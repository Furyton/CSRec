INFO    [03-14 15:43:05] setup_train in utils:
{
    "experiment_dir": "___el_base_partial_2022",
    "experiment_description": "base",
    "describe": "{config[model_code]}-rate-{config[sample_rate]}-seed-{config[sample_seed]}",
    "dataset_name": "electronics.csv",
    "sched": "basic",
    "model_code": "gru4rec",
    "num_epochs": 30,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "do_sampling": true,
    "path_for_sample": "Data/Cache/electronics-5-5.pkl",
    "sample_rate": 0.8,
    "sample_seed": 2001,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "do_remap": false,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 512,
    "val_batch_size": 512,
    "test_batch_size": 512,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "config_file": "config2.electronics/gru4rec/config_partial.json",
    "task_id": 2,
    "split": "leave_one_out",
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "mentor_code": "bert",
    "training_routine": null,
    "T": 1,
    "alpha": 0.1,
    "dvae_alpha": 0.5,
    "softmaxed_mentor": false,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [03-14 15:43:05] __init__ in BasicSched:
BasicScheduler attribs: tag=gru4rec
WARNING [03-14 15:43:05] _load_sampled_dataset_from_path in utils:
file from /data/wushiguang-slurm/code/gitee-repos/soft-rec/Data/Cache/sampled_electronics-5-5-rate-0.8-seed-2001.pkl not found. Regenerating.
DEBUG   [03-14 15:43:05] _resampling in utils:
loading full dataset from Data/Cache/electronics-5-5.pkl
INFO    [03-14 15:43:05] _load_full_dataset_from_path in utils:
loading cache from Data/Cache/electronics-5-5.pkl
INFO    [03-14 15:43:07] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [03-14 15:43:07] _check_dataset_cache in utils:
correct.
INFO    [03-14 15:43:12] __init__ in NextItemDataloader:
there are 29351 items in this dataset, 81749 users, padding_first? False
DEBUG   [03-14 15:43:25] generate_model in utils:
model_code_list=['gru4rec']
INFO    [03-14 15:43:25] load_model_config in utils:
loading model gru4rec's config file at asset/config/model/gru4rec.json
INFO    [03-14 15:43:25] load_model_config in utils:
{
    "embed_size": 64,
    "hidden_units": 64,
    "num_layers": 2,
    "hidden_dropout": 0.5,
    "loss_type": "CE"
}
WARNING [03-14 15:44:59] get_exist_path in utils:
dir ___el_base_partial_2022/base_gru4rec-rate-0.8-seed-2001_03-14_15:43_t2/gru4rec_logs does not exist! Create one.
WARNING [03-14 15:44:59] get_exist_path in utils:
dir ___el_base_partial_2022/base_gru4rec-rate-0.8-seed-2001_03-14_15:43_t2/gru4rec_logs/tb_vis does not exist! Create one.
WARNING [03-14 15:44:59] get_exist_path in utils:
dir ___el_base_partial_2022/base_gru4rec-rate-0.8-seed-2001_03-14_15:43_t2/gru4rec_logs/checkpoint does not exist! Create one.
INFO    [03-14 15:44:59] __init__ in BasicSched:
GRU4RecModel(
  (item_embedding): Embedding(29352, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.5, inplace=False)
  (gru_layers): GRU(64, 64, num_layers=2, bias=False, batch_first=True)
  (dense): Linear(in_features=64, out_features=64, bias=True)
  (loss_fct): CrossEntropyLoss()
)
WARNING [03-14 15:44:59] get_path in utils:
Path is None
WARNING [03-14 15:44:59] load_state_from_given_path in utils:
Not given any path.
INFO    [03-14 15:44:59] assert_model_device in utils:
model gru4rec has 7.369384765625 MB params.
INFO    [03-14 15:44:59] __init__ in BasicTrainer:
365568 iter per epoch
INFO    [03-14 15:44:59] _fit in BasicSched:
Start training.
INFO    [03-14 15:45:45] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [03-14 15:45:45] validate in BasicTrainer:
{'Recall@10': 0.0006591796875, 'NDCG@10': 0.00028428554687707217, 'MRR@10': 0.0001732138995976129, 'Recall@5': 0.00032958984375, 'NDCG@5': 0.00018030621868092567, 'MRR@5': 0.00013183593800931704, 'Recall*@10': 0.0005739090353017673, 'NDCG*@10': 0.00024303872378368397, 'MRR*@10': 0.0001444466226530494, 'Recall*@5': 0.00030326861888170243, 'NDCG*@5': 0.00015841641106817406, 'MRR*@5': 0.00011119137016066816}
INFO    [03-14 15:45:45] train in BasicTrainer:
epoch: 0
INFO    [03-14 15:46:17] _train_one_epoch in BasicTrainer:
loss = 9.614751165320559
INFO    [03-14 15:46:57] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [03-14 15:46:57] validate in BasicTrainer:
{'Recall@10': 0.0350405516801402, 'NDCG@10': 0.01790573649923317, 'MRR@10': 0.012696122063789516, 'Recall@5': 0.022906655236147343, 'NDCG@5': 0.013997986089088954, 'MRR@5': 0.011093721570796333, 'Recall*@10': 0.03813343849033117, 'NDCG*@10': 0.019871563994092865, 'MRR*@10': 0.014319776184856891, 'Recall*@5': 0.024644791497848928, 'NDCG*@5': 0.015527479053707794, 'MRR*@5': 0.012538342166226357}
INFO    [03-14 15:46:57] train in BasicTrainer:
duration: 72.17889428138733s
INFO    [03-14 15:46:57] train in BasicTrainer:
epoch: 1
INFO    [03-14 15:47:24] _train_one_epoch in BasicTrainer:
loss = 9.29691417544496
INFO    [03-14 15:48:03] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [03-14 15:48:03] validate in BasicTrainer:
{'Recall@10': 0.040301746362820266, 'NDCG@10': 0.02164483651285991, 'MRR@10': 0.015985337388701736, 'Recall@5': 0.026239174767397344, 'NDCG@5': 0.017122419213410466, 'MRR@5': 0.014133786765160038, 'Recall*@10': 0.04397039409959689, 'NDCG*@10': 0.023791417700704188, 'MRR*@10': 0.01766793498536572, 'Recall*@5': 0.028785599081311376, 'NDCG*@5': 0.01890616551390849, 'MRR*@5': 0.015666455728933215}
INFO    [03-14 15:48:03] train in BasicTrainer:
duration: 66.22391366958618s
INFO    [03-14 15:48:03] train in BasicTrainer:
epoch: 2
INFO    [03-14 15:48:30] _train_one_epoch in BasicTrainer:
loss = 9.047201629446334
INFO    [03-14 15:49:09] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [03-14 15:49:09] validate in BasicTrainer:
{'Recall@10': 0.0449892821488902, 'NDCG@10': 0.02445982766803354, 'MRR@10': 0.018221941427327693, 'Recall@5': 0.029870784457307308, 'NDCG@5': 0.019601745624095203, 'MRR@5': 0.01623452255153097, 'Recall*@10': 0.04911801491398364, 'NDCG*@10': 0.02675969761912711, 'MRR*@10': 0.019970951188588514, 'Recall*@5': 0.03250333668547682, 'NDCG*@5': 0.021417542407289148, 'MRR*@5': 0.01778348778607324}
INFO    [03-14 15:49:09] train in BasicTrainer:
duration: 65.97964644432068s
INFO    [03-14 15:49:09] train in BasicTrainer:
epoch: 3
INFO    [03-14 15:49:36] _train_one_epoch in BasicTrainer:
loss = 8.869409314056739
INFO    [03-14 15:50:17] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [03-14 15:50:18] validate in BasicTrainer:
{'Recall@10': 0.04688133620657027, 'NDCG@10': 0.02517837384948507, 'MRR@10': 0.018605313694570212, 'Recall@5': 0.03016980302054435, 'NDCG@5': 0.019800123595632612, 'MRR@5': 0.016400519758462906, 'Recall*@10': 0.05084673035889864, 'NDCG*@10': 0.027409621875267475, 'MRR*@10': 0.020305454364279284, 'Recall*@5': 0.03305275540333241, 'NDCG*@5': 0.021684706473024562, 'MRR*@5': 0.017959421151317656}
INFO    [03-14 15:50:18] train in BasicTrainer:
duration: 68.22461462020874s
INFO    [03-14 15:50:18] train in BasicTrainer:
epoch: 4
INFO    [03-14 15:50:43] _train_one_epoch in BasicTrainer:
loss = 8.736863817487444
INFO    [03-14 15:51:23] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [03-14 15:51:24] validate in BasicTrainer:
{'Recall@10': 0.048395043867640195, 'NDCG@10': 0.026124438602710142, 'MRR@10': 0.019364003842929377, 'Recall@5': 0.03187270178459585, 'NDCG@5': 0.02080867831245996, 'MRR@5': 0.017185733688529582, 'Recall*@10': 0.052581522439140826, 'NDCG*@10': 0.028496399434516206, 'MRR*@10': 0.02118381474283524, 'Recall*@5': 0.03477885226602666, 'NDCG*@5': 0.02277186291757971, 'MRR*@5': 0.01883984871383291}
INFO    [03-14 15:51:24] train in BasicTrainer:
duration: 66.32247233390808s
INFO    [03-14 15:51:24] train in BasicTrainer:
epoch: 5
INFO    [03-14 15:51:51] _train_one_epoch in BasicTrainer:
loss = 8.6339119889823
INFO    [03-14 15:52:31] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [03-14 15:52:32] validate in BasicTrainer:
{'Recall@10': 0.0491701724473387, 'NDCG@10': 0.02682752925902605, 'MRR@10': 0.02003300646902062, 'Recall@5': 0.03289809240959585, 'NDCG@5': 0.02159639325691387, 'MRR@5': 0.017892018432030456, 'Recall*@10': 0.05310264086583629, 'NDCG*@10': 0.02910525988554582, 'MRR*@10': 0.02180520328111015, 'Recall*@5': 0.03586738138692454, 'NDCG*@5': 0.02356652282178402, 'MRR*@5': 0.019539554003858938}
INFO    [03-14 15:52:32] train in BasicTrainer:
duration: 68.1213653087616s
INFO    [03-14 15:52:32] train in BasicTrainer:
epoch: 6
INFO    [03-14 15:52:58] _train_one_epoch in BasicTrainer:
loss = 8.547644207791453
INFO    [03-14 15:53:37] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [03-14 15:53:37] validate in BasicTrainer:
{'Recall@10': 0.0510683837113902, 'NDCG@10': 0.027781813708133995, 'MRR@10': 0.020708491175901143, 'Recall@5': 0.033776998659595846, 'NDCG@5': 0.022232371603604407, 'MRR@5': 0.018443248269613834, 'Recall*@10': 0.055457340355496855, 'NDCG*@10': 0.030126889946404844, 'MRR*@10': 0.022423894348321483, 'Recall*@5': 0.03684278509463183, 'NDCG*@5': 0.02414835056697484, 'MRR*@5': 0.019980921191745438}
INFO    [03-14 15:53:37] train in BasicTrainer:
duration: 65.10307955741882s
INFO    [03-14 15:53:37] train in BasicTrainer:
epoch: 7
INFO    [03-14 15:54:03] _train_one_epoch in BasicTrainer:
loss = 8.466080760421539
INFO    [03-14 15:54:43] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [03-14 15:54:45] validate in BasicTrainer:
{'Recall@10': 0.05075107249431312, 'NDCG@10': 0.027886753110215066, 'MRR@10': 0.020943032391369343, 'Recall@5': 0.033715963503345846, 'NDCG@5': 0.022412175661884248, 'MRR@5': 0.0187040759192314, 'Recall*@10': 0.054779906594194475, 'NDCG*@10': 0.0302043171657715, 'MRR*@10': 0.022737930004950613, 'Recall*@5': 0.036561622295994314, 'NDCG*@5': 0.02435577000142075, 'MRR*@5': 0.020349773272755556}
INFO    [03-14 15:54:45] train in BasicTrainer:
duration: 68.08694219589233s
INFO    [03-14 15:54:45] train in BasicTrainer:
epoch: 8
INFO    [03-14 15:55:11] _train_one_epoch in BasicTrainer:
loss = 8.387984010017886
INFO    [03-14 15:55:51] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [03-14 15:55:53] validate in BasicTrainer:
{'Recall@10': 0.051788598555140196, 'NDCG@10': 0.028192028444027527, 'MRR@10': 0.021044301672372968, 'Recall@5': 0.03391739742364734, 'NDCG@5': 0.0224433857598342, 'MRR@5': 0.018689229458686896, 'Recall*@10': 0.056272373697720465, 'NDCG*@10': 0.030600186489755286, 'MRR*@10': 0.0228288783429889, 'Recall*@5': 0.03673907548072748, 'NDCG*@5': 0.024318520145607182, 'MRR*@5': 0.02025637876940891}
INFO    [03-14 15:55:53] train in BasicTrainer:
duration: 68.09104919433594s
INFO    [03-14 15:55:53] train in BasicTrainer:
epoch: 9
INFO    [03-14 15:56:21] _train_one_epoch in BasicTrainer:
loss = 8.312282066719204
INFO    [03-14 15:57:01] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [03-14 15:57:03] validate in BasicTrainer:
{'Recall@10': 0.0518313410691917, 'NDCG@10': 0.02859285632148385, 'MRR@10': 0.021534287551185118, 'Recall@5': 0.034655940707307306, 'NDCG@5': 0.02307779180118814, 'MRR@5': 0.01928087195556145, 'Recall*@10': 0.05589498170884326, 'NDCG*@10': 0.03078182930476032, 'MRR*@10': 0.023142713244305925, 'Recall*@5': 0.03770973467035219, 'NDCG*@5': 0.024941568495705724, 'MRR*@5': 0.020755814504809678}
INFO    [03-14 15:57:03] train in BasicTrainer:
duration: 69.19474291801453s
INFO    [03-14 15:57:03] train in BasicTrainer:
epoch: 10
INFO    [03-14 15:57:30] _train_one_epoch in BasicTrainer:
loss = 8.240608183943591
INFO    [03-14 15:58:10] validate in BasicTrainer:
{'Recall@10': 0.0516848208848387, 'NDCG@10': 0.02849607923417352, 'MRR@10': 0.021456171857425942, 'Recall@5': 0.03430190100334585, 'NDCG@5': 0.02288637906895019, 'MRR@5': 0.019147494313074276, 'Recall*@10': 0.05593416797928512, 'NDCG*@10': 0.030908264877507464, 'MRR*@10': 0.02331080490257591, 'Recall*@5': 0.03712707507656887, 'NDCG*@5': 0.024842116588843055, 'MRR*@5': 0.020816100694355556}
INFO    [03-14 15:58:10] train in BasicTrainer:
duration: 67.092050075531s
INFO    [03-14 15:58:10] train in BasicTrainer:
epoch: 11
INFO    [03-14 15:58:37] _train_one_epoch in BasicTrainer:
loss = 8.170466417691955
INFO    [03-14 15:59:17] validate in BasicTrainer:
{'Recall@10': 0.0509829344926402, 'NDCG@10': 0.02824989677174017, 'MRR@10': 0.021344960387796163, 'Recall@5': 0.03394181148614735, 'NDCG@5': 0.022764893010025843, 'MRR@5': 0.019096454518148676, 'Recall*@10': 0.05502513579558581, 'NDCG*@10': 0.030481421935837714, 'MRR*@10': 0.023022634227527306, 'Recall*@5': 0.0367167059564963, 'NDCG*@5': 0.024581973446765916, 'MRR*@5': 0.020600194373400882}
INFO    [03-14 15:59:17] train in BasicTrainer:
duration: 67.73796963691711s
INFO    [03-14 15:59:17] train in BasicTrainer:
epoch: 12
INFO    [03-14 15:59:45] _train_one_epoch in BasicTrainer:
loss = 8.103346574874152
INFO    [03-14 16:00:24] validate in BasicTrainer:
{'Recall@10': 0.05137968091294169, 'NDCG@10': 0.028051589452661573, 'MRR@10': 0.02097171507193707, 'Recall@5': 0.034039539331570265, 'NDCG@5': 0.022467403166228906, 'MRR@5': 0.018680840951856226, 'Recall*@10': 0.05526979477144778, 'NDCG*@10': 0.03019876094767824, 'MRR*@10': 0.022590098436921835, 'Recall*@5': 0.0365771357784979, 'NDCG*@5': 0.024174243048764765, 'MRR*@5': 0.0201156326191267}
INFO    [03-14 16:00:24] train in BasicTrainer:
duration: 66.73471140861511s
INFO    [03-14 16:00:24] train in BasicTrainer:
epoch: 13
INFO    [03-14 16:00:52] _train_one_epoch in BasicTrainer:
loss = 8.039985289426745
INFO    [03-14 16:01:32] validate in BasicTrainer:
{'Recall@10': 0.05135526685044169, 'NDCG@10': 0.02851314191939309, 'MRR@10': 0.021560980903450398, 'Recall@5': 0.03469256180105731, 'NDCG@5': 0.023159216629574077, 'MRR@5': 0.019371030371985398, 'Recall*@10': 0.05501746826339513, 'NDCG*@10': 0.030659500043839216, 'MRR*@10': 0.0232422745146323, 'Recall*@5': 0.037400269554927944, 'NDCG*@5': 0.02499215245479718, 'MRR*@5': 0.020920256627141497}
INFO    [03-14 16:01:32] train in BasicTrainer:
duration: 67.76073169708252s
INFO    [03-14 16:01:32] train in BasicTrainer:
epoch: 14
INFO    [03-14 16:01:59] _train_one_epoch in BasicTrainer:
loss = 7.980787917011592
INFO    [03-14 16:02:42] validate in BasicTrainer:
{'Recall@10': 0.0502443911973387, 'NDCG@10': 0.027896270889323206, 'MRR@10': 0.021106307103764266, 'Recall@5': 0.03369162103626877, 'NDCG@5': 0.022588480199920012, 'MRR@5': 0.018941948475548996, 'Recall*@10': 0.05446160181891173, 'NDCG*@10': 0.03019990781904198, 'MRR*@10': 0.022835669229971246, 'Recall*@5': 0.03628427101066336, 'NDCG*@5': 0.024367069540312515, 'MRR*@5': 0.020454763900488615}
INFO    [03-14 16:02:42] train in BasicTrainer:
duration: 70.0335853099823s
INFO    [03-14 16:02:42] train in BasicTrainer:
epoch: 15
INFO    [03-14 16:03:08] _train_one_epoch in BasicTrainer:
loss = 7.920707238488505
INFO    [03-14 16:03:47] validate in BasicTrainer:
{'Recall@10': 0.049652368086390196, 'NDCG@10': 0.027692264795769007, 'MRR@10': 0.02102638696669601, 'Recall@5': 0.033313167269807306, 'NDCG@5': 0.022443155286600812, 'MRR@5': 0.018880202047876084, 'Recall*@10': 0.05363224936882034, 'NDCG*@10': 0.029985666438005865, 'MRR*@10': 0.02280916190939024, 'Recall*@5': 0.03601255802204832, 'NDCG*@5': 0.02432114604162052, 'MRR*@5': 0.020490809934563002}
INFO    [03-14 16:03:47] train in BasicTrainer:
duration: 65.45652890205383s
INFO    [03-14 16:03:47] train in BasicTrainer:
epoch: 16
INFO    [03-14 16:04:13] _train_one_epoch in BasicTrainer:
loss = 7.86620928927296
INFO    [03-14 16:04:54] validate in BasicTrainer:
{'Recall@10': 0.0490786376176402, 'NDCG@10': 0.027050050202524288, 'MRR@10': 0.020369100850075483, 'Recall@5': 0.03244643225334585, 'NDCG@5': 0.021693877928191795, 'MRR@5': 0.018171547577367164, 'Recall*@10': 0.05310196760110557, 'NDCG*@10': 0.02924810644472018, 'MRR*@10': 0.022012920200359075, 'Recall*@5': 0.03512548283906654, 'NDCG*@5': 0.023455534694949164, 'MRR*@5': 0.01963429273746442}
INFO    [03-14 16:04:54] train in BasicTrainer:
duration: 66.47300601005554s
INFO    [03-14 16:04:54] train in BasicTrainer:
epoch: 17
INFO    [03-14 16:05:20] _train_one_epoch in BasicTrainer:
loss = 7.8137596234554
INFO    [03-14 16:05:59] validate in BasicTrainer:
{'Recall@10': 0.05009185702074319, 'NDCG@10': 0.02770548315020278, 'MRR@10': 0.02092339769587852, 'Recall@5': 0.033069026644807306, 'NDCG@5': 0.022229728946695105, 'MRR@5': 0.01868043098656926, 'Recall*@10': 0.0535152533557266, 'NDCG*@10': 0.029716145183192565, 'MRR*@10': 0.022500212339218707, 'Recall*@5': 0.0355473289382644, 'NDCG*@5': 0.02393549677217379, 'MRR*@5': 0.020131893293000757}
INFO    [03-14 16:05:59] train in BasicTrainer:
duration: 65.06284689903259s
INFO    [03-14 16:05:59] train in BasicTrainer:
epoch: 18
INFO    [03-14 16:06:26] _train_one_epoch in BasicTrainer:
loss = 7.760535908680336
INFO    [03-14 16:07:05] validate in BasicTrainer:
{'Recall@10': 0.04917632967699319, 'NDCG@10': 0.02704339532647282, 'MRR@10': 0.020344104414107278, 'Recall@5': 0.032000929303467276, 'NDCG@5': 0.02153095161775127, 'MRR@5': 0.01809294884442352, 'Recall*@10': 0.05270091403508559, 'NDCG*@10': 0.029022338252980263, 'MRR*@10': 0.02186230314546265, 'Recall*@5': 0.034153825079556555, 'NDCG*@5': 0.02307614935853053, 'MRR*@5': 0.01943812632234767}
INFO    [03-14 16:07:05] train in BasicTrainer:
duration: 65.89428305625916s
INFO    [03-14 16:07:05] train in BasicTrainer:
epoch: 19
INFO    [03-14 16:07:33] _train_one_epoch in BasicTrainer:
loss = 7.714089167886088
INFO    [03-14 16:08:12] validate in BasicTrainer:
{'Recall@10': 0.048254716722294685, 'NDCG@10': 0.026331534079508855, 'MRR@10': 0.01969318574410863, 'Recall@5': 0.03143332025501877, 'NDCG@5': 0.020921508193714543, 'MRR@5': 0.01747762138256803, 'Recall*@10': 0.05153349284082651, 'NDCG*@10': 0.02828624535468407, 'MRR*@10': 0.021242361480835824, 'Recall*@5': 0.03385775163187645, 'NDCG*@5': 0.022603767493274064, 'MRR*@5': 0.018916586867999286}
INFO    [03-14 16:08:12] train in BasicTrainer:
duration: 66.92327618598938s
INFO    [03-14 16:08:12] train in BasicTrainer:
epoch: 20
INFO    [03-14 16:08:37] _train_one_epoch in BasicTrainer:
loss = 7.667628757092131
INFO    [03-14 16:09:16] validate in BasicTrainer:
{'Recall@10': 0.04830350903794169, 'NDCG@10': 0.026505986280972137, 'MRR@10': 0.019899825396714733, 'Recall@5': 0.031817823834717276, 'NDCG@5': 0.02121894700685516, 'MRR@5': 0.0177436224068515, 'Recall*@10': 0.05168236513854936, 'NDCG*@10': 0.028459296008804813, 'MRR*@10': 0.02141863529686816, 'Recall*@5': 0.03413511346443556, 'NDCG*@5': 0.022832686026231386, 'MRR*@5': 0.019124537004972807}
INFO    [03-14 16:09:16] train in BasicTrainer:
duration: 64.07470369338989s
INFO    [03-14 16:09:16] train in BasicTrainer:
epoch: 21
INFO    [03-14 16:09:41] _train_one_epoch in BasicTrainer:
loss = 7.6210049948438545
INFO    [03-14 16:10:21] validate in BasicTrainer:
{'Recall@10': 0.04790679842699319, 'NDCG@10': 0.02644377698889002, 'MRR@10': 0.019940272631356493, 'Recall@5': 0.03170799636282027, 'NDCG@5': 0.02124652997008525, 'MRR@5': 0.01781882216455415, 'Recall*@10': 0.05129428770160303, 'NDCG*@10': 0.028401045728242025, 'MRR*@10': 0.021459272975334898, 'Recall*@5': 0.034141146071488035, 'NDCG*@5': 0.022898905124748126, 'MRR*@5': 0.019214217230910435}
INFO    [03-14 16:10:21] train in BasicTrainer:
duration: 64.84631657600403s
INFO    [03-14 16:10:21] train in BasicTrainer:
epoch: 22
INFO    [03-14 16:10:48] _train_one_epoch in BasicTrainer:
loss = 7.577872425234284
INFO    [03-14 16:11:30] validate in BasicTrainer:
{'Recall@10': 0.05011018547229469, 'NDCG@10': 0.027593927073758094, 'MRR@10': 0.0207643139292486, 'Recall@5': 0.03320330398855731, 'NDCG@5': 0.022149744105990975, 'MRR@5': 0.018530984403332694, 'Recall*@10': 0.05386650718282908, 'NDCG*@10': 0.02969258210505359, 'MRR*@10': 0.022360922681400552, 'Recall*@5': 0.035753772396128626, 'NDCG*@5': 0.02386341896490194, 'MRR*@5': 0.019971547575551085}
INFO    [03-14 16:11:30] train in BasicTrainer:
duration: 68.88409733772278s
INFO    [03-14 16:11:30] train in BasicTrainer:
epoch: 23
INFO    [03-14 16:11:57] _train_one_epoch in BasicTrainer:
loss = 7.540936082685027
INFO    [03-14 16:12:37] validate in BasicTrainer:
{'Recall@10': 0.0486880126176402, 'NDCG@10': 0.026957702660001814, 'MRR@10': 0.020365911745466293, 'Recall@5': 0.03237934727221727, 'NDCG@5': 0.021718367061112076, 'MRR@5': 0.01822357238852419, 'Recall*@10': 0.052019728638697416, 'NDCG*@10': 0.02888367517734878, 'MRR*@10': 0.02186767056118697, 'Recall*@5': 0.034590891597326846, 'NDCG*@5': 0.02329040895565413, 'MRR*@5': 0.019583952671382576}
INFO    [03-14 16:12:37] train in BasicTrainer:
duration: 67.12173366546631s
INFO    [03-14 16:12:37] train in BasicTrainer:
epoch: 24
INFO    [03-14 16:13:04] _train_one_epoch in BasicTrainer:
loss = 7.4991718013079565
INFO    [03-14 16:13:42] validate in BasicTrainer:
{'Recall@10': 0.046649509994313124, 'NDCG@10': 0.0259820002829656, 'MRR@10': 0.019705268734833227, 'Recall@5': 0.031164765567518772, 'NDCG@5': 0.02099923447240144, 'MRR@5': 0.017662972598918712, 'Recall*@10': 0.04987859078682959, 'NDCG*@10': 0.02784307048423216, 'MRR*@10': 0.021150381566258147, 'Recall*@5': 0.03324368806788698, 'NDCG*@5': 0.022490693721920252, 'MRR*@5': 0.018956827669171616}
INFO    [03-14 16:13:42] train in BasicTrainer:
duration: 65.72105097770691s
INFO    [03-14 16:13:42] train in BasicTrainer:
epoch: 25
INFO    [03-14 16:14:10] _train_one_epoch in BasicTrainer:
loss = 7.460223374246549
INFO    [03-14 16:14:49] validate in BasicTrainer:
{'Recall@10': 0.04874908358324319, 'NDCG@10': 0.02699795530643314, 'MRR@10': 0.02040792313637212, 'Recall@5': 0.03205584305105731, 'NDCG@5': 0.021632993733510374, 'MRR@5': 0.018212992954067884, 'Recall*@10': 0.05210527079179883, 'NDCG*@10': 0.028879032621625812, 'MRR*@10': 0.021838656696490943, 'Recall*@5': 0.03438787878258154, 'NDCG*@5': 0.02318554142257199, 'MRR*@5': 0.019509714137529954}
INFO    [03-14 16:14:49] train in BasicTrainer:
duration: 66.7891013622284s
INFO    [03-14 16:14:49] train in BasicTrainer:
epoch: 26
INFO    [03-14 16:15:15] _train_one_epoch in BasicTrainer:
loss = 7.425496671046195
INFO    [03-14 16:15:54] validate in BasicTrainer:
{'Recall@10': 0.047485637944191694, 'NDCG@10': 0.02652343429508619, 'MRR@10': 0.020161598158301784, 'Recall@5': 0.03184220211114734, 'NDCG@5': 0.021495758841047062, 'MRR@5': 0.018104750791098922, 'Recall*@10': 0.0505890364642255, 'NDCG*@10': 0.02830176878487691, 'MRR*@10': 0.021527418127516285, 'Recall*@5': 0.03423690994968638, 'NDCG*@5': 0.023045987309888005, 'MRR*@5': 0.01937704552547075}
INFO    [03-14 16:15:54] train in BasicTrainer:
duration: 64.79464673995972s
INFO    [03-14 16:15:54] train in BasicTrainer:
epoch: 27
INFO    [03-14 16:16:20] _train_one_epoch in BasicTrainer:
loss = 7.389691877765816
INFO    [03-14 16:16:59] validate in BasicTrainer:
{'Recall@10': 0.04737581047229469, 'NDCG@10': 0.026710647769505158, 'MRR@10': 0.02043886117753573, 'Recall@5': 0.03184835931751877, 'NDCG@5': 0.021728641615482047, 'MRR@5': 0.018405487589188852, 'Recall*@10': 0.050175237946677956, 'NDCG*@10': 0.028358994406880812, 'MRR*@10': 0.021723620232660324, 'Recall*@5': 0.03414233917137608, 'NDCG*@5': 0.023214526008814573, 'MRR*@5': 0.019623692124150695}
INFO    [03-14 16:16:59] train in BasicTrainer:
duration: 65.09716892242432s
INFO    [03-14 16:16:59] train in BasicTrainer:
epoch: 28
INFO    [03-14 16:17:24] _train_one_epoch in BasicTrainer:
loss = 7.356524353935605
INFO    [03-14 16:18:04] validate in BasicTrainer:
{'Recall@10': 0.0445010008988902, 'NDCG@10': 0.024848210328491403, 'MRR@10': 0.01889468536246568, 'Recall@5': 0.029504537722095846, 'NDCG@5': 0.020037391601363197, 'MRR@5': 0.016931867343373597, 'Recall*@10': 0.04712787952739746, 'NDCG*@10': 0.02635749974870123, 'MRR*@10': 0.02006036257953383, 'Recall*@5': 0.0314413386688102, 'NDCG*@5': 0.021319896198110654, 'MRR*@5': 0.018001787416869773}
INFO    [03-14 16:18:04] train in BasicTrainer:
duration: 64.63668847084045s
INFO    [03-14 16:18:04] train in BasicTrainer:
epoch: 29
INFO    [03-14 16:18:30] _train_one_epoch in BasicTrainer:
loss = 7.322452295394171
INFO    [03-14 16:19:10] validate in BasicTrainer:
{'Recall@10': 0.048236424056813124, 'NDCG@10': 0.0273238567460794, 'MRR@10': 0.02096724129805807, 'Recall@5': 0.03297745601739734, 'NDCG@5': 0.02243009475641884, 'MRR@5': 0.01897096073953435, 'Recall*@10': 0.051438186783343554, 'NDCG*@10': 0.02903500327374786, 'MRR*@10': 0.022235726812505165, 'Recall*@5': 0.034859781386330724, 'NDCG*@5': 0.023718837957130746, 'MRR*@5': 0.02006766989652533}
INFO    [03-14 16:19:10] train in BasicTrainer:
duration: 66.26791524887085s
INFO    [03-14 16:19:10] close_training in BasicTrainer:
finished training
INFO    [03-14 16:19:10] final_validate in BasicTrainer:
validate model on val set!
INFO    [03-14 16:19:10] load_state_from_given_path in utils:
checkpoint epoch: 9
INFO    [03-14 16:19:10] load_state_from_given_path in utils:
Loading model's parameters
INFO    [03-14 16:19:49] validate in BasicTrainer:
{'Recall@10': 0.0518313410691917, 'NDCG@10': 0.02859285632148385, 'MRR@10': 0.021534287551185118, 'Recall@5': 0.034655940707307306, 'NDCG@5': 0.02307779180118814, 'MRR@5': 0.01928087195556145, 'Recall*@10': 0.05589498170884326, 'NDCG*@10': 0.03078182930476032, 'MRR*@10': 0.023142713244305925, 'Recall*@5': 0.03770973467035219, 'NDCG*@5': 0.024941568495705724, 'MRR*@5': 0.020755814504809678}
INFO    [03-14 16:19:49] test in BasicTrainer:
Test model on test set!
INFO    [03-14 16:19:49] test_with_given_state_path in BasicTrainer:
Loading model params from ___el_base_partial_2022/base_gru4rec-rate-0.8-seed-2001_03-14_15:43_t2/gru4rec_logs/checkpoint/best_acc_model.pth.
INFO    [03-14 16:19:49] load_state_from_given_path in utils:
checkpoint epoch: 9
INFO    [03-14 16:19:49] load_state_from_given_path in utils:
Loading model's parameters
INFO    [03-14 16:19:49] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [03-14 16:20:28] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.05089752108324319, 'NDCG@10': 0.02799320808262564, 'MRR@10': 0.02101358361542225, 'Recall@5': 0.0347414615098387, 'NDCG@5': 0.02280333202215843, 'MRR@5': 0.018891843024175615, 'Recall*@10': 0.054591005318798125, 'NDCG*@10': 0.02994998707436025, 'MRR*@10': 0.022436751393252054, 'Recall*@5': 0.03750398777774535, 'NDCG*@5': 0.024467832455411554, 'MRR*@5': 0.02019951890106313}
INFO    [03-14 16:20:28] _evaluate in BasicSched:
!!Final Result!!: {'Recall@10': 0.05089752108324319, 'NDCG@10': 0.02799320808262564, 'MRR@10': 0.02101358361542225, 'Recall@5': 0.0347414615098387, 'NDCG@5': 0.02280333202215843, 'MRR@5': 0.018891843024175615, 'Recall*@10': 0.054591005318798125, 'NDCG*@10': 0.02994998707436025, 'MRR*@10': 0.022436751393252054, 'Recall*@5': 0.03750398777774535, 'NDCG*@5': 0.024467832455411554, 'MRR*@5': 0.02019951890106313}
