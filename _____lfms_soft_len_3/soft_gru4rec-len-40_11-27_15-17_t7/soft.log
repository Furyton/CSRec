INFO    [11-27 15:17:45] setup_train in utils:
{
    "experiment_dir": "_____lfms_soft_len_3",
    "experiment_description": "soft",
    "describe": "{config[model_code]}-len-{config[max_len]}",
    "dataset_name": "lastfm_small.csv",
    "sched": "distill",
    "model_code": "gru4rec",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "dvae_alpha": 0.5,
    "alpha": 0.5,
    "T": 3,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 40,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2021,
    "load_processed_dataset": false,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 1024,
    "val_batch_size": 1024,
    "test_batch_size": 1024,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.lastfm_small/gru4rec/config_distill.json",
    "task_id": 7,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [11-27 15:17:45] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_gru4rec
INFO    [11-27 15:17:45] _gen_dataset in utils:
processing dataset lastfm_small.csv
INFO    [11-27 15:17:45] _drop_cold in utils:
filtering out cold users (who interacts with less or eq than 5 items) and cold items (which is interacted by less or eq than 5 users)
DEBUG   [11-27 15:17:45] _drop_cold in utils:
before filtering, there are 1090 users, 3646 items 
DEBUG   [11-27 15:17:45] _drop_cold in utils:
after 0 filterings, there are 1090 users, 3646 items
INFO    [11-27 15:17:45] _drop_cold in utils:
user desc 
            seq_len
count  1090.000000
mean     48.211927
std      77.730410
min       5.000000
25%       9.000000
50%      19.000000
75%      49.750000
max     899.000000
INFO    [11-27 15:17:45] _drop_cold in utils:
item desc 
           item_pop
count  3646.000000
mean     14.413330
std      16.072829
min       5.000000
25%       6.000000
50%       9.000000
75%      15.000000
max     177.000000
INFO    [11-27 15:17:45] _df_data_partition in utils:
dataset summary:
         session_id       item_id   rating
count  52551.000000  52551.000000  52551.0
mean     527.873799   1828.243915      1.0
std      316.650738   1049.669215      0.0
min        1.000000      1.000000      1.0
25%      248.000000    928.000000      1.0
50%      515.000000   1834.000000      1.0
75%      813.000000   2718.500000      1.0
max     1090.000000   3646.000000      1.0
INFO    [11-27 15:17:45] __init__ in NextItemDataloader:
there are 3646 items in this dataset, 1976 users, padding_first? False
DEBUG   [11-27 15:17:46] generate_model in utils:
model_code_list=['pop']
INFO    [11-27 15:17:46] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [11-27 15:17:46] load_model_config in utils:
{}
WARNING [11-27 15:17:51] get_exist_path in utils:
dir _____lfms_soft_len_3/soft_gru4rec-len-40_11-27_15-17_t7/teacher_pop_logs does not exist! Create one.
WARNING [11-27 15:17:51] get_exist_path in utils:
dir _____lfms_soft_len_3/soft_gru4rec-len-40_11-27_15-17_t7/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [11-27 15:17:51] get_exist_path in utils:
dir _____lfms_soft_len_3/soft_gru4rec-len-40_11-27_15-17_t7/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [11-27 15:17:51] get_path in utils:
Path is None
WARNING [11-27 15:17:51] load_state_from_given_path in utils:
Not given any path.
DEBUG   [11-27 15:17:51] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [11-27 15:17:51] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [11-27 15:17:51] __init__ in BasicTrainer:
53248 iter per epoch
DEBUG   [11-27 15:17:51] generate_model in utils:
model_code_list=['gru4rec']
INFO    [11-27 15:17:51] load_model_config in utils:
loading model gru4rec's config file at asset/config/model/gru4rec.json
INFO    [11-27 15:17:51] load_model_config in utils:
{
    "embed_size": 64,
    "hidden_units": 64,
    "num_layers": 2,
    "hidden_dropout": 0.5,
    "loss_type": "CE"
}
WARNING [11-27 15:17:52] get_exist_path in utils:
dir _____lfms_soft_len_3/soft_gru4rec-len-40_11-27_15-17_t7/student_gru4rec_logs does not exist! Create one.
WARNING [11-27 15:17:52] get_exist_path in utils:
dir _____lfms_soft_len_3/soft_gru4rec-len-40_11-27_15-17_t7/student_gru4rec_logs/tb_vis does not exist! Create one.
WARNING [11-27 15:17:52] get_exist_path in utils:
dir _____lfms_soft_len_3/soft_gru4rec-len-40_11-27_15-17_t7/student_gru4rec_logs/checkpoint does not exist! Create one.
WARNING [11-27 15:17:52] get_path in utils:
Path is None
WARNING [11-27 15:17:52] load_state_from_given_path in utils:
Not given any path.
DEBUG   [11-27 15:17:52] __init__ in DistillSched:
student model: 
GRU4RecModel(
  (item_embedding): Embedding(3647, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.5, inplace=False)
  (gru_layers): GRU(64, 64, num_layers=2, bias=False, batch_first=True)
  (dense): Linear(in_features=64, out_features=64, bias=True)
  (loss_fct): CrossEntropyLoss()
)
INFO    [11-27 15:17:52] assert_model_device in utils:
model student_gru4rec has 1.09375 MB params.
INFO    [11-27 15:17:52] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [11-27 15:17:52] __init__ in DistillTrainer:
53248 iter per epoch
INFO    [11-27 15:17:52] _set_current_routine in Routine:
first routine: student
INFO    [11-27 15:17:52] run_routine in Routine:
Start routine student
INFO    [11-27 15:17:52] run_routine in Routine:
Start training
INFO    [11-27 15:17:52] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [11-27 15:17:54] test_mentor in DistillTrainer:
{'Recall@10': 0.03325236402451992, 'NDCG@10': 0.015208391472697258, 'MRR@10': 0.009738542838022113, 'Recall@5': 0.021357175894081593, 'NDCG@5': 0.011484799440950155, 'MRR@5': 0.008273085113614798, 'Recall*@10': 0.03325236402451992, 'NDCG*@10': 0.015208391472697258, 'MRR*@10': 0.009738542838022113, 'Recall*@5': 0.021357175894081593, 'NDCG*@5': 0.011484799440950155, 'MRR*@5': 0.008273085113614798}
INFO    [11-27 15:17:54] train in DistillTrainer:
result:
{'Recall@10': 0.03325236402451992, 'NDCG@10': 0.015208391472697258, 'MRR@10': 0.009738542838022113, 'Recall@5': 0.021357175894081593, 'NDCG@5': 0.011484799440950155, 'MRR@5': 0.008273085113614798, 'Recall*@10': 0.03325236402451992, 'NDCG*@10': 0.015208391472697258, 'MRR*@10': 0.009738542838022113, 'Recall*@5': 0.021357175894081593, 'NDCG*@5': 0.011484799440950155, 'MRR*@5': 0.008273085113614798}
INFO    [11-27 15:17:55] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [11-27 15:17:55] validate in BasicTrainer:
{'Recall@10': 0.0010134913609363139, 'NDCG@10': 0.0003759766404982656, 'MRR@10': 0.00018772157636703923, 'Recall@5': 0.00048828125, 'NDCG@5': 0.00021029129857197404, 'MRR@5': 0.0001220703125, 'Recall*@10': 0.0010134913609363139, 'NDCG*@10': 0.0003759766404982656, 'MRR*@10': 0.00018772157636703923, 'Recall*@5': 0.00048828125, 'NDCG*@5': 0.00021029129857197404, 'MRR*@5': 0.0001220703125}
INFO    [11-27 15:17:55] train in BasicTrainer:
epoch: 0
DEBUG   [11-27 15:17:56] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 2627066
DEBUG   [11-27 15:17:56] calculate_loss in loss:
pred max in softmax: 0.00028816796839237213, argmax 2857165
INFO    [11-27 15:17:59] _train_one_epoch in BasicTrainer:
loss = 5.716458118878878
INFO    [11-27 15:18:01] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [11-27 15:18:01] validate in BasicTrainer:
{'Recall@10': 0.025189568288624287, 'NDCG@10': 0.013106343802064657, 'MRR@10': 0.009494198020547628, 'Recall@5': 0.016142004169523716, 'NDCG@5': 0.010219774674624205, 'MRR@5': 0.00832423847168684, 'Recall*@10': 0.025189568288624287, 'NDCG*@10': 0.013106343802064657, 'MRR*@10': 0.009494198020547628, 'Recall*@5': 0.016142004169523716, 'NDCG*@5': 0.010219774674624205, 'MRR*@5': 0.00832423847168684}
INFO    [11-27 15:18:01] train in BasicTrainer:
duration: 5.60180139541626s
INFO    [11-27 15:18:01] train in BasicTrainer:
epoch: 1
INFO    [11-27 15:18:05] _train_one_epoch in BasicTrainer:
loss = 5.476231776751005
INFO    [11-27 15:18:06] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [11-27 15:18:06] validate in BasicTrainer:
{'Recall@10': 0.025825565680861473, 'NDCG@10': 0.014940813183784485, 'MRR@10': 0.01172117330133915, 'Recall@5': 0.015616794116795063, 'NDCG@5': 0.011654948350042105, 'MRR@5': 0.010374883189797401, 'Recall*@10': 0.025825565680861473, 'NDCG*@10': 0.014940813183784485, 'MRR*@10': 0.01172117330133915, 'Recall*@5': 0.015616794116795063, 'NDCG*@5': 0.011654948350042105, 'MRR*@5': 0.010374883189797401}
INFO    [11-27 15:18:06] train in BasicTrainer:
duration: 5.518116474151611s
INFO    [11-27 15:18:06] train in BasicTrainer:
epoch: 2
INFO    [11-27 15:18:10] _train_one_epoch in BasicTrainer:
loss = 5.418969227717473
INFO    [11-27 15:18:12] validate in BasicTrainer:
{'Recall@10': 0.027704832144081593, 'NDCG@10': 0.014290013816207647, 'MRR@10': 0.010298660956323147, 'Recall@5': 0.015128512866795063, 'NDCG@5': 0.010269207414239645, 'MRR@5': 0.008666924200952053, 'Recall*@10': 0.027704832144081593, 'NDCG*@10': 0.014290013816207647, 'MRR*@10': 0.010298660956323147, 'Recall*@5': 0.015128512866795063, 'NDCG*@5': 0.010269207414239645, 'MRR*@5': 0.008666924200952053}
INFO    [11-27 15:18:12] train in BasicTrainer:
duration: 5.580567359924316s
INFO    [11-27 15:18:12] train in BasicTrainer:
epoch: 3
INFO    [11-27 15:18:16] _train_one_epoch in BasicTrainer:
loss = 5.373949674459604
INFO    [11-27 15:18:17] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [11-27 15:18:17] validate in BasicTrainer:
{'Recall@10': 0.03322364203631878, 'NDCG@10': 0.016155516263097525, 'MRR@10': 0.011024499079212546, 'Recall@5': 0.02008518297225237, 'NDCG@5': 0.011964048724621534, 'MRR@5': 0.009327608160674572, 'Recall*@10': 0.03322364203631878, 'NDCG*@10': 0.016155516263097525, 'MRR*@10': 0.011024499079212546, 'Recall*@5': 0.02008518297225237, 'NDCG*@5': 0.011964048724621534, 'MRR*@5': 0.009327608160674572}
INFO    [11-27 15:18:17] train in BasicTrainer:
duration: 5.459932088851929s
INFO    [11-27 15:18:17] train in BasicTrainer:
epoch: 4
INFO    [11-27 15:18:22] _train_one_epoch in BasicTrainer:
loss = 5.298424821633559
INFO    [11-27 15:18:23] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [11-27 15:18:23] validate in BasicTrainer:
{'Recall@10': 0.04545939527451992, 'NDCG@10': 0.021864010952413082, 'MRR@10': 0.014781547710299492, 'Recall@5': 0.025640920735895634, 'NDCG@5': 0.015490866266191006, 'MRR@5': 0.012171539012342691, 'Recall*@10': 0.04545939527451992, 'NDCG*@10': 0.021864010952413082, 'MRR*@10': 0.014781547710299492, 'Recall*@5': 0.025640920735895634, 'NDCG*@5': 0.015490866266191006, 'MRR*@5': 0.012171539012342691}
INFO    [11-27 15:18:23] train in BasicTrainer:
duration: 5.843661546707153s
INFO    [11-27 15:18:23] train in BasicTrainer:
epoch: 5
INFO    [11-27 15:18:27] _train_one_epoch in BasicTrainer:
loss = 5.210907340049744
INFO    [11-27 15:18:29] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [11-27 15:18:29] validate in BasicTrainer:
{'Recall@10': 0.05341961048543453, 'NDCG@10': 0.02766607515513897, 'MRR@10': 0.01987473014742136, 'Recall@5': 0.03479927219450474, 'NDCG@5': 0.02168624009937048, 'MRR@5': 0.01743430830538273, 'Recall*@10': 0.05341961048543453, 'NDCG*@10': 0.02766607515513897, 'MRR*@10': 0.01987473014742136, 'Recall*@5': 0.03479927219450474, 'NDCG*@5': 0.02168624009937048, 'MRR*@5': 0.01743430830538273}
INFO    [11-27 15:18:29] train in BasicTrainer:
duration: 5.72598123550415s
INFO    [11-27 15:18:29] train in BasicTrainer:
epoch: 6
INFO    [11-27 15:18:33] _train_one_epoch in BasicTrainer:
loss = 5.145472187262315
INFO    [11-27 15:18:35] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [11-27 15:18:35] validate in BasicTrainer:
{'Recall@10': 0.06002577021718025, 'NDCG@10': 0.033117168582975864, 'MRR@10': 0.02503008022904396, 'Recall@5': 0.03874245099723339, 'NDCG@5': 0.02622873056679964, 'MRR@5': 0.02218527253717184, 'Recall*@10': 0.06002577021718025, 'NDCG*@10': 0.033117168582975864, 'MRR*@10': 0.02503008022904396, 'Recall*@5': 0.03874245099723339, 'NDCG*@5': 0.02622873056679964, 'MRR*@5': 0.02218527253717184}
INFO    [11-27 15:18:35] train in BasicTrainer:
duration: 5.826662302017212s
INFO    [11-27 15:18:35] train in BasicTrainer:
epoch: 7
INFO    [11-27 15:18:38] _train_one_epoch in BasicTrainer:
loss = 5.097061799122737
INFO    [11-27 15:18:40] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [11-27 15:18:40] validate in BasicTrainer:
{'Recall@10': 0.061638329178094864, 'NDCG@10': 0.033246551640331745, 'MRR@10': 0.024717407301068306, 'Recall@5': 0.039866728708148, 'NDCG@5': 0.026255621574819088, 'MRR@5': 0.021859407424926758, 'Recall*@10': 0.061638329178094864, 'NDCG*@10': 0.033246551640331745, 'MRR*@10': 0.024717407301068306, 'Recall*@5': 0.039866728708148, 'NDCG*@5': 0.026255621574819088, 'MRR*@5': 0.021859407424926758}
INFO    [11-27 15:18:40] train in BasicTrainer:
duration: 5.329556226730347s
INFO    [11-27 15:18:40] train in BasicTrainer:
epoch: 8
INFO    [11-27 15:18:44] _train_one_epoch in BasicTrainer:
loss = 5.0491185096594
INFO    [11-27 15:18:45] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [11-27 15:18:45] validate in BasicTrainer:
{'Recall@10': 0.06509322673082352, 'NDCG@10': 0.03560175746679306, 'MRR@10': 0.026693088002502918, 'Recall@5': 0.04204142652451992, 'NDCG@5': 0.028211122378706932, 'MRR@5': 0.023679111152887344, 'Recall*@10': 0.06509322673082352, 'NDCG*@10': 0.03560175746679306, 'MRR*@10': 0.026693088002502918, 'Recall*@5': 0.04204142652451992, 'NDCG*@5': 0.028211122378706932, 'MRR*@5': 0.023679111152887344}
INFO    [11-27 15:18:45] train in BasicTrainer:
duration: 5.372223615646362s
INFO    [11-27 15:18:45] train in BasicTrainer:
epoch: 9
INFO    [11-27 15:18:50] _train_one_epoch in BasicTrainer:
loss = 4.9963867114140434
INFO    [11-27 15:18:51] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [11-27 15:18:51] validate in BasicTrainer:
{'Recall@10': 0.07473985850811005, 'NDCG@10': 0.039691852405667305, 'MRR@10': 0.029149668291211128, 'Recall@5': 0.048721443861722946, 'NDCG@5': 0.03135637007653713, 'MRR@5': 0.025759367272257805, 'Recall*@10': 0.07473985850811005, 'NDCG*@10': 0.039691852405667305, 'MRR*@10': 0.029149668291211128, 'Recall*@5': 0.048721443861722946, 'NDCG*@5': 0.03135637007653713, 'MRR*@5': 0.025759367272257805}
INFO    [11-27 15:18:51] train in BasicTrainer:
duration: 5.666707754135132s
INFO    [11-27 15:18:51] train in BasicTrainer:
epoch: 10
INFO    [11-27 15:18:55] _train_one_epoch in BasicTrainer:
loss = 4.932368902059702
INFO    [11-27 15:18:56] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [11-27 15:18:56] validate in BasicTrainer:
{'Recall@10': 0.08648733049631119, 'NDCG@10': 0.04438794404268265, 'MRR@10': 0.0316815497353673, 'Recall@5': 0.05525374412536621, 'NDCG@5': 0.03441521152853966, 'MRR@5': 0.027638361789286137, 'Recall*@10': 0.08648733049631119, 'NDCG*@10': 0.04438794404268265, 'MRR*@10': 0.0316815497353673, 'Recall*@5': 0.05525374412536621, 'NDCG*@5': 0.03441521152853966, 'MRR*@5': 0.027638361789286137}
INFO    [11-27 15:18:56] train in BasicTrainer:
duration: 5.14632248878479s
INFO    [11-27 15:18:56] train in BasicTrainer:
epoch: 11
INFO    [11-27 15:19:00] _train_one_epoch in BasicTrainer:
loss = 4.865377380297734
INFO    [11-27 15:19:01] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [11-27 15:19:01] validate in BasicTrainer:
{'Recall@10': 0.0920799970626831, 'NDCG@10': 0.04754672385752201, 'MRR@10': 0.034097058698534966, 'Recall@5': 0.05619337782263756, 'NDCG@5': 0.035962900146842, 'MRR@5': 0.02932580281049013, 'Recall*@10': 0.0920799970626831, 'NDCG*@10': 0.04754672385752201, 'MRR*@10': 0.034097058698534966, 'Recall*@5': 0.05619337782263756, 'NDCG*@5': 0.035962900146842, 'MRR*@5': 0.02932580281049013}
INFO    [11-27 15:19:01] train in BasicTrainer:
duration: 5.209004640579224s
INFO    [11-27 15:19:01] train in BasicTrainer:
epoch: 12
INFO    [11-27 15:19:05] _train_one_epoch in BasicTrainer:
loss = 4.809024957510141
INFO    [11-27 15:19:07] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [11-27 15:19:07] validate in BasicTrainer:
{'Recall@10': 0.09767266362905502, 'NDCG@10': 0.05119314230978489, 'MRR@10': 0.037129998207092285, 'Recall@5': 0.06433823704719543, 'NDCG@5': 0.04057263769209385, 'MRR@5': 0.0328379413112998, 'Recall*@10': 0.09767266362905502, 'NDCG*@10': 0.05119314230978489, 'MRR*@10': 0.037129998207092285, 'Recall*@5': 0.06433823704719543, 'NDCG*@5': 0.04057263769209385, 'MRR*@5': 0.0328379413112998}
INFO    [11-27 15:19:07] train in BasicTrainer:
duration: 5.428534507751465s
INFO    [11-27 15:19:07] train in BasicTrainer:
epoch: 13
INFO    [11-27 15:19:11] _train_one_epoch in BasicTrainer:
loss = 4.763835100027231
INFO    [11-27 15:19:12] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [11-27 15:19:12] validate in BasicTrainer:
{'Recall@10': 0.10469324886798859, 'NDCG@10': 0.05320458300411701, 'MRR@10': 0.03765911050140858, 'Recall@5': 0.06467880308628082, 'NDCG@5': 0.040245065465569496, 'MRR@5': 0.03229802567511797, 'Recall*@10': 0.10469324886798859, 'NDCG*@10': 0.05320458300411701, 'MRR*@10': 0.03765911050140858, 'Recall*@5': 0.06467880308628082, 'NDCG*@5': 0.040245065465569496, 'MRR*@5': 0.03229802567511797}
INFO    [11-27 15:19:12] train in BasicTrainer:
duration: 5.627201557159424s
INFO    [11-27 15:19:12] train in BasicTrainer:
epoch: 14
INFO    [11-27 15:19:16] _train_one_epoch in BasicTrainer:
loss = 4.725849124101492
INFO    [11-27 15:19:18] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [11-27 15:19:18] validate in BasicTrainer:
{'Recall@10': 0.10893185809254646, 'NDCG@10': 0.05676152929663658, 'MRR@10': 0.041169773787260056, 'Recall@5': 0.06565536558628082, 'NDCG@5': 0.04289981536567211, 'MRR@5': 0.03552800230681896, 'Recall*@10': 0.10893185809254646, 'NDCG*@10': 0.05676152929663658, 'MRR*@10': 0.041169773787260056, 'Recall*@5': 0.06565536558628082, 'NDCG*@5': 0.04289981536567211, 'MRR*@5': 0.03552800230681896}
INFO    [11-27 15:19:18] train in BasicTrainer:
duration: 5.613534688949585s
INFO    [11-27 15:19:18] train in BasicTrainer:
epoch: 15
INFO    [11-27 15:19:22] _train_one_epoch in BasicTrainer:
loss = 4.689896656916692
INFO    [11-27 15:19:24] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [11-27 15:19:24] validate in BasicTrainer:
{'Recall@10': 0.11234982684254646, 'NDCG@10': 0.05914614163339138, 'MRR@10': 0.04301784001290798, 'Recall@5': 0.07075975090265274, 'NDCG@5': 0.045657411217689514, 'MRR@5': 0.03742641769349575, 'Recall*@10': 0.11234982684254646, 'NDCG*@10': 0.05914614163339138, 'MRR*@10': 0.04301784001290798, 'Recall*@5': 0.07075975090265274, 'NDCG*@5': 0.045657411217689514, 'MRR*@5': 0.03742641769349575}
INFO    [11-27 15:19:24] train in BasicTrainer:
duration: 5.627846956253052s
INFO    [11-27 15:19:24] train in BasicTrainer:
epoch: 16
INFO    [11-27 15:19:28] _train_one_epoch in BasicTrainer:
loss = 4.649790342037495
INFO    [11-27 15:19:29] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [11-27 15:19:29] validate in BasicTrainer:
{'Recall@10': 0.11636686325073242, 'NDCG@10': 0.06290675885975361, 'MRR@10': 0.046759553253650665, 'Recall@5': 0.07492450252175331, 'NDCG@5': 0.049588944762945175, 'MRR@5': 0.04131092131137848, 'Recall*@10': 0.11636686325073242, 'NDCG*@10': 0.06290675885975361, 'MRR*@10': 0.046759553253650665, 'Recall*@5': 0.07492450252175331, 'NDCG*@5': 0.049588944762945175, 'MRR*@5': 0.04131092131137848}
INFO    [11-27 15:19:29] train in BasicTrainer:
duration: 5.440358638763428s
INFO    [11-27 15:19:29] train in BasicTrainer:
epoch: 17
INFO    [11-27 15:19:33] _train_one_epoch in BasicTrainer:
loss = 4.614334785021269
INFO    [11-27 15:19:35] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [11-27 15:19:35] validate in BasicTrainer:
{'Recall@10': 0.11479123309254646, 'NDCG@10': 0.06304027885198593, 'MRR@10': 0.04729306325316429, 'Recall@5': 0.07481371611356735, 'NDCG@5': 0.05005414970219135, 'MRR@5': 0.04190273955464363, 'Recall*@10': 0.11479123309254646, 'NDCG*@10': 0.06304027885198593, 'MRR*@10': 0.04729306325316429, 'Recall*@5': 0.07481371611356735, 'NDCG*@5': 0.05005414970219135, 'MRR*@5': 0.04190273955464363}
INFO    [11-27 15:19:35] train in BasicTrainer:
duration: 5.522443532943726s
INFO    [11-27 15:19:35] train in BasicTrainer:
epoch: 18
INFO    [11-27 15:19:39] _train_one_epoch in BasicTrainer:
loss = 4.58447421514071
INFO    [11-27 15:19:40] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [11-27 15:19:40] validate in BasicTrainer:
{'Recall@10': 0.12072446569800377, 'NDCG@10': 0.06322585418820381, 'MRR@10': 0.045830413699150085, 'Recall@5': 0.07432543486356735, 'NDCG@5': 0.048258401453495026, 'MRR@5': 0.0396708007901907, 'Recall*@10': 0.12072446569800377, 'NDCG*@10': 0.06322585418820381, 'MRR*@10': 0.045830413699150085, 'Recall*@5': 0.07432543486356735, 'NDCG*@5': 0.048258401453495026, 'MRR*@5': 0.0396708007901907}
INFO    [11-27 15:19:40] train in BasicTrainer:
duration: 5.517205238342285s
INFO    [11-27 15:19:40] train in BasicTrainer:
epoch: 19
DEBUG   [11-27 15:19:41] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 2521303
DEBUG   [11-27 15:19:41] calculate_loss in loss:
pred max in softmax: 0.0909288078546524, argmax 2475036
DEBUG   [11-27 15:19:41] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 632157
DEBUG   [11-27 15:19:41] calculate_loss in loss:
pred max in softmax: 0.0865718424320221, argmax 2865265
INFO    [11-27 15:19:44] _train_one_epoch in BasicTrainer:
loss = 4.556457556211031
INFO    [11-27 15:19:45] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [11-27 15:19:45] validate in BasicTrainer:
{'Recall@10': 0.12658384069800377, 'NDCG@10': 0.0686672180891037, 'MRR@10': 0.05107967369258404, 'Recall@5': 0.08442341908812523, 'NDCG@5': 0.055090488865971565, 'MRR@5': 0.04550897516310215, 'Recall*@10': 0.12658384069800377, 'NDCG*@10': 0.0686672180891037, 'MRR*@10': 0.05107967369258404, 'Recall*@5': 0.08442341908812523, 'NDCG*@5': 0.055090488865971565, 'MRR*@5': 0.04550897516310215}
INFO    [11-27 15:19:45] train in BasicTrainer:
duration: 5.302860975265503s
INFO    [11-27 15:19:45] train in BasicTrainer:
epoch: 20
INFO    [11-27 15:19:49] _train_one_epoch in BasicTrainer:
loss = 4.529464419071491
INFO    [11-27 15:19:51] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [11-27 15:19:51] validate in BasicTrainer:
{'Recall@10': 0.12774504721164703, 'NDCG@10': 0.07060102373361588, 'MRR@10': 0.05330987833440304, 'Recall@5': 0.08292164653539658, 'NDCG@5': 0.05614727735519409, 'MRR@5': 0.04736950621008873, 'Recall*@10': 0.12774504721164703, 'NDCG*@10': 0.07060102373361588, 'MRR*@10': 0.05330987833440304, 'Recall*@5': 0.08292164653539658, 'NDCG*@5': 0.05614727735519409, 'MRR*@5': 0.04736950621008873}
INFO    [11-27 15:19:51] train in BasicTrainer:
duration: 5.283268928527832s
INFO    [11-27 15:19:51] train in BasicTrainer:
epoch: 21
INFO    [11-27 15:19:55] _train_one_epoch in BasicTrainer:
loss = 4.505633610945481
INFO    [11-27 15:19:56] validate in BasicTrainer:
{'Recall@10': 0.1263171322643757, 'NDCG@10': 0.06804068386554718, 'MRR@10': 0.05039329081773758, 'Recall@5': 0.08393513783812523, 'NDCG@5': 0.05440659075975418, 'MRR@5': 0.044806577265262604, 'Recall*@10': 0.1263171322643757, 'NDCG*@10': 0.06804068386554718, 'MRR*@10': 0.05039329081773758, 'Recall*@5': 0.08393513783812523, 'NDCG*@5': 0.05440659075975418, 'MRR*@5': 0.044806577265262604}
INFO    [11-27 15:19:56] train in BasicTrainer:
duration: 5.408141613006592s
INFO    [11-27 15:19:56] train in BasicTrainer:
epoch: 22
INFO    [11-27 15:20:00] _train_one_epoch in BasicTrainer:
loss = 4.482274495638334
INFO    [11-27 15:20:01] validate in BasicTrainer:
{'Recall@10': 0.12560727819800377, 'NDCG@10': 0.06809605099260807, 'MRR@10': 0.05064276605844498, 'Recall@5': 0.08093159273266792, 'NDCG@5': 0.05342305265367031, 'MRR@5': 0.04445294849574566, 'Recall*@10': 0.12560727819800377, 'NDCG*@10': 0.06809605099260807, 'MRR*@10': 0.05064276605844498, 'Recall*@5': 0.08093159273266792, 'NDCG*@5': 0.05342305265367031, 'MRR*@5': 0.04445294849574566}
INFO    [11-27 15:20:01] train in BasicTrainer:
duration: 5.3258867263793945s
INFO    [11-27 15:20:01] train in BasicTrainer:
epoch: 23
INFO    [11-27 15:20:06] _train_one_epoch in BasicTrainer:
loss = 4.461087630345271
INFO    [11-27 15:20:07] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [11-27 15:20:07] validate in BasicTrainer:
{'Recall@10': 0.1318359375, 'NDCG@10': 0.07090582326054573, 'MRR@10': 0.05241624638438225, 'Recall@5': 0.08784138783812523, 'NDCG@5': 0.056830111891031265, 'MRR@5': 0.04669213481247425, 'Recall*@10': 0.1318359375, 'NDCG*@10': 0.07090582326054573, 'MRR*@10': 0.05241624638438225, 'Recall*@5': 0.08784138783812523, 'NDCG*@5': 0.056830111891031265, 'MRR*@5': 0.04669213481247425}
INFO    [11-27 15:20:07] train in BasicTrainer:
duration: 5.583633899688721s
INFO    [11-27 15:20:07] train in BasicTrainer:
epoch: 24
INFO    [11-27 15:20:11] _train_one_epoch in BasicTrainer:
loss = 4.435630257313068
INFO    [11-27 15:20:13] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [11-27 15:20:13] validate in BasicTrainer:
{'Recall@10': 0.14039522409439087, 'NDCG@10': 0.07281820848584175, 'MRR@10': 0.05248798988759518, 'Recall@5': 0.08581440523266792, 'NDCG@5': 0.05540890619158745, 'MRR@5': 0.04544469155371189, 'Recall*@10': 0.14039522409439087, 'NDCG*@10': 0.07281820848584175, 'MRR*@10': 0.05248798988759518, 'Recall*@5': 0.08581440523266792, 'NDCG*@5': 0.05540890619158745, 'MRR*@5': 0.04544469155371189}
INFO    [11-27 15:20:13] train in BasicTrainer:
duration: 5.570259094238281s
INFO    [11-27 15:20:13] train in BasicTrainer:
epoch: 25
INFO    [11-27 15:20:17] _train_one_epoch in BasicTrainer:
loss = 4.415372821000906
INFO    [11-27 15:20:18] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [11-27 15:20:18] validate in BasicTrainer:
{'Recall@10': 0.13750246167182922, 'NDCG@10': 0.07358956336975098, 'MRR@10': 0.054199343547225, 'Recall@5': 0.08945394679903984, 'NDCG@5': 0.05818137712776661, 'MRR@5': 0.04791236110031605, 'Recall*@10': 0.13750246167182922, 'NDCG*@10': 0.07358956336975098, 'MRR*@10': 0.054199343547225, 'Recall*@5': 0.08945394679903984, 'NDCG*@5': 0.05818137712776661, 'MRR*@5': 0.04791236110031605}
INFO    [11-27 15:20:18] train in BasicTrainer:
duration: 5.5074622631073s
INFO    [11-27 15:20:18] train in BasicTrainer:
epoch: 26
INFO    [11-27 15:20:22] _train_one_epoch in BasicTrainer:
loss = 4.3924756325208225
INFO    [11-27 15:20:24] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [11-27 15:20:24] validate in BasicTrainer:
{'Recall@10': 0.13818359375, 'NDCG@10': 0.0754430890083313, 'MRR@10': 0.05639011040329933, 'Recall@5': 0.0919322818517685, 'NDCG@5': 0.06059869937598705, 'MRR@5': 0.05032709613442421, 'Recall*@10': 0.13818359375, 'NDCG*@10': 0.0754430890083313, 'MRR*@10': 0.05639011040329933, 'Recall*@5': 0.0919322818517685, 'NDCG*@5': 0.06059869937598705, 'MRR*@5': 0.05032709613442421}
INFO    [11-27 15:20:24] train in BasicTrainer:
duration: 5.593160390853882s
INFO    [11-27 15:20:24] train in BasicTrainer:
epoch: 27
INFO    [11-27 15:20:28] _train_one_epoch in BasicTrainer:
loss = 4.372601353205168
INFO    [11-27 15:20:29] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [11-27 15:20:29] validate in BasicTrainer:
{'Recall@10': 0.14358341693878174, 'NDCG@10': 0.07797053828835487, 'MRR@10': 0.05799757316708565, 'Recall@5': 0.09767266362905502, 'NDCG@5': 0.06338525749742985, 'MRR@5': 0.052133189514279366, 'Recall*@10': 0.14358341693878174, 'NDCG*@10': 0.07797053828835487, 'MRR*@10': 0.05799757316708565, 'Recall*@5': 0.09767266362905502, 'NDCG*@5': 0.06338525749742985, 'MRR*@5': 0.052133189514279366}
INFO    [11-27 15:20:29] train in BasicTrainer:
duration: 5.503917217254639s
INFO    [11-27 15:20:29] train in BasicTrainer:
epoch: 28
INFO    [11-27 15:20:33] _train_one_epoch in BasicTrainer:
loss = 4.352341340138362
INFO    [11-27 15:20:35] validate in BasicTrainer:
{'Recall@10': 0.14001773297786713, 'NDCG@10': 0.07703858241438866, 'MRR@10': 0.0578184500336647, 'Recall@5': 0.09515739977359772, 'NDCG@5': 0.06262770295143127, 'MRR@5': 0.05192768946290016, 'Recall*@10': 0.14001773297786713, 'NDCG*@10': 0.07703858241438866, 'MRR*@10': 0.0578184500336647, 'Recall*@5': 0.09515739977359772, 'NDCG*@5': 0.06262770295143127, 'MRR*@5': 0.05192768946290016}
INFO    [11-27 15:20:35] train in BasicTrainer:
duration: 5.509387493133545s
INFO    [11-27 15:20:35] train in BasicTrainer:
epoch: 29
INFO    [11-27 15:20:39] _train_one_epoch in BasicTrainer:
loss = 4.328847830112164
INFO    [11-27 15:20:40] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [11-27 15:20:40] validate in BasicTrainer:
{'Recall@10': 0.1456473246216774, 'NDCG@10': 0.08052204176783562, 'MRR@10': 0.0608378890901804, 'Recall@5': 0.09669610112905502, 'NDCG@5': 0.06499605625867844, 'MRR@5': 0.05460578016936779, 'Recall*@10': 0.1456473246216774, 'NDCG*@10': 0.08052204176783562, 'MRR*@10': 0.0608378890901804, 'Recall*@5': 0.09669610112905502, 'NDCG*@5': 0.06499605625867844, 'MRR*@5': 0.05460578016936779}
INFO    [11-27 15:20:40] train in BasicTrainer:
duration: 5.625893831253052s
INFO    [11-27 15:20:40] train in BasicTrainer:
epoch: 30
INFO    [11-27 15:20:44] _train_one_epoch in BasicTrainer:
loss = 4.31062388420105
INFO    [11-27 15:20:46] validate in BasicTrainer:
{'Recall@10': 0.14324285089969635, 'NDCG@10': 0.07903463020920753, 'MRR@10': 0.05948851257562637, 'Recall@5': 0.10116448998451233, 'NDCG@5': 0.06559954211115837, 'MRR@5': 0.05403919517993927, 'Recall*@10': 0.14324285089969635, 'NDCG*@10': 0.07903463020920753, 'MRR*@10': 0.05948851257562637, 'Recall*@5': 0.10116448998451233, 'NDCG*@5': 0.06559954211115837, 'MRR*@5': 0.05403919517993927}
INFO    [11-27 15:20:46] train in BasicTrainer:
duration: 5.348231554031372s
INFO    [11-27 15:20:46] train in BasicTrainer:
epoch: 31
INFO    [11-27 15:20:50] _train_one_epoch in BasicTrainer:
loss = 4.288610274975117
INFO    [11-27 15:20:51] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [11-27 15:20:51] validate in BasicTrainer:
{'Recall@10': 0.15217962861061096, 'NDCG@10': 0.08303983509540558, 'MRR@10': 0.062161896377801895, 'Recall@5': 0.09722131118178368, 'NDCG@5': 0.06528446450829506, 'MRR@5': 0.05484513193368912, 'Recall*@10': 0.15217962861061096, 'NDCG*@10': 0.08303983509540558, 'MRR*@10': 0.062161896377801895, 'Recall*@5': 0.09722131118178368, 'NDCG*@5': 0.06528446450829506, 'MRR*@5': 0.05484513193368912}
INFO    [11-27 15:20:51] train in BasicTrainer:
duration: 5.477456569671631s
INFO    [11-27 15:20:51] train in BasicTrainer:
epoch: 32
INFO    [11-27 15:20:55] _train_one_epoch in BasicTrainer:
loss = 4.2682487689531765
INFO    [11-27 15:20:57] validate in BasicTrainer:
{'Recall@10': 0.15266790986061096, 'NDCG@10': 0.08256448432803154, 'MRR@10': 0.061265287920832634, 'Recall@5': 0.10266626626253128, 'NDCG@5': 0.06648234277963638, 'MRR@5': 0.05468210205435753, 'Recall*@10': 0.15266790986061096, 'NDCG*@10': 0.08256448432803154, 'MRR*@10': 0.061265287920832634, 'Recall*@5': 0.10266626626253128, 'NDCG*@5': 0.06648234277963638, 'MRR*@5': 0.05468210205435753}
INFO    [11-27 15:20:57] train in BasicTrainer:
duration: 5.3628692626953125s
INFO    [11-27 15:20:57] train in BasicTrainer:
epoch: 33
INFO    [11-27 15:21:01] _train_one_epoch in BasicTrainer:
loss = 4.249317756065955
INFO    [11-27 15:21:02] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [11-27 15:21:02] validate in BasicTrainer:
{'Recall@10': 0.15480567514896393, 'NDCG@10': 0.08343971893191338, 'MRR@10': 0.06196330860257149, 'Recall@5': 0.09714745357632637, 'NDCG@5': 0.06490040197968483, 'MRR@5': 0.05437135323882103, 'Recall*@10': 0.15480567514896393, 'NDCG*@10': 0.08343971893191338, 'MRR*@10': 0.06196330860257149, 'Recall*@5': 0.09714745357632637, 'NDCG*@5': 0.06490040197968483, 'MRR*@5': 0.05437135323882103}
INFO    [11-27 15:21:02] train in BasicTrainer:
duration: 5.498351335525513s
INFO    [11-27 15:21:02] train in BasicTrainer:
epoch: 34
INFO    [11-27 15:21:06] _train_one_epoch in BasicTrainer:
loss = 4.22843808394212
INFO    [11-27 15:21:07] validate in BasicTrainer:
{'Recall@10': 0.1584821492433548, 'NDCG@10': 0.08290065079927444, 'MRR@10': 0.05988580919802189, 'Recall@5': 0.10529231652617455, 'NDCG@5': 0.06577438116073608, 'MRR@5': 0.05285931937396526, 'Recall*@10': 0.1584821492433548, 'NDCG*@10': 0.08290065079927444, 'MRR*@10': 0.05988580919802189, 'Recall*@5': 0.10529231652617455, 'NDCG*@5': 0.06577438116073608, 'MRR*@5': 0.05285931937396526}
INFO    [11-27 15:21:07] train in BasicTrainer:
duration: 5.3296263217926025s
INFO    [11-27 15:21:07] train in BasicTrainer:
epoch: 35
INFO    [11-27 15:21:11] _train_one_epoch in BasicTrainer:
loss = 4.2096573664591865
INFO    [11-27 15:21:13] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [11-27 15:21:13] validate in BasicTrainer:
{'Recall@10': 0.1649775207042694, 'NDCG@10': 0.08496006950736046, 'MRR@10': 0.06080915592610836, 'Recall@5': 0.10675716027617455, 'NDCG@5': 0.06650847941637039, 'MRR@5': 0.05341208912432194, 'Recall*@10': 0.1649775207042694, 'NDCG*@10': 0.08496006950736046, 'MRR*@10': 0.06080915592610836, 'Recall*@5': 0.10675716027617455, 'NDCG*@5': 0.06650847941637039, 'MRR*@5': 0.05341208912432194}
INFO    [11-27 15:21:13] train in BasicTrainer:
duration: 5.456033706665039s
INFO    [11-27 15:21:13] train in BasicTrainer:
epoch: 36
INFO    [11-27 15:21:17] _train_one_epoch in BasicTrainer:
loss = 4.191078479473408
INFO    [11-27 15:21:18] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [11-27 15:21:18] validate in BasicTrainer:
{'Recall@10': 0.15780922025442123, 'NDCG@10': 0.08554558828473091, 'MRR@10': 0.06344745866954327, 'Recall@5': 0.1073562279343605, 'NDCG@5': 0.06932907924056053, 'MRR@5': 0.05681460350751877, 'Recall*@10': 0.15780922025442123, 'NDCG*@10': 0.08554558828473091, 'MRR*@10': 0.06344745866954327, 'Recall*@5': 0.1073562279343605, 'NDCG*@5': 0.06932907924056053, 'MRR*@5': 0.05681460350751877}
INFO    [11-27 15:21:18] train in BasicTrainer:
duration: 5.571345567703247s
INFO    [11-27 15:21:18] train in BasicTrainer:
epoch: 37
INFO    [11-27 15:21:23] _train_one_epoch in BasicTrainer:
loss = 4.175740608802209
INFO    [11-27 15:21:24] validate in BasicTrainer:
{'Recall@10': 0.15581917017698288, 'NDCG@10': 0.08427290618419647, 'MRR@10': 0.06229175254702568, 'Recall@5': 0.10878414288163185, 'NDCG@5': 0.06909260898828506, 'MRR@5': 0.056041011586785316, 'Recall*@10': 0.15581917017698288, 'NDCG*@10': 0.08427290618419647, 'MRR*@10': 0.06229175254702568, 'Recall*@5': 0.10878414288163185, 'NDCG*@5': 0.06909260898828506, 'MRR*@5': 0.056041011586785316}
INFO    [11-27 15:21:24] train in BasicTrainer:
duration: 5.676866292953491s
INFO    [11-27 15:21:24] train in BasicTrainer:
epoch: 38
DEBUG   [11-27 15:21:26] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 1219324
DEBUG   [11-27 15:21:26] calculate_loss in loss:
pred max in softmax: 0.12551890313625336, argmax 3662975
DEBUG   [11-27 15:21:26] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 883800
DEBUG   [11-27 15:21:26] calculate_loss in loss:
pred max in softmax: 0.1368156522512436, argmax 1754479
INFO    [11-27 15:21:28] _train_one_epoch in BasicTrainer:
loss = 4.158403955973112
INFO    [11-27 15:21:30] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [11-27 15:21:30] validate in BasicTrainer:
{'Recall@10': 0.16437844932079315, 'NDCG@10': 0.08808556199073792, 'MRR@10': 0.06485438533127308, 'Recall@5': 0.10822200402617455, 'NDCG@5': 0.07003667205572128, 'MRR@5': 0.0574729610234499, 'Recall*@10': 0.16437844932079315, 'NDCG*@10': 0.08808556199073792, 'MRR*@10': 0.06485438533127308, 'Recall*@5': 0.10822200402617455, 'NDCG*@5': 0.07003667205572128, 'MRR*@5': 0.0574729610234499}
INFO    [11-27 15:21:30] train in BasicTrainer:
duration: 5.516567230224609s
INFO    [11-27 15:21:30] train in BasicTrainer:
epoch: 39
INFO    [11-27 15:21:34] _train_one_epoch in BasicTrainer:
loss = 4.142798973963811
INFO    [11-27 15:21:35] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [11-27 15:21:35] validate in BasicTrainer:
{'Recall@10': 0.16403788328170776, 'NDCG@10': 0.08868337795138359, 'MRR@10': 0.06578054279088974, 'Recall@5': 0.1082589328289032, 'NDCG@5': 0.07081768289208412, 'MRR@5': 0.058506082743406296, 'Recall*@10': 0.16403788328170776, 'NDCG*@10': 0.08868337795138359, 'MRR*@10': 0.06578054279088974, 'Recall*@5': 0.1082589328289032, 'NDCG*@5': 0.07081768289208412, 'MRR*@5': 0.058506082743406296}
INFO    [11-27 15:21:35] train in BasicTrainer:
duration: 5.827484607696533s
INFO    [11-27 15:21:35] train in BasicTrainer:
epoch: 40
INFO    [11-27 15:21:40] _train_one_epoch in BasicTrainer:
loss = 4.126303755320036
INFO    [11-27 15:21:41] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [11-27 15:21:41] validate in BasicTrainer:
{'Recall@10': 0.16903148591518402, 'NDCG@10': 0.09061487019062042, 'MRR@10': 0.06685055792331696, 'Recall@5': 0.11084805428981781, 'NDCG@5': 0.0719696655869484, 'MRR@5': 0.059250131249427795, 'Recall*@10': 0.16903148591518402, 'NDCG*@10': 0.09061487019062042, 'MRR*@10': 0.06685055792331696, 'Recall*@5': 0.11084805428981781, 'NDCG*@5': 0.0719696655869484, 'MRR*@5': 0.059250131249427795}
INFO    [11-27 15:21:41] train in BasicTrainer:
duration: 5.860529661178589s
INFO    [11-27 15:21:41] train in BasicTrainer:
epoch: 41
INFO    [11-27 15:21:45] _train_one_epoch in BasicTrainer:
loss = 4.110805419775156
INFO    [11-27 15:21:47] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [11-27 15:21:47] validate in BasicTrainer:
{'Recall@10': 0.1649775207042694, 'NDCG@10': 0.09177757427096367, 'MRR@10': 0.06943973153829575, 'Recall@5': 0.11227596923708916, 'NDCG@5': 0.0748342014849186, 'MRR@5': 0.06250807084143162, 'Recall*@10': 0.1649775207042694, 'NDCG*@10': 0.09177757427096367, 'MRR*@10': 0.06943973153829575, 'Recall*@5': 0.11227596923708916, 'NDCG*@5': 0.0748342014849186, 'MRR*@5': 0.06250807084143162}
INFO    [11-27 15:21:47] train in BasicTrainer:
duration: 5.394412279129028s
INFO    [11-27 15:21:47] train in BasicTrainer:
epoch: 42
INFO    [11-27 15:21:50] _train_one_epoch in BasicTrainer:
loss = 4.098375613872822
INFO    [11-27 15:21:52] validate in BasicTrainer:
{'Recall@10': 0.1658063679933548, 'NDCG@10': 0.09104987606406212, 'MRR@10': 0.06820876523852348, 'Recall@5': 0.11186154559254646, 'NDCG@5': 0.07360268756747246, 'MRR@5': 0.0610054787248373, 'Recall*@10': 0.1658063679933548, 'NDCG*@10': 0.09104987606406212, 'MRR*@10': 0.06820876523852348, 'Recall*@5': 0.11186154559254646, 'NDCG*@5': 0.07360268756747246, 'MRR*@5': 0.0610054787248373}
INFO    [11-27 15:21:52] train in BasicTrainer:
duration: 5.171094179153442s
INFO    [11-27 15:21:52] train in BasicTrainer:
epoch: 43
INFO    [11-27 15:21:56] _train_one_epoch in BasicTrainer:
loss = 4.0855622841761665
INFO    [11-27 15:21:57] validate in BasicTrainer:
{'Recall@10': 0.16494058817625046, 'NDCG@10': 0.09159089997410774, 'MRR@10': 0.06911014765501022, 'Recall@5': 0.11692900210618973, 'NDCG@5': 0.07620178908109665, 'MRR@5': 0.06283940561115742, 'Recall*@10': 0.16494058817625046, 'NDCG*@10': 0.09159089997410774, 'MRR*@10': 0.06911014765501022, 'Recall*@5': 0.11692900210618973, 'NDCG*@5': 0.07620178908109665, 'MRR*@5': 0.06283940561115742}
INFO    [11-27 15:21:57] train in BasicTrainer:
duration: 5.026352643966675s
INFO    [11-27 15:21:57] train in BasicTrainer:
epoch: 44
INFO    [11-27 15:22:01] _train_one_epoch in BasicTrainer:
loss = 4.071868314192845
INFO    [11-27 15:22:02] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [11-27 15:22:03] validate in BasicTrainer:
{'Recall@10': 0.1648298054933548, 'NDCG@10': 0.09270607680082321, 'MRR@10': 0.0704711489379406, 'Recall@5': 0.11783170700073242, 'NDCG@5': 0.0775422640144825, 'MRR@5': 0.06423141807317734, 'Recall*@10': 0.1648298054933548, 'NDCG*@10': 0.09270607680082321, 'MRR*@10': 0.0704711489379406, 'Recall*@5': 0.11783170700073242, 'NDCG*@5': 0.0775422640144825, 'MRR*@5': 0.06423141807317734}
INFO    [11-27 15:22:03] train in BasicTrainer:
duration: 5.6576762199401855s
INFO    [11-27 15:22:03] train in BasicTrainer:
epoch: 45
INFO    [11-27 15:22:07] _train_one_epoch in BasicTrainer:
loss = 4.059228585316585
INFO    [11-27 15:22:08] validate in BasicTrainer:
{'Recall@10': 0.16550272703170776, 'NDCG@10': 0.09164568036794662, 'MRR@10': 0.06900002434849739, 'Recall@5': 0.11227596923708916, 'NDCG@5': 0.07437016814947128, 'MRR@5': 0.061830634251236916, 'Recall*@10': 0.16550272703170776, 'NDCG*@10': 0.09164568036794662, 'MRR*@10': 0.06900002434849739, 'Recall*@5': 0.11227596923708916, 'NDCG*@5': 0.07437016814947128, 'MRR*@5': 0.061830634251236916}
INFO    [11-27 15:22:08] train in BasicTrainer:
duration: 5.470059633255005s
INFO    [11-27 15:22:08] train in BasicTrainer:
epoch: 46
INFO    [11-27 15:22:12] _train_one_epoch in BasicTrainer:
loss = 4.046433421281668
INFO    [11-27 15:22:14] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [11-27 15:22:14] validate in BasicTrainer:
{'Recall@10': 0.16835855692625046, 'NDCG@10': 0.09440934285521507, 'MRR@10': 0.07183140516281128, 'Recall@5': 0.11644072085618973, 'NDCG@5': 0.07766404747962952, 'MRR@5': 0.06494086235761642, 'Recall*@10': 0.16835855692625046, 'NDCG*@10': 0.09440934285521507, 'MRR*@10': 0.07183140516281128, 'Recall*@5': 0.11644072085618973, 'NDCG*@5': 0.07766404747962952, 'MRR*@5': 0.06494086235761642}
INFO    [11-27 15:22:14] train in BasicTrainer:
duration: 5.720038652420044s
INFO    [11-27 15:22:14] train in BasicTrainer:
epoch: 47
INFO    [11-27 15:22:18] _train_one_epoch in BasicTrainer:
loss = 4.032333915050213
INFO    [11-27 15:22:19] validate in BasicTrainer:
{'Recall@10': 0.16550272703170776, 'NDCG@10': 0.09136234223842621, 'MRR@10': 0.06870725750923157, 'Recall@5': 0.11035977303981781, 'NDCG@5': 0.07356275618076324, 'MRR@5': 0.061377229169011116, 'Recall*@10': 0.16550272703170776, 'NDCG*@10': 0.09136234223842621, 'MRR*@10': 0.06870725750923157, 'Recall*@5': 0.11035977303981781, 'NDCG*@5': 0.07356275618076324, 'MRR*@5': 0.061377229169011116}
INFO    [11-27 15:22:19] train in BasicTrainer:
duration: 5.150160074234009s
INFO    [11-27 15:22:19] train in BasicTrainer:
epoch: 48
INFO    [11-27 15:22:23] _train_one_epoch in BasicTrainer:
loss = 4.020640634573423
INFO    [11-27 15:22:24] validate in BasicTrainer:
{'Recall@10': 0.1679072082042694, 'NDCG@10': 0.09288262203335762, 'MRR@10': 0.06986704468727112, 'Recall@5': 0.11621914803981781, 'NDCG@5': 0.07613293081521988, 'MRR@5': 0.06293555721640587, 'Recall*@10': 0.1679072082042694, 'NDCG*@10': 0.09288262203335762, 'MRR*@10': 0.06986704468727112, 'Recall*@5': 0.11621914803981781, 'NDCG*@5': 0.07613293081521988, 'MRR*@5': 0.06293555721640587}
INFO    [11-27 15:22:24] train in BasicTrainer:
duration: 5.537856340408325s
INFO    [11-27 15:22:24] train in BasicTrainer:
epoch: 49
INFO    [11-27 15:22:28] _train_one_epoch in BasicTrainer:
loss = 4.0094054112067585
INFO    [11-27 15:22:30] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [11-27 15:22:30] validate in BasicTrainer:
{'Recall@10': 0.17113232612609863, 'NDCG@10': 0.09552071243524551, 'MRR@10': 0.07234583795070648, 'Recall@5': 0.11794249340891838, 'NDCG@5': 0.07837064936757088, 'MRR@5': 0.06529216468334198, 'Recall*@10': 0.17113232612609863, 'NDCG*@10': 0.09552071243524551, 'MRR*@10': 0.07234583795070648, 'Recall*@5': 0.11794249340891838, 'NDCG*@5': 0.07837064936757088, 'MRR*@5': 0.06529216468334198}
INFO    [11-27 15:22:30] train in BasicTrainer:
duration: 5.501798629760742s
INFO    [11-27 15:22:30] train in BasicTrainer:
epoch: 50
INFO    [11-27 15:22:34] _train_one_epoch in BasicTrainer:
loss = 4.000979033800272
INFO    [11-27 15:22:35] validate in BasicTrainer:
{'Recall@10': 0.1693720519542694, 'NDCG@10': 0.09468498453497887, 'MRR@10': 0.0719367042183876, 'Recall@5': 0.11576779559254646, 'NDCG@5': 0.07744939252734184, 'MRR@5': 0.06488123163580894, 'Recall*@10': 0.1693720519542694, 'NDCG*@10': 0.09468498453497887, 'MRR*@10': 0.0719367042183876, 'Recall*@5': 0.11576779559254646, 'NDCG*@5': 0.07744939252734184, 'MRR*@5': 0.06488123163580894}
INFO    [11-27 15:22:35] train in BasicTrainer:
duration: 5.32054328918457s
INFO    [11-27 15:22:35] train in BasicTrainer:
epoch: 51
INFO    [11-27 15:22:39] _train_one_epoch in BasicTrainer:
loss = 3.9850349380419803
INFO    [11-27 15:22:41] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [11-27 15:22:41] validate in BasicTrainer:
{'Recall@10': 0.17387736588716507, 'NDCG@10': 0.09563470631837845, 'MRR@10': 0.07184810936450958, 'Recall@5': 0.11527951434254646, 'NDCG@5': 0.07683954760432243, 'MRR@5': 0.06417875923216343, 'Recall*@10': 0.17387736588716507, 'NDCG*@10': 0.09563470631837845, 'MRR*@10': 0.07184810936450958, 'Recall*@5': 0.11527951434254646, 'NDCG*@5': 0.07683954760432243, 'MRR*@5': 0.06417875923216343}
INFO    [11-27 15:22:41] train in BasicTrainer:
duration: 5.432051658630371s
INFO    [11-27 15:22:41] train in BasicTrainer:
epoch: 52
INFO    [11-27 15:22:45] _train_one_epoch in BasicTrainer:
loss = 3.9773622705386233
INFO    [11-27 15:22:46] log in loggers:
Update Best NDCG@10 Model at 52
INFO    [11-27 15:22:46] validate in BasicTrainer:
{'Recall@10': 0.17241252213716507, 'NDCG@10': 0.09703508019447327, 'MRR@10': 0.07388030737638474, 'Recall@5': 0.12440093606710434, 'NDCG@5': 0.08161453902721405, 'MRR@5': 0.06757840141654015, 'Recall*@10': 0.17241252213716507, 'NDCG*@10': 0.09703508019447327, 'MRR*@10': 0.07388030737638474, 'Recall*@5': 0.12440093606710434, 'NDCG*@5': 0.08161453902721405, 'MRR*@5': 0.06757840141654015}
INFO    [11-27 15:22:46] train in BasicTrainer:
duration: 5.5725250244140625s
INFO    [11-27 15:22:46] train in BasicTrainer:
epoch: 53
INFO    [11-27 15:22:50] _train_one_epoch in BasicTrainer:
loss = 3.966127487329336
INFO    [11-27 15:22:52] log in loggers:
Update Best NDCG@10 Model at 53
INFO    [11-27 15:22:52] validate in BasicTrainer:
{'Recall@10': 0.17492778599262238, 'NDCG@10': 0.09919459372758865, 'MRR@10': 0.07606589421629906, 'Recall@5': 0.123046875, 'NDCG@5': 0.08250795677304268, 'MRR@5': 0.06923096626996994, 'Recall*@10': 0.17492778599262238, 'NDCG*@10': 0.09919459372758865, 'MRR*@10': 0.07606589421629906, 'Recall*@5': 0.123046875, 'NDCG*@5': 0.08250795677304268, 'MRR*@5': 0.06923096626996994}
INFO    [11-27 15:22:52] train in BasicTrainer:
duration: 5.46465539932251s
INFO    [11-27 15:22:52] train in BasicTrainer:
epoch: 54
INFO    [11-27 15:22:56] _train_one_epoch in BasicTrainer:
loss = 3.958467428500836
INFO    [11-27 15:22:57] log in loggers:
Update Best NDCG@10 Model at 54
INFO    [11-27 15:22:57] validate in BasicTrainer:
{'Recall@10': 0.17706555873155594, 'NDCG@10': 0.09947073087096214, 'MRR@10': 0.07576489076018333, 'Recall@5': 0.12034697085618973, 'NDCG@5': 0.08125399425625801, 'MRR@5': 0.06832128390669823, 'Recall*@10': 0.17706555873155594, 'NDCG*@10': 0.09947073087096214, 'MRR*@10': 0.07576489076018333, 'Recall*@5': 0.12034697085618973, 'NDCG*@5': 0.08125399425625801, 'MRR*@5': 0.06832128390669823}
INFO    [11-27 15:22:57] train in BasicTrainer:
duration: 5.397329568862915s
INFO    [11-27 15:22:57] train in BasicTrainer:
epoch: 55
INFO    [11-27 15:23:01] _train_one_epoch in BasicTrainer:
loss = 3.945072435415708
INFO    [11-27 15:23:02] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [11-27 15:23:02] validate in BasicTrainer:
{'Recall@10': 0.16944590955972672, 'NDCG@10': 0.09974396973848343, 'MRR@10': 0.07821082696318626, 'Recall@5': 0.12383879721164703, 'NDCG@5': 0.08498979359865189, 'MRR@5': 0.07211558520793915, 'Recall*@10': 0.16944590955972672, 'NDCG*@10': 0.09974396973848343, 'MRR*@10': 0.07821082696318626, 'Recall*@5': 0.12383879721164703, 'NDCG*@5': 0.08498979359865189, 'MRR*@5': 0.07211558520793915}
INFO    [11-27 15:23:02] train in BasicTrainer:
duration: 5.321997165679932s
INFO    [11-27 15:23:02] train in BasicTrainer:
epoch: 56
INFO    [11-27 15:23:06] _train_one_epoch in BasicTrainer:
loss = 3.93387979727525
INFO    [11-27 15:23:08] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [11-27 15:23:08] validate in BasicTrainer:
{'Recall@10': 0.18202222883701324, 'NDCG@10': 0.10064075142145157, 'MRR@10': 0.07584347203373909, 'Recall@5': 0.12090910971164703, 'NDCG@5': 0.08096573501825333, 'MRR@5': 0.06776893138885498, 'Recall*@10': 0.18202222883701324, 'NDCG*@10': 0.10064075142145157, 'MRR*@10': 0.07584347203373909, 'Recall*@5': 0.12090910971164703, 'NDCG*@5': 0.08096573501825333, 'MRR*@5': 0.06776893138885498}
INFO    [11-27 15:23:08] train in BasicTrainer:
duration: 5.371397256851196s
INFO    [11-27 15:23:08] train in BasicTrainer:
epoch: 57
DEBUG   [11-27 15:23:11] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 1470967
DEBUG   [11-27 15:23:11] calculate_loss in loss:
pred max in softmax: 0.19996802508831024, argmax 2118036
DEBUG   [11-27 15:23:11] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 460748
DEBUG   [11-27 15:23:11] calculate_loss in loss:
pred max in softmax: 0.2254713475704193, argmax 3270488
INFO    [11-27 15:23:12] _train_one_epoch in BasicTrainer:
loss = 3.9233810351445126
INFO    [11-27 15:23:13] validate in BasicTrainer:
{'Recall@10': 0.17560071498155594, 'NDCG@10': 0.09925388172268867, 'MRR@10': 0.07577833533287048, 'Recall@5': 0.12353515625, 'NDCG@5': 0.0824212022125721, 'MRR@5': 0.06883767247200012, 'Recall*@10': 0.17560071498155594, 'NDCG*@10': 0.09925388172268867, 'MRR*@10': 0.07577833533287048, 'Recall*@5': 0.12353515625, 'NDCG*@5': 0.0824212022125721, 'MRR*@5': 0.06883767247200012}
INFO    [11-27 15:23:13] train in BasicTrainer:
duration: 5.39481258392334s
INFO    [11-27 15:23:13] train in BasicTrainer:
epoch: 58
INFO    [11-27 15:23:17] _train_one_epoch in BasicTrainer:
loss = 3.9155673063718357
INFO    [11-27 15:23:19] validate in BasicTrainer:
{'Recall@10': 0.17597820609807968, 'NDCG@10': 0.09909196197986603, 'MRR@10': 0.07536454126238823, 'Recall@5': 0.1265387013554573, 'NDCG@5': 0.08306369557976723, 'MRR@5': 0.0687296912074089, 'Recall*@10': 0.17597820609807968, 'NDCG*@10': 0.09909196197986603, 'MRR*@10': 0.07536454126238823, 'Recall*@5': 0.1265387013554573, 'NDCG*@5': 0.08306369557976723, 'MRR*@5': 0.0687296912074089}
INFO    [11-27 15:23:19] train in BasicTrainer:
duration: 5.320638656616211s
INFO    [11-27 15:23:19] train in BasicTrainer:
epoch: 59
INFO    [11-27 15:23:23] _train_one_epoch in BasicTrainer:
loss = 3.9053233174177318
INFO    [11-27 15:23:24] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [11-27 15:23:24] validate in BasicTrainer:
{'Recall@10': 0.1795438900589943, 'NDCG@10': 0.10158495977520943, 'MRR@10': 0.0778200663626194, 'Recall@5': 0.12342437356710434, 'NDCG@5': 0.08354923129081726, 'MRR@5': 0.07043922320008278, 'Recall*@10': 0.1795438900589943, 'NDCG*@10': 0.10158495977520943, 'MRR*@10': 0.0778200663626194, 'Recall*@5': 0.12342437356710434, 'NDCG*@5': 0.08354923129081726, 'MRR*@5': 0.07043922320008278}
INFO    [11-27 15:23:24] train in BasicTrainer:
duration: 5.486226797103882s
INFO    [11-27 15:23:24] close_training in BasicTrainer:
finished training
DEBUG   [11-27 15:23:24] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3121 times, ratio nan / (nan + not_nan) = 0.0
INFO    [11-27 15:23:24] run_routine in Routine:
Finished training, Start final validation
INFO    [11-27 15:23:24] final_validate in BasicTrainer:
validate model on val set!
INFO    [11-27 15:23:24] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [11-27 15:23:24] load_state_from_given_path in utils:
Loading model's parameters
INFO    [11-27 15:23:26] validate in BasicTrainer:
{'Recall@10': 0.1795438900589943, 'NDCG@10': 0.10158495977520943, 'MRR@10': 0.0778200663626194, 'Recall@5': 0.12342437356710434, 'NDCG@5': 0.08354923129081726, 'MRR@5': 0.07043922320008278, 'Recall*@10': 0.1795438900589943, 'NDCG*@10': 0.10158495977520943, 'MRR*@10': 0.0778200663626194, 'Recall*@5': 0.12342437356710434, 'NDCG*@5': 0.08354923129081726, 'MRR*@5': 0.07043922320008278}
INFO    [11-27 15:23:26] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.1795438900589943, 'NDCG@10': 0.10158495977520943, 'MRR@10': 0.0778200663626194, 'Recall@5': 0.12342437356710434, 'NDCG@5': 0.08354923129081726, 'MRR@5': 0.07043922320008278, 'Recall*@10': 0.1795438900589943, 'NDCG*@10': 0.10158495977520943, 'MRR*@10': 0.0778200663626194, 'Recall*@5': 0.12342437356710434, 'NDCG*@5': 0.08354923129081726, 'MRR*@5': 0.07043922320008278}
INFO    [11-27 15:23:26] _evaluate in DistillSched:
Start testing student model on test set
INFO    [11-27 15:23:26] test in BasicTrainer:
Test model on test set!
INFO    [11-27 15:23:26] test_with_given_state_path in BasicTrainer:
Loading model params from _____lfms_soft_len_3/soft_gru4rec-len-40_11-27_15-17_t7/student_gru4rec_logs/checkpoint/best_acc_model.pth.
INFO    [11-27 15:23:26] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [11-27 15:23:26] load_state_from_given_path in utils:
Loading model's parameters
INFO    [11-27 15:23:26] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [11-27 15:23:27] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.13705111294984818, 'NDCG@10': 0.07702376320958138, 'MRR@10': 0.058663973584771156, 'Recall@5': 0.09275292232632637, 'NDCG@5': 0.0624876469373703, 'MRR@5': 0.052542757242918015, 'Recall*@10': 0.13705111294984818, 'NDCG*@10': 0.07702376320958138, 'MRR*@10': 0.058663973584771156, 'Recall*@5': 0.09275292232632637, 'NDCG*@5': 0.0624876469373703, 'MRR*@5': 0.052542757242918015}
INFO    [11-27 15:23:27] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.13705111294984818, 'NDCG@10': 0.07702376320958138, 'MRR@10': 0.058663973584771156, 'Recall@5': 0.09275292232632637, 'NDCG@5': 0.0624876469373703, 'MRR@5': 0.052542757242918015, 'Recall*@10': 0.13705111294984818, 'NDCG*@10': 0.07702376320958138, 'MRR*@10': 0.058663973584771156, 'Recall*@5': 0.09275292232632637, 'NDCG*@5': 0.0624876469373703, 'MRR*@5': 0.052542757242918015}
