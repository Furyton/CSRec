INFO    [05-06 23:41:30] setup_train in utils:
{
    "experiment_dir": "___lfms_soft_2020",
    "experiment_description": "soft",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "lastfm_small.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "dvae_alpha": 0.5,
    "alpha": 0.5,
    "T": 3,
    "num_epochs": 80,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 20,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2020,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 256,
    "val_batch_size": 256,
    "test_batch_size": 256,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.lastfm_small/narm/config_distill.json",
    "task_id": -1,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-06 23:41:30] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-06 23:41:30] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/lastfm_small-5-5.pkl
INFO    [05-06 23:41:31] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-06 23:41:31] _check_dataset_cache in utils:
correct.
INFO    [05-06 23:41:31] __init__ in NextItemDataloader:
there are 3646 items in this dataset, 3173 users, padding_first? False
DEBUG   [05-06 23:41:32] generate_model in utils:
model_code_list=['pop']
INFO    [05-06 23:41:32] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-06 23:41:32] load_model_config in utils:
{}
WARNING [05-06 23:41:35] get_exist_path in utils:
dir ___lfms_soft_2020/soft_narm-T-3-al-0.5_05-06_23:41_0/teacher_pop_logs does not exist! Create one.
WARNING [05-06 23:41:35] get_exist_path in utils:
dir ___lfms_soft_2020/soft_narm-T-3-al-0.5_05-06_23:41_0/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-06 23:41:35] get_exist_path in utils:
dir ___lfms_soft_2020/soft_narm-T-3-al-0.5_05-06_23:41_0/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-06 23:41:35] get_path in utils:
Path is None
WARNING [05-06 23:41:35] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-06 23:41:35] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-06 23:41:35] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-06 23:41:35] __init__ in BasicTrainer:
48128 iter per epoch
DEBUG   [05-06 23:41:35] generate_model in utils:
model_code_list=['narm']
INFO    [05-06 23:41:35] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-06 23:41:35] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-06 23:41:36] get_exist_path in utils:
dir ___lfms_soft_2020/soft_narm-T-3-al-0.5_05-06_23:41_0/student_narm_logs does not exist! Create one.
WARNING [05-06 23:41:36] get_exist_path in utils:
dir ___lfms_soft_2020/soft_narm-T-3-al-0.5_05-06_23:41_0/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-06 23:41:36] get_exist_path in utils:
dir ___lfms_soft_2020/soft_narm-T-3-al-0.5_05-06_23:41_0/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-06 23:41:36] get_path in utils:
Path is None
WARNING [05-06 23:41:36] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-06 23:41:36] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(3647, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-06 23:41:36] assert_model_device in utils:
model student_narm has 1.359619140625 MB params.
INFO    [05-06 23:41:36] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-06 23:41:36] __init__ in DistillTrainer:
48128 iter per epoch
INFO    [05-06 23:41:36] _set_current_routine in Routine:
first routine: student
INFO    [05-06 23:41:36] run_routine in Routine:
Start routine student
INFO    [05-06 23:41:36] run_routine in Routine:
Start training
INFO    [05-06 23:41:36] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-06 23:41:38] test_mentor in DistillTrainer:
{'Recall@10': 0.03267505249151817, 'NDCG@10': 0.014886060944543434, 'MRR@10': 0.009547148437167589, 'Recall@5': 0.018231150049429674, 'NDCG@5': 0.010265986972416822, 'MRR@5': 0.007671780114133771, 'Recall*@10': 0.03267505249151817, 'NDCG*@10': 0.014886060944543434, 'MRR*@10': 0.009547148437167589, 'Recall*@5': 0.018231150049429674, 'NDCG*@5': 0.010265986972416822, 'MRR*@5': 0.007671780114133771}
INFO    [05-06 23:41:38] train in DistillTrainer:
result:
{'Recall@10': 0.03267505249151817, 'NDCG@10': 0.014886060944543434, 'MRR@10': 0.009547148437167589, 'Recall@5': 0.018231150049429674, 'NDCG@5': 0.010265986972416822, 'MRR@5': 0.007671780114133771, 'Recall*@10': 0.03267505249151817, 'NDCG*@10': 0.014886060944543434, 'MRR*@10': 0.009547148437167589, 'Recall*@5': 0.018231150049429674, 'NDCG*@5': 0.010265986972416822, 'MRR*@5': 0.007671780114133771}
INFO    [05-06 23:41:40] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-06 23:41:40] validate in BasicTrainer:
{'Recall@10': 0.0036265946065004054, 'NDCG@10': 0.0017313524507559263, 'MRR@10': 0.0011917914111668675, 'Recall@5': 0.001362576149404049, 'NDCG@5': 0.0010072664680102696, 'MRR@5': 0.0008968309579918591, 'Recall*@10': 0.0036265946065004054, 'NDCG*@10': 0.0017313524507559263, 'MRR*@10': 0.0011917914111668675, 'Recall*@5': 0.001362576149404049, 'NDCG*@5': 0.0010072664680102696, 'MRR*@5': 0.0008968309579918591}
INFO    [05-06 23:41:40] train in BasicTrainer:
epoch: 0
DEBUG   [05-06 23:41:40] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 275919
DEBUG   [05-06 23:41:40] calculate_loss in loss:
pred max in softmax: 0.00029324847855605185, argmax 682523
INFO    [05-06 23:41:43] _train_one_epoch in BasicTrainer:
loss = 5.607559632747732
INFO    [05-06 23:41:45] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-06 23:41:45] validate in BasicTrainer:
{'Recall@10': 0.04185012842600162, 'NDCG@10': 0.02148553843681629, 'MRR@10': 0.01537557841780094, 'Recall@5': 0.024681073828385428, 'NDCG@5': 0.015852919564797327, 'MRR@5': 0.01300333021208644, 'Recall*@10': 0.04185012842600162, 'NDCG*@10': 0.02148553843681629, 'MRR*@10': 0.01537557841780094, 'Recall*@5': 0.024681073828385428, 'NDCG*@5': 0.015852919564797327, 'MRR*@5': 0.01300333021208644}
INFO    [05-06 23:41:45] train in BasicTrainer:
duration: 5.533065557479858s
INFO    [05-06 23:41:45] train in BasicTrainer:
epoch: 1
INFO    [05-06 23:41:49] _train_one_epoch in BasicTrainer:
loss = 5.2825633997612815
INFO    [05-06 23:41:51] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-06 23:41:51] validate in BasicTrainer:
{'Recall@10': 0.055951899060836204, 'NDCG@10': 0.02804281419286361, 'MRR@10': 0.01966171360646303, 'Recall@5': 0.033415841368528515, 'NDCG@5': 0.020738123199687555, 'MRR@5': 0.016638304787473038, 'Recall*@10': 0.055951899060836204, 'NDCG*@10': 0.02804281419286361, 'MRR*@10': 0.01966171360646303, 'Recall*@5': 0.033415841368528515, 'NDCG*@5': 0.020738123199687555, 'MRR*@5': 0.016638304787473038}
INFO    [05-06 23:41:51] train in BasicTrainer:
duration: 5.928067207336426s
INFO    [05-06 23:41:51] train in BasicTrainer:
epoch: 2
INFO    [05-06 23:41:55] _train_one_epoch in BasicTrainer:
loss = 5.068432404639873
INFO    [05-06 23:41:57] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-06 23:41:57] validate in BasicTrainer:
{'Recall@10': 0.08165341787613355, 'NDCG@10': 0.04026671083500752, 'MRR@10': 0.027932352458055202, 'Recall@5': 0.04645551683811041, 'NDCG@5': 0.028931192194040004, 'MRR@5': 0.023281805862027865, 'Recall*@10': 0.08165341787613355, 'NDCG*@10': 0.04026671083500752, 'MRR*@10': 0.027932352458055202, 'Recall*@5': 0.04645551683811041, 'NDCG*@5': 0.028931192194040004, 'MRR*@5': 0.023281805862027865}
INFO    [05-06 23:41:57] train in BasicTrainer:
duration: 5.412183046340942s
INFO    [05-06 23:41:57] train in BasicTrainer:
epoch: 3
INFO    [05-06 23:42:00] _train_one_epoch in BasicTrainer:
loss = 4.90170433419816
INFO    [05-06 23:42:02] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-06 23:42:02] validate in BasicTrainer:
{'Recall@10': 0.09623714765677086, 'NDCG@10': 0.05101426920065513, 'MRR@10': 0.03741959525415531, 'Recall@5': 0.057894611587891213, 'NDCG@5': 0.038651249586389616, 'MRR@5': 0.03233807892180406, 'Recall*@10': 0.09623714765677086, 'NDCG*@10': 0.05101426920065513, 'MRR*@10': 0.03741959525415531, 'Recall*@5': 0.057894611587891213, 'NDCG*@5': 0.038651249586389616, 'MRR*@5': 0.03233807892180406}
INFO    [05-06 23:42:02] train in BasicTrainer:
duration: 5.6407856941223145s
INFO    [05-06 23:42:02] train in BasicTrainer:
epoch: 4
INFO    [05-06 23:42:06] _train_one_epoch in BasicTrainer:
loss = 4.795964048263874
INFO    [05-06 23:42:08] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-06 23:42:08] validate in BasicTrainer:
{'Recall@10': 0.11248393471424396, 'NDCG@10': 0.05856677230734091, 'MRR@10': 0.04229732989691771, 'Recall@5': 0.06917305290699005, 'NDCG@5': 0.044656871316524654, 'MRR@5': 0.0366151685324999, 'Recall*@10': 0.11248393471424396, 'NDCG*@10': 0.05856677230734091, 'MRR*@10': 0.04229732989691771, 'Recall*@5': 0.06917305290699005, 'NDCG*@5': 0.044656871316524654, 'MRR*@5': 0.0366151685324999}
INFO    [05-06 23:42:08] train in BasicTrainer:
duration: 5.801772117614746s
INFO    [05-06 23:42:08] train in BasicTrainer:
epoch: 5
DEBUG   [05-06 23:42:10] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 380514
DEBUG   [05-06 23:42:10] calculate_loss in loss:
pred max in softmax: 0.12525661289691925, argmax 22313
DEBUG   [05-06 23:42:10] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 581099
DEBUG   [05-06 23:42:10] calculate_loss in loss:
pred max in softmax: 0.0635884702205658, argmax 76957
INFO    [05-06 23:42:12] _train_one_epoch in BasicTrainer:
loss = 4.72029347876285
INFO    [05-06 23:42:14] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-06 23:42:14] validate in BasicTrainer:
{'Recall@10': 0.12498512405615586, 'NDCG@10': 0.06800105308110897, 'MRR@10': 0.050744980860214964, 'Recall@5': 0.08165341787613355, 'NDCG@5': 0.05416633446629231, 'MRR@5': 0.04513786532557928, 'Recall*@10': 0.12498512405615586, 'NDCG*@10': 0.06800105308110897, 'MRR*@10': 0.050744980860214964, 'Recall*@5': 0.08165341787613355, 'NDCG*@5': 0.05416633446629231, 'MRR*@5': 0.04513786532557928}
INFO    [05-06 23:42:14] train in BasicTrainer:
duration: 5.8228065967559814s
INFO    [05-06 23:42:14] train in BasicTrainer:
epoch: 6
INFO    [05-06 23:42:18] _train_one_epoch in BasicTrainer:
loss = 4.65595915976991
INFO    [05-06 23:42:20] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-06 23:42:20] validate in BasicTrainer:
{'Recall@10': 0.12877237223661864, 'NDCG@10': 0.07080411165952682, 'MRR@10': 0.05330864110818276, 'Recall@5': 0.0818348962527055, 'NDCG@5': 0.05576006237130899, 'MRR@5': 0.047178258546269856, 'Recall*@10': 0.12877237223661864, 'NDCG*@10': 0.07080411165952682, 'MRR*@10': 0.05330864110818276, 'Recall*@5': 0.0818348962527055, 'NDCG*@5': 0.05576006237130899, 'MRR*@5': 0.047178258546269856}
INFO    [05-06 23:42:20] train in BasicTrainer:
duration: 5.584120273590088s
INFO    [05-06 23:42:20] train in BasicTrainer:
epoch: 7
INFO    [05-06 23:42:23] _train_one_epoch in BasicTrainer:
loss = 4.597669553249441
INFO    [05-06 23:42:25] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-06 23:42:25] validate in BasicTrainer:
{'Recall@10': 0.13931002410558554, 'NDCG@10': 0.0733823011127802, 'MRR@10': 0.0533081149825683, 'Recall@5': 0.09131045295641972, 'NDCG@5': 0.057858549344998136, 'MRR@5': 0.046894239978148386, 'Recall*@10': 0.13931002410558554, 'NDCG*@10': 0.0733823011127802, 'MRR*@10': 0.0533081149825683, 'Recall*@5': 0.09131045295641972, 'NDCG*@5': 0.057858549344998136, 'MRR*@5': 0.046894239978148386}
INFO    [05-06 23:42:25] train in BasicTrainer:
duration: 5.78959846496582s
INFO    [05-06 23:42:25] train in BasicTrainer:
epoch: 8
INFO    [05-06 23:42:29] _train_one_epoch in BasicTrainer:
loss = 4.543653003712918
INFO    [05-06 23:42:31] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-06 23:42:31] validate in BasicTrainer:
{'Recall@10': 0.14185369817110208, 'NDCG@10': 0.07571283441323501, 'MRR@10': 0.05565055087208748, 'Recall@5': 0.09505605009885934, 'NDCG@5': 0.060940996958659246, 'MRR@5': 0.04976249142335011, 'Recall*@10': 0.14185369817110208, 'NDCG*@10': 0.07571283441323501, 'MRR*@10': 0.05565055087208748, 'Recall*@5': 0.09505605009885934, 'NDCG*@5': 0.060940996958659246, 'MRR*@5': 0.04976249142335011}
INFO    [05-06 23:42:31] train in BasicTrainer:
duration: 5.703539848327637s
INFO    [05-06 23:42:31] train in BasicTrainer:
epoch: 9
INFO    [05-06 23:42:35] _train_one_epoch in BasicTrainer:
loss = 4.49606325017645
INFO    [05-06 23:42:36] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-06 23:42:36] validate in BasicTrainer:
{'Recall@10': 0.1498476771207956, 'NDCG@10': 0.08040105494169089, 'MRR@10': 0.05929640680551529, 'Recall@5': 0.09722189146738786, 'NDCG@5': 0.06341155131275837, 'MRR@5': 0.052300562079136186, 'Recall*@10': 0.1498476771207956, 'NDCG*@10': 0.08040105494169089, 'MRR*@10': 0.05929640680551529, 'Recall*@5': 0.09722189146738786, 'NDCG*@5': 0.06341155131275837, 'MRR*@5': 0.052300562079136186}
INFO    [05-06 23:42:36] train in BasicTrainer:
duration: 5.258120775222778s
INFO    [05-06 23:42:36] train in BasicTrainer:
epoch: 10
DEBUG   [05-06 23:42:39] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 542150
DEBUG   [05-06 23:42:39] calculate_loss in loss:
pred max in softmax: 0.12689130008220673, argmax 443199
DEBUG   [05-06 23:42:39] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 522747
DEBUG   [05-06 23:42:39] calculate_loss in loss:
pred max in softmax: 0.12957489490509033, argmax 397341
INFO    [05-06 23:42:40] _train_one_epoch in BasicTrainer:
loss = 4.448609331820873
INFO    [05-06 23:42:42] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-06 23:42:42] validate in BasicTrainer:
{'Recall@10': 0.15493502410558554, 'NDCG@10': 0.0839279116346286, 'MRR@10': 0.062327205848235354, 'Recall@5': 0.10274954713307895, 'NDCG@5': 0.06718405250173348, 'MRR@5': 0.05549170850561215, 'Recall*@10': 0.15493502410558554, 'NDCG*@10': 0.0839279116346286, 'MRR*@10': 0.062327205848235354, 'Recall*@5': 0.10274954713307895, 'NDCG*@5': 0.06718405250173348, 'MRR*@5': 0.05549170850561215}
INFO    [05-06 23:42:42] train in BasicTrainer:
duration: 5.682027578353882s
INFO    [05-06 23:42:42] train in BasicTrainer:
epoch: 11
INFO    [05-06 23:42:45] _train_one_epoch in BasicTrainer:
loss = 4.409588123889679
INFO    [05-06 23:42:48] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-06 23:42:48] validate in BasicTrainer:
{'Recall@10': 0.15463454333635476, 'NDCG@10': 0.08594794829304402, 'MRR@10': 0.06506922611823449, 'Recall@5': 0.10471308575226711, 'NDCG@5': 0.07000507930150399, 'MRR@5': 0.05860381659406882, 'Recall*@10': 0.15463454333635476, 'NDCG*@10': 0.08594794829304402, 'MRR*@10': 0.06506922611823449, 'Recall*@5': 0.10471308575226711, 'NDCG*@5': 0.07000507930150399, 'MRR*@5': 0.05860381659406882}
INFO    [05-06 23:42:48] train in BasicTrainer:
duration: 5.689658880233765s
INFO    [05-06 23:42:48] train in BasicTrainer:
epoch: 12
INFO    [05-06 23:42:51] _train_one_epoch in BasicTrainer:
loss = 4.365632485836111
INFO    [05-06 23:42:53] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-06 23:42:53] validate in BasicTrainer:
{'Recall@10': 0.16110529349400446, 'NDCG@10': 0.09083897047317945, 'MRR@10': 0.06942730568922482, 'Recall@5': 0.11026156636384818, 'NDCG@5': 0.07441806363371703, 'MRR@5': 0.0626642735531697, 'Recall*@10': 0.16110529349400446, 'NDCG*@10': 0.09083897047317945, 'MRR*@10': 0.06942730568922482, 'Recall*@5': 0.11026156636384818, 'NDCG*@5': 0.07441806363371703, 'MRR*@5': 0.0626642735531697}
INFO    [05-06 23:42:53] train in BasicTrainer:
duration: 5.6215479373931885s
INFO    [05-06 23:42:53] train in BasicTrainer:
epoch: 13
INFO    [05-06 23:42:57] _train_one_epoch in BasicTrainer:
loss = 4.3293231801783785
INFO    [05-06 23:42:59] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-06 23:42:59] validate in BasicTrainer:
{'Recall@10': 0.16939975206668562, 'NDCG@10': 0.09419413598684165, 'MRR@10': 0.07140223911175361, 'Recall@5': 0.1101009135062878, 'NDCG@5': 0.07502962047090897, 'MRR@5': 0.06350140531475727, 'Recall*@10': 0.16939975206668562, 'NDCG*@10': 0.09419413598684165, 'MRR*@10': 0.07140223911175361, 'Recall*@5': 0.1101009135062878, 'NDCG*@5': 0.07502962047090897, 'MRR*@5': 0.06350140531475727}
INFO    [05-06 23:42:59] train in BasicTrainer:
duration: 5.728838205337524s
INFO    [05-06 23:42:59] train in BasicTrainer:
epoch: 14
INFO    [05-06 23:43:03] _train_one_epoch in BasicTrainer:
loss = 4.296364287112621
INFO    [05-06 23:43:05] validate in BasicTrainer:
{'Recall@10': 0.1686173127247737, 'NDCG@10': 0.09373468160629272, 'MRR@10': 0.07086263253138615, 'Recall@5': 0.1155303934445748, 'NDCG@5': 0.07662496715784073, 'MRR@5': 0.06383604957507207, 'Recall*@10': 0.1686173127247737, 'NDCG*@10': 0.09373468160629272, 'MRR*@10': 0.07086263253138615, 'Recall*@5': 0.1155303934445748, 'NDCG*@5': 0.07662496715784073, 'MRR*@5': 0.06383604957507207}
INFO    [05-06 23:43:05] train in BasicTrainer:
duration: 5.721949577331543s
INFO    [05-06 23:43:05] train in BasicTrainer:
epoch: 15
DEBUG   [05-06 23:43:08] calculate_loss in loss:
soft_target max: 0.5017377734184265, argmax 425422
DEBUG   [05-06 23:43:08] calculate_loss in loss:
pred max in softmax: 0.1588267982006073, argmax 594542
DEBUG   [05-06 23:43:08] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 139812
DEBUG   [05-06 23:43:08] calculate_loss in loss:
pred max in softmax: 0.15009663999080658, argmax 780293
INFO    [05-06 23:43:08] _train_one_epoch in BasicTrainer:
loss = 4.257581254269215
INFO    [05-06 23:43:11] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-06 23:43:11] validate in BasicTrainer:
{'Recall@10': 0.17372548580169678, 'NDCG@10': 0.09812920941756322, 'MRR@10': 0.07513447421101424, 'Recall@5': 0.1162920078405967, 'NDCG@5': 0.07965440475023709, 'MRR@5': 0.06756994500756264, 'Recall*@10': 0.17372548580169678, 'NDCG*@10': 0.09812920941756322, 'MRR*@10': 0.07513447421101424, 'Recall*@5': 0.1162920078405967, 'NDCG*@5': 0.07965440475023709, 'MRR*@5': 0.06756994500756264}
INFO    [05-06 23:43:11] train in BasicTrainer:
duration: 5.816558599472046s
INFO    [05-06 23:43:11] train in BasicTrainer:
epoch: 16
INFO    [05-06 23:43:14] _train_one_epoch in BasicTrainer:
loss = 4.225008761629145
INFO    [05-06 23:43:16] validate in BasicTrainer:
{'Recall@10': 0.17418661942848793, 'NDCG@10': 0.09790031210734294, 'MRR@10': 0.07458204202927075, 'Recall@5': 0.11837454713307895, 'NDCG@5': 0.07971367268608166, 'MRR@5': 0.06699447047251922, 'Recall*@10': 0.17418661942848793, 'NDCG*@10': 0.09790031210734294, 'MRR*@10': 0.07458204202927075, 'Recall*@5': 0.11837454713307895, 'NDCG*@5': 0.07971367268608166, 'MRR*@5': 0.06699447047251922}
INFO    [05-06 23:43:16] train in BasicTrainer:
duration: 5.413961410522461s
INFO    [05-06 23:43:16] train in BasicTrainer:
epoch: 17
INFO    [05-06 23:43:20] _train_one_epoch in BasicTrainer:
loss = 4.194991307055696
INFO    [05-06 23:43:22] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-06 23:43:22] validate in BasicTrainer:
{'Recall@10': 0.18234125008949867, 'NDCG@10': 0.10226867691828655, 'MRR@10': 0.07784082253391926, 'Recall@5': 0.12426516069815709, 'NDCG@5': 0.08341529048406161, 'MRR@5': 0.07001811896379177, 'Recall*@10': 0.18234125008949867, 'NDCG*@10': 0.10226867691828655, 'MRR*@10': 0.07784082253391926, 'Recall*@5': 0.12426516069815709, 'NDCG*@5': 0.08341529048406161, 'MRR*@5': 0.07001811896379177}
INFO    [05-06 23:43:22] train in BasicTrainer:
duration: 5.7957541942596436s
INFO    [05-06 23:43:22] train in BasicTrainer:
epoch: 18
INFO    [05-06 23:43:26] _train_one_epoch in BasicTrainer:
loss = 4.16753269763703
INFO    [05-06 23:43:27] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-06 23:43:27] validate in BasicTrainer:
{'Recall@10': 0.18199911942848793, 'NDCG@10': 0.10495703839338742, 'MRR@10': 0.08162818333277336, 'Recall@5': 0.1223016232252121, 'NDCG@5': 0.08580492494197992, 'MRR@5': 0.0738141442147585, 'Recall*@10': 0.18199911942848793, 'NDCG*@10': 0.10495703839338742, 'MRR*@10': 0.08162818333277336, 'Recall*@5': 0.1223016232252121, 'NDCG*@5': 0.08580492494197992, 'MRR*@5': 0.0738141442147585}
INFO    [05-06 23:43:27] train in BasicTrainer:
duration: 5.535522937774658s
INFO    [05-06 23:43:27] train in BasicTrainer:
epoch: 19
INFO    [05-06 23:43:31] _train_one_epoch in BasicTrainer:
loss = 4.140762029810155
INFO    [05-06 23:43:33] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-06 23:43:33] validate in BasicTrainer:
{'Recall@10': 0.1842423127247737, 'NDCG@10': 0.10527448126902947, 'MRR@10': 0.0810718725507076, 'Recall@5': 0.13131604630213517, 'NDCG@5': 0.08830861403391911, 'MRR@5': 0.0741559281372107, 'Recall*@10': 0.1842423127247737, 'NDCG*@10': 0.10527448126902947, 'MRR*@10': 0.0810718725507076, 'Recall*@5': 0.13131604630213517, 'NDCG*@5': 0.08830861403391911, 'MRR*@5': 0.0741559281372107}
INFO    [05-06 23:43:33] train in BasicTrainer:
duration: 5.453876733779907s
INFO    [05-06 23:43:33] train in BasicTrainer:
epoch: 20
INFO    [05-06 23:43:36] _train_one_epoch in BasicTrainer:
loss = 4.1135284304618835
INFO    [05-06 23:43:39] validate in BasicTrainer:
{'Recall@10': 0.18396265690143293, 'NDCG@10': 0.1047916836463488, 'MRR@10': 0.08066814507429416, 'Recall@5': 0.12967381454431093, 'NDCG@5': 0.0874240048802816, 'MRR@5': 0.07360742585017131, 'Recall*@10': 0.18396265690143293, 'NDCG*@10': 0.1047916836463488, 'MRR*@10': 0.08066814507429416, 'Recall*@5': 0.12967381454431093, 'NDCG*@5': 0.0874240048802816, 'MRR*@5': 0.07360742585017131}
INFO    [05-06 23:43:39] train in BasicTrainer:
duration: 5.682903528213501s
INFO    [05-06 23:43:39] train in BasicTrainer:
epoch: 21
DEBUG   [05-06 23:43:40] calculate_loss in loss:
soft_target max: 0.501916766166687, argmax 237653
DEBUG   [05-06 23:43:40] calculate_loss in loss:
pred max in softmax: 0.33750230073928833, argmax 845922
DEBUG   [05-06 23:43:40] calculate_loss in loss:
soft_target max: 0.501916766166687, argmax 157419
DEBUG   [05-06 23:43:40] calculate_loss in loss:
pred max in softmax: 0.18551526963710785, argmax 416628
INFO    [05-06 23:43:42] _train_one_epoch in BasicTrainer:
loss = 4.0886721636386625
INFO    [05-06 23:43:44] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-06 23:43:44] validate in BasicTrainer:
{'Recall@10': 0.1917959818473229, 'NDCG@10': 0.11111234128475189, 'MRR@10': 0.08648263261868404, 'Recall@5': 0.13237814146738786, 'NDCG@5': 0.09197104779573587, 'MRR@5': 0.07862401753664017, 'Recall*@10': 0.1917959818473229, 'NDCG*@10': 0.11111234128475189, 'MRR*@10': 0.08648263261868404, 'Recall*@5': 0.13237814146738786, 'NDCG*@5': 0.09197104779573587, 'MRR*@5': 0.07862401753664017}
INFO    [05-06 23:43:44] train in BasicTrainer:
duration: 5.404720783233643s
INFO    [05-06 23:43:44] train in BasicTrainer:
epoch: 22
INFO    [05-06 23:43:48] _train_one_epoch in BasicTrainer:
loss = 4.065374569689974
INFO    [05-06 23:43:49] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-06 23:43:50] validate in BasicTrainer:
{'Recall@10': 0.19117419536297137, 'NDCG@10': 0.1122324879352863, 'MRR@10': 0.08809307446846595, 'Recall@5': 0.13434167894033286, 'NDCG@5': 0.09393149442397632, 'MRR@5': 0.08058745585955106, 'Recall*@10': 0.19117419536297137, 'NDCG*@10': 0.1122324879352863, 'MRR*@10': 0.08809307446846595, 'Recall*@5': 0.13434167894033286, 'NDCG*@5': 0.09393149442397632, 'MRR*@5': 0.08058745585955106}
INFO    [05-06 23:43:50] train in BasicTrainer:
duration: 5.604494571685791s
INFO    [05-06 23:43:50] train in BasicTrainer:
epoch: 23
INFO    [05-06 23:43:53] _train_one_epoch in BasicTrainer:
loss = 4.038075748910296
INFO    [05-06 23:43:55] validate in BasicTrainer:
{'Recall@10': 0.18939213569347674, 'NDCG@10': 0.10905390404737912, 'MRR@10': 0.0844652303136312, 'Recall@5': 0.13253879432494825, 'NDCG@5': 0.09065113102014248, 'MRR@5': 0.07685584173752712, 'Recall*@10': 0.18939213569347674, 'NDCG*@10': 0.10905390404737912, 'MRR*@10': 0.0844652303136312, 'Recall*@5': 0.13253879432494825, 'NDCG*@5': 0.09065113102014248, 'MRR*@5': 0.07685584173752712}
INFO    [05-06 23:43:55] train in BasicTrainer:
duration: 5.320875883102417s
INFO    [05-06 23:43:55] train in BasicTrainer:
epoch: 24
INFO    [05-06 23:43:58] _train_one_epoch in BasicTrainer:
loss = 4.022123141491667
INFO    [05-06 23:44:00] validate in BasicTrainer:
{'Recall@10': 0.19225711547411406, 'NDCG@10': 0.11205129726574971, 'MRR@10': 0.08741086434859496, 'Recall@5': 0.13748631454431093, 'NDCG@5': 0.09436483967762727, 'MRR@5': 0.0801259740613974, 'Recall*@10': 0.19225711547411406, 'NDCG*@10': 0.11205129726574971, 'MRR*@10': 0.08741086434859496, 'Recall*@5': 0.13748631454431093, 'NDCG*@5': 0.09436483967762727, 'MRR*@5': 0.0801259740613974}
INFO    [05-06 23:44:00] train in BasicTrainer:
duration: 5.320110559463501s
INFO    [05-06 23:44:00] train in BasicTrainer:
epoch: 25
INFO    [05-06 23:44:04] _train_one_epoch in BasicTrainer:
loss = 3.99896295400376
INFO    [05-06 23:44:06] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-06 23:44:06] validate in BasicTrainer:
{'Recall@10': 0.19361969255484068, 'NDCG@10': 0.11544032968007602, 'MRR@10': 0.0914753578030146, 'Recall@5': 0.14021146641327784, 'NDCG@5': 0.09828906334363498, 'MRR@5': 0.08446559109366857, 'Recall*@10': 0.19361969255484068, 'NDCG*@10': 0.11544032968007602, 'MRR*@10': 0.0914753578030146, 'Recall*@5': 0.14021146641327784, 'NDCG*@5': 0.09828906334363498, 'MRR*@5': 0.08446559109366857}
INFO    [05-06 23:44:06] train in BasicTrainer:
duration: 5.7134435176849365s
INFO    [05-06 23:44:06] train in BasicTrainer:
epoch: 26
DEBUG   [05-06 23:44:08] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 622384
DEBUG   [05-06 23:44:08] calculate_loss in loss:
pred max in softmax: 0.24516932666301727, argmax 152839
DEBUG   [05-06 23:44:08] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 117930
DEBUG   [05-06 23:44:08] calculate_loss in loss:
pred max in softmax: 0.27594172954559326, argmax 652751
INFO    [05-06 23:44:09] _train_one_epoch in BasicTrainer:
loss = 3.9770126900774367
INFO    [05-06 23:44:11] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-06 23:44:11] validate in BasicTrainer:
{'Recall@10': 0.2007122291968419, 'NDCG@10': 0.11714315987550296, 'MRR@10': 0.09167348994658543, 'Recall@5': 0.14141338949020094, 'NDCG@5': 0.09819432806510192, 'MRR@5': 0.08398779739554112, 'Recall*@10': 0.2007122291968419, 'NDCG*@10': 0.11714315987550296, 'MRR*@10': 0.09167348994658543, 'Recall*@5': 0.14141338949020094, 'NDCG*@5': 0.09819432806510192, 'MRR*@5': 0.08398779739554112}
INFO    [05-06 23:44:11] train in BasicTrainer:
duration: 5.5474629402160645s
INFO    [05-06 23:44:11] train in BasicTrainer:
epoch: 27
INFO    [05-06 23:44:15] _train_one_epoch in BasicTrainer:
loss = 3.957899805079115
INFO    [05-06 23:44:17] validate in BasicTrainer:
{'Recall@10': 0.19255759624334481, 'NDCG@10': 0.11504555378968899, 'MRR@10': 0.09135330411104056, 'Recall@5': 0.13734648663264054, 'NDCG@5': 0.09730143042711112, 'MRR@5': 0.08409301592753483, 'Recall*@10': 0.19255759624334481, 'NDCG*@10': 0.11504555378968899, 'MRR*@10': 0.09135330411104056, 'Recall*@5': 0.13734648663264054, 'NDCG*@5': 0.09730143042711112, 'MRR*@5': 0.08409301592753483}
INFO    [05-06 23:44:17] train in BasicTrainer:
duration: 5.743696451187134s
INFO    [05-06 23:44:17] train in BasicTrainer:
epoch: 28
INFO    [05-06 23:44:21] _train_one_epoch in BasicTrainer:
loss = 3.938031017780304
INFO    [05-06 23:44:23] validate in BasicTrainer:
{'Recall@10': 0.1963240194779176, 'NDCG@10': 0.11625904131394166, 'MRR@10': 0.09180002888807884, 'Recall@5': 0.13722748481310332, 'NDCG@5': 0.09724874393298076, 'MRR@5': 0.08401730026190098, 'Recall*@10': 0.1963240194779176, 'NDCG*@10': 0.11625904131394166, 'MRR*@10': 0.09180002888807884, 'Recall*@5': 0.13722748481310332, 'NDCG*@5': 0.09724874393298076, 'MRR*@5': 0.08401730026190098}
INFO    [05-06 23:44:23] train in BasicTrainer:
duration: 5.29219388961792s
INFO    [05-06 23:44:23] train in BasicTrainer:
epoch: 29
INFO    [05-06 23:44:26] _train_one_epoch in BasicTrainer:
loss = 3.9171514244789774
INFO    [05-06 23:44:28] validate in BasicTrainer:
{'Recall@10': 0.19510127030886137, 'NDCG@10': 0.11437763331028131, 'MRR@10': 0.08972987074118394, 'Recall@5': 0.13600473564404708, 'NDCG@5': 0.0951847044321207, 'MRR@5': 0.08176438911603047, 'Recall*@10': 0.19510127030886137, 'NDCG*@10': 0.11437763331028131, 'MRR*@10': 0.08972987074118394, 'Recall*@5': 0.13600473564404708, 'NDCG*@5': 0.0951847044321207, 'MRR*@5': 0.08176438911603047}
INFO    [05-06 23:44:28] train in BasicTrainer:
duration: 5.822607755661011s
INFO    [05-06 23:44:28] train in BasicTrainer:
epoch: 30
INFO    [05-06 23:44:32] _train_one_epoch in BasicTrainer:
loss = 3.9002364391976214
INFO    [05-06 23:44:34] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [05-06 23:44:34] validate in BasicTrainer:
{'Recall@10': 0.19976913470488328, 'NDCG@10': 0.11958114229715787, 'MRR@10': 0.09512035147501872, 'Recall@5': 0.14531963949020094, 'NDCG@5': 0.10218204787144294, 'MRR@5': 0.0880597594838876, 'Recall*@10': 0.19976913470488328, 'NDCG*@10': 0.11958114229715787, 'MRR*@10': 0.09512035147501872, 'Recall*@5': 0.14531963949020094, 'NDCG*@5': 0.10218204787144294, 'MRR*@5': 0.0880597594838876}
INFO    [05-06 23:44:34] train in BasicTrainer:
duration: 5.818930149078369s
INFO    [05-06 23:44:34] train in BasicTrainer:
epoch: 31
DEBUG   [05-06 23:44:37] calculate_loss in loss:
soft_target max: 0.5017377734184265, argmax 173779
DEBUG   [05-06 23:44:37] calculate_loss in loss:
pred max in softmax: 0.2684694528579712, argmax 260324
DEBUG   [05-06 23:44:37] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 99695
DEBUG   [05-06 23:44:37] calculate_loss in loss:
pred max in softmax: 0.30248206853866577, argmax 341875
INFO    [05-06 23:44:38] _train_one_epoch in BasicTrainer:
loss = 3.8837060027934136
INFO    [05-06 23:44:40] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-06 23:44:40] validate in BasicTrainer:
{'Recall@10': 0.2005099241550152, 'NDCG@10': 0.11965027623451673, 'MRR@10': 0.09496433746356231, 'Recall@5': 0.14367740887861985, 'NDCG@5': 0.1013154020676246, 'MRR@5': 0.08742354151148063, 'Recall*@10': 0.2005099241550152, 'NDCG*@10': 0.11965027623451673, 'MRR*@10': 0.09496433746356231, 'Recall*@5': 0.14367740887861985, 'NDCG*@5': 0.1013154020676246, 'MRR*@5': 0.08742354151148063}
INFO    [05-06 23:44:40] train in BasicTrainer:
duration: 5.783571481704712s
INFO    [05-06 23:44:40] train in BasicTrainer:
epoch: 32
INFO    [05-06 23:44:43] _train_one_epoch in BasicTrainer:
loss = 3.8680913549788456
INFO    [05-06 23:44:46] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-06 23:44:46] validate in BasicTrainer:
{'Recall@10': 0.20367538470488328, 'NDCG@10': 0.1210697482411678, 'MRR@10': 0.09568223987634365, 'Recall@5': 0.14788413964785063, 'NDCG@5': 0.10310747015934724, 'MRR@5': 0.08831615746021271, 'Recall*@10': 0.20367538470488328, 'NDCG*@10': 0.1210697482411678, 'MRR*@10': 0.09568223987634365, 'Recall*@5': 0.14788413964785063, 'NDCG*@5': 0.10310747015934724, 'MRR*@5': 0.08831615746021271}
INFO    [05-06 23:44:46] train in BasicTrainer:
duration: 5.74669623374939s
INFO    [05-06 23:44:46] train in BasicTrainer:
epoch: 33
INFO    [05-06 23:44:49] _train_one_epoch in BasicTrainer:
loss = 3.8481586309189493
INFO    [05-06 23:44:51] validate in BasicTrainer:
{'Recall@10': 0.19852556173618024, 'NDCG@10': 0.11844240702115573, 'MRR@10': 0.09384560871582764, 'Recall@5': 0.14501915872097015, 'NDCG@5': 0.10118234959932473, 'MRR@5': 0.08674567422041526, 'Recall*@10': 0.19852556173618024, 'NDCG*@10': 0.11844240702115573, 'MRR*@10': 0.09384560871582764, 'Recall*@5': 0.14501915872097015, 'NDCG*@5': 0.10118234959932473, 'MRR*@5': 0.08674567422041526}
INFO    [05-06 23:44:51] train in BasicTrainer:
duration: 5.437048673629761s
INFO    [05-06 23:44:51] train in BasicTrainer:
epoch: 34
INFO    [05-06 23:44:55] _train_one_epoch in BasicTrainer:
loss = 3.8353382120741175
INFO    [05-06 23:44:57] validate in BasicTrainer:
{'Recall@10': 0.2044161741550152, 'NDCG@10': 0.1206172057069265, 'MRR@10': 0.09495942351909784, 'Recall@5': 0.14696187124802515, 'NDCG@5': 0.10233578143211511, 'MRR@5': 0.08758885585344754, 'Recall*@10': 0.2044161741550152, 'NDCG*@10': 0.1206172057069265, 'MRR*@10': 0.09495942351909784, 'Recall*@5': 0.14696187124802515, 'NDCG*@5': 0.10233578143211511, 'MRR*@5': 0.08758885585344754}
INFO    [05-06 23:44:57] train in BasicTrainer:
duration: 5.792791366577148s
INFO    [05-06 23:44:57] train in BasicTrainer:
epoch: 35
INFO    [05-06 23:45:01] _train_one_epoch in BasicTrainer:
loss = 3.822915423423686
INFO    [05-06 23:45:03] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-06 23:45:03] validate in BasicTrainer:
{'Recall@10': 0.20307442316642174, 'NDCG@10': 0.12381243189940086, 'MRR@10': 0.09954110189126088, 'Recall@5': 0.14862492795173937, 'NDCG@5': 0.10629975910370167, 'MRR@5': 0.09236838467992269, 'Recall*@10': 0.20307442316642174, 'NDCG*@10': 0.12381243189940086, 'MRR*@10': 0.09954110189126088, 'Recall*@5': 0.14862492795173937, 'NDCG*@5': 0.10629975910370167, 'MRR*@5': 0.09236838467992269}
INFO    [05-06 23:45:03] train in BasicTrainer:
duration: 5.9361419677734375s
INFO    [05-06 23:45:03] train in BasicTrainer:
epoch: 36
INFO    [05-06 23:45:07] _train_one_epoch in BasicTrainer:
loss = 3.806052843306927
INFO    [05-06 23:45:08] validate in BasicTrainer:
{'Recall@10': 0.2054574443743779, 'NDCG@10': 0.12234479647416335, 'MRR@10': 0.09692186575669509, 'Recall@5': 0.14862492795173937, 'NDCG@5': 0.10410694892589863, 'MRR@5': 0.08948030036229354, 'Recall*@10': 0.2054574443743779, 'NDCG*@10': 0.12234479647416335, 'MRR*@10': 0.09692186575669509, 'Recall*@5': 0.14862492795173937, 'NDCG*@5': 0.10410694892589863, 'MRR*@5': 0.08948030036229354}
INFO    [05-06 23:45:08] train in BasicTrainer:
duration: 5.511606454849243s
INFO    [05-06 23:45:08] train in BasicTrainer:
epoch: 37
DEBUG   [05-06 23:45:09] calculate_loss in loss:
soft_target max: 0.5017377734184265, argmax 698947
DEBUG   [05-06 23:45:09] calculate_loss in loss:
pred max in softmax: 0.5658285617828369, argmax 693702
DEBUG   [05-06 23:45:09] calculate_loss in loss:
soft_target max: 0.5014519095420837, argmax 598978
DEBUG   [05-06 23:45:09] calculate_loss in loss:
pred max in softmax: 0.5551979541778564, argmax 825840
INFO    [05-06 23:45:12] _train_one_epoch in BasicTrainer:
loss = 3.7921031168166626
INFO    [05-06 23:45:14] validate in BasicTrainer:
{'Recall@10': 0.2026132895396306, 'NDCG@10': 0.12093712217532672, 'MRR@10': 0.09589058561966969, 'Recall@5': 0.1455992953135417, 'NDCG@5': 0.10245935618877411, 'MRR@5': 0.08824098855257034, 'Recall*@10': 0.2026132895396306, 'NDCG*@10': 0.12093712217532672, 'MRR*@10': 0.09589058561966969, 'Recall*@5': 0.1455992953135417, 'NDCG*@5': 0.10245935618877411, 'MRR*@5': 0.08824098855257034}
INFO    [05-06 23:45:14] train in BasicTrainer:
duration: 5.276833772659302s
INFO    [05-06 23:45:14] train in BasicTrainer:
epoch: 38
INFO    [05-06 23:45:17] _train_one_epoch in BasicTrainer:
loss = 3.7795665581175624
INFO    [05-06 23:45:19] validate in BasicTrainer:
{'Recall@10': 0.20381521261655366, 'NDCG@10': 0.12191469222307205, 'MRR@10': 0.09691423120406958, 'Recall@5': 0.14531963949020094, 'NDCG@5': 0.10299037224971332, 'MRR@5': 0.08909750787111428, 'Recall*@10': 0.20381521261655366, 'NDCG*@10': 0.12191469222307205, 'MRR*@10': 0.09691423120406958, 'Recall*@5': 0.14531963949020094, 'NDCG*@5': 0.10299037224971332, 'MRR*@5': 0.08909750787111428}
INFO    [05-06 23:45:19] train in BasicTrainer:
duration: 5.795457601547241s
INFO    [05-06 23:45:19] train in BasicTrainer:
epoch: 39
INFO    [05-06 23:45:23] _train_one_epoch in BasicTrainer:
loss = 3.763957490312292
INFO    [05-06 23:45:25] validate in BasicTrainer:
{'Recall@10': 0.20709967613220215, 'NDCG@10': 0.12355116296273011, 'MRR@10': 0.0978804465669852, 'Recall@5': 0.15072829333635476, 'NDCG@5': 0.10531701949926522, 'MRR@5': 0.09035114886669013, 'Recall*@10': 0.20709967613220215, 'NDCG*@10': 0.12355116296273011, 'MRR*@10': 0.0978804465669852, 'Recall*@5': 0.15072829333635476, 'NDCG*@5': 0.10531701949926522, 'MRR*@5': 0.09035114886669013}
INFO    [05-06 23:45:25] train in BasicTrainer:
duration: 5.852774381637573s
INFO    [05-06 23:45:25] train in BasicTrainer:
epoch: 40
INFO    [05-06 23:45:29] _train_one_epoch in BasicTrainer:
loss = 3.761022562676288
INFO    [05-06 23:45:31] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [05-06 23:45:31] validate in BasicTrainer:
{'Recall@10': 0.2057579251436087, 'NDCG@10': 0.12544087779063445, 'MRR@10': 0.10070966929197311, 'Recall@5': 0.15435488865925714, 'NDCG@5': 0.10906168188040073, 'MRR@5': 0.09409565593187626, 'Recall*@10': 0.2057579251436087, 'NDCG*@10': 0.12544087779063445, 'MRR*@10': 0.10070966929197311, 'Recall*@5': 0.15435488865925714, 'NDCG*@5': 0.10906168188040073, 'MRR*@5': 0.09409565593187626}
INFO    [05-06 23:45:31] train in BasicTrainer:
duration: 5.9497389793396s
INFO    [05-06 23:45:31] train in BasicTrainer:
epoch: 41
INFO    [05-06 23:45:35] _train_one_epoch in BasicTrainer:
loss = 3.739633780844668
INFO    [05-06 23:45:37] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-06 23:45:37] validate in BasicTrainer:
{'Recall@10': 0.20682002030886137, 'NDCG@10': 0.12786446397121137, 'MRR@10': 0.10358965970002688, 'Recall@5': 0.15493502410558554, 'NDCG@5': 0.11112907758125892, 'MRR@5': 0.09671196914636172, 'Recall*@10': 0.20682002030886137, 'NDCG*@10': 0.12786446397121137, 'MRR*@10': 0.10358965970002688, 'Recall*@5': 0.15493502410558554, 'NDCG*@5': 0.11112907758125892, 'MRR*@5': 0.09671196914636172}
INFO    [05-06 23:45:37] train in BasicTrainer:
duration: 6.03550386428833s
INFO    [05-06 23:45:37] train in BasicTrainer:
epoch: 42
DEBUG   [05-06 23:45:39] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 596855
DEBUG   [05-06 23:45:39] calculate_loss in loss:
pred max in softmax: 0.555971622467041, argmax 799913
DEBUG   [05-06 23:45:39] calculate_loss in loss:
soft_target max: 0.501916766166687, argmax 314240
DEBUG   [05-06 23:45:39] calculate_loss in loss:
pred max in softmax: 0.45825275778770447, argmax 768884
INFO    [05-06 23:45:41] _train_one_epoch in BasicTrainer:
loss = 3.725729812967016
INFO    [05-06 23:45:43] validate in BasicTrainer:
{'Recall@10': 0.20890256074758676, 'NDCG@10': 0.12635771471720475, 'MRR@10': 0.10095581183066735, 'Recall@5': 0.1529923127247737, 'NDCG@5': 0.10826838417695119, 'MRR@5': 0.09348705697518128, 'Recall*@10': 0.20890256074758676, 'NDCG*@10': 0.12635771471720475, 'MRR*@10': 0.10095581183066735, 'Recall*@5': 0.1529923127247737, 'NDCG*@5': 0.10826838417695119, 'MRR*@5': 0.09348705697518128}
INFO    [05-06 23:45:43] train in BasicTrainer:
duration: 5.442920446395874s
INFO    [05-06 23:45:43] train in BasicTrainer:
epoch: 43
INFO    [05-06 23:45:46] _train_one_epoch in BasicTrainer:
loss = 3.7173376260919775
INFO    [05-06 23:45:49] validate in BasicTrainer:
{'Recall@10': 0.210586442397191, 'NDCG@10': 0.1262451559305191, 'MRR@10': 0.10027990260949501, 'Recall@5': 0.15749952426323524, 'NDCG@5': 0.10926466148633224, 'MRR@5': 0.0933766823548537, 'Recall*@10': 0.210586442397191, 'NDCG*@10': 0.1262451559305191, 'MRR*@10': 0.10027990260949501, 'Recall*@5': 0.15749952426323524, 'NDCG*@5': 0.10926466148633224, 'MRR*@5': 0.0933766823548537}
INFO    [05-06 23:45:49] train in BasicTrainer:
duration: 5.864679574966431s
INFO    [05-06 23:45:49] train in BasicTrainer:
epoch: 44
INFO    [05-06 23:45:52] _train_one_epoch in BasicTrainer:
loss = 3.705728122528563
INFO    [05-06 23:45:54] validate in BasicTrainer:
{'Recall@10': 0.2095243472319383, 'NDCG@10': 0.12612379858127007, 'MRR@10': 0.10052802872199279, 'Recall@5': 0.15401275685200325, 'NDCG@5': 0.10837500714338742, 'MRR@5': 0.09332838769142444, 'Recall*@10': 0.2095243472319383, 'NDCG*@10': 0.12612379858127007, 'MRR*@10': 0.10052802872199279, 'Recall*@5': 0.15401275685200325, 'NDCG*@5': 0.10837500714338742, 'MRR*@5': 0.09332838769142444}
INFO    [05-06 23:45:54] train in BasicTrainer:
duration: 5.244853734970093s
INFO    [05-06 23:45:54] train in BasicTrainer:
epoch: 45
INFO    [05-06 23:45:57] _train_one_epoch in BasicTrainer:
loss = 3.69623624010289
INFO    [05-06 23:46:00] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-06 23:46:00] validate in BasicTrainer:
{'Recall@10': 0.21252915492424598, 'NDCG@10': 0.12968008334820086, 'MRR@10': 0.10426915265046634, 'Recall@5': 0.15357244817110208, 'NDCG@5': 0.11058509808320266, 'MRR@5': 0.09636904299259186, 'Recall*@10': 0.21252915492424598, 'NDCG*@10': 0.12968008334820086, 'MRR*@10': 0.10426915265046634, 'Recall*@5': 0.15357244817110208, 'NDCG*@5': 0.11058509808320266, 'MRR*@5': 0.09636904299259186}
INFO    [05-06 23:46:00] train in BasicTrainer:
duration: 5.899490118026733s
INFO    [05-06 23:46:00] train in BasicTrainer:
epoch: 46
INFO    [05-06 23:46:03] _train_one_epoch in BasicTrainer:
loss = 3.6881893023531487
INFO    [05-06 23:46:05] validate in BasicTrainer:
{'Recall@10': 0.20605840591283944, 'NDCG@10': 0.12532975811224717, 'MRR@10': 0.100664700453098, 'Recall@5': 0.150427812567124, 'NDCG@5': 0.10753639615499057, 'MRR@5': 0.09343687530893546, 'Recall*@10': 0.20605840591283944, 'NDCG*@10': 0.12532975811224717, 'MRR*@10': 0.100664700453098, 'Recall*@5': 0.150427812567124, 'NDCG*@5': 0.10753639615499057, 'MRR*@5': 0.09343687530893546}
INFO    [05-06 23:46:05] train in BasicTrainer:
duration: 5.463864326477051s
INFO    [05-06 23:46:05] train in BasicTrainer:
epoch: 47
DEBUG   [05-06 23:46:08] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 205458
DEBUG   [05-06 23:46:08] calculate_loss in loss:
pred max in softmax: 0.42473065853118896, argmax 273554
DEBUG   [05-06 23:46:08] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 348859
DEBUG   [05-06 23:46:08] calculate_loss in loss:
pred max in softmax: 0.5058761239051819, argmax 653289
INFO    [05-06 23:46:09] _train_one_epoch in BasicTrainer:
loss = 3.673676090037569
INFO    [05-06 23:46:11] validate in BasicTrainer:
{'Recall@10': 0.20862290492424598, 'NDCG@10': 0.12638564980947053, 'MRR@10': 0.10108236796580829, 'Recall@5': 0.15463454333635476, 'NDCG@5': 0.10910006440602817, 'MRR@5': 0.09404681221796916, 'Recall*@10': 0.20862290492424598, 'NDCG*@10': 0.12638564980947053, 'MRR*@10': 0.10108236796580829, 'Recall*@5': 0.15463454333635476, 'NDCG*@5': 0.10910006440602817, 'MRR*@5': 0.09404681221796916}
INFO    [05-06 23:46:11] train in BasicTrainer:
duration: 5.674797058105469s
INFO    [05-06 23:46:11] train in BasicTrainer:
epoch: 48
INFO    [05-06 23:46:14] _train_one_epoch in BasicTrainer:
loss = 3.662865568982794
INFO    [05-06 23:46:17] validate in BasicTrainer:
{'Recall@10': 0.20772146261655366, 'NDCG@10': 0.1283438830421521, 'MRR@10': 0.10407496874149029, 'Recall@5': 0.14966619817110208, 'NDCG@5': 0.1095955824622741, 'MRR@5': 0.09635367187169883, 'Recall*@10': 0.20772146261655366, 'NDCG*@10': 0.1283438830421521, 'MRR*@10': 0.10407496874149029, 'Recall*@5': 0.14966619817110208, 'NDCG*@5': 0.1095955824622741, 'MRR*@5': 0.09635367187169883}
INFO    [05-06 23:46:17] train in BasicTrainer:
duration: 5.73767614364624s
INFO    [05-06 23:46:17] train in BasicTrainer:
epoch: 49
INFO    [05-06 23:46:20] _train_one_epoch in BasicTrainer:
loss = 3.656383073076289
INFO    [05-06 23:46:22] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-06 23:46:23] validate in BasicTrainer:
{'Recall@10': 0.21012530877039984, 'NDCG@10': 0.1304485832269375, 'MRR@10': 0.10595316095994069, 'Recall@5': 0.15581564146738786, 'NDCG@5': 0.11287244466634896, 'MRR@5': 0.09868785223135582, 'Recall*@10': 0.21012530877039984, 'NDCG*@10': 0.1304485832269375, 'MRR*@10': 0.10595316095994069, 'Recall*@5': 0.15581564146738786, 'NDCG*@5': 0.11287244466634896, 'MRR*@5': 0.09868785223135582}
INFO    [05-06 23:46:23] train in BasicTrainer:
duration: 5.898406267166138s
INFO    [05-06 23:46:23] train in BasicTrainer:
epoch: 50
INFO    [05-06 23:46:26] _train_one_epoch in BasicTrainer:
loss = 3.644385591466376
INFO    [05-06 23:46:28] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-06 23:46:28] validate in BasicTrainer:
{'Recall@10': 0.2149538271702253, 'NDCG@10': 0.13308360427618027, 'MRR@10': 0.10804823671395962, 'Recall@5': 0.1550956781093891, 'NDCG@5': 0.11383473873138428, 'MRR@5': 0.10016367985652043, 'Recall*@10': 0.2149538271702253, 'NDCG*@10': 0.13308360427618027, 'MRR*@10': 0.10804823671395962, 'Recall*@5': 0.1550956781093891, 'NDCG*@5': 0.11383473873138428, 'MRR*@5': 0.10016367985652043}
INFO    [05-06 23:46:28] train in BasicTrainer:
duration: 5.437352657318115s
INFO    [05-06 23:46:28] train in BasicTrainer:
epoch: 51
INFO    [05-06 23:46:32] _train_one_epoch in BasicTrainer:
loss = 3.6312239880257464
INFO    [05-06 23:46:34] validate in BasicTrainer:
{'Recall@10': 0.2110475771702253, 'NDCG@10': 0.1318150506569789, 'MRR@10': 0.10740346232285866, 'Recall@5': 0.15930240887861985, 'NDCG@5': 0.11516681714699818, 'MRR@5': 0.10058454997264422, 'Recall*@10': 0.2110475771702253, 'NDCG*@10': 0.1318150506569789, 'MRR*@10': 0.10740346232285866, 'Recall*@5': 0.15930240887861985, 'NDCG*@5': 0.11516681714699818, 'MRR*@5': 0.10058454997264422}
INFO    [05-06 23:46:34] train in BasicTrainer:
duration: 5.823848009109497s
INFO    [05-06 23:46:34] train in BasicTrainer:
epoch: 52
INFO    [05-06 23:46:37] _train_one_epoch in BasicTrainer:
loss = 3.624176466718633
INFO    [05-06 23:46:40] validate in BasicTrainer:
{'Recall@10': 0.21236850206668562, 'NDCG@10': 0.13103284400243026, 'MRR@10': 0.10610308612768467, 'Recall@5': 0.15643742795173937, 'NDCG@5': 0.11311736473670372, 'MRR@5': 0.09880987955973698, 'Recall*@10': 0.21236850206668562, 'NDCG*@10': 0.13103284400243026, 'MRR*@10': 0.10610308612768467, 'Recall*@5': 0.15643742795173937, 'NDCG*@5': 0.11311736473670372, 'MRR*@5': 0.09880987955973698}
INFO    [05-06 23:46:40] train in BasicTrainer:
duration: 5.866763591766357s
INFO    [05-06 23:46:40] train in BasicTrainer:
epoch: 53
DEBUG   [05-06 23:46:41] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 533688
DEBUG   [05-06 23:46:41] calculate_loss in loss:
pred max in softmax: 0.5992452502250671, argmax 37139
DEBUG   [05-06 23:46:41] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 139812
DEBUG   [05-06 23:46:41] calculate_loss in loss:
pred max in softmax: 0.7355700135231018, argmax 102197
INFO    [05-06 23:46:43] _train_one_epoch in BasicTrainer:
loss = 3.615038699292122
INFO    [05-06 23:46:45] validate in BasicTrainer:
{'Recall@10': 0.21224950024714836, 'NDCG@10': 0.1289930916749514, 'MRR@10': 0.10339764562936929, 'Recall@5': 0.15691938767066368, 'NDCG@5': 0.11101456101124103, 'MRR@5': 0.09592337906360626, 'Recall*@10': 0.21224950024714836, 'NDCG*@10': 0.1289930916749514, 'MRR*@10': 0.10339764562936929, 'Recall*@5': 0.15691938767066368, 'NDCG*@5': 0.11101456101124103, 'MRR*@5': 0.09592337906360626}
INFO    [05-06 23:46:45] train in BasicTrainer:
duration: 5.738765001296997s
INFO    [05-06 23:46:45] train in BasicTrainer:
epoch: 54
INFO    [05-06 23:46:49] _train_one_epoch in BasicTrainer:
loss = 3.6182799694385936
INFO    [05-06 23:46:51] validate in BasicTrainer:
{'Recall@10': 0.214492692397191, 'NDCG@10': 0.13233996354616606, 'MRR@10': 0.10705806544193855, 'Recall@5': 0.1618669078900264, 'NDCG@5': 0.11536541695778187, 'MRR@5': 0.10007888909715873, 'Recall*@10': 0.214492692397191, 'NDCG*@10': 0.13233996354616606, 'MRR*@10': 0.10705806544193855, 'Recall*@5': 0.1618669078900264, 'NDCG*@5': 0.11536541695778187, 'MRR*@5': 0.10007888909715873}
INFO    [05-06 23:46:51] train in BasicTrainer:
duration: 5.586163759231567s
INFO    [05-06 23:46:51] train in BasicTrainer:
epoch: 55
INFO    [05-06 23:46:54] _train_one_epoch in BasicTrainer:
loss = 3.6004067557923336
INFO    [05-06 23:46:56] validate in BasicTrainer:
{'Recall@10': 0.21100592613220215, 'NDCG@10': 0.13106867671012878, 'MRR@10': 0.10642707749054982, 'Recall@5': 0.16022467613220215, 'NDCG@5': 0.11473542738419312, 'MRR@5': 0.09973661085734001, 'Recall*@10': 0.21100592613220215, 'NDCG*@10': 0.13106867671012878, 'MRR*@10': 0.10642707749054982, 'Recall*@5': 0.16022467613220215, 'NDCG*@5': 0.11473542738419312, 'MRR*@5': 0.09973661085734001}
INFO    [05-06 23:46:56] train in BasicTrainer:
duration: 5.2685699462890625s
INFO    [05-06 23:46:56] train in BasicTrainer:
epoch: 56
INFO    [05-06 23:47:00] _train_one_epoch in BasicTrainer:
loss = 3.5940204148596906
INFO    [05-06 23:47:02] validate in BasicTrainer:
{'Recall@10': 0.21236850206668562, 'NDCG@10': 0.1316790202489266, 'MRR@10': 0.10685168837125485, 'Recall@5': 0.157820829978356, 'NDCG@5': 0.11401416475956257, 'MRR@5': 0.09954947806321658, 'Recall*@10': 0.21236850206668562, 'NDCG*@10': 0.1316790202489266, 'MRR*@10': 0.10685168837125485, 'Recall*@5': 0.157820829978356, 'NDCG*@5': 0.11401416475956257, 'MRR*@5': 0.09954947806321658}
INFO    [05-06 23:47:02] train in BasicTrainer:
duration: 5.944295883178711s
INFO    [05-06 23:47:02] train in BasicTrainer:
epoch: 57
INFO    [05-06 23:47:06] _train_one_epoch in BasicTrainer:
loss = 3.5842912755113967
INFO    [05-06 23:47:07] validate in BasicTrainer:
{'Recall@10': 0.2075608097589933, 'NDCG@10': 0.129799858881877, 'MRR@10': 0.10584094891181359, 'Recall@5': 0.15902275305527908, 'NDCG@5': 0.1140248729632451, 'MRR@5': 0.09928504320291373, 'Recall*@10': 0.2075608097589933, 'NDCG*@10': 0.129799858881877, 'MRR*@10': 0.10584094891181359, 'Recall*@5': 0.15902275305527908, 'NDCG*@5': 0.1140248729632451, 'MRR*@5': 0.09928504320291373}
INFO    [05-06 23:47:07] train in BasicTrainer:
duration: 5.243915557861328s
INFO    [05-06 23:47:07] train in BasicTrainer:
epoch: 58
DEBUG   [05-06 23:47:09] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 818154
DEBUG   [05-06 23:47:09] calculate_loss in loss:
pred max in softmax: 0.6299058794975281, argmax 684949
DEBUG   [05-06 23:47:09] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 223693
DEBUG   [05-06 23:47:09] calculate_loss in loss:
pred max in softmax: 0.7796439528465271, argmax 155433
INFO    [05-06 23:47:11] _train_one_epoch in BasicTrainer:
loss = 3.5832386752392384
INFO    [05-06 23:47:13] validate in BasicTrainer:
{'Recall@10': 0.21627475206668562, 'NDCG@10': 0.1322498218371318, 'MRR@10': 0.10650005306188877, 'Recall@5': 0.15944223564404708, 'NDCG@5': 0.11397940321610524, 'MRR@5': 0.09902165428950237, 'Recall*@10': 0.21627475206668562, 'NDCG*@10': 0.1322498218371318, 'MRR*@10': 0.10650005306188877, 'Recall*@5': 0.15944223564404708, 'NDCG*@5': 0.11397940321610524, 'MRR*@5': 0.09902165428950237}
INFO    [05-06 23:47:13] train in BasicTrainer:
duration: 5.669252395629883s
INFO    [05-06 23:47:13] train in BasicTrainer:
epoch: 59
INFO    [05-06 23:47:17] _train_one_epoch in BasicTrainer:
loss = 3.5721366139168436
INFO    [05-06 23:47:18] validate in BasicTrainer:
{'Recall@10': 0.21266898283591637, 'NDCG@10': 0.13061873614788055, 'MRR@10': 0.10537594442184155, 'Recall@5': 0.15659808195554292, 'NDCG@5': 0.11239249946979377, 'MRR@5': 0.0977987079666211, 'Recall*@10': 0.21266898283591637, 'NDCG*@10': 0.13061873614788055, 'MRR*@10': 0.10537594442184155, 'Recall*@5': 0.15659808195554292, 'NDCG*@5': 0.11239249946979377, 'MRR*@5': 0.0977987079666211}
INFO    [05-06 23:47:18] train in BasicTrainer:
duration: 5.38335394859314s
INFO    [05-06 23:47:18] train in BasicTrainer:
epoch: 60
INFO    [05-06 23:47:22] _train_one_epoch in BasicTrainer:
loss = 3.564604019865077
INFO    [05-06 23:47:24] validate in BasicTrainer:
{'Recall@10': 0.21387090591283944, 'NDCG@10': 0.1322306698331466, 'MRR@10': 0.10713019222021103, 'Recall@5': 0.158240312567124, 'NDCG@5': 0.11428991705179214, 'MRR@5': 0.0997516830953268, 'Recall*@10': 0.21387090591283944, 'NDCG*@10': 0.1322306698331466, 'MRR*@10': 0.10713019222021103, 'Recall*@5': 0.158240312567124, 'NDCG*@5': 0.11428991705179214, 'MRR*@5': 0.0997516830953268}
INFO    [05-06 23:47:24] train in BasicTrainer:
duration: 5.759974718093872s
INFO    [05-06 23:47:24] train in BasicTrainer:
epoch: 61
INFO    [05-06 23:47:28] _train_one_epoch in BasicTrainer:
loss = 3.5578616337573274
INFO    [05-06 23:47:30] log in loggers:
Update Best NDCG@10 Model at 61
INFO    [05-06 23:47:30] validate in BasicTrainer:
{'Recall@10': 0.21897907898976252, 'NDCG@10': 0.13413893144864303, 'MRR@10': 0.10816324559541848, 'Recall@5': 0.1631878327864867, 'NDCG@5': 0.11627785689555682, 'MRR@5': 0.10089663244210757, 'Recall*@10': 0.21897907898976252, 'NDCG*@10': 0.13413893144864303, 'MRR*@10': 0.10816324559541848, 'Recall*@5': 0.1631878327864867, 'NDCG*@5': 0.11627785689555682, 'MRR*@5': 0.10089663244210757}
INFO    [05-06 23:47:30] train in BasicTrainer:
duration: 5.791151762008667s
INFO    [05-06 23:47:30] train in BasicTrainer:
epoch: 62
INFO    [05-06 23:47:34] _train_one_epoch in BasicTrainer:
loss = 3.554068519714031
INFO    [05-06 23:47:35] log in loggers:
Update Best NDCG@10 Model at 62
INFO    [05-06 23:47:36] validate in BasicTrainer:
{'Recall@10': 0.2162955770125756, 'NDCG@10': 0.13415778199067482, 'MRR@10': 0.10903828476484005, 'Recall@5': 0.15960288964785063, 'NDCG@5': 0.1158566354559018, 'MRR@5': 0.10150443991789451, 'Recall*@10': 0.2162955770125756, 'NDCG*@10': 0.13415778199067482, 'MRR*@10': 0.10903828476484005, 'Recall*@5': 0.15960288964785063, 'NDCG*@5': 0.1158566354559018, 'MRR*@5': 0.10150443991789451}
INFO    [05-06 23:47:36] train in BasicTrainer:
duration: 5.554335355758667s
INFO    [05-06 23:47:36] train in BasicTrainer:
epoch: 63
DEBUG   [05-06 23:47:39] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 380514
DEBUG   [05-06 23:47:39] calculate_loss in loss:
pred max in softmax: 0.325906902551651, argmax 218091
DEBUG   [05-06 23:47:39] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 734273
DEBUG   [05-06 23:47:39] calculate_loss in loss:
pred max in softmax: 0.6349846124649048, argmax 762612
INFO    [05-06 23:47:39] _train_one_epoch in BasicTrainer:
loss = 3.5450085059125374
INFO    [05-06 23:47:42] validate in BasicTrainer:
{'Recall@10': 0.2162955770125756, 'NDCG@10': 0.1341117941416227, 'MRR@10': 0.1088332270200436, 'Recall@5': 0.1604835058634098, 'NDCG@5': 0.11609396854272255, 'MRR@5': 0.10141836049465033, 'Recall*@10': 0.2162955770125756, 'NDCG*@10': 0.1341117941416227, 'MRR*@10': 0.1088332270200436, 'Recall*@5': 0.1604835058634098, 'NDCG*@5': 0.11609396854272255, 'MRR*@5': 0.10141836049465033}
INFO    [05-06 23:47:42] train in BasicTrainer:
duration: 6.151031970977783s
INFO    [05-06 23:47:42] train in BasicTrainer:
epoch: 64
INFO    [05-06 23:47:45] _train_one_epoch in BasicTrainer:
loss = 3.5414510660983147
INFO    [05-06 23:47:47] log in loggers:
Update Best NDCG@10 Model at 64
INFO    [05-06 23:47:48] validate in BasicTrainer:
{'Recall@10': 0.2132699443743779, 'NDCG@10': 0.13522722572088242, 'MRR@10': 0.1112680257512973, 'Recall@5': 0.1573388702594317, 'NDCG@5': 0.11715287027450708, 'MRR@5': 0.10381288425280498, 'Recall*@10': 0.2132699443743779, 'NDCG*@10': 0.13522722572088242, 'MRR*@10': 0.1112680257512973, 'Recall*@5': 0.1573388702594317, 'NDCG*@5': 0.11715287027450708, 'MRR*@5': 0.10381288425280498}
INFO    [05-06 23:47:48] train in BasicTrainer:
duration: 5.789245367050171s
INFO    [05-06 23:47:48] train in BasicTrainer:
epoch: 65
INFO    [05-06 23:47:51] _train_one_epoch in BasicTrainer:
loss = 3.537444495140238
INFO    [05-06 23:47:53] log in loggers:
Update Best NDCG@10 Model at 65
INFO    [05-06 23:47:53] validate in BasicTrainer:
{'Recall@10': 0.21535248481310332, 'NDCG@10': 0.1353418231010437, 'MRR@10': 0.11077010287688328, 'Recall@5': 0.16078398663264054, 'NDCG@5': 0.11766531089177498, 'MRR@5': 0.10345572691697341, 'Recall*@10': 0.21535248481310332, 'NDCG*@10': 0.1353418231010437, 'MRR*@10': 0.11077010287688328, 'Recall*@5': 0.16078398663264054, 'NDCG*@5': 0.11766531089177498, 'MRR*@5': 0.10345572691697341}
INFO    [05-06 23:47:53] train in BasicTrainer:
duration: 5.460721254348755s
INFO    [05-06 23:47:53] train in BasicTrainer:
epoch: 66
INFO    [05-06 23:47:57] _train_one_epoch in BasicTrainer:
loss = 3.520772015794795
INFO    [05-06 23:47:59] validate in BasicTrainer:
{'Recall@10': 0.21220784920912522, 'NDCG@10': 0.13198492561395353, 'MRR@10': 0.10730193211482121, 'Recall@5': 0.15930240887861985, 'NDCG@5': 0.11500809914790668, 'MRR@5': 0.10037535600937329, 'Recall*@10': 0.21220784920912522, 'NDCG*@10': 0.13198492561395353, 'MRR*@10': 0.10730193211482121, 'Recall*@5': 0.15930240887861985, 'NDCG*@5': 0.11500809914790668, 'MRR*@5': 0.10037535600937329}
INFO    [05-06 23:47:59] train in BasicTrainer:
duration: 5.708771467208862s
INFO    [05-06 23:47:59] train in BasicTrainer:
epoch: 67
INFO    [05-06 23:48:02] _train_one_epoch in BasicTrainer:
loss = 3.522015120120759
INFO    [05-06 23:48:04] validate in BasicTrainer:
{'Recall@10': 0.2174766751436087, 'NDCG@10': 0.13466400710436013, 'MRR@10': 0.1093080324622301, 'Recall@5': 0.1580796597095636, 'NDCG@5': 0.11548673705412792, 'MRR@5': 0.10140908796053666, 'Recall*@10': 0.2174766751436087, 'NDCG*@10': 0.13466400710436013, 'MRR*@10': 0.1093080324622301, 'Recall*@5': 0.1580796597095636, 'NDCG*@5': 0.11548673705412792, 'MRR*@5': 0.10140908796053666}
INFO    [05-06 23:48:04] train in BasicTrainer:
duration: 5.616401672363281s
INFO    [05-06 23:48:04] train in BasicTrainer:
epoch: 68
INFO    [05-06 23:48:08] _train_one_epoch in BasicTrainer:
loss = 3.5204680485928312
INFO    [05-06 23:48:10] validate in BasicTrainer:
{'Recall@10': 0.21056561745130098, 'NDCG@10': 0.13287117446844393, 'MRR@10': 0.10890489300856224, 'Recall@5': 0.1590019281093891, 'NDCG@5': 0.11614344842158832, 'MRR@5': 0.10196859733416484, 'Recall*@10': 0.21056561745130098, 'NDCG*@10': 0.13287117446844393, 'MRR*@10': 0.10890489300856224, 'Recall*@5': 0.1590019281093891, 'NDCG*@5': 0.11614344842158832, 'MRR*@5': 0.10196859733416484}
INFO    [05-06 23:48:10] train in BasicTrainer:
duration: 5.369194030761719s
INFO    [05-06 23:48:10] train in BasicTrainer:
epoch: 69
DEBUG   [05-06 23:48:11] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 263810
DEBUG   [05-06 23:48:11] calculate_loss in loss:
pred max in softmax: 0.5706978440284729, argmax 92797
DEBUG   [05-06 23:48:11] calculate_loss in loss:
soft_target max: 0.501916766166687, argmax 799291
DEBUG   [05-06 23:48:11] calculate_loss in loss:
pred max in softmax: 0.5305407643318176, argmax 911859
INFO    [05-06 23:48:13] _train_one_epoch in BasicTrainer:
loss = 3.5124801993370056
INFO    [05-06 23:48:16] validate in BasicTrainer:
{'Recall@10': 0.21761650305527908, 'NDCG@10': 0.13432705001189157, 'MRR@10': 0.10877611946601135, 'Recall@5': 0.16110529349400446, 'NDCG@5': 0.1160973608493805, 'MRR@5': 0.10128101190695396, 'Recall*@10': 0.21761650305527908, 'NDCG*@10': 0.13432705001189157, 'MRR*@10': 0.10877611946601135, 'Recall*@5': 0.16110529349400446, 'NDCG*@5': 0.1160973608493805, 'MRR*@5': 0.10128101190695396}
INFO    [05-06 23:48:16] train in BasicTrainer:
duration: 5.9003989696502686s
INFO    [05-06 23:48:16] train in BasicTrainer:
epoch: 70
INFO    [05-06 23:48:19] _train_one_epoch in BasicTrainer:
loss = 3.5055308811208037
INFO    [05-06 23:48:21] validate in BasicTrainer:
{'Recall@10': 0.2134097722860483, 'NDCG@10': 0.13407839662753618, 'MRR@10': 0.10969046388681118, 'Recall@5': 0.160183025094179, 'NDCG@5': 0.11686103905622776, 'MRR@5': 0.10258418550858131, 'Recall*@10': 0.2134097722860483, 'NDCG*@10': 0.13407839662753618, 'MRR*@10': 0.10969046388681118, 'Recall*@5': 0.160183025094179, 'NDCG*@5': 0.11686103905622776, 'MRR*@5': 0.10258418550858131}
INFO    [05-06 23:48:21] train in BasicTrainer:
duration: 5.760979652404785s
INFO    [05-06 23:48:21] train in BasicTrainer:
epoch: 71
INFO    [05-06 23:48:25] _train_one_epoch in BasicTrainer:
loss = 3.4997153015846902
INFO    [05-06 23:48:27] validate in BasicTrainer:
{'Recall@10': 0.21567379052822405, 'NDCG@10': 0.13289319494595894, 'MRR@10': 0.10748571845201346, 'Recall@5': 0.15717821740187132, 'NDCG@5': 0.11399069886941177, 'MRR@5': 0.09969421648062192, 'Recall*@10': 0.21567379052822405, 'NDCG*@10': 0.13289319494595894, 'MRR*@10': 0.10748571845201346, 'Recall*@5': 0.15717821740187132, 'NDCG*@5': 0.11399069886941177, 'MRR*@5': 0.09969421648062192}
INFO    [05-06 23:48:27] train in BasicTrainer:
duration: 5.4297192096710205s
INFO    [05-06 23:48:27] train in BasicTrainer:
epoch: 72
INFO    [05-06 23:48:30] _train_one_epoch in BasicTrainer:
loss = 3.4922253324630415
INFO    [05-06 23:48:33] validate in BasicTrainer:
{'Recall@10': 0.2126481578900264, 'NDCG@10': 0.13430604625206727, 'MRR@10': 0.1102073215521299, 'Recall@5': 0.1573388702594317, 'NDCG@5': 0.11635834952959648, 'MRR@5': 0.10276303612268887, 'Recall*@10': 0.2126481578900264, 'NDCG*@10': 0.13430604625206727, 'MRR*@10': 0.1102073215521299, 'Recall*@5': 0.1573388702594317, 'NDCG*@5': 0.11635834952959648, 'MRR*@5': 0.10276303612268887}
INFO    [05-06 23:48:33] train in BasicTrainer:
duration: 5.750289678573608s
INFO    [05-06 23:48:33] train in BasicTrainer:
epoch: 73
INFO    [05-06 23:48:36] _train_one_epoch in BasicTrainer:
loss = 3.4927401377799665
INFO    [05-06 23:48:38] validate in BasicTrainer:
{'Recall@10': 0.21220784920912522, 'NDCG@10': 0.13295874744653702, 'MRR@10': 0.10850992340307969, 'Recall@5': 0.16094463949020094, 'NDCG@5': 0.11627293492739017, 'MRR@5': 0.10156101561509646, 'Recall*@10': 0.21220784920912522, 'NDCG*@10': 0.13295874744653702, 'MRR*@10': 0.10850992340307969, 'Recall*@5': 0.16094463949020094, 'NDCG*@5': 0.11627293492739017, 'MRR*@5': 0.10156101561509646}
INFO    [05-06 23:48:38] train in BasicTrainer:
duration: 5.73987340927124s
INFO    [05-06 23:48:38] train in BasicTrainer:
epoch: 74
DEBUG   [05-06 23:48:40] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 256516
DEBUG   [05-06 23:48:40] calculate_loss in loss:
pred max in softmax: 0.4501909911632538, argmax 531885
DEBUG   [05-06 23:48:40] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 30402
DEBUG   [05-06 23:48:40] calculate_loss in loss:
pred max in softmax: 0.577965497970581, argmax 795023
INFO    [05-06 23:48:42] _train_one_epoch in BasicTrainer:
loss = 3.4860101988975036
INFO    [05-06 23:48:44] log in loggers:
Update Best NDCG@10 Model at 74
INFO    [05-06 23:48:44] validate in BasicTrainer:
{'Recall@10': 0.2171761943743779, 'NDCG@10': 0.13558686066132325, 'MRR@10': 0.1105251547235709, 'Recall@5': 0.16154560102866247, 'NDCG@5': 0.11771248510250679, 'MRR@5': 0.1032137074149572, 'Recall*@10': 0.2171761943743779, 'NDCG*@10': 0.13558686066132325, 'MRR*@10': 0.1105251547235709, 'Recall*@5': 0.16154560102866247, 'NDCG*@5': 0.11771248510250679, 'MRR*@5': 0.1032137074149572}
INFO    [05-06 23:48:44] train in BasicTrainer:
duration: 5.695653438568115s
INFO    [05-06 23:48:44] train in BasicTrainer:
epoch: 75
INFO    [05-06 23:48:47] _train_one_epoch in BasicTrainer:
loss = 3.4832662521524633
INFO    [05-06 23:48:49] log in loggers:
Update Best NDCG@10 Model at 75
INFO    [05-06 23:48:49] validate in BasicTrainer:
{'Recall@10': 0.216414579978356, 'NDCG@10': 0.13590544290267503, 'MRR@10': 0.11109918126693138, 'Recall@5': 0.1669542548748163, 'NDCG@5': 0.11999007486380063, 'MRR@5': 0.10457593890336844, 'Recall*@10': 0.216414579978356, 'NDCG*@10': 0.13590544290267503, 'MRR*@10': 0.11109918126693138, 'Recall*@5': 0.1669542548748163, 'NDCG*@5': 0.11999007486380063, 'MRR*@5': 0.10457593890336844}
INFO    [05-06 23:48:49] train in BasicTrainer:
duration: 5.429959535598755s
INFO    [05-06 23:48:49] train in BasicTrainer:
epoch: 76
INFO    [05-06 23:48:53] _train_one_epoch in BasicTrainer:
loss = 3.4673975541236555
INFO    [05-06 23:48:55] log in loggers:
Update Best NDCG@10 Model at 76
INFO    [05-06 23:48:55] validate in BasicTrainer:
{'Recall@10': 0.22184405877039984, 'NDCG@10': 0.1392690550822478, 'MRR@10': 0.11394009739160538, 'Recall@5': 0.16667460019771868, 'NDCG@5': 0.12159621027799752, 'MRR@5': 0.1067458912730217, 'Recall*@10': 0.22184405877039984, 'NDCG*@10': 0.1392690550822478, 'MRR*@10': 0.11394009739160538, 'Recall*@5': 0.16667460019771868, 'NDCG*@5': 0.12159621027799752, 'MRR*@5': 0.1067458912730217}
INFO    [05-06 23:48:55] train in BasicTrainer:
duration: 5.459787368774414s
INFO    [05-06 23:48:55] train in BasicTrainer:
epoch: 77
INFO    [05-06 23:48:58] _train_one_epoch in BasicTrainer:
loss = 3.4712453953763274
INFO    [05-06 23:49:01] validate in BasicTrainer:
{'Recall@10': 0.2182382895396306, 'NDCG@10': 0.13603786952220476, 'MRR@10': 0.11075632675335957, 'Recall@5': 0.1629081781093891, 'NDCG@5': 0.11808141836753258, 'MRR@5': 0.10331044689967082, 'Recall*@10': 0.2182382895396306, 'NDCG*@10': 0.13603786952220476, 'MRR*@10': 0.11075632675335957, 'Recall*@5': 0.1629081781093891, 'NDCG*@5': 0.11808141836753258, 'MRR*@5': 0.10331044689967082}
INFO    [05-06 23:49:01] train in BasicTrainer:
duration: 5.734830379486084s
INFO    [05-06 23:49:01] train in BasicTrainer:
epoch: 78
INFO    [05-06 23:49:04] _train_one_epoch in BasicTrainer:
loss = 3.4580917967126723
INFO    [05-06 23:49:06] validate in BasicTrainer:
{'Recall@10': 0.22006200024714836, 'NDCG@10': 0.13533754360217315, 'MRR@10': 0.10932441800832748, 'Recall@5': 0.16138494817110208, 'NDCG@5': 0.11629005865408824, 'MRR@5': 0.10141999618365215, 'Recall*@10': 0.22006200024714836, 'NDCG*@10': 0.13533754360217315, 'MRR*@10': 0.10932441800832748, 'Recall*@5': 0.16138494817110208, 'NDCG*@5': 0.11629005865408824, 'MRR*@5': 0.10141999618365215}
INFO    [05-06 23:49:06] train in BasicTrainer:
duration: 5.786669015884399s
INFO    [05-06 23:49:06] train in BasicTrainer:
epoch: 79
DEBUG   [05-06 23:49:09] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 376867
DEBUG   [05-06 23:49:09] calculate_loss in loss:
pred max in softmax: 0.8267439603805542, argmax 529868
DEBUG   [05-06 23:49:09] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 786499
DEBUG   [05-06 23:49:09] calculate_loss in loss:
pred max in softmax: 0.4637775421142578, argmax 548094
INFO    [05-06 23:49:10] _train_one_epoch in BasicTrainer:
loss = 3.454708590152416
INFO    [05-06 23:49:12] validate in BasicTrainer:
{'Recall@10': 0.21869942316642174, 'NDCG@10': 0.13756006841476148, 'MRR@10': 0.11259497702121735, 'Recall@5': 0.16246786942848793, 'NDCG@5': 0.1192966693869004, 'MRR@5': 0.10501545209151047, 'Recall*@10': 0.21869942316642174, 'NDCG*@10': 0.13756006841476148, 'MRR*@10': 0.11259497702121735, 'Recall*@5': 0.16246786942848793, 'NDCG*@5': 0.1192966693869004, 'MRR*@5': 0.10501545209151047}
INFO    [05-06 23:49:12] train in BasicTrainer:
duration: 5.887924671173096s
INFO    [05-06 23:49:12] close_training in BasicTrainer:
finished training
DEBUG   [05-06 23:49:12] debug_summary in loss:
loss nan summary: nan 0 times, not nan 15041 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-06 23:49:12] run_routine in Routine:
Finished training, Start final validation
INFO    [05-06 23:49:12] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-06 23:49:12] load_state_from_given_path in utils:
checkpoint epoch: 76
INFO    [05-06 23:49:12] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-06 23:49:14] validate in BasicTrainer:
{'Recall@10': 0.22184405877039984, 'NDCG@10': 0.1392690550822478, 'MRR@10': 0.11394009739160538, 'Recall@5': 0.16667460019771868, 'NDCG@5': 0.12159621027799752, 'MRR@5': 0.1067458912730217, 'Recall*@10': 0.22184405877039984, 'NDCG*@10': 0.1392690550822478, 'MRR*@10': 0.11394009739160538, 'Recall*@5': 0.16667460019771868, 'NDCG*@5': 0.12159621027799752, 'MRR*@5': 0.1067458912730217}
INFO    [05-06 23:49:14] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.22184405877039984, 'NDCG@10': 0.1392690550822478, 'MRR@10': 0.11394009739160538, 'Recall@5': 0.16667460019771868, 'NDCG@5': 0.12159621027799752, 'MRR@5': 0.1067458912730217, 'Recall*@10': 0.22184405877039984, 'NDCG*@10': 0.1392690550822478, 'MRR*@10': 0.11394009739160538, 'Recall*@5': 0.16667460019771868, 'NDCG*@5': 0.12159621027799752, 'MRR*@5': 0.1067458912730217}
INFO    [05-06 23:49:14] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-06 23:49:14] test in BasicTrainer:
Test model on test set!
INFO    [05-06 23:49:14] test_with_given_state_path in BasicTrainer:
Loading model params from ___lfms_soft_2020/soft_narm-T-3-al-0.5_05-06_23:41_0/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-06 23:49:14] load_state_from_given_path in utils:
checkpoint epoch: 76
INFO    [05-06 23:49:14] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-06 23:49:14] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-06 23:49:16] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.20533844255484068, 'NDCG@10': 0.12855309076034105, 'MRR@10': 0.1049012799675648, 'Recall@5': 0.1549766751436087, 'NDCG@5': 0.11223307767739663, 'MRR@5': 0.09814123637401141, 'Recall*@10': 0.20533844255484068, 'NDCG*@10': 0.12855309076034105, 'MRR*@10': 0.1049012799675648, 'Recall*@5': 0.1549766751436087, 'NDCG*@5': 0.11223307767739663, 'MRR*@5': 0.09814123637401141}
INFO    [05-06 23:49:16] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.20533844255484068, 'NDCG@10': 0.12855309076034105, 'MRR@10': 0.1049012799675648, 'Recall@5': 0.1549766751436087, 'NDCG@5': 0.11223307767739663, 'MRR@5': 0.09814123637401141, 'Recall*@10': 0.20533844255484068, 'NDCG*@10': 0.12855309076034105, 'MRR*@10': 0.1049012799675648, 'Recall*@5': 0.1549766751436087, 'NDCG*@5': 0.11223307767739663, 'MRR*@5': 0.09814123637401141}
