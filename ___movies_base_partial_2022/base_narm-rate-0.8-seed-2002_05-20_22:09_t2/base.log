INFO    [05-20 22:09:32] setup_train in utils:
{
    "experiment_dir": "___movies_base_partial_2022",
    "experiment_description": "base",
    "describe": "{config[model_code]}-rate-{config[sample_rate]}-seed-{config[sample_seed]}",
    "dataset_name": "movies.csv",
    "sched": "basic",
    "model_code": "narm",
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "do_sampling": true,
    "path_for_sample": "Data/Cache/movies-5-5.pkl",
    "sample_rate": 0.8,
    "sample_seed": 2002,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "do_remap": false,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "config_file": "config2.movies/narm/config_partial.json",
    "task_id": 2,
    "split": "leave_one_out",
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "mentor_code": "bert",
    "training_routine": null,
    "T": 1,
    "alpha": 0.1,
    "dvae_alpha": 0.5,
    "softmaxed_mentor": false,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-20 22:09:32] __init__ in BasicSched:
BasicScheduler attribs: tag=narm
WARNING [05-20 22:09:32] _load_sampled_dataset_from_path in utils:
file from /data/wushiguang-slurm/code/gitee-repos/soft-rec/Data/Cache/sampled_movies-5-5-rate-0.8-seed-2002.pkl not found. Regenerating.
DEBUG   [05-20 22:09:32] _resampling in utils:
loading full dataset from Data/Cache/movies-5-5.pkl
INFO    [05-20 22:09:32] _load_full_dataset_from_path in utils:
loading cache from Data/Cache/movies-5-5.pkl
INFO    [05-20 22:09:33] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-20 22:09:33] _check_dataset_cache in utils:
correct.
INFO    [05-20 22:09:39] __init__ in NextItemDataloader:
there are 21035 items in this dataset, 65724 users, padding_first? False
DEBUG   [05-20 22:09:51] generate_model in utils:
model_code_list=['narm']
INFO    [05-20 22:09:51] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-20 22:09:51] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-20 22:10:24] get_exist_path in utils:
dir ___movies_base_partial_2022/base_narm-rate-0.8-seed-2002_05-20_22:09_t2/narm_logs does not exist! Create one.
WARNING [05-20 22:10:25] get_exist_path in utils:
dir ___movies_base_partial_2022/base_narm-rate-0.8-seed-2002_05-20_22:09_t2/narm_logs/tb_vis does not exist! Create one.
WARNING [05-20 22:10:25] get_exist_path in utils:
dir ___movies_base_partial_2022/base_narm-rate-0.8-seed-2002_05-20_22:09_t2/narm_logs/checkpoint does not exist! Create one.
INFO    [05-20 22:10:25] __init__ in BasicSched:
NARM(
  (item_embedding): Embedding(21036, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
WARNING [05-20 22:10:25] get_path in utils:
Path is None
WARNING [05-20 22:10:25] load_state_from_given_path in utils:
Not given any path.
INFO    [05-20 22:10:25] assert_model_device in utils:
model narm has 5.60498046875 MB params.
INFO    [05-20 22:10:25] __init__ in BasicTrainer:
360448 iter per epoch
INFO    [05-20 22:10:25] _fit in BasicSched:
Start training.
INFO    [05-20 22:10:55] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-20 22:10:55] validate in BasicTrainer:
{'Recall@10': 0.0005744485294117647, 'NDCG@10': 0.000263072775423472, 'MRR@10': 0.00017014048802700606, 'Recall@5': 0.0003015854779411765, 'NDCG@5': 0.0001773798550643465, 'MRR@5': 0.00013619217454962542, 'Recall*@10': 0.0005568414430051823, 'NDCG*@10': 0.00025241938933237074, 'MRR*@10': 0.0001613404471273123, 'Recall*@5': 0.0003064671815509963, 'NDCG*@5': 0.0001739845782354036, 'MRR*@5': 0.00013040631850291153}
INFO    [05-20 22:10:55] train in BasicTrainer:
epoch: 0
INFO    [05-20 22:11:08] _train_one_epoch in BasicTrainer:
loss = 9.61186239936135
INFO    [05-20 22:11:33] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-20 22:11:34] validate in BasicTrainer:
{'Recall@10': 0.015130607575616416, 'NDCG@10': 0.007447865627267782, 'MRR@10': 0.0051452640361864775, 'Recall@5': 0.008840396178557593, 'NDCG@5': 0.005423590650453287, 'MRR@5': 0.004315590540714124, 'Recall*@10': 0.014391211792826653, 'NDCG*@10': 0.007010524955523365, 'MRR*@10': 0.004808736910276553, 'Recall*@5': 0.007946601712747532, 'NDCG*@5': 0.004931285018649171, 'MRR*@5': 0.003953168319319101}
INFO    [05-20 22:11:34] train in BasicTrainer:
duration: 38.51761865615845s
INFO    [05-20 22:11:34] train in BasicTrainer:
epoch: 1
INFO    [05-20 22:11:48] _train_one_epoch in BasicTrainer:
loss = 9.114464413036
INFO    [05-20 22:12:13] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-20 22:12:14] validate in BasicTrainer:
{'Recall@10': 0.015202413641792886, 'NDCG@10': 0.007582381175940528, 'MRR@10': 0.005272661554901039, 'Recall@5': 0.009386122281498769, 'NDCG@5': 0.00572501147604164, 'MRR@5': 0.004519769264494672, 'Recall*@10': 0.013700209064956973, 'NDCG*@10': 0.006603783653939471, 'MRR*@10': 0.004462935770040049, 'Recall*@5': 0.008022053605493377, 'NDCG*@5': 0.004793919075061293, 'MRR*@5': 0.0037312799352495108}
INFO    [05-20 22:12:14] train in BasicTrainer:
duration: 39.68051886558533s
INFO    [05-20 22:12:14] train in BasicTrainer:
epoch: 2
INFO    [05-20 22:12:26] _train_one_epoch in BasicTrainer:
loss = 9.026944149624217
INFO    [05-20 22:12:51] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-20 22:12:52] validate in BasicTrainer:
{'Recall@10': 0.01913127489387989, 'NDCG@10': 0.00942051613374668, 'MRR@10': 0.006509758107473745, 'Recall@5': 0.010997633751043501, 'NDCG@5': 0.0068052861675181806, 'MRR@5': 0.0054390243706567325, 'Recall*@10': 0.017477215870338327, 'NDCG*@10': 0.008684588623616625, 'MRR*@10': 0.006052389473873465, 'Recall*@5': 0.009980581591234487, 'NDCG*@5': 0.006274881087900961, 'MRR*@5': 0.005066421923830229}
INFO    [05-20 22:12:52] train in BasicTrainer:
duration: 38.03047585487366s
INFO    [05-20 22:12:52] train in BasicTrainer:
epoch: 3
INFO    [05-20 22:13:05] _train_one_epoch in BasicTrainer:
loss = 8.909064303744923
INFO    [05-20 22:13:31] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-20 22:13:31] validate in BasicTrainer:
{'Recall@10': 0.02898520603775978, 'NDCG@10': 0.01418485481511144, 'MRR@10': 0.009760011042303899, 'Recall@5': 0.01616155936875764, 'NDCG@5': 0.010045589769587797, 'MRR@5': 0.008056350518018007, 'Recall*@10': 0.028820720884729836, 'NDCG*@10': 0.014192192103056347, 'MRR*@10': 0.009825507644563913, 'Recall*@5': 0.01588378764469834, 'NDCG*@5': 0.010024768190787119, 'MRR*@5': 0.008115418693598579}
INFO    [05-20 22:13:31] train in BasicTrainer:
duration: 39.48647737503052s
INFO    [05-20 22:13:31] train in BasicTrainer:
epoch: 4
INFO    [05-20 22:13:44] _train_one_epoch in BasicTrainer:
loss = 8.71944604136727
INFO    [05-20 22:14:09] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-20 22:14:09] validate in BasicTrainer:
{'Recall@10': 0.034322382882237434, 'NDCG@10': 0.016571121016407713, 'MRR@10': 0.011251661378671141, 'Recall@5': 0.020122198607115185, 'NDCG@5': 0.012038975734921062, 'MRR@5': 0.009415868642356466, 'Recall*@10': 0.03336164223797181, 'NDCG*@10': 0.01615996373926892, 'MRR*@10': 0.011009850511875223, 'Recall*@5': 0.019448282744954613, 'NDCG*@5': 0.01171828614657416, 'MRR*@5': 0.009209935909465831}
INFO    [05-20 22:14:09] train in BasicTrainer:
duration: 38.18957209587097s
INFO    [05-20 22:14:09] train in BasicTrainer:
epoch: 5
INFO    [05-20 22:14:23] _train_one_epoch in BasicTrainer:
loss = 8.606622977690263
INFO    [05-20 22:14:49] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-20 22:14:49] validate in BasicTrainer:
{'Recall@10': 0.03825429980369175, 'NDCG@10': 0.018776477533666527, 'MRR@10': 0.012938402017907184, 'Recall@5': 0.022322519846698818, 'NDCG@5': 0.013682980912134927, 'MRR@5': 0.010870975045049015, 'Recall*@10': 0.03671446585041635, 'NDCG*@10': 0.018139176782878005, 'MRR*@10': 0.012572590864318259, 'Recall*@5': 0.021284976207158145, 'NDCG*@5': 0.01320309956174563, 'MRR*@5': 0.010567410917514387}
INFO    [05-20 22:14:49] train in BasicTrainer:
duration: 40.063568115234375s
INFO    [05-20 22:14:49] train in BasicTrainer:
epoch: 6
INFO    [05-20 22:15:02] _train_one_epoch in BasicTrainer:
loss = 8.52323690327731
INFO    [05-20 22:15:27] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-20 22:15:28] validate in BasicTrainer:
{'Recall@10': 0.04215749418910812, 'NDCG@10': 0.02089287417338175, 'MRR@10': 0.01451889140640988, 'Recall@5': 0.02454239666900214, 'NDCG@5': 0.01524405658025952, 'MRR@5': 0.012215164544827798, 'Recall*@10': 0.04037083685398102, 'NDCG*@10': 0.020240518209688804, 'MRR*@10': 0.01420552798492067, 'Recall*@5': 0.023479623500915134, 'NDCG*@5': 0.014816092820290257, 'MRR*@5': 0.011988741674405686}
INFO    [05-20 22:15:28] train in BasicTrainer:
duration: 38.15099740028381s
INFO    [05-20 22:15:28] train in BasicTrainer:
epoch: 7
INFO    [05-20 22:15:41] _train_one_epoch in BasicTrainer:
loss = 8.442022876306014
INFO    [05-20 22:16:07] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-20 22:16:07] validate in BasicTrainer:
{'Recall@10': 0.044397843453814, 'NDCG@10': 0.02203148795182214, 'MRR@10': 0.015319446649621515, 'Recall@5': 0.026125185739468124, 'NDCG@5': 0.016167132950880948, 'MRR@5': 0.012925392509821583, 'Recall*@10': 0.04310205009053735, 'NDCG*@10': 0.021394852877539748, 'MRR*@10': 0.014880832421648152, 'Recall*@5': 0.025399703861159438, 'NDCG*@5': 0.015708773150382674, 'MRR*@5': 0.012556724524235023}
INFO    [05-20 22:16:07] train in BasicTrainer:
duration: 39.57796263694763s
INFO    [05-20 22:16:07] train in BasicTrainer:
epoch: 8
INFO    [05-20 22:16:20] _train_one_epoch in BasicTrainer:
loss = 8.370796539566733
INFO    [05-20 22:16:45] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-20 22:16:45] validate in BasicTrainer:
{'Recall@10': 0.04747939307023497, 'NDCG@10': 0.023540715960895315, 'MRR@10': 0.016344608136397952, 'Recall@5': 0.028534813948413906, 'NDCG@5': 0.017481108689132857, 'MRR@5': 0.013882465715355733, 'Recall*@10': 0.04665234597290263, 'NDCG*@10': 0.02323363765197642, 'MRR*@10': 0.016205340240369823, 'Recall*@5': 0.027702666380826163, 'NDCG*@5': 0.017174024792278513, 'MRR*@5': 0.013743949560996364}
INFO    [05-20 22:16:45] train in BasicTrainer:
duration: 38.177555322647095s
INFO    [05-20 22:16:45] train in BasicTrainer:
epoch: 9
INFO    [05-20 22:17:00] _train_one_epoch in BasicTrainer:
loss = 8.306036179715937
INFO    [05-20 22:17:25] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-20 22:17:26] validate in BasicTrainer:
{'Recall@10': 0.04972890917869175, 'NDCG@10': 0.02530377927948447, 'MRR@10': 0.017943164443268496, 'Recall@5': 0.030519716989468124, 'NDCG@5': 0.019163907505571842, 'MRR@5': 0.015450817149351625, 'Recall*@10': 0.04875164172228645, 'NDCG*@10': 0.02489943040863556, 'MRR*@10': 0.01771756787510479, 'Recall*@5': 0.029996005818247795, 'NDCG*@5': 0.01891143072177382, 'MRR*@5': 0.015290805029080194}
INFO    [05-20 22:17:26] train in BasicTrainer:
duration: 40.435890197753906s
INFO    [05-20 22:17:26] train in BasicTrainer:
epoch: 10
INFO    [05-20 22:17:38] _train_one_epoch in BasicTrainer:
loss = 8.234228838573802
INFO    [05-20 22:18:03] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-20 22:18:04] validate in BasicTrainer:
{'Recall@10': 0.054674360901117325, 'NDCG@10': 0.027908290900728282, 'MRR@10': 0.01987893123398809, 'Recall@5': 0.03234359107035048, 'NDCG@5': 0.020743527504451135, 'MRR@5': 0.016955454669454518, 'Recall*@10': 0.054421150289914184, 'NDCG*@10': 0.027952141292831478, 'MRR*@10': 0.020024906296063873, 'Recall*@5': 0.03190377924372168, 'NDCG*@5': 0.020734920111649176, 'MRR*@5': 0.017084162627511165}
INFO    [05-20 22:18:04] train in BasicTrainer:
duration: 37.87138772010803s
INFO    [05-20 22:18:04] train in BasicTrainer:
epoch: 11
INFO    [05-20 22:18:17] _train_one_epoch in BasicTrainer:
loss = 8.151128552176736
INFO    [05-20 22:18:42] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-20 22:18:42] validate in BasicTrainer:
{'Recall@10': 0.057262434898053896, 'NDCG@10': 0.029309547122787025, 'MRR@10': 0.0208788039162755, 'Recall@5': 0.03578417112722116, 'NDCG@5': 0.022405070417067584, 'MRR@5': 0.018052921301740056, 'Recall*@10': 0.05668925581609502, 'NDCG*@10': 0.029400323681971607, 'MRR*@10': 0.021152941619648653, 'Recall*@5': 0.036346280509058165, 'NDCG*@5': 0.022861957330914104, 'MRR*@5': 0.018477691885303047}
INFO    [05-20 22:18:42] train in BasicTrainer:
duration: 38.75226831436157s
INFO    [05-20 22:18:42] train in BasicTrainer:
epoch: 12
INFO    [05-20 22:18:56] _train_one_epoch in BasicTrainer:
loss = 8.070672983472997
INFO    [05-20 22:19:22] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-20 22:19:23] validate in BasicTrainer:
{'Recall@10': 0.06062907002427999, 'NDCG@10': 0.03132166187552845, 'MRR@10': 0.022504233481252894, 'Recall@5': 0.03717506989179289, 'NDCG@5': 0.023820385775145364, 'MRR@5': 0.019456536618663985, 'Recall*@10': 0.060629902626661694, 'NDCG*@10': 0.031281130278811735, 'MRR*@10': 0.02245818038799745, 'Recall*@5': 0.03683806780506583, 'NDCG*@5': 0.023674381677718723, 'MRR*@5': 0.019369047244682032}
INFO    [05-20 22:19:23] train in BasicTrainer:
duration: 40.24231767654419s
INFO    [05-20 22:19:23] train in BasicTrainer:
epoch: 13
INFO    [05-20 22:19:36] _train_one_epoch in BasicTrainer:
loss = 8.004999209534038
INFO    [05-20 22:20:01] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-20 22:20:01] validate in BasicTrainer:
{'Recall@10': 0.06410662238212193, 'NDCG@10': 0.033139468773322946, 'MRR@10': 0.023814749191789067, 'Recall@5': 0.03979400512488449, 'NDCG@5': 0.025363153668449205, 'MRR@5': 0.020656104802208787, 'Recall*@10': 0.06401926388635355, 'NDCG*@10': 0.033174712977865166, 'MRR*@10': 0.02388949736076243, 'Recall*@5': 0.039747094078099024, 'NDCG*@5': 0.025417426710619646, 'MRR*@5': 0.020742220311042142}
INFO    [05-20 22:20:01] train in BasicTrainer:
duration: 38.89516615867615s
INFO    [05-20 22:20:01] train in BasicTrainer:
epoch: 14
INFO    [05-20 22:20:15] _train_one_epoch in BasicTrainer:
loss = 7.947572951967066
INFO    [05-20 22:20:41] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-20 22:20:42] validate in BasicTrainer:
{'Recall@10': 0.06694708698812653, 'NDCG@10': 0.03471817678826697, 'MRR@10': 0.024996666018577182, 'Recall@5': 0.04133065494106097, 'NDCG@5': 0.02648457490346011, 'MRR@5': 0.021627457976779518, 'Recall*@10': 0.06694050045574412, 'NDCG*@10': 0.03490313810898977, 'MRR*@10': 0.02525489399319186, 'Recall*@5': 0.04120755579103442, 'NDCG*@5': 0.026634476038024706, 'MRR*@5': 0.021873068557504344}
INFO    [05-20 22:20:42] train in BasicTrainer:
duration: 40.04038739204407s
INFO    [05-20 22:20:42] train in BasicTrainer:
epoch: 15
INFO    [05-20 22:20:54] _train_one_epoch in BasicTrainer:
loss = 7.8937799605456265
INFO    [05-20 22:21:19] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-20 22:21:20] validate in BasicTrainer:
{'Recall@10': 0.06859862651018535, 'NDCG@10': 0.03597620677422075, 'MRR@10': 0.0261268753777532, 'Recall@5': 0.04246213528163293, 'NDCG@5': 0.027563238406882566, 'MRR@5': 0.022677557652487475, 'Recall*@10': 0.06887330925639938, 'NDCG*@10': 0.03630909400389475, 'MRR*@10': 0.026482351233854014, 'Recall*@5': 0.04284728318452835, 'NDCG*@5': 0.027944510966977653, 'MRR*@5': 0.023060290115501952}
INFO    [05-20 22:21:20] train in BasicTrainer:
duration: 38.125415086746216s
INFO    [05-20 22:21:20] train in BasicTrainer:
epoch: 16
INFO    [05-20 22:21:33] _train_one_epoch in BasicTrainer:
loss = 7.849045840176669
INFO    [05-20 22:21:59] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-20 22:21:59] validate in BasicTrainer:
{'Recall@10': 0.07049125126179527, 'NDCG@10': 0.03702103379456436, 'MRR@10': 0.026893870795474333, 'Recall@5': 0.04523904380552909, 'NDCG@5': 0.02891897574505385, 'MRR@5': 0.023587447645909646, 'Recall*@10': 0.07061014938003876, 'NDCG*@10': 0.03743194218944101, 'MRR*@10': 0.02738331411691273, 'Recall*@5': 0.04567282471586676, 'NDCG*@5': 0.02943967918262762, 'MRR*@5': 0.02412653363802854}
INFO    [05-20 22:21:59] train in BasicTrainer:
duration: 39.35527586936951s
INFO    [05-20 22:21:59] train in BasicTrainer:
epoch: 17
INFO    [05-20 22:22:12] _train_one_epoch in BasicTrainer:
loss = 7.805398610505191
INFO    [05-20 22:22:37] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-20 22:22:37] validate in BasicTrainer:
{'Recall@10': 0.0713960076956188, 'NDCG@10': 0.038054796812288905, 'MRR@10': 0.027964453705969977, 'Recall@5': 0.04597146568052909, 'NDCG@5': 0.029913308646749046, 'MRR@5': 0.02465149190495996, 'Recall*@10': 0.07171323325704126, 'NDCG*@10': 0.03850549262236146, 'MRR*@10': 0.02844725242432426, 'Recall*@5': 0.046771283316261625, 'NDCG*@5': 0.03052298122030847, 'MRR*@5': 0.025201354997561258}
INFO    [05-20 22:22:37] train in BasicTrainer:
duration: 38.159167766571045s
INFO    [05-20 22:22:37] train in BasicTrainer:
epoch: 18
INFO    [05-20 22:22:51] _train_one_epoch in BasicTrainer:
loss = 7.763520192016255
INFO    [05-20 22:23:17] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-20 22:23:17] validate in BasicTrainer:
{'Recall@10': 0.07202270648935262, 'NDCG@10': 0.03858676465118632, 'MRR@10': 0.028467398246421534, 'Recall@5': 0.04662383150528459, 'NDCG@5': 0.030429313616717562, 'MRR@5': 0.02513311167850214, 'Recall*@10': 0.07313910104772624, 'NDCG*@10': 0.039041137103648746, 'MRR*@10': 0.02870066118810107, 'Recall*@5': 0.04747363859239746, 'NDCG*@5': 0.030780410065370446, 'MRR*@5': 0.025313866269939086}
INFO    [05-20 22:23:17] train in BasicTrainer:
duration: 39.84596347808838s
INFO    [05-20 22:23:17] train in BasicTrainer:
epoch: 19
INFO    [05-20 22:23:30] _train_one_epoch in BasicTrainer:
loss = 7.724915260618383
INFO    [05-20 22:23:55] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-20 22:23:55] validate in BasicTrainer:
{'Recall@10': 0.0748653100693927, 'NDCG@10': 0.03971867701586555, 'MRR@10': 0.029090697493623283, 'Recall@5': 0.04763736641582321, 'NDCG@5': 0.030974313288050538, 'MRR@5': 0.025517747463548884, 'Recall*@10': 0.07597771330791361, 'NDCG*@10': 0.04041080472662168, 'MRR*@10': 0.02966389640727464, 'Recall*@5': 0.04837107877520954, 'NDCG*@5': 0.03155110524419476, 'MRR*@5': 0.026047404472003963}
INFO    [05-20 22:23:55] train in BasicTrainer:
duration: 37.72862267494202s
INFO    [05-20 22:23:55] train in BasicTrainer:
epoch: 20
INFO    [05-20 22:24:08] _train_one_epoch in BasicTrainer:
loss = 7.688056046312505
INFO    [05-20 22:24:34] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-20 22:24:34] validate in BasicTrainer:
{'Recall@10': 0.07558642634574105, 'NDCG@10': 0.04028088051606627, 'MRR@10': 0.029600272393401933, 'Recall@5': 0.04874929106410812, 'NDCG@5': 0.03168230974937186, 'MRR@5': 0.02609725822420681, 'Recall*@10': 0.07583752405994079, 'NDCG*@10': 0.04058443678214269, 'MRR*@10': 0.029915462686296773, 'Recall*@5': 0.04925327397444669, 'NDCG*@5': 0.032085957991726255, 'MRR*@5': 0.02646413620780496}
INFO    [05-20 22:24:34] train in BasicTrainer:
duration: 39.182554483413696s
INFO    [05-20 22:24:34] train in BasicTrainer:
epoch: 21
INFO    [05-20 22:24:46] _train_one_epoch in BasicTrainer:
loss = 7.655490181662819
INFO    [05-20 22:25:11] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-20 22:25:12] validate in BasicTrainer:
{'Recall@10': 0.07566128802650116, 'NDCG@10': 0.040971853496397245, 'MRR@10': 0.030457731884192017, 'Recall@5': 0.04965099188334802, 'NDCG@5': 0.0326343137113487, 'MRR@5': 0.027059943579575595, 'Recall*@10': 0.07663965707316119, 'NDCG*@10': 0.04176503803361865, 'MRR*@10': 0.03119431688066791, 'Recall*@5': 0.05075640253284398, 'NDCG*@5': 0.03348761555903098, 'MRR*@5': 0.027832198449793982}
INFO    [05-20 22:25:12] train in BasicTrainer:
duration: 37.663960695266724s
INFO    [05-20 22:25:12] train in BasicTrainer:
epoch: 22
INFO    [05-20 22:25:25] _train_one_epoch in BasicTrainer:
loss = 7.620226177302274
INFO    [05-20 22:25:51] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-20 22:25:51] validate in BasicTrainer:
{'Recall@10': 0.07659171127221163, 'NDCG@10': 0.04143730507177465, 'MRR@10': 0.030801146126845303, 'Recall@5': 0.04982638205675518, 'NDCG@5': 0.03282684953335453, 'MRR@5': 0.02727391033926431, 'Recall*@10': 0.07791796282810323, 'NDCG*@10': 0.042422020479160195, 'MRR*@10': 0.03167180607424063, 'Recall*@5': 0.050978990600389594, 'NDCG*@5': 0.0337629783898592, 'MRR*@5': 0.02812883520827574}
INFO    [05-20 22:25:51] train in BasicTrainer:
duration: 39.47138261795044s
INFO    [05-20 22:25:51] train in BasicTrainer:
epoch: 23
INFO    [05-20 22:26:04] _train_one_epoch in BasicTrainer:
loss = 7.586212933063507
INFO    [05-20 22:26:29] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-20 22:26:29] validate in BasicTrainer:
{'Recall@10': 0.07975637255346074, 'NDCG@10': 0.04317104509648155, 'MRR@10': 0.032110884018680626, 'Recall@5': 0.051781645811655945, 'NDCG@5': 0.034203359747634214, 'MRR@5': 0.028455660404527888, 'Recall*@10': 0.08052645798991709, 'NDCG*@10': 0.043714222662589126, 'MRR*@10': 0.03257225946906735, 'Recall*@5': 0.052558678037980026, 'NDCG*@5': 0.03473749263759922, 'MRR*@5': 0.02890669455861344}
INFO    [05-20 22:26:29] train in BasicTrainer:
duration: 38.06790518760681s
INFO    [05-20 22:26:29] train in BasicTrainer:
epoch: 24
INFO    [05-20 22:26:43] _train_one_epoch in BasicTrainer:
loss = 7.555149018764496
INFO    [05-20 22:27:08] validate in BasicTrainer:
{'Recall@10': 0.07855308625627966, 'NDCG@10': 0.04272759968743605, 'MRR@10': 0.031881652772426605, 'Recall@5': 0.05114761367440224, 'NDCG@5': 0.03393046031979954, 'MRR@5': 0.028289196793647373, 'Recall*@10': 0.07985662931905073, 'NDCG*@10': 0.0436286961331087, 'MRR*@10': 0.03265865267637898, 'Recall*@5': 0.05213695129050928, 'NDCG*@5': 0.03473536078544224, 'MRR*@5': 0.029029629138462684}
INFO    [05-20 22:27:08] train in BasicTrainer:
duration: 38.755675077438354s
INFO    [05-20 22:27:08] train in BasicTrainer:
epoch: 25
INFO    [05-20 22:27:21] _train_one_epoch in BasicTrainer:
loss = 7.524337990717455
INFO    [05-20 22:27:48] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-20 22:27:48] validate in BasicTrainer:
{'Recall@10': 0.07942087027956457, 'NDCG@10': 0.043452723280471915, 'MRR@10': 0.0325194871162667, 'Recall@5': 0.05274079170297174, 'NDCG@5': 0.03485239067060106, 'MRR@5': 0.028986489728969687, 'Recall*@10': 0.08077611248282825, 'NDCG*@10': 0.04453830092268832, 'MRR*@10': 0.03350676245549146, 'Recall*@5': 0.05447796337744769, 'NDCG*@5': 0.03607048401061226, 'MRR*@5': 0.030033381327110177}
INFO    [05-20 22:27:48] train in BasicTrainer:
duration: 40.247292280197144s
INFO    [05-20 22:27:48] train in BasicTrainer:
epoch: 26
INFO    [05-20 22:28:01] _train_one_epoch in BasicTrainer:
loss = 7.490085184574127
INFO    [05-20 22:28:26] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-20 22:28:26] validate in BasicTrainer:
{'Recall@10': 0.079518343157628, 'NDCG@10': 0.04373777942622409, 'MRR@10': 0.032868155004347074, 'Recall@5': 0.053246489561655945, 'NDCG@5': 0.035307727644548696, 'MRR@5': 0.02942779682138387, 'Recall*@10': 0.08107800299630445, 'NDCG*@10': 0.044840137748157274, 'MRR*@10': 0.03382746206925196, 'Recall*@5': 0.05457986694048433, 'NDCG*@5': 0.03633936867117882, 'MRR*@5': 0.030359553173184395}
INFO    [05-20 22:28:26] train in BasicTrainer:
duration: 38.186949729919434s
INFO    [05-20 22:28:26] train in BasicTrainer:
epoch: 27
INFO    [05-20 22:28:40] _train_one_epoch in BasicTrainer:
loss = 7.459201742302287
INFO    [05-20 22:29:08] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-20 22:29:09] validate in BasicTrainer:
{'Recall@10': 0.08087960280039731, 'NDCG@10': 0.044762635055710286, 'MRR@10': 0.03380163561771898, 'Recall@5': 0.05359421429388663, 'NDCG@5': 0.035990696838673425, 'MRR@5': 0.030211573137956506, 'Recall*@10': 0.08255659569712247, 'NDCG*@10': 0.04563079883947092, 'MRR*@10': 0.03439657532555215, 'Recall*@5': 0.054991893032017874, 'NDCG*@5': 0.03675121222348774, 'MRR*@5': 0.0307521503418684}
INFO    [05-20 22:29:09] train in BasicTrainer:
duration: 42.56618881225586s
INFO    [05-20 22:29:09] train in BasicTrainer:
epoch: 28
INFO    [05-20 22:29:22] _train_one_epoch in BasicTrainer:
loss = 7.4322443496097215
INFO    [05-20 22:29:48] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-20 22:29:49] validate in BasicTrainer:
{'Recall@10': 0.08255680913434309, 'NDCG@10': 0.045961852459346544, 'MRR@10': 0.034885253099834215, 'Recall@5': 0.054283552529180754, 'NDCG@5': 0.03687192127108574, 'MRR@5': 0.03116412888116696, 'Recall*@10': 0.08394745255217832, 'NDCG*@10': 0.0467471603085013, 'MRR*@10': 0.035487838637302906, 'Recall*@5': 0.05516498163342476, 'NDCG*@5': 0.03749155976316508, 'MRR*@5': 0.03169755144592594}
INFO    [05-20 22:29:49] train in BasicTrainer:
duration: 39.90096163749695s
INFO    [05-20 22:29:49] train in BasicTrainer:
epoch: 29
INFO    [05-20 22:30:02] _train_one_epoch in BasicTrainer:
loss = 7.401540924202312
INFO    [05-20 22:30:30] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-20 22:30:31] validate in BasicTrainer:
{'Recall@10': 0.08193408259574105, 'NDCG@10': 0.04630398750305176, 'MRR@10': 0.03550180376452558, 'Recall@5': 0.05501291878959712, 'NDCG@5': 0.03764172950211693, 'MRR@5': 0.03195196839378161, 'Recall*@10': 0.08389085136792239, 'NDCG*@10': 0.04749234897248885, 'MRR*@10': 0.036448366940021515, 'Recall*@5': 0.05656526084331905, 'NDCG*@5': 0.03869734353878919, 'MRR*@5': 0.032842680044910484}
INFO    [05-20 22:30:31] train in BasicTrainer:
duration: 42.091876745224s
INFO    [05-20 22:30:31] train in BasicTrainer:
epoch: 30
INFO    [05-20 22:30:43] _train_one_epoch in BasicTrainer:
loss = 7.371259694749659
INFO    [05-20 22:31:09] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [05-20 22:31:10] validate in BasicTrainer:
{'Recall@10': 0.08361953891375486, 'NDCG@10': 0.04665059158030678, 'MRR@10': 0.03544341991929447, 'Recall@5': 0.05575145189376438, 'NDCG@5': 0.0377082616529044, 'MRR@5': 0.03179409146747168, 'Recall*@10': 0.08553407910992117, 'NDCG*@10': 0.04773906048606424, 'MRR*@10': 0.03626354772816686, 'Recall*@5': 0.05721715728149695, 'NDCG*@5': 0.03865120406536495, 'MRR*@5': 0.032553994261166626}
INFO    [05-20 22:31:10] train in BasicTrainer:
duration: 38.93605422973633s
INFO    [05-20 22:31:10] train in BasicTrainer:
epoch: 31
INFO    [05-20 22:31:23] _train_one_epoch in BasicTrainer:
loss = 7.346835976297205
INFO    [05-20 22:31:49] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-20 22:31:49] validate in BasicTrainer:
{'Recall@10': 0.0841622094021124, 'NDCG@10': 0.046975902117350525, 'MRR@10': 0.03572738784201005, 'Recall@5': 0.05594639764989123, 'NDCG@5': 0.03794612472548204, 'MRR@5': 0.03205636231338277, 'Recall*@10': 0.08564782405600828, 'NDCG*@10': 0.04805793415974168, 'MRR*@10': 0.036666549303952384, 'Recall*@5': 0.057496775379952264, 'NDCG*@5': 0.03903673611143056, 'MRR*@5': 0.03299218744916074}
INFO    [05-20 22:31:49] train in BasicTrainer:
duration: 39.57889175415039s
INFO    [05-20 22:31:49] train in BasicTrainer:
epoch: 32
INFO    [05-20 22:32:02] _train_one_epoch in BasicTrainer:
loss = 7.31890239498832
INFO    [05-20 22:32:27] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-20 22:32:27] validate in BasicTrainer:
{'Recall@10': 0.08533982888740652, 'NDCG@10': 0.04809788745992324, 'MRR@10': 0.03682946369928472, 'Recall@5': 0.05690554354120703, 'NDCG@5': 0.03897460265194669, 'MRR@5': 0.0331072720753796, 'Recall*@10': 0.08733481913805008, 'NDCG*@10': 0.0493074787013671, 'MRR*@10': 0.0378008980084868, 'Recall*@5': 0.05805881891180487, 'NDCG*@5': 0.039921294459525275, 'MRR*@5': 0.03397576006896356}
INFO    [05-20 22:32:27] train in BasicTrainer:
duration: 37.93753147125244s
INFO    [05-20 22:32:27] train in BasicTrainer:
epoch: 33
INFO    [05-20 22:32:41] _train_one_epoch in BasicTrainer:
loss = 7.296094195409254
INFO    [05-20 22:33:07] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-20 22:33:07] validate in BasicTrainer:
{'Recall@10': 0.08699961839353337, 'NDCG@10': 0.04842298894244082, 'MRR@10': 0.03676741855109439, 'Recall@5': 0.05689729333800428, 'NDCG@5': 0.038761333945919484, 'MRR@5': 0.032822309390586966, 'Recall*@10': 0.0889606699347496, 'NDCG*@10': 0.049733889453551346, 'MRR*@10': 0.03787923034499673, 'Recall*@5': 0.058092334910350686, 'NDCG*@5': 0.03981738417025875, 'MRR*@5': 0.03382487595081329}
INFO    [05-20 22:33:07] train in BasicTrainer:
duration: 39.749197244644165s
INFO    [05-20 22:33:07] train in BasicTrainer:
epoch: 34
INFO    [05-20 22:33:21] _train_one_epoch in BasicTrainer:
loss = 7.272917384451086
INFO    [05-20 22:33:46] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-20 22:33:46] validate in BasicTrainer:
{'Recall@10': 0.08750531647135229, 'NDCG@10': 0.04927037459085969, 'MRR@10': 0.0376634080620373, 'Recall@5': 0.05895614141927046, 'NDCG@5': 0.040093674817506, 'MRR@5': 0.03390858738737948, 'Recall*@10': 0.09019975627169889, 'NDCG*@10': 0.05095357820391655, 'MRR*@10': 0.039026527720339155, 'Recall*@5': 0.06113272554734174, 'NDCG*@5': 0.04160692038781503, 'MRR*@5': 0.03520015846280491}
INFO    [05-20 22:33:47] train in BasicTrainer:
duration: 39.426337003707886s
INFO    [05-20 22:33:47] train in BasicTrainer:
epoch: 35
INFO    [05-20 22:34:00] _train_one_epoch in BasicTrainer:
loss = 7.247038207270882
INFO    [05-20 22:34:26] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-20 22:34:26] validate in BasicTrainer:
{'Recall@10': 0.08793615286841112, 'NDCG@10': 0.050034099422833496, 'MRR@10': 0.03854219330584302, 'Recall@5': 0.05948445069439271, 'NDCG@5': 0.040940986398388356, 'MRR@5': 0.03485085004392792, 'Recall*@10': 0.0890930290607845, 'NDCG*@10': 0.05102466375512235, 'MRR*@10': 0.03945716032210518, 'Recall*@5': 0.061173333183807486, 'NDCG*@5': 0.042100862325990904, 'MRR*@5': 0.03583397650543381}
INFO    [05-20 22:34:26] train in BasicTrainer:
duration: 39.5463330745697s
INFO    [05-20 22:34:26] train in BasicTrainer:
epoch: 36
INFO    [05-20 22:34:39] _train_one_epoch in BasicTrainer:
loss = 7.2214286435734145
INFO    [05-20 22:35:04] validate in BasicTrainer:
{'Recall@10': 0.08779559635064181, 'NDCG@10': 0.0497317938681911, 'MRR@10': 0.038178870783132667, 'Recall@5': 0.05933869958800428, 'NDCG@5': 0.040589404675890416, 'MRR@5': 0.034440726589630634, 'Recall*@10': 0.08950363011921153, 'NDCG*@10': 0.05097956714384696, 'MRR*@10': 0.03927382454276085, 'Recall*@5': 0.060768102898317224, 'NDCG*@5': 0.04173160936026012, 'MRR*@5': 0.03548315638566718}
INFO    [05-20 22:35:04] train in BasicTrainer:
duration: 37.949687480926514s
INFO    [05-20 22:35:04] train in BasicTrainer:
epoch: 37
INFO    [05-20 22:35:17] _train_one_epoch in BasicTrainer:
loss = 7.199479699134827
INFO    [05-20 22:35:42] validate in BasicTrainer:
{'Recall@10': 0.08770942907123004, 'NDCG@10': 0.049756939139436275, 'MRR@10': 0.0382247297641109, 'Recall@5': 0.05924947669400888, 'NDCG@5': 0.04059094979482539, 'MRR@5': 0.03446302617735723, 'Recall*@10': 0.08944226450779859, 'NDCG*@10': 0.05089734604253488, 'MRR*@10': 0.039192626800607235, 'Recall*@5': 0.06026444364996517, 'NDCG*@5': 0.04149558132185655, 'MRR*@5': 0.03533174031797577}
INFO    [05-20 22:35:42] train in BasicTrainer:
duration: 38.30034279823303s
INFO    [05-20 22:35:42] train in BasicTrainer:
epoch: 38
INFO    [05-20 22:35:56] _train_one_epoch in BasicTrainer:
loss = 7.177244777029211
INFO    [05-20 22:36:23] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-20 22:36:23] validate in BasicTrainer:
{'Recall@10': 0.08835873928140192, 'NDCG@10': 0.05009965686237111, 'MRR@10': 0.038476733819526786, 'Recall@5': 0.059536700958714765, 'NDCG@5': 0.04081591766546754, 'MRR@5': 0.034666365669930685, 'Recall*@10': 0.09007781744003296, 'NDCG*@10': 0.05102867523536963, 'MRR*@10': 0.03916572987595025, 'Recall*@5': 0.06051084596444579, 'NDCG*@5': 0.041511141311596424, 'MRR*@5': 0.03526275177650592}
INFO    [05-20 22:36:23] train in BasicTrainer:
duration: 40.45978236198425s
INFO    [05-20 22:36:23] train in BasicTrainer:
epoch: 39
INFO    [05-20 22:36:36] _train_one_epoch in BasicTrainer:
loss = 7.155065482312983
INFO    [05-20 22:37:01] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [05-20 22:37:01] validate in BasicTrainer:
{'Recall@10': 0.08977438816252876, 'NDCG@10': 0.051182800136944824, 'MRR@10': 0.03946613235508695, 'Recall@5': 0.06115646265885409, 'NDCG@5': 0.04197909200892729, 'MRR@5': 0.035696221844238395, 'Recall*@10': 0.09082615945269079, 'NDCG*@10': 0.05212060405927546, 'MRR*@10': 0.04036435287664918, 'Recall*@5': 0.061831846833229065, 'NDCG*@5': 0.04279340453007642, 'MRR*@5': 0.036542372887625414}
INFO    [05-20 22:37:01] train in BasicTrainer:
duration: 38.621089220047s
INFO    [05-20 22:37:01] train in BasicTrainer:
epoch: 40
INFO    [05-20 22:37:15] _train_one_epoch in BasicTrainer:
loss = 7.133981444618919
INFO    [05-20 22:37:41] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [05-20 22:37:41] validate in BasicTrainer:
{'Recall@10': 0.08883571493275025, 'NDCG@10': 0.05125648484510534, 'MRR@10': 0.03983553301762132, 'Recall@5': 0.06116776825750575, 'NDCG@5': 0.04237593337893486, 'MRR@5': 0.03620920242632136, 'Recall*@10': 0.09025574344045975, 'NDCG*@10': 0.05231704869691063, 'MRR*@10': 0.0407808727639563, 'Recall*@5': 0.06246557240100468, 'NDCG*@5': 0.0434004248065107, 'MRR*@5': 0.03714193863903775}
INFO    [05-20 22:37:41] train in BasicTrainer:
duration: 40.10571599006653s
INFO    [05-20 22:37:41] train in BasicTrainer:
epoch: 41
INFO    [05-20 22:37:54] _train_one_epoch in BasicTrainer:
loss = 7.114751230586659
INFO    [05-20 22:38:20] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-20 22:38:20] validate in BasicTrainer:
{'Recall@10': 0.08978355500627966, 'NDCG@10': 0.051940071232178635, 'MRR@10': 0.040444498333860844, 'Recall@5': 0.061716549975030566, 'NDCG@5': 0.042934854021843744, 'MRR@5': 0.036769498797024, 'Recall*@10': 0.09140299085308523, 'NDCG*@10': 0.053194348207291436, 'MRR*@10': 0.04157821899827789, 'Recall*@5': 0.06300220638513565, 'NDCG*@5': 0.044079775538514644, 'MRR*@5': 0.037857129074194855}
INFO    [05-20 22:38:20] train in BasicTrainer:
duration: 38.645782709121704s
INFO    [05-20 22:38:20] train in BasicTrainer:
epoch: 42
INFO    [05-20 22:38:34] _train_one_epoch in BasicTrainer:
loss = 7.0945514982396904
INFO    [05-20 22:39:00] validate in BasicTrainer:
{'Recall@10': 0.08962252604610779, 'NDCG@10': 0.05175177796798594, 'MRR@10': 0.04023272434578223, 'Recall@5': 0.06160471566459712, 'NDCG@5': 0.04273158684372902, 'MRR@5': 0.03653343438225634, 'Recall*@10': 0.09143820843275856, 'NDCG*@10': 0.052871559034375584, 'MRR*@10': 0.041124396793106026, 'Recall*@5': 0.06316274886622149, 'NDCG*@5': 0.04376491137287196, 'MRR*@5': 0.037387484684586525}
INFO    [05-20 22:39:00] train in BasicTrainer:
duration: 39.56493043899536s
INFO    [05-20 22:39:00] train in BasicTrainer:
epoch: 43
INFO    [05-20 22:39:12] _train_one_epoch in BasicTrainer:
loss = 7.071849037300456
INFO    [05-20 22:39:38] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [05-20 22:39:38] validate in BasicTrainer:
{'Recall@10': 0.09017130776363261, 'NDCG@10': 0.0519666169934413, 'MRR@10': 0.040358194095246935, 'Recall@5': 0.06178010583800428, 'NDCG@5': 0.04282735419623992, 'MRR@5': 0.03661015498287538, 'Recall*@10': 0.09162288246785893, 'NDCG*@10': 0.05308388326974476, 'MRR*@10': 0.04136762658462805, 'Recall*@5': 0.06309894801062696, 'NDCG*@5': 0.043896774377893, 'MRR*@5': 0.037596702575683594}
INFO    [05-20 22:39:38] train in BasicTrainer:
duration: 38.152363777160645s
INFO    [05-20 22:39:38] train in BasicTrainer:
epoch: 44
INFO    [05-20 22:39:51] _train_one_epoch in BasicTrainer:
loss = 7.053412627090108
INFO    [05-20 22:40:17] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-20 22:40:17] validate in BasicTrainer:
{'Recall@10': 0.09204345985370524, 'NDCG@10': 0.05321263061726794, 'MRR@10': 0.04141417277209899, 'Recall@5': 0.06308392062783241, 'NDCG@5': 0.043857181773466224, 'MRR@5': 0.037557965473217124, 'Recall*@10': 0.09393407009980258, 'NDCG*@10': 0.05435237376128926, 'MRR*@10': 0.04232314196141327, 'Recall*@5': 0.06436431079226382, 'NDCG*@5': 0.04480790193466579, 'MRR*@5': 0.03839390560546342}
INFO    [05-20 22:40:17] train in BasicTrainer:
duration: 39.635719776153564s
INFO    [05-20 22:40:17] train in BasicTrainer:
epoch: 45
INFO    [05-20 22:40:31] _train_one_epoch in BasicTrainer:
loss = 7.039077579975128
INFO    [05-20 22:40:56] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-20 22:40:56] validate in BasicTrainer:
{'Recall@10': 0.09233373973299475, 'NDCG@10': 0.05341813318869647, 'MRR@10': 0.041612505036241865, 'Recall@5': 0.06286544703385409, 'NDCG@5': 0.043935323243632037, 'MRR@5': 0.037726490155738944, 'Recall*@10': 0.09394224689287298, 'NDCG*@10': 0.054591272245435155, 'MRR*@10': 0.042624488911207986, 'Recall*@5': 0.06464251240386683, 'NDCG*@5': 0.045150227625580394, 'MRR*@5': 0.038748102591318244}
INFO    [05-20 22:40:56] train in BasicTrainer:
duration: 38.638041496276855s
INFO    [05-20 22:40:56] train in BasicTrainer:
epoch: 46
INFO    [05-20 22:41:09] _train_one_epoch in BasicTrainer:
loss = 7.015408255837181
INFO    [05-20 22:41:35] validate in BasicTrainer:
{'Recall@10': 0.09165876271093593, 'NDCG@10': 0.0532094365095391, 'MRR@10': 0.04152466312927358, 'Recall@5': 0.06290333608494085, 'NDCG@5': 0.0439419159117867, 'MRR@5': 0.03771756194970187, 'Recall*@10': 0.0934471615097102, 'NDCG*@10': 0.05424768280457048, 'MRR*@10': 0.042332072906634384, 'Recall*@5': 0.06421997792580549, 'NDCG*@5': 0.04484667015426299, 'MRR*@5': 0.03848106852349113}
INFO    [05-20 22:41:35] train in BasicTrainer:
duration: 39.03176474571228s
INFO    [05-20 22:41:35] train in BasicTrainer:
epoch: 47
INFO    [05-20 22:41:48] _train_one_epoch in BasicTrainer:
loss = 6.997448276389729
INFO    [05-20 22:42:13] log in loggers:
Update Best NDCG@10 Model at 47
INFO    [05-20 22:42:13] validate in BasicTrainer:
{'Recall@10': 0.0922188500271124, 'NDCG@10': 0.05379468816168168, 'MRR@10': 0.04210407571757541, 'Recall@5': 0.0640717889456188, 'NDCG@5': 0.044759626774226915, 'MRR@5': 0.0384147844332106, 'Recall*@10': 0.0938760559348499, 'NDCG*@10': 0.055338476729743624, 'MRR*@10': 0.04358419841703247, 'Recall*@5': 0.06639323011040688, 'NDCG*@5': 0.04652984922423082, 'MRR*@5': 0.03999482818386134}
INFO    [05-20 22:42:13] train in BasicTrainer:
duration: 38.2298846244812s
INFO    [05-20 22:42:13] train in BasicTrainer:
epoch: 48
INFO    [05-20 22:42:27] _train_one_epoch in BasicTrainer:
loss = 6.983277499675751
INFO    [05-20 22:42:53] validate in BasicTrainer:
{'Recall@10': 0.09153562302098554, 'NDCG@10': 0.05366721311036278, 'MRR@10': 0.04215719068751616, 'Recall@5': 0.0631875047350631, 'NDCG@5': 0.04452372364261571, 'MRR@5': 0.03839707747101784, 'Recall*@10': 0.09303518998272278, 'NDCG*@10': 0.05488225839593831, 'MRR*@10': 0.043264755431343525, 'Recall*@5': 0.06476864876116023, 'NDCG*@5': 0.045741853468558365, 'MRR*@5': 0.03949195847791784}
INFO    [05-20 22:42:53] train in BasicTrainer:
duration: 39.507123708724976s
INFO    [05-20 22:42:53] train in BasicTrainer:
epoch: 49
INFO    [05-20 22:43:05] _train_one_epoch in BasicTrainer:
loss = 6.966325662352822
INFO    [05-20 22:43:31] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-20 22:43:31] validate in BasicTrainer:
{'Recall@10': 0.09362013769500396, 'NDCG@10': 0.054396897116128134, 'MRR@10': 0.04247066970257198, 'Recall@5': 0.0652032691766234, 'NDCG@5': 0.04527810676132932, 'MRR@5': 0.03874764854417128, 'Recall*@10': 0.09494658559560776, 'NDCG*@10': 0.05553492925622884, 'MRR*@10': 0.0435464009642601, 'Recall*@5': 0.06641959267504075, 'NDCG*@5': 0.04638551657690721, 'MRR*@5': 0.0398137824719443}
INFO    [05-20 22:43:31] train in BasicTrainer:
duration: 38.01353430747986s
INFO    [05-20 22:43:31] train in BasicTrainer:
epoch: 50
INFO    [05-20 22:43:44] _train_one_epoch in BasicTrainer:
loss = 6.948860450224443
INFO    [05-20 22:44:10] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-20 22:44:11] validate in BasicTrainer:
{'Recall@10': 0.09350830360370524, 'NDCG@10': 0.054609420983230364, 'MRR@10': 0.04277849460349364, 'Recall@5': 0.064821627429303, 'NDCG@5': 0.04535097541177974, 'MRR@5': 0.038968537002801895, 'Recall*@10': 0.09521580005393308, 'NDCG*@10': 0.05565733221523902, 'MRR*@10': 0.04361770904677756, 'Recall*@5': 0.06611382983186666, 'NDCG*@5': 0.04625902785097852, 'MRR*@5': 0.039746912853682745}
INFO    [05-20 22:44:11] train in BasicTrainer:
duration: 39.655969858169556s
INFO    [05-20 22:44:11] train in BasicTrainer:
epoch: 51
INFO    [05-20 22:44:23] _train_one_epoch in BasicTrainer:
loss = 6.933512205427343
INFO    [05-20 22:44:49] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [05-20 22:44:49] validate in BasicTrainer:
{'Recall@10': 0.09391866755836151, 'NDCG@10': 0.05522755445802913, 'MRR@10': 0.04346486093366847, 'Recall@5': 0.06502268441459712, 'NDCG@5': 0.04588424655444482, 'MRR@5': 0.039609112722032214, 'Recall*@10': 0.09557770324103973, 'NDCG*@10': 0.05654559766545015, 'MRR*@10': 0.044655256630743254, 'Recall*@5': 0.0665947882568135, 'NDCG*@5': 0.04713469743728638, 'MRR*@5': 0.04074901890228776}
INFO    [05-20 22:44:49] train in BasicTrainer:
duration: 38.24655079841614s
INFO    [05-20 22:44:49] train in BasicTrainer:
epoch: 52
INFO    [05-20 22:45:02] _train_one_epoch in BasicTrainer:
loss = 6.915862782434984
INFO    [05-20 22:45:28] validate in BasicTrainer:
{'Recall@10': 0.09431253154488171, 'NDCG@10': 0.05509296563618323, 'MRR@10': 0.043163579176453984, 'Recall@5': 0.06534688130897634, 'NDCG@5': 0.045774590881431806, 'MRR@5': 0.03934569634935435, 'Recall*@10': 0.09592265109805499, 'NDCG*@10': 0.055965637021205, 'MRR*@10': 0.04379382773357279, 'Recall*@5': 0.06662410979761797, 'NDCG*@5': 0.04652747862479266, 'MRR*@5': 0.03991929266382666}
INFO    [05-20 22:45:28] train in BasicTrainer:
duration: 39.060914516448975s
INFO    [05-20 22:45:28] train in BasicTrainer:
epoch: 53
INFO    [05-20 22:45:41] _train_one_epoch in BasicTrainer:
loss = 6.901969297365709
INFO    [05-20 22:46:08] log in loggers:
Update Best NDCG@10 Model at 53
INFO    [05-20 22:46:09] validate in BasicTrainer:
{'Recall@10': 0.09377291667110779, 'NDCG@10': 0.05539883695104543, 'MRR@10': 0.04374084753148696, 'Recall@5': 0.0652924920706188, 'NDCG@5': 0.04624986429424847, 'MRR@5': 0.040001082069733566, 'Recall*@10': 0.09610419106834076, 'NDCG*@10': 0.05710523290669217, 'MRR*@10': 0.04526297813829254, 'Recall*@5': 0.06700640084112391, 'NDCG*@5': 0.04776312520398813, 'MRR*@5': 0.04144734231864705}
INFO    [05-20 22:46:09] train in BasicTrainer:
duration: 40.880313873291016s
INFO    [05-20 22:46:09] train in BasicTrainer:
epoch: 54
INFO    [05-20 22:46:21] _train_one_epoch in BasicTrainer:
loss = 6.890166927467693
INFO    [05-20 22:46:47] validate in BasicTrainer:
{'Recall@10': 0.09381600031081368, 'NDCG@10': 0.05538245860268088, 'MRR@10': 0.04369486013756079, 'Recall@5': 0.06545352081165594, 'NDCG@5': 0.046255175243405736, 'MRR@5': 0.03995322633315535, 'Recall*@10': 0.09596432044225581, 'NDCG*@10': 0.05702815643128227, 'MRR*@10': 0.04517855736262658, 'Recall*@5': 0.06727766377084396, 'NDCG*@5': 0.04777473715298316, 'MRR*@5': 0.04137218787389643}
INFO    [05-20 22:46:47] train in BasicTrainer:
duration: 38.51254653930664s
INFO    [05-20 22:46:47] train in BasicTrainer:
epoch: 55
INFO    [05-20 22:47:01] _train_one_epoch in BasicTrainer:
loss = 6.875314934687181
INFO    [05-20 22:47:27] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [05-20 22:47:28] validate in BasicTrainer:
{'Recall@10': 0.09436997639782288, 'NDCG@10': 0.055737516897566175, 'MRR@10': 0.043967831003315305, 'Recall@5': 0.06612849783371477, 'NDCG@5': 0.046616623506826514, 'MRR@5': 0.040210669750676435, 'Recall*@10': 0.09594081780489754, 'NDCG*@10': 0.057146846371538496, 'MRR*@10': 0.04531559479587218, 'Recall*@5': 0.0678097715272623, 'NDCG*@5': 0.048065069405471575, 'MRR*@5': 0.04157667245496722}
INFO    [05-20 22:47:28] train in BasicTrainer:
duration: 40.93068814277649s
INFO    [05-20 22:47:28] train in BasicTrainer:
epoch: 56
INFO    [05-20 22:47:41] _train_one_epoch in BasicTrainer:
loss = 6.860287926413796
INFO    [05-20 22:48:09] validate in BasicTrainer:
{'Recall@10': 0.09260446402956457, 'NDCG@10': 0.055092722834909666, 'MRR@10': 0.043637096881866455, 'Recall@5': 0.06594180206165594, 'NDCG@5': 0.046513965024667626, 'MRR@5': 0.040121375199626476, 'Recall*@10': 0.09334125413614161, 'NDCG*@10': 0.0564111672780093, 'MRR*@10': 0.04510430202764623, 'Recall*@5': 0.06768612344475354, 'NDCG*@5': 0.048152144340907824, 'MRR*@5': 0.04171738883151727}
INFO    [05-20 22:48:09] train in BasicTrainer:
duration: 40.94300365447998s
INFO    [05-20 22:48:09] train in BasicTrainer:
epoch: 57
INFO    [05-20 22:48:23] _train_one_epoch in BasicTrainer:
loss = 6.848862935196269
INFO    [05-20 22:48:49] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-20 22:48:49] validate in BasicTrainer:
{'Recall@10': 0.09526556598789551, 'NDCG@10': 0.05621370738920044, 'MRR@10': 0.0443146853324245, 'Recall@5': 0.06745492403998095, 'NDCG@5': 0.0473000873975894, 'MRR@5': 0.040682903545744276, 'Recall*@10': 0.09664192927234314, 'NDCG*@10': 0.05759949302848648, 'MRR*@10': 0.04569833681863897, 'Recall*@5': 0.06873294667286031, 'NDCG*@5': 0.04864486350732691, 'MRR*@5': 0.042044113444931364}
INFO    [05-20 22:48:49] train in BasicTrainer:
duration: 40.34002184867859s
INFO    [05-20 22:48:49] train in BasicTrainer:
epoch: 58
INFO    [05-20 22:49:02] _train_one_epoch in BasicTrainer:
loss = 6.836285282265056
INFO    [05-20 22:49:28] validate in BasicTrainer:
{'Recall@10': 0.09338821952833849, 'NDCG@10': 0.055570064879515595, 'MRR@10': 0.044029817204265034, 'Recall@5': 0.06609366439721163, 'NDCG@5': 0.046803116140996706, 'MRR@5': 0.04044666645281455, 'Recall*@10': 0.09487606015275507, 'NDCG*@10': 0.05689745681250796, 'MRR*@10': 0.0452917152467896, 'Recall*@5': 0.0679483591195415, 'NDCG*@5': 0.04824929333785001, 'MRR*@5': 0.041757857755703086}
INFO    [05-20 22:49:28] train in BasicTrainer:
duration: 38.12854051589966s
INFO    [05-20 22:49:28] train in BasicTrainer:
epoch: 59
INFO    [05-20 22:49:41] _train_one_epoch in BasicTrainer:
loss = 6.8210734291510144
INFO    [05-20 22:50:08] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [05-20 22:50:09] validate in BasicTrainer:
{'Recall@10': 0.09567990241681829, 'NDCG@10': 0.05687244587084826, 'MRR@10': 0.04507795677465551, 'Recall@5': 0.06672555777956457, 'NDCG@5': 0.047563936123076606, 'MRR@5': 0.04126754731816404, 'Recall*@10': 0.09721118036438436, 'NDCG*@10': 0.058053630458958005, 'MRR*@10': 0.04614489372162258, 'Recall*@5': 0.06817906700512942, 'NDCG*@5': 0.04872030392289162, 'MRR*@5': 0.04232391736963216}
INFO    [05-20 22:50:09] train in BasicTrainer:
duration: 41.07860326766968s
INFO    [05-20 22:50:10] close_training in BasicTrainer:
finished training
INFO    [05-20 22:50:10] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-20 22:50:10] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-20 22:50:10] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-20 22:50:37] validate in BasicTrainer:
{'Recall@10': 0.09567990241681829, 'NDCG@10': 0.05687244587084826, 'MRR@10': 0.04507795677465551, 'Recall@5': 0.06672555777956457, 'NDCG@5': 0.047563936123076606, 'MRR@5': 0.04126754731816404, 'Recall*@10': 0.09721118036438436, 'NDCG*@10': 0.058053630458958005, 'MRR*@10': 0.04614489372162258, 'Recall*@5': 0.06817906700512942, 'NDCG*@5': 0.04872030392289162, 'MRR*@5': 0.04232391736963216}
INFO    [05-20 22:50:37] test in BasicTrainer:
Test model on test set!
INFO    [05-20 22:50:37] test_with_given_state_path in BasicTrainer:
Loading model params from ___movies_base_partial_2022/base_narm-rate-0.8-seed-2002_05-20_22:09_t2/narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-20 22:50:37] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-20 22:50:37] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-20 22:50:37] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-20 22:51:03] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.08301117358838811, 'NDCG@10': 0.048339539591003865, 'MRR@10': 0.03780634153415175, 'Recall@5': 0.0570983503232984, 'NDCG@5': 0.040017761290073395, 'MRR@5': 0.034405072274453496, 'Recall*@10': 0.08513835247825174, 'NDCG*@10': 0.050285657758221906, 'MRR*@10': 0.03967904672026634, 'Recall*@5': 0.05934920140049037, 'NDCG*@5': 0.042016870616113436, 'MRR*@5': 0.03630718282040428}
INFO    [05-20 22:51:03] _evaluate in BasicSched:
!!Final Result!!: {'Recall@10': 0.08301117358838811, 'NDCG@10': 0.048339539591003865, 'MRR@10': 0.03780634153415175, 'Recall@5': 0.0570983503232984, 'NDCG@5': 0.040017761290073395, 'MRR@5': 0.034405072274453496, 'Recall*@10': 0.08513835247825174, 'NDCG*@10': 0.050285657758221906, 'MRR*@10': 0.03967904672026634, 'Recall*@5': 0.05934920140049037, 'NDCG*@5': 0.042016870616113436, 'MRR*@5': 0.03630718282040428}
