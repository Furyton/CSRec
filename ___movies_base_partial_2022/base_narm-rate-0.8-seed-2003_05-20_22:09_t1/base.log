INFO    [05-20 22:09:32] setup_train in utils:
{
    "experiment_dir": "___movies_base_partial_2022",
    "experiment_description": "base",
    "describe": "{config[model_code]}-rate-{config[sample_rate]}-seed-{config[sample_seed]}",
    "dataset_name": "movies.csv",
    "sched": "basic",
    "model_code": "narm",
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "do_sampling": true,
    "path_for_sample": "Data/Cache/movies-5-5.pkl",
    "sample_rate": 0.8,
    "sample_seed": 2003,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "do_remap": false,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "config_file": "config2.movies/narm/config_partial.json",
    "task_id": 1,
    "split": "leave_one_out",
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "mentor_code": "bert",
    "training_routine": null,
    "T": 1,
    "alpha": 0.1,
    "dvae_alpha": 0.5,
    "softmaxed_mentor": false,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-20 22:09:32] __init__ in BasicSched:
BasicScheduler attribs: tag=narm
WARNING [05-20 22:09:32] _load_sampled_dataset_from_path in utils:
file from /data/wushiguang-slurm/code/gitee-repos/soft-rec/Data/Cache/sampled_movies-5-5-rate-0.8-seed-2003.pkl not found. Regenerating.
DEBUG   [05-20 22:09:32] _resampling in utils:
loading full dataset from Data/Cache/movies-5-5.pkl
INFO    [05-20 22:09:32] _load_full_dataset_from_path in utils:
loading cache from Data/Cache/movies-5-5.pkl
INFO    [05-20 22:09:33] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-20 22:09:33] _check_dataset_cache in utils:
correct.
INFO    [05-20 22:09:38] __init__ in NextItemDataloader:
there are 21035 items in this dataset, 65724 users, padding_first? False
DEBUG   [05-20 22:09:50] generate_model in utils:
model_code_list=['narm']
INFO    [05-20 22:09:50] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-20 22:09:50] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-20 22:10:24] get_exist_path in utils:
dir ___movies_base_partial_2022/base_narm-rate-0.8-seed-2003_05-20_22:09_t1/narm_logs does not exist! Create one.
WARNING [05-20 22:10:25] get_exist_path in utils:
dir ___movies_base_partial_2022/base_narm-rate-0.8-seed-2003_05-20_22:09_t1/narm_logs/tb_vis does not exist! Create one.
WARNING [05-20 22:10:25] get_exist_path in utils:
dir ___movies_base_partial_2022/base_narm-rate-0.8-seed-2003_05-20_22:09_t1/narm_logs/checkpoint does not exist! Create one.
INFO    [05-20 22:10:25] __init__ in BasicSched:
NARM(
  (item_embedding): Embedding(21036, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
WARNING [05-20 22:10:25] get_path in utils:
Path is None
WARNING [05-20 22:10:25] load_state_from_given_path in utils:
Not given any path.
INFO    [05-20 22:10:25] assert_model_device in utils:
model narm has 5.60498046875 MB params.
INFO    [05-20 22:10:25] __init__ in BasicTrainer:
360448 iter per epoch
INFO    [05-20 22:10:25] _fit in BasicSched:
Start training.
INFO    [05-20 22:10:55] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-20 22:10:55] validate in BasicTrainer:
{'Recall@10': 0.0005313648897058823, 'NDCG@10': 0.0002704097950139412, 'MRR@10': 0.00019176209196516806, 'Recall@5': 0.0003159466911764706, 'NDCG@5': 0.00020342247957801993, 'MRR@5': 0.00016563266249517363, 'Recall*@10': 0.0004429935207179583, 'NDCG*@10': 0.00020980808296692833, 'MRR*@10': 0.0001397273579855477, 'Recall*@5': 0.0002506637795116095, 'NDCG*@5': 0.00014968897020855153, 'MRR*@5': 0.00011610886705217555}
INFO    [05-20 22:10:55] train in BasicTrainer:
epoch: 0
INFO    [05-20 22:11:09] _train_one_epoch in BasicTrainer:
loss = 9.631151058457114
INFO    [05-20 22:11:36] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-20 22:11:37] validate in BasicTrainer:
{'Recall@10': 0.016463144846698818, 'NDCG@10': 0.007908162523937575, 'MRR@10': 0.0053566916407469444, 'Recall@5': 0.009058869964278796, 'NDCG@5': 0.005537088330396835, 'MRR@5': 0.004392091944978079, 'Recall*@10': 0.015975627719479447, 'NDCG*@10': 0.007701200789169353, 'MRR*@10': 0.005237757050267914, 'Recall*@5': 0.008373454377493438, 'NDCG*@5': 0.005259798483594376, 'MRR*@5': 0.0042405825327424445}
INFO    [05-20 22:11:37] train in BasicTrainer:
duration: 41.79574370384216s
INFO    [05-20 22:11:37] train in BasicTrainer:
epoch: 1
INFO    [05-20 22:11:51] _train_one_epoch in BasicTrainer:
loss = 9.11270272731781
INFO    [05-20 22:12:17] validate in BasicTrainer:
{'Recall@10': 0.015374748200616416, 'NDCG@10': 0.007458748241119525, 'MRR@10': 0.005076085025554194, 'Recall@5': 0.008760340073529412, 'NDCG@5': 0.005308085340349113, 'MRR@5': 0.004181745996260468, 'Recall*@10': 0.014695911777808386, 'NDCG*@10': 0.006836182602188166, 'MRR*@10': 0.004463813623742145, 'Recall*@5': 0.008233335225240272, 'NDCG*@5': 0.004724862999008859, 'MRR*@5': 0.0035800308071296007}
INFO    [05-20 22:12:17] train in BasicTrainer:
duration: 39.51963496208191s
INFO    [05-20 22:12:17] train in BasicTrainer:
epoch: 2
INFO    [05-20 22:12:29] _train_one_epoch in BasicTrainer:
loss = 9.031962329691106
INFO    [05-20 22:12:55] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-20 22:12:55] validate in BasicTrainer:
{'Recall@10': 0.016469255993690562, 'NDCG@10': 0.008145145304939327, 'MRR@10': 0.005667934587964898, 'Recall@5': 0.008990119485294117, 'NDCG@5': 0.005745897042181562, 'MRR@5': 0.00468893620349905, 'Recall*@10': 0.015280120293883717, 'NDCG*@10': 0.007514267160064157, 'MRR*@10': 0.0052108378149569035, 'Recall*@5': 0.008056042578947894, 'NDCG*@5': 0.0051988515564624005, 'MRR*@5': 0.004267201457610901}
INFO    [05-20 22:12:55] train in BasicTrainer:
duration: 38.27644181251526s
INFO    [05-20 22:12:55] train in BasicTrainer:
epoch: 3
INFO    [05-20 22:13:09] _train_one_epoch in BasicTrainer:
loss = 8.96746558492834
INFO    [05-20 22:13:35] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-20 22:13:35] validate in BasicTrainer:
{'Recall@10': 0.027411583811044693, 'NDCG@10': 0.01334641156170298, 'MRR@10': 0.009150564424036181, 'Recall@5': 0.015547082759439945, 'NDCG@5': 0.009582323433064362, 'MRR@5': 0.007639254155733129, 'Recall*@10': 0.026438598356702748, 'NDCG*@10': 0.01272420700201217, 'MRR*@10': 0.00864579131388489, 'Recall*@5': 0.01470103459980558, 'NDCG*@5': 0.009017606101491871, 'MRR*@5': 0.007167720413931152}
INFO    [05-20 22:13:35] train in BasicTrainer:
duration: 39.964558362960815s
INFO    [05-20 22:13:35] train in BasicTrainer:
epoch: 4
INFO    [05-20 22:13:48] _train_one_epoch in BasicTrainer:
loss = 8.788072521036321
INFO    [05-20 22:14:14] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-20 22:14:14] validate in BasicTrainer:
{'Recall@10': 0.033629989141927046, 'NDCG@10': 0.01658508855411235, 'MRR@10': 0.01149369518765632, 'Recall@5': 0.019148691721698818, 'NDCG@5': 0.011952942593351883, 'MRR@5': 0.009611929712050101, 'Recall*@10': 0.03322522068286643, 'NDCG*@10': 0.01632609810022747, 'MRR*@10': 0.011285675360875972, 'Recall*@5': 0.01852967792793232, 'NDCG*@5': 0.011625192402040256, 'MRR*@5': 0.0093759683179943}
INFO    [05-20 22:14:14] train in BasicTrainer:
duration: 39.07652544975281s
INFO    [05-20 22:14:14] train in BasicTrainer:
epoch: 5
INFO    [05-20 22:14:28] _train_one_epoch in BasicTrainer:
loss = 8.639134829694575
INFO    [05-20 22:14:54] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-20 22:14:54] validate in BasicTrainer:
{'Recall@10': 0.03819379933616694, 'NDCG@10': 0.01912364549934864, 'MRR@10': 0.013397932052612305, 'Recall@5': 0.022675438948413906, 'NDCG@5': 0.014159567161079715, 'MRR@5': 0.0113808492965558, 'Recall*@10': 0.037839902674450594, 'NDCG*@10': 0.019049199243240496, 'MRR*@10': 0.013400616124272346, 'Recall*@5': 0.022613685249405747, 'NDCG*@5': 0.014182380784083815, 'MRR*@5': 0.011425468139350414}
INFO    [05-20 22:14:54] train in BasicTrainer:
duration: 39.856120109558105s
INFO    [05-20 22:14:54] train in BasicTrainer:
epoch: 6
INFO    [05-20 22:15:07] _train_one_epoch in BasicTrainer:
loss = 8.55809543349526
INFO    [05-20 22:15:32] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-20 22:15:32] validate in BasicTrainer:
{'Recall@10': 0.04149687838028459, 'NDCG@10': 0.021110365331611213, 'MRR@10': 0.014986118794802357, 'Recall@5': 0.02492403830675518, 'NDCG@5': 0.015807662980959696, 'MRR@5': 0.012830939691732912, 'Recall*@10': 0.04056238240617163, 'NDCG*@10': 0.020851057132377344, 'MRR*@10': 0.01492120259824921, 'Recall*@5': 0.0246865731828353, 'NDCG*@5': 0.015766376355553374, 'MRR*@5': 0.012851860209861222}
INFO    [05-20 22:15:32] train in BasicTrainer:
duration: 38.14117074012756s
INFO    [05-20 22:15:32] train in BasicTrainer:
epoch: 7
INFO    [05-20 22:15:46] _train_one_epoch in BasicTrainer:
loss = 8.482594164935024
INFO    [05-20 22:16:12] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-20 22:16:12] validate in BasicTrainer:
{'Recall@10': 0.04362539355369175, 'NDCG@10': 0.022399949019446093, 'MRR@10': 0.016039761878988323, 'Recall@5': 0.025877989499884492, 'NDCG@5': 0.016709523165927213, 'MRR@5': 0.013720081899972522, 'Recall*@10': 0.04308555647730827, 'NDCG*@10': 0.022313334047794342, 'MRR*@10': 0.016093045582666117, 'Recall*@5': 0.025603009168716037, 'NDCG*@5': 0.016712311326580888, 'MRR*@5': 0.013812380459378748}
INFO    [05-20 22:16:12] train in BasicTrainer:
duration: 40.25938153266907s
INFO    [05-20 22:16:12] train in BasicTrainer:
epoch: 8
INFO    [05-20 22:16:25] _train_one_epoch in BasicTrainer:
loss = 8.396550807085903
INFO    [05-20 22:16:50] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-20 22:16:51] validate in BasicTrainer:
{'Recall@10': 0.04720958563334802, 'NDCG@10': 0.02387320129748653, 'MRR@10': 0.01684922944096958, 'Recall@5': 0.028804621494868222, 'NDCG@5': 0.017973394680987385, 'MRR@5': 0.01444466647637241, 'Recall*@10': 0.04727798809900003, 'NDCG*@10': 0.024095908464754328, 'MRR*@10': 0.01711119179997374, 'Recall*@5': 0.02920568800147842, 'NDCG*@5': 0.018299267682082513, 'MRR*@5': 0.014746464788913727}
INFO    [05-20 22:16:51] train in BasicTrainer:
duration: 38.407652616500854s
INFO    [05-20 22:16:51] train in BasicTrainer:
epoch: 9
INFO    [05-20 22:17:04] _train_one_epoch in BasicTrainer:
loss = 8.31702493537556
INFO    [05-20 22:17:30] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-20 22:17:30] validate in BasicTrainer:
{'Recall@10': 0.05158058882636182, 'NDCG@10': 0.02635245638735154, 'MRR@10': 0.018762714832144624, 'Recall@5': 0.03142661228775978, 'NDCG@5': 0.019911566091810957, 'MRR@5': 0.016149322118829277, 'Recall*@10': 0.05147899709203664, 'NDCG*@10': 0.026487880550763187, 'MRR*@10': 0.018972636967459145, 'Recall*@5': 0.031387577271636796, 'NDCG*@5': 0.020069064846371904, 'MRR*@5': 0.016369670903419748}
INFO    [05-20 22:17:30] train in BasicTrainer:
duration: 39.65251278877258s
INFO    [05-20 22:17:30] train in BasicTrainer:
epoch: 10
INFO    [05-20 22:17:43] _train_one_epoch in BasicTrainer:
loss = 8.243065628138455
INFO    [05-20 22:18:09] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-20 22:18:09] validate in BasicTrainer:
{'Recall@10': 0.053421879735063106, 'NDCG@10': 0.027584783404188996, 'MRR@10': 0.01978250384769019, 'Recall@5': 0.032995040144990474, 'NDCG@5': 0.021004665971678847, 'MRR@5': 0.017082118538810927, 'Recall*@10': 0.05402919409029624, 'NDCG*@10': 0.027845351792433682, 'MRR*@10': 0.01992924862048205, 'Recall*@5': 0.03363074482802082, 'NDCG*@5': 0.021274808903827387, 'MRR*@5': 0.017233068068676135}
INFO    [05-20 22:18:09] train in BasicTrainer:
duration: 38.53027963638306s
INFO    [05-20 22:18:09] train in BasicTrainer:
epoch: 11
INFO    [05-20 22:18:22] _train_one_epoch in BasicTrainer:
loss = 8.17206586490978
INFO    [05-20 22:18:48] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-20 22:18:48] validate in BasicTrainer:
{'Recall@10': 0.05706351688679527, 'NDCG@10': 0.029861890656106612, 'MRR@10': 0.021666507948847377, 'Recall@5': 0.03571755943052909, 'NDCG@5': 0.02302223739816862, 'MRR@5': 0.01888057019780664, 'Recall*@10': 0.058016485808526766, 'NDCG*@10': 0.030675361042513567, 'MRR*@10': 0.022439638043151182, 'Recall*@5': 0.03659911541377797, 'NDCG*@5': 0.023812132832758567, 'MRR*@5': 0.019644063130459365}
INFO    [05-20 22:18:48] train in BasicTrainer:
duration: 39.399086713790894s
INFO    [05-20 22:18:48] train in BasicTrainer:
epoch: 12
INFO    [05-20 22:19:02] _train_one_epoch in BasicTrainer:
loss = 8.10362606156956
INFO    [05-20 22:19:29] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-20 22:19:29] validate in BasicTrainer:
{'Recall@10': 0.060473235433592516, 'NDCG@10': 0.03146867103436414, 'MRR@10': 0.022735735949348, 'Recall@5': 0.03724901487722116, 'NDCG@5': 0.02400084661648554, 'MRR@5': 0.019678335636854172, 'Recall*@10': 0.061939398593762345, 'NDCG*@10': 0.032359684324439836, 'MRR*@10': 0.023447837461443508, 'Recall*@5': 0.038110675180659574, 'NDCG*@5': 0.024678777793751043, 'MRR*@5': 0.02029222107547171}
INFO    [05-20 22:19:29] train in BasicTrainer:
duration: 40.97904372215271s
INFO    [05-20 22:19:29] train in BasicTrainer:
epoch: 13
INFO    [05-20 22:19:42] _train_one_epoch in BasicTrainer:
loss = 8.03953355550766
INFO    [05-20 22:20:07] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-20 22:20:08] validate in BasicTrainer:
{'Recall@10': 0.06347167338518535, 'NDCG@10': 0.03353523123351967, 'MRR@10': 0.024508465519722772, 'Recall@5': 0.039759171578814, 'NDCG@5': 0.02593333087861538, 'MRR@5': 0.021410206551937497, 'Recall*@10': 0.0648541597320753, 'NDCG*@10': 0.034650063251747805, 'MRR*@10': 0.025534816634129074, 'Recall*@5': 0.041198307100464314, 'NDCG*@5': 0.02706826653550653, 'MRR*@5': 0.022445852265638465}
INFO    [05-20 22:20:08] train in BasicTrainer:
duration: 38.29631996154785s
INFO    [05-20 22:20:08] train in BasicTrainer:
epoch: 14
INFO    [05-20 22:20:21] _train_one_epoch in BasicTrainer:
loss = 7.9818859371272
INFO    [05-20 22:20:47] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-20 22:20:47] validate in BasicTrainer:
{'Recall@10': 0.06551921586779987, 'NDCG@10': 0.03455984263735659, 'MRR@10': 0.025243905865970778, 'Recall@5': 0.04082190135822577, 'NDCG@5': 0.02665997055523536, 'MRR@5': 0.022033880409948966, 'Recall*@10': 0.06718785534886752, 'NDCG*@10': 0.03565186064909486, 'MRR*@10': 0.026159192490227082, 'Recall*@5': 0.04212897314744837, 'NDCG*@5': 0.027642063248683426, 'MRR*@5': 0.022907671244705424}
INFO    [05-20 22:20:47] train in BasicTrainer:
duration: 39.79623341560364s
INFO    [05-20 22:20:47] train in BasicTrainer:
epoch: 15
INFO    [05-20 22:21:00] _train_one_epoch in BasicTrainer:
loss = 7.929953645576131
INFO    [05-20 22:21:25] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-20 22:21:25] validate in BasicTrainer:
{'Recall@10': 0.06847457017968683, 'NDCG@10': 0.0361209068009082, 'MRR@10': 0.026364837608793202, 'Recall@5': 0.043501337004058505, 'NDCG@5': 0.028147278353571892, 'MRR@5': 0.02313359278966399, 'Recall*@10': 0.0694722447763471, 'NDCG*@10': 0.03690046981415328, 'MRR*@10': 0.02708171954488053, 'Recall*@5': 0.04412077454959645, 'NDCG*@5': 0.028809124056030724, 'MRR*@5': 0.023804625277133548}
INFO    [05-20 22:21:25] train in BasicTrainer:
duration: 38.00099158287048s
INFO    [05-20 22:21:25] train in BasicTrainer:
epoch: 16
INFO    [05-20 22:21:39] _train_one_epoch in BasicTrainer:
loss = 7.880806993354451
INFO    [05-20 22:22:05] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-20 22:22:05] validate in BasicTrainer:
{'Recall@10': 0.06974752356900889, 'NDCG@10': 0.03718159128637875, 'MRR@10': 0.027352289899307138, 'Recall@5': 0.04376595007146106, 'NDCG@5': 0.028855535146944663, 'MRR@5': 0.023960935718872967, 'Recall*@10': 0.07032021244659144, 'NDCG*@10': 0.03788744822582778, 'MRR*@10': 0.02806641687365139, 'Recall*@5': 0.04513480054105029, 'NDCG*@5': 0.029815926600028488, 'MRR*@5': 0.02477838427704923}
INFO    [05-20 22:22:05] train in BasicTrainer:
duration: 39.65778112411499s
INFO    [05-20 22:22:05] train in BasicTrainer:
epoch: 17
INFO    [05-20 22:22:18] _train_one_epoch in BasicTrainer:
loss = 7.838020194660533
INFO    [05-20 22:22:43] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-20 22:22:43] validate in BasicTrainer:
{'Recall@10': 0.07201262300505358, 'NDCG@10': 0.038598712971981836, 'MRR@10': 0.028513423331520137, 'Recall@5': 0.04566682458800428, 'NDCG@5': 0.030158522703191814, 'MRR@5': 0.025076425360406145, 'Recall*@10': 0.07360806075089119, 'NDCG*@10': 0.03979045032140087, 'MRR*@10': 0.02956486482392339, 'Recall*@5': 0.04711462250527214, 'NDCG*@5': 0.03128748540492619, 'MRR*@5': 0.026092927245532766}
INFO    [05-20 22:22:43] train in BasicTrainer:
duration: 37.98503398895264s
INFO    [05-20 22:22:43] train in BasicTrainer:
epoch: 18
INFO    [05-20 22:22:56] _train_one_epoch in BasicTrainer:
loss = 7.7938132882118225
INFO    [05-20 22:23:22] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-20 22:23:23] validate in BasicTrainer:
{'Recall@10': 0.07274290612515281, 'NDCG@10': 0.038982436937444354, 'MRR@10': 0.02878589226919062, 'Recall@5': 0.04614685585393625, 'NDCG@5': 0.030444868128089345, 'MRR@5': 0.02529941575930399, 'Recall*@10': 0.07472663241274216, 'NDCG*@10': 0.040470902424524814, 'MRR*@10': 0.030107851194984773, 'Recall*@5': 0.0479651858263156, 'NDCG*@5': 0.031868948327267874, 'MRR*@5': 0.026588728432269657}
INFO    [05-20 22:23:23] train in BasicTrainer:
duration: 39.51959300041199s
INFO    [05-20 22:23:23] train in BasicTrainer:
epoch: 19
INFO    [05-20 22:23:35] _train_one_epoch in BasicTrainer:
loss = 7.752807400443337
INFO    [05-20 22:24:00] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-20 22:24:01] validate in BasicTrainer:
{'Recall@10': 0.07460680823115741, 'NDCG@10': 0.040342530783484966, 'MRR@10': 0.030002638697624207, 'Recall@5': 0.047935896279180754, 'NDCG@5': 0.031806826810626423, 'MRR@5': 0.026532077175729415, 'Recall*@10': 0.07631079260917271, 'NDCG*@10': 0.041716594249010086, 'MRR*@10': 0.031261071891469115, 'Recall*@5': 0.04997215617228957, 'NDCG*@5': 0.033296882010558075, 'MRR*@5': 0.02784298185039969}
INFO    [05-20 22:24:01] train in BasicTrainer:
duration: 38.077741384506226s
INFO    [05-20 22:24:01] train in BasicTrainer:
epoch: 20
INFO    [05-20 22:24:14] _train_one_epoch in BasicTrainer:
loss = 7.7149183479222385
INFO    [05-20 22:24:40] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-20 22:24:40] validate in BasicTrainer:
{'Recall@10': 0.07662562806816663, 'NDCG@10': 0.041251223972615075, 'MRR@10': 0.030546213226283297, 'Recall@5': 0.049308461739736444, 'NDCG@5': 0.03248713384656345, 'MRR@5': 0.02696984458495589, 'Recall*@10': 0.07927930924822302, 'NDCG*@10': 0.042885740890222436, 'MRR*@10': 0.03187105037710246, 'Recall*@5': 0.050983072861152536, 'NDCG*@5': 0.03380034820121877, 'MRR*@5': 0.028159592191086096}
INFO    [05-20 22:24:40] train in BasicTrainer:
duration: 39.19661474227905s
INFO    [05-20 22:24:40] train in BasicTrainer:
epoch: 21
INFO    [05-20 22:24:53] _train_one_epoch in BasicTrainer:
loss = 7.680227073756131
INFO    [05-20 22:25:18] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-20 22:25:18] validate in BasicTrainer:
{'Recall@10': 0.076344515032628, 'NDCG@10': 0.04143483060247758, 'MRR@10': 0.030868635129402664, 'Recall@5': 0.04932893396300428, 'NDCG@5': 0.0327651619034655, 'MRR@5': 0.02732900683494175, 'Recall*@10': 0.07840491173898473, 'NDCG*@10': 0.04305480486329864, 'MRR*@10': 0.03234146447742686, 'Recall*@5': 0.05112931439105202, 'NDCG*@5': 0.034294272937318855, 'MRR*@5': 0.0287603029214284}
INFO    [05-20 22:25:18] train in BasicTrainer:
duration: 38.42435312271118s
INFO    [05-20 22:25:18] train in BasicTrainer:
epoch: 22
INFO    [05-20 22:25:32] _train_one_epoch in BasicTrainer:
loss = 7.644817476922816
INFO    [05-20 22:25:58] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-20 22:25:58] validate in BasicTrainer:
{'Recall@10': 0.0770625756943927, 'NDCG@10': 0.04176468336406876, 'MRR@10': 0.031098621513913658, 'Recall@5': 0.04924887791275978, 'NDCG@5': 0.03284557076061473, 'MRR@5': 0.02746037667726769, 'Recall*@10': 0.0794537935186835, 'NDCG*@10': 0.043393182623035764, 'MRR*@10': 0.03249880923506092, 'Recall*@5': 0.05100066784550162, 'NDCG*@5': 0.03426880652413649, 'MRR*@5': 0.028776517904856625}
INFO    [05-20 22:25:58] train in BasicTrainer:
duration: 39.808945655822754s
INFO    [05-20 22:25:58] train in BasicTrainer:
epoch: 23
INFO    [05-20 22:26:11] _train_one_epoch in BasicTrainer:
loss = 7.609690059315074
INFO    [05-20 22:26:36] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-20 22:26:37] validate in BasicTrainer:
{'Recall@10': 0.07776627514292211, 'NDCG@10': 0.04277310410843176, 'MRR@10': 0.03218398758155458, 'Recall@5': 0.05062449876876438, 'NDCG@5': 0.034080066882512146, 'MRR@5': 0.02864533454618033, 'Recall*@10': 0.07991707062020022, 'NDCG*@10': 0.044476334662998426, 'MRR*@10': 0.033731442711809105, 'Recall*@5': 0.05262818669571596, 'NDCG*@5': 0.0357247939442887, 'MRR*@5': 0.030162721653194988}
INFO    [05-20 22:26:37] train in BasicTrainer:
duration: 38.45366072654724s
INFO    [05-20 22:26:37] train in BasicTrainer:
epoch: 24
INFO    [05-20 22:26:50] _train_one_epoch in BasicTrainer:
loss = 7.576280485499989
INFO    [05-20 22:27:15] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-20 22:27:16] validate in BasicTrainer:
{'Recall@10': 0.07861053110922084, 'NDCG@10': 0.04319895935409209, 'MRR@10': 0.03251072424737846, 'Recall@5': 0.05044391422587283, 'NDCG@5': 0.03411535414702752, 'MRR@5': 0.028776229961830026, 'Recall*@10': 0.08125122943345238, 'NDCG*@10': 0.0449829699800295, 'MRR*@10': 0.03404452388777452, 'Recall*@5': 0.05207425377824727, 'NDCG*@5': 0.035571640357375145, 'MRR*@5': 0.03017431278439129}
INFO    [05-20 22:27:16] train in BasicTrainer:
duration: 39.00984239578247s
INFO    [05-20 22:27:16] train in BasicTrainer:
epoch: 25
INFO    [05-20 22:27:29] _train_one_epoch in BasicTrainer:
loss = 7.544411518357017
INFO    [05-20 22:27:56] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-20 22:27:56] validate in BasicTrainer:
{'Recall@10': 0.08092788080958759, 'NDCG@10': 0.044461296980871874, 'MRR@10': 0.03344237300402978, 'Recall@5': 0.052448372849646735, 'NDCG@5': 0.03534581928568728, 'MRR@5': 0.02973533564192407, 'Recall*@10': 0.08332650670233895, 'NDCG*@10': 0.04622288114007782, 'MRR*@10': 0.03500392134575283, 'Recall*@5': 0.05428761594435748, 'NDCG*@5': 0.03691148779848043, 'MRR*@5': 0.03120727004373775}
INFO    [05-20 22:27:56] train in BasicTrainer:
duration: 40.80512881278992s
INFO    [05-20 22:27:56] train in BasicTrainer:
epoch: 26
INFO    [05-20 22:28:10] _train_one_epoch in BasicTrainer:
loss = 7.5144846710291775
INFO    [05-20 22:28:35] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-20 22:28:36] validate in BasicTrainer:
{'Recall@10': 0.08095965885064181, 'NDCG@10': 0.04450125532115207, 'MRR@10': 0.03343831112279611, 'Recall@5': 0.05432877514292212, 'NDCG@5': 0.03593018179868951, 'MRR@5': 0.029924373854609096, 'Recall*@10': 0.08403471594347674, 'NDCG*@10': 0.046581236974281424, 'MRR*@10': 0.035199839183512854, 'Recall*@5': 0.05714665134163464, 'NDCG*@5': 0.03792753147290034, 'MRR*@5': 0.031651582021047085}
INFO    [05-20 22:28:36] train in BasicTrainer:
duration: 39.31001114845276s
INFO    [05-20 22:28:36] train in BasicTrainer:
epoch: 27
INFO    [05-20 22:28:49] _train_one_epoch in BasicTrainer:
loss = 7.481986490162936
INFO    [05-20 22:29:17] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-20 22:29:17] validate in BasicTrainer:
{'Recall@10': 0.08182133164475947, 'NDCG@10': 0.04522778816959437, 'MRR@10': 0.034141883582753295, 'Recall@5': 0.053795271279180754, 'NDCG@5': 0.036202072658959555, 'MRR@5': 0.030437822618028697, 'Recall*@10': 0.08476067115278806, 'NDCG*@10': 0.0471941322526511, 'MRR*@10': 0.03580723494729575, 'Recall*@5': 0.055997197023209405, 'NDCG*@5': 0.037932036115842706, 'MRR*@5': 0.03200678242480054}
INFO    [05-20 22:29:17] train in BasicTrainer:
duration: 41.6990225315094s
INFO    [05-20 22:29:17] train in BasicTrainer:
epoch: 28
INFO    [05-20 22:29:30] _train_one_epoch in BasicTrainer:
loss = 7.449148779565638
INFO    [05-20 22:29:55] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-20 22:29:56] validate in BasicTrainer:
{'Recall@10': 0.08188794334145154, 'NDCG@10': 0.04527135850752101, 'MRR@10': 0.034168570466777855, 'Recall@5': 0.054679555489736444, 'NDCG@5': 0.0365371774224674, 'MRR@5': 0.030601153917172375, 'Recall*@10': 0.08424307844218086, 'NDCG*@10': 0.047058603342841655, 'MRR*@10': 0.035764075486975556, 'Recall*@5': 0.05719083832467303, 'NDCG*@5': 0.03836401760139886, 'MRR*@5': 0.03220685220816556}
INFO    [05-20 22:29:56] train in BasicTrainer:
duration: 38.53397250175476s
INFO    [05-20 22:29:56] train in BasicTrainer:
epoch: 29
INFO    [05-20 22:30:09] _train_one_epoch in BasicTrainer:
loss = 7.42094163461165
INFO    [05-20 22:30:37] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-20 22:30:38] validate in BasicTrainer:
{'Recall@10': 0.08396634678630267, 'NDCG@10': 0.04674637668273028, 'MRR@10': 0.035508300561238736, 'Recall@5': 0.05515653092195006, 'NDCG@5': 0.037530856973984665, 'MRR@5': 0.03176371446427177, 'Recall*@10': 0.08639962532941033, 'NDCG*@10': 0.04858511927373269, 'MRR*@10': 0.03715360394733794, 'Recall*@5': 0.05782578403458876, 'NDCG*@5': 0.03945112874840989, 'MRR*@5': 0.03344600012197214}
INFO    [05-20 22:30:38] train in BasicTrainer:
duration: 42.26070284843445s
INFO    [05-20 22:30:38] train in BasicTrainer:
epoch: 30
INFO    [05-20 22:30:51] _train_one_epoch in BasicTrainer:
loss = 7.38927857984196
INFO    [05-20 22:31:17] validate in BasicTrainer:
{'Recall@10': 0.08221214001669604, 'NDCG@10': 0.04597451296799323, 'MRR@10': 0.03496401592650834, 'Recall@5': 0.05537194912047947, 'NDCG@5': 0.03737573983038173, 'MRR@5': 0.031461706056314355, 'Recall*@10': 0.08516057449228623, 'NDCG*@10': 0.04798355501364259, 'MRR*@10': 0.03667225425734239, 'Recall*@5': 0.057847346233970975, 'NDCG*@5': 0.03922905904405257, 'MRR*@5': 0.03310416638851166}
INFO    [05-20 22:31:17] train in BasicTrainer:
duration: 38.997559547424316s
INFO    [05-20 22:31:17] train in BasicTrainer:
epoch: 31
INFO    [05-20 22:31:31] _train_one_epoch in BasicTrainer:
loss = 7.3644262606447395
INFO    [05-20 22:31:57] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-20 22:31:58] validate in BasicTrainer:
{'Recall@10': 0.08407604212270063, 'NDCG@10': 0.047078234307906204, 'MRR@10': 0.03588782754891059, 'Recall@5': 0.055963814477710164, 'NDCG@5': 0.03808973970658639, 'MRR@5': 0.03223776181831079, 'Recall*@10': 0.08736037506776698, 'NDCG*@10': 0.04931268095970154, 'MRR*@10': 0.0378035970908754, 'Recall*@5': 0.05838282691205249, 'NDCG*@5': 0.04004882078836946, 'MRR*@5': 0.03404244199833449}
INFO    [05-20 22:31:58] train in BasicTrainer:
duration: 40.52665328979492s
INFO    [05-20 22:31:58] train in BasicTrainer:
epoch: 32
INFO    [05-20 22:32:10] _train_one_epoch in BasicTrainer:
loss = 7.334951102733612
INFO    [05-20 22:32:36] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-20 22:32:36] validate in BasicTrainer:
{'Recall@10': 0.08404212532674565, 'NDCG@10': 0.047222937073777706, 'MRR@10': 0.03606944914688082, 'Recall@5': 0.05611353783923037, 'NDCG@5': 0.038293137269861555, 'MRR@5': 0.03244377354926923, 'Recall*@10': 0.08596355687169467, 'NDCG*@10': 0.048813330338281745, 'MRR*@10': 0.0375374087735134, 'Recall*@5': 0.058001734097214305, 'NDCG*@5': 0.03985177615986151, 'MRR*@5': 0.0338874383665183}
INFO    [05-20 22:32:36] train in BasicTrainer:
duration: 38.53880286216736s
INFO    [05-20 22:32:36] train in BasicTrainer:
epoch: 33
INFO    [05-20 22:32:50] _train_one_epoch in BasicTrainer:
loss = 7.308232128620148
INFO    [05-20 22:33:16] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-20 22:33:16] validate in BasicTrainer:
{'Recall@10': 0.08532241205958759, 'NDCG@10': 0.04804405394722434, 'MRR@10': 0.036731046350563276, 'Recall@5': 0.05752307571032468, 'NDCG@5': 0.039122059722157085, 'MRR@5': 0.03308905069442356, 'Recall*@10': 0.08768800602239721, 'NDCG*@10': 0.04996616590548964, 'MRR*@10': 0.038515250143759394, 'Recall*@5': 0.05964914030011963, 'NDCG*@5': 0.04096470773220062, 'MRR*@5': 0.034839344265706396}
INFO    [05-20 22:33:16] train in BasicTrainer:
duration: 39.93389868736267s
INFO    [05-20 22:33:16] train in BasicTrainer:
epoch: 34
INFO    [05-20 22:33:29] _train_one_epoch in BasicTrainer:
loss = 7.285134803165089
INFO    [05-20 22:33:54] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-20 22:33:55] validate in BasicTrainer:
{'Recall@10': 0.08537160692846074, 'NDCG@10': 0.04847676876713248, 'MRR@10': 0.037316698252278215, 'Recall@5': 0.05673931999241605, 'NDCG@5': 0.039275220650083875, 'MRR@5': 0.03355272530632861, 'Recall*@10': 0.08795502080636866, 'NDCG*@10': 0.050520489101900774, 'MRR*@10': 0.03919930821832489, 'Recall*@5': 0.059060894391115976, 'NDCG*@5': 0.04125073267256513, 'MRR*@5': 0.03541682353791069}
INFO    [05-20 22:33:55] train in BasicTrainer:
duration: 38.59288239479065s
INFO    [05-20 22:33:55] train in BasicTrainer:
epoch: 35
INFO    [05-20 22:34:08] _train_one_epoch in BasicTrainer:
loss = 7.2579702951691365
INFO    [05-20 22:34:35] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-20 22:34:35] validate in BasicTrainer:
{'Recall@10': 0.08748789964353337, 'NDCG@10': 0.049236133256379294, 'MRR@10': 0.037667092045440394, 'Recall@5': 0.05813755226485869, 'NDCG@5': 0.039858657866716385, 'MRR@5': 0.033863761736189615, 'Recall*@10': 0.09050930729683708, 'NDCG*@10': 0.05150407070622725, 'MRR*@10': 0.03968730700366637, 'Recall*@5': 0.06119395726743866, 'NDCG*@5': 0.04214709295946009, 'MRR*@5': 0.03589776706169633}
INFO    [05-20 22:34:35] train in BasicTrainer:
duration: 40.04365563392639s
INFO    [05-20 22:34:35] train in BasicTrainer:
epoch: 36
INFO    [05-20 22:34:48] _train_one_epoch in BasicTrainer:
loss = 7.2364825064485725
INFO    [05-20 22:35:13] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-20 22:35:13] validate in BasicTrainer:
{'Recall@10': 0.08689389553140192, 'NDCG@10': 0.0497749038040638, 'MRR@10': 0.038530838401878584, 'Recall@5': 0.058826890500152815, 'NDCG@5': 0.040790161884882874, 'MRR@5': 0.03487535664702163, 'Recall*@10': 0.08947716653347015, 'NDCG*@10': 0.0518339241252226, 'MRR*@10': 0.04042731641846545, 'Recall*@5': 0.06106615329489989, 'NDCG*@5': 0.042734816670417786, 'MRR*@5': 0.03672219517038149}
INFO    [05-20 22:35:13] train in BasicTrainer:
duration: 38.68569993972778s
INFO    [05-20 22:35:13] train in BasicTrainer:
epoch: 37
INFO    [05-20 22:35:27] _train_one_epoch in BasicTrainer:
loss = 7.2128341956572095
INFO    [05-20 22:35:53] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [05-20 22:35:53] validate in BasicTrainer:
{'Recall@10': 0.08885221490088631, 'NDCG@10': 0.050274160197552514, 'MRR@10': 0.03856402767055175, 'Recall@5': 0.059774730573682225, 'NDCG@5': 0.040917729191920334, 'MRR@5': 0.034730191506883674, 'Recall*@10': 0.09250900806749568, 'NDCG*@10': 0.052721278632388395, 'MRR*@10': 0.04063786916873034, 'Recall*@5': 0.06270810304319158, 'NDCG*@5': 0.043133179492810196, 'MRR*@5': 0.03670974831809016}
INFO    [05-20 22:35:53] train in BasicTrainer:
duration: 39.68612051010132s
INFO    [05-20 22:35:53] train in BasicTrainer:
epoch: 38
INFO    [05-20 22:36:07] _train_one_epoch in BasicTrainer:
loss = 7.1901271072301
INFO    [05-20 22:36:33] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-20 22:36:33] validate in BasicTrainer:
{'Recall@10': 0.08884915928630267, 'NDCG@10': 0.05040996784673018, 'MRR@10': 0.038744325146955604, 'Recall@5': 0.059685507679686826, 'NDCG@5': 0.041031332138706654, 'MRR@5': 0.034904231372125005, 'Recall*@10': 0.09162021428346634, 'NDCG*@10': 0.052571696612764805, 'MRR*@10': 0.040699211113593155, 'Recall*@5': 0.06250707870897125, 'NDCG*@5': 0.04319464393398341, 'MRR*@5': 0.03685133980915827}
INFO    [05-20 22:36:33] train in BasicTrainer:
duration: 40.11085629463196s
INFO    [05-20 22:36:33] train in BasicTrainer:
epoch: 39
INFO    [05-20 22:36:47] _train_one_epoch in BasicTrainer:
loss = 7.16737174987793
INFO    [05-20 22:37:13] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [05-20 22:37:13] validate in BasicTrainer:
{'Recall@10': 0.09078395103707033, 'NDCG@10': 0.05150138915461652, 'MRR@10': 0.03960936231648221, 'Recall@5': 0.06068468137699015, 'NDCG@5': 0.041850867955123675, 'MRR@5': 0.03567436907221289, 'Recall*@10': 0.09356188774108887, 'NDCG*@10': 0.053896419046556246, 'MRR*@10': 0.041869003106566036, 'Recall*@5': 0.06340077190714724, 'NDCG*@5': 0.04421183532651733, 'MRR*@5': 0.03791153398068512}
INFO    [05-20 22:37:13] train in BasicTrainer:
duration: 39.475348234176636s
INFO    [05-20 22:37:13] train in BasicTrainer:
epoch: 40
INFO    [05-20 22:37:27] _train_one_epoch in BasicTrainer:
loss = 7.145433176647533
INFO    [05-20 22:37:54] validate in BasicTrainer:
{'Recall@10': 0.09121264824095894, 'NDCG@10': 0.05133349820971489, 'MRR@10': 0.03925083533805959, 'Recall@5': 0.06033481788985869, 'NDCG@5': 0.041396785965737176, 'MRR@5': 0.03517794532372671, 'Recall*@10': 0.09444053208126742, 'NDCG*@10': 0.05362421274185181, 'MRR*@10': 0.04125591761925641, 'Recall*@5': 0.06295965064097853, 'NDCG*@5': 0.04350228454260265, 'MRR*@5': 0.03711235139738111}
INFO    [05-20 22:37:54] train in BasicTrainer:
duration: 41.53274178504944s
INFO    [05-20 22:37:54] train in BasicTrainer:
epoch: 41
INFO    [05-20 22:38:07] _train_one_epoch in BasicTrainer:
loss = 7.126496260816401
INFO    [05-20 22:38:33] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-20 22:38:33] validate in BasicTrainer:
{'Recall@10': 0.09066386652343414, 'NDCG@10': 0.05153523056822665, 'MRR@10': 0.03962311126730021, 'Recall@5': 0.06311172641375486, 'NDCG@5': 0.042692056692698425, 'MRR@5': 0.03601262718439102, 'Recall*@10': 0.09375834684161578, 'NDCG*@10': 0.05364843348369879, 'MRR*@10': 0.04141398343969794, 'Recall*@5': 0.0659525569747476, 'NDCG*@5': 0.04471404762829051, 'MRR*@5': 0.03776072086218525}
INFO    [05-20 22:38:33] train in BasicTrainer:
duration: 38.727871894836426s
INFO    [05-20 22:38:33] train in BasicTrainer:
epoch: 42
INFO    [05-20 22:38:47] _train_one_epoch in BasicTrainer:
loss = 7.105229545723308
INFO    [05-20 22:39:13] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-20 22:39:13] validate in BasicTrainer:
{'Recall@10': 0.08986361105652417, 'NDCG@10': 0.05202108139500899, 'MRR@10': 0.04053364453070304, 'Recall@5': 0.061914551345741045, 'NDCG@5': 0.0430489706204218, 'MRR@5': 0.03686885053620619, 'Recall*@10': 0.09226722840000601, 'NDCG*@10': 0.05407621404703926, 'MRR*@10': 0.04245886535328977, 'Recall*@5': 0.06430201473481514, 'NDCG*@5': 0.04507528113968232, 'MRR*@5': 0.03876857448588399}
INFO    [05-20 22:39:13] train in BasicTrainer:
duration: 39.94318413734436s
INFO    [05-20 22:39:13] train in BasicTrainer:
epoch: 43
INFO    [05-20 22:39:26] _train_one_epoch in BasicTrainer:
loss = 7.087808614427393
INFO    [05-20 22:39:51] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [05-20 22:39:51] validate in BasicTrainer:
{'Recall@10': 0.09083100671277326, 'NDCG@10': 0.0523327681071618, 'MRR@10': 0.04060332060736768, 'Recall@5': 0.06356822962270063, 'NDCG@5': 0.04355827784713577, 'MRR@5': 0.03700686158502803, 'Recall*@10': 0.09329680704018649, 'NDCG*@10': 0.05417786319466198, 'MRR*@10': 0.04225997166598544, 'Recall*@5': 0.06559046818053021, 'NDCG*@5': 0.045259696595809036, 'MRR*@5': 0.03860429652473506}
INFO    [05-20 22:39:51] train in BasicTrainer:
duration: 38.319177865982056s
INFO    [05-20 22:39:51] train in BasicTrainer:
epoch: 44
INFO    [05-20 22:40:05] _train_one_epoch in BasicTrainer:
loss = 7.068979572166096
INFO    [05-20 22:40:31] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-20 22:40:31] validate in BasicTrainer:
{'Recall@10': 0.09173270753201317, 'NDCG@10': 0.05295177505296819, 'MRR@10': 0.04117213737438707, 'Recall@5': 0.06306039278998095, 'NDCG@5': 0.04372214854640119, 'MRR@5': 0.03738845632795025, 'Recall*@10': 0.09368803965694764, 'NDCG*@10': 0.054504334488335776, 'MRR*@10': 0.042582665077027154, 'Recall*@5': 0.06516991577604238, 'NDCG*@5': 0.045308908995460064, 'MRR*@5': 0.03880420809282976}
INFO    [05-20 22:40:31] train in BasicTrainer:
duration: 40.16836428642273s
INFO    [05-20 22:40:31] train in BasicTrainer:
epoch: 45
INFO    [05-20 22:40:44] _train_one_epoch in BasicTrainer:
loss = 7.0507366548884995
INFO    [05-20 22:41:10] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-20 22:41:10] validate in BasicTrainer:
{'Recall@10': 0.09214307148666943, 'NDCG@10': 0.05296480721410583, 'MRR@10': 0.04109641098800827, 'Recall@5': 0.062089941519148206, 'NDCG@5': 0.04332150496980723, 'MRR@5': 0.03716056158437448, 'Recall*@10': 0.09504606311812121, 'NDCG*@10': 0.05518888112376718, 'MRR*@10': 0.04309147881234393, 'Recall*@5': 0.06499997066224322, 'NDCG*@5': 0.04554066850858576, 'MRR*@5': 0.03914934199522523}
INFO    [05-20 22:41:10] train in BasicTrainer:
duration: 38.760841369628906s
INFO    [05-20 22:41:10] train in BasicTrainer:
epoch: 46
INFO    [05-20 22:41:24] _train_one_epoch in BasicTrainer:
loss = 7.028346608985554
INFO    [05-20 22:41:50] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-20 22:41:50] validate in BasicTrainer:
{'Recall@10': 0.09349302553078707, 'NDCG@10': 0.05354228221318301, 'MRR@10': 0.041395223754293775, 'Recall@5': 0.06410570574157379, 'NDCG@5': 0.044092074474867654, 'MRR@5': 0.03752482726293452, 'Recall*@10': 0.09592619275345522, 'NDCG*@10': 0.05546628793372827, 'MRR*@10': 0.043136830496437406, 'Recall*@5': 0.06698111598105992, 'NDCG*@5': 0.04614774619831758, 'MRR*@5': 0.039314396021997225}
INFO    [05-20 22:41:50] train in BasicTrainer:
duration: 40.163790464401245s
INFO    [05-20 22:41:50] train in BasicTrainer:
epoch: 47
INFO    [05-20 22:42:03] _train_one_epoch in BasicTrainer:
loss = 7.014188034967943
INFO    [05-20 22:42:29] log in loggers:
Update Best NDCG@10 Model at 47
INFO    [05-20 22:42:29] validate in BasicTrainer:
{'Recall@10': 0.09297602185431648, 'NDCG@10': 0.05377653920475174, 'MRR@10': 0.04186011850833893, 'Recall@5': 0.06393337118275025, 'NDCG@5': 0.04440006394596661, 'MRR@5': 0.037999332279843444, 'Recall*@10': 0.09553102798321668, 'NDCG*@10': 0.05594125170918072, 'MRR*@10': 0.043893209713346815, 'Recall*@5': 0.06666307896375656, 'NDCG*@5': 0.04663706921479281, 'MRR*@5': 0.04007226491675658}
INFO    [05-20 22:42:29] train in BasicTrainer:
duration: 38.65709209442139s
INFO    [05-20 22:42:29] train in BasicTrainer:
epoch: 48
INFO    [05-20 22:42:42] _train_one_epoch in BasicTrainer:
loss = 6.996537295254794
INFO    [05-20 22:43:09] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-20 22:43:09] validate in BasicTrainer:
{'Recall@10': 0.09393211235018338, 'NDCG@10': 0.05420622558278196, 'MRR@10': 0.04214433098540587, 'Recall@5': 0.06467709865640192, 'NDCG@5': 0.044841269798138565, 'MRR@5': 0.03833478426232057, 'Recall*@10': 0.09649158181513057, 'NDCG*@10': 0.05628342071876807, 'MRR*@10': 0.04405110636178185, 'Recall*@5': 0.06715058360029669, 'NDCG*@5': 0.04687856773243231, 'MRR*@5': 0.040217764456482494}
INFO    [05-20 22:43:09] train in BasicTrainer:
duration: 39.834975242614746s
INFO    [05-20 22:43:09] train in BasicTrainer:
epoch: 49
INFO    [05-20 22:43:22] _train_one_epoch in BasicTrainer:
loss = 6.9794006456028335
INFO    [05-20 22:43:47] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-20 22:43:48] validate in BasicTrainer:
{'Recall@10': 0.09345299750566483, 'NDCG@10': 0.05447429615785094, 'MRR@10': 0.04262702254688039, 'Recall@5': 0.06443601364598554, 'NDCG@5': 0.045146424104185665, 'MRR@5': 0.038810266948798126, 'Recall*@10': 0.09608843133730047, 'NDCG*@10': 0.05668014770045, 'MRR*@10': 0.044688038527965546, 'Recall*@5': 0.0672424010494176, 'NDCG*@5': 0.0474170492414166, 'MRR*@5': 0.040902472375070345}
INFO    [05-20 22:43:48] train in BasicTrainer:
duration: 38.92469835281372s
INFO    [05-20 22:43:48] train in BasicTrainer:
epoch: 50
INFO    [05-20 22:44:01] _train_one_epoch in BasicTrainer:
loss = 6.9647321050817315
INFO    [05-20 22:44:27] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-20 22:44:27] validate in BasicTrainer:
{'Recall@10': 0.09529337199295268, 'NDCG@10': 0.05519641738604097, 'MRR@10': 0.04301870789598016, 'Recall@5': 0.06521151916069143, 'NDCG@5': 0.04552382296499084, 'MRR@5': 0.03905958726125605, 'Recall*@10': 0.09813487924197141, 'NDCG*@10': 0.05730385289472692, 'MRR*@10': 0.044911473989486694, 'Recall*@5': 0.06738087030894616, 'NDCG*@5': 0.04742090425947133, 'MRR*@5': 0.04086934906594893}
INFO    [05-20 22:44:27] train in BasicTrainer:
duration: 39.34166622161865s
INFO    [05-20 22:44:27] train in BasicTrainer:
epoch: 51
INFO    [05-20 22:44:40] _train_one_epoch in BasicTrainer:
loss = 6.949517499316823
INFO    [05-20 22:45:05] validate in BasicTrainer:
{'Recall@10': 0.09396389039123759, 'NDCG@10': 0.054872594116365206, 'MRR@10': 0.042955938507528865, 'Recall@5': 0.06566496675505358, 'NDCG@5': 0.045719252132317596, 'MRR@5': 0.03917655545999022, 'Recall*@10': 0.09724369250676211, 'NDCG*@10': 0.057385068825062585, 'MRR*@10': 0.04520801542436376, 'Recall*@5': 0.06892506975461454, 'NDCG*@5': 0.048222453278653765, 'MRR*@5': 0.041422974318265915}
INFO    [05-20 22:45:05] train in BasicTrainer:
duration: 37.965970277786255s
INFO    [05-20 22:45:05] train in BasicTrainer:
epoch: 52
INFO    [05-20 22:45:19] _train_one_epoch in BasicTrainer:
loss = 6.932854186404835
INFO    [05-20 22:45:46] log in loggers:
Update Best NDCG@10 Model at 52
INFO    [05-20 22:45:47] validate in BasicTrainer:
{'Recall@10': 0.09522767715594348, 'NDCG@10': 0.05601431692347807, 'MRR@10': 0.04404456738163443, 'Recall@5': 0.06785000992171905, 'NDCG@5': 0.04724356532096863, 'MRR@5': 0.040472909369889426, 'Recall*@10': 0.09765217234106625, 'NDCG*@10': 0.0581409628776943, 'MRR*@10': 0.046041952336535734, 'Recall*@5': 0.07086247118080363, 'NDCG*@5': 0.04954631451298209, 'MRR*@5': 0.04253470196443446}
INFO    [05-20 22:45:47] train in BasicTrainer:
duration: 42.12498211860657s
INFO    [05-20 22:45:47] train in BasicTrainer:
epoch: 53
INFO    [05-20 22:46:01] _train_one_epoch in BasicTrainer:
loss = 6.918256374922666
INFO    [05-20 22:46:28] validate in BasicTrainer:
{'Recall@10': 0.09483167397625306, 'NDCG@10': 0.05579396622145877, 'MRR@10': 0.043863722944960874, 'Recall@5': 0.06774948142907199, 'NDCG@5': 0.04705847712124095, 'MRR@5': 0.040271729669150186, 'Recall*@10': 0.09754264924456091, 'NDCG*@10': 0.05784513647941982, 'MRR*@10': 0.045693100594422394, 'Recall*@5': 0.07074440424056615, 'NDCG*@5': 0.049216415294829535, 'MRR*@5': 0.042154088178101706}
INFO    [05-20 22:46:28] train in BasicTrainer:
duration: 40.481642723083496s
INFO    [05-20 22:46:28] train in BasicTrainer:
epoch: 54
INFO    [05-20 22:46:41] _train_one_epoch in BasicTrainer:
loss = 6.900956798683513
INFO    [05-20 22:47:08] validate in BasicTrainer:
{'Recall@10': 0.09483167397625306, 'NDCG@10': 0.055549501277068085, 'MRR@10': 0.04356181511984152, 'Recall@5': 0.06690003109328888, 'NDCG@5': 0.04655813710654483, 'MRR@5': 0.03987577798611978, 'Recall*@10': 0.09796888512723587, 'NDCG*@10': 0.057952760992681276, 'MRR*@10': 0.045714949202888155, 'Recall*@5': 0.06989625052494161, 'NDCG*@5': 0.048882607808884454, 'MRR*@5': 0.04197701789876994}
INFO    [05-20 22:47:08] train in BasicTrainer:
duration: 39.88524842262268s
INFO    [05-20 22:47:08] train in BasicTrainer:
epoch: 55
INFO    [05-20 22:47:21] _train_one_epoch in BasicTrainer:
loss = 6.889979384162209
INFO    [05-20 22:47:48] validate in BasicTrainer:
{'Recall@10': 0.09530559401301776, 'NDCG@10': 0.055868191973251456, 'MRR@10': 0.04383980000720305, 'Recall@5': 0.0668887254946372, 'NDCG@5': 0.046710933832561266, 'MRR@5': 0.04007946283501737, 'Recall*@10': 0.09816170790616204, 'NDCG*@10': 0.05816606607507257, 'MRR*@10': 0.04592289205859689, 'Recall*@5': 0.07018174450187122, 'NDCG*@5': 0.04912581163294175, 'MRR*@5': 0.042196873794583714}
INFO    [05-20 22:47:48] train in BasicTrainer:
duration: 40.03580403327942s
INFO    [05-20 22:47:48] train in BasicTrainer:
epoch: 56
INFO    [05-20 22:48:00] _train_one_epoch in BasicTrainer:
loss = 6.8757543401284655
INFO    [05-20 22:48:27] validate in BasicTrainer:
{'Recall@10': 0.09616421119255178, 'NDCG@10': 0.055876468910890466, 'MRR@10': 0.04363301900379798, 'Recall@5': 0.066090608782628, 'NDCG@5': 0.04616582196424989, 'MRR@5': 0.03963342462392414, 'Recall*@10': 0.09926540579865961, 'NDCG*@10': 0.0580001905122224, 'MRR*@10': 0.04545135292060235, 'Recall*@5': 0.06866198602844686, 'NDCG*@5': 0.04809652707156013, 'MRR*@5': 0.041359023136251116}
INFO    [05-20 22:48:27] train in BasicTrainer:
duration: 39.24303340911865s
INFO    [05-20 22:48:27] train in BasicTrainer:
epoch: 57
INFO    [05-20 22:48:40] _train_one_epoch in BasicTrainer:
loss = 6.8622365322980015
INFO    [05-20 22:49:06] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-20 22:49:07] validate in BasicTrainer:
{'Recall@10': 0.0954122337348321, 'NDCG@10': 0.05630796161644599, 'MRR@10': 0.044370558551129174, 'Recall@5': 0.06767553660799475, 'NDCG@5': 0.047389446155113334, 'MRR@5': 0.04071837904698709, 'Recall*@10': 0.09847521913402221, 'NDCG*@10': 0.05876079004477052, 'MRR*@10': 0.04661409491125275, 'Recall*@5': 0.07050252903033705, 'NDCG*@5': 0.04975255973198835, 'MRR*@5': 0.042917327188393646}
INFO    [05-20 22:49:07] train in BasicTrainer:
duration: 40.144946813583374s
INFO    [05-20 22:49:07] train in BasicTrainer:
epoch: 58
INFO    [05-20 22:49:20] _train_one_epoch in BasicTrainer:
loss = 6.845247355374423
INFO    [05-20 22:49:45] validate in BasicTrainer:
{'Recall@10': 0.09515067628201317, 'NDCG@10': 0.05608635023236275, 'MRR@10': 0.04420969065497903, 'Recall@5': 0.06671333532123004, 'NDCG@5': 0.04697502382537898, 'MRR@5': 0.04049844294786453, 'Recall*@10': 0.09731034540078219, 'NDCG*@10': 0.05815964783815777, 'MRR*@10': 0.04622482946690391, 'Recall*@5': 0.06925186208065819, 'NDCG*@5': 0.049142292974626314, 'MRR*@5': 0.04253577923073488}
INFO    [05-20 22:49:45] train in BasicTrainer:
duration: 38.33429026603699s
INFO    [05-20 22:49:45] train in BasicTrainer:
epoch: 59
INFO    [05-20 22:49:59] _train_one_epoch in BasicTrainer:
loss = 6.837130812081424
INFO    [05-20 22:50:26] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [05-20 22:50:27] validate in BasicTrainer:
{'Recall@10': 0.09661246441742953, 'NDCG@10': 0.05679718558402622, 'MRR@10': 0.04467294693869703, 'Recall@5': 0.06767248099341112, 'NDCG@5': 0.04749443886034629, 'MRR@5': 0.04086531611049876, 'Recall*@10': 0.09957973527557709, 'NDCG*@10': 0.0590078922755578, 'MRR*@10': 0.04663964054163765, 'Recall*@5': 0.07034737003200195, 'NDCG*@5': 0.04961865022778511, 'MRR*@5': 0.042800635318545735}
INFO    [05-20 22:50:27] train in BasicTrainer:
duration: 41.26264667510986s
INFO    [05-20 22:50:27] close_training in BasicTrainer:
finished training
INFO    [05-20 22:50:27] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-20 22:50:27] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-20 22:50:27] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-20 22:50:53] validate in BasicTrainer:
{'Recall@10': 0.09661246441742953, 'NDCG@10': 0.05679718558402622, 'MRR@10': 0.04467294693869703, 'Recall@5': 0.06767248099341112, 'NDCG@5': 0.04749443886034629, 'MRR@5': 0.04086531611049876, 'Recall*@10': 0.09957973527557709, 'NDCG*@10': 0.0590078922755578, 'MRR*@10': 0.04663964054163765, 'Recall*@5': 0.07034737003200195, 'NDCG*@5': 0.04961865022778511, 'MRR*@5': 0.042800635318545735}
INFO    [05-20 22:50:53] test in BasicTrainer:
Test model on test set!
INFO    [05-20 22:50:53] test_with_given_state_path in BasicTrainer:
Loading model params from ___movies_base_partial_2022/base_narm-rate-0.8-seed-2003_05-20_22:09_t1/narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-20 22:50:53] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-20 22:50:53] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-20 22:50:53] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-20 22:51:19] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.08573491520741407, 'NDCG@10': 0.04971254025312031, 'MRR@10': 0.03881181162946364, 'Recall@5': 0.0579734676901032, 'NDCG@5': 0.04084122619208168, 'MRR@5': 0.03521137783194289, 'Recall*@10': 0.08676834097679924, 'NDCG*@10': 0.050447909490150565, 'MRR*@10': 0.0394415623124908, 'Recall*@5': 0.05911736540934619, 'NDCG*@5': 0.04162299391977927, 'MRR*@5': 0.035866377327372044}
INFO    [05-20 22:51:19] _evaluate in BasicSched:
!!Final Result!!: {'Recall@10': 0.08573491520741407, 'NDCG@10': 0.04971254025312031, 'MRR@10': 0.03881181162946364, 'Recall@5': 0.0579734676901032, 'NDCG@5': 0.04084122619208168, 'MRR@5': 0.03521137783194289, 'Recall*@10': 0.08676834097679924, 'NDCG*@10': 0.050447909490150565, 'MRR*@10': 0.0394415623124908, 'Recall*@5': 0.05911736540934619, 'NDCG*@5': 0.04162299391977927, 'MRR*@5': 0.035866377327372044}
