INFO    [05-25 22:08:15] setup_train in utils:
{
    "experiment_dir": "___ablation_el_ed_test_teacher",
    "experiment_description": "new_metrics",
    "dataset_name": "electronics.csv",
    "sched": "basic",
    "model_code": "nextitnet",
    "num_epochs": 0,
    "mode": "test",
    "max_len": 10,
    "test_state_path": "___el_dvae/nextitnet/teacher_nextitnet_logs/checkpoint/best_acc_model.pth",
    "model_state_path": null,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "do_remap": false,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.electronics/nextitnet/config_test.json",
    "task_id": -1,
    "describe": null,
    "split": "leave_one_out",
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "mentor_code": "bert",
    "training_routine": null,
    "T": 1,
    "alpha": 0.1,
    "dvae_alpha": 0.5,
    "softmaxed_mentor": false,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-25 22:08:15] __init__ in BasicSched:
BasicScheduler attribs: tag=nextitnet
INFO    [05-25 22:08:15] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/electronics-5-5.pkl
INFO    [05-25 22:08:17] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-25 22:08:17] _check_dataset_cache in utils:
correct.
INFO    [05-25 22:08:17] __init__ in NextItemDataloader:
there are 29351 items in this dataset, 102187 users, padding_first? True
DEBUG   [05-25 22:08:31] generate_model in utils:
model_code_list=['nextitnet']
INFO    [05-25 22:08:31] load_model_config in utils:
loading model nextitnet's config file at asset/config/model/nextitnet.json
INFO    [05-25 22:08:31] load_model_config in utils:
{
    "embedding_size": 64,
    "kernel_size": 3,
    "block_num": 5,
    "dilations": [
        1
    ],
    "reg_weight": 5e-06,
    "loss_type": "CE"
}
WARNING [05-25 22:08:57] get_exist_path in utils:
dir ___ablation_el_ed_test_teacher/new_metrics_nextitnet_05-25_22:08_0/nextitnet_logs does not exist! Create one.
WARNING [05-25 22:08:57] get_exist_path in utils:
dir ___ablation_el_ed_test_teacher/new_metrics_nextitnet_05-25_22:08_0/nextitnet_logs/tb_vis does not exist! Create one.
WARNING [05-25 22:08:57] get_exist_path in utils:
dir ___ablation_el_ed_test_teacher/new_metrics_nextitnet_05-25_22:08_0/nextitnet_logs/checkpoint does not exist! Create one.
INFO    [05-25 22:08:57] __init__ in BasicSched:
NextItNet(
  (item_embedding): Embedding(29352, 64, padding_idx=0)
  (residual_blocks): Sequential(
    (0): ResidualBlock_b(
      (conv1): Conv2d(64, 64, kernel_size=(1, 3), stride=(1, 1))
      (ln1): LayerNorm((64,), eps=1e-08, elementwise_affine=True)
      (conv2): Conv2d(64, 64, kernel_size=(1, 3), stride=(1, 1), dilation=(2, 2))
      (ln2): LayerNorm((64,), eps=1e-08, elementwise_affine=True)
    )
    (1): ResidualBlock_b(
      (conv1): Conv2d(64, 64, kernel_size=(1, 3), stride=(1, 1))
      (ln1): LayerNorm((64,), eps=1e-08, elementwise_affine=True)
      (conv2): Conv2d(64, 64, kernel_size=(1, 3), stride=(1, 1), dilation=(2, 2))
      (ln2): LayerNorm((64,), eps=1e-08, elementwise_affine=True)
    )
    (2): ResidualBlock_b(
      (conv1): Conv2d(64, 64, kernel_size=(1, 3), stride=(1, 1))
      (ln1): LayerNorm((64,), eps=1e-08, elementwise_affine=True)
      (conv2): Conv2d(64, 64, kernel_size=(1, 3), stride=(1, 1), dilation=(2, 2))
      (ln2): LayerNorm((64,), eps=1e-08, elementwise_affine=True)
    )
    (3): ResidualBlock_b(
      (conv1): Conv2d(64, 64, kernel_size=(1, 3), stride=(1, 1))
      (ln1): LayerNorm((64,), eps=1e-08, elementwise_affine=True)
      (conv2): Conv2d(64, 64, kernel_size=(1, 3), stride=(1, 1), dilation=(2, 2))
      (ln2): LayerNorm((64,), eps=1e-08, elementwise_affine=True)
    )
    (4): ResidualBlock_b(
      (conv1): Conv2d(64, 64, kernel_size=(1, 3), stride=(1, 1))
      (ln1): LayerNorm((64,), eps=1e-08, elementwise_affine=True)
      (conv2): Conv2d(64, 64, kernel_size=(1, 3), stride=(1, 1), dilation=(2, 2))
      (ln2): LayerNorm((64,), eps=1e-08, elementwise_affine=True)
    )
  )
  (final_layer): Linear(in_features=64, out_features=64, bias=True)
  (loss_fct): CrossEntropyLoss()
  (reg_loss): RegLoss()
)
WARNING [05-25 22:08:57] get_path in utils:
Path is None
WARNING [05-25 22:08:57] load_state_from_given_path in utils:
Not given any path.
INFO    [05-25 22:08:57] assert_model_device in utils:
model nextitnet has 7.657958984375 MB params.
INFO    [05-25 22:08:57] __init__ in BasicTrainer:
454656 iter per epoch
INFO    [05-25 22:08:57] test_with_given_state_path in BasicTrainer:
Loading model params from ___el_dvae/nextitnet/teacher_nextitnet_logs/checkpoint/best_acc_model.pth.
INFO    [05-25 22:08:58] load_state_from_given_path in utils:
checkpoint epoch: 74
INFO    [05-25 22:08:58] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-25 22:08:58] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-25 22:09:51] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.04780418053269386, 'NDCG@10': 0.031192133203148842, 'MRR@10': 0.026102408468723297, 'Recall@5': 0.036453020870685575, 'NDCG@5': 0.027545510157942772, 'MRR@5': 0.024611558988690375, 'Recall*@10': 0.049820274114608765, 'NDCG*@10': 0.03255629844963551, 'MRR*@10': 0.02726650930941105, 'Recall*@5': 0.03802434340119362, 'NDCG*@5': 0.02876236118376255, 'MRR*@5': 0.02571281246840954, 'Recall**@10': 0.03945601336658001, 'NDCG**@10': 0.025548000037670136, 'MRR**@10': 0.021287694536149503, 'Recall**@5': 0.029962995424866676, 'NDCG**@5': 0.02251570373773575, 'MRR**@5': 0.020058289021253586}
INFO    [05-25 22:09:51] _evaluate in BasicSched:
!!Final Result!!: {'Recall@10': 0.04780418053269386, 'NDCG@10': 0.031192133203148842, 'MRR@10': 0.026102408468723297, 'Recall@5': 0.036453020870685575, 'NDCG@5': 0.027545510157942772, 'MRR@5': 0.024611558988690375, 'Recall*@10': 0.049820274114608765, 'NDCG*@10': 0.03255629844963551, 'MRR*@10': 0.02726650930941105, 'Recall*@5': 0.03802434340119362, 'NDCG*@5': 0.02876236118376255, 'MRR*@5': 0.02571281246840954, 'Recall**@10': 0.03945601336658001, 'NDCG**@10': 0.025548000037670136, 'MRR**@10': 0.021287694536149503, 'Recall**@5': 0.029962995424866676, 'NDCG**@5': 0.02251570373773575, 'MRR**@5': 0.020058289021253586}
