INFO    [11-27 00:54:37] setup_train in utils:
{
    "experiment_dir": "_____lfms_soft_len_2",
    "experiment_description": "soft",
    "describe": "{config[model_code]}-len-{config[max_len]}",
    "dataset_name": "lastfm_small.csv",
    "sched": "distill",
    "model_code": "gru4rec",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "dvae_alpha": 0.5,
    "alpha": 0.5,
    "T": 3,
    "num_epochs": 80,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 20,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2021,
    "load_processed_dataset": false,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 1024,
    "val_batch_size": 1024,
    "test_batch_size": 1024,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.lastfm_small/gru4rec/config_distill.json",
    "task_id": 3,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [11-27 00:54:37] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_gru4rec
INFO    [11-27 00:54:37] _gen_dataset in utils:
processing dataset lastfm_small.csv
INFO    [11-27 00:54:37] _drop_cold in utils:
filtering out cold users (who interacts with less or eq than 5 items) and cold items (which is interacted by less or eq than 5 users)
DEBUG   [11-27 00:54:37] _drop_cold in utils:
before filtering, there are 1090 users, 3646 items 
DEBUG   [11-27 00:54:37] _drop_cold in utils:
after 0 filterings, there are 1090 users, 3646 items
INFO    [11-27 00:54:37] _drop_cold in utils:
user desc 
            seq_len
count  1090.000000
mean     48.211927
std      77.730410
min       5.000000
25%       9.000000
50%      19.000000
75%      49.750000
max     899.000000
INFO    [11-27 00:54:37] _drop_cold in utils:
item desc 
           item_pop
count  3646.000000
mean     14.413330
std      16.072829
min       5.000000
25%       6.000000
50%       9.000000
75%      15.000000
max     177.000000
INFO    [11-27 00:54:37] _df_data_partition in utils:
dataset summary:
         session_id       item_id   rating
count  52551.000000  52551.000000  52551.0
mean     527.873799   1828.243915      1.0
std      316.650738   1049.669215      0.0
min        1.000000      1.000000      1.0
25%      248.000000    928.000000      1.0
50%      515.000000   1834.000000      1.0
75%      813.000000   2718.500000      1.0
max     1090.000000   3646.000000      1.0
INFO    [11-27 00:54:37] __init__ in NextItemDataloader:
there are 3646 items in this dataset, 3173 users, padding_first? False
DEBUG   [11-27 00:54:38] generate_model in utils:
model_code_list=['pop']
INFO    [11-27 00:54:38] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [11-27 00:54:38] load_model_config in utils:
{}
WARNING [11-27 00:54:42] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-20_11-27_00-54_t3/teacher_pop_logs does not exist! Create one.
WARNING [11-27 00:54:43] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-20_11-27_00-54_t3/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [11-27 00:54:43] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-20_11-27_00-54_t3/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [11-27 00:54:43] get_path in utils:
Path is None
WARNING [11-27 00:54:43] load_state_from_given_path in utils:
Not given any path.
DEBUG   [11-27 00:54:43] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [11-27 00:54:43] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [11-27 00:54:43] __init__ in BasicTrainer:
48128 iter per epoch
DEBUG   [11-27 00:54:43] generate_model in utils:
model_code_list=['gru4rec']
INFO    [11-27 00:54:43] load_model_config in utils:
loading model gru4rec's config file at asset/config/model/gru4rec.json
INFO    [11-27 00:54:43] load_model_config in utils:
{
    "embed_size": 64,
    "hidden_units": 64,
    "num_layers": 2,
    "hidden_dropout": 0.5,
    "loss_type": "CE"
}
WARNING [11-27 00:54:44] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-20_11-27_00-54_t3/student_gru4rec_logs does not exist! Create one.
WARNING [11-27 00:54:44] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-20_11-27_00-54_t3/student_gru4rec_logs/tb_vis does not exist! Create one.
WARNING [11-27 00:54:44] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-20_11-27_00-54_t3/student_gru4rec_logs/checkpoint does not exist! Create one.
WARNING [11-27 00:54:44] get_path in utils:
Path is None
WARNING [11-27 00:54:44] load_state_from_given_path in utils:
Not given any path.
DEBUG   [11-27 00:54:44] __init__ in DistillSched:
student model: 
GRU4RecModel(
  (item_embedding): Embedding(3647, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.5, inplace=False)
  (gru_layers): GRU(64, 64, num_layers=2, bias=False, batch_first=True)
  (dense): Linear(in_features=64, out_features=64, bias=True)
  (loss_fct): CrossEntropyLoss()
)
INFO    [11-27 00:54:44] assert_model_device in utils:
model student_gru4rec has 1.09375 MB params.
INFO    [11-27 00:54:44] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [11-27 00:54:44] __init__ in DistillTrainer:
48128 iter per epoch
INFO    [11-27 00:54:44] _set_current_routine in Routine:
first routine: student
INFO    [11-27 00:54:44] run_routine in Routine:
Start routine student
INFO    [11-27 00:54:44] run_routine in Routine:
Start training
INFO    [11-27 00:54:44] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [11-27 00:54:45] test_mentor in DistillTrainer:
{'Recall@10': 0.039543529972434044, 'NDCG@10': 0.01852993853390217, 'MRR@10': 0.01218377286568284, 'Recall*@10': 0.039543529972434044, 'NDCG*@10': 0.01852993853390217, 'MRR*@10': 0.01218377286568284}
INFO    [11-27 00:54:45] train in DistillTrainer:
result:
{'Recall@10': 0.039543529972434044, 'NDCG@10': 0.01852993853390217, 'MRR@10': 0.01218377286568284, 'Recall*@10': 0.039543529972434044, 'NDCG*@10': 0.01852993853390217, 'MRR*@10': 0.01218377286568284}
INFO    [11-27 00:54:47] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [11-27 00:54:47] validate in BasicTrainer:
{'Recall@10': 0.0009765625, 'NDCG@10': 0.000646679247438442, 'MRR@10': 0.0005536760618269909, 'Recall*@10': 0.0009765625, 'NDCG*@10': 0.000646679247438442, 'MRR*@10': 0.0005536760618269909}
INFO    [11-27 00:54:47] train in BasicTrainer:
epoch: 0
DEBUG   [11-27 00:54:47] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 2061781
DEBUG   [11-27 00:54:47] calculate_loss in loss:
pred max in softmax: 0.0002881696855183691, argmax 1124840
INFO    [11-27 00:54:49] _train_one_epoch in BasicTrainer:
loss = 5.742924933737897
INFO    [11-27 00:54:51] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [11-27 00:54:51] validate in BasicTrainer:
{'Recall@10': 0.020331354346126318, 'NDCG@10': 0.00886485236696899, 'MRR@10': 0.005425357026979327, 'Recall*@10': 0.020331354346126318, 'NDCG*@10': 0.00886485236696899, 'MRR*@10': 0.005425357026979327}
INFO    [11-27 00:54:51] train in BasicTrainer:
duration: 3.983938455581665s
INFO    [11-27 00:54:51] train in BasicTrainer:
epoch: 1
INFO    [11-27 00:54:53] _train_one_epoch in BasicTrainer:
loss = 5.490209153357973
INFO    [11-27 00:54:54] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [11-27 00:54:55] validate in BasicTrainer:
{'Recall@10': 0.020575494971126318, 'NDCG@10': 0.010394209763035178, 'MRR@10': 0.007289242814294994, 'Recall*@10': 0.020575494971126318, 'NDCG*@10': 0.010394209763035178, 'MRR*@10': 0.007289242814294994}
INFO    [11-27 00:54:55] train in BasicTrainer:
duration: 3.819761276245117s
INFO    [11-27 00:54:55] train in BasicTrainer:
epoch: 2
INFO    [11-27 00:54:57] _train_one_epoch in BasicTrainer:
loss = 5.423594038537208
INFO    [11-27 00:54:58] validate in BasicTrainer:
{'Recall@10': 0.01736782561056316, 'NDCG@10': 0.008662360138259828, 'MRR@10': 0.00597947440110147, 'Recall*@10': 0.01736782561056316, 'NDCG*@10': 0.008662360138259828, 'MRR*@10': 0.00597947440110147}
INFO    [11-27 00:54:58] train in BasicTrainer:
duration: 3.8218376636505127s
INFO    [11-27 00:54:58] train in BasicTrainer:
epoch: 3
INFO    [11-27 00:55:01] _train_one_epoch in BasicTrainer:
loss = 5.397362698899939
INFO    [11-27 00:55:02] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [11-27 00:55:02] validate in BasicTrainer:
{'Recall@10': 0.026746693067252636, 'NDCG@10': 0.010857173008844256, 'MRR@10': 0.0061863166047260165, 'Recall*@10': 0.026746693067252636, 'NDCG*@10': 0.010857173008844256, 'MRR*@10': 0.0061863166047260165}
INFO    [11-27 00:55:02] train in BasicTrainer:
duration: 3.8712804317474365s
INFO    [11-27 00:55:02] train in BasicTrainer:
epoch: 4
INFO    [11-27 00:55:05] _train_one_epoch in BasicTrainer:
loss = 5.3653555930928984
INFO    [11-27 00:55:06] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [11-27 00:55:06] validate in BasicTrainer:
{'Recall@10': 0.03361647203564644, 'NDCG@10': 0.0184291978366673, 'MRR@10': 0.013734818436205387, 'Recall*@10': 0.03361647203564644, 'NDCG*@10': 0.0184291978366673, 'MRR*@10': 0.013734818436205387}
INFO    [11-27 00:55:06] train in BasicTrainer:
duration: 3.863563299179077s
INFO    [11-27 00:55:06] train in BasicTrainer:
epoch: 5
INFO    [11-27 00:55:08] _train_one_epoch in BasicTrainer:
loss = 5.304634672530154
INFO    [11-27 00:55:10] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [11-27 00:55:10] validate in BasicTrainer:
{'Recall@10': 0.04836643300950527, 'NDCG@10': 0.02428989764302969, 'MRR@10': 0.017009255243465304, 'Recall*@10': 0.04836643300950527, 'NDCG*@10': 0.02428989764302969, 'MRR*@10': 0.017009255243465304}
INFO    [11-27 00:55:10] train in BasicTrainer:
duration: 3.8572986125946045s
INFO    [11-27 00:55:10] train in BasicTrainer:
epoch: 6
INFO    [11-27 00:55:12] _train_one_epoch in BasicTrainer:
loss = 5.226796119771105
INFO    [11-27 00:55:14] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [11-27 00:55:14] validate in BasicTrainer:
{'Recall@10': 0.0591424610465765, 'NDCG@10': 0.030200826935470104, 'MRR@10': 0.021502362797036767, 'Recall*@10': 0.0591424610465765, 'NDCG*@10': 0.030200826935470104, 'MRR*@10': 0.021502362797036767}
INFO    [11-27 00:55:14] train in BasicTrainer:
duration: 4.148597002029419s
INFO    [11-27 00:55:14] train in BasicTrainer:
epoch: 7
INFO    [11-27 00:55:16] _train_one_epoch in BasicTrainer:
loss = 5.164448230824572
INFO    [11-27 00:55:18] validate in BasicTrainer:
{'Recall@10': 0.06130588613450527, 'NDCG@10': 0.028925362043082714, 'MRR@10': 0.019130398519337177, 'Recall*@10': 0.06130588613450527, 'NDCG*@10': 0.028925362043082714, 'MRR*@10': 0.019130398519337177}
INFO    [11-27 00:55:18] train in BasicTrainer:
duration: 3.7768609523773193s
INFO    [11-27 00:55:18] train in BasicTrainer:
epoch: 8
INFO    [11-27 00:55:20] _train_one_epoch in BasicTrainer:
loss = 5.119024185424156
INFO    [11-27 00:55:22] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [11-27 00:55:22] validate in BasicTrainer:
{'Recall@10': 0.06447971425950527, 'NDCG@10': 0.030898767989128828, 'MRR@10': 0.02075336594134569, 'Recall*@10': 0.06447971425950527, 'NDCG*@10': 0.030898767989128828, 'MRR*@10': 0.02075336594134569}
INFO    [11-27 00:55:22] train in BasicTrainer:
duration: 3.9280993938446045s
INFO    [11-27 00:55:22] train in BasicTrainer:
epoch: 9
INFO    [11-27 00:55:24] _train_one_epoch in BasicTrainer:
loss = 5.080317345071347
INFO    [11-27 00:55:26] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [11-27 00:55:26] validate in BasicTrainer:
{'Recall@10': 0.0684198047965765, 'NDCG@10': 0.03383007925003767, 'MRR@10': 0.023359027225524187, 'Recall*@10': 0.0684198047965765, 'NDCG*@10': 0.03383007925003767, 'MRR*@10': 0.023359027225524187}
INFO    [11-27 00:55:26] train in BasicTrainer:
duration: 3.9995903968811035s
INFO    [11-27 00:55:26] train in BasicTrainer:
epoch: 10
INFO    [11-27 00:55:28] _train_one_epoch in BasicTrainer:
loss = 5.041277844855126
INFO    [11-27 00:55:30] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [11-27 00:55:30] validate in BasicTrainer:
{'Recall@10': 0.0720819141715765, 'NDCG@10': 0.036593245808035135, 'MRR@10': 0.025801999494433403, 'Recall*@10': 0.0720819141715765, 'NDCG*@10': 0.036593245808035135, 'MRR*@10': 0.025801999494433403}
INFO    [11-27 00:55:30] train in BasicTrainer:
duration: 3.8312454223632812s
INFO    [11-27 00:55:30] train in BasicTrainer:
epoch: 11
INFO    [11-27 00:55:32] _train_one_epoch in BasicTrainer:
loss = 4.9972125215733305
INFO    [11-27 00:55:33] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [11-27 00:55:34] validate in BasicTrainer:
{'Recall@10': 0.08365804702043533, 'NDCG@10': 0.04119782894849777, 'MRR@10': 0.028723315335810184, 'Recall*@10': 0.08365804702043533, 'NDCG*@10': 0.04119782894849777, 'MRR*@10': 0.028723315335810184}
INFO    [11-27 00:55:34] train in BasicTrainer:
duration: 3.949514389038086s
INFO    [11-27 00:55:34] train in BasicTrainer:
epoch: 12
INFO    [11-27 00:55:36] _train_one_epoch in BasicTrainer:
loss = 4.944572184948211
INFO    [11-27 00:55:37] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [11-27 00:55:37] validate in BasicTrainer:
{'Recall@10': 0.0877745971083641, 'NDCG@10': 0.04459082521498203, 'MRR@10': 0.031303723342716694, 'Recall*@10': 0.0877745971083641, 'NDCG*@10': 0.04459082521498203, 'MRR*@10': 0.031303723342716694}
INFO    [11-27 00:55:37] train in BasicTrainer:
duration: 3.9145021438598633s
INFO    [11-27 00:55:37] train in BasicTrainer:
epoch: 13
INFO    [11-27 00:55:40] _train_one_epoch in BasicTrainer:
loss = 4.884863954909305
INFO    [11-27 00:55:41] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [11-27 00:55:41] validate in BasicTrainer:
{'Recall@10': 0.09614305943250656, 'NDCG@10': 0.047418177127838135, 'MRR@10': 0.03257243940606713, 'Recall*@10': 0.09614305943250656, 'NDCG*@10': 0.047418177127838135, 'MRR*@10': 0.03257243940606713}
INFO    [11-27 00:55:41] train in BasicTrainer:
duration: 3.8161580562591553s
INFO    [11-27 00:55:41] train in BasicTrainer:
epoch: 14
INFO    [11-27 00:55:44] _train_one_epoch in BasicTrainer:
loss = 4.83008854439918
INFO    [11-27 00:55:45] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [11-27 00:55:45] validate in BasicTrainer:
{'Recall@10': 0.11033705994486809, 'NDCG@10': 0.05333390738815069, 'MRR@10': 0.03613846655935049, 'Recall*@10': 0.11033705994486809, 'NDCG*@10': 0.05333390738815069, 'MRR*@10': 0.03613846655935049}
INFO    [11-27 00:55:45] train in BasicTrainer:
duration: 3.9005510807037354s
INFO    [11-27 00:55:45] train in BasicTrainer:
epoch: 15
INFO    [11-27 00:55:48] _train_one_epoch in BasicTrainer:
loss = 4.784375647281078
INFO    [11-27 00:55:49] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [11-27 00:55:49] validate in BasicTrainer:
{'Recall@10': 0.10862807556986809, 'NDCG@10': 0.05357930436730385, 'MRR@10': 0.03696349821984768, 'Recall*@10': 0.10862807556986809, 'NDCG*@10': 0.05357930436730385, 'MRR*@10': 0.03696349821984768}
INFO    [11-27 00:55:49] train in BasicTrainer:
duration: 3.7690885066986084s
INFO    [11-27 00:55:49] train in BasicTrainer:
epoch: 16
INFO    [11-27 00:55:51] _train_one_epoch in BasicTrainer:
loss = 4.7455137435426105
INFO    [11-27 00:55:53] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [11-27 00:55:53] validate in BasicTrainer:
{'Recall@10': 0.11253432556986809, 'NDCG@10': 0.05867124628275633, 'MRR@10': 0.04238820355385542, 'Recall*@10': 0.11253432556986809, 'NDCG*@10': 0.05867124628275633, 'MRR*@10': 0.04238820355385542}
INFO    [11-27 00:55:53] train in BasicTrainer:
duration: 3.8775439262390137s
INFO    [11-27 00:55:53] train in BasicTrainer:
epoch: 17
INFO    [11-27 00:55:55] _train_one_epoch in BasicTrainer:
loss = 4.7137828380503555
INFO    [11-27 00:55:57] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [11-27 00:55:57] validate in BasicTrainer:
{'Recall@10': 0.11909227818250656, 'NDCG@10': 0.06166166439652443, 'MRR@10': 0.04420581180602312, 'Recall*@10': 0.11909227818250656, 'NDCG*@10': 0.06166166439652443, 'MRR*@10': 0.04420581180602312}
INFO    [11-27 00:55:57] train in BasicTrainer:
duration: 3.971832036972046s
INFO    [11-27 00:55:57] train in BasicTrainer:
epoch: 18
INFO    [11-27 00:55:59] _train_one_epoch in BasicTrainer:
loss = 4.680730312428576
INFO    [11-27 00:56:01] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [11-27 00:56:01] validate in BasicTrainer:
{'Recall@10': 0.11808187514543533, 'NDCG@10': 0.06279777642339468, 'MRR@10': 0.04602770134806633, 'Recall*@10': 0.11808187514543533, 'NDCG*@10': 0.06279777642339468, 'MRR*@10': 0.04602770134806633}
INFO    [11-27 00:56:01] train in BasicTrainer:
duration: 3.928663492202759s
INFO    [11-27 00:56:01] train in BasicTrainer:
epoch: 19
INFO    [11-27 00:56:03] _train_one_epoch in BasicTrainer:
loss = 4.649399077638667
INFO    [11-27 00:56:05] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [11-27 00:56:05] validate in BasicTrainer:
{'Recall@10': 0.11857015639543533, 'NDCG@10': 0.0629145335406065, 'MRR@10': 0.045970385894179344, 'Recall*@10': 0.11857015639543533, 'NDCG*@10': 0.0629145335406065, 'MRR*@10': 0.045970385894179344}
INFO    [11-27 00:56:05] train in BasicTrainer:
duration: 3.9976279735565186s
INFO    [11-27 00:56:05] train in BasicTrainer:
epoch: 20
INFO    [11-27 00:56:07] _train_one_epoch in BasicTrainer:
loss = 4.624129620004208
INFO    [11-27 00:56:09] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [11-27 00:56:09] validate in BasicTrainer:
{'Recall@10': 0.13307597860693932, 'NDCG@10': 0.06634521670639515, 'MRR@10': 0.04643590096384287, 'Recall*@10': 0.13307597860693932, 'NDCG*@10': 0.06634521670639515, 'MRR*@10': 0.04643590096384287}
INFO    [11-27 00:56:09] train in BasicTrainer:
duration: 3.979342460632324s
INFO    [11-27 00:56:09] train in BasicTrainer:
epoch: 21
DEBUG   [11-27 00:56:10] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 1284970
DEBUG   [11-27 00:56:10] calculate_loss in loss:
pred max in softmax: 0.07158204913139343, argmax 2677768
DEBUG   [11-27 00:56:10] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 249222
DEBUG   [11-27 00:56:10] calculate_loss in loss:
pred max in softmax: 0.07547948509454727, argmax 1094970
INFO    [11-27 00:56:11] _train_one_epoch in BasicTrainer:
loss = 4.598419666290283
INFO    [11-27 00:56:13] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [11-27 00:56:13] validate in BasicTrainer:
{'Recall@10': 0.13799263164401054, 'NDCG@10': 0.07029785215854645, 'MRR@10': 0.05002624075859785, 'Recall*@10': 0.13799263164401054, 'NDCG*@10': 0.07029785215854645, 'MRR*@10': 0.05002624075859785}
INFO    [11-27 00:56:13] train in BasicTrainer:
duration: 3.918203830718994s
INFO    [11-27 00:56:13] train in BasicTrainer:
epoch: 22
INFO    [11-27 00:56:15] _train_one_epoch in BasicTrainer:
loss = 4.571843035677646
INFO    [11-27 00:56:17] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [11-27 00:56:17] validate in BasicTrainer:
{'Recall@10': 0.13332011923193932, 'NDCG@10': 0.07305456511676311, 'MRR@10': 0.054924698546528816, 'Recall*@10': 0.13332011923193932, 'NDCG*@10': 0.07305456511676311, 'MRR*@10': 0.054924698546528816}
INFO    [11-27 00:56:17] train in BasicTrainer:
duration: 4.023827314376831s
INFO    [11-27 00:56:17] train in BasicTrainer:
epoch: 23
INFO    [11-27 00:56:19] _train_one_epoch in BasicTrainer:
loss = 4.549960704559975
INFO    [11-27 00:56:21] validate in BasicTrainer:
{'Recall@10': 0.1335304193198681, 'NDCG@10': 0.06987402401864529, 'MRR@10': 0.050682236440479755, 'Recall*@10': 0.1335304193198681, 'NDCG*@10': 0.06987402401864529, 'MRR*@10': 0.050682236440479755}
INFO    [11-27 00:56:21] train in BasicTrainer:
duration: 3.860137939453125s
INFO    [11-27 00:56:21] train in BasicTrainer:
epoch: 24
INFO    [11-27 00:56:23] _train_one_epoch in BasicTrainer:
loss = 4.528063368290029
INFO    [11-27 00:56:24] validate in BasicTrainer:
{'Recall@10': 0.13300829380750656, 'NDCG@10': 0.07146730646491051, 'MRR@10': 0.05284362006932497, 'Recall*@10': 0.13300829380750656, 'NDCG*@10': 0.07146730646491051, 'MRR*@10': 0.05284362006932497}
INFO    [11-27 00:56:24] train in BasicTrainer:
duration: 3.9149131774902344s
INFO    [11-27 00:56:24] train in BasicTrainer:
epoch: 25
INFO    [11-27 00:56:27] _train_one_epoch in BasicTrainer:
loss = 4.505675934730692
INFO    [11-27 00:56:28] validate in BasicTrainer:
{'Recall@10': 0.1257928516715765, 'NDCG@10': 0.06838166248053312, 'MRR@10': 0.0508500887081027, 'Recall*@10': 0.1257928516715765, 'NDCG*@10': 0.06838166248053312, 'MRR*@10': 0.0508500887081027}
INFO    [11-27 00:56:28] train in BasicTrainer:
duration: 3.8012359142303467s
INFO    [11-27 00:56:28] train in BasicTrainer:
epoch: 26
INFO    [11-27 00:56:31] _train_one_epoch in BasicTrainer:
loss = 4.484546377303753
INFO    [11-27 00:56:32] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [11-27 00:56:32] validate in BasicTrainer:
{'Recall@10': 0.13468343764543533, 'NDCG@10': 0.07353598065674305, 'MRR@10': 0.05500389076769352, 'Recall*@10': 0.13468343764543533, 'NDCG*@10': 0.07353598065674305, 'MRR*@10': 0.05500389076769352}
INFO    [11-27 00:56:32] train in BasicTrainer:
duration: 3.9755682945251465s
INFO    [11-27 00:56:32] train in BasicTrainer:
epoch: 27
INFO    [11-27 00:56:35] _train_one_epoch in BasicTrainer:
loss = 4.465904134385129
INFO    [11-27 00:56:36] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [11-27 00:56:36] validate in BasicTrainer:
{'Recall@10': 0.13862352818250656, 'NDCG@10': 0.07485523074865341, 'MRR@10': 0.055401941761374474, 'Recall*@10': 0.13862352818250656, 'NDCG*@10': 0.07485523074865341, 'MRR*@10': 0.055401941761374474}
INFO    [11-27 00:56:36] train in BasicTrainer:
duration: 3.874565839767456s
INFO    [11-27 00:56:36] train in BasicTrainer:
epoch: 28
INFO    [11-27 00:56:39] _train_one_epoch in BasicTrainer:
loss = 4.44713956751722
INFO    [11-27 00:56:40] validate in BasicTrainer:
{'Recall@10': 0.1326964721083641, 'NDCG@10': 0.07359720207750797, 'MRR@10': 0.05559572670608759, 'Recall*@10': 0.1326964721083641, 'NDCG*@10': 0.07359720207750797, 'MRR*@10': 0.05559572670608759}
INFO    [11-27 00:56:40] train in BasicTrainer:
duration: 3.833160877227783s
INFO    [11-27 00:56:40] train in BasicTrainer:
epoch: 29
INFO    [11-27 00:56:42] _train_one_epoch in BasicTrainer:
loss = 4.427532845355095
INFO    [11-27 00:56:44] validate in BasicTrainer:
{'Recall@10': 0.1324523314833641, 'NDCG@10': 0.07330442778766155, 'MRR@10': 0.05520243477076292, 'Recall*@10': 0.1324523314833641, 'NDCG*@10': 0.07330442778766155, 'MRR*@10': 0.05520243477076292}
INFO    [11-27 00:56:44] train in BasicTrainer:
duration: 3.736699342727661s
INFO    [11-27 00:56:44] train in BasicTrainer:
epoch: 30
INFO    [11-27 00:56:46] _train_one_epoch in BasicTrainer:
loss = 4.407298443165232
INFO    [11-27 00:56:48] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [11-27 00:56:48] validate in BasicTrainer:
{'Recall@10': 0.13789110630750656, 'NDCG@10': 0.07571210898458958, 'MRR@10': 0.05671043787151575, 'Recall*@10': 0.13789110630750656, 'NDCG*@10': 0.07571210898458958, 'MRR*@10': 0.05671043787151575}
INFO    [11-27 00:56:48] train in BasicTrainer:
duration: 3.962204933166504s
INFO    [11-27 00:56:48] train in BasicTrainer:
epoch: 31
INFO    [11-27 00:56:50] _train_one_epoch in BasicTrainer:
loss = 4.391745141211977
INFO    [11-27 00:56:52] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [11-27 00:56:52] validate in BasicTrainer:
{'Recall@10': 0.1418312005698681, 'NDCG@10': 0.07873174175620079, 'MRR@10': 0.05953250639140606, 'Recall*@10': 0.1418312005698681, 'NDCG*@10': 0.07873174175620079, 'MRR*@10': 0.05953250639140606}
INFO    [11-27 00:56:52] train in BasicTrainer:
duration: 3.981555700302124s
INFO    [11-27 00:56:52] train in BasicTrainer:
epoch: 32
INFO    [11-27 00:56:54] _train_one_epoch in BasicTrainer:
loss = 4.37357116252818
INFO    [11-27 00:56:55] validate in BasicTrainer:
{'Recall@10': 0.14057665318250656, 'NDCG@10': 0.07531065121293068, 'MRR@10': 0.055370936170220375, 'Recall*@10': 0.14057665318250656, 'NDCG*@10': 0.07531065121293068, 'MRR*@10': 0.055370936170220375}
INFO    [11-27 00:56:55] train in BasicTrainer:
duration: 3.899435520172119s
INFO    [11-27 00:56:55] train in BasicTrainer:
epoch: 33
INFO    [11-27 00:56:58] _train_one_epoch in BasicTrainer:
loss = 4.3558758573329195
INFO    [11-27 00:56:59] validate in BasicTrainer:
{'Recall@10': 0.1331847533583641, 'NDCG@10': 0.07738594710826874, 'MRR@10': 0.060354008339345455, 'Recall*@10': 0.1331847533583641, 'NDCG*@10': 0.07738594710826874, 'MRR*@10': 0.060354008339345455}
INFO    [11-27 00:56:59] train in BasicTrainer:
duration: 3.827805280685425s
INFO    [11-27 00:56:59] train in BasicTrainer:
epoch: 34
INFO    [11-27 00:57:02] _train_one_epoch in BasicTrainer:
loss = 4.341769350335953
INFO    [11-27 00:57:03] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [11-27 00:57:03] validate in BasicTrainer:
{'Recall@10': 0.13517171889543533, 'NDCG@10': 0.07938704453408718, 'MRR@10': 0.062392087653279305, 'Recall*@10': 0.13517171889543533, 'NDCG*@10': 0.07938704453408718, 'MRR*@10': 0.062392087653279305}
INFO    [11-27 00:57:03] train in BasicTrainer:
duration: 4.048767566680908s
INFO    [11-27 00:57:03] train in BasicTrainer:
epoch: 35
INFO    [11-27 00:57:06] _train_one_epoch in BasicTrainer:
loss = 4.321669314769989
INFO    [11-27 00:57:07] validate in BasicTrainer:
{'Recall@10': 0.13639242202043533, 'NDCG@10': 0.07629565894603729, 'MRR@10': 0.058018770068883896, 'Recall*@10': 0.13639242202043533, 'NDCG*@10': 0.07629565894603729, 'MRR*@10': 0.058018770068883896}
INFO    [11-27 00:57:07] train in BasicTrainer:
duration: 3.8570289611816406s
INFO    [11-27 00:57:07] train in BasicTrainer:
epoch: 36
INFO    [11-27 00:57:10] _train_one_epoch in BasicTrainer:
loss = 4.305761448880459
INFO    [11-27 00:57:11] validate in BasicTrainer:
{'Recall@10': 0.1384132318198681, 'NDCG@10': 0.07915893755853176, 'MRR@10': 0.06107745133340359, 'Recall*@10': 0.1384132318198681, 'NDCG*@10': 0.07915893755853176, 'MRR*@10': 0.06107745133340359}
INFO    [11-27 00:57:11] train in BasicTrainer:
duration: 4.089938640594482s
INFO    [11-27 00:57:11] train in BasicTrainer:
epoch: 37
INFO    [11-27 00:57:14] _train_one_epoch in BasicTrainer:
loss = 4.2923132003621856
INFO    [11-27 00:57:16] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [11-27 00:57:16] validate in BasicTrainer:
{'Recall@10': 0.14155321568250656, 'NDCG@10': 0.08207877352833748, 'MRR@10': 0.06384609825909138, 'Recall*@10': 0.14155321568250656, 'NDCG*@10': 0.08207877352833748, 'MRR*@10': 0.06384609825909138}
INFO    [11-27 00:57:16] train in BasicTrainer:
duration: 4.307742595672607s
INFO    [11-27 00:57:16] train in BasicTrainer:
epoch: 38
INFO    [11-27 00:57:18] _train_one_epoch in BasicTrainer:
loss = 4.2781109505511346
INFO    [11-27 00:57:19] validate in BasicTrainer:
{'Recall@10': 0.13960009068250656, 'NDCG@10': 0.08159950189292431, 'MRR@10': 0.06394975446164608, 'Recall*@10': 0.13960009068250656, 'NDCG*@10': 0.08159950189292431, 'MRR*@10': 0.06394975446164608}
INFO    [11-27 00:57:19] train in BasicTrainer:
duration: 3.640794515609741s
INFO    [11-27 00:57:19] train in BasicTrainer:
epoch: 39
INFO    [11-27 00:57:22] _train_one_epoch in BasicTrainer:
loss = 4.261935629743211
INFO    [11-27 00:57:23] validate in BasicTrainer:
{'Recall@10': 0.14235332235693932, 'NDCG@10': 0.08128044568002224, 'MRR@10': 0.06274629943072796, 'Recall*@10': 0.14235332235693932, 'NDCG*@10': 0.08128044568002224, 'MRR*@10': 0.06274629943072796}
INFO    [11-27 00:57:23] train in BasicTrainer:
duration: 3.8036513328552246s
INFO    [11-27 00:57:23] train in BasicTrainer:
epoch: 40
INFO    [11-27 00:57:26] _train_one_epoch in BasicTrainer:
loss = 4.246606684745626
INFO    [11-27 00:57:27] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [11-27 00:57:27] validate in BasicTrainer:
{'Recall@10': 0.14503886923193932, 'NDCG@10': 0.08290276117622852, 'MRR@10': 0.06414072215557098, 'Recall*@10': 0.14503886923193932, 'NDCG*@10': 0.08290276117622852, 'MRR*@10': 0.06414072215557098}
INFO    [11-27 00:57:27] train in BasicTrainer:
duration: 3.9638099670410156s
INFO    [11-27 00:57:27] train in BasicTrainer:
epoch: 41
INFO    [11-27 00:57:29] _train_one_epoch in BasicTrainer:
loss = 4.231555177810344
INFO    [11-27 00:57:31] validate in BasicTrainer:
{'Recall@10': 0.13960009068250656, 'NDCG@10': 0.08045690506696701, 'MRR@10': 0.062451910227537155, 'Recall*@10': 0.13960009068250656, 'NDCG*@10': 0.08045690506696701, 'MRR*@10': 0.062451910227537155}
INFO    [11-27 00:57:31] train in BasicTrainer:
duration: 3.663158893585205s
INFO    [11-27 00:57:31] train in BasicTrainer:
epoch: 42
DEBUG   [11-27 00:57:32] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 807213
DEBUG   [11-27 00:57:32] calculate_loss in loss:
pred max in softmax: 0.12531524896621704, argmax 3341522
DEBUG   [11-27 00:57:32] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 519100
DEBUG   [11-27 00:57:32] calculate_loss in loss:
pred max in softmax: 0.10130398720502853, argmax 993210
INFO    [11-27 00:57:33] _train_one_epoch in BasicTrainer:
loss = 4.217901615386314
INFO    [11-27 00:57:34] validate in BasicTrainer:
{'Recall@10': 0.1440284661948681, 'NDCG@10': 0.08209831081330776, 'MRR@10': 0.06341043300926685, 'Recall*@10': 0.1440284661948681, 'NDCG*@10': 0.08209831081330776, 'MRR*@10': 0.06341043300926685}
INFO    [11-27 00:57:34] train in BasicTrainer:
duration: 3.722714900970459s
INFO    [11-27 00:57:34] train in BasicTrainer:
epoch: 43
INFO    [11-27 00:57:37] _train_one_epoch in BasicTrainer:
loss = 4.20218884691279
INFO    [11-27 00:57:38] validate in BasicTrainer:
{'Recall@10': 0.1450050286948681, 'NDCG@10': 0.08125944994390011, 'MRR@10': 0.06196310184895992, 'Recall*@10': 0.1450050286948681, 'NDCG*@10': 0.08125944994390011, 'MRR*@10': 0.06196310184895992}
INFO    [11-27 00:57:38] train in BasicTrainer:
duration: 3.7092132568359375s
INFO    [11-27 00:57:38] train in BasicTrainer:
epoch: 44
INFO    [11-27 00:57:41] _train_one_epoch in BasicTrainer:
loss = 4.189737908383633
INFO    [11-27 00:57:42] validate in BasicTrainer:
{'Recall@10': 0.14775825664401054, 'NDCG@10': 0.08127044141292572, 'MRR@10': 0.06109444983303547, 'Recall*@10': 0.14775825664401054, 'NDCG*@10': 0.08127044141292572, 'MRR*@10': 0.06109444983303547}
INFO    [11-27 00:57:42] train in BasicTrainer:
duration: 3.730234146118164s
INFO    [11-27 00:57:42] train in BasicTrainer:
epoch: 45
INFO    [11-27 00:57:44] _train_one_epoch in BasicTrainer:
loss = 4.170507857140074
INFO    [11-27 00:57:46] validate in BasicTrainer:
{'Recall@10': 0.1472022943198681, 'NDCG@10': 0.08248932845890522, 'MRR@10': 0.06286572944372892, 'Recall*@10': 0.1472022943198681, 'NDCG*@10': 0.08248932845890522, 'MRR*@10': 0.06286572944372892}
INFO    [11-27 00:57:46] train in BasicTrainer:
duration: 3.845553159713745s
INFO    [11-27 00:57:46] train in BasicTrainer:
epoch: 46
INFO    [11-27 00:57:48] _train_one_epoch in BasicTrainer:
loss = 4.16256689518056
INFO    [11-27 00:57:49] validate in BasicTrainer:
{'Recall@10': 0.14772441610693932, 'NDCG@10': 0.08231461979448795, 'MRR@10': 0.062485676258802414, 'Recall*@10': 0.14772441610693932, 'NDCG*@10': 0.08231461979448795, 'MRR*@10': 0.062485676258802414}
INFO    [11-27 00:57:49] train in BasicTrainer:
duration: 3.643000841140747s
INFO    [11-27 00:57:49] train in BasicTrainer:
epoch: 47
INFO    [11-27 00:57:52] _train_one_epoch in BasicTrainer:
loss = 4.147439733464667
INFO    [11-27 00:57:53] log in loggers:
Update Best NDCG@10 Model at 47
INFO    [11-27 00:57:53] validate in BasicTrainer:
{'Recall@10': 0.15068794414401054, 'NDCG@10': 0.0833183191716671, 'MRR@10': 0.06281858216971159, 'Recall*@10': 0.15068794414401054, 'NDCG*@10': 0.0833183191716671, 'MRR*@10': 0.06281858216971159}
INFO    [11-27 00:57:53] train in BasicTrainer:
duration: 3.9767699241638184s
INFO    [11-27 00:57:53] train in BasicTrainer:
epoch: 48
INFO    [11-27 00:57:56] _train_one_epoch in BasicTrainer:
loss = 4.134717291974007
INFO    [11-27 00:57:57] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [11-27 00:57:57] validate in BasicTrainer:
{'Recall@10': 0.156126718968153, 'NDCG@10': 0.08597692288458347, 'MRR@10': 0.0646284930408001, 'Recall*@10': 0.156126718968153, 'NDCG*@10': 0.08597692288458347, 'MRR*@10': 0.0646284930408001}
INFO    [11-27 00:57:57] train in BasicTrainer:
duration: 3.9323649406433105s
INFO    [11-27 00:57:57] train in BasicTrainer:
epoch: 49
INFO    [11-27 00:58:00] _train_one_epoch in BasicTrainer:
loss = 4.119474654502057
INFO    [11-27 00:58:01] validate in BasicTrainer:
{'Recall@10': 0.15316319093108177, 'NDCG@10': 0.08493594080209732, 'MRR@10': 0.06435178779065609, 'Recall*@10': 0.15316319093108177, 'NDCG*@10': 0.08493594080209732, 'MRR*@10': 0.06435178779065609}
INFO    [11-27 00:58:01] train in BasicTrainer:
duration: 3.6909992694854736s
INFO    [11-27 00:58:01] train in BasicTrainer:
epoch: 50
INFO    [11-27 00:58:03] _train_one_epoch in BasicTrainer:
loss = 4.107817913623566
INFO    [11-27 00:58:05] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [11-27 00:58:05] validate in BasicTrainer:
{'Recall@10': 0.15616056323051453, 'NDCG@10': 0.08615842647850513, 'MRR@10': 0.06489998567849398, 'Recall*@10': 0.15616056323051453, 'NDCG*@10': 0.08615842647850513, 'MRR*@10': 0.06489998567849398}
INFO    [11-27 00:58:05] train in BasicTrainer:
duration: 4.014011859893799s
INFO    [11-27 00:58:05] train in BasicTrainer:
epoch: 51
INFO    [11-27 00:58:07] _train_one_epoch in BasicTrainer:
loss = 4.096562547886625
INFO    [11-27 00:58:09] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [11-27 00:58:09] validate in BasicTrainer:
{'Recall@10': 0.157103281468153, 'NDCG@10': 0.08868515305221081, 'MRR@10': 0.06787090748548508, 'Recall*@10': 0.157103281468153, 'NDCG*@10': 0.08868515305221081, 'MRR*@10': 0.06787090748548508}
INFO    [11-27 00:58:09] train in BasicTrainer:
duration: 3.863529682159424s
INFO    [11-27 00:58:09] train in BasicTrainer:
epoch: 52
INFO    [11-27 00:58:11] _train_one_epoch in BasicTrainer:
loss = 4.083437457997748
INFO    [11-27 00:58:13] log in loggers:
Update Best NDCG@10 Model at 52
INFO    [11-27 00:58:13] validate in BasicTrainer:
{'Recall@10': 0.16250821948051453, 'NDCG@10': 0.09310673177242279, 'MRR@10': 0.07203172147274017, 'Recall*@10': 0.16250821948051453, 'NDCG*@10': 0.09310673177242279, 'MRR*@10': 0.07203172147274017}
INFO    [11-27 00:58:13] train in BasicTrainer:
duration: 3.9377636909484863s
INFO    [11-27 00:58:13] train in BasicTrainer:
epoch: 53
INFO    [11-27 00:58:15] _train_one_epoch in BasicTrainer:
loss = 4.0751806320028106
INFO    [11-27 00:58:17] validate in BasicTrainer:
{'Recall@10': 0.157103281468153, 'NDCG@10': 0.08993496559560299, 'MRR@10': 0.06943431217223406, 'Recall*@10': 0.157103281468153, 'NDCG*@10': 0.08993496559560299, 'MRR*@10': 0.06943431217223406}
INFO    [11-27 00:58:17] train in BasicTrainer:
duration: 3.785780191421509s
INFO    [11-27 00:58:17] train in BasicTrainer:
epoch: 54
INFO    [11-27 00:58:19] _train_one_epoch in BasicTrainer:
loss = 4.059643141766812
INFO    [11-27 00:58:20] validate in BasicTrainer:
{'Recall@10': 0.160765390843153, 'NDCG@10': 0.09195318818092346, 'MRR@10': 0.07102659065276384, 'Recall*@10': 0.160765390843153, 'NDCG*@10': 0.09195318818092346, 'MRR*@10': 0.07102659065276384}
INFO    [11-27 00:58:20] train in BasicTrainer:
duration: 3.737187385559082s
INFO    [11-27 00:58:20] train in BasicTrainer:
epoch: 55
INFO    [11-27 00:58:23] _train_one_epoch in BasicTrainer:
loss = 4.04752957059982
INFO    [11-27 00:58:24] validate in BasicTrainer:
{'Recall@10': 0.16916769742965698, 'NDCG@10': 0.09285971522331238, 'MRR@10': 0.06974184978753328, 'Recall*@10': 0.16916769742965698, 'NDCG*@10': 0.09285971522331238, 'MRR*@10': 0.06974184978753328}
INFO    [11-27 00:58:24] train in BasicTrainer:
duration: 3.96822452545166s
INFO    [11-27 00:58:24] train in BasicTrainer:
epoch: 56
INFO    [11-27 00:58:27] _train_one_epoch in BasicTrainer:
loss = 4.034117338505197
INFO    [11-27 00:58:28] validate in BasicTrainer:
{'Recall@10': 0.15933439135551453, 'NDCG@10': 0.09268757700920105, 'MRR@10': 0.07218280993402004, 'Recall*@10': 0.15933439135551453, 'NDCG*@10': 0.09268757700920105, 'MRR*@10': 0.07218280993402004}
INFO    [11-27 00:58:28] train in BasicTrainer:
duration: 3.870792865753174s
INFO    [11-27 00:58:28] train in BasicTrainer:
epoch: 57
INFO    [11-27 00:58:31] _train_one_epoch in BasicTrainer:
loss = 4.025854034626738
INFO    [11-27 00:58:32] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [11-27 00:58:32] validate in BasicTrainer:
{'Recall@10': 0.1660277098417282, 'NDCG@10': 0.09487765654921532, 'MRR@10': 0.07325975690037012, 'Recall*@10': 0.1660277098417282, 'NDCG*@10': 0.09487765654921532, 'MRR*@10': 0.07325975690037012}
INFO    [11-27 00:58:32] train in BasicTrainer:
duration: 4.156486749649048s
INFO    [11-27 00:58:32] train in BasicTrainer:
epoch: 58
INFO    [11-27 00:58:35] _train_one_epoch in BasicTrainer:
loss = 4.011377593304249
INFO    [11-27 00:58:36] validate in BasicTrainer:
{'Recall@10': 0.16477316617965698, 'NDCG@10': 0.09253604710102081, 'MRR@10': 0.07049973960965872, 'Recall*@10': 0.16477316617965698, 'NDCG*@10': 0.09253604710102081, 'MRR*@10': 0.07049973960965872}
INFO    [11-27 00:58:36] train in BasicTrainer:
duration: 3.9218711853027344s
INFO    [11-27 00:58:36] train in BasicTrainer:
epoch: 59
INFO    [11-27 00:58:39] _train_one_epoch in BasicTrainer:
loss = 4.002061148907276
INFO    [11-27 00:58:40] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [11-27 00:58:40] validate in BasicTrainer:
{'Recall@10': 0.16571588814258575, 'NDCG@10': 0.09698599763214588, 'MRR@10': 0.07598546519875526, 'Recall*@10': 0.16571588814258575, 'NDCG*@10': 0.09698599763214588, 'MRR*@10': 0.07598546519875526}
INFO    [11-27 00:58:40] train in BasicTrainer:
duration: 3.9637186527252197s
INFO    [11-27 00:58:40] train in BasicTrainer:
epoch: 60
INFO    [11-27 00:58:43] _train_one_epoch in BasicTrainer:
loss = 3.9902012753993907
INFO    [11-27 00:58:44] validate in BasicTrainer:
{'Recall@10': 0.16421720385551453, 'NDCG@10': 0.09367667138576508, 'MRR@10': 0.07189653255045414, 'Recall*@10': 0.16421720385551453, 'NDCG*@10': 0.09367667138576508, 'MRR*@10': 0.07189653255045414}
INFO    [11-27 00:58:44] train in BasicTrainer:
duration: 3.9022557735443115s
INFO    [11-27 00:58:44] train in BasicTrainer:
epoch: 61
INFO    [11-27 00:58:47] _train_one_epoch in BasicTrainer:
loss = 3.98274882803572
INFO    [11-27 00:58:48] log in loggers:
Update Best NDCG@10 Model at 61
INFO    [11-27 00:58:48] validate in BasicTrainer:
{'Recall@10': 0.16867941617965698, 'NDCG@10': 0.09790202043950558, 'MRR@10': 0.07627958059310913, 'Recall*@10': 0.16867941617965698, 'NDCG*@10': 0.09790202043950558, 'MRR*@10': 0.07627958059310913}
INFO    [11-27 00:58:48] train in BasicTrainer:
duration: 3.929304361343384s
INFO    [11-27 00:58:48] train in BasicTrainer:
epoch: 62
INFO    [11-27 00:58:50] _train_one_epoch in BasicTrainer:
loss = 3.970597490351251
INFO    [11-27 00:58:52] validate in BasicTrainer:
{'Recall@10': 0.16770285367965698, 'NDCG@10': 0.09640759229660034, 'MRR@10': 0.07450209464877844, 'Recall*@10': 0.16770285367965698, 'NDCG*@10': 0.09640759229660034, 'MRR*@10': 0.07450209464877844}
INFO    [11-27 00:58:52] train in BasicTrainer:
duration: 3.825108528137207s
INFO    [11-27 00:58:52] train in BasicTrainer:
epoch: 63
DEBUG   [11-27 00:58:54] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 1832020
DEBUG   [11-27 00:58:54] calculate_loss in loss:
pred max in softmax: 0.19617138803005219, argmax 340840
DEBUG   [11-27 00:58:54] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 2149309
DEBUG   [11-27 00:58:54] calculate_loss in loss:
pred max in softmax: 0.16620789468288422, argmax 974954
INFO    [11-27 00:58:54] _train_one_epoch in BasicTrainer:
loss = 3.961335887300207
INFO    [11-27 00:58:56] validate in BasicTrainer:
{'Recall@10': 0.16596002876758575, 'NDCG@10': 0.0960555151104927, 'MRR@10': 0.07465803436934948, 'Recall*@10': 0.16596002876758575, 'NDCG*@10': 0.0960555151104927, 'MRR*@10': 0.07465803436934948}
INFO    [11-27 00:58:56] train in BasicTrainer:
duration: 3.79284405708313s
INFO    [11-27 00:58:56] train in BasicTrainer:
epoch: 64
INFO    [11-27 00:58:58] _train_one_epoch in BasicTrainer:
loss = 3.948081057122413
INFO    [11-27 00:59:00] validate in BasicTrainer:
{'Recall@10': 0.16648215055465698, 'NDCG@10': 0.09706717170774937, 'MRR@10': 0.07576648704707623, 'Recall*@10': 0.16648215055465698, 'NDCG*@10': 0.09706717170774937, 'MRR*@10': 0.07576648704707623}
INFO    [11-27 00:59:00] train in BasicTrainer:
duration: 4.013103246688843s
INFO    [11-27 00:59:00] train in BasicTrainer:
epoch: 65
INFO    [11-27 00:59:02] _train_one_epoch in BasicTrainer:
loss = 3.94039571031611
INFO    [11-27 00:59:04] log in loggers:
Update Best NDCG@10 Model at 65
INFO    [11-27 00:59:04] validate in BasicTrainer:
{'Recall@10': 0.17014425992965698, 'NDCG@10': 0.09859180450439453, 'MRR@10': 0.07674231007695198, 'Recall*@10': 0.17014425992965698, 'NDCG*@10': 0.09859180450439453, 'MRR*@10': 0.07674231007695198}
INFO    [11-27 00:59:04] train in BasicTrainer:
duration: 4.014190912246704s
INFO    [11-27 00:59:04] train in BasicTrainer:
epoch: 66
INFO    [11-27 00:59:06] _train_one_epoch in BasicTrainer:
loss = 3.930018328605814
INFO    [11-27 00:59:08] validate in BasicTrainer:
{'Recall@10': 0.16299650073051453, 'NDCG@10': 0.09687809459865093, 'MRR@10': 0.07640920206904411, 'Recall*@10': 0.16299650073051453, 'NDCG*@10': 0.09687809459865093, 'MRR*@10': 0.07640920206904411}
INFO    [11-27 00:59:08] train in BasicTrainer:
duration: 3.9718637466430664s
INFO    [11-27 00:59:08] train in BasicTrainer:
epoch: 67
INFO    [11-27 00:59:10] _train_one_epoch in BasicTrainer:
loss = 3.9185721265508775
INFO    [11-27 00:59:12] validate in BasicTrainer:
{'Recall@10': 0.16592618823051453, 'NDCG@10': 0.0981004647910595, 'MRR@10': 0.0772186927497387, 'Recall*@10': 0.16592618823051453, 'NDCG*@10': 0.0981004647910595, 'MRR*@10': 0.0772186927497387}
INFO    [11-27 00:59:12] train in BasicTrainer:
duration: 3.9324169158935547s
INFO    [11-27 00:59:12] train in BasicTrainer:
epoch: 68
INFO    [11-27 00:59:14] _train_one_epoch in BasicTrainer:
loss = 3.909786163492406
INFO    [11-27 00:59:15] log in loggers:
Update Best NDCG@10 Model at 68
INFO    [11-27 00:59:15] validate in BasicTrainer:
{'Recall@10': 0.16913385689258575, 'NDCG@10': 0.10152103379368782, 'MRR@10': 0.08072349801659584, 'Recall*@10': 0.16913385689258575, 'NDCG*@10': 0.10152103379368782, 'MRR*@10': 0.08072349801659584}
INFO    [11-27 00:59:15] train in BasicTrainer:
duration: 3.925851345062256s
INFO    [11-27 00:59:15] train in BasicTrainer:
epoch: 69
INFO    [11-27 00:59:18] _train_one_epoch in BasicTrainer:
loss = 3.9024137791166913
INFO    [11-27 00:59:19] validate in BasicTrainer:
{'Recall@10': 0.1743284910917282, 'NDCG@10': 0.09943079575896263, 'MRR@10': 0.07663049548864365, 'Recall*@10': 0.1743284910917282, 'NDCG*@10': 0.09943079575896263, 'MRR*@10': 0.07663049548864365}
INFO    [11-27 00:59:19] train in BasicTrainer:
duration: 3.886381149291992s
INFO    [11-27 00:59:19] train in BasicTrainer:
epoch: 70
INFO    [11-27 00:59:22] _train_one_epoch in BasicTrainer:
loss = 3.893339304213828
INFO    [11-27 00:59:23] log in loggers:
Update Best NDCG@10 Model at 70
INFO    [11-27 00:59:23] validate in BasicTrainer:
{'Recall@10': 0.17014425992965698, 'NDCG@10': 0.10213599912822247, 'MRR@10': 0.0815935991704464, 'Recall*@10': 0.17014425992965698, 'NDCG*@10': 0.10213599912822247, 'MRR*@10': 0.0815935991704464}
INFO    [11-27 00:59:23] train in BasicTrainer:
duration: 4.004969596862793s
INFO    [11-27 00:59:23] train in BasicTrainer:
epoch: 71
INFO    [11-27 00:59:26] _train_one_epoch in BasicTrainer:
loss = 3.88299113131584
INFO    [11-27 00:59:27] validate in BasicTrainer:
{'Recall@10': 0.16794699430465698, 'NDCG@10': 0.09953218884766102, 'MRR@10': 0.07864567451179028, 'Recall*@10': 0.16794699430465698, 'NDCG*@10': 0.09953218884766102, 'MRR*@10': 0.07864567451179028}
INFO    [11-27 00:59:27] train in BasicTrainer:
duration: 3.932710647583008s
INFO    [11-27 00:59:27] train in BasicTrainer:
epoch: 72
INFO    [11-27 00:59:30] _train_one_epoch in BasicTrainer:
loss = 3.871982067189318
INFO    [11-27 00:59:31] validate in BasicTrainer:
{'Recall@10': 0.164427500218153, 'NDCG@10': 0.09757890924811363, 'MRR@10': 0.0770107414573431, 'Recall*@10': 0.164427500218153, 'NDCG*@10': 0.09757890924811363, 'MRR*@10': 0.0770107414573431}
INFO    [11-27 00:59:31] train in BasicTrainer:
duration: 3.881784439086914s
INFO    [11-27 00:59:31] train in BasicTrainer:
epoch: 73
INFO    [11-27 00:59:34] _train_one_epoch in BasicTrainer:
loss = 3.8612485845038234
INFO    [11-27 00:59:35] validate in BasicTrainer:
{'Recall@10': 0.16421720385551453, 'NDCG@10': 0.09655945934355259, 'MRR@10': 0.07590615004301071, 'Recall*@10': 0.16421720385551453, 'NDCG*@10': 0.09655945934355259, 'MRR*@10': 0.07590615004301071}
INFO    [11-27 00:59:35] train in BasicTrainer:
duration: 3.7913272380828857s
INFO    [11-27 00:59:35] train in BasicTrainer:
epoch: 74
INFO    [11-27 00:59:38] _train_one_epoch in BasicTrainer:
loss = 3.8560565025248428
INFO    [11-27 00:59:39] validate in BasicTrainer:
{'Recall@10': 0.16864557564258575, 'NDCG@10': 0.09742669202387333, 'MRR@10': 0.0756135880947113, 'Recall*@10': 0.16864557564258575, 'NDCG*@10': 0.09742669202387333, 'MRR*@10': 0.0756135880947113}
INFO    [11-27 00:59:39] train in BasicTrainer:
duration: 3.8804078102111816s
INFO    [11-27 00:59:39] train in BasicTrainer:
epoch: 75
INFO    [11-27 00:59:41] _train_one_epoch in BasicTrainer:
loss = 3.848107784352404
INFO    [11-27 00:59:43] validate in BasicTrainer:
{'Recall@10': 0.166624765843153, 'NDCG@10': 0.09725580178201199, 'MRR@10': 0.07599892280995846, 'Recall*@10': 0.166624765843153, 'NDCG*@10': 0.09725580178201199, 'MRR*@10': 0.07599892280995846}
INFO    [11-27 00:59:43] train in BasicTrainer:
duration: 3.8642356395721436s
INFO    [11-27 00:59:43] train in BasicTrainer:
epoch: 76
INFO    [11-27 00:59:45] _train_one_epoch in BasicTrainer:
loss = 3.8376459618832204
INFO    [11-27 00:59:47] log in loggers:
Update Best NDCG@10 Model at 76
INFO    [11-27 00:59:47] validate in BasicTrainer:
{'Recall@10': 0.17377252876758575, 'NDCG@10': 0.10246478766202927, 'MRR@10': 0.08070242591202259, 'Recall*@10': 0.17377252876758575, 'NDCG*@10': 0.10246478766202927, 'MRR*@10': 0.08070242591202259}
INFO    [11-27 00:59:47] train in BasicTrainer:
duration: 3.985978126525879s
INFO    [11-27 00:59:47] train in BasicTrainer:
epoch: 77
INFO    [11-27 00:59:49] _train_one_epoch in BasicTrainer:
loss = 3.8313830304653087
INFO    [11-27 00:59:51] validate in BasicTrainer:
{'Recall@10': 0.16317295655608177, 'NDCG@10': 0.09975475817918777, 'MRR@10': 0.0802843701094389, 'Recall*@10': 0.16317295655608177, 'NDCG*@10': 0.09975475817918777, 'MRR*@10': 0.0802843701094389}
INFO    [11-27 00:59:51] train in BasicTrainer:
duration: 3.8408215045928955s
INFO    [11-27 00:59:51] train in BasicTrainer:
epoch: 78
INFO    [11-27 00:59:53] _train_one_epoch in BasicTrainer:
loss = 3.8224487253960144
INFO    [11-27 00:59:55] validate in BasicTrainer:
{'Recall@10': 0.16885587573051453, 'NDCG@10': 0.09923445992171764, 'MRR@10': 0.07800907827913761, 'Recall*@10': 0.16885587573051453, 'NDCG*@10': 0.09923445992171764, 'MRR*@10': 0.07800907827913761}
INFO    [11-27 00:59:55] train in BasicTrainer:
duration: 4.020691633224487s
INFO    [11-27 00:59:55] train in BasicTrainer:
epoch: 79
INFO    [11-27 00:59:57] _train_one_epoch in BasicTrainer:
loss = 3.8145626910189363
INFO    [11-27 00:59:59] validate in BasicTrainer:
{'Recall@10': 0.16341709718108177, 'NDCG@10': 0.0983966663479805, 'MRR@10': 0.07857712544500828, 'Recall*@10': 0.16341709718108177, 'NDCG*@10': 0.0983966663479805, 'MRR*@10': 0.07857712544500828}
INFO    [11-27 00:59:59] train in BasicTrainer:
duration: 4.197127819061279s
INFO    [11-27 00:59:59] close_training in BasicTrainer:
finished training
DEBUG   [11-27 00:59:59] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3761 times, ratio nan / (nan + not_nan) = 0.0
INFO    [11-27 00:59:59] run_routine in Routine:
Finished training, Start final validation
INFO    [11-27 00:59:59] final_validate in BasicTrainer:
validate model on val set!
INFO    [11-27 00:59:59] load_state_from_given_path in utils:
checkpoint epoch: 76
INFO    [11-27 00:59:59] load_state_from_given_path in utils:
Loading model's parameters
INFO    [11-27 01:00:00] validate in BasicTrainer:
{'Recall@10': 0.17377252876758575, 'NDCG@10': 0.10246478766202927, 'MRR@10': 0.08070242591202259, 'Recall*@10': 0.17377252876758575, 'NDCG*@10': 0.10246478766202927, 'MRR*@10': 0.08070242591202259}
INFO    [11-27 01:00:00] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.17377252876758575, 'NDCG@10': 0.10246478766202927, 'MRR@10': 0.08070242591202259, 'Recall*@10': 0.17377252876758575, 'NDCG*@10': 0.10246478766202927, 'MRR*@10': 0.08070242591202259}
INFO    [11-27 01:00:00] _evaluate in DistillSched:
Start testing student model on test set
INFO    [11-27 01:00:00] test in BasicTrainer:
Test model on test set!
INFO    [11-27 01:00:00] test_with_given_state_path in BasicTrainer:
Loading model params from _____lfms_soft_len_2/soft_gru4rec-len-20_11-27_00-54_t3/student_gru4rec_logs/checkpoint/best_acc_model.pth.
INFO    [11-27 01:00:00] load_state_from_given_path in utils:
checkpoint epoch: 76
INFO    [11-27 01:00:00] load_state_from_given_path in utils:
Loading model's parameters
INFO    [11-27 01:00:00] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [11-27 01:00:02] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.15337349101901054, 'NDCG@10': 0.08246770687401295, 'MRR@10': 0.06088399514555931, 'Recall*@10': 0.15337349101901054, 'NDCG*@10': 0.08246770687401295, 'MRR*@10': 0.06088399514555931}
INFO    [11-27 01:00:02] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.15337349101901054, 'NDCG@10': 0.08246770687401295, 'MRR@10': 0.06088399514555931, 'Recall*@10': 0.15337349101901054, 'NDCG*@10': 0.08246770687401295, 'MRR*@10': 0.06088399514555931}
