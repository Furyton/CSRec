INFO    [11-27 00:49:14] setup_train in utils:
{
    "experiment_dir": "_____lfms_soft_len_2",
    "experiment_description": "soft",
    "describe": "{config[model_code]}-len-{config[max_len]}",
    "dataset_name": "lastfm_small.csv",
    "sched": "distill",
    "model_code": "gru4rec",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "dvae_alpha": 0.5,
    "alpha": 0.5,
    "T": 3,
    "num_epochs": 80,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 15,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2021,
    "load_processed_dataset": false,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 1024,
    "val_batch_size": 1024,
    "test_batch_size": 1024,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.lastfm_small/gru4rec/config_distill.json",
    "task_id": 2,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [11-27 00:49:14] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_gru4rec
INFO    [11-27 00:49:14] _gen_dataset in utils:
processing dataset lastfm_small.csv
INFO    [11-27 00:49:14] _drop_cold in utils:
filtering out cold users (who interacts with less or eq than 5 items) and cold items (which is interacted by less or eq than 5 users)
DEBUG   [11-27 00:49:14] _drop_cold in utils:
before filtering, there are 1090 users, 3646 items 
DEBUG   [11-27 00:49:14] _drop_cold in utils:
after 0 filterings, there are 1090 users, 3646 items
INFO    [11-27 00:49:14] _drop_cold in utils:
user desc 
            seq_len
count  1090.000000
mean     48.211927
std      77.730410
min       5.000000
25%       9.000000
50%      19.000000
75%      49.750000
max     899.000000
INFO    [11-27 00:49:14] _drop_cold in utils:
item desc 
           item_pop
count  3646.000000
mean     14.413330
std      16.072829
min       5.000000
25%       6.000000
50%       9.000000
75%      15.000000
max     177.000000
INFO    [11-27 00:49:14] _df_data_partition in utils:
dataset summary:
         session_id       item_id   rating
count  52551.000000  52551.000000  52551.0
mean     527.873799   1828.243915      1.0
std      316.650738   1049.669215      0.0
min        1.000000      1.000000      1.0
25%      248.000000    928.000000      1.0
50%      515.000000   1834.000000      1.0
75%      813.000000   2718.500000      1.0
max     1090.000000   3646.000000      1.0
INFO    [11-27 00:49:14] __init__ in NextItemDataloader:
there are 3646 items in this dataset, 4030 users, padding_first? False
DEBUG   [11-27 00:49:15] generate_model in utils:
model_code_list=['pop']
INFO    [11-27 00:49:15] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [11-27 00:49:15] load_model_config in utils:
{}
WARNING [11-27 00:49:19] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-15_11-27_00-49_t2/teacher_pop_logs does not exist! Create one.
WARNING [11-27 00:49:19] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-15_11-27_00-49_t2/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [11-27 00:49:19] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-15_11-27_00-49_t2/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [11-27 00:49:19] get_path in utils:
Path is None
WARNING [11-27 00:49:19] load_state_from_given_path in utils:
Not given any path.
DEBUG   [11-27 00:49:19] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [11-27 00:49:19] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [11-27 00:49:19] __init__ in BasicTrainer:
45056 iter per epoch
DEBUG   [11-27 00:49:19] generate_model in utils:
model_code_list=['gru4rec']
INFO    [11-27 00:49:19] load_model_config in utils:
loading model gru4rec's config file at asset/config/model/gru4rec.json
INFO    [11-27 00:49:19] load_model_config in utils:
{
    "embed_size": 64,
    "hidden_units": 64,
    "num_layers": 2,
    "hidden_dropout": 0.5,
    "loss_type": "CE"
}
WARNING [11-27 00:49:21] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-15_11-27_00-49_t2/student_gru4rec_logs does not exist! Create one.
WARNING [11-27 00:49:21] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-15_11-27_00-49_t2/student_gru4rec_logs/tb_vis does not exist! Create one.
WARNING [11-27 00:49:21] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-15_11-27_00-49_t2/student_gru4rec_logs/checkpoint does not exist! Create one.
WARNING [11-27 00:49:21] get_path in utils:
Path is None
WARNING [11-27 00:49:21] load_state_from_given_path in utils:
Not given any path.
DEBUG   [11-27 00:49:21] __init__ in DistillSched:
student model: 
GRU4RecModel(
  (item_embedding): Embedding(3647, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.5, inplace=False)
  (gru_layers): GRU(64, 64, num_layers=2, bias=False, batch_first=True)
  (dense): Linear(in_features=64, out_features=64, bias=True)
  (loss_fct): CrossEntropyLoss()
)
INFO    [11-27 00:49:21] assert_model_device in utils:
model student_gru4rec has 1.09375 MB params.
INFO    [11-27 00:49:21] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [11-27 00:49:21] __init__ in DistillTrainer:
45056 iter per epoch
INFO    [11-27 00:49:21] _set_current_routine in Routine:
first routine: student
INFO    [11-27 00:49:21] run_routine in Routine:
Start routine student
INFO    [11-27 00:49:21] run_routine in Routine:
Start training
INFO    [11-27 00:49:21] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [11-27 00:49:22] test_mentor in DistillTrainer:
{'Recall@10': 0.025878396816551685, 'NDCG@10': 0.012082622619345784, 'MRR@10': 0.007897175382822752, 'Recall*@10': 0.025878396816551685, 'NDCG*@10': 0.012082622619345784, 'MRR*@10': 0.007897175382822752}
INFO    [11-27 00:49:22] train in DistillTrainer:
result:
{'Recall@10': 0.025878396816551685, 'NDCG@10': 0.012082622619345784, 'MRR@10': 0.007897175382822752, 'Recall*@10': 0.025878396816551685, 'NDCG*@10': 0.012082622619345784, 'MRR*@10': 0.007897175382822752}
INFO    [11-27 00:49:24] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [11-27 00:49:24] validate in BasicTrainer:
{'Recall@10': 0.001481663464801386, 'NDCG@10': 0.0007176628496381454, 'MRR@10': 0.0004903837252641097, 'Recall*@10': 0.001481663464801386, 'NDCG*@10': 0.0007176628496381454, 'MRR*@10': 0.0004903837252641097}
INFO    [11-27 00:49:24] train in BasicTrainer:
epoch: 0
DEBUG   [11-27 00:49:24] calculate_loss in loss:
soft_target max: 0.5027613043785095, argmax 1346969
DEBUG   [11-27 00:49:24] calculate_loss in loss:
pred max in softmax: 0.0002881895052269101, argmax 1938121
INFO    [11-27 00:49:26] _train_one_epoch in BasicTrainer:
loss = 5.757906079292297
INFO    [11-27 00:49:27] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [11-27 00:49:28] validate in BasicTrainer:
{'Recall@10': 0.022132189013063908, 'NDCG@10': 0.01057879300788045, 'MRR@10': 0.007150595309212804, 'Recall*@10': 0.022132189013063908, 'NDCG*@10': 0.01057879300788045, 'MRR*@10': 0.007150595309212804}
INFO    [11-27 00:49:28] train in BasicTrainer:
duration: 3.871140956878662s
INFO    [11-27 00:49:28] train in BasicTrainer:
epoch: 1
INFO    [11-27 00:49:30] _train_one_epoch in BasicTrainer:
loss = 5.50447783686898
INFO    [11-27 00:49:31] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [11-27 00:49:32] validate in BasicTrainer:
{'Recall@10': 0.024102133698761463, 'NDCG@10': 0.011585218599066138, 'MRR@10': 0.007874537026509643, 'Recall*@10': 0.024102133698761463, 'NDCG*@10': 0.011585218599066138, 'MRR*@10': 0.007874537026509643}
INFO    [11-27 00:49:32] train in BasicTrainer:
duration: 3.9120121002197266s
INFO    [11-27 00:49:32] train in BasicTrainer:
epoch: 2
INFO    [11-27 00:49:34] _train_one_epoch in BasicTrainer:
loss = 5.428120277144692
INFO    [11-27 00:49:35] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [11-27 00:49:35] validate in BasicTrainer:
{'Recall@10': 0.023790713865309954, 'NDCG@10': 0.011714589316397905, 'MRR@10': 0.008167510037310421, 'Recall*@10': 0.023790713865309954, 'NDCG*@10': 0.011714589316397905, 'MRR*@10': 0.008167510037310421}
INFO    [11-27 00:49:35] train in BasicTrainer:
duration: 3.7450942993164062s
INFO    [11-27 00:49:35] train in BasicTrainer:
epoch: 3
INFO    [11-27 00:49:37] _train_one_epoch in BasicTrainer:
loss = 5.403550093824213
INFO    [11-27 00:49:39] validate in BasicTrainer:
{'Recall@10': 0.025289196986705065, 'NDCG@10': 0.011542744236066937, 'MRR@10': 0.007564662140794098, 'Recall*@10': 0.025289196986705065, 'NDCG*@10': 0.011542744236066937, 'MRR*@10': 0.007564662140794098}
INFO    [11-27 00:49:39] train in BasicTrainer:
duration: 3.727623462677002s
INFO    [11-27 00:49:39] train in BasicTrainer:
epoch: 4
INFO    [11-27 00:49:41] _train_one_epoch in BasicTrainer:
loss = 5.379872679710388
INFO    [11-27 00:49:43] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [11-27 00:49:43] validate in BasicTrainer:
{'Recall@10': 0.03001196775585413, 'NDCG@10': 0.013747938675805926, 'MRR@10': 0.008986348519101739, 'Recall*@10': 0.03001196775585413, 'NDCG*@10': 0.013747938675805926, 'MRR*@10': 0.008986348519101739}
INFO    [11-27 00:49:43] train in BasicTrainer:
duration: 3.6616995334625244s
INFO    [11-27 00:49:43] train in BasicTrainer:
epoch: 5
INFO    [11-27 00:49:45] _train_one_epoch in BasicTrainer:
loss = 5.34547652981498
INFO    [11-27 00:49:46] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [11-27 00:49:46] validate in BasicTrainer:
{'Recall@10': 0.03630049992352724, 'NDCG@10': 0.018423430621623993, 'MRR@10': 0.013119276147335768, 'Recall*@10': 0.03630049992352724, 'NDCG*@10': 0.018423430621623993, 'MRR*@10': 0.013119276147335768}
INFO    [11-27 00:49:46] train in BasicTrainer:
duration: 3.665360450744629s
INFO    [11-27 00:49:46] train in BasicTrainer:
epoch: 6
INFO    [11-27 00:49:48] _train_one_epoch in BasicTrainer:
loss = 5.2863241542469375
INFO    [11-27 00:49:50] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [11-27 00:49:50] validate in BasicTrainer:
{'Recall@10': 0.04398659709841013, 'NDCG@10': 0.02064571436494589, 'MRR@10': 0.013654508162289858, 'Recall*@10': 0.04398659709841013, 'NDCG*@10': 0.02064571436494589, 'MRR*@10': 0.013654508162289858}
INFO    [11-27 00:49:50] train in BasicTrainer:
duration: 3.7946712970733643s
INFO    [11-27 00:49:50] train in BasicTrainer:
epoch: 7
INFO    [11-27 00:49:52] _train_one_epoch in BasicTrainer:
loss = 5.219073468988592
INFO    [11-27 00:49:54] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [11-27 00:49:54] validate in BasicTrainer:
{'Recall@10': 0.053726738318800926, 'NDCG@10': 0.026169717777520418, 'MRR@10': 0.01791259809397161, 'Recall*@10': 0.053726738318800926, 'NDCG*@10': 0.026169717777520418, 'MRR*@10': 0.01791259809397161}
INFO    [11-27 00:49:54] train in BasicTrainer:
duration: 3.697261095046997s
INFO    [11-27 00:49:54] train in BasicTrainer:
epoch: 8
INFO    [11-27 00:49:56] _train_one_epoch in BasicTrainer:
loss = 5.162424770268527
INFO    [11-27 00:49:58] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [11-27 00:49:58] validate in BasicTrainer:
{'Recall@10': 0.06111823581159115, 'NDCG@10': 0.03051820443943143, 'MRR@10': 0.021388461347669363, 'Recall*@10': 0.06111823581159115, 'NDCG*@10': 0.03051820443943143, 'MRR*@10': 0.021388461347669363}
INFO    [11-27 00:49:58] train in BasicTrainer:
duration: 3.9051730632781982s
INFO    [11-27 00:49:58] train in BasicTrainer:
epoch: 9
INFO    [11-27 00:50:00] _train_one_epoch in BasicTrainer:
loss = 5.121596964922818
INFO    [11-27 00:50:02] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [11-27 00:50:02] validate in BasicTrainer:
{'Recall@10': 0.06582418642938137, 'NDCG@10': 0.03177497908473015, 'MRR@10': 0.021567688789218664, 'Recall*@10': 0.06582418642938137, 'NDCG*@10': 0.03177497908473015, 'MRR*@10': 0.021567688789218664}
INFO    [11-27 00:50:02] train in BasicTrainer:
duration: 3.900996208190918s
INFO    [11-27 00:50:02] train in BasicTrainer:
epoch: 10
INFO    [11-27 00:50:04] _train_one_epoch in BasicTrainer:
loss = 5.086007941852916
INFO    [11-27 00:50:05] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [11-27 00:50:05] validate in BasicTrainer:
{'Recall@10': 0.06957039423286915, 'NDCG@10': 0.03457832150161266, 'MRR@10': 0.024027184583246708, 'Recall*@10': 0.06957039423286915, 'NDCG*@10': 0.03457832150161266, 'MRR*@10': 0.024027184583246708}
INFO    [11-27 00:50:05] train in BasicTrainer:
duration: 3.7135963439941406s
INFO    [11-27 00:50:05] train in BasicTrainer:
epoch: 11
INFO    [11-27 00:50:07] _train_one_epoch in BasicTrainer:
loss = 5.052563147111372
INFO    [11-27 00:50:09] validate in BasicTrainer:
{'Recall@10': 0.07211271859705448, 'NDCG@10': 0.03422976331785321, 'MRR@10': 0.02282843692228198, 'Recall*@10': 0.07211271859705448, 'NDCG*@10': 0.03422976331785321, 'MRR*@10': 0.02282843692228198}
INFO    [11-27 00:50:09] train in BasicTrainer:
duration: 3.72274112701416s
INFO    [11-27 00:50:09] train in BasicTrainer:
epoch: 12
INFO    [11-27 00:50:11] _train_one_epoch in BasicTrainer:
loss = 5.0168434164740825
INFO    [11-27 00:50:13] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [11-27 00:50:13] validate in BasicTrainer:
{'Recall@10': 0.07356074266135693, 'NDCG@10': 0.03723734896630049, 'MRR@10': 0.026288586668670177, 'Recall*@10': 0.07356074266135693, 'NDCG*@10': 0.03723734896630049, 'MRR*@10': 0.026288586668670177}
INFO    [11-27 00:50:13] train in BasicTrainer:
duration: 3.881115436553955s
INFO    [11-27 00:50:13] train in BasicTrainer:
epoch: 13
INFO    [11-27 00:50:15] _train_one_epoch in BasicTrainer:
loss = 4.978260397911072
INFO    [11-27 00:50:17] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [11-27 00:50:17] validate in BasicTrainer:
{'Recall@10': 0.07611988671123981, 'NDCG@10': 0.03856926877051592, 'MRR@10': 0.027353445999324322, 'Recall*@10': 0.07611988671123981, 'NDCG*@10': 0.03856926877051592, 'MRR*@10': 0.027353445999324322}
INFO    [11-27 00:50:17] train in BasicTrainer:
duration: 3.808673858642578s
INFO    [11-27 00:50:17] train in BasicTrainer:
epoch: 14
INFO    [11-27 00:50:19] _train_one_epoch in BasicTrainer:
loss = 4.93935641375455
INFO    [11-27 00:50:20] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [11-27 00:50:20] validate in BasicTrainer:
{'Recall@10': 0.07944509200751781, 'NDCG@10': 0.04162560310214758, 'MRR@10': 0.030256809666752815, 'Recall*@10': 0.07944509200751781, 'NDCG*@10': 0.04162560310214758, 'MRR*@10': 0.030256809666752815}
INFO    [11-27 00:50:20] train in BasicTrainer:
duration: 3.717310667037964s
INFO    [11-27 00:50:20] train in BasicTrainer:
epoch: 15
INFO    [11-27 00:50:23] _train_one_epoch in BasicTrainer:
loss = 4.903261737389998
INFO    [11-27 00:50:24] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [11-27 00:50:24] validate in BasicTrainer:
{'Recall@10': 0.08476572670042515, 'NDCG@10': 0.04307827353477478, 'MRR@10': 0.030519211664795876, 'Recall*@10': 0.08476572670042515, 'NDCG*@10': 0.04307827353477478, 'MRR*@10': 0.030519211664795876}
INFO    [11-27 00:50:24] train in BasicTrainer:
duration: 3.9140331745147705s
INFO    [11-27 00:50:24] train in BasicTrainer:
epoch: 16
INFO    [11-27 00:50:27] _train_one_epoch in BasicTrainer:
loss = 4.869255499406294
INFO    [11-27 00:50:28] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [11-27 00:50:28] validate in BasicTrainer:
{'Recall@10': 0.09227496385574341, 'NDCG@10': 0.04793503228574991, 'MRR@10': 0.03465674165636301, 'Recall*@10': 0.09227496385574341, 'NDCG*@10': 0.04793503228574991, 'MRR*@10': 0.03465674165636301}
INFO    [11-27 00:50:28] train in BasicTrainer:
duration: 3.8224411010742188s
INFO    [11-27 00:50:28] train in BasicTrainer:
epoch: 17
INFO    [11-27 00:50:30] _train_one_epoch in BasicTrainer:
loss = 4.832583286545494
INFO    [11-27 00:50:32] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [11-27 00:50:32] validate in BasicTrainer:
{'Recall@10': 0.09813433885574341, 'NDCG@10': 0.050441241823136806, 'MRR@10': 0.03615245223045349, 'Recall*@10': 0.09813433885574341, 'NDCG*@10': 0.050441241823136806, 'MRR*@10': 0.03615245223045349}
INFO    [11-27 00:50:32] train in BasicTrainer:
duration: 3.9847962856292725s
INFO    [11-27 00:50:32] train in BasicTrainer:
epoch: 18
INFO    [11-27 00:50:34] _train_one_epoch in BasicTrainer:
loss = 4.794983181086454
INFO    [11-27 00:50:36] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [11-27 00:50:36] validate in BasicTrainer:
{'Recall@10': 0.10106402635574341, 'NDCG@10': 0.05145572870969772, 'MRR@10': 0.03656594920903444, 'Recall*@10': 0.10106402635574341, 'NDCG*@10': 0.05145572870969772, 'MRR*@10': 0.03656594920903444}
INFO    [11-27 00:50:36] train in BasicTrainer:
duration: 3.6711554527282715s
INFO    [11-27 00:50:36] train in BasicTrainer:
epoch: 19
INFO    [11-27 00:50:38] _train_one_epoch in BasicTrainer:
loss = 4.76338605447249
INFO    [11-27 00:50:40] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [11-27 00:50:40] validate in BasicTrainer:
{'Recall@10': 0.10793360322713852, 'NDCG@10': 0.05544824060052633, 'MRR@10': 0.03956020437180996, 'Recall*@10': 0.10793360322713852, 'NDCG*@10': 0.05544824060052633, 'MRR*@10': 0.03956020437180996}
INFO    [11-27 00:50:40] train in BasicTrainer:
duration: 3.821934938430786s
INFO    [11-27 00:50:40] train in BasicTrainer:
epoch: 20
INFO    [11-27 00:50:42] _train_one_epoch in BasicTrainer:
loss = 4.729038314385847
INFO    [11-27 00:50:43] validate in BasicTrainer:
{'Recall@10': 0.10688109695911407, 'NDCG@10': 0.054650476202368736, 'MRR@10': 0.03885817248374224, 'Recall*@10': 0.10688109695911407, 'NDCG*@10': 0.054650476202368736, 'MRR*@10': 0.03885817248374224}
INFO    [11-27 00:50:43] train in BasicTrainer:
duration: 3.769176959991455s
INFO    [11-27 00:50:43] train in BasicTrainer:
epoch: 21
INFO    [11-27 00:50:46] _train_one_epoch in BasicTrainer:
loss = 4.701539679007097
INFO    [11-27 00:50:47] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [11-27 00:50:47] validate in BasicTrainer:
{'Recall@10': 0.11150294914841652, 'NDCG@10': 0.056524752639234066, 'MRR@10': 0.03988596796989441, 'Recall*@10': 0.11150294914841652, 'NDCG*@10': 0.056524752639234066, 'MRR*@10': 0.03988596796989441}
INFO    [11-27 00:50:47] train in BasicTrainer:
duration: 3.8344364166259766s
INFO    [11-27 00:50:47] train in BasicTrainer:
epoch: 22
DEBUG   [11-27 00:50:49] calculate_loss in loss:
soft_target max: 0.5027613043785095, argmax 2007076
DEBUG   [11-27 00:50:49] calculate_loss in loss:
pred max in softmax: 0.0672193393111229, argmax 3248224
DEBUG   [11-27 00:50:49] calculate_loss in loss:
soft_target max: 0.5027613043785095, argmax 19461
DEBUG   [11-27 00:50:49] calculate_loss in loss:
pred max in softmax: 0.09720604866743088, argmax 1741193
INFO    [11-27 00:50:49] _train_one_epoch in BasicTrainer:
loss = 4.673343409191478
INFO    [11-27 00:50:51] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [11-27 00:50:51] validate in BasicTrainer:
{'Recall@10': 0.11420531570911407, 'NDCG@10': 0.059214873239398, 'MRR@10': 0.0426384536549449, 'Recall*@10': 0.11420531570911407, 'NDCG*@10': 0.059214873239398, 'MRR*@10': 0.0426384536549449}
INFO    [11-27 00:50:51] train in BasicTrainer:
duration: 3.8468165397644043s
INFO    [11-27 00:50:51] train in BasicTrainer:
epoch: 23
INFO    [11-27 00:50:53] _train_one_epoch in BasicTrainer:
loss = 4.647322773933411
INFO    [11-27 00:50:55] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [11-27 00:50:55] validate in BasicTrainer:
{'Recall@10': 0.11655395850539207, 'NDCG@10': 0.059992363676428795, 'MRR@10': 0.04290375392884016, 'Recall*@10': 0.11655395850539207, 'NDCG*@10': 0.059992363676428795, 'MRR*@10': 0.04290375392884016}
INFO    [11-27 00:50:55] train in BasicTrainer:
duration: 3.9381065368652344s
INFO    [11-27 00:50:55] train in BasicTrainer:
epoch: 24
INFO    [11-27 00:50:57] _train_one_epoch in BasicTrainer:
loss = 4.6252228888598355
INFO    [11-27 00:50:59] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [11-27 00:50:59] validate in BasicTrainer:
{'Recall@10': 0.11791788414120674, 'NDCG@10': 0.0610803859308362, 'MRR@10': 0.04384631011635065, 'Recall*@10': 0.11791788414120674, 'NDCG*@10': 0.0610803859308362, 'MRR*@10': 0.04384631011635065}
INFO    [11-27 00:50:59] train in BasicTrainer:
duration: 3.866180896759033s
INFO    [11-27 00:50:59] train in BasicTrainer:
epoch: 25
INFO    [11-27 00:51:01] _train_one_epoch in BasicTrainer:
loss = 4.5998099933971055
INFO    [11-27 00:51:03] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [11-27 00:51:03] validate in BasicTrainer:
{'Recall@10': 0.12291843444108963, 'NDCG@10': 0.06356739811599255, 'MRR@10': 0.04576226510107517, 'Recall*@10': 0.12291843444108963, 'NDCG*@10': 0.06356739811599255, 'MRR*@10': 0.04576226510107517}
INFO    [11-27 00:51:03] train in BasicTrainer:
duration: 3.733562469482422s
INFO    [11-27 00:51:03] train in BasicTrainer:
epoch: 26
INFO    [11-27 00:51:05] _train_one_epoch in BasicTrainer:
loss = 4.578245227987116
INFO    [11-27 00:51:07] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [11-27 00:51:07] validate in BasicTrainer:
{'Recall@10': 0.12495565786957741, 'NDCG@10': 0.06405688356608152, 'MRR@10': 0.04569782968610525, 'Recall*@10': 0.12495565786957741, 'NDCG*@10': 0.06405688356608152, 'MRR*@10': 0.04569782968610525}
INFO    [11-27 00:51:07] train in BasicTrainer:
duration: 3.956653356552124s
INFO    [11-27 00:51:07] train in BasicTrainer:
epoch: 27
INFO    [11-27 00:51:09] _train_one_epoch in BasicTrainer:
loss = 4.5568094795400444
INFO    [11-27 00:51:11] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [11-27 00:51:11] validate in BasicTrainer:
{'Recall@10': 0.12596585974097252, 'NDCG@10': 0.06560014840215445, 'MRR@10': 0.047363970428705215, 'Recall*@10': 0.12596585974097252, 'NDCG*@10': 0.06560014840215445, 'MRR*@10': 0.047363970428705215}
INFO    [11-27 00:51:11] train in BasicTrainer:
duration: 4.026797771453857s
INFO    [11-27 00:51:11] train in BasicTrainer:
epoch: 28
INFO    [11-27 00:51:13] _train_one_epoch in BasicTrainer:
loss = 4.5360704552043565
INFO    [11-27 00:51:14] validate in BasicTrainer:
{'Recall@10': 0.12554485723376274, 'NDCG@10': 0.06529078260064125, 'MRR@10': 0.04704025387763977, 'Recall*@10': 0.12554485723376274, 'NDCG*@10': 0.06529078260064125, 'MRR*@10': 0.04704025387763977}
INFO    [11-27 00:51:14] train in BasicTrainer:
duration: 3.8345978260040283s
INFO    [11-27 00:51:14] train in BasicTrainer:
epoch: 29
INFO    [11-27 00:51:17] _train_one_epoch in BasicTrainer:
loss = 4.511850118637085
INFO    [11-27 00:51:18] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [11-27 00:51:19] validate in BasicTrainer:
{'Recall@10': 0.13137059286236763, 'NDCG@10': 0.06942775286734104, 'MRR@10': 0.0506269047036767, 'Recall*@10': 0.13137059286236763, 'NDCG*@10': 0.06942775286734104, 'MRR*@10': 0.0506269047036767}
INFO    [11-27 00:51:19] train in BasicTrainer:
duration: 4.0764172077178955s
INFO    [11-27 00:51:19] train in BasicTrainer:
epoch: 30
INFO    [11-27 00:51:21] _train_one_epoch in BasicTrainer:
loss = 4.491646950895136
INFO    [11-27 00:51:23] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [11-27 00:51:23] validate in BasicTrainer:
{'Recall@10': 0.13119373098015785, 'NDCG@10': 0.06968672014772892, 'MRR@10': 0.05103134177625179, 'Recall*@10': 0.13119373098015785, 'NDCG*@10': 0.06968672014772892, 'MRR*@10': 0.05103134177625179}
INFO    [11-27 00:51:23] train in BasicTrainer:
duration: 4.016772031784058s
INFO    [11-27 00:51:23] train in BasicTrainer:
epoch: 31
INFO    [11-27 00:51:25] _train_one_epoch in BasicTrainer:
loss = 4.472233349626714
INFO    [11-27 00:51:26] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [11-27 00:51:26] validate in BasicTrainer:
{'Recall@10': 0.13663210347294807, 'NDCG@10': 0.07249892875552177, 'MRR@10': 0.05307149514555931, 'Recall*@10': 0.13663210347294807, 'NDCG*@10': 0.07249892875552177, 'MRR*@10': 0.05307149514555931}
INFO    [11-27 00:51:26] train in BasicTrainer:
duration: 3.6668128967285156s
INFO    [11-27 00:51:26] train in BasicTrainer:
epoch: 32
INFO    [11-27 00:51:28] _train_one_epoch in BasicTrainer:
loss = 4.451278740709478
INFO    [11-27 00:51:30] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [11-27 00:51:30] validate in BasicTrainer:
{'Recall@10': 0.1391407884657383, 'NDCG@10': 0.0725637748837471, 'MRR@10': 0.052458626218140125, 'Recall*@10': 0.1391407884657383, 'NDCG*@10': 0.0725637748837471, 'MRR*@10': 0.052458626218140125}
INFO    [11-27 00:51:30] train in BasicTrainer:
duration: 3.706141471862793s
INFO    [11-27 00:51:30] train in BasicTrainer:
epoch: 33
INFO    [11-27 00:51:32] _train_one_epoch in BasicTrainer:
loss = 4.433015411550349
INFO    [11-27 00:51:34] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [11-27 00:51:34] validate in BasicTrainer:
{'Recall@10': 0.13814740628004074, 'NDCG@10': 0.07417724654078484, 'MRR@10': 0.05479684006422758, 'Recall*@10': 0.13814740628004074, 'NDCG*@10': 0.07417724654078484, 'MRR*@10': 0.05479684006422758}
INFO    [11-27 00:51:34] train in BasicTrainer:
duration: 3.849106550216675s
INFO    [11-27 00:51:34] train in BasicTrainer:
epoch: 34
INFO    [11-27 00:51:36] _train_one_epoch in BasicTrainer:
loss = 4.41615279154344
INFO    [11-27 00:51:37] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [11-27 00:51:38] validate in BasicTrainer:
{'Recall@10': 0.14212093502283096, 'NDCG@10': 0.07556606829166412, 'MRR@10': 0.05535580683499575, 'Recall*@10': 0.14212093502283096, 'NDCG*@10': 0.07556606829166412, 'MRR*@10': 0.05535580683499575}
INFO    [11-27 00:51:38] train in BasicTrainer:
duration: 3.7071261405944824s
INFO    [11-27 00:51:38] train in BasicTrainer:
epoch: 35
INFO    [11-27 00:51:40] _train_one_epoch in BasicTrainer:
loss = 4.397627071900801
INFO    [11-27 00:51:41] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [11-27 00:51:41] validate in BasicTrainer:
{'Recall@10': 0.1464986465871334, 'NDCG@10': 0.0773025918751955, 'MRR@10': 0.05640364810824394, 'Recall*@10': 0.1464986465871334, 'NDCG*@10': 0.0773025918751955, 'MRR*@10': 0.05640364810824394}
INFO    [11-27 00:51:41] train in BasicTrainer:
duration: 3.8019115924835205s
INFO    [11-27 00:51:41] train in BasicTrainer:
epoch: 36
INFO    [11-27 00:51:43] _train_one_epoch in BasicTrainer:
loss = 4.381965908137235
INFO    [11-27 00:51:45] validate in BasicTrainer:
{'Recall@10': 0.14388037845492363, 'NDCG@10': 0.07692098245024681, 'MRR@10': 0.0567029258236289, 'Recall*@10': 0.14388037845492363, 'NDCG*@10': 0.07692098245024681, 'MRR*@10': 0.0567029258236289}
INFO    [11-27 00:51:45] train in BasicTrainer:
duration: 3.6316232681274414s
INFO    [11-27 00:51:45] train in BasicTrainer:
epoch: 37
INFO    [11-27 00:51:47] _train_one_epoch in BasicTrainer:
loss = 4.365988590500572
INFO    [11-27 00:51:49] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [11-27 00:51:49] validate in BasicTrainer:
{'Recall@10': 0.14558936282992363, 'NDCG@10': 0.07794130593538284, 'MRR@10': 0.05754146073013544, 'Recall*@10': 0.14558936282992363, 'NDCG*@10': 0.07794130593538284, 'MRR*@10': 0.05754146073013544}
INFO    [11-27 00:51:49] train in BasicTrainer:
duration: 3.845209836959839s
INFO    [11-27 00:51:49] train in BasicTrainer:
epoch: 38
INFO    [11-27 00:51:51] _train_one_epoch in BasicTrainer:
loss = 4.349220666018399
INFO    [11-27 00:51:53] validate in BasicTrainer:
{'Recall@10': 0.1450338028371334, 'NDCG@10': 0.07741511985659599, 'MRR@10': 0.056980401277542114, 'Recall*@10': 0.1450338028371334, 'NDCG*@10': 0.07741511985659599, 'MRR*@10': 0.056980401277542114}
INFO    [11-27 00:51:53] train in BasicTrainer:
duration: 3.7631263732910156s
INFO    [11-27 00:51:53] train in BasicTrainer:
epoch: 39
INFO    [11-27 00:51:55] _train_one_epoch in BasicTrainer:
loss = 4.3351216966455635
INFO    [11-27 00:51:56] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [11-27 00:51:57] validate in BasicTrainer:
{'Recall@10': 0.1464058831334114, 'NDCG@10': 0.07852726057171822, 'MRR@10': 0.05799871031194925, 'Recall*@10': 0.1464058831334114, 'NDCG*@10': 0.07852726057171822, 'MRR*@10': 0.05799871031194925}
INFO    [11-27 00:51:57] train in BasicTrainer:
duration: 3.958188772201538s
INFO    [11-27 00:51:57] train in BasicTrainer:
epoch: 40
INFO    [11-27 00:51:59] _train_one_epoch in BasicTrainer:
loss = 4.320709932934154
INFO    [11-27 00:52:00] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [11-27 00:52:00] validate in BasicTrainer:
{'Recall@10': 0.14794667065143585, 'NDCG@10': 0.07953464612364769, 'MRR@10': 0.05882590543478727, 'Recall*@10': 0.14794667065143585, 'NDCG*@10': 0.07953464612364769, 'MRR*@10': 0.05882590543478727}
INFO    [11-27 00:52:00] train in BasicTrainer:
duration: 3.924851417541504s
INFO    [11-27 00:52:00] train in BasicTrainer:
epoch: 41
INFO    [11-27 00:52:03] _train_one_epoch in BasicTrainer:
loss = 4.304413838820024
INFO    [11-27 00:52:04] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [11-27 00:52:04] validate in BasicTrainer:
{'Recall@10': 0.14827490970492363, 'NDCG@10': 0.07998212240636349, 'MRR@10': 0.05924543738365173, 'Recall*@10': 0.14827490970492363, 'NDCG*@10': 0.07998212240636349, 'MRR*@10': 0.05924543738365173}
INFO    [11-27 00:52:04] train in BasicTrainer:
duration: 3.8283519744873047s
INFO    [11-27 00:52:04] train in BasicTrainer:
epoch: 42
INFO    [11-27 00:52:06] _train_one_epoch in BasicTrainer:
loss = 4.288982781496915
INFO    [11-27 00:52:08] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [11-27 00:52:08] validate in BasicTrainer:
{'Recall@10': 0.1527199000120163, 'NDCG@10': 0.08106864616274834, 'MRR@10': 0.05945443920791149, 'Recall*@10': 0.1527199000120163, 'NDCG*@10': 0.08106864616274834, 'MRR*@10': 0.05945443920791149}
INFO    [11-27 00:52:08] train in BasicTrainer:
duration: 3.72062611579895s
INFO    [11-27 00:52:08] train in BasicTrainer:
epoch: 43
INFO    [11-27 00:52:10] _train_one_epoch in BasicTrainer:
loss = 4.2746255506168715
INFO    [11-27 00:52:12] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [11-27 00:52:12] validate in BasicTrainer:
{'Recall@10': 0.15428566187620163, 'NDCG@10': 0.08262501657009125, 'MRR@10': 0.06101047806441784, 'Recall*@10': 0.15428566187620163, 'NDCG*@10': 0.08262501657009125, 'MRR*@10': 0.06101047806441784}
INFO    [11-27 00:52:12] train in BasicTrainer:
duration: 3.8283851146698s
INFO    [11-27 00:52:12] train in BasicTrainer:
epoch: 44
INFO    [11-27 00:52:14] _train_one_epoch in BasicTrainer:
loss = 4.259733070026744
INFO    [11-27 00:52:16] validate in BasicTrainer:
{'Recall@10': 0.15239981561899185, 'NDCG@10': 0.08181632868945599, 'MRR@10': 0.06042252294719219, 'Recall*@10': 0.15239981561899185, 'NDCG*@10': 0.08181632868945599, 'MRR*@10': 0.06042252294719219}
INFO    [11-27 00:52:16] train in BasicTrainer:
duration: 3.8560445308685303s
INFO    [11-27 00:52:16] train in BasicTrainer:
epoch: 45
DEBUG   [11-27 00:52:17] calculate_loss in loss:
soft_target max: 0.5027613043785095, argmax 1857549
DEBUG   [11-27 00:52:17] calculate_loss in loss:
pred max in softmax: 0.16199767589569092, argmax 3493644
DEBUG   [11-27 00:52:17] calculate_loss in loss:
soft_target max: 0.5027613043785095, argmax 66872
DEBUG   [11-27 00:52:17] calculate_loss in loss:
pred max in softmax: 0.15825775265693665, argmax 3220119
INFO    [11-27 00:52:18] _train_one_epoch in BasicTrainer:
loss = 4.24561520056291
INFO    [11-27 00:52:19] validate in BasicTrainer:
{'Recall@10': 0.14764340594410896, 'NDCG@10': 0.08186865039169788, 'MRR@10': 0.06178149301558733, 'Recall*@10': 0.14764340594410896, 'NDCG*@10': 0.08186865039169788, 'MRR*@10': 0.06178149301558733}
INFO    [11-27 00:52:19] train in BasicTrainer:
duration: 3.6983447074890137s
INFO    [11-27 00:52:19] train in BasicTrainer:
epoch: 46
INFO    [11-27 00:52:22] _train_one_epoch in BasicTrainer:
loss = 4.232504822991111
INFO    [11-27 00:52:23] validate in BasicTrainer:
{'Recall@10': 0.15496762469410896, 'NDCG@10': 0.08246446214616299, 'MRR@10': 0.06042237486690283, 'Recall*@10': 0.15496762469410896, 'NDCG*@10': 0.08246446214616299, 'MRR*@10': 0.06042237486690283}
INFO    [11-27 00:52:23] train in BasicTrainer:
duration: 3.771609306335449s
INFO    [11-27 00:52:23] train in BasicTrainer:
epoch: 47
INFO    [11-27 00:52:25] _train_one_epoch in BasicTrainer:
loss = 4.217676390301097
INFO    [11-27 00:52:27] validate in BasicTrainer:
{'Recall@10': 0.15309859812259674, 'NDCG@10': 0.08164463751018047, 'MRR@10': 0.06004219129681587, 'Recall*@10': 0.15309859812259674, 'NDCG*@10': 0.08164463751018047, 'MRR*@10': 0.06004219129681587}
INFO    [11-27 00:52:27] train in BasicTrainer:
duration: 3.741055488586426s
INFO    [11-27 00:52:27] train in BasicTrainer:
epoch: 48
INFO    [11-27 00:52:29] _train_one_epoch in BasicTrainer:
loss = 4.2056286985223945
INFO    [11-27 00:52:31] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [11-27 00:52:31] validate in BasicTrainer:
{'Recall@10': 0.1599513553082943, 'NDCG@10': 0.08510751090943813, 'MRR@10': 0.06257906556129456, 'Recall*@10': 0.1599513553082943, 'NDCG*@10': 0.08510751090943813, 'MRR*@10': 0.06257906556129456}
INFO    [11-27 00:52:31] train in BasicTrainer:
duration: 3.76997447013855s
INFO    [11-27 00:52:31] train in BasicTrainer:
epoch: 49
INFO    [11-27 00:52:33] _train_one_epoch in BasicTrainer:
loss = 4.194154240868309
INFO    [11-27 00:52:34] validate in BasicTrainer:
{'Recall@10': 0.15834328904747963, 'NDCG@10': 0.08433635160326958, 'MRR@10': 0.061925314366817474, 'Recall*@10': 0.15834328904747963, 'NDCG*@10': 0.08433635160326958, 'MRR*@10': 0.061925314366817474}
INFO    [11-27 00:52:34] train in BasicTrainer:
duration: 3.7675015926361084s
INFO    [11-27 00:52:34] train in BasicTrainer:
epoch: 50
INFO    [11-27 00:52:37] _train_one_epoch in BasicTrainer:
loss = 4.178827058185231
INFO    [11-27 00:52:38] validate in BasicTrainer:
{'Recall@10': 0.15866337344050407, 'NDCG@10': 0.08510646410286427, 'MRR@10': 0.06282110139727592, 'Recall*@10': 0.15866337344050407, 'NDCG*@10': 0.08510646410286427, 'MRR*@10': 0.06282110139727592}
INFO    [11-27 00:52:38] train in BasicTrainer:
duration: 3.7926740646362305s
INFO    [11-27 00:52:38] train in BasicTrainer:
epoch: 51
INFO    [11-27 00:52:40] _train_one_epoch in BasicTrainer:
loss = 4.168423327532682
INFO    [11-27 00:52:42] validate in BasicTrainer:
{'Recall@10': 0.16052373498678207, 'NDCG@10': 0.084917476400733, 'MRR@10': 0.0620679035782814, 'Recall*@10': 0.16052373498678207, 'NDCG*@10': 0.084917476400733, 'MRR*@10': 0.0620679035782814}
INFO    [11-27 00:52:42] train in BasicTrainer:
duration: 3.6361606121063232s
INFO    [11-27 00:52:42] train in BasicTrainer:
epoch: 52
INFO    [11-27 00:52:44] _train_one_epoch in BasicTrainer:
loss = 4.153913422064348
INFO    [11-27 00:52:46] validate in BasicTrainer:
{'Recall@10': 0.1558009646832943, 'NDCG@10': 0.08425665460526943, 'MRR@10': 0.06253806035965681, 'Recall*@10': 0.1558009646832943, 'NDCG*@10': 0.08425665460526943, 'MRR*@10': 0.06253806035965681}
INFO    [11-27 00:52:46] train in BasicTrainer:
duration: 3.7213294506073s
INFO    [11-27 00:52:46] train in BasicTrainer:
epoch: 53
INFO    [11-27 00:52:48] _train_one_epoch in BasicTrainer:
loss = 4.1393749280409375
INFO    [11-27 00:52:49] validate in BasicTrainer:
{'Recall@10': 0.15615468844771385, 'NDCG@10': 0.08384321257472038, 'MRR@10': 0.06186164915561676, 'Recall*@10': 0.15615468844771385, 'NDCG*@10': 0.08384321257472038, 'MRR*@10': 0.06186164915561676}
INFO    [11-27 00:52:49] train in BasicTrainer:
duration: 3.7567970752716064s
INFO    [11-27 00:52:49] train in BasicTrainer:
epoch: 54
INFO    [11-27 00:52:51] _train_one_epoch in BasicTrainer:
loss = 4.134240529753945
INFO    [11-27 00:52:53] log in loggers:
Update Best NDCG@10 Model at 54
INFO    [11-27 00:52:53] validate in BasicTrainer:
{'Recall@10': 0.1572658084332943, 'NDCG@10': 0.08543403819203377, 'MRR@10': 0.06357641145586967, 'Recall*@10': 0.1572658084332943, 'NDCG*@10': 0.08543403819203377, 'MRR*@10': 0.06357641145586967}
INFO    [11-27 00:52:53] train in BasicTrainer:
duration: 3.8315842151641846s
INFO    [11-27 00:52:53] train in BasicTrainer:
epoch: 55
INFO    [11-27 00:52:55] _train_one_epoch in BasicTrainer:
loss = 4.118543511087244
INFO    [11-27 00:52:57] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [11-27 00:52:57] validate in BasicTrainer:
{'Recall@10': 0.15972403436899185, 'NDCG@10': 0.08660607412457466, 'MRR@10': 0.064361865632236, 'Recall*@10': 0.15972403436899185, 'NDCG*@10': 0.08660607412457466, 'MRR*@10': 0.064361865632236}
INFO    [11-27 00:52:57] train in BasicTrainer:
duration: 3.7911651134490967s
INFO    [11-27 00:52:57] train in BasicTrainer:
epoch: 56
INFO    [11-27 00:52:59] _train_one_epoch in BasicTrainer:
loss = 4.1053173542022705
INFO    [11-27 00:53:01] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [11-27 00:53:01] validate in BasicTrainer:
{'Recall@10': 0.16451408341526985, 'NDCG@10': 0.08826643414795399, 'MRR@10': 0.06518268398940563, 'Recall*@10': 0.16451408341526985, 'NDCG*@10': 0.08826643414795399, 'MRR*@10': 0.06518268398940563}
INFO    [11-27 00:53:01] train in BasicTrainer:
duration: 3.8989038467407227s
INFO    [11-27 00:53:01] train in BasicTrainer:
epoch: 57
INFO    [11-27 00:53:03] _train_one_epoch in BasicTrainer:
loss = 4.094072580337524
INFO    [11-27 00:53:05] validate in BasicTrainer:
{'Recall@10': 0.16109611466526985, 'NDCG@10': 0.08710403926670551, 'MRR@10': 0.0647089360281825, 'Recall*@10': 0.16109611466526985, 'NDCG*@10': 0.08710403926670551, 'MRR*@10': 0.0647089360281825}
INFO    [11-27 00:53:05] train in BasicTrainer:
duration: 3.792314291000366s
INFO    [11-27 00:53:05] train in BasicTrainer:
epoch: 58
INFO    [11-27 00:53:07] _train_one_epoch in BasicTrainer:
loss = 4.080746954137629
INFO    [11-27 00:53:08] validate in BasicTrainer:
{'Recall@10': 0.16050691530108452, 'NDCG@10': 0.08658280782401562, 'MRR@10': 0.06416035443544388, 'Recall*@10': 0.16050691530108452, 'NDCG*@10': 0.08658280782401562, 'MRR*@10': 0.06416035443544388}
INFO    [11-27 00:53:08] train in BasicTrainer:
duration: 3.736117124557495s
INFO    [11-27 00:53:08] train in BasicTrainer:
epoch: 59
INFO    [11-27 00:53:11] _train_one_epoch in BasicTrainer:
loss = 4.073032249103893
INFO    [11-27 00:53:12] validate in BasicTrainer:
{'Recall@10': 0.15920211374759674, 'NDCG@10': 0.08698052167892456, 'MRR@10': 0.06502468697726727, 'Recall*@10': 0.15920211374759674, 'NDCG*@10': 0.08698052167892456, 'MRR*@10': 0.06502468697726727}
INFO    [11-27 00:53:12] train in BasicTrainer:
duration: 3.8036441802978516s
INFO    [11-27 00:53:12] train in BasicTrainer:
epoch: 60
INFO    [11-27 00:53:14] _train_one_epoch in BasicTrainer:
loss = 4.063440116969022
INFO    [11-27 00:53:16] log in loggers:
Update Best NDCG@10 Model at 60
INFO    [11-27 00:53:16] validate in BasicTrainer:
{'Recall@10': 0.16407626122236252, 'NDCG@10': 0.0889205951243639, 'MRR@10': 0.06606460176408291, 'Recall*@10': 0.16407626122236252, 'NDCG*@10': 0.0889205951243639, 'MRR*@10': 0.06606460176408291}
INFO    [11-27 00:53:16] train in BasicTrainer:
duration: 3.815502166748047s
INFO    [11-27 00:53:16] train in BasicTrainer:
epoch: 61
INFO    [11-27 00:53:18] _train_one_epoch in BasicTrainer:
loss = 4.048650681972504
INFO    [11-27 00:53:20] validate in BasicTrainer:
{'Recall@10': 0.16121385246515274, 'NDCG@10': 0.08852915093302727, 'MRR@10': 0.06638025399297476, 'Recall*@10': 0.16121385246515274, 'NDCG*@10': 0.08852915093302727, 'MRR*@10': 0.06638025399297476}
INFO    [11-27 00:53:20] train in BasicTrainer:
duration: 3.7132983207702637s
INFO    [11-27 00:53:20] train in BasicTrainer:
epoch: 62
INFO    [11-27 00:53:22] _train_one_epoch in BasicTrainer:
loss = 4.036645553328774
INFO    [11-27 00:53:23] log in loggers:
Update Best NDCG@10 Model at 62
INFO    [11-27 00:53:24] validate in BasicTrainer:
{'Recall@10': 0.16475822404026985, 'NDCG@10': 0.08972970023751259, 'MRR@10': 0.06693508848547935, 'Recall*@10': 0.16475822404026985, 'NDCG*@10': 0.08972970023751259, 'MRR*@10': 0.06693508848547935}
INFO    [11-27 00:53:24] train in BasicTrainer:
duration: 3.876868963241577s
INFO    [11-27 00:53:24] train in BasicTrainer:
epoch: 63
INFO    [11-27 00:53:26] _train_one_epoch in BasicTrainer:
loss = 4.028631714257327
INFO    [11-27 00:53:28] validate in BasicTrainer:
{'Recall@10': 0.16524650529026985, 'NDCG@10': 0.08935423009097576, 'MRR@10': 0.06632952950894833, 'Recall*@10': 0.16524650529026985, 'NDCG*@10': 0.08935423009097576, 'MRR*@10': 0.06632952950894833}
INFO    [11-27 00:53:28] train in BasicTrainer:
duration: 3.9856832027435303s
INFO    [11-27 00:53:28] train in BasicTrainer:
epoch: 64
INFO    [11-27 00:53:30] _train_one_epoch in BasicTrainer:
loss = 4.017719642682509
INFO    [11-27 00:53:32] log in loggers:
Update Best NDCG@10 Model at 64
INFO    [11-27 00:53:32] validate in BasicTrainer:
{'Recall@10': 0.16402580216526985, 'NDCG@10': 0.08996179327368736, 'MRR@10': 0.06740805134177208, 'Recall*@10': 0.16402580216526985, 'NDCG*@10': 0.08996179327368736, 'MRR*@10': 0.06740805134177208}
INFO    [11-27 00:53:32] train in BasicTrainer:
duration: 4.102802991867065s
INFO    [11-27 00:53:32] train in BasicTrainer:
epoch: 65
INFO    [11-27 00:53:34] _train_one_epoch in BasicTrainer:
loss = 4.007914315570485
INFO    [11-27 00:53:35] validate in BasicTrainer:
{'Recall@10': 0.16357116028666496, 'NDCG@10': 0.0885932557284832, 'MRR@10': 0.0656950669363141, 'Recall*@10': 0.16357116028666496, 'NDCG*@10': 0.0885932557284832, 'MRR*@10': 0.0656950669363141}
INFO    [11-27 00:53:35] train in BasicTrainer:
duration: 3.67857027053833s
INFO    [11-27 00:53:35] train in BasicTrainer:
epoch: 66
INFO    [11-27 00:53:37] _train_one_epoch in BasicTrainer:
loss = 3.9988742037252947
INFO    [11-27 00:53:39] log in loggers:
Update Best NDCG@10 Model at 66
INFO    [11-27 00:53:39] validate in BasicTrainer:
{'Recall@10': 0.16677862778306007, 'NDCG@10': 0.09027526341378689, 'MRR@10': 0.06708107143640518, 'Recall*@10': 0.16677862778306007, 'NDCG*@10': 0.09027526341378689, 'MRR*@10': 0.06708107143640518}
INFO    [11-27 00:53:39] train in BasicTrainer:
duration: 3.632288932800293s
INFO    [11-27 00:53:39] train in BasicTrainer:
epoch: 67
INFO    [11-27 00:53:41] _train_one_epoch in BasicTrainer:
loss = 3.9883809902451257
INFO    [11-27 00:53:43] validate in BasicTrainer:
{'Recall@10': 0.1640089824795723, 'NDCG@10': 0.08967944793403149, 'MRR@10': 0.0670354263857007, 'Recall*@10': 0.1640089824795723, 'NDCG*@10': 0.08967944793403149, 'MRR*@10': 0.0670354263857007}
INFO    [11-27 00:53:43] train in BasicTrainer:
duration: 3.761155605316162s
INFO    [11-27 00:53:43] train in BasicTrainer:
epoch: 68
DEBUG   [11-27 00:53:43] calculate_loss in loss:
soft_target max: 0.5027613043785095, argmax 2036252
DEBUG   [11-27 00:53:43] calculate_loss in loss:
pred max in softmax: 0.2831898033618927, argmax 321789
DEBUG   [11-27 00:53:43] calculate_loss in loss:
soft_target max: 0.5027613043785095, argmax 442513
DEBUG   [11-27 00:53:43] calculate_loss in loss:
pred max in softmax: 0.22762201726436615, argmax 3653800
INFO    [11-27 00:53:45] _train_one_epoch in BasicTrainer:
loss = 3.9781736568971113
INFO    [11-27 00:53:46] validate in BasicTrainer:
{'Recall@10': 0.1628219187259674, 'NDCG@10': 0.090020090341568, 'MRR@10': 0.06772857252508402, 'Recall*@10': 0.1628219187259674, 'NDCG*@10': 0.090020090341568, 'MRR*@10': 0.06772857252508402}
INFO    [11-27 00:53:46] train in BasicTrainer:
duration: 3.4743247032165527s
INFO    [11-27 00:53:46] train in BasicTrainer:
epoch: 69
INFO    [11-27 00:53:48] _train_one_epoch in BasicTrainer:
loss = 3.9666765278035943
INFO    [11-27 00:53:50] log in loggers:
Update Best NDCG@10 Model at 69
INFO    [11-27 00:53:50] validate in BasicTrainer:
{'Recall@10': 0.1668795458972454, 'NDCG@10': 0.09212878718972206, 'MRR@10': 0.06936165690422058, 'Recall*@10': 0.1668795458972454, 'NDCG*@10': 0.09212878718972206, 'MRR*@10': 0.06936165690422058}
INFO    [11-27 00:53:50] train in BasicTrainer:
duration: 3.923189163208008s
INFO    [11-27 00:53:50] train in BasicTrainer:
epoch: 70
INFO    [11-27 00:53:52] _train_one_epoch in BasicTrainer:
loss = 3.9623436711051245
INFO    [11-27 00:53:54] validate in BasicTrainer:
{'Recall@10': 0.1627882793545723, 'NDCG@10': 0.09091323614120483, 'MRR@10': 0.06900550611317158, 'Recall*@10': 0.1627882793545723, 'NDCG*@10': 0.09091323614120483, 'MRR*@10': 0.06900550611317158}
INFO    [11-27 00:53:54] train in BasicTrainer:
duration: 3.613253355026245s
INFO    [11-27 00:53:54] train in BasicTrainer:
epoch: 71
INFO    [11-27 00:53:56] _train_one_epoch in BasicTrainer:
loss = 3.9532100829211148
INFO    [11-27 00:53:57] validate in BasicTrainer:
{'Recall@10': 0.1630660593509674, 'NDCG@10': 0.09077963978052139, 'MRR@10': 0.06878346763551235, 'Recall*@10': 0.1630660593509674, 'NDCG*@10': 0.09077963978052139, 'MRR*@10': 0.06878346763551235}
INFO    [11-27 00:53:57] train in BasicTrainer:
duration: 3.7198293209075928s
INFO    [11-27 00:53:57] train in BasicTrainer:
epoch: 72
INFO    [11-27 00:54:00] _train_one_epoch in BasicTrainer:
loss = 3.9386224042285574
INFO    [11-27 00:54:01] validate in BasicTrainer:
{'Recall@10': 0.16432040184736252, 'NDCG@10': 0.09128905273973942, 'MRR@10': 0.0691219661384821, 'Recall*@10': 0.16432040184736252, 'NDCG*@10': 0.09128905273973942, 'MRR*@10': 0.0691219661384821}
INFO    [11-27 00:54:01] train in BasicTrainer:
duration: 3.584859609603882s
INFO    [11-27 00:54:01] train in BasicTrainer:
epoch: 73
INFO    [11-27 00:54:03] _train_one_epoch in BasicTrainer:
loss = 3.9331708496267144
INFO    [11-27 00:54:05] log in loggers:
Update Best NDCG@10 Model at 73
INFO    [11-27 00:54:05] validate in BasicTrainer:
{'Recall@10': 0.17055847495794296, 'NDCG@10': 0.09275331161916256, 'MRR@10': 0.06920048967003822, 'Recall*@10': 0.17055847495794296, 'NDCG*@10': 0.09275331161916256, 'MRR*@10': 0.06920048967003822}
INFO    [11-27 00:54:05] train in BasicTrainer:
duration: 4.157559394836426s
INFO    [11-27 00:54:05] train in BasicTrainer:
epoch: 74
INFO    [11-27 00:54:07] _train_one_epoch in BasicTrainer:
loss = 3.924181271683086
INFO    [11-27 00:54:09] validate in BasicTrainer:
{'Recall@10': 0.16803297027945518, 'NDCG@10': 0.09252494387328625, 'MRR@10': 0.06952591612935066, 'Recall*@10': 0.16803297027945518, 'NDCG*@10': 0.09252494387328625, 'MRR*@10': 0.06952591612935066}
INFO    [11-27 00:54:09] train in BasicTrainer:
duration: 3.6323719024658203s
INFO    [11-27 00:54:09] train in BasicTrainer:
epoch: 75
INFO    [11-27 00:54:11] _train_one_epoch in BasicTrainer:
loss = 3.913976566358046
INFO    [11-27 00:54:13] log in loggers:
Update Best NDCG@10 Model at 75
INFO    [11-27 00:54:13] validate in BasicTrainer:
{'Recall@10': 0.16845397278666496, 'NDCG@10': 0.09378175996243954, 'MRR@10': 0.0711072999984026, 'Recall*@10': 0.16845397278666496, 'NDCG*@10': 0.09378175996243954, 'MRR*@10': 0.0711072999984026}
INFO    [11-27 00:54:13] train in BasicTrainer:
duration: 3.960076332092285s
INFO    [11-27 00:54:13] train in BasicTrainer:
epoch: 76
INFO    [11-27 00:54:15] _train_one_epoch in BasicTrainer:
loss = 3.8999752564863726
INFO    [11-27 00:54:16] validate in BasicTrainer:
{'Recall@10': 0.16636629030108452, 'NDCG@10': 0.09264183603227139, 'MRR@10': 0.07016303762793541, 'Recall*@10': 0.16636629030108452, 'NDCG*@10': 0.09264183603227139, 'MRR*@10': 0.07016303762793541}
INFO    [11-27 00:54:16] train in BasicTrainer:
duration: 3.6421964168548584s
INFO    [11-27 00:54:16] train in BasicTrainer:
epoch: 77
INFO    [11-27 00:54:19] _train_one_epoch in BasicTrainer:
loss = 3.896103403785012
INFO    [11-27 00:54:20] log in loggers:
Update Best NDCG@10 Model at 77
INFO    [11-27 00:54:20] validate in BasicTrainer:
{'Recall@10': 0.1684035137295723, 'NDCG@10': 0.09392208606004715, 'MRR@10': 0.07128699868917465, 'Recall*@10': 0.1684035137295723, 'NDCG*@10': 0.09392208606004715, 'MRR*@10': 0.07128699868917465}
INFO    [11-27 00:54:20] train in BasicTrainer:
duration: 3.8484299182891846s
INFO    [11-27 00:54:20] train in BasicTrainer:
epoch: 78
INFO    [11-27 00:54:23] _train_one_epoch in BasicTrainer:
loss = 3.8901624462821265
INFO    [11-27 00:54:24] validate in BasicTrainer:
{'Recall@10': 0.1706344187259674, 'NDCG@10': 0.09388339892029762, 'MRR@10': 0.07057265378534794, 'Recall*@10': 0.1706344187259674, 'NDCG*@10': 0.09388339892029762, 'MRR*@10': 0.07057265378534794}
INFO    [11-27 00:54:24] train in BasicTrainer:
duration: 3.8184754848480225s
INFO    [11-27 00:54:24] train in BasicTrainer:
epoch: 79
INFO    [11-27 00:54:26] _train_one_epoch in BasicTrainer:
loss = 3.8772957812656057
INFO    [11-27 00:54:28] log in loggers:
Update Best NDCG@10 Model at 79
INFO    [11-27 00:54:28] validate in BasicTrainer:
{'Recall@10': 0.17141729965806007, 'NDCG@10': 0.0945078544318676, 'MRR@10': 0.07125561870634556, 'Recall*@10': 0.17141729965806007, 'NDCG*@10': 0.0945078544318676, 'MRR*@10': 0.07125561870634556}
INFO    [11-27 00:54:28] train in BasicTrainer:
duration: 3.809602737426758s
INFO    [11-27 00:54:28] close_training in BasicTrainer:
finished training
DEBUG   [11-27 00:54:28] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3521 times, ratio nan / (nan + not_nan) = 0.0
INFO    [11-27 00:54:28] run_routine in Routine:
Finished training, Start final validation
INFO    [11-27 00:54:28] final_validate in BasicTrainer:
validate model on val set!
INFO    [11-27 00:54:28] load_state_from_given_path in utils:
checkpoint epoch: 79
INFO    [11-27 00:54:28] load_state_from_given_path in utils:
Loading model's parameters
INFO    [11-27 00:54:30] validate in BasicTrainer:
{'Recall@10': 0.17141729965806007, 'NDCG@10': 0.0945078544318676, 'MRR@10': 0.07125561870634556, 'Recall*@10': 0.17141729965806007, 'NDCG*@10': 0.0945078544318676, 'MRR*@10': 0.07125561870634556}
INFO    [11-27 00:54:30] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.17141729965806007, 'NDCG@10': 0.0945078544318676, 'MRR@10': 0.07125561870634556, 'Recall*@10': 0.17141729965806007, 'NDCG*@10': 0.0945078544318676, 'MRR*@10': 0.07125561870634556}
INFO    [11-27 00:54:30] _evaluate in DistillSched:
Start testing student model on test set
INFO    [11-27 00:54:30] test in BasicTrainer:
Test model on test set!
INFO    [11-27 00:54:30] test_with_given_state_path in BasicTrainer:
Loading model params from _____lfms_soft_len_2/soft_gru4rec-len-15_11-27_00-49_t2/student_gru4rec_logs/checkpoint/best_acc_model.pth.
INFO    [11-27 00:54:30] load_state_from_given_path in utils:
checkpoint epoch: 79
INFO    [11-27 00:54:30] load_state_from_given_path in utils:
Loading model's parameters
INFO    [11-27 00:54:30] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [11-27 00:54:31] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.15415110439062119, 'NDCG@10': 0.08196774497628212, 'MRR@10': 0.06003638915717602, 'Recall*@10': 0.15415110439062119, 'NDCG*@10': 0.08196774497628212, 'MRR*@10': 0.06003638915717602}
INFO    [11-27 00:54:31] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.15415110439062119, 'NDCG@10': 0.08196774497628212, 'MRR@10': 0.06003638915717602, 'Recall*@10': 0.15415110439062119, 'NDCG*@10': 0.08196774497628212, 'MRR*@10': 0.06003638915717602}
