INFO    [11-27 01:05:58] setup_train in utils:
{
    "experiment_dir": "_____lfms_soft_len_2",
    "experiment_description": "soft",
    "describe": "{config[model_code]}-len-{config[max_len]}",
    "dataset_name": "lastfm_small.csv",
    "sched": "distill",
    "model_code": "gru4rec",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "dvae_alpha": 0.5,
    "alpha": 0.5,
    "T": 3,
    "num_epochs": 80,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 30,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2021,
    "load_processed_dataset": false,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 1024,
    "val_batch_size": 1024,
    "test_batch_size": 1024,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.lastfm_small/gru4rec/config_distill.json",
    "task_id": 5,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [11-27 01:05:58] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_gru4rec
INFO    [11-27 01:05:58] _gen_dataset in utils:
processing dataset lastfm_small.csv
INFO    [11-27 01:05:58] _drop_cold in utils:
filtering out cold users (who interacts with less or eq than 5 items) and cold items (which is interacted by less or eq than 5 users)
DEBUG   [11-27 01:05:58] _drop_cold in utils:
before filtering, there are 1090 users, 3646 items 
DEBUG   [11-27 01:05:58] _drop_cold in utils:
after 0 filterings, there are 1090 users, 3646 items
INFO    [11-27 01:05:58] _drop_cold in utils:
user desc 
            seq_len
count  1090.000000
mean     48.211927
std      77.730410
min       5.000000
25%       9.000000
50%      19.000000
75%      49.750000
max     899.000000
INFO    [11-27 01:05:58] _drop_cold in utils:
item desc 
           item_pop
count  3646.000000
mean     14.413330
std      16.072829
min       5.000000
25%       6.000000
50%       9.000000
75%      15.000000
max     177.000000
INFO    [11-27 01:05:58] _df_data_partition in utils:
dataset summary:
         session_id       item_id   rating
count  52551.000000  52551.000000  52551.0
mean     527.873799   1828.243915      1.0
std      316.650738   1049.669215      0.0
min        1.000000      1.000000      1.0
25%      248.000000    928.000000      1.0
50%      515.000000   1834.000000      1.0
75%      813.000000   2718.500000      1.0
max     1090.000000   3646.000000      1.0
INFO    [11-27 01:05:58] __init__ in NextItemDataloader:
there are 3646 items in this dataset, 2376 users, padding_first? False
DEBUG   [11-27 01:05:59] generate_model in utils:
model_code_list=['pop']
INFO    [11-27 01:05:59] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [11-27 01:05:59] load_model_config in utils:
{}
WARNING [11-27 01:06:03] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-30_11-27_01-05_t5/teacher_pop_logs does not exist! Create one.
WARNING [11-27 01:06:03] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-30_11-27_01-05_t5/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [11-27 01:06:03] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-30_11-27_01-05_t5/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [11-27 01:06:03] get_path in utils:
Path is None
WARNING [11-27 01:06:03] load_state_from_given_path in utils:
Not given any path.
DEBUG   [11-27 01:06:03] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [11-27 01:06:03] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [11-27 01:06:03] __init__ in BasicTrainer:
51200 iter per epoch
DEBUG   [11-27 01:06:03] generate_model in utils:
model_code_list=['gru4rec']
INFO    [11-27 01:06:03] load_model_config in utils:
loading model gru4rec's config file at asset/config/model/gru4rec.json
INFO    [11-27 01:06:03] load_model_config in utils:
{
    "embed_size": 64,
    "hidden_units": 64,
    "num_layers": 2,
    "hidden_dropout": 0.5,
    "loss_type": "CE"
}
WARNING [11-27 01:06:05] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-30_11-27_01-05_t5/student_gru4rec_logs does not exist! Create one.
WARNING [11-27 01:06:05] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-30_11-27_01-05_t5/student_gru4rec_logs/tb_vis does not exist! Create one.
WARNING [11-27 01:06:05] get_exist_path in utils:
dir _____lfms_soft_len_2/soft_gru4rec-len-30_11-27_01-05_t5/student_gru4rec_logs/checkpoint does not exist! Create one.
WARNING [11-27 01:06:05] get_path in utils:
Path is None
WARNING [11-27 01:06:05] load_state_from_given_path in utils:
Not given any path.
DEBUG   [11-27 01:06:05] __init__ in DistillSched:
student model: 
GRU4RecModel(
  (item_embedding): Embedding(3647, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.5, inplace=False)
  (gru_layers): GRU(64, 64, num_layers=2, bias=False, batch_first=True)
  (dense): Linear(in_features=64, out_features=64, bias=True)
  (loss_fct): CrossEntropyLoss()
)
INFO    [11-27 01:06:05] assert_model_device in utils:
model student_gru4rec has 1.09375 MB params.
INFO    [11-27 01:06:05] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [11-27 01:06:05] __init__ in DistillTrainer:
51200 iter per epoch
INFO    [11-27 01:06:05] _set_current_routine in Routine:
first routine: student
INFO    [11-27 01:06:05] run_routine in Routine:
Start routine student
INFO    [11-27 01:06:05] run_routine in Routine:
Start training
INFO    [11-27 01:06:05] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [11-27 01:06:06] test_mentor in DistillTrainer:
{'Recall@10': 0.03140085066358248, 'NDCG@10': 0.01530759378025929, 'MRR@10': 0.010382067101697126, 'Recall*@10': 0.03140085066358248, 'NDCG*@10': 0.01530759378025929, 'MRR*@10': 0.010382067101697126}
INFO    [11-27 01:06:06] train in DistillTrainer:
result:
{'Recall@10': 0.03140085066358248, 'NDCG@10': 0.01530759378025929, 'MRR@10': 0.010382067101697126, 'Recall*@10': 0.03140085066358248, 'NDCG*@10': 0.01530759378025929, 'MRR*@10': 0.010382067101697126}
INFO    [11-27 01:06:07] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [11-27 01:06:07] validate in BasicTrainer:
{'Recall@10': 0.001341780958076318, 'NDCG@10': 0.0006461152224801481, 'MRR@10': 0.0004525533489262064, 'Recall*@10': 0.001341780958076318, 'NDCG*@10': 0.0006461152224801481, 'MRR*@10': 0.0004525533489262064}
INFO    [11-27 01:06:07] train in BasicTrainer:
epoch: 0
DEBUG   [11-27 01:06:08] calculate_loss in loss:
soft_target max: 0.5027085542678833, argmax 2083663
DEBUG   [11-27 01:06:08] calculate_loss in loss:
pred max in softmax: 0.00028812873642891645, argmax 8858
INFO    [11-27 01:06:11] _train_one_epoch in BasicTrainer:
loss = 5.730329351425171
INFO    [11-27 01:06:12] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [11-27 01:06:12] validate in BasicTrainer:
{'Recall@10': 0.023429560164610546, 'NDCG@10': 0.011392681238551935, 'MRR@10': 0.007841964407513538, 'Recall*@10': 0.023429560164610546, 'NDCG*@10': 0.011392681238551935, 'MRR*@10': 0.007841964407513538}
INFO    [11-27 01:06:12] train in BasicTrainer:
duration: 4.983933925628662s
INFO    [11-27 01:06:12] train in BasicTrainer:
epoch: 1
INFO    [11-27 01:06:16] _train_one_epoch in BasicTrainer:
loss = 5.485564842224121
INFO    [11-27 01:06:17] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [11-27 01:06:17] validate in BasicTrainer:
{'Recall@10': 0.02603372683127721, 'NDCG@10': 0.012652171154816946, 'MRR@10': 0.008791645988821983, 'Recall*@10': 0.02603372683127721, 'NDCG*@10': 0.012652171154816946, 'MRR*@10': 0.008791645988821983}
INFO    [11-27 01:06:17] train in BasicTrainer:
duration: 5.361552953720093s
INFO    [11-27 01:06:17] train in BasicTrainer:
epoch: 2
INFO    [11-27 01:06:21] _train_one_epoch in BasicTrainer:
loss = 5.4257599639892575
INFO    [11-27 01:06:23] validate in BasicTrainer:
{'Recall@10': 0.026684768497943878, 'NDCG@10': 0.011738241650164127, 'MRR@10': 0.00730155020331343, 'Recall*@10': 0.026684768497943878, 'NDCG*@10': 0.011738241650164127, 'MRR*@10': 0.00730155020331343}
INFO    [11-27 01:06:23] train in BasicTrainer:
duration: 5.439576625823975s
INFO    [11-27 01:06:23] train in BasicTrainer:
epoch: 3
INFO    [11-27 01:06:26] _train_one_epoch in BasicTrainer:
loss = 5.38973690032959
INFO    [11-27 01:06:28] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [11-27 01:06:28] validate in BasicTrainer:
{'Recall@10': 0.029614455997943878, 'NDCG@10': 0.016817656345665455, 'MRR@10': 0.013026696008940538, 'Recall*@10': 0.029614455997943878, 'NDCG*@10': 0.016817656345665455, 'MRR*@10': 0.013026696008940538}
INFO    [11-27 01:06:28] train in BasicTrainer:
duration: 4.828584909439087s
INFO    [11-27 01:06:28] train in BasicTrainer:
epoch: 4
INFO    [11-27 01:06:31] _train_one_epoch in BasicTrainer:
loss = 5.331279296875
INFO    [11-27 01:06:32] validate in BasicTrainer:
{'Recall@10': 0.0320598321656386, 'NDCG@10': 0.014927369697640339, 'MRR@10': 0.009794235927984118, 'Recall*@10': 0.0320598321656386, 'NDCG*@10': 0.014927369697640339, 'MRR*@10': 0.009794235927984118}
INFO    [11-27 01:06:32] train in BasicTrainer:
duration: 4.576275825500488s
INFO    [11-27 01:06:32] train in BasicTrainer:
epoch: 5
INFO    [11-27 01:06:35] _train_one_epoch in BasicTrainer:
loss = 5.241210241317749
INFO    [11-27 01:06:37] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [11-27 01:06:37] validate in BasicTrainer:
{'Recall@10': 0.05467162032922109, 'NDCG@10': 0.024069133525093395, 'MRR@10': 0.014999144400159517, 'Recall*@10': 0.05467162032922109, 'NDCG*@10': 0.024069133525093395, 'MRR*@10': 0.014999144400159517}
INFO    [11-27 01:06:37] train in BasicTrainer:
duration: 4.528661251068115s
INFO    [11-27 01:06:37] train in BasicTrainer:
epoch: 6
INFO    [11-27 01:06:40] _train_one_epoch in BasicTrainer:
loss = 5.168976716995239
INFO    [11-27 01:06:42] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [11-27 01:06:42] validate in BasicTrainer:
{'Recall@10': 0.06097560872634252, 'NDCG@10': 0.029704225560029347, 'MRR@10': 0.020364586884776752, 'Recall*@10': 0.06097560872634252, 'NDCG*@10': 0.029704225560029347, 'MRR*@10': 0.020364586884776752}
INFO    [11-27 01:06:42] train in BasicTrainer:
duration: 5.0079851150512695s
INFO    [11-27 01:06:42] train in BasicTrainer:
epoch: 7
INFO    [11-27 01:06:45] _train_one_epoch in BasicTrainer:
loss = 5.119937715530395
INFO    [11-27 01:06:46] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [11-27 01:06:46] validate in BasicTrainer:
{'Recall@10': 0.0642705149948597, 'NDCG@10': 0.03187072463333607, 'MRR@10': 0.022103834276398022, 'Recall*@10': 0.0642705149948597, 'NDCG*@10': 0.03187072463333607, 'MRR*@10': 0.022103834276398022}
INFO    [11-27 01:06:46] train in BasicTrainer:
duration: 4.744728088378906s
INFO    [11-27 01:06:46] train in BasicTrainer:
epoch: 8
INFO    [11-27 01:06:50] _train_one_epoch in BasicTrainer:
loss = 5.075827512741089
INFO    [11-27 01:06:52] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [11-27 01:06:52] validate in BasicTrainer:
{'Recall@10': 0.06695407629013062, 'NDCG@10': 0.035201999048391976, 'MRR@10': 0.025638847922285397, 'Recall*@10': 0.06695407629013062, 'NDCG*@10': 0.035201999048391976, 'MRR*@10': 0.025638847922285397}
INFO    [11-27 01:06:52] train in BasicTrainer:
duration: 5.123487234115601s
INFO    [11-27 01:06:52] train in BasicTrainer:
epoch: 9
INFO    [11-27 01:06:55] _train_one_epoch in BasicTrainer:
loss = 5.033385572433471
INFO    [11-27 01:06:56] validate in BasicTrainer:
{'Recall@10': 0.0698440670967102, 'NDCG@10': 0.034592067201932274, 'MRR@10': 0.023954156165321667, 'Recall*@10': 0.0698440670967102, 'NDCG*@10': 0.034592067201932274, 'MRR*@10': 0.023954156165321667}
INFO    [11-27 01:06:56] train in BasicTrainer:
duration: 4.7670862674713135s
INFO    [11-27 01:06:56] train in BasicTrainer:
epoch: 10
INFO    [11-27 01:07:00] _train_one_epoch in BasicTrainer:
loss = 4.988507070541382
INFO    [11-27 01:07:01] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [11-27 01:07:01] validate in BasicTrainer:
{'Recall@10': 0.07342479626337688, 'NDCG@10': 0.036283756916721664, 'MRR@10': 0.02526697392265002, 'Recall*@10': 0.07342479626337688, 'NDCG*@10': 0.036283756916721664, 'MRR*@10': 0.02526697392265002}
INFO    [11-27 01:07:01] train in BasicTrainer:
duration: 4.994694948196411s
INFO    [11-27 01:07:01] train in BasicTrainer:
epoch: 11
INFO    [11-27 01:07:05] _train_one_epoch in BasicTrainer:
loss = 4.9376462459564205
INFO    [11-27 01:07:06] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [11-27 01:07:07] validate in BasicTrainer:
{'Recall@10': 0.07407583793004353, 'NDCG@10': 0.03668073068062464, 'MRR@10': 0.025554198150833447, 'Recall*@10': 0.07407583793004353, 'NDCG*@10': 0.03668073068062464, 'MRR*@10': 0.025554198150833447}
INFO    [11-27 01:07:07] train in BasicTrainer:
duration: 5.155654430389404s
INFO    [11-27 01:07:07] train in BasicTrainer:
epoch: 12
INFO    [11-27 01:07:10] _train_one_epoch in BasicTrainer:
loss = 4.882021026611328
INFO    [11-27 01:07:11] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [11-27 01:07:12] validate in BasicTrainer:
{'Recall@10': 0.08294429630041122, 'NDCG@10': 0.04232905929287275, 'MRR@10': 0.030073387548327446, 'Recall*@10': 0.08294429630041122, 'NDCG*@10': 0.04232905929287275, 'MRR*@10': 0.030073387548327446}
INFO    [11-27 01:07:12] train in BasicTrainer:
duration: 4.985522031784058s
INFO    [11-27 01:07:12] train in BasicTrainer:
epoch: 13
INFO    [11-27 01:07:15] _train_one_epoch in BasicTrainer:
loss = 4.827152357101441
INFO    [11-27 01:07:16] validate in BasicTrainer:
{'Recall@10': 0.08591368049383163, 'NDCG@10': 0.042269059146444, 'MRR@10': 0.029105146105090778, 'Recall*@10': 0.08591368049383163, 'NDCG*@10': 0.042269059146444, 'MRR*@10': 0.029105146105090778}
INFO    [11-27 01:07:16] train in BasicTrainer:
duration: 4.651214361190796s
INFO    [11-27 01:07:16] train in BasicTrainer:
epoch: 14
INFO    [11-27 01:07:20] _train_one_epoch in BasicTrainer:
loss = 4.7771733951568605
INFO    [11-27 01:07:21] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [11-27 01:07:21] validate in BasicTrainer:
{'Recall@10': 0.0936388447880745, 'NDCG@10': 0.04609702403346697, 'MRR@10': 0.03184741549193859, 'Recall*@10': 0.0936388447880745, 'NDCG*@10': 0.04609702403346697, 'MRR*@10': 0.03184741549193859}
INFO    [11-27 01:07:21] train in BasicTrainer:
duration: 4.790675163269043s
INFO    [11-27 01:07:21] train in BasicTrainer:
epoch: 15
INFO    [11-27 01:07:24] _train_one_epoch in BasicTrainer:
loss = 4.735265922546387
INFO    [11-27 01:07:26] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [11-27 01:07:26] validate in BasicTrainer:
{'Recall@10': 0.09677496055761974, 'NDCG@10': 0.04837219292918841, 'MRR@10': 0.03388994621733824, 'Recall*@10': 0.09677496055761974, 'NDCG*@10': 0.04837219292918841, 'MRR*@10': 0.03388994621733824}
INFO    [11-27 01:07:26] train in BasicTrainer:
duration: 4.786555767059326s
INFO    [11-27 01:07:26] train in BasicTrainer:
epoch: 16
INFO    [11-27 01:07:29] _train_one_epoch in BasicTrainer:
loss = 4.699483633041382
INFO    [11-27 01:07:31] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [11-27 01:07:31] validate in BasicTrainer:
{'Recall@10': 0.09933943053086598, 'NDCG@10': 0.05143432319164276, 'MRR@10': 0.03689385515948137, 'Recall*@10': 0.09933943053086598, 'NDCG*@10': 0.05143432319164276, 'MRR*@10': 0.03689385515948137}
INFO    [11-27 01:07:31] train in BasicTrainer:
duration: 5.192375659942627s
INFO    [11-27 01:07:31] train in BasicTrainer:
epoch: 17
INFO    [11-27 01:07:34] _train_one_epoch in BasicTrainer:
loss = 4.65697639465332
INFO    [11-27 01:07:36] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [11-27 01:07:36] validate in BasicTrainer:
{'Recall@10': 0.11532170822223027, 'NDCG@10': 0.057112070421377815, 'MRR@10': 0.03964631880323092, 'Recall*@10': 0.11532170822223027, 'NDCG*@10': 0.057112070421377815, 'MRR*@10': 0.03964631880323092}
INFO    [11-27 01:07:36] train in BasicTrainer:
duration: 4.832213878631592s
INFO    [11-27 01:07:36] train in BasicTrainer:
epoch: 18
INFO    [11-27 01:07:39] _train_one_epoch in BasicTrainer:
loss = 4.623651704788208
INFO    [11-27 01:07:40] validate in BasicTrainer:
{'Recall@10': 0.11125666896502177, 'NDCG@10': 0.056727913518746696, 'MRR@10': 0.04038811847567558, 'Recall*@10': 0.11125666896502177, 'NDCG*@10': 0.056727913518746696, 'MRR*@10': 0.04038811847567558}
INFO    [11-27 01:07:40] train in BasicTrainer:
duration: 4.50528883934021s
INFO    [11-27 01:07:40] train in BasicTrainer:
epoch: 19
DEBUG   [11-27 01:07:44] calculate_loss in loss:
soft_target max: 0.5027085542678833, argmax 81460
DEBUG   [11-27 01:07:44] calculate_loss in loss:
pred max in softmax: 0.08248995989561081, argmax 1407560
INFO    [11-27 01:07:44] _train_one_epoch in BasicTrainer:
loss = 4.590046281814575
INFO    [11-27 01:07:45] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [11-27 01:07:45] validate in BasicTrainer:
{'Recall@10': 0.1136544073621432, 'NDCG@10': 0.057206654300292335, 'MRR@10': 0.040276672691106796, 'Recall*@10': 0.1136544073621432, 'NDCG*@10': 0.057206654300292335, 'MRR*@10': 0.040276672691106796}
INFO    [11-27 01:07:45] train in BasicTrainer:
duration: 5.135034084320068s
INFO    [11-27 01:07:45] train in BasicTrainer:
epoch: 20
DEBUG   [11-27 01:07:46] calculate_loss in loss:
soft_target max: 0.5027085542678833, argmax 1452732
DEBUG   [11-27 01:07:46] calculate_loss in loss:
pred max in softmax: 0.06078139692544937, argmax 2428720
INFO    [11-27 01:07:49] _train_one_epoch in BasicTrainer:
loss = 4.5619502353668215
INFO    [11-27 01:07:50] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [11-27 01:07:50] validate in BasicTrainer:
{'Recall@10': 0.1125587522983551, 'NDCG@10': 0.059675085047880806, 'MRR@10': 0.0437144028643767, 'Recall*@10': 0.1125587522983551, 'NDCG*@10': 0.059675085047880806, 'MRR*@10': 0.0437144028643767}
INFO    [11-27 01:07:50] train in BasicTrainer:
duration: 4.8127617835998535s
INFO    [11-27 01:07:50] train in BasicTrainer:
epoch: 21
INFO    [11-27 01:07:54] _train_one_epoch in BasicTrainer:
loss = 4.537311649322509
INFO    [11-27 01:07:55] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [11-27 01:07:55] validate in BasicTrainer:
{'Recall@10': 0.1191485623518626, 'NDCG@10': 0.06129071116447449, 'MRR@10': 0.04382554938395818, 'Recall*@10': 0.1191485623518626, 'NDCG*@10': 0.06129071116447449, 'MRR*@10': 0.04382554938395818}
INFO    [11-27 01:07:55] train in BasicTrainer:
duration: 4.761586904525757s
INFO    [11-27 01:07:55] train in BasicTrainer:
epoch: 22
INFO    [11-27 01:07:59] _train_one_epoch in BasicTrainer:
loss = 4.510117416381836
INFO    [11-27 01:08:00] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [11-27 01:08:00] validate in BasicTrainer:
{'Recall@10': 0.12480151156584422, 'NDCG@10': 0.06417059774200122, 'MRR@10': 0.046073740969101586, 'Recall*@10': 0.12480151156584422, 'NDCG*@10': 0.06417059774200122, 'MRR*@10': 0.046073740969101586}
INFO    [11-27 01:08:00] train in BasicTrainer:
duration: 5.202349424362183s
INFO    [11-27 01:08:00] train in BasicTrainer:
epoch: 23
INFO    [11-27 01:08:04] _train_one_epoch in BasicTrainer:
loss = 4.487457103729248
INFO    [11-27 01:08:05] validate in BasicTrainer:
{'Recall@10': 0.12508733322223028, 'NDCG@10': 0.06335857634743054, 'MRR@10': 0.044803945968548455, 'Recall*@10': 0.12508733322223028, 'NDCG*@10': 0.06335857634743054, 'MRR*@10': 0.044803945968548455}
INFO    [11-27 01:08:05] train in BasicTrainer:
duration: 5.09796142578125s
INFO    [11-27 01:08:05] train in BasicTrainer:
epoch: 24
INFO    [11-27 01:08:09] _train_one_epoch in BasicTrainer:
loss = 4.466651401519775
INFO    [11-27 01:08:10] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [11-27 01:08:10] validate in BasicTrainer:
{'Recall@10': 0.12748507161935171, 'NDCG@10': 0.06518649682402611, 'MRR@10': 0.04635092740257581, 'Recall*@10': 0.12748507161935171, 'NDCG*@10': 0.06518649682402611, 'MRR*@10': 0.04635092740257581}
INFO    [11-27 01:08:10] train in BasicTrainer:
duration: 5.064439058303833s
INFO    [11-27 01:08:10] train in BasicTrainer:
epoch: 25
INFO    [11-27 01:08:14] _train_one_epoch in BasicTrainer:
loss = 4.447641201019287
INFO    [11-27 01:08:15] validate in BasicTrainer:
{'Recall@10': 0.1254922499259313, 'NDCG@10': 0.06390006219347318, 'MRR@10': 0.04533521210153898, 'Recall*@10': 0.1254922499259313, 'NDCG*@10': 0.06390006219347318, 'MRR*@10': 0.04533521210153898}
INFO    [11-27 01:08:15] train in BasicTrainer:
duration: 4.622377634048462s
INFO    [11-27 01:08:15] train in BasicTrainer:
epoch: 26
INFO    [11-27 01:08:18] _train_one_epoch in BasicTrainer:
loss = 4.426456117630005
INFO    [11-27 01:08:20] validate in BasicTrainer:
{'Recall@10': 0.1274056782325109, 'NDCG@10': 0.065060509989659, 'MRR@10': 0.046187633027633034, 'Recall*@10': 0.1274056782325109, 'NDCG*@10': 0.065060509989659, 'MRR*@10': 0.046187633027633034}
INFO    [11-27 01:08:20] train in BasicTrainer:
duration: 4.572151184082031s
INFO    [11-27 01:08:20] train in BasicTrainer:
epoch: 27
INFO    [11-27 01:08:23] _train_one_epoch in BasicTrainer:
loss = 4.404521532058716
INFO    [11-27 01:08:24] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [11-27 01:08:24] validate in BasicTrainer:
{'Recall@10': 0.13468622912963232, 'NDCG@10': 0.06762595723072688, 'MRR@10': 0.0475157896677653, 'Recall*@10': 0.13468622912963232, 'NDCG*@10': 0.06762595723072688, 'MRR*@10': 0.0475157896677653}
INFO    [11-27 01:08:24] train in BasicTrainer:
duration: 4.895243883132935s
INFO    [11-27 01:08:24] train in BasicTrainer:
epoch: 28
INFO    [11-27 01:08:28] _train_one_epoch in BasicTrainer:
loss = 4.387491140365601
INFO    [11-27 01:08:29] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [11-27 01:08:29] validate in BasicTrainer:
{'Recall@10': 0.13798113415638605, 'NDCG@10': 0.06907402724027634, 'MRR@10': 0.04849266757567724, 'Recall*@10': 0.13798113415638605, 'NDCG*@10': 0.06907402724027634, 'MRR*@10': 0.04849266757567724}
INFO    [11-27 01:08:29] train in BasicTrainer:
duration: 5.002664089202881s
INFO    [11-27 01:08:29] train in BasicTrainer:
epoch: 29
INFO    [11-27 01:08:33] _train_one_epoch in BasicTrainer:
loss = 4.371562337875366
INFO    [11-27 01:08:34] validate in BasicTrainer:
{'Recall@10': 0.1293588032325109, 'NDCG@10': 0.06640622392296791, 'MRR@10': 0.04757716382543246, 'Recall*@10': 0.1293588032325109, 'NDCG*@10': 0.06640622392296791, 'MRR*@10': 0.04757716382543246}
INFO    [11-27 01:08:34] train in BasicTrainer:
duration: 4.852438688278198s
INFO    [11-27 01:08:34] train in BasicTrainer:
epoch: 30
INFO    [11-27 01:08:38] _train_one_epoch in BasicTrainer:
loss = 4.348736724853516
INFO    [11-27 01:08:39] validate in BasicTrainer:
{'Recall@10': 0.13436070829629898, 'NDCG@10': 0.06788815557956696, 'MRR@10': 0.048035857578118644, 'Recall*@10': 0.13436070829629898, 'NDCG*@10': 0.06788815557956696, 'MRR*@10': 0.048035857578118644}
INFO    [11-27 01:08:39] train in BasicTrainer:
duration: 4.569714784622192s
INFO    [11-27 01:08:39] train in BasicTrainer:
epoch: 31
INFO    [11-27 01:08:42] _train_one_epoch in BasicTrainer:
loss = 4.3344309425354
INFO    [11-27 01:08:44] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [11-27 01:08:44] validate in BasicTrainer:
{'Recall@10': 0.13667905082305273, 'NDCG@10': 0.07080357149243355, 'MRR@10': 0.051082863161961235, 'Recall*@10': 0.13667905082305273, 'NDCG*@10': 0.07080357149243355, 'MRR*@10': 0.051082863161961235}
INFO    [11-27 01:08:44] train in BasicTrainer:
duration: 5.071018934249878s
INFO    [11-27 01:08:44] train in BasicTrainer:
epoch: 32
INFO    [11-27 01:08:48] _train_one_epoch in BasicTrainer:
loss = 4.317395229339599
INFO    [11-27 01:08:49] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [11-27 01:08:49] validate in BasicTrainer:
{'Recall@10': 0.14160156001647314, 'NDCG@10': 0.07218446334203084, 'MRR@10': 0.05141690125068029, 'Recall*@10': 0.14160156001647314, 'NDCG*@10': 0.07218446334203084, 'MRR*@10': 0.05141690125068029}
INFO    [11-27 01:08:49] train in BasicTrainer:
duration: 5.066649913787842s
INFO    [11-27 01:08:49] train in BasicTrainer:
epoch: 33
INFO    [11-27 01:08:52] _train_one_epoch in BasicTrainer:
loss = 4.298462009429931
INFO    [11-27 01:08:53] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [11-27 01:08:54] validate in BasicTrainer:
{'Recall@10': 0.1435943841934204, 'NDCG@10': 0.0728681484858195, 'MRR@10': 0.05177819232145945, 'Recall*@10': 0.1435943841934204, 'NDCG*@10': 0.0728681484858195, 'MRR*@10': 0.05177819232145945}
INFO    [11-27 01:08:54] train in BasicTrainer:
duration: 4.568488359451294s
INFO    [11-27 01:08:54] train in BasicTrainer:
epoch: 34
INFO    [11-27 01:08:57] _train_one_epoch in BasicTrainer:
loss = 4.282749109268188
INFO    [11-27 01:08:59] validate in BasicTrainer:
{'Recall@10': 0.1422129049897194, 'NDCG@10': 0.07262847448388736, 'MRR@10': 0.05179873978098234, 'Recall*@10': 0.1422129049897194, 'NDCG*@10': 0.07262847448388736, 'MRR*@10': 0.05179873978098234}
INFO    [11-27 01:08:59] train in BasicTrainer:
duration: 5.29489803314209s
INFO    [11-27 01:08:59] train in BasicTrainer:
epoch: 35
INFO    [11-27 01:09:02] _train_one_epoch in BasicTrainer:
loss = 4.267729425430298
INFO    [11-27 01:09:04] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [11-27 01:09:04] validate in BasicTrainer:
{'Recall@10': 0.14388020584980646, 'NDCG@10': 0.0731543352206548, 'MRR@10': 0.05185409511129061, 'Recall*@10': 0.14388020584980646, 'NDCG*@10': 0.0731543352206548, 'MRR*@10': 0.05185409511129061}
INFO    [11-27 01:09:04] train in BasicTrainer:
duration: 4.742093324661255s
INFO    [11-27 01:09:04] train in BasicTrainer:
epoch: 36
INFO    [11-27 01:09:07] _train_one_epoch in BasicTrainer:
loss = 4.2508323192596436
INFO    [11-27 01:09:08] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [11-27 01:09:08] validate in BasicTrainer:
{'Recall@10': 0.14688928922017416, 'NDCG@10': 0.07387232780456543, 'MRR@10': 0.051987635592619576, 'Recall*@10': 0.14688928922017416, 'NDCG*@10': 0.07387232780456543, 'MRR*@10': 0.051987635592619576}
INFO    [11-27 01:09:08] train in BasicTrainer:
duration: 4.864216327667236s
INFO    [11-27 01:09:08] train in BasicTrainer:
epoch: 37
INFO    [11-27 01:09:12] _train_one_epoch in BasicTrainer:
loss = 4.232915658950805
INFO    [11-27 01:09:13] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [11-27 01:09:13] validate in BasicTrainer:
{'Recall@10': 0.15343940258026123, 'NDCG@10': 0.07853679607311885, 'MRR@10': 0.05607546617587408, 'Recall*@10': 0.15343940258026123, 'NDCG*@10': 0.07853679607311885, 'MRR*@10': 0.05607546617587408}
INFO    [11-27 01:09:13] train in BasicTrainer:
duration: 4.644746541976929s
INFO    [11-27 01:09:13] train in BasicTrainer:
epoch: 38
INFO    [11-27 01:09:17] _train_one_epoch in BasicTrainer:
loss = 4.219403495788574
INFO    [11-27 01:09:18] validate in BasicTrainer:
{'Recall@10': 0.14815167586008707, 'NDCG@10': 0.07610624035199483, 'MRR@10': 0.05430499340097109, 'Recall*@10': 0.14815167586008707, 'NDCG*@10': 0.07610624035199483, 'MRR*@10': 0.05430499340097109}
INFO    [11-27 01:09:18] train in BasicTrainer:
duration: 4.634464502334595s
INFO    [11-27 01:09:18] train in BasicTrainer:
epoch: 39
DEBUG   [11-27 01:09:21] calculate_loss in loss:
soft_target max: 0.5027085542678833, argmax 887447
DEBUG   [11-27 01:09:21] calculate_loss in loss:
pred max in softmax: 0.1045696809887886, argmax 1690774
INFO    [11-27 01:09:21] _train_one_epoch in BasicTrainer:
loss = 4.203584880828857
INFO    [11-27 01:09:23] validate in BasicTrainer:
{'Recall@10': 0.14782615502675375, 'NDCG@10': 0.0766600991288821, 'MRR@10': 0.055119012792905174, 'Recall*@10': 0.14782615502675375, 'NDCG*@10': 0.0766600991288821, 'MRR*@10': 0.055119012792905174}
INFO    [11-27 01:09:23] train in BasicTrainer:
duration: 4.818179130554199s
INFO    [11-27 01:09:23] train in BasicTrainer:
epoch: 40
DEBUG   [11-27 01:09:23] calculate_loss in loss:
soft_target max: 0.5027085542678833, argmax 238281
DEBUG   [11-27 01:09:23] calculate_loss in loss:
pred max in softmax: 0.0997515544295311, argmax 601573
INFO    [11-27 01:09:26] _train_one_epoch in BasicTrainer:
loss = 4.185396137237549
INFO    [11-27 01:09:28] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [11-27 01:09:28] validate in BasicTrainer:
{'Recall@10': 0.15445566177368164, 'NDCG@10': 0.08127552767594655, 'MRR@10': 0.05911358570059141, 'Recall*@10': 0.15445566177368164, 'NDCG*@10': 0.08127552767594655, 'MRR*@10': 0.05911358570059141}
INFO    [11-27 01:09:28] train in BasicTrainer:
duration: 5.158688068389893s
INFO    [11-27 01:09:28] train in BasicTrainer:
epoch: 41
INFO    [11-27 01:09:31] _train_one_epoch in BasicTrainer:
loss = 4.170918264389038
INFO    [11-27 01:09:32] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [11-27 01:09:33] validate in BasicTrainer:
{'Recall@10': 0.1567740092674891, 'NDCG@10': 0.08146602163712184, 'MRR@10': 0.058761650075515114, 'Recall*@10': 0.1567740092674891, 'NDCG*@10': 0.08146602163712184, 'MRR*@10': 0.058761650075515114}
INFO    [11-27 01:09:33] train in BasicTrainer:
duration: 4.792186975479126s
INFO    [11-27 01:09:33] train in BasicTrainer:
epoch: 42
INFO    [11-27 01:09:36] _train_one_epoch in BasicTrainer:
loss = 4.156392650604248
INFO    [11-27 01:09:37] validate in BasicTrainer:
{'Recall@10': 0.1531138817469279, 'NDCG@10': 0.08102747301260631, 'MRR@10': 0.05925240864356359, 'Recall*@10': 0.1531138817469279, 'NDCG*@10': 0.08102747301260631, 'MRR*@10': 0.05925240864356359}
INFO    [11-27 01:09:37] train in BasicTrainer:
duration: 4.549604177474976s
INFO    [11-27 01:09:37] train in BasicTrainer:
epoch: 43
INFO    [11-27 01:09:40] _train_one_epoch in BasicTrainer:
loss = 4.141496362686158
INFO    [11-27 01:09:42] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [11-27 01:09:42] validate in BasicTrainer:
{'Recall@10': 0.1521373192469279, 'NDCG@10': 0.08234856526056926, 'MRR@10': 0.06122796858350436, 'Recall*@10': 0.1521373192469279, 'NDCG*@10': 0.08234856526056926, 'MRR*@10': 0.06122796858350436}
INFO    [11-27 01:09:42] train in BasicTrainer:
duration: 4.738689661026001s
INFO    [11-27 01:09:42] train in BasicTrainer:
epoch: 44
INFO    [11-27 01:09:45] _train_one_epoch in BasicTrainer:
loss = 4.1284694480896
INFO    [11-27 01:09:46] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [11-27 01:09:47] validate in BasicTrainer:
{'Recall@10': 0.15779026846090952, 'NDCG@10': 0.08472242454687755, 'MRR@10': 0.06267973904808362, 'Recall*@10': 0.15779026846090952, 'NDCG*@10': 0.08472242454687755, 'MRR*@10': 0.06267973904808362}
INFO    [11-27 01:09:47] train in BasicTrainer:
duration: 4.727257966995239s
INFO    [11-27 01:09:47] train in BasicTrainer:
epoch: 45
INFO    [11-27 01:09:50] _train_one_epoch in BasicTrainer:
loss = 4.1117082118988035
INFO    [11-27 01:09:51] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [11-27 01:09:51] validate in BasicTrainer:
{'Recall@10': 0.1621411293745041, 'NDCG@10': 0.08691398799419403, 'MRR@10': 0.0641613466044267, 'Recall*@10': 0.1621411293745041, 'NDCG*@10': 0.08691398799419403, 'MRR*@10': 0.0641613466044267}
INFO    [11-27 01:09:51] train in BasicTrainer:
duration: 4.646881103515625s
INFO    [11-27 01:09:51] train in BasicTrainer:
epoch: 46
INFO    [11-27 01:09:55] _train_one_epoch in BasicTrainer:
loss = 4.093800959587097
INFO    [11-27 01:09:56] validate in BasicTrainer:
{'Recall@10': 0.15543222427368164, 'NDCG@10': 0.08365743855635326, 'MRR@10': 0.06181008989612261, 'Recall*@10': 0.15543222427368164, 'NDCG*@10': 0.08365743855635326, 'MRR*@10': 0.06181008989612261}
INFO    [11-27 01:09:56] train in BasicTrainer:
duration: 4.659606695175171s
INFO    [11-27 01:09:56] train in BasicTrainer:
epoch: 47
INFO    [11-27 01:09:59] _train_one_epoch in BasicTrainer:
loss = 4.086801357269287
INFO    [11-27 01:10:00] validate in BasicTrainer:
{'Recall@10': 0.15815548598766327, 'NDCG@10': 0.08667247245709102, 'MRR@10': 0.06501117100318272, 'Recall*@10': 0.15815548598766327, 'NDCG*@10': 0.08667247245709102, 'MRR*@10': 0.06501117100318272}
INFO    [11-27 01:10:00] train in BasicTrainer:
duration: 4.616570472717285s
INFO    [11-27 01:10:00] train in BasicTrainer:
epoch: 48
INFO    [11-27 01:10:04] _train_one_epoch in BasicTrainer:
loss = 4.073198962211609
INFO    [11-27 01:10:06] validate in BasicTrainer:
{'Recall@10': 0.15717892348766327, 'NDCG@10': 0.08552467823028564, 'MRR@10': 0.06368789821863174, 'Recall*@10': 0.15717892348766327, 'NDCG*@10': 0.08552467823028564, 'MRR*@10': 0.06368789821863174}
INFO    [11-27 01:10:06] train in BasicTrainer:
duration: 5.101729869842529s
INFO    [11-27 01:10:06] train in BasicTrainer:
epoch: 49
INFO    [11-27 01:10:09] _train_one_epoch in BasicTrainer:
loss = 4.056496753692627
INFO    [11-27 01:10:10] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [11-27 01:10:10] validate in BasicTrainer:
{'Recall@10': 0.16438007851441702, 'NDCG@10': 0.08875805139541626, 'MRR@10': 0.06565187871456146, 'Recall*@10': 0.16438007851441702, 'NDCG*@10': 0.08875805139541626, 'MRR*@10': 0.06565187871456146}
INFO    [11-27 01:10:10] train in BasicTrainer:
duration: 4.767434597015381s
INFO    [11-27 01:10:10] train in BasicTrainer:
epoch: 50
INFO    [11-27 01:10:14] _train_one_epoch in BasicTrainer:
loss = 4.043799600601196
INFO    [11-27 01:10:15] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [11-27 01:10:15] validate in BasicTrainer:
{'Recall@10': 0.16376873354117075, 'NDCG@10': 0.09089987973372142, 'MRR@10': 0.06879796087741852, 'Recall*@10': 0.16376873354117075, 'NDCG*@10': 0.09089987973372142, 'MRR*@10': 0.06879796087741852}
INFO    [11-27 01:10:15] train in BasicTrainer:
duration: 4.767579078674316s
INFO    [11-27 01:10:15] train in BasicTrainer:
epoch: 51
INFO    [11-27 01:10:19] _train_one_epoch in BasicTrainer:
loss = 4.03104983329773
INFO    [11-27 01:10:20] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [11-27 01:10:20] validate in BasicTrainer:
{'Recall@10': 0.1647849977016449, 'NDCG@10': 0.09148418654998143, 'MRR@10': 0.06916593263546626, 'Recall*@10': 0.1647849977016449, 'NDCG*@10': 0.09148418654998143, 'MRR*@10': 0.06916593263546626}
INFO    [11-27 01:10:20] train in BasicTrainer:
duration: 5.0003180503845215s
INFO    [11-27 01:10:20] train in BasicTrainer:
epoch: 52
INFO    [11-27 01:10:24] _train_one_epoch in BasicTrainer:
loss = 4.017536988258362
INFO    [11-27 01:10:25] validate in BasicTrainer:
{'Recall@10': 0.1638084352016449, 'NDCG@10': 0.08979896952708562, 'MRR@10': 0.06741891553004582, 'Recall*@10': 0.1638084352016449, 'NDCG*@10': 0.08979896952708562, 'MRR*@10': 0.06741891553004582}
INFO    [11-27 01:10:25] train in BasicTrainer:
duration: 5.0039472579956055s
INFO    [11-27 01:10:25] train in BasicTrainer:
epoch: 53
INFO    [11-27 01:10:29] _train_one_epoch in BasicTrainer:
loss = 4.003664541244507
INFO    [11-27 01:10:30] validate in BasicTrainer:
{'Recall@10': 0.1631176918745041, 'NDCG@10': 0.09146184474229813, 'MRR@10': 0.06951941053072612, 'Recall*@10': 0.1631176918745041, 'NDCG*@10': 0.09146184474229813, 'MRR*@10': 0.06951941053072612}
INFO    [11-27 01:10:30] train in BasicTrainer:
duration: 4.80423903465271s
INFO    [11-27 01:10:30] train in BasicTrainer:
epoch: 54
INFO    [11-27 01:10:33] _train_one_epoch in BasicTrainer:
loss = 3.9927715063095093
INFO    [11-27 01:10:35] validate in BasicTrainer:
{'Recall@10': 0.16742886106173197, 'NDCG@10': 0.09035554776589076, 'MRR@10': 0.06706559658050537, 'Recall*@10': 0.16742886106173197, 'NDCG*@10': 0.09035554776589076, 'MRR*@10': 0.06706559658050537}
INFO    [11-27 01:10:35] train in BasicTrainer:
duration: 4.713071584701538s
INFO    [11-27 01:10:35] train in BasicTrainer:
epoch: 55
INFO    [11-27 01:10:38] _train_one_epoch in BasicTrainer:
loss = 3.9808175659179685
INFO    [11-27 01:10:40] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [11-27 01:10:40] validate in BasicTrainer:
{'Recall@10': 0.16637290020783743, 'NDCG@10': 0.09345449507236481, 'MRR@10': 0.07134438802798589, 'Recall*@10': 0.16637290020783743, 'NDCG*@10': 0.09345449507236481, 'MRR*@10': 0.07134438802798589}
INFO    [11-27 01:10:40] train in BasicTrainer:
duration: 5.047793626785278s
INFO    [11-27 01:10:40] train in BasicTrainer:
epoch: 56
INFO    [11-27 01:10:43] _train_one_epoch in BasicTrainer:
loss = 3.970606083869934
INFO    [11-27 01:10:44] validate in BasicTrainer:
{'Recall@10': 0.16848481694857279, 'NDCG@10': 0.09095916400353114, 'MRR@10': 0.06757952893773715, 'Recall*@10': 0.16848481694857279, 'NDCG*@10': 0.09095916400353114, 'MRR*@10': 0.06757952893773715}
INFO    [11-27 01:10:44] train in BasicTrainer:
duration: 4.601076126098633s
INFO    [11-27 01:10:44] train in BasicTrainer:
epoch: 57
INFO    [11-27 01:10:48] _train_one_epoch in BasicTrainer:
loss = 3.9577756547927856
INFO    [11-27 01:10:49] validate in BasicTrainer:
{'Recall@10': 0.16848481694857279, 'NDCG@10': 0.09267303844292958, 'MRR@10': 0.06979412337144215, 'Recall*@10': 0.16848481694857279, 'NDCG*@10': 0.09267303844292958, 'MRR*@10': 0.06979412337144215}
INFO    [11-27 01:10:49] train in BasicTrainer:
duration: 4.565572023391724s
INFO    [11-27 01:10:49] train in BasicTrainer:
epoch: 58
INFO    [11-27 01:10:52] _train_one_epoch in BasicTrainer:
loss = 3.9474800395965577
INFO    [11-27 01:10:54] validate in BasicTrainer:
{'Recall@10': 0.16470559934775034, 'NDCG@10': 0.09312071651220322, 'MRR@10': 0.07127960522969563, 'Recall*@10': 0.16470559934775034, 'NDCG*@10': 0.09312071651220322, 'MRR*@10': 0.07127960522969563}
INFO    [11-27 01:10:54] train in BasicTrainer:
duration: 4.958480358123779s
INFO    [11-27 01:10:54] train in BasicTrainer:
epoch: 59
DEBUG   [11-27 01:10:57] calculate_loss in loss:
soft_target max: 0.5027085542678833, argmax 511806
DEBUG   [11-27 01:10:57] calculate_loss in loss:
pred max in softmax: 0.20399707555770874, argmax 1129136
INFO    [11-27 01:10:57] _train_one_epoch in BasicTrainer:
loss = 3.9363487100601198
INFO    [11-27 01:10:59] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [11-27 01:10:59] validate in BasicTrainer:
{'Recall@10': 0.17417746285597482, 'NDCG@10': 0.09459381053845088, 'MRR@10': 0.07065964490175247, 'Recall*@10': 0.17417746285597482, 'NDCG*@10': 0.09459381053845088, 'MRR*@10': 0.07065964490175247}
INFO    [11-27 01:10:59] train in BasicTrainer:
duration: 4.990477561950684s
INFO    [11-27 01:10:59] train in BasicTrainer:
epoch: 60
DEBUG   [11-27 01:10:59] calculate_loss in loss:
soft_target max: 0.5027085542678833, argmax 785331
DEBUG   [11-27 01:10:59] calculate_loss in loss:
pred max in softmax: 0.24188660085201263, argmax 834869
INFO    [11-27 01:11:02] _train_one_epoch in BasicTrainer:
loss = 3.9239801168441772
INFO    [11-27 01:11:03] validate in BasicTrainer:
{'Recall@10': 0.16938198606173197, 'NDCG@10': 0.09421778966983159, 'MRR@10': 0.07130574683348338, 'Recall*@10': 0.16938198606173197, 'NDCG*@10': 0.09421778966983159, 'MRR*@10': 0.07130574683348338}
INFO    [11-27 01:11:03] train in BasicTrainer:
duration: 4.479005813598633s
INFO    [11-27 01:11:03] train in BasicTrainer:
epoch: 61
INFO    [11-27 01:11:07] _train_one_epoch in BasicTrainer:
loss = 3.9168850660324095
INFO    [11-27 01:11:09] validate in BasicTrainer:
{'Recall@10': 0.1631176918745041, 'NDCG@10': 0.09053791562716167, 'MRR@10': 0.06833030531803767, 'Recall*@10': 0.1631176918745041, 'NDCG*@10': 0.09053791562716167, 'MRR*@10': 0.06833030531803767}
INFO    [11-27 01:11:09] train in BasicTrainer:
duration: 5.288756370544434s
INFO    [11-27 01:11:09] train in BasicTrainer:
epoch: 62
INFO    [11-27 01:11:12] _train_one_epoch in BasicTrainer:
loss = 3.902808632850647
INFO    [11-27 01:11:13] validate in BasicTrainer:
{'Recall@10': 0.16742886106173197, 'NDCG@10': 0.09355191886425018, 'MRR@10': 0.07108474274476369, 'Recall*@10': 0.16742886106173197, 'NDCG*@10': 0.09355191886425018, 'MRR*@10': 0.07108474274476369}
INFO    [11-27 01:11:13] train in BasicTrainer:
duration: 4.565212249755859s
INFO    [11-27 01:11:13] train in BasicTrainer:
epoch: 63
INFO    [11-27 01:11:16] _train_one_epoch in BasicTrainer:
loss = 3.8920829057693482
INFO    [11-27 01:11:18] validate in BasicTrainer:
{'Recall@10': 0.16804020603497824, 'NDCG@10': 0.09371431668599446, 'MRR@10': 0.07104568680127461, 'Recall*@10': 0.16804020603497824, 'NDCG*@10': 0.09371431668599446, 'MRR*@10': 0.07104568680127461}
INFO    [11-27 01:11:18] train in BasicTrainer:
duration: 4.581144094467163s
INFO    [11-27 01:11:18] train in BasicTrainer:
epoch: 64
INFO    [11-27 01:11:21] _train_one_epoch in BasicTrainer:
loss = 3.883637099266052
INFO    [11-27 01:11:22] validate in BasicTrainer:
{'Recall@10': 0.16368934015432993, 'NDCG@10': 0.09208099295695622, 'MRR@10': 0.07008505860964458, 'Recall*@10': 0.16368934015432993, 'NDCG*@10': 0.09208099295695622, 'MRR*@10': 0.07008505860964458}
INFO    [11-27 01:11:22] train in BasicTrainer:
duration: 4.609325408935547s
INFO    [11-27 01:11:22] train in BasicTrainer:
epoch: 65
INFO    [11-27 01:11:26] _train_one_epoch in BasicTrainer:
loss = 3.870769395828247
INFO    [11-27 01:11:27] validate in BasicTrainer:
{'Recall@10': 0.16441977520783743, 'NDCG@10': 0.09309835980335872, 'MRR@10': 0.07126484314600627, 'Recall*@10': 0.16441977520783743, 'NDCG*@10': 0.09309835980335872, 'MRR*@10': 0.07126484314600627}
INFO    [11-27 01:11:27] train in BasicTrainer:
duration: 4.596421718597412s
INFO    [11-27 01:11:27] train in BasicTrainer:
epoch: 66
INFO    [11-27 01:11:30] _train_one_epoch in BasicTrainer:
loss = 3.8652106857299806
INFO    [11-27 01:11:32] validate in BasicTrainer:
{'Recall@10': 0.16698424518108368, 'NDCG@10': 0.09433934837579727, 'MRR@10': 0.072071373462677, 'Recall*@10': 0.16698424518108368, 'NDCG*@10': 0.09433934837579727, 'MRR*@10': 0.072071373462677}
INFO    [11-27 01:11:32] train in BasicTrainer:
duration: 4.593701362609863s
INFO    [11-27 01:11:32] train in BasicTrainer:
epoch: 67
INFO    [11-27 01:11:35] _train_one_epoch in BasicTrainer:
loss = 3.856753416061401
INFO    [11-27 01:11:36] validate in BasicTrainer:
{'Recall@10': 0.1657615602016449, 'NDCG@10': 0.09405027329921722, 'MRR@10': 0.07214842736721039, 'Recall*@10': 0.1657615602016449, 'NDCG*@10': 0.09405027329921722, 'MRR*@10': 0.07214842736721039}
INFO    [11-27 01:11:36] train in BasicTrainer:
duration: 4.825132608413696s
INFO    [11-27 01:11:36] train in BasicTrainer:
epoch: 68
INFO    [11-27 01:11:40] _train_one_epoch in BasicTrainer:
loss = 3.844658236503601
INFO    [11-27 01:11:41] log in loggers:
Update Best NDCG@10 Model at 68
INFO    [11-27 01:11:41] validate in BasicTrainer:
{'Recall@10': 0.1695010761419932, 'NDCG@10': 0.095619002978007, 'MRR@10': 0.07310123989979427, 'Recall*@10': 0.1695010761419932, 'NDCG*@10': 0.095619002978007, 'MRR*@10': 0.07310123989979427}
INFO    [11-27 01:11:41] train in BasicTrainer:
duration: 5.1321470737457275s
INFO    [11-27 01:11:41] train in BasicTrainer:
epoch: 69
INFO    [11-27 01:11:45] _train_one_epoch in BasicTrainer:
loss = 3.8364110136032106
INFO    [11-27 01:11:46] log in loggers:
Update Best NDCG@10 Model at 69
INFO    [11-27 01:11:46] validate in BasicTrainer:
{'Recall@10': 0.16909616192181906, 'NDCG@10': 0.09576410800218582, 'MRR@10': 0.07335752248764038, 'Recall*@10': 0.16909616192181906, 'NDCG*@10': 0.09576410800218582, 'MRR*@10': 0.07335752248764038}
INFO    [11-27 01:11:46] train in BasicTrainer:
duration: 4.666194200515747s
INFO    [11-27 01:11:46] train in BasicTrainer:
epoch: 70
INFO    [11-27 01:11:50] _train_one_epoch in BasicTrainer:
loss = 3.8270494174957275
INFO    [11-27 01:11:51] log in loggers:
Update Best NDCG@10 Model at 70
INFO    [11-27 01:11:51] validate in BasicTrainer:
{'Recall@10': 0.16832602520783743, 'NDCG@10': 0.09767866631348927, 'MRR@10': 0.07611492276191711, 'Recall*@10': 0.16832602520783743, 'NDCG*@10': 0.09767866631348927, 'MRR*@10': 0.07611492276191711}
INFO    [11-27 01:11:51] train in BasicTrainer:
duration: 5.136514186859131s
INFO    [11-27 01:11:51] train in BasicTrainer:
epoch: 71
INFO    [11-27 01:11:55] _train_one_epoch in BasicTrainer:
loss = 3.8167685365676878
INFO    [11-27 01:11:56] validate in BasicTrainer:
{'Recall@10': 0.1706840693950653, 'NDCG@10': 0.0971596563855807, 'MRR@10': 0.0746657798687617, 'Recall*@10': 0.1706840693950653, 'NDCG*@10': 0.0971596563855807, 'MRR*@10': 0.0746657798687617}
INFO    [11-27 01:11:56] train in BasicTrainer:
duration: 4.73577356338501s
INFO    [11-27 01:11:56] train in BasicTrainer:
epoch: 72
INFO    [11-27 01:11:59] _train_one_epoch in BasicTrainer:
loss = 3.8081737422943114
INFO    [11-27 01:12:01] validate in BasicTrainer:
{'Recall@10': 0.17108898361523947, 'NDCG@10': 0.09679915010929108, 'MRR@10': 0.0740897407134374, 'Recall*@10': 0.17108898361523947, 'NDCG*@10': 0.09679915010929108, 'MRR*@10': 0.0740897407134374}
INFO    [11-27 01:12:01] train in BasicTrainer:
duration: 4.760811805725098s
INFO    [11-27 01:12:01] train in BasicTrainer:
epoch: 73
INFO    [11-27 01:12:04] _train_one_epoch in BasicTrainer:
loss = 3.8044429445266723
INFO    [11-27 01:12:05] validate in BasicTrainer:
{'Recall@10': 0.16942168275515238, 'NDCG@10': 0.09562298903862636, 'MRR@10': 0.07298991084098816, 'Recall*@10': 0.16942168275515238, 'NDCG*@10': 0.09562298903862636, 'MRR*@10': 0.07298991084098816}
INFO    [11-27 01:12:05] train in BasicTrainer:
duration: 4.457475185394287s
INFO    [11-27 01:12:05] train in BasicTrainer:
epoch: 74
INFO    [11-27 01:12:09] _train_one_epoch in BasicTrainer:
loss = 3.7921194648742675
INFO    [11-27 01:12:10] validate in BasicTrainer:
{'Recall@10': 0.17235137025515238, 'NDCG@10': 0.09718276063601176, 'MRR@10': 0.07420395314693451, 'Recall*@10': 0.17235137025515238, 'NDCG*@10': 0.09718276063601176, 'MRR*@10': 0.07420395314693451}
INFO    [11-27 01:12:10] train in BasicTrainer:
duration: 4.433893203735352s
INFO    [11-27 01:12:10] train in BasicTrainer:
epoch: 75
INFO    [11-27 01:12:13] _train_one_epoch in BasicTrainer:
loss = 3.784215474128723
INFO    [11-27 01:12:15] validate in BasicTrainer:
{'Recall@10': 0.16905646522839865, 'NDCG@10': 0.09592086325089137, 'MRR@10': 0.07351533323526382, 'Recall*@10': 0.16905646522839865, 'NDCG*@10': 0.09592086325089137, 'MRR*@10': 0.07351533323526382}
INFO    [11-27 01:12:15] train in BasicTrainer:
duration: 5.068574666976929s
INFO    [11-27 01:12:15] train in BasicTrainer:
epoch: 76
INFO    [11-27 01:12:18] _train_one_epoch in BasicTrainer:
loss = 3.7746265506744385
INFO    [11-27 01:12:19] validate in BasicTrainer:
{'Recall@10': 0.17060467104117075, 'NDCG@10': 0.09671010325352351, 'MRR@10': 0.07419608285029729, 'Recall*@10': 0.17060467104117075, 'NDCG*@10': 0.09671010325352351, 'MRR*@10': 0.07419608285029729}
INFO    [11-27 01:12:19] train in BasicTrainer:
duration: 4.28885555267334s
INFO    [11-27 01:12:19] train in BasicTrainer:
epoch: 77
INFO    [11-27 01:12:22] _train_one_epoch in BasicTrainer:
loss = 3.76837646484375
INFO    [11-27 01:12:24] log in loggers:
Update Best NDCG@10 Model at 77
INFO    [11-27 01:12:24] validate in BasicTrainer:
{'Recall@10': 0.1714938978354136, 'NDCG@10': 0.09825699279705684, 'MRR@10': 0.07595701764027278, 'Recall*@10': 0.1714938978354136, 'NDCG*@10': 0.09825699279705684, 'MRR*@10': 0.07595701764027278}
INFO    [11-27 01:12:24] train in BasicTrainer:
duration: 4.741601943969727s
INFO    [11-27 01:12:24] train in BasicTrainer:
epoch: 78
INFO    [11-27 01:12:27] _train_one_epoch in BasicTrainer:
loss = 3.7612015628814697
INFO    [11-27 01:12:29] validate in BasicTrainer:
{'Recall@10': 0.1706443727016449, 'NDCG@10': 0.09693295260270436, 'MRR@10': 0.07449578990538915, 'Recall*@10': 0.1706443727016449, 'NDCG*@10': 0.09693295260270436, 'MRR*@10': 0.07449578990538915}
INFO    [11-27 01:12:29] train in BasicTrainer:
duration: 5.022029638290405s
INFO    [11-27 01:12:29] train in BasicTrainer:
epoch: 79
DEBUG   [11-27 01:12:32] calculate_loss in loss:
soft_target max: 0.5027085542678833, argmax 307574
DEBUG   [11-27 01:12:32] calculate_loss in loss:
pred max in softmax: 0.32881027460098267, argmax 759909
INFO    [11-27 01:12:32] _train_one_epoch in BasicTrainer:
loss = 3.7539156913757323
INFO    [11-27 01:12:34] log in loggers:
Update Best NDCG@10 Model at 79
INFO    [11-27 01:12:34] validate in BasicTrainer:
{'Recall@10': 0.17698805530865988, 'NDCG@10': 0.09858952462673187, 'MRR@10': 0.07478809853394826, 'Recall*@10': 0.17698805530865988, 'NDCG*@10': 0.09858952462673187, 'MRR*@10': 0.07478809853394826}
INFO    [11-27 01:12:34] train in BasicTrainer:
duration: 4.956599235534668s
INFO    [11-27 01:12:34] close_training in BasicTrainer:
finished training
DEBUG   [11-27 01:12:34] debug_summary in loss:
loss nan summary: nan 0 times, not nan 4001 times, ratio nan / (nan + not_nan) = 0.0
INFO    [11-27 01:12:34] run_routine in Routine:
Finished training, Start final validation
INFO    [11-27 01:12:34] final_validate in BasicTrainer:
validate model on val set!
INFO    [11-27 01:12:34] load_state_from_given_path in utils:
checkpoint epoch: 79
INFO    [11-27 01:12:34] load_state_from_given_path in utils:
Loading model's parameters
INFO    [11-27 01:12:35] validate in BasicTrainer:
{'Recall@10': 0.17698805530865988, 'NDCG@10': 0.09858952462673187, 'MRR@10': 0.07478809853394826, 'Recall*@10': 0.17698805530865988, 'NDCG*@10': 0.09858952462673187, 'MRR*@10': 0.07478809853394826}
INFO    [11-27 01:12:35] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.17698805530865988, 'NDCG@10': 0.09858952462673187, 'MRR@10': 0.07478809853394826, 'Recall*@10': 0.17698805530865988, 'NDCG*@10': 0.09858952462673187, 'MRR*@10': 0.07478809853394826}
INFO    [11-27 01:12:35] _evaluate in DistillSched:
Start testing student model on test set
INFO    [11-27 01:12:35] test in BasicTrainer:
Test model on test set!
INFO    [11-27 01:12:35] test_with_given_state_path in BasicTrainer:
Loading model params from _____lfms_soft_len_2/soft_gru4rec-len-30_11-27_01-05_t5/student_gru4rec_logs/checkpoint/best_acc_model.pth.
INFO    [11-27 01:12:35] load_state_from_given_path in utils:
checkpoint epoch: 79
INFO    [11-27 01:12:35] load_state_from_given_path in utils:
Loading model's parameters
INFO    [11-27 01:12:35] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [11-27 01:12:36] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.15526549518108368, 'NDCG@10': 0.089155246814092, 'MRR@10': 0.06904736161231995, 'Recall*@10': 0.15526549518108368, 'NDCG*@10': 0.089155246814092, 'MRR*@10': 0.06904736161231995}
INFO    [11-27 01:12:36] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.15526549518108368, 'NDCG@10': 0.089155246814092, 'MRR@10': 0.06904736161231995, 'Recall*@10': 0.15526549518108368, 'NDCG*@10': 0.089155246814092, 'MRR*@10': 0.06904736161231995}
