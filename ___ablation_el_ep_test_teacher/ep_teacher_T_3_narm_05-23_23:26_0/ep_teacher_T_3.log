INFO    [05-23 23:26:10] setup_train in utils:
{
    "experiment_dir": "___ablation_el_ep_test_teacher",
    "experiment_description": "ep_teacher_T_3",
    "dataset_name": "electronics.csv",
    "sched": "ensemble",
    "model_code": "narm",
    "mentor_code": "narm",
    "mentor2_code": "narm",
    "softmaxed_mentor": true,
    "T": 3,
    "weight_list": [
        1,
        1
    ],
    "training_routine": "finished",
    "enable_auto_path_finder": false,
    "num_epochs": 0,
    "mode": "test",
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": "___el_base_partial_2022/base_narm-rate-0.8-seed-2000_05-05_12:50_t2/narm_logs/checkpoint/best_acc_model.pth",
    "mentor2_state_path": "___el_base_partial_2022/base_narm-rate-0.8-seed-2001_05-05_15:33_0/narm_logs/checkpoint/best_acc_model.pth",
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "do_remap": false,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.electronics/narm/config_test.json",
    "task_id": -1,
    "describe": null,
    "split": "leave_one_out",
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "alpha": 0.1,
    "dvae_alpha": 0.5,
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
INFO    [05-23 23:26:10] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/electronics-5-5.pkl
INFO    [05-23 23:26:12] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-23 23:26:12] _check_dataset_cache in utils:
correct.
INFO    [05-23 23:26:12] __init__ in NextItemDataloader:
there are 29351 items in this dataset, 102187 users, padding_first? False
DEBUG   [05-23 23:26:30] generate_model in utils:
model_code_list=['narm']
INFO    [05-23 23:26:30] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-23 23:26:30] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-23 23:26:59] get_exist_path in utils:
dir ___ablation_el_ep_test_teacher/ep_teacher_T_3_narm_05-23_23:26_0/teacher1_narm_logs does not exist! Create one.
WARNING [05-23 23:26:59] get_exist_path in utils:
dir ___ablation_el_ep_test_teacher/ep_teacher_T_3_narm_05-23_23:26_0/teacher1_narm_logs/tb_vis does not exist! Create one.
WARNING [05-23 23:26:59] get_exist_path in utils:
dir ___ablation_el_ep_test_teacher/ep_teacher_T_3_narm_05-23_23:26_0/teacher1_narm_logs/checkpoint does not exist! Create one.
INFO    [05-23 23:27:00] load_state_from_given_path in utils:
checkpoint epoch: 78
INFO    [05-23 23:27:00] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-23 23:27:00] load_state_from_given_path in utils:
Loading optimizer's parameters
DEBUG   [05-23 23:27:00] _generate_teacher_trainer in EnsembleSched:
teacher1_narm: 
NARM(
  (item_embedding): Embedding(29352, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-23 23:27:00] assert_model_device in utils:
model teacher1_narm has 7.63525390625 MB params.
INFO    [05-23 23:27:00] __init__ in BasicTrainer:
454656 iter per epoch
DEBUG   [05-23 23:27:00] generate_model in utils:
model_code_list=['narm']
INFO    [05-23 23:27:00] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-23 23:27:00] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-23 23:27:06] get_exist_path in utils:
dir ___ablation_el_ep_test_teacher/ep_teacher_T_3_narm_05-23_23:26_0/teacher2_narm_logs does not exist! Create one.
WARNING [05-23 23:27:06] get_exist_path in utils:
dir ___ablation_el_ep_test_teacher/ep_teacher_T_3_narm_05-23_23:26_0/teacher2_narm_logs/tb_vis does not exist! Create one.
WARNING [05-23 23:27:06] get_exist_path in utils:
dir ___ablation_el_ep_test_teacher/ep_teacher_T_3_narm_05-23_23:26_0/teacher2_narm_logs/checkpoint does not exist! Create one.
INFO    [05-23 23:27:06] load_state_from_given_path in utils:
checkpoint epoch: 78
INFO    [05-23 23:27:06] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-23 23:27:06] load_state_from_given_path in utils:
Loading optimizer's parameters
DEBUG   [05-23 23:27:06] _generate_teacher_trainer in EnsembleSched:
teacher2_narm: 
NARM(
  (item_embedding): Embedding(29352, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-23 23:27:06] assert_model_device in utils:
model teacher2_narm has 7.63525390625 MB params.
INFO    [05-23 23:27:06] __init__ in BasicTrainer:
454656 iter per epoch
INFO    [05-23 23:27:06] assert_model_device in utils:
model ensemble_model has 0.0 MB params.
INFO    [05-23 23:27:06] assert_model_device in utils:
model ensemble_model has no param
INFO    [05-23 23:27:06] _set_current_routine in Routine:
first routine: finished
INFO    [05-23 23:27:06] _evaluate in EnsembleSched:
Start testing ensemble model on test set
INFO    [05-23 23:27:06] test in tester:
Finished loading. Start testing.
DEBUG   [05-23 23:27:07] forward in Ensembler:
raw predict
DEBUG   [05-23 23:27:07] forward in Ensembler:
[tensor([[3.4382e-08, 5.2122e-06, 2.8146e-05,  ..., 3.6962e-07, 1.8516e-06,
         1.2093e-04],
        [5.2436e-08, 3.5057e-07, 9.4290e-06,  ..., 6.8690e-07, 7.3371e-05,
         1.4610e-06],
        [9.4050e-07, 2.1175e-06, 1.8353e-05,  ..., 1.1701e-05, 1.0373e-04,
         7.4306e-06],
        ...,
        [1.7403e-07, 7.9523e-06, 2.0014e-05,  ..., 2.4777e-06, 2.0249e-05,
         6.3466e-05],
        [1.5505e-07, 3.6445e-06, 2.3041e-05,  ..., 1.1945e-06, 4.8857e-05,
         2.6135e-05],
        [3.6851e-07, 1.5950e-06, 2.7259e-05,  ..., 1.0995e-05, 2.3836e-05,
         3.7568e-05]], device='cuda:0'), tensor([[1.3875e-07, 1.7947e-06, 1.5111e-05,  ..., 1.3336e-07, 7.6505e-06,
         1.6788e-05],
        [1.1278e-07, 3.7632e-06, 5.0773e-06,  ..., 1.7696e-06, 2.1870e-06,
         4.9807e-06],
        [1.2194e-07, 1.7485e-06, 1.3679e-06,  ..., 2.2804e-06, 8.2659e-05,
         1.5794e-06],
        ...,
        [1.3735e-07, 1.7556e-05, 1.1354e-05,  ..., 2.6810e-06, 1.2442e-05,
         3.7224e-05],
        [4.8528e-07, 1.3268e-05, 2.8756e-05,  ..., 2.9823e-07, 3.9148e-05,
         6.8293e-05],
        [2.4059e-07, 1.0222e-05, 1.7663e-05,  ..., 2.3282e-05, 1.4455e-05,
         7.8555e-05]], device='cuda:0')]
DEBUG   [05-23 23:27:07] forward in Ensembler:
raw confidence
DEBUG   [05-23 23:27:07] forward in Ensembler:
[tensor([0.0018, 0.0055, 0.0005,  ..., 0.0008, 0.0009, 0.0010], device='cuda:0'), tensor([0.0014, 0.0037, 0.0014,  ..., 0.0006, 0.0010, 0.0006], device='cuda:0')]
DEBUG   [05-23 23:27:07] forward in Ensembler:
weighted predict
DEBUG   [05-23 23:27:07] forward in Ensembler:
[tensor([[3.4382e-08, 5.2122e-06, 2.8146e-05,  ..., 3.6962e-07, 1.8516e-06,
         1.2093e-04],
        [5.2436e-08, 3.5057e-07, 9.4290e-06,  ..., 6.8690e-07, 7.3371e-05,
         1.4610e-06],
        [9.4050e-07, 2.1175e-06, 1.8353e-05,  ..., 1.1701e-05, 1.0373e-04,
         7.4306e-06],
        ...,
        [1.7403e-07, 7.9523e-06, 2.0014e-05,  ..., 2.4777e-06, 2.0249e-05,
         6.3466e-05],
        [1.5505e-07, 3.6445e-06, 2.3041e-05,  ..., 1.1945e-06, 4.8857e-05,
         2.6135e-05],
        [3.6851e-07, 1.5950e-06, 2.7259e-05,  ..., 1.0995e-05, 2.3836e-05,
         3.7568e-05]], device='cuda:0'), tensor([[1.3875e-07, 1.7947e-06, 1.5111e-05,  ..., 1.3336e-07, 7.6505e-06,
         1.6788e-05],
        [1.1278e-07, 3.7632e-06, 5.0773e-06,  ..., 1.7696e-06, 2.1870e-06,
         4.9807e-06],
        [1.2194e-07, 1.7485e-06, 1.3679e-06,  ..., 2.2804e-06, 8.2659e-05,
         1.5794e-06],
        ...,
        [1.3735e-07, 1.7556e-05, 1.1354e-05,  ..., 2.6810e-06, 1.2442e-05,
         3.7224e-05],
        [4.8528e-07, 1.3268e-05, 2.8756e-05,  ..., 2.9823e-07, 3.9148e-05,
         6.8293e-05],
        [2.4059e-07, 1.0222e-05, 1.7663e-05,  ..., 2.3282e-05, 1.4455e-05,
         7.8555e-05]], device='cuda:0')]
DEBUG   [05-23 23:27:07] forward in Ensembler:
final predict
DEBUG   [05-23 23:27:07] forward in Ensembler:
tensor([[8.6564e-08, 3.5035e-06, 2.1629e-05,  ..., 2.5149e-07, 4.7510e-06,
         6.8857e-05],
        [8.2606e-08, 2.0569e-06, 7.2532e-06,  ..., 1.2282e-06, 3.7779e-05,
         3.2209e-06],
        [5.3122e-07, 1.9330e-06, 9.8607e-06,  ..., 6.9905e-06, 9.3196e-05,
         4.5050e-06],
        ...,
        [1.5569e-07, 1.2754e-05, 1.5684e-05,  ..., 2.5793e-06, 1.6346e-05,
         5.0345e-05],
        [3.2016e-07, 8.4563e-06, 2.5899e-05,  ..., 7.4639e-07, 4.4003e-05,
         4.7214e-05],
        [3.0455e-07, 5.9087e-06, 2.2461e-05,  ..., 1.7138e-05, 1.9145e-05,
         5.8062e-05]], device='cuda:0')
DEBUG   [05-23 23:27:07] forward in Ensembler:
final confidence
DEBUG   [05-23 23:27:07] forward in Ensembler:
tensor([0.0011, 0.0029, 0.0008,  ..., 0.0005, 0.0008, 0.0007], device='cuda:0')
DEBUG   [05-23 23:27:10] forward in Ensembler:
raw predict
DEBUG   [05-23 23:27:10] forward in Ensembler:
[tensor([[2.9175e-07, 1.3024e-05, 9.1439e-06,  ..., 1.7176e-05, 2.3139e-05,
         2.5747e-05],
        [1.8549e-07, 2.2043e-06, 8.5056e-06,  ..., 6.5443e-06, 7.6610e-06,
         9.5204e-05],
        [2.9427e-08, 6.7677e-07, 2.2979e-05,  ..., 9.4954e-06, 1.0854e-05,
         1.7494e-05],
        ...,
        [4.1056e-07, 3.4888e-07, 2.5739e-06,  ..., 1.9818e-06, 6.4377e-05,
         1.4322e-05],
        [1.3805e-07, 1.0560e-06, 1.0547e-05,  ..., 1.2876e-06, 2.8451e-05,
         7.7795e-06],
        [1.1606e-06, 1.7171e-06, 8.5764e-06,  ..., 5.6507e-06, 2.1346e-05,
         1.7306e-05]], device='cuda:0'), tensor([[3.2245e-07, 2.9606e-06, 3.2089e-06,  ..., 8.8147e-06, 1.1088e-05,
         1.0667e-05],
        [9.0071e-08, 9.6089e-08, 1.3616e-05,  ..., 4.4559e-05, 3.3655e-05,
         3.9718e-05],
        [1.7346e-07, 3.2063e-06, 8.1453e-06,  ..., 2.2536e-06, 1.5508e-06,
         4.5072e-05],
        ...,
        [1.6715e-06, 3.0200e-06, 6.1820e-06,  ..., 5.9285e-06, 3.7292e-04,
         1.2105e-05],
        [4.2461e-07, 1.3040e-06, 1.0120e-05,  ..., 7.2832e-06, 3.4535e-05,
         5.2302e-05],
        [1.0903e-06, 1.0276e-05, 5.7974e-06,  ..., 1.2208e-06, 2.8103e-05,
         1.6128e-05]], device='cuda:0')]
DEBUG   [05-23 23:27:10] forward in Ensembler:
raw confidence
DEBUG   [05-23 23:27:10] forward in Ensembler:
[tensor([0.0010, 0.0010, 0.0018,  ..., 0.0014, 0.0009, 0.0011], device='cuda:0'), tensor([0.0025, 0.0030, 0.0021,  ..., 0.0008, 0.0013, 0.0010], device='cuda:0')]
DEBUG   [05-23 23:27:10] forward in Ensembler:
weighted predict
DEBUG   [05-23 23:27:10] forward in Ensembler:
[tensor([[2.9175e-07, 1.3024e-05, 9.1439e-06,  ..., 1.7176e-05, 2.3139e-05,
         2.5747e-05],
        [1.8549e-07, 2.2043e-06, 8.5056e-06,  ..., 6.5443e-06, 7.6610e-06,
         9.5204e-05],
        [2.9427e-08, 6.7677e-07, 2.2979e-05,  ..., 9.4954e-06, 1.0854e-05,
         1.7494e-05],
        ...,
        [4.1056e-07, 3.4888e-07, 2.5739e-06,  ..., 1.9818e-06, 6.4377e-05,
         1.4322e-05],
        [1.3805e-07, 1.0560e-06, 1.0547e-05,  ..., 1.2876e-06, 2.8451e-05,
         7.7795e-06],
        [1.1606e-06, 1.7171e-06, 8.5764e-06,  ..., 5.6507e-06, 2.1346e-05,
         1.7306e-05]], device='cuda:0'), tensor([[3.2245e-07, 2.9606e-06, 3.2089e-06,  ..., 8.8147e-06, 1.1088e-05,
         1.0667e-05],
        [9.0071e-08, 9.6089e-08, 1.3616e-05,  ..., 4.4559e-05, 3.3655e-05,
         3.9718e-05],
        [1.7346e-07, 3.2063e-06, 8.1453e-06,  ..., 2.2536e-06, 1.5508e-06,
         4.5072e-05],
        ...,
        [1.6715e-06, 3.0200e-06, 6.1820e-06,  ..., 5.9285e-06, 3.7292e-04,
         1.2105e-05],
        [4.2461e-07, 1.3040e-06, 1.0120e-05,  ..., 7.2832e-06, 3.4535e-05,
         5.2302e-05],
        [1.0903e-06, 1.0276e-05, 5.7974e-06,  ..., 1.2208e-06, 2.8103e-05,
         1.6128e-05]], device='cuda:0')]
DEBUG   [05-23 23:27:10] forward in Ensembler:
final predict
DEBUG   [05-23 23:27:10] forward in Ensembler:
tensor([[3.0710e-07, 7.9922e-06, 6.1764e-06,  ..., 1.2995e-05, 1.7113e-05,
         1.8207e-05],
        [1.3778e-07, 1.1502e-06, 1.1061e-05,  ..., 2.5552e-05, 2.0658e-05,
         6.7461e-05],
        [1.0144e-07, 1.9415e-06, 1.5562e-05,  ..., 5.8745e-06, 6.2025e-06,
         3.1283e-05],
        ...,
        [1.0410e-06, 1.6844e-06, 4.3779e-06,  ..., 3.9552e-06, 2.1865e-04,
         1.3214e-05],
        [2.8133e-07, 1.1800e-06, 1.0334e-05,  ..., 4.2854e-06, 3.1493e-05,
         3.0041e-05],
        [1.1254e-06, 5.9965e-06, 7.1869e-06,  ..., 3.4357e-06, 2.4725e-05,
         1.6717e-05]], device='cuda:0')
DEBUG   [05-23 23:27:10] forward in Ensembler:
final confidence
DEBUG   [05-23 23:27:10] forward in Ensembler:
tensor([0.0015, 0.0016, 0.0017,  ..., 0.0008, 0.0007, 0.0007], device='cuda:0')
DEBUG   [05-23 23:27:13] forward in Ensembler:
raw predict
DEBUG   [05-23 23:27:13] forward in Ensembler:
[tensor([[4.0481e-07, 2.0094e-06, 2.5953e-05,  ..., 1.7807e-06, 4.6221e-05,
         2.2215e-05],
        [2.3007e-06, 1.5488e-06, 2.8106e-05,  ..., 3.5057e-06, 2.3972e-05,
         4.1413e-05],
        [9.1295e-07, 1.1262e-05, 1.4109e-05,  ..., 9.0147e-05, 3.4776e-05,
         1.6661e-05],
        ...,
        [6.2540e-08, 6.4521e-08, 1.1991e-05,  ..., 1.3112e-06, 4.7097e-04,
         4.5829e-06],
        [1.2873e-06, 1.5034e-07, 4.9769e-06,  ..., 1.7200e-08, 1.8041e-04,
         1.9546e-05],
        [7.7017e-08, 4.3070e-06, 9.7075e-06,  ..., 2.5664e-06, 5.9577e-05,
         2.0229e-05]], device='cuda:0'), tensor([[2.4511e-07, 1.9372e-06, 6.9567e-06,  ..., 2.0697e-06, 1.4635e-05,
         1.7788e-06],
        [1.0782e-06, 7.9950e-06, 7.9281e-06,  ..., 1.4774e-05, 1.2984e-05,
         6.6591e-05],
        [7.6721e-07, 3.0469e-05, 3.2484e-05,  ..., 8.3531e-06, 6.1503e-06,
         1.0255e-04],
        ...,
        [2.2701e-07, 1.0879e-06, 5.0051e-06,  ..., 1.1938e-05, 6.4934e-05,
         1.8714e-05],
        [1.3508e-06, 1.8841e-07, 3.3676e-06,  ..., 2.0127e-06, 1.1591e-04,
         7.5212e-06],
        [1.7009e-07, 1.7086e-07, 2.5083e-06,  ..., 1.0445e-06, 1.2960e-04,
         3.2388e-06]], device='cuda:0')]
DEBUG   [05-23 23:27:13] forward in Ensembler:
raw confidence
DEBUG   [05-23 23:27:13] forward in Ensembler:
[tensor([0.0015, 0.0006, 0.0007,  ..., 0.0023, 0.0955, 0.0020], device='cuda:0'), tensor([0.0021, 0.0004, 0.0010,  ..., 0.0023, 0.0128, 0.0025], device='cuda:0')]
DEBUG   [05-23 23:27:13] forward in Ensembler:
weighted predict
DEBUG   [05-23 23:27:13] forward in Ensembler:
[tensor([[4.0481e-07, 2.0094e-06, 2.5953e-05,  ..., 1.7807e-06, 4.6221e-05,
         2.2215e-05],
        [2.3007e-06, 1.5488e-06, 2.8106e-05,  ..., 3.5057e-06, 2.3972e-05,
         4.1413e-05],
        [9.1295e-07, 1.1262e-05, 1.4109e-05,  ..., 9.0147e-05, 3.4776e-05,
         1.6661e-05],
        ...,
        [6.2540e-08, 6.4521e-08, 1.1991e-05,  ..., 1.3112e-06, 4.7097e-04,
         4.5829e-06],
        [1.2873e-06, 1.5034e-07, 4.9769e-06,  ..., 1.7200e-08, 1.8041e-04,
         1.9546e-05],
        [7.7017e-08, 4.3070e-06, 9.7075e-06,  ..., 2.5664e-06, 5.9577e-05,
         2.0229e-05]], device='cuda:0'), tensor([[2.4511e-07, 1.9372e-06, 6.9567e-06,  ..., 2.0697e-06, 1.4635e-05,
         1.7788e-06],
        [1.0782e-06, 7.9950e-06, 7.9281e-06,  ..., 1.4774e-05, 1.2984e-05,
         6.6591e-05],
        [7.6721e-07, 3.0469e-05, 3.2484e-05,  ..., 8.3531e-06, 6.1503e-06,
         1.0255e-04],
        ...,
        [2.2701e-07, 1.0879e-06, 5.0051e-06,  ..., 1.1938e-05, 6.4934e-05,
         1.8714e-05],
        [1.3508e-06, 1.8841e-07, 3.3676e-06,  ..., 2.0127e-06, 1.1591e-04,
         7.5212e-06],
        [1.7009e-07, 1.7086e-07, 2.5083e-06,  ..., 1.0445e-06, 1.2960e-04,
         3.2388e-06]], device='cuda:0')]
DEBUG   [05-23 23:27:13] forward in Ensembler:
final predict
DEBUG   [05-23 23:27:13] forward in Ensembler:
tensor([[3.2496e-07, 1.9733e-06, 1.6455e-05,  ..., 1.9252e-06, 3.0428e-05,
         1.1997e-05],
        [1.6894e-06, 4.7719e-06, 1.8017e-05,  ..., 9.1398e-06, 1.8478e-05,
         5.4002e-05],
        [8.4008e-07, 2.0865e-05, 2.3296e-05,  ..., 4.9250e-05, 2.0463e-05,
         5.9606e-05],
        ...,
        [1.4477e-07, 5.7619e-07, 8.4979e-06,  ..., 6.6248e-06, 2.6795e-04,
         1.1649e-05],
        [1.3191e-06, 1.6937e-07, 4.1723e-06,  ..., 1.0150e-06, 1.4816e-04,
         1.3534e-05],
        [1.2356e-07, 2.2389e-06, 6.1079e-06,  ..., 1.8055e-06, 9.4587e-05,
         1.1734e-05]], device='cuda:0')
DEBUG   [05-23 23:27:13] forward in Ensembler:
final confidence
DEBUG   [05-23 23:27:13] forward in Ensembler:
tensor([0.0013, 0.0004, 0.0006,  ..., 0.0014, 0.0541, 0.0018], device='cuda:0')
DEBUG   [05-23 23:27:15] forward in Ensembler:
raw predict
DEBUG   [05-23 23:27:15] forward in Ensembler:
[tensor([[1.6636e-07, 1.6546e-05, 1.5588e-05,  ..., 1.2869e-05, 5.9719e-05,
         1.5021e-05],
        [2.1687e-06, 3.7782e-05, 1.0592e-05,  ..., 1.3211e-06, 9.5439e-05,
         6.6525e-05],
        [1.0110e-06, 9.3397e-07, 2.1829e-05,  ..., 1.0638e-05, 3.4894e-05,
         7.1865e-05],
        ...,
        [1.8600e-07, 2.4522e-06, 2.1318e-05,  ..., 2.9944e-06, 6.1565e-06,
         3.4051e-05],
        [4.3647e-07, 2.7171e-07, 6.3671e-06,  ..., 8.2650e-07, 2.4383e-05,
         2.5688e-06],
        [1.9349e-07, 1.5442e-06, 1.0478e-05,  ..., 3.7655e-06, 8.5054e-06,
         2.0006e-05]], device='cuda:0'), tensor([[2.4187e-07, 6.0504e-06, 1.8015e-05,  ..., 2.8495e-05, 1.8887e-05,
         7.5061e-05],
        [1.0054e-06, 8.1728e-06, 1.2175e-05,  ..., 8.6809e-06, 1.0538e-04,
         1.7150e-05],
        [2.8532e-07, 8.5945e-08, 2.2477e-05,  ..., 2.3465e-05, 1.9308e-05,
         1.6605e-05],
        ...,
        [5.5646e-07, 2.6278e-05, 1.8015e-05,  ..., 3.7079e-06, 1.2216e-05,
         3.4815e-05],
        [1.0667e-06, 1.7410e-05, 8.9279e-06,  ..., 2.7381e-06, 2.7405e-05,
         1.8447e-05],
        [1.6227e-06, 1.0063e-05, 3.3528e-05,  ..., 3.5010e-05, 8.3969e-05,
         6.9551e-06]], device='cuda:0')]
DEBUG   [05-23 23:27:15] forward in Ensembler:
raw confidence
DEBUG   [05-23 23:27:15] forward in Ensembler:
[tensor([0.0010, 0.0009, 0.0009,  ..., 0.0009, 0.0017, 0.0009], device='cuda:0'), tensor([0.0005, 0.0007, 0.0010,  ..., 0.0006, 0.0010, 0.0004], device='cuda:0')]
DEBUG   [05-23 23:27:15] forward in Ensembler:
weighted predict
DEBUG   [05-23 23:27:15] forward in Ensembler:
[tensor([[1.6636e-07, 1.6546e-05, 1.5588e-05,  ..., 1.2869e-05, 5.9719e-05,
         1.5021e-05],
        [2.1687e-06, 3.7782e-05, 1.0592e-05,  ..., 1.3211e-06, 9.5439e-05,
         6.6525e-05],
        [1.0110e-06, 9.3397e-07, 2.1829e-05,  ..., 1.0638e-05, 3.4894e-05,
         7.1865e-05],
        ...,
        [1.8600e-07, 2.4522e-06, 2.1318e-05,  ..., 2.9944e-06, 6.1565e-06,
         3.4051e-05],
        [4.3647e-07, 2.7171e-07, 6.3671e-06,  ..., 8.2650e-07, 2.4383e-05,
         2.5688e-06],
        [1.9349e-07, 1.5442e-06, 1.0478e-05,  ..., 3.7655e-06, 8.5054e-06,
         2.0006e-05]], device='cuda:0'), tensor([[2.4187e-07, 6.0504e-06, 1.8015e-05,  ..., 2.8495e-05, 1.8887e-05,
         7.5061e-05],
        [1.0054e-06, 8.1728e-06, 1.2175e-05,  ..., 8.6809e-06, 1.0538e-04,
         1.7150e-05],
        [2.8532e-07, 8.5945e-08, 2.2477e-05,  ..., 2.3465e-05, 1.9308e-05,
         1.6605e-05],
        ...,
        [5.5646e-07, 2.6278e-05, 1.8015e-05,  ..., 3.7079e-06, 1.2216e-05,
         3.4815e-05],
        [1.0667e-06, 1.7410e-05, 8.9279e-06,  ..., 2.7381e-06, 2.7405e-05,
         1.8447e-05],
        [1.6227e-06, 1.0063e-05, 3.3528e-05,  ..., 3.5010e-05, 8.3969e-05,
         6.9551e-06]], device='cuda:0')]
DEBUG   [05-23 23:27:15] forward in Ensembler:
final predict
DEBUG   [05-23 23:27:15] forward in Ensembler:
tensor([[2.0412e-07, 1.1298e-05, 1.6801e-05,  ..., 2.0682e-05, 3.9303e-05,
         4.5041e-05],
        [1.5871e-06, 2.2978e-05, 1.1384e-05,  ..., 5.0010e-06, 1.0041e-04,
         4.1838e-05],
        [6.4815e-07, 5.0996e-07, 2.2153e-05,  ..., 1.7052e-05, 2.7101e-05,
         4.4235e-05],
        ...,
        [3.7123e-07, 1.4365e-05, 1.9667e-05,  ..., 3.3512e-06, 9.1862e-06,
         3.4433e-05],
        [7.5157e-07, 8.8411e-06, 7.6475e-06,  ..., 1.7823e-06, 2.5894e-05,
         1.0508e-05],
        [9.0808e-07, 5.8034e-06, 2.2003e-05,  ..., 1.9388e-05, 4.6237e-05,
         1.3481e-05]], device='cuda:0')
DEBUG   [05-23 23:27:15] forward in Ensembler:
final confidence
DEBUG   [05-23 23:27:15] forward in Ensembler:
tensor([0.0007, 0.0006, 0.0006,  ..., 0.0008, 0.0010, 0.0006], device='cuda:0')
DEBUG   [05-23 23:27:17] forward in Ensembler:
raw predict
DEBUG   [05-23 23:27:17] forward in Ensembler:
[tensor([[5.4965e-07, 1.1601e-06, 3.1576e-05,  ..., 8.4495e-06, 1.7867e-05,
         8.7414e-05],
        [3.6129e-06, 4.2912e-06, 1.5209e-05,  ..., 2.0086e-05, 8.4344e-05,
         1.3783e-05],
        [4.4528e-07, 1.8126e-06, 2.1350e-06,  ..., 5.9310e-07, 4.7851e-05,
         3.0028e-05],
        ...,
        [1.7672e-06, 7.2380e-06, 1.8041e-05,  ..., 2.2675e-06, 3.5335e-05,
         2.9456e-05],
        [5.8464e-08, 2.1270e-06, 2.5879e-05,  ..., 8.3015e-06, 4.5239e-06,
         2.0901e-05],
        [4.6103e-08, 4.4331e-06, 8.0309e-05,  ..., 1.1561e-06, 2.9804e-06,
         1.1844e-05]], device='cuda:0'), tensor([[6.3111e-07, 4.1661e-06, 1.3991e-05,  ..., 6.8863e-06, 1.1302e-05,
         2.0920e-05],
        [4.8314e-06, 8.9579e-06, 1.5960e-05,  ..., 9.2904e-06, 3.8828e-05,
         5.9314e-06],
        [2.2221e-07, 2.5111e-06, 1.0043e-05,  ..., 9.1650e-07, 1.4140e-05,
         6.1694e-06],
        ...,
        [9.9982e-07, 9.5601e-06, 1.5462e-05,  ..., 1.2007e-06, 4.8304e-05,
         9.3420e-05],
        [1.3137e-07, 1.0201e-05, 1.1254e-05,  ..., 2.9829e-05, 2.2615e-06,
         7.7884e-05],
        [1.2323e-07, 1.8637e-05, 3.3935e-05,  ..., 1.2032e-06, 3.4168e-06,
         1.0323e-04]], device='cuda:0')]
DEBUG   [05-23 23:27:18] forward in Ensembler:
raw confidence
DEBUG   [05-23 23:27:18] forward in Ensembler:
[tensor([0.0022, 0.0004, 0.0016,  ..., 0.0015, 0.0027, 0.0050], device='cuda:0'), tensor([0.0011, 0.0009, 0.0009,  ..., 0.0021, 0.0009, 0.0017], device='cuda:0')]
DEBUG   [05-23 23:27:18] forward in Ensembler:
weighted predict
DEBUG   [05-23 23:27:18] forward in Ensembler:
[tensor([[5.4965e-07, 1.1601e-06, 3.1576e-05,  ..., 8.4495e-06, 1.7867e-05,
         8.7414e-05],
        [3.6129e-06, 4.2912e-06, 1.5209e-05,  ..., 2.0086e-05, 8.4344e-05,
         1.3783e-05],
        [4.4528e-07, 1.8126e-06, 2.1350e-06,  ..., 5.9310e-07, 4.7851e-05,
         3.0028e-05],
        ...,
        [1.7672e-06, 7.2380e-06, 1.8041e-05,  ..., 2.2675e-06, 3.5335e-05,
         2.9456e-05],
        [5.8464e-08, 2.1270e-06, 2.5879e-05,  ..., 8.3015e-06, 4.5239e-06,
         2.0901e-05],
        [4.6103e-08, 4.4331e-06, 8.0309e-05,  ..., 1.1561e-06, 2.9804e-06,
         1.1844e-05]], device='cuda:0'), tensor([[6.3111e-07, 4.1661e-06, 1.3991e-05,  ..., 6.8863e-06, 1.1302e-05,
         2.0920e-05],
        [4.8314e-06, 8.9579e-06, 1.5960e-05,  ..., 9.2904e-06, 3.8828e-05,
         5.9314e-06],
        [2.2221e-07, 2.5111e-06, 1.0043e-05,  ..., 9.1650e-07, 1.4140e-05,
         6.1694e-06],
        ...,
        [9.9982e-07, 9.5601e-06, 1.5462e-05,  ..., 1.2007e-06, 4.8304e-05,
         9.3420e-05],
        [1.3137e-07, 1.0201e-05, 1.1254e-05,  ..., 2.9829e-05, 2.2615e-06,
         7.7884e-05],
        [1.2323e-07, 1.8637e-05, 3.3935e-05,  ..., 1.2032e-06, 3.4168e-06,
         1.0323e-04]], device='cuda:0')]
DEBUG   [05-23 23:27:18] forward in Ensembler:
final predict
DEBUG   [05-23 23:27:18] forward in Ensembler:
tensor([[5.9038e-07, 2.6631e-06, 2.2784e-05,  ..., 7.6679e-06, 1.4584e-05,
         5.4167e-05],
        [4.2221e-06, 6.6246e-06, 1.5584e-05,  ..., 1.4688e-05, 6.1586e-05,
         9.8573e-06],
        [3.3375e-07, 2.1619e-06, 6.0892e-06,  ..., 7.5480e-07, 3.0996e-05,
         1.8099e-05],
        ...,
        [1.3835e-06, 8.3991e-06, 1.6752e-05,  ..., 1.7341e-06, 4.1820e-05,
         6.1438e-05],
        [9.4917e-08, 6.1638e-06, 1.8567e-05,  ..., 1.9065e-05, 3.3927e-06,
         4.9392e-05],
        [8.4669e-08, 1.1535e-05, 5.7122e-05,  ..., 1.1797e-06, 3.1986e-06,
         5.7535e-05]], device='cuda:0')
DEBUG   [05-23 23:27:18] forward in Ensembler:
final confidence
DEBUG   [05-23 23:27:18] forward in Ensembler:
tensor([0.0017, 0.0005, 0.0012,  ..., 0.0018, 0.0016, 0.0030], device='cuda:0')
WARNING [05-23 23:28:09] get_exist_path in utils:
dir ___ablation_el_ep_test_teacher/ep_teacher_T_3_narm_05-23_23:26_0/ensemble_model_logs does not exist! Create one.
INFO    [05-23 23:28:09] _evaluate in EnsembleSched:
!!Final Result!!: {'Recall@10': 0.06164771720767021, 'NDCG@10': 0.03833414658904075, 'MRR@10': 0.031211747154593468, 'Recall@5': 0.04500478357076645, 'NDCG@5': 0.03296767055988312, 'MRR@5': 0.029006101861596106, 'Recall*@10': 0.06575129061937332, 'NDCG*@10': 0.04076294526457787, 'MRR*@10': 0.03312544248998165, 'Recall*@5': 0.04801308467984199, 'NDCG*@5': 0.035045683085918426, 'MRR*@5': 0.0307771535217762}
