INFO    [05-25 14:38:44] setup_train in utils:
{
    "experiment_dir": "___ablation_el_ep_test_teacher",
    "experiment_description": "new_metrics_ep_teacher_T_1",
    "dataset_name": "electronics.csv",
    "sched": "ensemble",
    "model_code": "narm",
    "mentor_code": "narm",
    "mentor2_code": "narm",
    "softmaxed_mentor": true,
    "T": 1,
    "weight_list": [
        1,
        1
    ],
    "training_routine": "finished",
    "enable_auto_path_finder": false,
    "num_epochs": 0,
    "mode": "test",
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": "___el_base_partial_2022/base_narm-rate-0.8-seed-2000_05-05_12:50_t2/narm_logs/checkpoint/best_acc_model.pth",
    "mentor2_state_path": "___el_base_partial_2022/base_narm-rate-0.8-seed-2001_05-05_15:33_0/narm_logs/checkpoint/best_acc_model.pth",
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "do_remap": false,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.electronics/narm/config_ensemble.json",
    "task_id": -1,
    "describe": null,
    "split": "leave_one_out",
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "alpha": 0.1,
    "dvae_alpha": 0.5,
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
INFO    [05-25 14:38:44] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/electronics-5-5.pkl
INFO    [05-25 14:38:45] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-25 14:38:45] _check_dataset_cache in utils:
correct.
INFO    [05-25 14:38:45] __init__ in NextItemDataloader:
there are 29351 items in this dataset, 102187 users, padding_first? False
DEBUG   [05-25 14:39:01] generate_model in utils:
model_code_list=['narm']
INFO    [05-25 14:39:01] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-25 14:39:01] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-25 14:39:11] get_exist_path in utils:
dir ___ablation_el_ep_test_teacher/new_metrics_ep_teacher_T_1_narm_05-25_14:38_0/teacher1_narm_logs does not exist! Create one.
WARNING [05-25 14:39:11] get_exist_path in utils:
dir ___ablation_el_ep_test_teacher/new_metrics_ep_teacher_T_1_narm_05-25_14:38_0/teacher1_narm_logs/tb_vis does not exist! Create one.
WARNING [05-25 14:39:11] get_exist_path in utils:
dir ___ablation_el_ep_test_teacher/new_metrics_ep_teacher_T_1_narm_05-25_14:38_0/teacher1_narm_logs/checkpoint does not exist! Create one.
INFO    [05-25 14:39:11] load_state_from_given_path in utils:
checkpoint epoch: 78
INFO    [05-25 14:39:11] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-25 14:39:11] load_state_from_given_path in utils:
Loading optimizer's parameters
DEBUG   [05-25 14:39:11] _generate_teacher_trainer in EnsembleSched:
teacher1_narm: 
NARM(
  (item_embedding): Embedding(29352, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-25 14:39:11] assert_model_device in utils:
model teacher1_narm has 7.63525390625 MB params.
INFO    [05-25 14:39:11] __init__ in BasicTrainer:
454656 iter per epoch
DEBUG   [05-25 14:39:11] generate_model in utils:
model_code_list=['narm']
INFO    [05-25 14:39:11] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-25 14:39:11] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-25 14:39:16] get_exist_path in utils:
dir ___ablation_el_ep_test_teacher/new_metrics_ep_teacher_T_1_narm_05-25_14:38_0/teacher2_narm_logs does not exist! Create one.
WARNING [05-25 14:39:16] get_exist_path in utils:
dir ___ablation_el_ep_test_teacher/new_metrics_ep_teacher_T_1_narm_05-25_14:38_0/teacher2_narm_logs/tb_vis does not exist! Create one.
WARNING [05-25 14:39:16] get_exist_path in utils:
dir ___ablation_el_ep_test_teacher/new_metrics_ep_teacher_T_1_narm_05-25_14:38_0/teacher2_narm_logs/checkpoint does not exist! Create one.
INFO    [05-25 14:39:16] load_state_from_given_path in utils:
checkpoint epoch: 78
INFO    [05-25 14:39:16] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-25 14:39:16] load_state_from_given_path in utils:
Loading optimizer's parameters
DEBUG   [05-25 14:39:16] _generate_teacher_trainer in EnsembleSched:
teacher2_narm: 
NARM(
  (item_embedding): Embedding(29352, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-25 14:39:16] assert_model_device in utils:
model teacher2_narm has 7.63525390625 MB params.
INFO    [05-25 14:39:16] __init__ in BasicTrainer:
454656 iter per epoch
INFO    [05-25 14:39:16] assert_model_device in utils:
model ensemble_model has 0.0 MB params.
INFO    [05-25 14:39:16] assert_model_device in utils:
model ensemble_model has no param
INFO    [05-25 14:39:16] _set_current_routine in Routine:
first routine: finished
INFO    [05-25 14:39:16] _evaluate in EnsembleSched:
Start testing ensemble model on test set
INFO    [05-25 14:39:16] test in tester:
Finished loading. Start testing.
DEBUG   [05-25 14:39:17] forward in Ensembler:
raw predict
DEBUG   [05-25 14:39:17] forward in Ensembler:
[tensor([[2.4470e-16, 8.5255e-10, 1.3425e-07,  ..., 3.0403e-13, 3.8218e-11,
         1.0646e-05],
        [2.1217e-16, 6.3405e-14, 1.2337e-09,  ..., 4.7694e-13, 5.8127e-07,
         4.5897e-12],
        [6.6803e-11, 7.6238e-10, 4.9645e-07,  ..., 1.2863e-07, 8.9637e-05,
         3.2946e-08],
        ...,
        [2.9572e-13, 2.8217e-08, 4.4982e-07,  ..., 8.5341e-10, 4.6588e-07,
         1.4343e-05],
        [1.2641e-13, 1.6417e-09, 4.1486e-07,  ..., 5.7808e-11, 3.9552e-06,
         6.0544e-07],
        [1.1283e-12, 9.1477e-11, 4.5664e-07,  ..., 2.9964e-08, 3.0532e-07,
         1.1953e-06]], device='cuda:0'), tensor([[4.0635e-14, 8.7950e-11, 5.2492e-08,  ..., 3.6086e-14, 6.8123e-09,
         7.1984e-08],
        [6.0916e-15, 2.2633e-10, 5.5588e-10,  ..., 2.3534e-11, 4.4425e-11,
         5.2474e-10],
        [3.1146e-14, 9.1822e-11, 4.3972e-11,  ..., 2.0371e-10, 9.7018e-06,
         6.7680e-11],
        ...,
        [1.1884e-13, 2.4819e-07, 6.7135e-08,  ..., 8.8383e-10, 8.8339e-08,
         2.3658e-06],
        [3.3849e-12, 6.9182e-08, 7.0431e-07,  ..., 7.8566e-13, 1.7771e-06,
         9.4340e-06],
        [8.6723e-13, 6.6517e-08, 3.4315e-07,  ..., 7.8581e-07, 1.8806e-07,
         3.0186e-05]], device='cuda:0')]
DEBUG   [05-25 14:39:17] forward in Ensembler:
raw confidence
DEBUG   [05-25 14:39:17] forward in Ensembler:
[tensor([0.0348, 0.2485, 0.0101,  ..., 0.0245, 0.0241, 0.0249], device='cuda:0'), tensor([0.0422, 0.2106, 0.0490,  ..., 0.0100, 0.0303, 0.0117], device='cuda:0')]
DEBUG   [05-25 14:39:17] forward in Ensembler:
weighted predict
DEBUG   [05-25 14:39:17] forward in Ensembler:
[tensor([[2.4470e-16, 8.5255e-10, 1.3425e-07,  ..., 3.0403e-13, 3.8218e-11,
         1.0646e-05],
        [2.1217e-16, 6.3405e-14, 1.2337e-09,  ..., 4.7694e-13, 5.8127e-07,
         4.5897e-12],
        [6.6803e-11, 7.6238e-10, 4.9645e-07,  ..., 1.2863e-07, 8.9637e-05,
         3.2946e-08],
        ...,
        [2.9572e-13, 2.8217e-08, 4.4982e-07,  ..., 8.5341e-10, 4.6588e-07,
         1.4343e-05],
        [1.2641e-13, 1.6417e-09, 4.1486e-07,  ..., 5.7808e-11, 3.9552e-06,
         6.0544e-07],
        [1.1283e-12, 9.1477e-11, 4.5664e-07,  ..., 2.9964e-08, 3.0532e-07,
         1.1953e-06]], device='cuda:0'), tensor([[4.0635e-14, 8.7950e-11, 5.2492e-08,  ..., 3.6086e-14, 6.8123e-09,
         7.1984e-08],
        [6.0916e-15, 2.2633e-10, 5.5588e-10,  ..., 2.3534e-11, 4.4425e-11,
         5.2474e-10],
        [3.1146e-14, 9.1822e-11, 4.3972e-11,  ..., 2.0371e-10, 9.7018e-06,
         6.7680e-11],
        ...,
        [1.1884e-13, 2.4819e-07, 6.7135e-08,  ..., 8.8383e-10, 8.8339e-08,
         2.3658e-06],
        [3.3849e-12, 6.9182e-08, 7.0431e-07,  ..., 7.8566e-13, 1.7771e-06,
         9.4340e-06],
        [8.6723e-13, 6.6517e-08, 3.4315e-07,  ..., 7.8581e-07, 1.8806e-07,
         3.0186e-05]], device='cuda:0')]
DEBUG   [05-25 14:39:17] forward in Ensembler:
final predict
DEBUG   [05-25 14:39:17] forward in Ensembler:
tensor([[2.0440e-14, 4.7025e-10, 9.3371e-08,  ..., 1.7006e-13, 3.4253e-09,
         5.3591e-06],
        [3.1519e-15, 1.1320e-10, 8.9477e-10,  ..., 1.2006e-11, 2.9066e-07,
         2.6467e-10],
        [3.3417e-11, 4.2710e-10, 2.4825e-07,  ..., 6.4418e-08, 4.9669e-05,
         1.6507e-08],
        ...,
        [2.0728e-13, 1.3820e-07, 2.5848e-07,  ..., 8.6862e-10, 2.7711e-07,
         8.3546e-06],
        [1.7557e-12, 3.5412e-08, 5.5959e-07,  ..., 2.9297e-11, 2.8661e-06,
         5.0197e-06],
        [9.9775e-13, 3.3304e-08, 3.9989e-07,  ..., 4.0789e-07, 2.4669e-07,
         1.5691e-05]], device='cuda:0')
DEBUG   [05-25 14:39:17] forward in Ensembler:
final confidence
DEBUG   [05-25 14:39:17] forward in Ensembler:
tensor([0.0221, 0.1242, 0.0252,  ..., 0.0127, 0.0174, 0.0125], device='cuda:0')
DEBUG   [05-25 14:39:18] forward in Ensembler:
raw predict
DEBUG   [05-25 14:39:18] forward in Ensembler:
[tensor([[1.3163e-12, 1.1709e-07, 4.0522e-08,  ..., 2.6858e-07, 6.5667e-07,
         9.0464e-07],
        [1.2469e-13, 2.0924e-10, 1.2022e-08,  ..., 5.4758e-09, 8.7844e-09,
         1.6859e-05],
        [3.3480e-16, 4.0723e-12, 1.5940e-07,  ..., 1.1248e-08, 1.6801e-08,
         7.0335e-08],
        ...,
        [9.7260e-13, 5.9679e-13, 2.3963e-10,  ..., 1.0940e-10, 3.7496e-06,
         4.1286e-08],
        [8.1639e-14, 3.6534e-11, 3.6402e-08,  ..., 6.6228e-11, 7.1459e-07,
         1.4608e-08],
        [7.0474e-11, 2.2826e-10, 2.8441e-08,  ..., 8.1344e-09, 4.3851e-07,
         2.3369e-07]], device='cuda:0'), tensor([[2.6086e-13, 2.0192e-10, 2.5709e-10,  ..., 5.3289e-09, 1.0606e-08,
         9.4447e-09],
        [3.3567e-15, 4.0755e-15, 1.1595e-08,  ..., 4.0640e-07, 1.7511e-07,
         2.8783e-07],
        [5.7797e-14, 3.6500e-10, 5.9844e-09,  ..., 1.2675e-10, 4.1298e-11,
         1.0139e-06],
        ...,
        [3.9134e-10, 2.3081e-09, 1.9798e-08,  ..., 1.7462e-08, 4.3460e-03,
         1.4864e-07],
        [2.3553e-12, 6.8228e-11, 3.1890e-08,  ..., 1.1886e-08, 1.2672e-06,
         4.4018e-06],
        [3.7589e-11, 3.1470e-08, 5.6514e-09,  ..., 5.2763e-11, 6.4376e-07,
         1.2167e-07]], device='cuda:0')]
DEBUG   [05-25 14:39:18] forward in Ensembler:
raw confidence
DEBUG   [05-25 14:39:18] forward in Ensembler:
[tensor([0.0513, 0.0202, 0.0784,  ..., 0.0395, 0.0212, 0.0683], device='cuda:0'), tensor([0.1253, 0.1272, 0.1033,  ..., 0.0469, 0.0694, 0.0298], device='cuda:0')]
DEBUG   [05-25 14:39:18] forward in Ensembler:
weighted predict
DEBUG   [05-25 14:39:18] forward in Ensembler:
[tensor([[1.3163e-12, 1.1709e-07, 4.0522e-08,  ..., 2.6858e-07, 6.5667e-07,
         9.0464e-07],
        [1.2469e-13, 2.0924e-10, 1.2022e-08,  ..., 5.4758e-09, 8.7844e-09,
         1.6859e-05],
        [3.3480e-16, 4.0723e-12, 1.5940e-07,  ..., 1.1248e-08, 1.6801e-08,
         7.0335e-08],
        ...,
        [9.7260e-13, 5.9679e-13, 2.3963e-10,  ..., 1.0940e-10, 3.7496e-06,
         4.1286e-08],
        [8.1639e-14, 3.6534e-11, 3.6402e-08,  ..., 6.6228e-11, 7.1459e-07,
         1.4608e-08],
        [7.0474e-11, 2.2826e-10, 2.8441e-08,  ..., 8.1344e-09, 4.3851e-07,
         2.3369e-07]], device='cuda:0'), tensor([[2.6086e-13, 2.0192e-10, 2.5709e-10,  ..., 5.3289e-09, 1.0606e-08,
         9.4447e-09],
        [3.3567e-15, 4.0755e-15, 1.1595e-08,  ..., 4.0640e-07, 1.7511e-07,
         2.8783e-07],
        [5.7797e-14, 3.6500e-10, 5.9844e-09,  ..., 1.2675e-10, 4.1298e-11,
         1.0139e-06],
        ...,
        [3.9134e-10, 2.3081e-09, 1.9798e-08,  ..., 1.7462e-08, 4.3460e-03,
         1.4864e-07],
        [2.3553e-12, 6.8228e-11, 3.1890e-08,  ..., 1.1886e-08, 1.2672e-06,
         4.4018e-06],
        [3.7589e-11, 3.1470e-08, 5.6514e-09,  ..., 5.2763e-11, 6.4376e-07,
         1.2167e-07]], device='cuda:0')]
DEBUG   [05-25 14:39:19] forward in Ensembler:
final predict
DEBUG   [05-25 14:39:19] forward in Ensembler:
tensor([[7.8857e-13, 5.8645e-08, 2.0389e-08,  ..., 1.3695e-07, 3.3364e-07,
         4.5704e-07],
        [6.4023e-14, 1.0462e-10, 1.1808e-08,  ..., 2.0594e-07, 9.1948e-08,
         8.5733e-06],
        [2.9066e-14, 1.8454e-10, 8.2693e-08,  ..., 5.6871e-09, 8.4209e-09,
         5.4214e-07],
        ...,
        [1.9616e-10, 1.1544e-09, 1.0019e-08,  ..., 8.7856e-09, 2.1749e-03,
         9.4964e-08],
        [1.2184e-12, 5.2381e-11, 3.4146e-08,  ..., 5.9762e-09, 9.9091e-07,
         2.2082e-06],
        [5.4032e-11, 1.5849e-08, 1.7046e-08,  ..., 4.0936e-09, 5.4113e-07,
         1.7768e-07]], device='cuda:0')
DEBUG   [05-25 14:39:19] forward in Ensembler:
final confidence
DEBUG   [05-25 14:39:19] forward in Ensembler:
tensor([0.0632, 0.0636, 0.0631,  ..., 0.0260, 0.0347, 0.0344], device='cuda:0')
DEBUG   [05-25 14:39:20] forward in Ensembler:
raw predict
DEBUG   [05-25 14:39:20] forward in Ensembler:
[tensor([[1.3716e-12, 1.6774e-10, 3.6142e-07,  ..., 1.1675e-10, 2.0417e-06,
         2.2668e-07],
        [1.3509e-09, 4.1214e-10, 2.4632e-06,  ..., 4.7795e-09, 1.5282e-06,
         7.8793e-06],
        [4.6321e-11, 8.6959e-08, 1.7095e-07,  ..., 4.4594e-05, 2.5602e-06,
         2.8152e-07],
        ...,
        [1.1077e-15, 1.2163e-15, 7.8067e-09,  ..., 1.0209e-11, 4.7306e-04,
         4.3588e-10],
        [2.4441e-15, 3.8930e-18, 1.4123e-13,  ..., 5.8296e-21, 6.7269e-09,
         8.5551e-12],
        [2.7249e-15, 4.7656e-10, 5.4564e-09,  ..., 1.0083e-10, 1.2613e-06,
         4.9377e-08]], device='cuda:0'), tensor([[2.2447e-13, 1.1081e-10, 5.1319e-09,  ..., 1.3514e-10, 4.7783e-08,
         8.5793e-11],
        [1.4077e-10, 5.7401e-08, 5.5972e-08,  ..., 3.6221e-07, 2.4588e-07,
         3.3168e-05],
        [1.5702e-11, 9.8352e-07, 1.1919e-06,  ..., 2.0266e-08, 8.0897e-09,
         3.7501e-05],
        ...,
        [1.4180e-13, 1.5605e-11, 1.5198e-09,  ..., 2.0625e-08, 3.3187e-06,
         7.9447e-08],
        [9.8260e-13, 2.6660e-15, 1.5224e-11,  ..., 3.2501e-12, 6.2080e-07,
         1.6960e-10],
        [2.5019e-14, 2.5357e-14, 8.0228e-11,  ..., 5.7935e-12, 1.1066e-05,
         1.7272e-10]], device='cuda:0')]
DEBUG   [05-25 14:39:20] forward in Ensembler:
raw confidence
DEBUG   [05-25 14:39:20] forward in Ensembler:
[tensor([0.0663, 0.0263, 0.0179,  ..., 0.0583, 0.9979, 0.0509], device='cuda:0'), tensor([0.1480, 0.0072, 0.0379,  ..., 0.1415, 0.8305, 0.0805], device='cuda:0')]
DEBUG   [05-25 14:39:20] forward in Ensembler:
weighted predict
DEBUG   [05-25 14:39:20] forward in Ensembler:
[tensor([[1.3716e-12, 1.6774e-10, 3.6142e-07,  ..., 1.1675e-10, 2.0417e-06,
         2.2668e-07],
        [1.3509e-09, 4.1214e-10, 2.4632e-06,  ..., 4.7795e-09, 1.5282e-06,
         7.8793e-06],
        [4.6321e-11, 8.6959e-08, 1.7095e-07,  ..., 4.4594e-05, 2.5602e-06,
         2.8152e-07],
        ...,
        [1.1077e-15, 1.2163e-15, 7.8067e-09,  ..., 1.0209e-11, 4.7306e-04,
         4.3588e-10],
        [2.4441e-15, 3.8930e-18, 1.4123e-13,  ..., 5.8296e-21, 6.7269e-09,
         8.5551e-12],
        [2.7249e-15, 4.7656e-10, 5.4564e-09,  ..., 1.0083e-10, 1.2613e-06,
         4.9377e-08]], device='cuda:0'), tensor([[2.2447e-13, 1.1081e-10, 5.1319e-09,  ..., 1.3514e-10, 4.7783e-08,
         8.5793e-11],
        [1.4077e-10, 5.7401e-08, 5.5972e-08,  ..., 3.6221e-07, 2.4588e-07,
         3.3168e-05],
        [1.5702e-11, 9.8352e-07, 1.1919e-06,  ..., 2.0266e-08, 8.0897e-09,
         3.7501e-05],
        ...,
        [1.4180e-13, 1.5605e-11, 1.5198e-09,  ..., 2.0625e-08, 3.3187e-06,
         7.9447e-08],
        [9.8260e-13, 2.6660e-15, 1.5224e-11,  ..., 3.2501e-12, 6.2080e-07,
         1.6960e-10],
        [2.5019e-14, 2.5357e-14, 8.0228e-11,  ..., 5.7935e-12, 1.1066e-05,
         1.7272e-10]], device='cuda:0')]
DEBUG   [05-25 14:39:20] forward in Ensembler:
final predict
DEBUG   [05-25 14:39:20] forward in Ensembler:
tensor([[7.9801e-13, 1.3928e-10, 1.8328e-07,  ..., 1.2595e-10, 1.0447e-06,
         1.1338e-07],
        [7.4585e-10, 2.8907e-08, 1.2596e-06,  ..., 1.8349e-07, 8.8704e-07,
         2.0523e-05],
        [3.1012e-11, 5.3524e-07, 6.8142e-07,  ..., 2.2307e-05, 1.2841e-06,
         1.8891e-05],
        ...,
        [7.1454e-14, 7.8030e-12, 4.6633e-09,  ..., 1.0318e-08, 2.3819e-04,
         3.9941e-08],
        [4.9252e-13, 1.3349e-15, 7.6827e-12,  ..., 1.6251e-12, 3.1376e-07,
         8.9076e-11],
        [1.3872e-14, 2.3829e-10, 2.7683e-09,  ..., 5.3311e-11, 6.1637e-06,
         2.4775e-08]], device='cuda:0')
DEBUG   [05-25 14:39:20] forward in Ensembler:
final confidence
DEBUG   [05-25 14:39:20] forward in Ensembler:
tensor([0.0752, 0.0134, 0.0190,  ..., 0.0707, 0.9142, 0.0404], device='cuda:0')
DEBUG   [05-25 14:39:22] forward in Ensembler:
raw predict
DEBUG   [05-25 14:39:22] forward in Ensembler:
[tensor([[1.4059e-13, 1.3831e-07, 1.1565e-07,  ..., 6.5075e-08, 6.5030e-06,
         1.0349e-07],
        [4.2609e-10, 2.2531e-06, 4.9643e-08,  ..., 9.6318e-11, 3.6315e-05,
         1.2299e-05],
        [4.8497e-11, 3.8239e-11, 4.8823e-07,  ..., 5.6501e-08, 1.9941e-06,
         1.7420e-05],
        ...,
        [1.7770e-13, 4.0721e-10, 2.6754e-07,  ..., 7.4141e-10, 6.4436e-09,
         1.0902e-06],
        [1.0702e-12, 2.5817e-13, 3.3222e-09,  ..., 7.2666e-12, 1.8657e-07,
         2.1816e-10],
        [1.8768e-13, 9.5403e-11, 2.9807e-08,  ..., 1.3834e-09, 1.5942e-08,
         2.0747e-07]], device='cuda:0'), tensor([[1.1905e-12, 1.8635e-08, 4.9189e-07,  ..., 1.9467e-06, 5.6690e-07,
         3.5582e-05],
        [7.9417e-11, 4.2656e-08, 1.4103e-07,  ..., 5.1117e-08, 9.1431e-05,
         3.9417e-07],
        [7.4627e-13, 2.0396e-14, 3.6484e-07,  ..., 4.1511e-07, 2.3127e-07,
         1.4709e-07],
        ...,
        [8.5751e-12, 9.0304e-07, 2.9099e-07,  ..., 2.5372e-09, 9.0727e-08,
         2.1001e-06],
        [4.2847e-11, 1.8632e-07, 2.5124e-08,  ..., 7.2473e-10, 7.2663e-07,
         2.2161e-07],
        [4.5263e-10, 1.0794e-07, 3.9927e-06,  ..., 4.5459e-06, 6.2720e-05,
         3.5642e-08]], device='cuda:0')]
DEBUG   [05-25 14:39:22] forward in Ensembler:
raw confidence
DEBUG   [05-25 14:39:22] forward in Ensembler:
[tensor([0.0305, 0.0260, 0.0391,  ..., 0.0226, 0.0635, 0.0189], device='cuda:0'), tensor([0.0132, 0.0263, 0.0360,  ..., 0.0128, 0.0361, 0.0090], device='cuda:0')]
DEBUG   [05-25 14:39:22] forward in Ensembler:
weighted predict
DEBUG   [05-25 14:39:22] forward in Ensembler:
[tensor([[1.4059e-13, 1.3831e-07, 1.1565e-07,  ..., 6.5075e-08, 6.5030e-06,
         1.0349e-07],
        [4.2609e-10, 2.2531e-06, 4.9643e-08,  ..., 9.6318e-11, 3.6315e-05,
         1.2299e-05],
        [4.8497e-11, 3.8239e-11, 4.8823e-07,  ..., 5.6501e-08, 1.9941e-06,
         1.7420e-05],
        ...,
        [1.7770e-13, 4.0721e-10, 2.6754e-07,  ..., 7.4141e-10, 6.4436e-09,
         1.0902e-06],
        [1.0702e-12, 2.5817e-13, 3.3222e-09,  ..., 7.2666e-12, 1.8657e-07,
         2.1816e-10],
        [1.8768e-13, 9.5403e-11, 2.9807e-08,  ..., 1.3834e-09, 1.5942e-08,
         2.0747e-07]], device='cuda:0'), tensor([[1.1905e-12, 1.8635e-08, 4.9189e-07,  ..., 1.9467e-06, 5.6690e-07,
         3.5582e-05],
        [7.9417e-11, 4.2656e-08, 1.4103e-07,  ..., 5.1117e-08, 9.1431e-05,
         3.9417e-07],
        [7.4627e-13, 2.0396e-14, 3.6484e-07,  ..., 4.1511e-07, 2.3127e-07,
         1.4709e-07],
        ...,
        [8.5751e-12, 9.0304e-07, 2.9099e-07,  ..., 2.5372e-09, 9.0727e-08,
         2.1001e-06],
        [4.2847e-11, 1.8632e-07, 2.5124e-08,  ..., 7.2473e-10, 7.2663e-07,
         2.2161e-07],
        [4.5263e-10, 1.0794e-07, 3.9927e-06,  ..., 4.5459e-06, 6.2720e-05,
         3.5642e-08]], device='cuda:0')]
DEBUG   [05-25 14:39:22] forward in Ensembler:
final predict
DEBUG   [05-25 14:39:22] forward in Ensembler:
tensor([[6.6555e-13, 7.8474e-08, 3.0377e-07,  ..., 1.0059e-06, 3.5349e-06,
         1.7843e-05],
        [2.5275e-10, 1.1479e-06, 9.5336e-08,  ..., 2.5607e-08, 6.3873e-05,
         6.3465e-06],
        [2.4622e-11, 1.9130e-11, 4.2653e-07,  ..., 2.3580e-07, 1.1127e-06,
         8.7836e-06],
        ...,
        [4.3764e-12, 4.5172e-07, 2.7927e-07,  ..., 1.6393e-09, 4.8585e-08,
         1.5951e-06],
        [2.1959e-11, 9.3162e-08, 1.4223e-08,  ..., 3.6600e-10, 4.5660e-07,
         1.1091e-07],
        [2.2641e-10, 5.4016e-08, 2.0112e-06,  ..., 2.2736e-06, 3.1368e-05,
         1.2156e-07]], device='cuda:0')
DEBUG   [05-25 14:39:22] forward in Ensembler:
final confidence
DEBUG   [05-25 14:39:22] forward in Ensembler:
tensor([0.0182, 0.0147, 0.0196,  ..., 0.0166, 0.0319, 0.0098], device='cuda:0')
DEBUG   [05-25 14:39:24] forward in Ensembler:
raw predict
DEBUG   [05-25 14:39:24] forward in Ensembler:
[tensor([[1.9939e-12, 1.8746e-11, 3.7804e-07,  ..., 7.2435e-09, 6.8482e-08,
         8.0204e-06],
        [6.0576e-09, 1.0150e-08, 4.5190e-07,  ..., 1.0409e-06, 7.7076e-05,
         3.3635e-07],
        [1.4372e-12, 9.6948e-11, 1.5843e-10,  ..., 3.3963e-12, 1.7836e-06,
         4.4075e-07],
        ...,
        [1.2668e-10, 8.7044e-09, 1.3480e-07,  ..., 2.6762e-10, 1.0127e-06,
         5.8666e-07],
        [1.1057e-15, 5.3245e-11, 9.5893e-08,  ..., 3.1654e-09, 5.1228e-10,
         5.0518e-08],
        [1.2459e-16, 1.1077e-10, 6.5857e-07,  ..., 1.9647e-12, 3.3662e-11,
         2.1125e-09]], device='cuda:0'), tensor([[8.9268e-12, 2.5678e-09, 9.7251e-08,  ..., 1.1597e-08, 5.1266e-08,
         3.2515e-07],
        [1.0694e-08, 6.8167e-08, 3.8553e-07,  ..., 7.6043e-08, 5.5514e-06,
         1.9789e-08],
        [3.9561e-13, 5.7090e-10, 3.6527e-08,  ..., 2.7757e-11, 1.0194e-07,
         8.4665e-09],
        ...,
        [2.0613e-11, 1.8020e-08, 7.6239e-08,  ..., 3.5702e-11, 2.3245e-06,
         1.6814e-05],
        [6.7773e-14, 3.1728e-08, 4.2613e-08,  ..., 7.9339e-07, 3.4573e-10,
         1.4123e-05],
        [1.8541e-14, 6.4134e-08, 3.8714e-07,  ..., 1.7258e-11, 3.9517e-10,
         1.0897e-05]], device='cuda:0')]
DEBUG   [05-25 14:39:24] forward in Ensembler:
raw confidence
DEBUG   [05-25 14:39:24] forward in Ensembler:
[tensor([0.1315, 0.0105, 0.0646,  ..., 0.0810, 0.1063, 0.1575], device='cuda:0'), tensor([0.0490, 0.0683, 0.0267,  ..., 0.1906, 0.0187, 0.0465], device='cuda:0')]
DEBUG   [05-25 14:39:24] forward in Ensembler:
weighted predict
DEBUG   [05-25 14:39:24] forward in Ensembler:
[tensor([[1.9939e-12, 1.8746e-11, 3.7804e-07,  ..., 7.2435e-09, 6.8482e-08,
         8.0204e-06],
        [6.0576e-09, 1.0150e-08, 4.5190e-07,  ..., 1.0409e-06, 7.7076e-05,
         3.3635e-07],
        [1.4372e-12, 9.6948e-11, 1.5843e-10,  ..., 3.3963e-12, 1.7836e-06,
         4.4075e-07],
        ...,
        [1.2668e-10, 8.7044e-09, 1.3480e-07,  ..., 2.6762e-10, 1.0127e-06,
         5.8666e-07],
        [1.1057e-15, 5.3245e-11, 9.5893e-08,  ..., 3.1654e-09, 5.1228e-10,
         5.0518e-08],
        [1.2459e-16, 1.1077e-10, 6.5857e-07,  ..., 1.9647e-12, 3.3662e-11,
         2.1125e-09]], device='cuda:0'), tensor([[8.9268e-12, 2.5678e-09, 9.7251e-08,  ..., 1.1597e-08, 5.1266e-08,
         3.2515e-07],
        [1.0694e-08, 6.8167e-08, 3.8553e-07,  ..., 7.6043e-08, 5.5514e-06,
         1.9789e-08],
        [3.9561e-13, 5.7090e-10, 3.6527e-08,  ..., 2.7757e-11, 1.0194e-07,
         8.4665e-09],
        ...,
        [2.0613e-11, 1.8020e-08, 7.6239e-08,  ..., 3.5702e-11, 2.3245e-06,
         1.6814e-05],
        [6.7773e-14, 3.1728e-08, 4.2613e-08,  ..., 7.9339e-07, 3.4573e-10,
         1.4123e-05],
        [1.8541e-14, 6.4134e-08, 3.8714e-07,  ..., 1.7258e-11, 3.9517e-10,
         1.0897e-05]], device='cuda:0')]
DEBUG   [05-25 14:39:24] forward in Ensembler:
final predict
DEBUG   [05-25 14:39:24] forward in Ensembler:
tensor([[5.4603e-12, 1.2933e-09, 2.3765e-07,  ..., 9.4201e-09, 5.9874e-08,
         4.1728e-06],
        [8.3761e-09, 3.9159e-08, 4.1871e-07,  ..., 5.5847e-07, 4.1314e-05,
         1.7807e-07],
        [9.1641e-13, 3.3392e-10, 1.8343e-08,  ..., 1.5577e-11, 9.4276e-07,
         2.2461e-07],
        ...,
        [7.3646e-11, 1.3362e-08, 1.0552e-07,  ..., 1.5166e-10, 1.6686e-06,
         8.7006e-06],
        [3.4439e-14, 1.5890e-08, 6.9253e-08,  ..., 3.9828e-07, 4.2900e-10,
         7.0866e-06],
        [9.3329e-15, 3.2123e-08, 5.2286e-07,  ..., 9.6112e-12, 2.1442e-10,
         5.4497e-06]], device='cuda:0')
DEBUG   [05-25 14:39:24] forward in Ensembler:
final confidence
DEBUG   [05-25 14:39:24] forward in Ensembler:
tensor([0.0902, 0.0346, 0.0394,  ..., 0.1358, 0.0549, 0.0820], device='cuda:0')
WARNING [05-25 14:40:02] get_exist_path in utils:
dir ___ablation_el_ep_test_teacher/new_metrics_ep_teacher_T_1_narm_05-25_14:38_0/ensemble_model_logs does not exist! Create one.
INFO    [05-25 14:40:02] _evaluate in EnsembleSched:
!!Final Result!!: {'Recall@10': 0.05875012829899788, 'NDCG@10': 0.03645374499261379, 'MRR@10': 0.029645686969161034, 'Recall@5': 0.04294489547610283, 'NDCG@5': 0.03136848762631416, 'MRR@5': 0.02756171889603138, 'Recall*@10': 0.06268928185105324, 'NDCG*@10': 0.038723609000444414, 'MRR*@10': 0.03140322372317314, 'Recall*@5': 0.0457861091196537, 'NDCG*@5': 0.033281443491578105, 'MRR*@5': 0.02917083874344826, 'Recall**@10': 0.042477369233965875, 'NDCG**@10': 0.02708403445780277, 'MRR**@10': 0.0223953302949667, 'Recall**@5': 0.031211716160178184, 'NDCG**@5': 0.023475467786192895, 'MRR**@5': 0.020925997048616408}
