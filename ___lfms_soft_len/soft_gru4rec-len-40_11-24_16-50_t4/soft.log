INFO    [11-24 16:50:13] setup_train in utils:
{
    "experiment_dir": "___lfms_soft_len",
    "experiment_description": "soft",
    "describe": "{config[model_code]}-len-{config[max_len]}",
    "dataset_name": "lastfm_small.csv",
    "sched": "distill",
    "model_code": "gru4rec",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "dvae_alpha": 0.5,
    "alpha": 0.5,
    "T": 3,
    "num_epochs": 80,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 40,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2022,
    "load_processed_dataset": false,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 256,
    "val_batch_size": 256,
    "test_batch_size": 256,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.lastfm_small/gru4rec/config_distill.json",
    "task_id": 4,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [11-24 16:50:13] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_gru4rec
INFO    [11-24 16:50:13] _gen_dataset in utils:
processing dataset lastfm_small.csv
INFO    [11-24 16:50:13] _drop_cold in utils:
filtering out cold users (who interacts with less or eq than 5 items) and cold items (which is interacted by less or eq than 5 users)
DEBUG   [11-24 16:50:13] _drop_cold in utils:
before filtering, there are 1090 users, 3646 items 
DEBUG   [11-24 16:50:13] _drop_cold in utils:
after 0 filterings, there are 1090 users, 3646 items
INFO    [11-24 16:50:13] _drop_cold in utils:
user desc 
            seq_len
count  1090.000000
mean     48.211927
std      77.730410
min       5.000000
25%       9.000000
50%      19.000000
75%      49.750000
max     899.000000
INFO    [11-24 16:50:13] _drop_cold in utils:
item desc 
           item_pop
count  3646.000000
mean     14.413330
std      16.072829
min       5.000000
25%       6.000000
50%       9.000000
75%      15.000000
max     177.000000
INFO    [11-24 16:50:13] _df_data_partition in utils:
dataset summary:
         session_id       item_id   rating
count  52551.000000  52551.000000  52551.0
mean     527.873799   1828.243915      1.0
std      316.650738   1049.669215      0.0
min        1.000000      1.000000      1.0
25%      248.000000    928.000000      1.0
50%      515.000000   1834.000000      1.0
75%      813.000000   2718.500000      1.0
max     1090.000000   3646.000000      1.0
INFO    [11-24 16:50:13] __init__ in NextItemDataloader:
there are 3646 items in this dataset, 1976 users, padding_first? False
DEBUG   [11-24 16:50:14] generate_model in utils:
model_code_list=['pop']
INFO    [11-24 16:50:14] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [11-24 16:50:14] load_model_config in utils:
{}
WARNING [11-24 16:50:19] get_exist_path in utils:
dir ___lfms_soft_len/soft_gru4rec-len-40_11-24_16:50_t4/teacher_pop_logs does not exist! Create one.
WARNING [11-24 16:50:19] get_exist_path in utils:
dir ___lfms_soft_len/soft_gru4rec-len-40_11-24_16:50_t4/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [11-24 16:50:19] get_exist_path in utils:
dir ___lfms_soft_len/soft_gru4rec-len-40_11-24_16:50_t4/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [11-24 16:50:19] get_path in utils:
Path is None
WARNING [11-24 16:50:19] load_state_from_given_path in utils:
Not given any path.
DEBUG   [11-24 16:50:19] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [11-24 16:50:19] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [11-24 16:50:19] __init__ in BasicTrainer:
53760 iter per epoch
DEBUG   [11-24 16:50:19] generate_model in utils:
model_code_list=['gru4rec']
INFO    [11-24 16:50:19] load_model_config in utils:
loading model gru4rec's config file at asset/config/model/gru4rec.json
INFO    [11-24 16:50:19] load_model_config in utils:
{
    "embed_size": 64,
    "hidden_units": 64,
    "num_layers": 2,
    "hidden_dropout": 0.5,
    "loss_type": "CE"
}
WARNING [11-24 16:50:20] get_exist_path in utils:
dir ___lfms_soft_len/soft_gru4rec-len-40_11-24_16:50_t4/student_gru4rec_logs does not exist! Create one.
WARNING [11-24 16:50:20] get_exist_path in utils:
dir ___lfms_soft_len/soft_gru4rec-len-40_11-24_16:50_t4/student_gru4rec_logs/tb_vis does not exist! Create one.
WARNING [11-24 16:50:20] get_exist_path in utils:
dir ___lfms_soft_len/soft_gru4rec-len-40_11-24_16:50_t4/student_gru4rec_logs/checkpoint does not exist! Create one.
WARNING [11-24 16:50:20] get_path in utils:
Path is None
WARNING [11-24 16:50:20] load_state_from_given_path in utils:
Not given any path.
DEBUG   [11-24 16:50:20] __init__ in DistillSched:
student model: 
GRU4RecModel(
  (item_embedding): Embedding(3647, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.5, inplace=False)
  (gru_layers): GRU(64, 64, num_layers=2, bias=False, batch_first=True)
  (dense): Linear(in_features=64, out_features=64, bias=True)
  (loss_fct): CrossEntropyLoss()
)
INFO    [11-24 16:50:20] assert_model_device in utils:
model student_gru4rec has 1.09375 MB params.
INFO    [11-24 16:50:20] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [11-24 16:50:20] __init__ in DistillTrainer:
53760 iter per epoch
INFO    [11-24 16:50:20] _set_current_routine in Routine:
first routine: student
INFO    [11-24 16:50:20] run_routine in Routine:
Start routine student
INFO    [11-24 16:50:20] run_routine in Routine:
Start training
INFO    [11-24 16:50:20] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [11-24 16:50:22] test_mentor in DistillTrainer:
{'Recall@10': 0.03364894725382328, 'NDCG@10': 0.01537859975360334, 'MRR@10': 0.009834486641921103, 'Recall@5': 0.021654211916029453, 'NDCG@5': 0.011621803510934114, 'MRR@5': 0.008354916993994266, 'Recall*@10': 0.03364894725382328, 'NDCG*@10': 0.01537859975360334, 'MRR*@10': 0.009834486641921103, 'Recall*@5': 0.021654211916029453, 'NDCG*@5': 0.011621803510934114, 'MRR*@5': 0.008354916993994266}
INFO    [11-24 16:50:22] train in DistillTrainer:
result:
{'Recall@10': 0.03364894725382328, 'NDCG@10': 0.01537859975360334, 'MRR@10': 0.009834486641921103, 'Recall@5': 0.021654211916029453, 'NDCG@5': 0.011621803510934114, 'MRR@5': 0.008354916993994266, 'Recall*@10': 0.03364894725382328, 'NDCG*@10': 0.01537859975360334, 'MRR*@10': 0.009834486641921103, 'Recall*@5': 0.021654211916029453, 'NDCG*@5': 0.011621803510934114, 'MRR*@5': 0.008354916993994266}
INFO    [11-24 16:50:23] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [11-24 16:50:23] validate in BasicTrainer:
{'Recall@10': 0.0048828125, 'NDCG@10': 0.0019411435932852328, 'MRR@10': 0.0010428292589494959, 'Recall@5': 0.00341796875, 'NDCG@5': 0.0014416934282053262, 'MRR@5': 0.0008219401133828796, 'Recall*@10': 0.0048828125, 'NDCG*@10': 0.0019411435932852328, 'MRR*@10': 0.0010428292589494959, 'Recall*@5': 0.00341796875, 'NDCG*@5': 0.0014416934282053262, 'MRR*@5': 0.0008219401133828796}
INFO    [11-24 16:50:23] train in BasicTrainer:
epoch: 0
DEBUG   [11-24 16:50:23] calculate_loss in loss:
soft_target max: 0.5020851492881775, argmax 401768
DEBUG   [11-24 16:50:23] calculate_loss in loss:
pred max in softmax: 0.00028796144761145115, argmax 859947
INFO    [11-24 16:50:28] _train_one_epoch in BasicTrainer:
loss = 5.558358896346319
INFO    [11-24 16:50:30] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [11-24 16:50:30] validate in BasicTrainer:
{'Recall@10': 0.02585767675191164, 'NDCG@10': 0.01238375622779131, 'MRR@10': 0.008284791663754731, 'Recall@5': 0.015412703854963183, 'NDCG@5': 0.008985800086520612, 'MRR@5': 0.006871320423670113, 'Recall*@10': 0.02585767675191164, 'NDCG*@10': 0.01238375622779131, 'MRR*@10': 0.008284791663754731, 'Recall*@5': 0.015412703854963183, 'NDCG*@5': 0.008985800086520612, 'MRR*@5': 0.006871320423670113}
INFO    [11-24 16:50:30] train in BasicTrainer:
duration: 6.8778908252716064s
INFO    [11-24 16:50:30] train in BasicTrainer:
epoch: 1
INFO    [11-24 16:50:35] _train_one_epoch in BasicTrainer:
loss = 5.3042728741963705
INFO    [11-24 16:50:36] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [11-24 16:50:36] validate in BasicTrainer:
{'Recall@10': 0.05288298241794109, 'NDCG@10': 0.027865481795743108, 'MRR@10': 0.02040574257262051, 'Recall@5': 0.03190811816602945, 'NDCG@5': 0.021210820646956563, 'MRR@5': 0.017732394160702825, 'Recall*@10': 0.05288298241794109, 'NDCG*@10': 0.027865481795743108, 'MRR*@10': 0.02040574257262051, 'Recall*@5': 0.03190811816602945, 'NDCG*@5': 0.021210820646956563, 'MRR*@5': 0.017732394160702825}
INFO    [11-24 16:50:36] train in BasicTrainer:
duration: 6.556999683380127s
INFO    [11-24 16:50:36] train in BasicTrainer:
epoch: 2
INFO    [11-24 16:50:41] _train_one_epoch in BasicTrainer:
loss = 5.141961172648839
INFO    [11-24 16:50:43] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [11-24 16:50:43] validate in BasicTrainer:
{'Recall@10': 0.06653362791985273, 'NDCG@10': 0.03437618934549391, 'MRR@10': 0.02459911408368498, 'Recall@5': 0.04555876366794109, 'NDCG@5': 0.02778600307647139, 'MRR@5': 0.021990347653627396, 'Recall*@10': 0.06653362791985273, 'NDCG*@10': 0.03437618934549391, 'MRR*@10': 0.02459911408368498, 'Recall*@5': 0.04555876366794109, 'NDCG*@5': 0.02778600307647139, 'MRR*@5': 0.021990347653627396}
INFO    [11-24 16:50:43] train in BasicTrainer:
duration: 6.574049949645996s
INFO    [11-24 16:50:43] train in BasicTrainer:
epoch: 3
INFO    [11-24 16:50:48] _train_one_epoch in BasicTrainer:
loss = 5.0293018318357925
INFO    [11-24 16:50:49] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [11-24 16:50:49] validate in BasicTrainer:
{'Recall@10': 0.08058763574808836, 'NDCG@10': 0.04166770167648792, 'MRR@10': 0.030018741497769952, 'Recall@5': 0.04927394725382328, 'NDCG@5': 0.03166680736467242, 'MRR@5': 0.025963471736758947, 'Recall*@10': 0.08058763574808836, 'NDCG*@10': 0.04166770167648792, 'MRR*@10': 0.030018741497769952, 'Recall*@5': 0.04927394725382328, 'NDCG*@5': 0.03166680736467242, 'MRR*@5': 0.025963471736758947}
INFO    [11-24 16:50:49] train in BasicTrainer:
duration: 6.481017827987671s
INFO    [11-24 16:50:49] train in BasicTrainer:
epoch: 4
DEBUG   [11-24 16:50:53] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 322162
DEBUG   [11-24 16:50:53] calculate_loss in loss:
pred max in softmax: 0.039357367902994156, argmax 411929
DEBUG   [11-24 16:50:53] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 179929
DEBUG   [11-24 16:50:53] calculate_loss in loss:
pred max in softmax: 0.042980317026376724, argmax 622384
INFO    [11-24 16:50:55] _train_one_epoch in BasicTrainer:
loss = 4.904761498314993
INFO    [11-24 16:50:56] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [11-24 16:50:56] validate in BasicTrainer:
{'Recall@10': 0.09502377733588219, 'NDCG@10': 0.047549301758408546, 'MRR@10': 0.033261852571740746, 'Recall@5': 0.05863620899617672, 'NDCG@5': 0.03581843967549503, 'MRR@5': 0.028442737413570285, 'Recall*@10': 0.09502377733588219, 'NDCG*@10': 0.047549301758408546, 'MRR*@10': 0.033261852571740746, 'Recall*@5': 0.05863620899617672, 'NDCG*@5': 0.03581843967549503, 'MRR*@5': 0.028442737413570285}
INFO    [11-24 16:50:56] train in BasicTrainer:
duration: 6.582901239395142s
INFO    [11-24 16:50:56] train in BasicTrainer:
epoch: 5
INFO    [11-24 16:51:01] _train_one_epoch in BasicTrainer:
loss = 4.79117560613723
INFO    [11-24 16:51:03] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [11-24 16:51:03] validate in BasicTrainer:
{'Recall@10': 0.11171025782823563, 'NDCG@10': 0.05953013012185693, 'MRR@10': 0.04370118072256446, 'Recall@5': 0.07317849900573492, 'NDCG@5': 0.046972102019935846, 'MRR@5': 0.038463826291263103, 'Recall*@10': 0.11171025782823563, 'NDCG*@10': 0.05953013012185693, 'MRR*@10': 0.04370118072256446, 'Recall*@5': 0.07317849900573492, 'NDCG*@5': 0.046972102019935846, 'MRR*@5': 0.038463826291263103}
INFO    [11-24 16:51:03] train in BasicTrainer:
duration: 6.751851320266724s
INFO    [11-24 16:51:03] train in BasicTrainer:
epoch: 6
INFO    [11-24 16:51:08] _train_one_epoch in BasicTrainer:
loss = 4.70100530896868
INFO    [11-24 16:51:09] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [11-24 16:51:09] validate in BasicTrainer:
{'Recall@10': 0.11474609375, 'NDCG@10': 0.06263516936451197, 'MRR@10': 0.046696385368704796, 'Recall@5': 0.07445227634161711, 'NDCG@5': 0.04935286776162684, 'MRR@5': 0.04106905357912183, 'Recall*@10': 0.11474609375, 'NDCG*@10': 0.06263516936451197, 'MRR*@10': 0.046696385368704796, 'Recall*@5': 0.07445227634161711, 'NDCG*@5': 0.04935286776162684, 'MRR*@5': 0.04106905357912183}
INFO    [11-24 16:51:09] train in BasicTrainer:
duration: 6.545926332473755s
INFO    [11-24 16:51:09] train in BasicTrainer:
epoch: 7
INFO    [11-24 16:51:15] _train_one_epoch in BasicTrainer:
loss = 4.6248467286427815
INFO    [11-24 16:51:16] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [11-24 16:51:16] validate in BasicTrainer:
{'Recall@10': 0.1266559101641178, 'NDCG@10': 0.06615802412852645, 'MRR@10': 0.04789500776678324, 'Recall@5': 0.08050271775573492, 'NDCG@5': 0.05140687292441726, 'MRR@5': 0.04191257758066058, 'Recall*@10': 0.1266559101641178, 'NDCG*@10': 0.06615802412852645, 'MRR*@10': 0.04789500776678324, 'Recall*@5': 0.08050271775573492, 'NDCG*@5': 0.05140687292441726, 'MRR*@5': 0.04191257758066058}
INFO    [11-24 16:51:16] train in BasicTrainer:
duration: 6.841430902481079s
INFO    [11-24 16:51:16] train in BasicTrainer:
epoch: 8
INFO    [11-24 16:51:21] _train_one_epoch in BasicTrainer:
loss = 4.559261163075765
INFO    [11-24 16:51:23] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [11-24 16:51:23] validate in BasicTrainer:
{'Recall@10': 0.13240913674235344, 'NDCG@10': 0.07035410776734352, 'MRR@10': 0.05165132042020559, 'Recall@5': 0.08585258200764656, 'NDCG@5': 0.05541978497058153, 'MRR@5': 0.045559472404420376, 'Recall*@10': 0.13240913674235344, 'NDCG*@10': 0.07035410776734352, 'MRR*@10': 0.05165132042020559, 'Recall*@5': 0.08585258200764656, 'NDCG*@5': 0.05541978497058153, 'MRR*@5': 0.045559472404420376}
INFO    [11-24 16:51:23] train in BasicTrainer:
duration: 6.6188929080963135s
INFO    [11-24 16:51:23] train in BasicTrainer:
epoch: 9
DEBUG   [11-24 16:51:26] calculate_loss in loss:
soft_target max: 0.5020851492881775, argmax 810232
DEBUG   [11-24 16:51:26] calculate_loss in loss:
pred max in softmax: 0.08121894299983978, argmax 811660
DEBUG   [11-24 16:51:26] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 431572
DEBUG   [11-24 16:51:26] calculate_loss in loss:
pred max in softmax: 0.0748530924320221, argmax 724132
INFO    [11-24 16:51:28] _train_one_epoch in BasicTrainer:
loss = 4.505791477929979
INFO    [11-24 16:51:29] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [11-24 16:51:29] validate in BasicTrainer:
{'Recall@10': 0.1350416112691164, 'NDCG@10': 0.07448871107771993, 'MRR@10': 0.0559545811265707, 'Recall@5': 0.09287958592176437, 'NDCG@5': 0.060864105354994535, 'MRR@5': 0.050341444090008736, 'Recall*@10': 0.1350416112691164, 'NDCG*@10': 0.07448871107771993, 'MRR*@10': 0.0559545811265707, 'Recall*@5': 0.09287958592176437, 'NDCG*@5': 0.060864105354994535, 'MRR*@5': 0.050341444090008736}
INFO    [11-24 16:51:29] train in BasicTrainer:
duration: 6.449435472488403s
INFO    [11-24 16:51:29] train in BasicTrainer:
epoch: 10
INFO    [11-24 16:51:34] _train_one_epoch in BasicTrainer:
loss = 4.457704133079165
INFO    [11-24 16:51:36] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [11-24 16:51:36] validate in BasicTrainer:
{'Recall@10': 0.14567765034735203, 'NDCG@10': 0.07877922337502241, 'MRR@10': 0.058443163987249136, 'Recall@5': 0.09642493259161711, 'NDCG@5': 0.06288908468559384, 'MRR@5': 0.051907483488321304, 'Recall*@10': 0.14567765034735203, 'NDCG*@10': 0.07877922337502241, 'MRR*@10': 0.058443163987249136, 'Recall*@5': 0.09642493259161711, 'NDCG*@5': 0.06288908468559384, 'MRR*@5': 0.051907483488321304}
INFO    [11-24 16:51:36] train in BasicTrainer:
duration: 6.5072410106658936s
INFO    [11-24 16:51:36] train in BasicTrainer:
epoch: 11
INFO    [11-24 16:51:41] _train_one_epoch in BasicTrainer:
loss = 4.4158045859563915
INFO    [11-24 16:51:42] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [11-24 16:51:42] validate in BasicTrainer:
{'Recall@10': 0.15221637301146984, 'NDCG@10': 0.08275778591632843, 'MRR@10': 0.06165085034444928, 'Recall@5': 0.09933339059352875, 'NDCG@5': 0.06576720718294382, 'MRR@5': 0.054703069385141134, 'Recall*@10': 0.15221637301146984, 'NDCG*@10': 0.08275778591632843, 'MRR*@10': 0.06165085034444928, 'Recall*@5': 0.09933339059352875, 'NDCG*@5': 0.06576720718294382, 'MRR*@5': 0.054703069385141134}
INFO    [11-24 16:51:42] train in BasicTrainer:
duration: 6.566627264022827s
INFO    [11-24 16:51:42] train in BasicTrainer:
epoch: 12
INFO    [11-24 16:51:47] _train_one_epoch in BasicTrainer:
loss = 4.3774464857010615
INFO    [11-24 16:51:49] validate in BasicTrainer:
{'Recall@10': 0.14567765034735203, 'NDCG@10': 0.08051286730915308, 'MRR@10': 0.06063631735742092, 'Recall@5': 0.099609375, 'NDCG@5': 0.06556283077225089, 'MRR@5': 0.05443380633369088, 'Recall*@10': 0.14567765034735203, 'NDCG*@10': 0.08051286730915308, 'MRR*@10': 0.06063631735742092, 'Recall*@5': 0.099609375, 'NDCG*@5': 0.06556283077225089, 'MRR*@5': 0.05443380633369088}
INFO    [11-24 16:51:49] train in BasicTrainer:
duration: 6.387363910675049s
INFO    [11-24 16:51:49] train in BasicTrainer:
epoch: 13
INFO    [11-24 16:51:54] _train_one_epoch in BasicTrainer:
loss = 4.338479216893514
INFO    [11-24 16:51:55] validate in BasicTrainer:
{'Recall@10': 0.15026324801146984, 'NDCG@10': 0.08271397184580564, 'MRR@10': 0.06208670511841774, 'Recall@5': 0.10606317967176437, 'NDCG@5': 0.06830551940947771, 'MRR@5': 0.05607308819890022, 'Recall*@10': 0.15026324801146984, 'NDCG*@10': 0.08271397184580564, 'MRR*@10': 0.06208670511841774, 'Recall*@5': 0.10606317967176437, 'NDCG*@5': 0.06830551940947771, 'MRR*@5': 0.05607308819890022}
INFO    [11-24 16:51:55] train in BasicTrainer:
duration: 6.390418529510498s
INFO    [11-24 16:51:55] train in BasicTrainer:
epoch: 14
DEBUG   [11-24 16:51:57] calculate_loss in loss:
soft_target max: 0.501268744468689, argmax 752152
DEBUG   [11-24 16:51:57] calculate_loss in loss:
pred max in softmax: 0.0854993388056755, argmax 890486
DEBUG   [11-24 16:51:57] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 223693
DEBUG   [11-24 16:51:57] calculate_loss in loss:
pred max in softmax: 0.11400537937879562, argmax 431443
INFO    [11-24 16:52:00] _train_one_epoch in BasicTrainer:
loss = 4.308211544581822
INFO    [11-24 16:52:02] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [11-24 16:52:02] validate in BasicTrainer:
{'Recall@10': 0.15270465426146984, 'NDCG@10': 0.08336412720382214, 'MRR@10': 0.06213944312185049, 'Recall@5': 0.10353685449808836, 'NDCG@5': 0.0673532048240304, 'MRR@5': 0.05546662909910083, 'Recall*@10': 0.15270465426146984, 'NDCG*@10': 0.08336412720382214, 'MRR*@10': 0.06213944312185049, 'Recall*@5': 0.10353685449808836, 'NDCG*@5': 0.0673532048240304, 'MRR*@5': 0.05546662909910083}
INFO    [11-24 16:52:02] train in BasicTrainer:
duration: 6.490726947784424s
INFO    [11-24 16:52:02] train in BasicTrainer:
epoch: 15
INFO    [11-24 16:52:07] _train_one_epoch in BasicTrainer:
loss = 4.274231851668585
INFO    [11-24 16:52:08] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [11-24 16:52:08] validate in BasicTrainer:
{'Recall@10': 0.15552819333970547, 'NDCG@10': 0.08443397283554077, 'MRR@10': 0.06289575761184096, 'Recall@5': 0.09827190916985273, 'NDCG@5': 0.06579450936987996, 'MRR@5': 0.05513296974822879, 'Recall*@10': 0.15552819333970547, 'NDCG*@10': 0.08443397283554077, 'MRR*@10': 0.06289575761184096, 'Recall*@5': 0.09827190916985273, 'NDCG*@5': 0.06579450936987996, 'MRR*@5': 0.05513296974822879}
INFO    [11-24 16:52:08] train in BasicTrainer:
duration: 6.473762035369873s
INFO    [11-24 16:52:08] train in BasicTrainer:
epoch: 16
INFO    [11-24 16:52:13] _train_one_epoch in BasicTrainer:
loss = 4.2453435511816116
INFO    [11-24 16:52:14] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [11-24 16:52:15] validate in BasicTrainer:
{'Recall@10': 0.15973165817558765, 'NDCG@10': 0.08654280379414558, 'MRR@10': 0.06432252237573266, 'Recall@5': 0.11221976950764656, 'NDCG@5': 0.07146222423762083, 'MRR@5': 0.058256554417312145, 'Recall*@10': 0.15973165817558765, 'NDCG*@10': 0.08654280379414558, 'MRR*@10': 0.06432252237573266, 'Recall*@5': 0.11221976950764656, 'NDCG*@5': 0.07146222423762083, 'MRR*@5': 0.058256554417312145}
INFO    [11-24 16:52:15] train in BasicTrainer:
duration: 6.458343029022217s
INFO    [11-24 16:52:15] train in BasicTrainer:
epoch: 17
INFO    [11-24 16:52:20] _train_one_epoch in BasicTrainer:
loss = 4.219569349288941
INFO    [11-24 16:52:21] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [11-24 16:52:21] validate in BasicTrainer:
{'Recall@10': 0.16119650192558765, 'NDCG@10': 0.08909112773835659, 'MRR@10': 0.06703501008450985, 'Recall@5': 0.11143427342176437, 'NDCG@5': 0.07307401532307267, 'MRR@5': 0.0604725731536746, 'Recall*@10': 0.16119650192558765, 'NDCG*@10': 0.08909112773835659, 'MRR*@10': 0.06703501008450985, 'Recall*@5': 0.11143427342176437, 'NDCG*@5': 0.07307401532307267, 'MRR*@5': 0.0604725731536746}
INFO    [11-24 16:52:21] train in BasicTrainer:
duration: 6.576416015625s
INFO    [11-24 16:52:21] train in BasicTrainer:
epoch: 18
INFO    [11-24 16:52:26] _train_one_epoch in BasicTrainer:
loss = 4.19095995766776
INFO    [11-24 16:52:28] validate in BasicTrainer:
{'Recall@10': 0.15964674018323421, 'NDCG@10': 0.087773353792727, 'MRR@10': 0.06587631814181805, 'Recall@5': 0.10627547558397055, 'NDCG@5': 0.07035676622763276, 'MRR@5': 0.05859764199703932, 'Recall*@10': 0.15964674018323421, 'NDCG*@10': 0.087773353792727, 'MRR*@10': 0.06587631814181805, 'Recall*@5': 0.10627547558397055, 'NDCG*@5': 0.07035676622763276, 'MRR*@5': 0.05859764199703932}
INFO    [11-24 16:52:28] train in BasicTrainer:
duration: 6.442602872848511s
INFO    [11-24 16:52:28] train in BasicTrainer:
epoch: 19
DEBUG   [11-24 16:52:28] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 336750
DEBUG   [11-24 16:52:28] calculate_loss in loss:
pred max in softmax: 0.10455538332462311, argmax 281689
DEBUG   [11-24 16:52:28] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 672274
DEBUG   [11-24 16:52:28] calculate_loss in loss:
pred max in softmax: 0.11005371063947678, argmax 450346
INFO    [11-24 16:52:33] _train_one_epoch in BasicTrainer:
loss = 4.163970649810064
INFO    [11-24 16:52:34] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [11-24 16:52:34] validate in BasicTrainer:
{'Recall@10': 0.16794752143323421, 'NDCG@10': 0.09031217638403177, 'MRR@10': 0.06662296177819371, 'Recall@5': 0.11466117575764656, 'NDCG@5': 0.07307327911257744, 'MRR@5': 0.05950379325076938, 'Recall*@10': 0.16794752143323421, 'NDCG*@10': 0.09031217638403177, 'MRR*@10': 0.06662296177819371, 'Recall*@5': 0.11466117575764656, 'NDCG*@5': 0.07307327911257744, 'MRR*@5': 0.05950379325076938}
INFO    [11-24 16:52:34] train in BasicTrainer:
duration: 6.448857545852661s
INFO    [11-24 16:52:34] train in BasicTrainer:
epoch: 20
INFO    [11-24 16:52:39] _train_one_epoch in BasicTrainer:
loss = 4.138961017699469
INFO    [11-24 16:52:40] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [11-24 16:52:40] validate in BasicTrainer:
{'Recall@10': 0.1689453125, 'NDCG@10': 0.09116021078079939, 'MRR@10': 0.06749648507684469, 'Recall@5': 0.11262313183397055, 'NDCG@5': 0.07281126966699958, 'MRR@5': 0.059846299700438976, 'Recall*@10': 0.1689453125, 'NDCG*@10': 0.09116021078079939, 'MRR*@10': 0.06749648507684469, 'Recall*@5': 0.11262313183397055, 'NDCG*@5': 0.07281126966699958, 'MRR*@5': 0.059846299700438976}
INFO    [11-24 16:52:40] train in BasicTrainer:
duration: 6.487039089202881s
INFO    [11-24 16:52:40] train in BasicTrainer:
epoch: 21
INFO    [11-24 16:52:45] _train_one_epoch in BasicTrainer:
loss = 4.112671023323422
INFO    [11-24 16:52:47] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [11-24 16:52:47] validate in BasicTrainer:
{'Recall@10': 0.17331861518323421, 'NDCG@10': 0.09286994114518166, 'MRR@10': 0.06836669659242034, 'Recall@5': 0.11525560449808836, 'NDCG@5': 0.07402592804282904, 'MRR@5': 0.06055112276226282, 'Recall*@10': 0.17331861518323421, 'NDCG*@10': 0.09286994114518166, 'MRR*@10': 0.06836669659242034, 'Recall*@5': 0.11525560449808836, 'NDCG*@5': 0.07402592804282904, 'MRR*@5': 0.06055112276226282}
INFO    [11-24 16:52:47] train in BasicTrainer:
duration: 6.458770513534546s
INFO    [11-24 16:52:47] train in BasicTrainer:
epoch: 22
INFO    [11-24 16:52:52] _train_one_epoch in BasicTrainer:
loss = 4.087755530221122
INFO    [11-24 16:52:53] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [11-24 16:52:53] validate in BasicTrainer:
{'Recall@10': 0.17478345893323421, 'NDCG@10': 0.09656085819005966, 'MRR@10': 0.07263127295300364, 'Recall@5': 0.12013841699808836, 'NDCG@5': 0.07872891472652555, 'MRR@5': 0.0651724562048912, 'Recall*@10': 0.17478345893323421, 'NDCG*@10': 0.09656085819005966, 'MRR*@10': 0.07263127295300364, 'Recall*@5': 0.12013841699808836, 'NDCG*@5': 0.07872891472652555, 'MRR*@5': 0.0651724562048912}
INFO    [11-24 16:52:53] train in BasicTrainer:
duration: 6.341358184814453s
INFO    [11-24 16:52:53] train in BasicTrainer:
epoch: 23
DEBUG   [11-24 16:52:57] calculate_loss in loss:
soft_target max: 0.5015878677368164, argmax 429620
DEBUG   [11-24 16:52:57] calculate_loss in loss:
pred max in softmax: 0.1436689794063568, argmax 182168
DEBUG   [11-24 16:52:57] calculate_loss in loss:
soft_target max: 0.5020193457603455, argmax 42511
DEBUG   [11-24 16:52:57] calculate_loss in loss:
pred max in softmax: 0.1433563381433487, argmax 743806
INFO    [11-24 16:52:58] _train_one_epoch in BasicTrainer:
loss = 4.063866500627427
INFO    [11-24 16:53:00] validate in BasicTrainer:
{'Recall@10': 0.1750806737691164, 'NDCG@10': 0.09471728838980198, 'MRR@10': 0.07010926213115454, 'Recall@5': 0.12277089059352875, 'NDCG@5': 0.07775853388011456, 'MRR@5': 0.06308275368064642, 'Recall*@10': 0.1750806737691164, 'NDCG*@10': 0.09471728838980198, 'MRR*@10': 0.07010926213115454, 'Recall*@5': 0.12277089059352875, 'NDCG*@5': 0.07775853388011456, 'MRR*@5': 0.06308275368064642}
INFO    [11-24 16:53:00] train in BasicTrainer:
duration: 6.226547956466675s
INFO    [11-24 16:53:00] train in BasicTrainer:
epoch: 24
INFO    [11-24 16:53:04] _train_one_epoch in BasicTrainer:
loss = 4.040383874802362
INFO    [11-24 16:53:06] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [11-24 16:53:06] validate in BasicTrainer:
{'Recall@10': 0.17692765034735203, 'NDCG@10': 0.09689951688051224, 'MRR@10': 0.07254405366256833, 'Recall@5': 0.11829144041985273, 'NDCG@5': 0.07788791554048657, 'MRR@5': 0.06466754572466016, 'Recall*@10': 0.17692765034735203, 'NDCG*@10': 0.09689951688051224, 'MRR*@10': 0.07254405366256833, 'Recall*@5': 0.11829144041985273, 'NDCG*@5': 0.07788791554048657, 'MRR*@5': 0.06466754572466016}
INFO    [11-24 16:53:06] train in BasicTrainer:
duration: 6.5042102336883545s
INFO    [11-24 16:53:06] train in BasicTrainer:
epoch: 25
INFO    [11-24 16:53:11] _train_one_epoch in BasicTrainer:
loss = 4.017175376982916
INFO    [11-24 16:53:12] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [11-24 16:53:12] validate in BasicTrainer:
{'Recall@10': 0.17868970893323421, 'NDCG@10': 0.09699761215597391, 'MRR@10': 0.07196730840951204, 'Recall@5': 0.12502122949808836, 'NDCG@5': 0.07967714127153158, 'MRR@5': 0.06484339665621519, 'Recall*@10': 0.17868970893323421, 'NDCG*@10': 0.09699761215597391, 'MRR*@10': 0.07196730840951204, 'Recall*@5': 0.12502122949808836, 'NDCG*@5': 0.07967714127153158, 'MRR*@5': 0.06484339665621519}
INFO    [11-24 16:53:12] train in BasicTrainer:
duration: 6.359652042388916s
INFO    [11-24 16:53:12] train in BasicTrainer:
epoch: 26
INFO    [11-24 16:53:17] _train_one_epoch in BasicTrainer:
loss = 3.9946194069726126
INFO    [11-24 16:53:19] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [11-24 16:53:19] validate in BasicTrainer:
{'Recall@10': 0.18004840426146984, 'NDCG@10': 0.09786272048950195, 'MRR@10': 0.07283962471410632, 'Recall@5': 0.12385360058397055, 'NDCG@5': 0.07968039764091372, 'MRR@5': 0.06532955495640635, 'Recall*@10': 0.18004840426146984, 'NDCG*@10': 0.09786272048950195, 'MRR*@10': 0.07283962471410632, 'Recall*@5': 0.12385360058397055, 'NDCG*@5': 0.07968039764091372, 'MRR*@5': 0.06532955495640635}
INFO    [11-24 16:53:19] train in BasicTrainer:
duration: 6.395081996917725s
INFO    [11-24 16:53:19] train in BasicTrainer:
epoch: 27
INFO    [11-24 16:53:24] _train_one_epoch in BasicTrainer:
loss = 3.9739773103169034
INFO    [11-24 16:53:25] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [11-24 16:53:25] validate in BasicTrainer:
{'Recall@10': 0.18083390034735203, 'NDCG@10': 0.0986560583114624, 'MRR@10': 0.07350624306127429, 'Recall@5': 0.12610394041985273, 'NDCG@5': 0.08102325350046158, 'MRR@5': 0.06627073558047414, 'Recall*@10': 0.18083390034735203, 'NDCG*@10': 0.0986560583114624, 'MRR*@10': 0.07350624306127429, 'Recall*@5': 0.12610394041985273, 'NDCG*@5': 0.08102325350046158, 'MRR*@5': 0.06627073558047414}
INFO    [11-24 16:53:25] train in BasicTrainer:
duration: 6.357299327850342s
INFO    [11-24 16:53:25] train in BasicTrainer:
epoch: 28
DEBUG   [11-24 16:53:28] calculate_loss in loss:
soft_target max: 0.5018050670623779, argmax 53428
DEBUG   [11-24 16:53:28] calculate_loss in loss:
pred max in softmax: 0.15884801745414734, argmax 190496
DEBUG   [11-24 16:53:28] calculate_loss in loss:
soft_target max: 0.5020193457603455, argmax 228508
DEBUG   [11-24 16:53:28] calculate_loss in loss:
pred max in softmax: 0.14066798985004425, argmax 628506
INFO    [11-24 16:53:30] _train_one_epoch in BasicTrainer:
loss = 3.9559364171255202
INFO    [11-24 16:53:31] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [11-24 16:53:32] validate in BasicTrainer:
{'Recall@10': 0.18414572067558765, 'NDCG@10': 0.10150739923119545, 'MRR@10': 0.07631443394348025, 'Recall@5': 0.12979789450764656, 'NDCG@5': 0.08394605247303843, 'MRR@5': 0.06907835369929671, 'Recall*@10': 0.18414572067558765, 'NDCG*@10': 0.10150739923119545, 'MRR*@10': 0.07631443394348025, 'Recall*@5': 0.12979789450764656, 'NDCG*@5': 0.08394605247303843, 'MRR*@5': 0.06907835369929671}
INFO    [11-24 16:53:32] train in BasicTrainer:
duration: 6.401373624801636s
INFO    [11-24 16:53:32] train in BasicTrainer:
epoch: 29
INFO    [11-24 16:53:36] _train_one_epoch in BasicTrainer:
loss = 3.933158703077407
INFO    [11-24 16:53:38] validate in BasicTrainer:
{'Recall@10': 0.17643936909735203, 'NDCG@10': 0.0979450773447752, 'MRR@10': 0.0739775262773037, 'Recall@5': 0.12345023825764656, 'NDCG@5': 0.08101495821028948, 'MRR@5': 0.06710859900340438, 'Recall*@10': 0.17643936909735203, 'NDCG*@10': 0.0979450773447752, 'MRR*@10': 0.0739775262773037, 'Recall*@5': 0.12345023825764656, 'NDCG*@5': 0.08101495821028948, 'MRR*@5': 0.06710859900340438}
INFO    [11-24 16:53:38] train in BasicTrainer:
duration: 6.341348886489868s
INFO    [11-24 16:53:38] train in BasicTrainer:
epoch: 30
INFO    [11-24 16:53:43] _train_one_epoch in BasicTrainer:
loss = 3.914031465848287
INFO    [11-24 16:53:44] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [11-24 16:53:44] validate in BasicTrainer:
{'Recall@10': 0.1799634862691164, 'NDCG@10': 0.10154932830482721, 'MRR@10': 0.07747805304825306, 'Recall@5': 0.12667714059352875, 'NDCG@5': 0.08442916860803962, 'MRR@5': 0.07048304425552487, 'Recall*@10': 0.1799634862691164, 'NDCG*@10': 0.10154932830482721, 'MRR*@10': 0.07747805304825306, 'Recall*@5': 0.12667714059352875, 'NDCG*@5': 0.08442916860803962, 'MRR*@5': 0.07048304425552487}
INFO    [11-24 16:53:44] train in BasicTrainer:
duration: 6.387985706329346s
INFO    [11-24 16:53:44] train in BasicTrainer:
epoch: 31
INFO    [11-24 16:53:49] _train_one_epoch in BasicTrainer:
loss = 3.8972360633668446
INFO    [11-24 16:53:51] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [11-24 16:53:51] validate in BasicTrainer:
{'Recall@10': 0.1832540761679411, 'NDCG@10': 0.10321766044944525, 'MRR@10': 0.07890300918370485, 'Recall@5': 0.12841796875, 'NDCG@5': 0.08570921141654253, 'MRR@5': 0.07180918985977769, 'Recall*@10': 0.1832540761679411, 'NDCG*@10': 0.10321766044944525, 'MRR*@10': 0.07890300918370485, 'Recall*@5': 0.12841796875, 'NDCG*@5': 0.08570921141654253, 'MRR*@5': 0.07180918985977769}
INFO    [11-24 16:53:51] train in BasicTrainer:
duration: 6.392962217330933s
INFO    [11-24 16:53:51] train in BasicTrainer:
epoch: 32
INFO    [11-24 16:53:56] _train_one_epoch in BasicTrainer:
loss = 3.8776182594753448
INFO    [11-24 16:53:57] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [11-24 16:53:57] validate in BasicTrainer:
{'Recall@10': 0.18677819333970547, 'NDCG@10': 0.10648345295339823, 'MRR@10': 0.08210819913074374, 'Recall@5': 0.1257854960858822, 'NDCG@5': 0.08659351523965597, 'MRR@5': 0.0738030057400465, 'Recall*@10': 0.18677819333970547, 'NDCG*@10': 0.10648345295339823, 'MRR*@10': 0.08210819913074374, 'Recall*@5': 0.1257854960858822, 'NDCG*@5': 0.08659351523965597, 'MRR*@5': 0.0738030057400465}
INFO    [11-24 16:53:57] train in BasicTrainer:
duration: 6.473934650421143s
INFO    [11-24 16:53:57] train in BasicTrainer:
epoch: 33
DEBUG   [11-24 16:53:59] calculate_loss in loss:
soft_target max: 0.5020851492881775, argmax 299652
DEBUG   [11-24 16:53:59] calculate_loss in loss:
pred max in softmax: 0.1472053825855255, argmax 779270
DEBUG   [11-24 16:53:59] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 540982
DEBUG   [11-24 16:53:59] calculate_loss in loss:
pred max in softmax: 0.19505347311496735, argmax 833096
INFO    [11-24 16:54:02] _train_one_epoch in BasicTrainer:
loss = 3.858739366985503
INFO    [11-24 16:54:04] validate in BasicTrainer:
{'Recall@10': 0.18140709958970547, 'NDCG@10': 0.10207432229071856, 'MRR@10': 0.07795469276607037, 'Recall@5': 0.11886464059352875, 'NDCG@5': 0.08173324493691325, 'MRR@5': 0.0694962227717042, 'Recall*@10': 0.18140709958970547, 'NDCG*@10': 0.10207432229071856, 'MRR*@10': 0.07795469276607037, 'Recall*@5': 0.11886464059352875, 'NDCG*@5': 0.08173324493691325, 'MRR*@5': 0.0694962227717042}
INFO    [11-24 16:54:04] train in BasicTrainer:
duration: 6.597685098648071s
INFO    [11-24 16:54:04] train in BasicTrainer:
epoch: 34
INFO    [11-24 16:54:09] _train_one_epoch in BasicTrainer:
loss = 3.841884532428923
INFO    [11-24 16:54:10] validate in BasicTrainer:
{'Recall@10': 0.1837423574179411, 'NDCG@10': 0.10502203833311796, 'MRR@10': 0.08099181903526187, 'Recall@5': 0.13009510934352875, 'NDCG@5': 0.08781365398317575, 'MRR@5': 0.07397319516167045, 'Recall*@10': 0.1837423574179411, 'NDCG*@10': 0.10502203833311796, 'MRR*@10': 0.08099181903526187, 'Recall*@5': 0.13009510934352875, 'NDCG*@5': 0.08781365398317575, 'MRR*@5': 0.07397319516167045}
INFO    [11-24 16:54:10] train in BasicTrainer:
duration: 6.300177097320557s
INFO    [11-24 16:54:10] train in BasicTrainer:
epoch: 35
INFO    [11-24 16:54:15] _train_one_epoch in BasicTrainer:
loss = 3.824575544538952
INFO    [11-24 16:54:17] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [11-24 16:54:17] validate in BasicTrainer:
{'Recall@10': 0.1918308436870575, 'NDCG@10': 0.10893640294671059, 'MRR@10': 0.08374912431463599, 'Recall@5': 0.12960682809352875, 'NDCG@5': 0.08896820154041052, 'MRR@5': 0.07559266267344356, 'Recall*@10': 0.1918308436870575, 'NDCG*@10': 0.10893640294671059, 'MRR*@10': 0.08374912431463599, 'Recall*@5': 0.12960682809352875, 'NDCG*@5': 0.08896820154041052, 'MRR*@5': 0.07559266267344356}
INFO    [11-24 16:54:17] train in BasicTrainer:
duration: 6.544939041137695s
INFO    [11-24 16:54:17] train in BasicTrainer:
epoch: 36
INFO    [11-24 16:54:21] _train_one_epoch in BasicTrainer:
loss = 3.810510395822071
INFO    [11-24 16:54:23] validate in BasicTrainer:
{'Recall@10': 0.19193699024617672, 'NDCG@10': 0.10838885512202978, 'MRR@10': 0.08304721489548683, 'Recall@5': 0.13243036717176437, 'NDCG@5': 0.0895632323808968, 'MRR@5': 0.07551942020654678, 'Recall*@10': 0.19193699024617672, 'NDCG*@10': 0.10838885512202978, 'MRR*@10': 0.08304721489548683, 'Recall*@5': 0.13243036717176437, 'NDCG*@5': 0.0895632323808968, 'MRR*@5': 0.07551942020654678}
INFO    [11-24 16:54:23] train in BasicTrainer:
duration: 6.182960510253906s
INFO    [11-24 16:54:23] train in BasicTrainer:
epoch: 37
INFO    [11-24 16:54:28] _train_one_epoch in BasicTrainer:
loss = 3.7954153526396976
INFO    [11-24 16:54:29] validate in BasicTrainer:
{'Recall@10': 0.1874363124370575, 'NDCG@10': 0.10664729215204716, 'MRR@10': 0.08186013344675303, 'Recall@5': 0.13270635157823563, 'NDCG@5': 0.08885142765939236, 'MRR@5': 0.07446254044771194, 'Recall*@10': 0.1874363124370575, 'NDCG*@10': 0.10664729215204716, 'MRR*@10': 0.08186013344675303, 'Recall*@5': 0.13270635157823563, 'NDCG*@5': 0.08885142765939236, 'MRR*@5': 0.07446254044771194}
INFO    [11-24 16:54:29] train in BasicTrainer:
duration: 6.225140571594238s
INFO    [11-24 16:54:29] train in BasicTrainer:
epoch: 38
DEBUG   [11-24 16:54:30] calculate_loss in loss:
soft_target max: 0.5020851492881775, argmax 350710
DEBUG   [11-24 16:54:30] calculate_loss in loss:
pred max in softmax: 0.1924992799758911, argmax 756549
DEBUG   [11-24 16:54:30] calculate_loss in loss:
soft_target max: 0.5020193457603455, argmax 210273
DEBUG   [11-24 16:54:30] calculate_loss in loss:
pred max in softmax: 0.24821892380714417, argmax 566057
INFO    [11-24 16:54:34] _train_one_epoch in BasicTrainer:
loss = 3.7777885527837842
INFO    [11-24 16:54:35] validate in BasicTrainer:
{'Recall@10': 0.18578040041029453, 'NDCG@10': 0.10715414956212044, 'MRR@10': 0.08311589900404215, 'Recall@5': 0.12901239842176437, 'NDCG@5': 0.08887554053217173, 'MRR@5': 0.07561495248228312, 'Recall*@10': 0.18578040041029453, 'NDCG*@10': 0.10715414956212044, 'MRR*@10': 0.08311589900404215, 'Recall*@5': 0.12901239842176437, 'NDCG*@5': 0.08887554053217173, 'MRR*@5': 0.07561495248228312}
INFO    [11-24 16:54:35] train in BasicTrainer:
duration: 6.392709970474243s
INFO    [11-24 16:54:35] train in BasicTrainer:
epoch: 39
INFO    [11-24 16:54:40] _train_one_epoch in BasicTrainer:
loss = 3.7633882091158912
INFO    [11-24 16:54:42] validate in BasicTrainer:
{'Recall@10': 0.18754245899617672, 'NDCG@10': 0.10789618361741304, 'MRR@10': 0.08337997924536467, 'Recall@5': 0.134765625, 'NDCG@5': 0.09080660622566938, 'MRR@5': 0.0763169452548027, 'Recall*@10': 0.18754245899617672, 'NDCG*@10': 0.10789618361741304, 'MRR*@10': 0.08337997924536467, 'Recall*@5': 0.134765625, 'NDCG*@5': 0.09080660622566938, 'MRR*@5': 0.0763169452548027}
INFO    [11-24 16:54:42] train in BasicTrainer:
duration: 6.384052753448486s
INFO    [11-24 16:54:42] train in BasicTrainer:
epoch: 40
INFO    [11-24 16:54:47] _train_one_epoch in BasicTrainer:
loss = 3.7459329491569884
INFO    [11-24 16:54:48] validate in BasicTrainer:
{'Recall@10': 0.18501613475382328, 'NDCG@10': 0.10534265916794538, 'MRR@10': 0.08112280815839767, 'Recall@5': 0.12678328808397055, 'NDCG@5': 0.08656747080385685, 'MRR@5': 0.07340494869276881, 'Recall*@10': 0.18501613475382328, 'NDCG*@10': 0.10534265916794538, 'MRR*@10': 0.08112280815839767, 'Recall*@5': 0.12678328808397055, 'NDCG*@5': 0.08656747080385685, 'MRR*@5': 0.07340494869276881}
INFO    [11-24 16:54:48] train in BasicTrainer:
duration: 6.369375228881836s
INFO    [11-24 16:54:48] train in BasicTrainer:
epoch: 41
INFO    [11-24 16:54:53] _train_one_epoch in BasicTrainer:
loss = 3.734041389964876
INFO    [11-24 16:54:54] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [11-24 16:54:54] validate in BasicTrainer:
{'Recall@10': 0.19212805666029453, 'NDCG@10': 0.10926351137459278, 'MRR@10': 0.08391882572323084, 'Recall@5': 0.13389521092176437, 'NDCG@5': 0.09055519104003906, 'MRR@5': 0.07626953301951289, 'Recall*@10': 0.19212805666029453, 'NDCG*@10': 0.10926351137459278, 'MRR*@10': 0.08391882572323084, 'Recall*@5': 0.13389521092176437, 'NDCG*@5': 0.09055519104003906, 'MRR*@5': 0.07626953301951289}
INFO    [11-24 16:54:54] train in BasicTrainer:
duration: 6.371490955352783s
INFO    [11-24 16:54:54] train in BasicTrainer:
epoch: 42
DEBUG   [11-24 16:54:59] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 821801
DEBUG   [11-24 16:54:59] calculate_loss in loss:
pred max in softmax: 0.2878928780555725, argmax 629196
DEBUG   [11-24 16:54:59] calculate_loss in loss:
soft_target max: 0.5020851492881775, argmax 172007
DEBUG   [11-24 16:54:59] calculate_loss in loss:
pred max in softmax: 0.3451891541481018, argmax 798470
INFO    [11-24 16:54:59] _train_one_epoch in BasicTrainer:
loss = 3.721079299563453
INFO    [11-24 16:55:01] validate in BasicTrainer:
{'Recall@10': 0.18803074024617672, 'NDCG@10': 0.10670958925038576, 'MRR@10': 0.08166465256363153, 'Recall@5': 0.1345745585858822, 'NDCG@5': 0.08937952667474747, 'MRR@5': 0.07449048943817616, 'Recall*@10': 0.18803074024617672, 'NDCG*@10': 0.10670958925038576, 'MRR*@10': 0.08166465256363153, 'Recall*@5': 0.1345745585858822, 'NDCG*@5': 0.08937952667474747, 'MRR*@5': 0.07449048943817616}
INFO    [11-24 16:55:01] train in BasicTrainer:
duration: 6.421383380889893s
INFO    [11-24 16:55:01] train in BasicTrainer:
epoch: 43
INFO    [11-24 16:55:06] _train_one_epoch in BasicTrainer:
loss = 3.707539263225737
INFO    [11-24 16:55:07] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [11-24 16:55:08] validate in BasicTrainer:
{'Recall@10': 0.1937839686870575, 'NDCG@10': 0.11193637736141682, 'MRR@10': 0.08691584970802069, 'Recall@5': 0.13758916407823563, 'NDCG@5': 0.09402447007596493, 'MRR@5': 0.07968007074669003, 'Recall*@10': 0.1937839686870575, 'NDCG*@10': 0.11193637736141682, 'MRR*@10': 0.08691584970802069, 'Recall*@5': 0.13758916407823563, 'NDCG*@5': 0.09402447007596493, 'MRR*@5': 0.07968007074669003}
INFO    [11-24 16:55:08] train in BasicTrainer:
duration: 6.637510061264038s
INFO    [11-24 16:55:08] train in BasicTrainer:
epoch: 44
INFO    [11-24 16:55:12] _train_one_epoch in BasicTrainer:
loss = 3.6930886575153896
INFO    [11-24 16:55:14] validate in BasicTrainer:
{'Recall@10': 0.18900730274617672, 'NDCG@10': 0.11050114780664444, 'MRR@10': 0.08653297461569309, 'Recall@5': 0.13058339059352875, 'NDCG@5': 0.0917104659602046, 'MRR@5': 0.07883477909490466, 'Recall*@10': 0.18900730274617672, 'NDCG*@10': 0.11050114780664444, 'MRR*@10': 0.08653297461569309, 'Recall*@5': 0.13058339059352875, 'NDCG*@5': 0.0917104659602046, 'MRR*@5': 0.07883477909490466}
INFO    [11-24 16:55:14] train in BasicTrainer:
duration: 6.273530006408691s
INFO    [11-24 16:55:14] train in BasicTrainer:
epoch: 45
INFO    [11-24 16:55:19] _train_one_epoch in BasicTrainer:
loss = 3.6765942437308174
INFO    [11-24 16:55:20] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [11-24 16:55:20] validate in BasicTrainer:
{'Recall@10': 0.19340183399617672, 'NDCG@10': 0.11411704123020172, 'MRR@10': 0.08984160982072353, 'Recall@5': 0.1388629414141178, 'NDCG@5': 0.09659674018621445, 'MRR@5': 0.08267556969076395, 'Recall*@10': 0.19340183399617672, 'NDCG*@10': 0.11411704123020172, 'MRR*@10': 0.08984160982072353, 'Recall*@5': 0.1388629414141178, 'NDCG*@5': 0.09659674018621445, 'MRR*@5': 0.08267556969076395}
INFO    [11-24 16:55:20] train in BasicTrainer:
duration: 6.261058807373047s
INFO    [11-24 16:55:20] train in BasicTrainer:
epoch: 46
INFO    [11-24 16:55:25] _train_one_epoch in BasicTrainer:
loss = 3.6670422554016113
INFO    [11-24 16:55:26] validate in BasicTrainer:
{'Recall@10': 0.19144870899617672, 'NDCG@10': 0.11285917460918427, 'MRR@10': 0.08859759196639061, 'Recall@5': 0.14393682032823563, 'NDCG@5': 0.09755338169634342, 'MRR@5': 0.08231218997389078, 'Recall*@10': 0.19144870899617672, 'NDCG*@10': 0.11285917460918427, 'MRR*@10': 0.08859759196639061, 'Recall*@5': 0.14393682032823563, 'NDCG*@5': 0.09755338169634342, 'MRR*@5': 0.08231218997389078}
INFO    [11-24 16:55:26] train in BasicTrainer:
duration: 6.351885080337524s
INFO    [11-24 16:55:26] train in BasicTrainer:
epoch: 47
DEBUG   [11-24 16:55:30] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 241928
DEBUG   [11-24 16:55:30] calculate_loss in loss:
pred max in softmax: 0.23273421823978424, argmax 20954
DEBUG   [11-24 16:55:30] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 44990
DEBUG   [11-24 16:55:30] calculate_loss in loss:
pred max in softmax: 0.3721526265144348, argmax 550513
INFO    [11-24 16:55:31] _train_one_epoch in BasicTrainer:
loss = 3.6523693504787627
INFO    [11-24 16:55:33] validate in BasicTrainer:
{'Recall@10': 0.18998386524617672, 'NDCG@10': 0.1131855295971036, 'MRR@10': 0.08952543325722218, 'Recall@5': 0.14149541407823563, 'NDCG@5': 0.09758350998163223, 'MRR@5': 0.08313130028545856, 'Recall*@10': 0.18998386524617672, 'NDCG*@10': 0.1131855295971036, 'MRR*@10': 0.08952543325722218, 'Recall*@5': 0.14149541407823563, 'NDCG*@5': 0.09758350998163223, 'MRR*@5': 0.08313130028545856}
INFO    [11-24 16:55:33] train in BasicTrainer:
duration: 6.375910758972168s
INFO    [11-24 16:55:33] train in BasicTrainer:
epoch: 48
INFO    [11-24 16:55:38] _train_one_epoch in BasicTrainer:
loss = 3.6411511341730756
INFO    [11-24 16:55:39] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [11-24 16:55:39] validate in BasicTrainer:
{'Recall@10': 0.1973930038511753, 'NDCG@10': 0.11506188474595547, 'MRR@10': 0.08974026422947645, 'Recall@5': 0.1417926289141178, 'NDCG@5': 0.09720748383551836, 'MRR@5': 0.0824427530169487, 'Recall*@10': 0.1973930038511753, 'NDCG*@10': 0.11506188474595547, 'MRR*@10': 0.08974026422947645, 'Recall*@5': 0.1417926289141178, 'NDCG*@5': 0.09720748383551836, 'MRR*@5': 0.0824427530169487}
INFO    [11-24 16:55:39] train in BasicTrainer:
duration: 6.438876152038574s
INFO    [11-24 16:55:39] train in BasicTrainer:
epoch: 49
INFO    [11-24 16:55:44] _train_one_epoch in BasicTrainer:
loss = 3.632553584235055
INFO    [11-24 16:55:46] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [11-24 16:55:46] validate in BasicTrainer:
{'Recall@10': 0.19603430666029453, 'NDCG@10': 0.1151288878172636, 'MRR@10': 0.09019340854138136, 'Recall@5': 0.1433423925191164, 'NDCG@5': 0.0981126232072711, 'MRR@5': 0.08318861853331327, 'Recall*@10': 0.19603430666029453, 'NDCG*@10': 0.1151288878172636, 'MRR*@10': 0.09019340854138136, 'Recall*@5': 0.1433423925191164, 'NDCG*@5': 0.0981126232072711, 'MRR*@5': 0.08318861853331327}
INFO    [11-24 16:55:46] train in BasicTrainer:
duration: 6.3777430057525635s
INFO    [11-24 16:55:46] train in BasicTrainer:
epoch: 50
INFO    [11-24 16:55:51] _train_one_epoch in BasicTrainer:
loss = 3.6221977744783675
INFO    [11-24 16:55:52] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [11-24 16:55:52] validate in BasicTrainer:
{'Recall@10': 0.1964164413511753, 'NDCG@10': 0.11783603765070438, 'MRR@10': 0.09373242221772671, 'Recall@5': 0.1409009862691164, 'NDCG@5': 0.09995532035827637, 'MRR@5': 0.08639500010758638, 'Recall*@10': 0.1964164413511753, 'NDCG*@10': 0.11783603765070438, 'MRR*@10': 0.09373242221772671, 'Recall*@5': 0.1409009862691164, 'NDCG*@5': 0.09995532035827637, 'MRR*@5': 0.08639500010758638}
INFO    [11-24 16:55:52] train in BasicTrainer:
duration: 6.357095241546631s
INFO    [11-24 16:55:52] train in BasicTrainer:
epoch: 51
INFO    [11-24 16:55:57] _train_one_epoch in BasicTrainer:
loss = 3.610820882661002
INFO    [11-24 16:55:58] validate in BasicTrainer:
{'Recall@10': 0.1889011561870575, 'NDCG@10': 0.11234750133007765, 'MRR@10': 0.08871923107653856, 'Recall@5': 0.14070991799235344, 'NDCG@5': 0.0968230552971363, 'MRR@5': 0.08234828058630228, 'Recall*@10': 0.1889011561870575, 'NDCG*@10': 0.11234750133007765, 'MRR*@10': 0.08871923107653856, 'Recall*@5': 0.14070991799235344, 'NDCG*@5': 0.0968230552971363, 'MRR*@5': 0.08234828058630228}
INFO    [11-24 16:55:58] train in BasicTrainer:
duration: 6.3249831199646s
INFO    [11-24 16:55:58] train in BasicTrainer:
epoch: 52
DEBUG   [11-24 16:56:00] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 260163
DEBUG   [11-24 16:56:00] calculate_loss in loss:
pred max in softmax: 0.3614216148853302, argmax 325562
DEBUG   [11-24 16:56:00] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 147106
DEBUG   [11-24 16:56:00] calculate_loss in loss:
pred max in softmax: 0.36812469363212585, argmax 536086
INFO    [11-24 16:56:03] _train_one_epoch in BasicTrainer:
loss = 3.5986773002715338
INFO    [11-24 16:56:05] validate in BasicTrainer:
{'Recall@10': 0.19367782026529312, 'NDCG@10': 0.11712204944342375, 'MRR@10': 0.09353644214570522, 'Recall@5': 0.14168648049235344, 'NDCG@5': 0.10022945702075958, 'MRR@5': 0.08652167022228241, 'Recall*@10': 0.19367782026529312, 'NDCG*@10': 0.11712204944342375, 'MRR*@10': 0.09353644214570522, 'Recall*@5': 0.14168648049235344, 'NDCG*@5': 0.10022945702075958, 'MRR*@5': 0.08652167022228241}
INFO    [11-24 16:56:05] train in BasicTrainer:
duration: 6.222880125045776s
INFO    [11-24 16:56:05] train in BasicTrainer:
epoch: 53
INFO    [11-24 16:56:09] _train_one_epoch in BasicTrainer:
loss = 3.590118408203125
INFO    [11-24 16:56:11] validate in BasicTrainer:
{'Recall@10': 0.19357167184352875, 'NDCG@10': 0.1143572898581624, 'MRR@10': 0.09005097486078739, 'Recall@5': 0.1409009862691164, 'NDCG@5': 0.0974250677973032, 'MRR@5': 0.08312033209949732, 'Recall*@10': 0.19357167184352875, 'NDCG*@10': 0.1143572898581624, 'MRR*@10': 0.09005097486078739, 'Recall*@5': 0.1409009862691164, 'NDCG*@5': 0.0974250677973032, 'MRR*@5': 0.08312033209949732}
INFO    [11-24 16:56:11] train in BasicTrainer:
duration: 6.234548091888428s
INFO    [11-24 16:56:11] train in BasicTrainer:
epoch: 54
INFO    [11-24 16:56:16] _train_one_epoch in BasicTrainer:
loss = 3.578840142204648
INFO    [11-24 16:56:17] validate in BasicTrainer:
{'Recall@10': 0.19669242575764656, 'NDCG@10': 0.11659691389650106, 'MRR@10': 0.09204664546996355, 'Recall@5': 0.14372452534735203, 'NDCG@5': 0.09941831324249506, 'MRR@5': 0.08492803294211626, 'Recall*@10': 0.19669242575764656, 'NDCG*@10': 0.11659691389650106, 'MRR*@10': 0.09204664546996355, 'Recall*@5': 0.14372452534735203, 'NDCG*@5': 0.09941831324249506, 'MRR*@5': 0.08492803294211626}
INFO    [11-24 16:56:17] train in BasicTrainer:
duration: 6.124436616897583s
INFO    [11-24 16:56:17] train in BasicTrainer:
epoch: 55
INFO    [11-24 16:56:22] _train_one_epoch in BasicTrainer:
loss = 3.5673457543055216
INFO    [11-24 16:56:23] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [11-24 16:56:23] validate in BasicTrainer:
{'Recall@10': 0.20089589059352875, 'NDCG@10': 0.11967330612242222, 'MRR@10': 0.09471892192959785, 'Recall@5': 0.1428541112691164, 'NDCG@5': 0.1008535036817193, 'MRR@5': 0.08692220132797956, 'Recall*@10': 0.20089589059352875, 'NDCG*@10': 0.11967330612242222, 'MRR*@10': 0.09471892192959785, 'Recall*@5': 0.1428541112691164, 'NDCG*@5': 0.1008535036817193, 'MRR*@5': 0.08692220132797956}
INFO    [11-24 16:56:23] train in BasicTrainer:
duration: 6.5146777629852295s
INFO    [11-24 16:56:23] train in BasicTrainer:
epoch: 56
INFO    [11-24 16:56:28] _train_one_epoch in BasicTrainer:
loss = 3.55967435496194
INFO    [11-24 16:56:30] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [11-24 16:56:30] validate in BasicTrainer:
{'Recall@10': 0.20314623042941093, 'NDCG@10': 0.12003286648541689, 'MRR@10': 0.09476914070546627, 'Recall@5': 0.14030655659735203, 'NDCG@5': 0.09973664954304695, 'MRR@5': 0.08640879951417446, 'Recall*@10': 0.20314623042941093, 'NDCG*@10': 0.12003286648541689, 'MRR*@10': 0.09476914070546627, 'Recall*@5': 0.14030655659735203, 'NDCG*@5': 0.09973664954304695, 'MRR*@5': 0.08640879951417446}
INFO    [11-24 16:56:30] train in BasicTrainer:
duration: 6.359567403793335s
INFO    [11-24 16:56:30] train in BasicTrainer:
epoch: 57
DEBUG   [11-24 16:56:31] calculate_loss in loss:
soft_target max: 0.5020851492881775, argmax 26127
DEBUG   [11-24 16:56:31] calculate_loss in loss:
pred max in softmax: 0.2368175983428955, argmax 752090
DEBUG   [11-24 16:56:31] calculate_loss in loss:
soft_target max: 0.5020193457603455, argmax 348859
DEBUG   [11-24 16:56:31] calculate_loss in loss:
pred max in softmax: 0.2557032108306885, argmax 527910
INFO    [11-24 16:56:35] _train_one_epoch in BasicTrainer:
loss = 3.548268295469738
INFO    [11-24 16:56:36] validate in BasicTrainer:
{'Recall@10': 0.20274286717176437, 'NDCG@10': 0.11917287483811378, 'MRR@10': 0.09360215533524752, 'Recall@5': 0.14548658393323421, 'NDCG@5': 0.10072787385433912, 'MRR@5': 0.08602772746235132, 'Recall*@10': 0.20274286717176437, 'NDCG*@10': 0.11917287483811378, 'MRR*@10': 0.09360215533524752, 'Recall*@5': 0.14548658393323421, 'NDCG*@5': 0.10072787385433912, 'MRR*@5': 0.08602772746235132}
INFO    [11-24 16:56:36] train in BasicTrainer:
duration: 6.243152618408203s
INFO    [11-24 16:56:36] train in BasicTrainer:
epoch: 58
INFO    [11-24 16:56:41] _train_one_epoch in BasicTrainer:
loss = 3.5395736569450014
INFO    [11-24 16:56:42] validate in BasicTrainer:
{'Recall@10': 0.1962253749370575, 'NDCG@10': 0.1168969813734293, 'MRR@10': 0.09245756454765797, 'Recall@5': 0.14372452534735203, 'NDCG@5': 0.09982300084084272, 'MRR@5': 0.0853526247665286, 'Recall*@10': 0.1962253749370575, 'NDCG*@10': 0.1168969813734293, 'MRR*@10': 0.09245756454765797, 'Recall*@5': 0.14372452534735203, 'NDCG*@5': 0.09982300084084272, 'MRR*@5': 0.0853526247665286}
INFO    [11-24 16:56:42] train in BasicTrainer:
duration: 6.302072525024414s
INFO    [11-24 16:56:42] train in BasicTrainer:
epoch: 59
INFO    [11-24 16:56:47] _train_one_epoch in BasicTrainer:
loss = 3.536049356914702
INFO    [11-24 16:56:49] validate in BasicTrainer:
{'Recall@10': 0.19921875, 'NDCG@10': 0.11798415798693895, 'MRR@10': 0.09298884402960539, 'Recall@5': 0.14429772458970547, 'NDCG@5': 0.10009468346834183, 'MRR@5': 0.08552918583154678, 'Recall*@10': 0.19921875, 'NDCG*@10': 0.11798415798693895, 'MRR*@10': 0.09298884402960539, 'Recall*@5': 0.14429772458970547, 'NDCG*@5': 0.10009468346834183, 'MRR*@5': 0.08552918583154678}
INFO    [11-24 16:56:49] train in BasicTrainer:
duration: 6.3335161209106445s
INFO    [11-24 16:56:49] train in BasicTrainer:
epoch: 60
INFO    [11-24 16:56:54] _train_one_epoch in BasicTrainer:
loss = 3.5199964954739524
INFO    [11-24 16:56:55] validate in BasicTrainer:
{'Recall@10': 0.2000042460858822, 'NDCG@10': 0.11864613741636276, 'MRR@10': 0.09370484482496977, 'Recall@5': 0.14215353317558765, 'NDCG@5': 0.10001128260046244, 'MRR@5': 0.08605462033301592, 'Recall*@10': 0.2000042460858822, 'NDCG*@10': 0.11864613741636276, 'MRR*@10': 0.09370484482496977, 'Recall*@5': 0.14215353317558765, 'NDCG*@5': 0.10001128260046244, 'MRR*@5': 0.08605462033301592}
INFO    [11-24 16:56:55] train in BasicTrainer:
duration: 6.212530851364136s
INFO    [11-24 16:56:55] train in BasicTrainer:
epoch: 61
DEBUG   [11-24 16:56:59] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 176282
DEBUG   [11-24 16:56:59] calculate_loss in loss:
pred max in softmax: 0.5529845952987671, argmax 112055
DEBUG   [11-24 16:56:59] calculate_loss in loss:
soft_target max: 0.5020851492881775, argmax 175654
DEBUG   [11-24 16:56:59] calculate_loss in loss:
pred max in softmax: 0.21326234936714172, argmax 629810
INFO    [11-24 16:57:00] _train_one_epoch in BasicTrainer:
loss = 3.511361393474397
INFO    [11-24 16:57:01] validate in BasicTrainer:
{'Recall@10': 0.19652258791029453, 'NDCG@10': 0.11867911275476217, 'MRR@10': 0.09455080237239599, 'Recall@5': 0.15034816600382328, 'NDCG@5': 0.10378126241266727, 'MRR@5': 0.08842702955007553, 'Recall*@10': 0.19652258791029453, 'NDCG*@10': 0.11867911275476217, 'MRR*@10': 0.09455080237239599, 'Recall*@5': 0.15034816600382328, 'NDCG*@5': 0.10378126241266727, 'MRR*@5': 0.08842702955007553}
INFO    [11-24 16:57:01] train in BasicTrainer:
duration: 6.288472414016724s
INFO    [11-24 16:57:01] train in BasicTrainer:
epoch: 62
INFO    [11-24 16:57:06] _train_one_epoch in BasicTrainer:
loss = 3.507195224080767
INFO    [11-24 16:57:07] log in loggers:
Update Best NDCG@10 Model at 62
INFO    [11-24 16:57:07] validate in BasicTrainer:
{'Recall@10': 0.20284901559352875, 'NDCG@10': 0.12023288756608963, 'MRR@10': 0.09489615634083748, 'Recall@5': 0.14684527926146984, 'NDCG@5': 0.10239799972623587, 'MRR@5': 0.08770026825368404, 'Recall*@10': 0.20284901559352875, 'NDCG*@10': 0.12023288756608963, 'MRR*@10': 0.09489615634083748, 'Recall*@5': 0.14684527926146984, 'NDCG*@5': 0.10239799972623587, 'MRR*@5': 0.08770026825368404}
INFO    [11-24 16:57:07] train in BasicTrainer:
duration: 6.273496150970459s
INFO    [11-24 16:57:07] train in BasicTrainer:
epoch: 63
INFO    [11-24 16:57:12] _train_one_epoch in BasicTrainer:
loss = 3.494383884611584
INFO    [11-24 16:57:14] log in loggers:
Update Best NDCG@10 Model at 63
INFO    [11-24 16:57:14] validate in BasicTrainer:
{'Recall@10': 0.2068401835858822, 'NDCG@10': 0.1203130753710866, 'MRR@10': 0.0936721870675683, 'Recall@5': 0.14966881833970547, 'NDCG@5': 0.10166541766375303, 'MRR@5': 0.08588477969169617, 'Recall*@10': 0.2068401835858822, 'NDCG*@10': 0.1203130753710866, 'MRR*@10': 0.0936721870675683, 'Recall*@5': 0.14966881833970547, 'NDCG*@5': 0.10166541766375303, 'MRR*@5': 0.08588477969169617}
INFO    [11-24 16:57:14] train in BasicTrainer:
duration: 6.418878555297852s
INFO    [11-24 16:57:14] train in BasicTrainer:
epoch: 64
INFO    [11-24 16:57:19] _train_one_epoch in BasicTrainer:
loss = 3.491573568752834
INFO    [11-24 16:57:20] log in loggers:
Update Best NDCG@10 Model at 64
INFO    [11-24 16:57:20] validate in BasicTrainer:
{'Recall@10': 0.20363451167941093, 'NDCG@10': 0.12099117785692215, 'MRR@10': 0.09575364831835032, 'Recall@5': 0.14344853907823563, 'NDCG@5': 0.1015618247911334, 'MRR@5': 0.0877522798255086, 'Recall*@10': 0.20363451167941093, 'NDCG*@10': 0.12099117785692215, 'MRR*@10': 0.09575364831835032, 'Recall*@5': 0.14344853907823563, 'NDCG*@5': 0.1015618247911334, 'MRR*@5': 0.0877522798255086}
INFO    [11-24 16:57:20] train in BasicTrainer:
duration: 6.393682479858398s
INFO    [11-24 16:57:20] train in BasicTrainer:
epoch: 65
INFO    [11-24 16:57:25] _train_one_epoch in BasicTrainer:
loss = 3.480839157104492
INFO    [11-24 16:57:27] log in loggers:
Update Best NDCG@10 Model at 65
INFO    [11-24 16:57:27] validate in BasicTrainer:
{'Recall@10': 0.20382557809352875, 'NDCG@10': 0.12214720994234085, 'MRR@10': 0.09709164500236511, 'Recall@5': 0.1467603612691164, 'NDCG@5': 0.10377340856939554, 'MRR@5': 0.08955467492341995, 'Recall*@10': 0.20382557809352875, 'NDCG*@10': 0.12214720994234085, 'MRR*@10': 0.09709164500236511, 'Recall*@5': 0.1467603612691164, 'NDCG*@5': 0.10377340856939554, 'MRR*@5': 0.08955467492341995}
INFO    [11-24 16:57:27] train in BasicTrainer:
duration: 6.578001260757446s
INFO    [11-24 16:57:27] train in BasicTrainer:
epoch: 66
DEBUG   [11-24 16:57:30] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 128871
DEBUG   [11-24 16:57:30] calculate_loss in loss:
pred max in softmax: 0.32091638445854187, argmax 483742
DEBUG   [11-24 16:57:30] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 292986
DEBUG   [11-24 16:57:30] calculate_loss in loss:
pred max in softmax: 0.2857392728328705, argmax 758358
INFO    [11-24 16:57:32] _train_one_epoch in BasicTrainer:
loss = 3.476766591980344
INFO    [11-24 16:57:33] validate in BasicTrainer:
{'Recall@10': 0.20021654292941093, 'NDCG@10': 0.12074063066393137, 'MRR@10': 0.09628460090607405, 'Recall@5': 0.15153702534735203, 'NDCG@5': 0.10497544426470995, 'MRR@5': 0.08976520411670208, 'Recall*@10': 0.20021654292941093, 'NDCG*@10': 0.12074063066393137, 'MRR*@10': 0.09628460090607405, 'Recall*@5': 0.15153702534735203, 'NDCG*@5': 0.10497544426470995, 'MRR*@5': 0.08976520411670208}
INFO    [11-24 16:57:33] train in BasicTrainer:
duration: 6.381097316741943s
INFO    [11-24 16:57:33] train in BasicTrainer:
epoch: 67
INFO    [11-24 16:57:38] _train_one_epoch in BasicTrainer:
loss = 3.4676420484270367
INFO    [11-24 16:57:39] log in loggers:
Update Best NDCG@10 Model at 67
INFO    [11-24 16:57:39] validate in BasicTrainer:
{'Recall@10': 0.20754076167941093, 'NDCG@10': 0.12539879884570837, 'MRR@10': 0.10014871787279844, 'Recall@5': 0.15289572067558765, 'NDCG@5': 0.10787149518728256, 'MRR@5': 0.09299210552126169, 'Recall*@10': 0.20754076167941093, 'NDCG*@10': 0.12539879884570837, 'MRR*@10': 0.10014871787279844, 'Recall*@5': 0.15289572067558765, 'NDCG*@5': 0.10787149518728256, 'MRR*@5': 0.09299210552126169}
INFO    [11-24 16:57:39] train in BasicTrainer:
duration: 6.291539430618286s
INFO    [11-24 16:57:39] train in BasicTrainer:
epoch: 68
INFO    [11-24 16:57:44] _train_one_epoch in BasicTrainer:
loss = 3.4596165248325894
INFO    [11-24 16:57:46] validate in BasicTrainer:
{'Recall@10': 0.20734969526529312, 'NDCG@10': 0.12504351790994406, 'MRR@10': 0.09973233751952648, 'Recall@5': 0.15446671284735203, 'NDCG@5': 0.10807112604379654, 'MRR@5': 0.09280953090637922, 'Recall*@10': 0.20734969526529312, 'NDCG*@10': 0.12504351790994406, 'MRR*@10': 0.09973233751952648, 'Recall*@5': 0.15446671284735203, 'NDCG*@5': 0.10807112604379654, 'MRR*@5': 0.09280953090637922}
INFO    [11-24 16:57:46] train in BasicTrainer:
duration: 6.365137338638306s
INFO    [11-24 16:57:46] train in BasicTrainer:
epoch: 69
INFO    [11-24 16:57:51] _train_one_epoch in BasicTrainer:
loss = 3.4515171664101736
INFO    [11-24 16:57:52] log in loggers:
Update Best NDCG@10 Model at 69
INFO    [11-24 16:57:52] validate in BasicTrainer:
{'Recall@10': 0.20480214059352875, 'NDCG@10': 0.1268331604078412, 'MRR@10': 0.1026976965367794, 'Recall@5': 0.15718410350382328, 'NDCG@5': 0.11154284980148077, 'MRR@5': 0.09645324014127254, 'Recall*@10': 0.20480214059352875, 'NDCG*@10': 0.1268331604078412, 'MRR*@10': 0.1026976965367794, 'Recall*@5': 0.15718410350382328, 'NDCG*@5': 0.11154284980148077, 'MRR*@5': 0.09645324014127254}
INFO    [11-24 16:57:52] train in BasicTrainer:
duration: 6.449407339096069s
INFO    [11-24 16:57:52] train in BasicTrainer:
epoch: 70
INFO    [11-24 16:57:57] _train_one_epoch in BasicTrainer:
loss = 3.4452660526548113
INFO    [11-24 16:57:59] validate in BasicTrainer:
{'Recall@10': 0.20040760934352875, 'NDCG@10': 0.12246240675449371, 'MRR@10': 0.09849765338003635, 'Recall@5': 0.15181300975382328, 'NDCG@5': 0.10685478337109089, 'MRR@5': 0.09211815241724253, 'Recall*@10': 0.20040760934352875, 'NDCG*@10': 0.12246240675449371, 'MRR*@10': 0.09849765338003635, 'Recall*@5': 0.15181300975382328, 'NDCG*@5': 0.10685478337109089, 'MRR*@5': 0.09211815241724253}
INFO    [11-24 16:57:59] train in BasicTrainer:
duration: 6.269963264465332s
INFO    [11-24 16:57:59] train in BasicTrainer:
epoch: 71
DEBUG   [11-24 16:58:01] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 690509
DEBUG   [11-24 16:58:01] calculate_loss in loss:
pred max in softmax: 0.4408157467842102, argmax 659152
DEBUG   [11-24 16:58:01] calculate_loss in loss:
soft_target max: 0.5020851492881775, argmax 299652
DEBUG   [11-24 16:58:01] calculate_loss in loss:
pred max in softmax: 0.4465944170951843, argmax 710001
INFO    [11-24 16:58:03] _train_one_epoch in BasicTrainer:
loss = 3.436824183236985
INFO    [11-24 16:58:05] validate in BasicTrainer:
{'Recall@10': 0.20548148825764656, 'NDCG@10': 0.1261797845363617, 'MRR@10': 0.10175110027194023, 'Recall@5': 0.1529806386679411, 'NDCG@5': 0.10910734627395868, 'MRR@5': 0.09465049114078283, 'Recall*@10': 0.20548148825764656, 'NDCG*@10': 0.1261797845363617, 'MRR*@10': 0.10175110027194023, 'Recall*@5': 0.1529806386679411, 'NDCG*@5': 0.10910734627395868, 'MRR*@5': 0.09465049114078283}
INFO    [11-24 16:58:05] train in BasicTrainer:
duration: 6.174633502960205s
INFO    [11-24 16:58:05] train in BasicTrainer:
epoch: 72
INFO    [11-24 16:58:10] _train_one_epoch in BasicTrainer:
loss = 3.432988528978257
INFO    [11-24 16:58:11] validate in BasicTrainer:
{'Recall@10': 0.20333729684352875, 'NDCG@10': 0.12574501056224108, 'MRR@10': 0.10173773020505905, 'Recall@5': 0.15474269725382328, 'NDCG@5': 0.11016316153109074, 'MRR@5': 0.09537902195006609, 'Recall*@10': 0.20333729684352875, 'NDCG*@10': 0.12574501056224108, 'MRR*@10': 0.10173773020505905, 'Recall*@5': 0.15474269725382328, 'NDCG*@5': 0.11016316153109074, 'MRR*@5': 0.09537902195006609}
INFO    [11-24 16:58:11] train in BasicTrainer:
duration: 6.450112819671631s
INFO    [11-24 16:58:11] train in BasicTrainer:
epoch: 73
INFO    [11-24 16:58:16] _train_one_epoch in BasicTrainer:
loss = 3.421777472041902
INFO    [11-24 16:58:18] validate in BasicTrainer:
{'Recall@10': 0.20548148825764656, 'NDCG@10': 0.12645830772817135, 'MRR@10': 0.10187605954706669, 'Recall@5': 0.15864894725382328, 'NDCG@5': 0.11127710714936256, 'MRR@5': 0.09558813646435738, 'Recall*@10': 0.20548148825764656, 'NDCG*@10': 0.12645830772817135, 'MRR*@10': 0.10187605954706669, 'Recall*@5': 0.15864894725382328, 'NDCG*@5': 0.11127710714936256, 'MRR*@5': 0.09558813646435738}
INFO    [11-24 16:58:18] train in BasicTrainer:
duration: 6.38487982749939s
INFO    [11-24 16:58:18] train in BasicTrainer:
epoch: 74
INFO    [11-24 16:58:22] _train_one_epoch in BasicTrainer:
loss = 3.4195890029271445
INFO    [11-24 16:58:24] log in loggers:
Update Best NDCG@10 Model at 74
INFO    [11-24 16:58:24] validate in BasicTrainer:
{'Recall@10': 0.20957880467176437, 'NDCG@10': 0.12688201759010553, 'MRR@10': 0.10139025561511517, 'Recall@5': 0.15856402926146984, 'NDCG@5': 0.1104148281738162, 'MRR@5': 0.09461015556007624, 'Recall*@10': 0.20957880467176437, 'NDCG*@10': 0.12688201759010553, 'MRR*@10': 0.10139025561511517, 'Recall*@5': 0.15856402926146984, 'NDCG*@5': 0.1104148281738162, 'MRR*@5': 0.09461015556007624}
INFO    [11-24 16:58:24] train in BasicTrainer:
duration: 6.450838327407837s
INFO    [11-24 16:58:24] train in BasicTrainer:
epoch: 75
INFO    [11-24 16:58:29] _train_one_epoch in BasicTrainer:
loss = 3.408655682064238
INFO    [11-24 16:58:30] validate in BasicTrainer:
{'Recall@10': 0.2063519023358822, 'NDCG@10': 0.12635724246501923, 'MRR@10': 0.10168169997632504, 'Recall@5': 0.1583517324179411, 'NDCG@5': 0.11111665237694979, 'MRR@5': 0.09555770363658667, 'Recall*@10': 0.2063519023358822, 'NDCG*@10': 0.12635724246501923, 'MRR*@10': 0.10168169997632504, 'Recall*@5': 0.1583517324179411, 'NDCG*@5': 0.11111665237694979, 'MRR*@5': 0.09555770363658667}
INFO    [11-24 16:58:30] train in BasicTrainer:
duration: 6.318478345870972s
INFO    [11-24 16:58:30] train in BasicTrainer:
epoch: 76
DEBUG   [11-24 16:58:32] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 646745
DEBUG   [11-24 16:58:32] calculate_loss in loss:
pred max in softmax: 0.3001435697078705, argmax 771623
DEBUG   [11-24 16:58:32] calculate_loss in loss:
soft_target max: 0.5027381181716919, argmax 916623
DEBUG   [11-24 16:58:32] calculate_loss in loss:
pred max in softmax: 0.4931779205799103, argmax 520760
INFO    [11-24 16:58:35] _train_one_epoch in BasicTrainer:
loss = 3.4076540924253917
INFO    [11-24 16:58:37] log in loggers:
Update Best NDCG@10 Model at 76
INFO    [11-24 16:58:37] validate in BasicTrainer:
{'Recall@10': 0.20401664450764656, 'NDCG@10': 0.12760394159704447, 'MRR@10': 0.10405377019196749, 'Recall@5': 0.15474269725382328, 'NDCG@5': 0.11161594279110432, 'MRR@5': 0.09742944967001677, 'Recall*@10': 0.20401664450764656, 'NDCG*@10': 0.12760394159704447, 'MRR*@10': 0.10405377019196749, 'Recall*@5': 0.15474269725382328, 'NDCG*@5': 0.11161594279110432, 'MRR*@5': 0.09742944967001677}
INFO    [11-24 16:58:37] train in BasicTrainer:
duration: 6.420430421829224s
INFO    [11-24 16:58:37] train in BasicTrainer:
epoch: 77
INFO    [11-24 16:58:42] _train_one_epoch in BasicTrainer:
loss = 3.3982703322455996
INFO    [11-24 16:58:43] validate in BasicTrainer:
{'Recall@10': 0.20480214059352875, 'NDCG@10': 0.12469651829451323, 'MRR@10': 0.09990195836871862, 'Recall@5': 0.1559103261679411, 'NDCG@5': 0.10895442590117455, 'MRR@5': 0.09344712644815445, 'Recall*@10': 0.20480214059352875, 'NDCG*@10': 0.12469651829451323, 'MRR*@10': 0.09990195836871862, 'Recall*@5': 0.1559103261679411, 'NDCG*@5': 0.10895442590117455, 'MRR*@5': 0.09344712644815445}
INFO    [11-24 16:58:43] train in BasicTrainer:
duration: 6.3450539112091064s
INFO    [11-24 16:58:43] train in BasicTrainer:
epoch: 78
INFO    [11-24 16:58:48] _train_one_epoch in BasicTrainer:
loss = 3.394298028945923
INFO    [11-24 16:58:49] log in loggers:
Update Best NDCG@10 Model at 78
INFO    [11-24 16:58:49] validate in BasicTrainer:
{'Recall@10': 0.20333729684352875, 'NDCG@10': 0.12801888585090637, 'MRR@10': 0.10477820690721273, 'Recall@5': 0.1561013925820589, 'NDCG@5': 0.11291055474430323, 'MRR@5': 0.0986370611935854, 'Recall*@10': 0.20333729684352875, 'NDCG*@10': 0.12801888585090637, 'MRR*@10': 0.10477820690721273, 'Recall*@5': 0.1561013925820589, 'NDCG*@5': 0.11291055474430323, 'MRR*@5': 0.0986370611935854}
INFO    [11-24 16:58:49] train in BasicTrainer:
duration: 6.253482103347778s
INFO    [11-24 16:58:49] train in BasicTrainer:
epoch: 79
INFO    [11-24 16:58:54] _train_one_epoch in BasicTrainer:
loss = 3.3885010072163175
INFO    [11-24 16:58:56] log in loggers:
Update Best NDCG@10 Model at 79
INFO    [11-24 16:58:56] validate in BasicTrainer:
{'Recall@10': 0.2097698710858822, 'NDCG@10': 0.12830737326294184, 'MRR@10': 0.10319814551621675, 'Recall@5': 0.1598165761679411, 'NDCG@5': 0.1121806837618351, 'MRR@5': 0.09655691217631102, 'Recall*@10': 0.2097698710858822, 'NDCG*@10': 0.12830737326294184, 'MRR*@10': 0.10319814551621675, 'Recall*@5': 0.1598165761679411, 'NDCG*@5': 0.1121806837618351, 'MRR*@5': 0.09655691217631102}
INFO    [11-24 16:58:56] train in BasicTrainer:
duration: 6.341359615325928s
INFO    [11-24 16:58:56] close_training in BasicTrainer:
finished training
DEBUG   [11-24 16:58:56] debug_summary in loss:
loss nan summary: nan 0 times, not nan 16801 times, ratio nan / (nan + not_nan) = 0.0
INFO    [11-24 16:58:56] run_routine in Routine:
Finished training, Start final validation
INFO    [11-24 16:58:56] final_validate in BasicTrainer:
validate model on val set!
INFO    [11-24 16:58:56] load_state_from_given_path in utils:
checkpoint epoch: 79
INFO    [11-24 16:58:56] load_state_from_given_path in utils:
Loading model's parameters
INFO    [11-24 16:58:57] validate in BasicTrainer:
{'Recall@10': 0.2097698710858822, 'NDCG@10': 0.12830737326294184, 'MRR@10': 0.10319814551621675, 'Recall@5': 0.1598165761679411, 'NDCG@5': 0.1121806837618351, 'MRR@5': 0.09655691217631102, 'Recall*@10': 0.2097698710858822, 'NDCG*@10': 0.12830737326294184, 'MRR*@10': 0.10319814551621675, 'Recall*@5': 0.1598165761679411, 'NDCG*@5': 0.1121806837618351, 'MRR*@5': 0.09655691217631102}
INFO    [11-24 16:58:57] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.2097698710858822, 'NDCG@10': 0.12830737326294184, 'MRR@10': 0.10319814551621675, 'Recall@5': 0.1598165761679411, 'NDCG@5': 0.1121806837618351, 'MRR@5': 0.09655691217631102, 'Recall*@10': 0.2097698710858822, 'NDCG*@10': 0.12830737326294184, 'MRR*@10': 0.10319814551621675, 'Recall*@5': 0.1598165761679411, 'NDCG*@5': 0.1121806837618351, 'MRR*@5': 0.09655691217631102}
INFO    [11-24 16:58:57] _evaluate in DistillSched:
Start testing student model on test set
INFO    [11-24 16:58:57] test in BasicTrainer:
Test model on test set!
INFO    [11-24 16:58:57] test_with_given_state_path in BasicTrainer:
Loading model params from ___lfms_soft_len/soft_gru4rec-len-40_11-24_16:50_t4/student_gru4rec_logs/checkpoint/best_acc_model.pth.
INFO    [11-24 16:58:57] load_state_from_given_path in utils:
checkpoint epoch: 79
INFO    [11-24 16:58:57] load_state_from_given_path in utils:
Loading model's parameters
INFO    [11-24 16:58:57] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [11-24 16:58:58] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.17047384567558765, 'NDCG@10': 0.10230306070297956, 'MRR@10': 0.08133995532989502, 'Recall@5': 0.12236752733588219, 'NDCG@5': 0.08658827841281891, 'MRR@5': 0.07476399978622794, 'Recall*@10': 0.17047384567558765, 'NDCG*@10': 0.10230306070297956, 'MRR*@10': 0.08133995532989502, 'Recall*@5': 0.12236752733588219, 'NDCG*@5': 0.08658827841281891, 'MRR*@5': 0.07476399978622794}
INFO    [11-24 16:58:58] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.17047384567558765, 'NDCG@10': 0.10230306070297956, 'MRR@10': 0.08133995532989502, 'Recall@5': 0.12236752733588219, 'NDCG@5': 0.08658827841281891, 'MRR@5': 0.07476399978622794, 'Recall*@10': 0.17047384567558765, 'NDCG*@10': 0.10230306070297956, 'MRR*@10': 0.08133995532989502, 'Recall*@5': 0.12236752733588219, 'NDCG*@5': 0.08658827841281891, 'MRR*@5': 0.07476399978622794}
