INFO    [05-06 23:49:38] setup_train in utils:
{
    "experiment_dir": "___yelp_soft_2020",
    "experiment_description": "pop",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "yelp.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "alpha": 0.25,
    "T": 6,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2020,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.yelp/narm/config_distill.json",
    "task_id": -1,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "dvae_alpha": 0.5,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-06 23:49:38] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-06 23:49:38] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/yelp-5-5.pkl
INFO    [05-06 23:49:39] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-06 23:49:39] _check_dataset_cache in utils:
correct.
INFO    [05-06 23:49:39] __init__ in NextItemDataloader:
there are 20033 items in this dataset, 43947 users, padding_first? False
DEBUG   [05-06 23:49:46] generate_model in utils:
model_code_list=['pop']
INFO    [05-06 23:49:46] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-06 23:49:46] load_model_config in utils:
{}
WARNING [05-06 23:49:51] get_exist_path in utils:
dir ___yelp_soft_2020/pop_narm-T-6-al-0.25_05-06_23:49_0/teacher_pop_logs does not exist! Create one.
WARNING [05-06 23:49:51] get_exist_path in utils:
dir ___yelp_soft_2020/pop_narm-T-6-al-0.25_05-06_23:49_0/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-06 23:49:51] get_exist_path in utils:
dir ___yelp_soft_2020/pop_narm-T-6-al-0.25_05-06_23:49_0/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-06 23:49:51] get_path in utils:
Path is None
WARNING [05-06 23:49:51] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-06 23:49:51] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-06 23:49:51] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-06 23:49:51] __init__ in BasicTrainer:
229376 iter per epoch
DEBUG   [05-06 23:49:51] generate_model in utils:
model_code_list=['narm']
INFO    [05-06 23:49:51] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-06 23:49:51] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-06 23:49:54] get_exist_path in utils:
dir ___yelp_soft_2020/pop_narm-T-6-al-0.25_05-06_23:49_0/student_narm_logs does not exist! Create one.
WARNING [05-06 23:49:54] get_exist_path in utils:
dir ___yelp_soft_2020/pop_narm-T-6-al-0.25_05-06_23:49_0/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-06 23:49:54] get_exist_path in utils:
dir ___yelp_soft_2020/pop_narm-T-6-al-0.25_05-06_23:49_0/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-06 23:49:54] get_path in utils:
Path is None
WARNING [05-06 23:49:54] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-06 23:49:54] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(20034, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-06 23:49:54] assert_model_device in utils:
model student_narm has 5.3603515625 MB params.
INFO    [05-06 23:49:54] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-06 23:49:54] __init__ in DistillTrainer:
229376 iter per epoch
INFO    [05-06 23:49:54] _set_current_routine in Routine:
first routine: student
INFO    [05-06 23:49:54] run_routine in Routine:
Start routine student
INFO    [05-06 23:49:54] run_routine in Routine:
Start training
INFO    [05-06 23:49:54] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-06 23:50:13] test_mentor in DistillTrainer:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-06 23:50:13] train in DistillTrainer:
result:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-06 23:50:32] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-06 23:50:32] validate in BasicTrainer:
{'Recall@10': 0.0006766047180545601, 'NDCG@10': 0.00029780428965089163, 'MRR@10': 0.0001856484926644374, 'Recall@5': 0.00034115934712727636, 'NDCG@5': 0.00019322107651863587, 'MRR@5': 0.00014479222690252672, 'Recall*@10': 0.0006766047180545601, 'NDCG*@10': 0.00029780428965089163, 'MRR*@10': 0.0001856484926644374, 'Recall*@5': 0.00034115934712727636, 'NDCG*@5': 0.00019322107651863587, 'MRR*@5': 0.00014479222690252672}
INFO    [05-06 23:50:32] train in BasicTrainer:
epoch: 0
DEBUG   [05-06 23:50:33] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 4234309
DEBUG   [05-06 23:50:33] calculate_loss in loss:
pred max in softmax: 5.0048762204824015e-05, argmax 70463018
INFO    [05-06 23:50:42] _train_one_epoch in BasicTrainer:
loss = 8.468602112361364
INFO    [05-06 23:51:06] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-06 23:51:06] validate in BasicTrainer:
{'Recall@10': 0.009013415991582653, 'NDCG@10': 0.004723697371611541, 'MRR@10': 0.0034498829733241687, 'Recall@5': 0.00547184253280813, 'NDCG@5': 0.003608858699656346, 'MRR@5': 0.003007342086427591, 'Recall*@10': 0.009013415991582653, 'NDCG*@10': 0.004723697371611541, 'MRR*@10': 0.0034498829733241687, 'Recall*@5': 0.00547184253280813, 'NDCG*@5': 0.003608858699656346, 'MRR*@5': 0.003007342086427591}
INFO    [05-06 23:51:06] train in BasicTrainer:
duration: 33.45365524291992s
INFO    [05-06 23:51:06] train in BasicTrainer:
epoch: 1
INFO    [05-06 23:51:16] _train_one_epoch in BasicTrainer:
loss = 7.9450609258243015
INFO    [05-06 23:51:40] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-06 23:51:40] validate in BasicTrainer:
{'Recall@10': 0.020306619561531326, 'NDCG@10': 0.010103016583756967, 'MRR@10': 0.007042567499659278, 'Recall@5': 0.011971012096513401, 'NDCG@5': 0.0074223164807666435, 'MRR@5': 0.0059449592266570435, 'Recall*@10': 0.020306619561531326, 'NDCG*@10': 0.010103016583756967, 'MRR*@10': 0.007042567499659278, 'Recall*@5': 0.011971012096513401, 'NDCG*@5': 0.0074223164807666435, 'MRR*@5': 0.0059449592266570435}
INFO    [05-06 23:51:40] train in BasicTrainer:
duration: 33.95113134384155s
INFO    [05-06 23:51:40] train in BasicTrainer:
epoch: 2
INFO    [05-06 23:51:50] _train_one_epoch in BasicTrainer:
loss = 7.519412645271847
INFO    [05-06 23:52:09] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-06 23:52:09] validate in BasicTrainer:
{'Recall@10': 0.025959867984056473, 'NDCG@10': 0.013196742754768242, 'MRR@10': 0.00939889286052097, 'Recall@5': 0.014850596389309927, 'NDCG@5': 0.00966837155548009, 'MRR@5': 0.007979702162133022, 'Recall*@10': 0.025959867984056473, 'NDCG*@10': 0.013196742754768242, 'MRR*@10': 0.00939889286052097, 'Recall*@5': 0.014850596389309927, 'NDCG*@5': 0.00966837155548009, 'MRR*@5': 0.007979702162133022}
INFO    [05-06 23:52:09] train in BasicTrainer:
duration: 29.59683609008789s
INFO    [05-06 23:52:09] train in BasicTrainer:
epoch: 3
INFO    [05-06 23:52:19] _train_one_epoch in BasicTrainer:
loss = 7.3064588734081815
INFO    [05-06 23:52:43] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-06 23:52:43] validate in BasicTrainer:
{'Recall@10': 0.031174819239161232, 'NDCG@10': 0.015838056040758438, 'MRR@10': 0.011247697540304878, 'Recall@5': 0.018198132345622235, 'NDCG@5': 0.011677104133096609, 'MRR@5': 0.009550903923809528, 'Recall*@10': 0.031174819239161232, 'NDCG*@10': 0.015838056040758438, 'MRR*@10': 0.011247697540304878, 'Recall*@5': 0.018198132345622235, 'NDCG*@5': 0.011677104133096609, 'MRR*@5': 0.009550903923809528}
INFO    [05-06 23:52:43] train in BasicTrainer:
duration: 34.04455876350403s
INFO    [05-06 23:52:43] train in BasicTrainer:
epoch: 4
INFO    [05-06 23:52:54] _train_one_epoch in BasicTrainer:
loss = 7.179397353104183
INFO    [05-06 23:53:12] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-06 23:53:13] validate in BasicTrainer:
{'Recall@10': 0.037160325456749306, 'NDCG@10': 0.018820978531783276, 'MRR@10': 0.013324744914743033, 'Recall@5': 0.021822770210829647, 'NDCG@5': 0.013912010853263464, 'MRR@5': 0.0113282979212024, 'Recall*@10': 0.037160325456749306, 'NDCG*@10': 0.018820978531783276, 'MRR*@10': 0.013324744914743033, 'Recall*@5': 0.021822770210829647, 'NDCG*@5': 0.013912010853263464, 'MRR*@5': 0.0113282979212024}
INFO    [05-06 23:53:13] train in BasicTrainer:
duration: 29.17591142654419s
INFO    [05-06 23:53:13] train in BasicTrainer:
epoch: 5
INFO    [05-06 23:53:23] _train_one_epoch in BasicTrainer:
loss = 7.050324354852949
INFO    [05-06 23:53:47] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-06 23:53:47] validate in BasicTrainer:
{'Recall@10': 0.04450607740066268, 'NDCG@10': 0.02313155359165235, 'MRR@10': 0.01673099339346994, 'Recall@5': 0.026710635389794003, 'NDCG@5': 0.017418921332467686, 'MRR@5': 0.014397558925504034, 'Recall*@10': 0.04450607740066268, 'NDCG*@10': 0.02313155359165235, 'MRR*@10': 0.01673099339346994, 'Recall*@5': 0.026710635389794003, 'NDCG*@5': 0.017418921332467686, 'MRR*@5': 0.014397558925504034}
INFO    [05-06 23:53:47] train in BasicTrainer:
duration: 34.27981948852539s
INFO    [05-06 23:53:47] train in BasicTrainer:
epoch: 6
INFO    [05-06 23:53:57] _train_one_epoch in BasicTrainer:
loss = 6.932628180299487
INFO    [05-06 23:54:20] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-06 23:54:20] validate in BasicTrainer:
{'Recall@10': 0.048359036445617676, 'NDCG@10': 0.025305499238046734, 'MRR@10': 0.018361760134046726, 'Recall@5': 0.030238254673101685, 'NDCG@5': 0.01949685337868604, 'MRR@5': 0.01599401794373989, 'Recall*@10': 0.048359036445617676, 'NDCG*@10': 0.025305499238046734, 'MRR*@10': 0.018361760134046726, 'Recall*@5': 0.030238254673101685, 'NDCG*@5': 0.01949685337868604, 'MRR*@5': 0.01599401794373989}
INFO    [05-06 23:54:20] train in BasicTrainer:
duration: 32.878741979599s
INFO    [05-06 23:54:20] train in BasicTrainer:
epoch: 7
INFO    [05-06 23:54:30] _train_one_epoch in BasicTrainer:
loss = 6.8239965949739725
INFO    [05-06 23:54:54] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-06 23:54:54] validate in BasicTrainer:
{'Recall@10': 0.052523923868482765, 'NDCG@10': 0.027947230941869995, 'MRR@10': 0.020562744106758724, 'Recall@5': 0.032737343148751694, 'NDCG@5': 0.02159750766374848, 'MRR@5': 0.0179710802198811, 'Recall*@10': 0.052523923868482765, 'NDCG*@10': 0.027947230941869995, 'MRR*@10': 0.020562744106758724, 'Recall*@5': 0.032737343148751694, 'NDCG*@5': 0.02159750766374848, 'MRR*@5': 0.0179710802198811}
INFO    [05-06 23:54:54] train in BasicTrainer:
duration: 33.98484826087952s
INFO    [05-06 23:54:54] train in BasicTrainer:
epoch: 8
INFO    [05-06 23:55:04] _train_one_epoch in BasicTrainer:
loss = 6.732970944472721
INFO    [05-06 23:55:23] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-06 23:55:23] validate in BasicTrainer:
{'Recall@10': 0.056723756207661194, 'NDCG@10': 0.030729607086290012, 'MRR@10': 0.022916163910518993, 'Recall@5': 0.035519247366623444, 'NDCG@5': 0.02393971857699481, 'MRR@5': 0.020153193311257797, 'Recall*@10': 0.056723756207661194, 'NDCG*@10': 0.030729607086290012, 'MRR*@10': 0.022916163910518993, 'Recall*@5': 0.035519247366623444, 'NDCG*@5': 0.02393971857699481, 'MRR*@5': 0.020153193311257797}
INFO    [05-06 23:55:23] train in BasicTrainer:
duration: 29.50243902206421s
INFO    [05-06 23:55:23] train in BasicTrainer:
epoch: 9
INFO    [05-06 23:55:33] _train_one_epoch in BasicTrainer:
loss = 6.648831478187016
INFO    [05-06 23:55:53] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-06 23:55:53] validate in BasicTrainer:
{'Recall@10': 0.061562722379511055, 'NDCG@10': 0.03378494896671989, 'MRR@10': 0.025408405302600426, 'Recall@5': 0.03980148312720386, 'NDCG@5': 0.026832629503174263, 'MRR@5': 0.022588642991401932, 'Recall*@10': 0.061562722379511055, 'NDCG*@10': 0.03378494896671989, 'MRR*@10': 0.025408405302600426, 'Recall*@5': 0.03980148312720386, 'NDCG*@5': 0.026832629503174263, 'MRR*@5': 0.022588642991401932}
INFO    [05-06 23:55:53] train in BasicTrainer:
duration: 30.123741626739502s
INFO    [05-06 23:55:53] train in BasicTrainer:
epoch: 10
INFO    [05-06 23:56:04] _train_one_epoch in BasicTrainer:
loss = 6.569929080350058
INFO    [05-06 23:56:25] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-06 23:56:25] validate in BasicTrainer:
{'Recall@10': 0.06450702520934018, 'NDCG@10': 0.03611050918698311, 'MRR@10': 0.027517491612922062, 'Recall@5': 0.04243692654100331, 'NDCG@5': 0.02899917350573973, 'MRR@5': 0.024597815999930554, 'Recall*@10': 0.06450702520934018, 'NDCG*@10': 0.03611050918698311, 'MRR*@10': 0.027517491612922062, 'Recall*@5': 0.04243692654100331, 'NDCG*@5': 0.02899917350573973, 'MRR*@5': 0.024597815999930554}
INFO    [05-06 23:56:25] train in BasicTrainer:
duration: 32.177273750305176s
INFO    [05-06 23:56:25] train in BasicTrainer:
epoch: 11
INFO    [05-06 23:56:35] _train_one_epoch in BasicTrainer:
loss = 6.494392071451459
INFO    [05-06 23:56:54] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-06 23:56:55] validate in BasicTrainer:
{'Recall@10': 0.06702698563987558, 'NDCG@10': 0.03802142292261124, 'MRR@10': 0.029261259531432934, 'Recall@5': 0.04422007399526509, 'NDCG@5': 0.030694760382175446, 'MRR@5': 0.026266178285533733, 'Recall*@10': 0.06702698563987558, 'NDCG*@10': 0.03802142292261124, 'MRR*@10': 0.029261259531432934, 'Recall*@5': 0.04422007399526509, 'NDCG*@5': 0.030694760382175446, 'MRR*@5': 0.026266178285533733}
INFO    [05-06 23:56:55] train in BasicTrainer:
duration: 29.073692321777344s
INFO    [05-06 23:56:55] train in BasicTrainer:
epoch: 12
INFO    [05-06 23:57:04] _train_one_epoch in BasicTrainer:
loss = 6.423613360949925
INFO    [05-06 23:57:23] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-06 23:57:23] validate in BasicTrainer:
{'Recall@10': 0.06924073194915598, 'NDCG@10': 0.039526590569452805, 'MRR@10': 0.030550645833665676, 'Recall@5': 0.04605837674303488, 'NDCG@5': 0.032080088488080284, 'MRR@5': 0.02750669081102718, 'Recall*@10': 0.06924073194915598, 'NDCG*@10': 0.039526590569452805, 'MRR*@10': 0.030550645833665676, 'Recall*@5': 0.04605837674303488, 'NDCG*@5': 0.032080088488080284, 'MRR*@5': 0.02750669081102718}
INFO    [05-06 23:57:23] train in BasicTrainer:
duration: 28.70583200454712s
INFO    [05-06 23:57:23] train in BasicTrainer:
epoch: 13
INFO    [05-06 23:57:33] _train_one_epoch in BasicTrainer:
loss = 6.357083737850189
INFO    [05-06 23:57:57] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-06 23:57:57] validate in BasicTrainer:
{'Recall@10': 0.0703955123370344, 'NDCG@10': 0.0406373722309416, 'MRR@10': 0.03162845122543248, 'Recall@5': 0.047484545545144516, 'NDCG@5': 0.033282625234939835, 'MRR@5': 0.028624385764653034, 'Recall*@10': 0.0703955123370344, 'NDCG*@10': 0.0406373722309416, 'MRR*@10': 0.03162845122543248, 'Recall*@5': 0.047484545545144516, 'NDCG*@5': 0.033282625234939835, 'MRR*@5': 0.028624385764653034}
INFO    [05-06 23:57:57] train in BasicTrainer:
duration: 33.97068500518799s
INFO    [05-06 23:57:57] train in BasicTrainer:
epoch: 14
INFO    [05-06 23:58:07] _train_one_epoch in BasicTrainer:
loss = 6.2972211582320075
INFO    [05-06 23:58:26] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-06 23:58:26] validate in BasicTrainer:
{'Recall@10': 0.07216404378414154, 'NDCG@10': 0.041920118711211464, 'MRR@10': 0.03276489895175804, 'Recall@5': 0.04958984492854639, 'NDCG@5': 0.034691985019228676, 'MRR@5': 0.029823448847640644, 'Recall*@10': 0.07216404378414154, 'NDCG*@10': 0.041920118711211464, 'MRR*@10': 0.03276489895175804, 'Recall*@5': 0.04958984492854639, 'NDCG*@5': 0.034691985019228676, 'MRR*@5': 0.029823448847640644}
INFO    [05-06 23:58:26] train in BasicTrainer:
duration: 28.955931186676025s
INFO    [05-06 23:58:26] train in BasicTrainer:
epoch: 15
INFO    [05-06 23:58:36] _train_one_epoch in BasicTrainer:
loss = 6.237017282417843
INFO    [05-06 23:58:55] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-06 23:58:55] validate in BasicTrainer:
{'Recall@10': 0.07401948896321384, 'NDCG@10': 0.04383628205819563, 'MRR@10': 0.03469865024089813, 'Recall@5': 0.05132421173832633, 'NDCG@5': 0.03653584319082173, 'MRR@5': 0.031708127057010475, 'Recall*@10': 0.07401948896321384, 'NDCG*@10': 0.04383628205819563, 'MRR*@10': 0.03469865024089813, 'Recall*@5': 0.05132421173832633, 'NDCG*@5': 0.03653584319082173, 'MRR*@5': 0.031708127057010475}
INFO    [05-06 23:58:55] train in BasicTrainer:
duration: 28.894740343093872s
INFO    [05-06 23:58:55] train in BasicTrainer:
epoch: 16
INFO    [05-06 23:59:06] _train_one_epoch in BasicTrainer:
loss = 6.185174584388733
INFO    [05-06 23:59:29] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-06 23:59:29] validate in BasicTrainer:
{'Recall@10': 0.07612039758400484, 'NDCG@10': 0.045026753775098106, 'MRR@10': 0.0355989160862836, 'Recall@5': 0.05253920060667125, 'NDCG@5': 0.03744435073299841, 'MRR@5': 0.03249529901553284, 'Recall*@10': 0.07612039758400484, 'NDCG*@10': 0.045026753775098106, 'MRR*@10': 0.0355989160862836, 'Recall*@5': 0.05253920060667125, 'NDCG*@5': 0.03744435073299841, 'MRR*@5': 0.03249529901553284}
INFO    [05-06 23:59:29] train in BasicTrainer:
duration: 34.08982467651367s
INFO    [05-06 23:59:29] train in BasicTrainer:
epoch: 17
DEBUG   [05-06 23:59:38] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 27714157
DEBUG   [05-06 23:59:38] calculate_loss in loss:
pred max in softmax: 0.9345840811729431, argmax 57641250
DEBUG   [05-06 23:59:38] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 7359613
DEBUG   [05-06 23:59:38] calculate_loss in loss:
pred max in softmax: 0.7561654448509216, argmax 47223424
INFO    [05-06 23:59:39] _train_one_epoch in BasicTrainer:
loss = 6.135647288390568
INFO    [05-06 23:59:58] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-06 23:59:58] validate in BasicTrainer:
{'Recall@10': 0.0780753872611306, 'NDCG@10': 0.04603583975271745, 'MRR@10': 0.036309991709210655, 'Recall@5': 0.05422466790134257, 'NDCG@5': 0.0383654616095803, 'MRR@5': 0.03316858597099781, 'Recall*@10': 0.0780753872611306, 'NDCG*@10': 0.04603583975271745, 'MRR*@10': 0.036309991709210655, 'Recall*@5': 0.05422466790134257, 'NDCG*@5': 0.0383654616095803, 'MRR*@5': 0.03316858597099781}
INFO    [05-06 23:59:58] train in BasicTrainer:
duration: 28.993796586990356s
INFO    [05-06 23:59:58] train in BasicTrainer:
epoch: 18
INFO    [05-07 00:00:08] _train_one_epoch in BasicTrainer:
loss = 6.089827912194388
INFO    [05-07 00:00:32] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-07 00:00:32] validate in BasicTrainer:
{'Recall@10': 0.07997774806889621, 'NDCG@10': 0.04760581492023035, 'MRR@10': 0.0377770679240877, 'Recall@5': 0.055724999105388466, 'NDCG@5': 0.0398151200603355, 'MRR@5': 0.034592301500114525, 'Recall*@10': 0.07997774806889621, 'NDCG*@10': 0.04760581492023035, 'MRR*@10': 0.0377770679240877, 'Recall*@5': 0.055724999105388466, 'NDCG*@5': 0.0398151200603355, 'MRR*@5': 0.034592301500114525}
INFO    [05-07 00:00:32] train in BasicTrainer:
duration: 33.778860569000244s
INFO    [05-07 00:00:32] train in BasicTrainer:
epoch: 19
INFO    [05-07 00:00:42] _train_one_epoch in BasicTrainer:
loss = 6.046841297830854
INFO    [05-07 00:01:01] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-07 00:01:01] validate in BasicTrainer:
{'Recall@10': 0.08070511709560048, 'NDCG@10': 0.04831484976139935, 'MRR@10': 0.03847161070867018, 'Recall@5': 0.05658553608439185, 'NDCG@5': 0.04055824875831604, 'MRR@5': 0.03529575263912028, 'Recall*@10': 0.08070511709560048, 'NDCG*@10': 0.04831484976139935, 'MRR*@10': 0.03847161070867018, 'Recall*@5': 0.05658553608439185, 'NDCG*@5': 0.04055824875831604, 'MRR*@5': 0.03529575263912028}
INFO    [05-07 00:01:01] train in BasicTrainer:
duration: 29.031035661697388s
INFO    [05-07 00:01:01] train in BasicTrainer:
epoch: 20
INFO    [05-07 00:01:12] _train_one_epoch in BasicTrainer:
loss = 6.007522361619132
INFO    [05-07 00:01:31] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-07 00:01:31] validate in BasicTrainer:
{'Recall@10': 0.08187066424976695, 'NDCG@10': 0.0489089543169195, 'MRR@10': 0.038891862400553444, 'Recall@5': 0.05749551477757367, 'NDCG@5': 0.04105901176279241, 'MRR@5': 0.03567109087651426, 'Recall*@10': 0.08187066424976695, 'NDCG*@10': 0.0489089543169195, 'MRR*@10': 0.038891862400553444, 'Recall*@5': 0.05749551477757367, 'NDCG*@5': 0.04105901176279241, 'MRR*@5': 0.03567109087651426}
INFO    [05-07 00:01:31] train in BasicTrainer:
duration: 29.84169054031372s
INFO    [05-07 00:01:31] train in BasicTrainer:
epoch: 21
INFO    [05-07 00:01:40] _train_one_epoch in BasicTrainer:
loss = 5.966086506843567
INFO    [05-07 00:02:04] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-07 00:02:04] validate in BasicTrainer:
{'Recall@10': 0.08248892561955885, 'NDCG@10': 0.04951094192537395, 'MRR@10': 0.03948811915787784, 'Recall@5': 0.05764516307549043, 'NDCG@5': 0.04148432883349332, 'MRR@5': 0.03617927228862589, 'Recall*@10': 0.08248892561955885, 'NDCG*@10': 0.04951094192537395, 'MRR*@10': 0.03948811915787784, 'Recall*@5': 0.05764516307549043, 'NDCG*@5': 0.04148432883349332, 'MRR*@5': 0.03617927228862589}
INFO    [05-07 00:02:04] train in BasicTrainer:
duration: 33.60848951339722s
INFO    [05-07 00:02:04] train in BasicTrainer:
epoch: 22
INFO    [05-07 00:02:15] _train_one_epoch in BasicTrainer:
loss = 5.930012958390372
INFO    [05-07 00:02:38] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-07 00:02:39] validate in BasicTrainer:
{'Recall@10': 0.08282370933077553, 'NDCG@10': 0.0498999800871719, 'MRR@10': 0.03990516439080238, 'Recall@5': 0.05812454257499088, 'NDCG@5': 0.04194773767482151, 'MRR@5': 0.03664382597939535, 'Recall*@10': 0.08282370933077553, 'NDCG*@10': 0.0498999800871719, 'MRR*@10': 0.03990516439080238, 'Recall*@5': 0.05812454257499088, 'NDCG*@5': 0.04194773767482151, 'MRR*@5': 0.03664382597939535}
INFO    [05-07 00:02:39] train in BasicTrainer:
duration: 34.132370710372925s
INFO    [05-07 00:02:39] train in BasicTrainer:
epoch: 23
INFO    [05-07 00:02:49] _train_one_epoch in BasicTrainer:
loss = 5.890747504574912
INFO    [05-07 00:03:13] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-07 00:03:14] validate in BasicTrainer:
{'Recall@10': 0.083769175816666, 'NDCG@10': 0.05085119740529494, 'MRR@10': 0.0408282574604858, 'Recall@5': 0.05983605337413875, 'NDCG@5': 0.0431580702689561, 'MRR@5': 0.03768008371645754, 'Recall*@10': 0.083769175816666, 'NDCG*@10': 0.05085119740529494, 'MRR*@10': 0.0408282574604858, 'Recall*@5': 0.05983605337413875, 'NDCG*@5': 0.0431580702689561, 'MRR*@5': 0.03768008371645754}
INFO    [05-07 00:03:14] train in BasicTrainer:
duration: 35.02139329910278s
INFO    [05-07 00:03:14] train in BasicTrainer:
epoch: 24
INFO    [05-07 00:03:23] _train_one_epoch in BasicTrainer:
loss = 5.859786203929356
INFO    [05-07 00:03:42] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-07 00:03:43] validate in BasicTrainer:
{'Recall@10': 0.08522006530653346, 'NDCG@10': 0.0519807826388966, 'MRR@10': 0.041864045641639015, 'Recall@5': 0.06123365190896121, 'NDCG@5': 0.04427293620326302, 'MRR@5': 0.03871085664088076, 'Recall*@10': 0.08522006530653346, 'NDCG*@10': 0.0519807826388966, 'MRR*@10': 0.041864045641639015, 'Recall*@5': 0.06123365190896121, 'NDCG*@5': 0.04427293620326302, 'MRR*@5': 0.03871085664088076}
INFO    [05-07 00:03:43] train in BasicTrainer:
duration: 28.934917211532593s
INFO    [05-07 00:03:43] train in BasicTrainer:
epoch: 25
INFO    [05-07 00:03:53] _train_one_epoch in BasicTrainer:
loss = 5.825328579970768
INFO    [05-07 00:04:17] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-07 00:04:17] validate in BasicTrainer:
{'Recall@10': 0.08562209457159042, 'NDCG@10': 0.052368106151169, 'MRR@10': 0.04224809868769212, 'Recall@5': 0.060990172692320564, 'NDCG@5': 0.04446671462871812, 'MRR@5': 0.03902458467266776, 'Recall*@10': 0.08562209457159042, 'NDCG*@10': 0.052368106151169, 'MRR*@10': 0.04224809868769212, 'Recall*@5': 0.060990172692320564, 'NDCG*@5': 0.04446671462871812, 'MRR*@5': 0.03902458467266776}
INFO    [05-07 00:04:17] train in BasicTrainer:
duration: 34.22279500961304s
INFO    [05-07 00:04:17] train in BasicTrainer:
epoch: 26
INFO    [05-07 00:04:26] _train_one_epoch in BasicTrainer:
loss = 5.793129290853228
INFO    [05-07 00:04:45] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-07 00:04:45] validate in BasicTrainer:
{'Recall@10': 0.08671720935539766, 'NDCG@10': 0.05327061733061617, 'MRR@10': 0.04310586946931752, 'Recall@5': 0.061516467820514335, 'NDCG@5': 0.04516027495265007, 'MRR@5': 0.039781317792155525, 'Recall*@10': 0.08671720935539766, 'NDCG*@10': 0.05327061733061617, 'MRR*@10': 0.04310586946931752, 'Recall*@5': 0.061516467820514335, 'NDCG*@5': 0.04516027495265007, 'MRR*@5': 0.039781317792155525}
INFO    [05-07 00:04:45] train in BasicTrainer:
duration: 28.534803867340088s
INFO    [05-07 00:04:45] train in BasicTrainer:
epoch: 27
INFO    [05-07 00:04:55] _train_one_epoch in BasicTrainer:
loss = 5.764278914247241
INFO    [05-07 00:05:19] validate in BasicTrainer:
{'Recall@10': 0.08625364845449274, 'NDCG@10': 0.05306928909637711, 'MRR@10': 0.042988056486303154, 'Recall@5': 0.06144483150406317, 'NDCG@5': 0.045114907012744385, 'MRR@5': 0.03974568674510175, 'Recall*@10': 0.08625364845449274, 'NDCG*@10': 0.05306928909637711, 'MRR*@10': 0.042988056486303154, 'Recall*@5': 0.06144483150406317, 'NDCG*@5': 0.045114907012744385, 'MRR*@5': 0.03974568674510175}
INFO    [05-07 00:05:19] train in BasicTrainer:
duration: 34.05757141113281s
INFO    [05-07 00:05:19] train in BasicTrainer:
epoch: 28
INFO    [05-07 00:05:30] _train_one_epoch in BasicTrainer:
loss = 5.735592586653573
INFO    [05-07 00:05:53] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-07 00:05:53] validate in BasicTrainer:
{'Recall@10': 0.08661381493915211, 'NDCG@10': 0.05332496051083912, 'MRR@10': 0.043191793290051544, 'Recall@5': 0.061691498214548286, 'NDCG@5': 0.0452618267048489, 'MRR@5': 0.03986179388382218, 'Recall*@10': 0.08661381493915211, 'NDCG*@10': 0.05332496051083912, 'MRR*@10': 0.043191793290051544, 'Recall*@5': 0.061691498214548286, 'NDCG*@5': 0.0452618267048489, 'MRR*@5': 0.03986179388382218}
INFO    [05-07 00:05:53] train in BasicTrainer:
duration: 33.81797695159912s
INFO    [05-07 00:05:53] train in BasicTrainer:
epoch: 29
INFO    [05-07 00:06:04] _train_one_epoch in BasicTrainer:
loss = 5.709791566644396
INFO    [05-07 00:06:23] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-07 00:06:23] validate in BasicTrainer:
{'Recall@10': 0.08728789334947412, 'NDCG@10': 0.05399253456430002, 'MRR@10': 0.04387382384050976, 'Recall@5': 0.06251709027723833, 'NDCG@5': 0.04603517969900912, 'MRR@5': 0.04062024639411406, 'Recall*@10': 0.08728789334947412, 'NDCG*@10': 0.05399253456430002, 'MRR*@10': 0.04387382384050976, 'Recall*@5': 0.06251709027723833, 'NDCG*@5': 0.04603517969900912, 'MRR*@5': 0.04062024639411406}
INFO    [05-07 00:06:23] train in BasicTrainer:
duration: 30.318289756774902s
INFO    [05-07 00:06:23] train in BasicTrainer:
epoch: 30
INFO    [05-07 00:06:33] _train_one_epoch in BasicTrainer:
loss = 5.680062072617667
INFO    [05-07 00:06:52] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [05-07 00:06:53] validate in BasicTrainer:
{'Recall@10': 0.08802789449691772, 'NDCG@10': 0.05422473664988171, 'MRR@10': 0.04393471133979884, 'Recall@5': 0.06378470835360614, 'NDCG@5': 0.04645514826882969, 'MRR@5': 0.040768699551170524, 'Recall*@10': 0.08802789449691772, 'NDCG*@10': 0.05422473664988171, 'MRR*@10': 0.04393471133979884, 'Recall*@5': 0.06378470835360614, 'NDCG*@5': 0.04645514826882969, 'MRR*@5': 0.040768699551170524}
INFO    [05-07 00:06:53] train in BasicTrainer:
duration: 29.032641410827637s
INFO    [05-07 00:06:53] train in BasicTrainer:
epoch: 31
INFO    [05-07 00:07:03] _train_one_epoch in BasicTrainer:
loss = 5.655073872634342
INFO    [05-07 00:07:21] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-07 00:07:22] validate in BasicTrainer:
{'Recall@10': 0.08954789421775124, 'NDCG@10': 0.05489198863506317, 'MRR@10': 0.04435421187769283, 'Recall@5': 0.06416454301639037, 'NDCG@5': 0.04673283445564183, 'MRR@5': 0.041015671735460106, 'Recall*@10': 0.08954789421775124, 'NDCG*@10': 0.05489198863506317, 'MRR*@10': 0.04435421187769283, 'Recall*@5': 0.06416454301639037, 'NDCG*@5': 0.04673283445564183, 'MRR*@5': 0.041015671735460106}
INFO    [05-07 00:07:22] train in BasicTrainer:
duration: 29.11261796951294s
INFO    [05-07 00:07:22] train in BasicTrainer:
epoch: 32
INFO    [05-07 00:07:32] _train_one_epoch in BasicTrainer:
loss = 5.629764863422939
INFO    [05-07 00:07:51] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-07 00:07:51] validate in BasicTrainer:
{'Recall@10': 0.0909601084210656, 'NDCG@10': 0.05594818124716932, 'MRR@10': 0.045302455736832184, 'Recall@5': 0.06553555618632924, 'NDCG@5': 0.0477839894592762, 'MRR@5': 0.04196689108555967, 'Recall*@10': 0.0909601084210656, 'NDCG*@10': 0.05594818124716932, 'MRR*@10': 0.045302455736832184, 'Recall*@5': 0.06553555618632924, 'NDCG*@5': 0.0477839894592762, 'MRR*@5': 0.04196689108555967}
INFO    [05-07 00:07:51] train in BasicTrainer:
duration: 29.256804704666138s
INFO    [05-07 00:07:51] train in BasicTrainer:
epoch: 33
INFO    [05-07 00:08:01] _train_one_epoch in BasicTrainer:
loss = 5.605333149433136
INFO    [05-07 00:08:19] validate in BasicTrainer:
{'Recall@10': 0.09019791267134926, 'NDCG@10': 0.05583432757041671, 'MRR@10': 0.04536054114049131, 'Recall@5': 0.06507452170957219, 'NDCG@5': 0.04773324592546983, 'MRR@5': 0.04203075983307578, 'Recall*@10': 0.09019791267134926, 'NDCG*@10': 0.05583432757041671, 'MRR*@10': 0.04536054114049131, 'Recall*@5': 0.06507452170957219, 'NDCG*@5': 0.04773324592546983, 'MRR*@5': 0.04203075983307578}
INFO    [05-07 00:08:19] train in BasicTrainer:
duration: 28.344792366027832s
INFO    [05-07 00:08:19] train in BasicTrainer:
epoch: 34
INFO    [05-07 00:08:29] _train_one_epoch in BasicTrainer:
loss = 5.582897126674652
INFO    [05-07 00:08:48] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-07 00:08:48] validate in BasicTrainer:
{'Recall@10': 0.09111294421282681, 'NDCG@10': 0.05649025805971839, 'MRR@10': 0.04595761373639107, 'Recall@5': 0.06551402265375311, 'NDCG@5': 0.048250271515412765, 'MRR@5': 0.04257908057082783, 'Recall*@10': 0.09111294421282681, 'NDCG*@10': 0.05649025805971839, 'MRR*@10': 0.04595761373639107, 'Recall*@5': 0.06551402265375311, 'NDCG*@5': 0.048250271515412765, 'MRR*@5': 0.04257908057082783}
INFO    [05-07 00:08:48] train in BasicTrainer:
duration: 29.013670444488525s
INFO    [05-07 00:08:48] train in BasicTrainer:
epoch: 35
DEBUG   [05-07 00:08:55] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 7559953
DEBUG   [05-07 00:08:55] calculate_loss in loss:
pred max in softmax: 0.9394641518592834, argmax 53943705
DEBUG   [05-07 00:08:55] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 4094071
DEBUG   [05-07 00:08:55] calculate_loss in loss:
pred max in softmax: 0.8403368592262268, argmax 675203
INFO    [05-07 00:08:58] _train_one_epoch in BasicTrainer:
loss = 5.5584554587091715
INFO    [05-07 00:09:17] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-07 00:09:17] validate in BasicTrainer:
{'Recall@10': 0.09101406010714444, 'NDCG@10': 0.05651583590290763, 'MRR@10': 0.04600628770210526, 'Recall@5': 0.06619315391237085, 'NDCG@5': 0.048571215773170646, 'MRR@5': 0.04277528009631417, 'Recall*@10': 0.09101406010714444, 'NDCG*@10': 0.05651583590290763, 'MRR*@10': 0.04600628770210526, 'Recall*@5': 0.06619315391237085, 'NDCG*@5': 0.048571215773170646, 'MRR*@5': 0.04277528009631417}
INFO    [05-07 00:09:17] train in BasicTrainer:
duration: 28.467812299728394s
INFO    [05-07 00:09:17] train in BasicTrainer:
epoch: 36
INFO    [05-07 00:09:26] _train_one_epoch in BasicTrainer:
loss = 5.536782681941986
INFO    [05-07 00:09:46] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-07 00:09:46] validate in BasicTrainer:
{'Recall@10': 0.09162847223606976, 'NDCG@10': 0.05736965719949116, 'MRR@10': 0.046921187842434105, 'Recall@5': 0.06752922115000812, 'NDCG@5': 0.049649915234609085, 'MRR@5': 0.04377874156290835, 'Recall*@10': 0.09162847223606976, 'NDCG*@10': 0.05736965719949116, 'MRR*@10': 0.046921187842434105, 'Recall*@5': 0.06752922115000812, 'NDCG*@5': 0.049649915234609085, 'MRR*@5': 0.04377874156290835}
INFO    [05-07 00:09:46] train in BasicTrainer:
duration: 29.655913829803467s
INFO    [05-07 00:09:46] train in BasicTrainer:
epoch: 37
INFO    [05-07 00:09:56] _train_one_epoch in BasicTrainer:
loss = 5.514099614960807
INFO    [05-07 00:10:15] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [05-07 00:10:15] validate in BasicTrainer:
{'Recall@10': 0.09290114383805882, 'NDCG@10': 0.057847259735519234, 'MRR@10': 0.047154105861078606, 'Recall@5': 0.06762623990123923, 'NDCG@5': 0.04970120706341483, 'MRR@5': 0.04380813918330453, 'Recall*@10': 0.09290114383805882, 'NDCG*@10': 0.057847259735519234, 'MRR*@10': 0.047154105861078606, 'Recall*@5': 0.06762623990123923, 'NDCG*@5': 0.04970120706341483, 'MRR*@5': 0.04380813918330453}
INFO    [05-07 00:10:15] train in BasicTrainer:
duration: 28.92286705970764s
INFO    [05-07 00:10:15] train in BasicTrainer:
epoch: 38
INFO    [05-07 00:10:25] _train_one_epoch in BasicTrainer:
loss = 5.494002878665924
INFO    [05-07 00:10:49] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-07 00:10:49] validate in BasicTrainer:
{'Recall@10': 0.09324867820197885, 'NDCG@10': 0.05790446563200517, 'MRR@10': 0.04712926223874092, 'Recall@5': 0.06757679784839804, 'NDCG@5': 0.049617537381974136, 'MRR@5': 0.0437173643572764, 'Recall*@10': 0.09324867820197885, 'NDCG*@10': 0.05790446563200517, 'MRR*@10': 0.04712926223874092, 'Recall*@5': 0.06757679784839804, 'NDCG*@5': 0.049617537381974136, 'MRR*@5': 0.0437173643572764}
INFO    [05-07 00:10:49] train in BasicTrainer:
duration: 34.04061412811279s
INFO    [05-07 00:10:49] train in BasicTrainer:
epoch: 39
INFO    [05-07 00:11:00] _train_one_epoch in BasicTrainer:
loss = 5.470687457493374
INFO    [05-07 00:11:23] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [05-07 00:11:24] validate in BasicTrainer:
{'Recall@10': 0.09490689838474448, 'NDCG@10': 0.059057592329653824, 'MRR@10': 0.04814210534095764, 'Recall@5': 0.06855017285455357, 'NDCG@5': 0.05059757320718332, 'MRR@5': 0.04468793963844126, 'Recall*@10': 0.09490689838474448, 'NDCG*@10': 0.059057592329653824, 'MRR*@10': 0.04814210534095764, 'Recall*@5': 0.06855017285455357, 'NDCG*@5': 0.05059757320718332, 'MRR*@5': 0.04468793963844126}
INFO    [05-07 00:11:24] train in BasicTrainer:
duration: 34.3593385219574s
INFO    [05-07 00:11:24] train in BasicTrainer:
epoch: 40
INFO    [05-07 00:11:34] _train_one_epoch in BasicTrainer:
loss = 5.453749988760267
INFO    [05-07 00:11:55] validate in BasicTrainer:
{'Recall@10': 0.0947027558630163, 'NDCG@10': 0.05903875455260277, 'MRR@10': 0.04815636676820842, 'Recall@5': 0.0690606487068263, 'NDCG@5': 0.05080014772035859, 'MRR@5': 0.04478812691840259, 'Recall*@10': 0.0947027558630163, 'NDCG*@10': 0.05903875455260277, 'MRR*@10': 0.04815636676820842, 'Recall*@5': 0.0690606487068263, 'NDCG*@5': 0.05080014772035859, 'MRR*@5': 0.04478812691840259}
INFO    [05-07 00:11:55] train in BasicTrainer:
duration: 31.486469984054565s
INFO    [05-07 00:11:55] train in BasicTrainer:
epoch: 41
INFO    [05-07 00:12:05] _train_one_epoch in BasicTrainer:
loss = 5.4309631160327365
INFO    [05-07 00:12:23] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-07 00:12:24] validate in BasicTrainer:
{'Recall@10': 0.09441356428644875, 'NDCG@10': 0.05918732895092531, 'MRR@10': 0.0484554073349996, 'Recall@5': 0.06889067116108807, 'NDCG@5': 0.050969467921690506, 'MRR@5': 0.04508442905816165, 'Recall*@10': 0.09441356428644875, 'NDCG*@10': 0.05918732895092531, 'MRR*@10': 0.0484554073349996, 'Recall*@5': 0.06889067116108807, 'NDCG*@5': 0.050969467921690506, 'MRR*@5': 0.04508442905816165}
INFO    [05-07 00:12:24] train in BasicTrainer:
duration: 28.448724031448364s
INFO    [05-07 00:12:24] train in BasicTrainer:
epoch: 42
INFO    [05-07 00:12:33] _train_one_epoch in BasicTrainer:
loss = 5.41316705090659
INFO    [05-07 00:12:57] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-07 00:12:57] validate in BasicTrainer:
{'Recall@10': 0.09538188644430855, 'NDCG@10': 0.05985420908440243, 'MRR@10': 0.04903733764182438, 'Recall@5': 0.06931874359195883, 'NDCG@5': 0.05145849389108745, 'MRR@5': 0.04559163512154059, 'Recall*@10': 0.09538188644430855, 'NDCG*@10': 0.05985420908440243, 'MRR*@10': 0.04903733764182438, 'Recall*@5': 0.06931874359195883, 'NDCG*@5': 0.05145849389108745, 'MRR*@5': 0.04559163512154059}
INFO    [05-07 00:12:57] train in BasicTrainer:
duration: 33.849778175354004s
INFO    [05-07 00:12:57] train in BasicTrainer:
epoch: 43
INFO    [05-07 00:13:08] _train_one_epoch in BasicTrainer:
loss = 5.396542915276119
INFO    [05-07 00:13:26] validate in BasicTrainer:
{'Recall@10': 0.09397604790600864, 'NDCG@10': 0.059479504485021935, 'MRR@10': 0.04896013946695761, 'Recall@5': 0.06898263706402345, 'NDCG@5': 0.051413786682215606, 'MRR@5': 0.045640688728202476, 'Recall*@10': 0.09397604790600864, 'NDCG*@10': 0.059479504485021935, 'MRR*@10': 0.04896013946695761, 'Recall*@5': 0.06898263706402345, 'NDCG*@5': 0.051413786682215606, 'MRR*@5': 0.045640688728202476}
INFO    [05-07 00:13:26] train in BasicTrainer:
duration: 28.916197776794434s
INFO    [05-07 00:13:26] train in BasicTrainer:
epoch: 44
INFO    [05-07 00:13:36] _train_one_epoch in BasicTrainer:
loss = 5.376417023794992
INFO    [05-07 00:13:55] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-07 00:13:56] validate in BasicTrainer:
{'Recall@10': 0.0964021770791574, 'NDCG@10': 0.060485502535646614, 'MRR@10': 0.049550938335332, 'Recall@5': 0.06978164274584163, 'NDCG@5': 0.05190690403634852, 'MRR@5': 0.04602831873026761, 'Recall*@10': 0.0964021770791574, 'NDCG*@10': 0.060485502535646614, 'MRR*@10': 0.049550938335332, 'Recall*@5': 0.06978164274584163, 'NDCG*@5': 0.05190690403634852, 'MRR*@5': 0.04602831873026761}
INFO    [05-07 00:13:56] train in BasicTrainer:
duration: 29.150431871414185s
INFO    [05-07 00:13:56] train in BasicTrainer:
epoch: 45
INFO    [05-07 00:14:05] _train_one_epoch in BasicTrainer:
loss = 5.358743829386575
INFO    [05-07 00:14:29] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-07 00:14:29] validate in BasicTrainer:
{'Recall@10': 0.09699890491637317, 'NDCG@10': 0.06096171418374235, 'MRR@10': 0.0499806363474239, 'Recall@5': 0.0707106285474517, 'NDCG@5': 0.05249878086827018, 'MRR@5': 0.04651024260304191, 'Recall*@10': 0.09699890491637317, 'NDCG*@10': 0.06096171418374235, 'MRR*@10': 0.0499806363474239, 'Recall*@5': 0.0707106285474517, 'NDCG*@5': 0.05249878086827018, 'MRR*@5': 0.04651024260304191}
INFO    [05-07 00:14:29] train in BasicTrainer:
duration: 33.22776007652283s
INFO    [05-07 00:14:29] train in BasicTrainer:
epoch: 46
INFO    [05-07 00:14:39] _train_one_epoch in BasicTrainer:
loss = 5.3405754906790595
INFO    [05-07 00:15:03] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-07 00:15:03] validate in BasicTrainer:
{'Recall@10': 0.09675476429137317, 'NDCG@10': 0.06106035208160227, 'MRR@10': 0.050146780569445, 'Recall@5': 0.07144557684659958, 'NDCG@5': 0.05289835008707913, 'MRR@5': 0.04679130254821344, 'Recall*@10': 0.09675476429137317, 'NDCG*@10': 0.06106035208160227, 'MRR*@10': 0.050146780569445, 'Recall*@5': 0.07144557684659958, 'NDCG*@5': 0.05289835008707913, 'MRR*@5': 0.04679130254821344}
INFO    [05-07 00:15:03] train in BasicTrainer:
duration: 34.06713533401489s
INFO    [05-07 00:15:03] train in BasicTrainer:
epoch: 47
INFO    [05-07 00:15:13] _train_one_epoch in BasicTrainer:
loss = 5.32611003943852
INFO    [05-07 00:15:31] log in loggers:
Update Best NDCG@10 Model at 47
INFO    [05-07 00:15:32] validate in BasicTrainer:
{'Recall@10': 0.09705724838105115, 'NDCG@10': 0.06150163743983616, 'MRR@10': 0.05065382034941153, 'Recall@5': 0.071118371730501, 'NDCG@5': 0.05312831327319145, 'MRR@5': 0.047206594524058426, 'Recall*@10': 0.09705724838105115, 'NDCG*@10': 0.06150163743983616, 'MRR*@10': 0.05065382034941153, 'Recall*@5': 0.071118371730501, 'NDCG*@5': 0.05312831327319145, 'MRR*@5': 0.047206594524058426}
INFO    [05-07 00:15:32] train in BasicTrainer:
duration: 28.831517457962036s
INFO    [05-07 00:15:32] train in BasicTrainer:
epoch: 48
INFO    [05-07 00:15:41] _train_one_epoch in BasicTrainer:
loss = 5.311104118824005
INFO    [05-07 00:16:05] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-07 00:16:06] validate in BasicTrainer:
{'Recall@10': 0.09803062338720668, 'NDCG@10': 0.06191416050900112, 'MRR@10': 0.05089350857517936, 'Recall@5': 0.07171828706156123, 'NDCG@5': 0.053438864309679375, 'MRR@5': 0.04741478542035276, 'Recall*@10': 0.09803062338720668, 'NDCG*@10': 0.06191416050900112, 'MRR*@10': 0.05089350857517936, 'Recall*@5': 0.07171828706156123, 'NDCG*@5': 0.053438864309679375, 'MRR*@5': 0.04741478542035276}
INFO    [05-07 00:16:06] train in BasicTrainer:
duration: 33.82591009140015s
INFO    [05-07 00:16:06] train in BasicTrainer:
epoch: 49
INFO    [05-07 00:16:15] _train_one_epoch in BasicTrainer:
loss = 5.294663224901472
INFO    [05-07 00:16:34] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-07 00:16:34] validate in BasicTrainer:
{'Recall@10': 0.09802238304506648, 'NDCG@10': 0.0624022859741341, 'MRR@10': 0.051513034173033455, 'Recall@5': 0.0729078941724517, 'NDCG@5': 0.05432949689301578, 'MRR@5': 0.04820956594564698, 'Recall*@10': 0.09802238304506648, 'NDCG*@10': 0.0624022859741341, 'MRR*@10': 0.051513034173033455, 'Recall*@5': 0.0729078941724517, 'NDCG*@5': 0.05432949689301578, 'MRR*@5': 0.04820956594564698}
INFO    [05-07 00:16:34] train in BasicTrainer:
duration: 28.56981348991394s
INFO    [05-07 00:16:34] train in BasicTrainer:
epoch: 50
INFO    [05-07 00:16:44] _train_one_epoch in BasicTrainer:
loss = 5.277428848402841
INFO    [05-07 00:17:06] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-07 00:17:06] validate in BasicTrainer:
{'Recall@10': 0.09828047793019902, 'NDCG@10': 0.06277290122075514, 'MRR@10': 0.05192736705595797, 'Recall@5': 0.07371700487353584, 'NDCG@5': 0.05489090423692356, 'MRR@5': 0.048709959807721054, 'Recall*@10': 0.09828047793019902, 'NDCG*@10': 0.06277290122075514, 'MRR*@10': 0.05192736705595797, 'Recall*@5': 0.07371700487353584, 'NDCG*@5': 0.05489090423692356, 'MRR*@5': 0.048709959807721054}
INFO    [05-07 00:17:06] train in BasicTrainer:
duration: 31.623379468917847s
INFO    [05-07 00:17:06] train in BasicTrainer:
epoch: 51
INFO    [05-07 00:17:15] _train_one_epoch in BasicTrainer:
loss = 5.264940346990313
INFO    [05-07 00:17:36] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [05-07 00:17:36] validate in BasicTrainer:
{'Recall@10': 0.099095303226601, 'NDCG@10': 0.06285444410009818, 'MRR@10': 0.051786300472237846, 'Recall@5': 0.07342342219569466, 'NDCG@5': 0.0545897250148383, 'MRR@5': 0.048396401445974006, 'Recall*@10': 0.099095303226601, 'NDCG*@10': 0.06285444410009818, 'MRR*@10': 0.051786300472237846, 'Recall*@5': 0.07342342219569466, 'NDCG*@5': 0.0545897250148383, 'MRR*@5': 0.048396401445974006}
INFO    [05-07 00:17:36] train in BasicTrainer:
duration: 30.756144762039185s
INFO    [05-07 00:17:36] train in BasicTrainer:
epoch: 52
INFO    [05-07 00:17:47] _train_one_epoch in BasicTrainer:
loss = 5.247565473828997
INFO    [05-07 00:18:07] log in loggers:
Update Best NDCG@10 Model at 52
INFO    [05-07 00:18:07] validate in BasicTrainer:
{'Recall@10': 0.09916002167896791, 'NDCG@10': 0.06312550807541067, 'MRR@10': 0.052081179889765655, 'Recall@5': 0.07461621680042961, 'NDCG@5': 0.055217233232476494, 'MRR@5': 0.04883404008366845, 'Recall*@10': 0.09916002167896791, 'NDCG*@10': 0.06312550807541067, 'MRR*@10': 0.052081179889765655, 'Recall*@5': 0.07461621680042961, 'NDCG*@5': 0.055217233232476494, 'MRR*@5': 0.04883404008366845}
INFO    [05-07 00:18:07] train in BasicTrainer:
duration: 30.318843364715576s
INFO    [05-07 00:18:07] train in BasicTrainer:
epoch: 53
DEBUG   [05-07 00:18:13] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 1169107
DEBUG   [05-07 00:18:13] calculate_loss in loss:
pred max in softmax: 0.906406581401825, argmax 58286900
DEBUG   [05-07 00:18:13] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 12608521
DEBUG   [05-07 00:18:13] calculate_loss in loss:
pred max in softmax: 0.9892505407333374, argmax 24636609
INFO    [05-07 00:18:17] _train_one_epoch in BasicTrainer:
loss = 5.237895607948303
INFO    [05-07 00:18:35] log in loggers:
Update Best NDCG@10 Model at 53
INFO    [05-07 00:18:35] validate in BasicTrainer:
{'Recall@10': 0.09957281771031293, 'NDCG@10': 0.06370298361236398, 'MRR@10': 0.052742897448214615, 'Recall@5': 0.07447799701582301, 'NDCG@5': 0.05559781396930868, 'MRR@5': 0.049403617666526276, 'Recall*@10': 0.09957281771031293, 'NDCG*@10': 0.06370298361236398, 'MRR*@10': 0.052742897448214615, 'Recall*@5': 0.07447799701582301, 'NDCG*@5': 0.05559781396930868, 'MRR*@5': 0.049403617666526276}
INFO    [05-07 00:18:35] train in BasicTrainer:
duration: 28.638746976852417s
INFO    [05-07 00:18:35] train in BasicTrainer:
epoch: 54
INFO    [05-07 00:18:46] _train_one_epoch in BasicTrainer:
loss = 5.225005745887756
INFO    [05-07 00:19:07] validate in BasicTrainer:
{'Recall@10': 0.09960962764241478, 'NDCG@10': 0.06360707432031631, 'MRR@10': 0.05259635739705779, 'Recall@5': 0.07460226254029707, 'NDCG@5': 0.05553129213777455, 'MRR@5': 0.04926996847445315, 'Recall*@10': 0.09960962764241478, 'NDCG*@10': 0.06360707432031631, 'MRR*@10': 0.05259635739705779, 'Recall*@5': 0.07460226254029707, 'NDCG*@5': 0.05553129213777455, 'MRR*@5': 0.04926996847445315}
INFO    [05-07 00:19:07] train in BasicTrainer:
duration: 31.228103399276733s
INFO    [05-07 00:19:07] train in BasicTrainer:
epoch: 55
INFO    [05-07 00:19:17] _train_one_epoch in BasicTrainer:
loss = 5.211405941418239
INFO    [05-07 00:19:40] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [05-07 00:19:40] validate in BasicTrainer:
{'Recall@10': 0.100013522261923, 'NDCG@10': 0.06381332095373761, 'MRR@10': 0.05274883319031109, 'Recall@5': 0.07467708668925545, 'NDCG@5': 0.055655101483518425, 'MRR@5': 0.049402230165221474, 'Recall*@10': 0.100013522261923, 'NDCG*@10': 0.06381332095373761, 'MRR*@10': 0.05274883319031109, 'Recall*@5': 0.07467708668925545, 'NDCG*@5': 0.055655101483518425, 'MRR*@5': 0.049402230165221474}
INFO    [05-07 00:19:40] train in BasicTrainer:
duration: 33.769402503967285s
INFO    [05-07 00:19:40] train in BasicTrainer:
epoch: 56
INFO    [05-07 00:19:51] _train_one_epoch in BasicTrainer:
loss = 5.198877368654523
INFO    [05-07 00:20:11] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-07 00:20:11] validate in BasicTrainer:
{'Recall@10': 0.09988101571798325, 'NDCG@10': 0.064220975745808, 'MRR@10': 0.053276903250000694, 'Recall@5': 0.0757309997623617, 'NDCG@5': 0.056429198519750076, 'MRR@5': 0.050071333619681274, 'Recall*@10': 0.09988101571798325, 'NDCG*@10': 0.064220975745808, 'MRR*@10': 0.053276903250000694, 'Recall*@5': 0.0757309997623617, 'NDCG*@5': 0.056429198519750076, 'MRR*@5': 0.050071333619681274}
INFO    [05-07 00:20:11] train in BasicTrainer:
duration: 30.512044191360474s
INFO    [05-07 00:20:11] train in BasicTrainer:
epoch: 57
INFO    [05-07 00:20:21] _train_one_epoch in BasicTrainer:
loss = 5.183269875390189
INFO    [05-07 00:20:44] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-07 00:20:45] validate in BasicTrainer:
{'Recall@10': 0.10084548863497647, 'NDCG@10': 0.06460634449666197, 'MRR@10': 0.05351100794293664, 'Recall@5': 0.07539236681027846, 'NDCG@5': 0.05637543005022136, 'MRR@5': 0.050114071504636246, 'Recall*@10': 0.10084548863497647, 'NDCG*@10': 0.06460634449666197, 'MRR*@10': 0.05351100794293664, 'Recall*@5': 0.07539236681027846, 'NDCG*@5': 0.05637543005022136, 'MRR*@5': 0.050114071504636246}
INFO    [05-07 00:20:45] train in BasicTrainer:
duration: 33.739073038101196s
INFO    [05-07 00:20:45] train in BasicTrainer:
epoch: 58
INFO    [05-07 00:20:55] _train_one_epoch in BasicTrainer:
loss = 5.171388013022287
INFO    [05-07 00:21:15] log in loggers:
Update Best NDCG@10 Model at 58
INFO    [05-07 00:21:15] validate in BasicTrainer:
{'Recall@10': 0.10106238248673352, 'NDCG@10': 0.0647938766262748, 'MRR@10': 0.0537177138030529, 'Recall@5': 0.0752015168016607, 'NDCG@5': 0.05643862316554243, 'MRR@5': 0.050274253568866036, 'Recall*@10': 0.10106238248673352, 'NDCG*@10': 0.0647938766262748, 'MRR*@10': 0.0537177138030529, 'Recall*@5': 0.0752015168016607, 'NDCG*@5': 0.05643862316554243, 'MRR*@5': 0.050274253568866036}
INFO    [05-07 00:21:15] train in BasicTrainer:
duration: 30.314758777618408s
INFO    [05-07 00:21:15] train in BasicTrainer:
epoch: 59
INFO    [05-07 00:21:25] _train_one_epoch in BasicTrainer:
loss = 5.162278303078243
INFO    [05-07 00:21:44] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [05-07 00:21:44] validate in BasicTrainer:
{'Recall@10': 0.10227989744056355, 'NDCG@10': 0.06522015549919823, 'MRR@10': 0.053896930746056816, 'Recall@5': 0.0761945599859411, 'NDCG@5': 0.05684615129774267, 'MRR@5': 0.050476827743378555, 'Recall*@10': 0.10227989744056355, 'NDCG*@10': 0.06522015549919823, 'MRR*@10': 0.053896930746056816, 'Recall*@5': 0.0761945599859411, 'NDCG*@5': 0.05684615129774267, 'MRR*@5': 0.050476827743378555}
INFO    [05-07 00:21:44] train in BasicTrainer:
duration: 29.425652503967285s
INFO    [05-07 00:21:45] close_training in BasicTrainer:
finished training
DEBUG   [05-07 00:21:45] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3361 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-07 00:21:45] run_routine in Routine:
Finished training, Start final validation
INFO    [05-07 00:21:45] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-07 00:21:45] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-07 00:21:45] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-07 00:22:03] validate in BasicTrainer:
{'Recall@10': 0.10227989744056355, 'NDCG@10': 0.06522015549919823, 'MRR@10': 0.053896930746056816, 'Recall@5': 0.0761945599859411, 'NDCG@5': 0.05684615129774267, 'MRR@5': 0.050476827743378555, 'Recall*@10': 0.10227989744056355, 'NDCG*@10': 0.06522015549919823, 'MRR*@10': 0.053896930746056816, 'Recall*@5': 0.0761945599859411, 'NDCG*@5': 0.05684615129774267, 'MRR*@5': 0.050476827743378555}
INFO    [05-07 00:22:03] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.10227989744056355, 'NDCG@10': 0.06522015549919823, 'MRR@10': 0.053896930746056816, 'Recall@5': 0.0761945599859411, 'NDCG@5': 0.05684615129774267, 'MRR@5': 0.050476827743378555, 'Recall*@10': 0.10227989744056355, 'NDCG*@10': 0.06522015549919823, 'MRR*@10': 0.053896930746056816, 'Recall*@5': 0.0761945599859411, 'NDCG*@5': 0.05684615129774267, 'MRR*@5': 0.050476827743378555}
INFO    [05-07 00:22:03] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-07 00:22:03] test in BasicTrainer:
Test model on test set!
INFO    [05-07 00:22:03] test_with_given_state_path in BasicTrainer:
Loading model params from ___yelp_soft_2020/pop_narm-T-6-al-0.25_05-06_23:49_0/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-07 00:22:03] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-07 00:22:03] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-07 00:22:03] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-07 00:22:22] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.08134743774479086, 'NDCG@10': 0.05063163252039389, 'MRR@10': 0.0412771190431985, 'Recall@5': 0.05897617780349471, 'NDCG@5': 0.0434389744292606, 'MRR@5': 0.03833348676562309, 'Recall*@10': 0.08134743774479086, 'NDCG*@10': 0.05063163252039389, 'MRR*@10': 0.0412771190431985, 'Recall*@5': 0.05897617780349471, 'NDCG*@5': 0.0434389744292606, 'MRR*@5': 0.03833348676562309}
INFO    [05-07 00:22:22] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.08134743774479086, 'NDCG@10': 0.05063163252039389, 'MRR@10': 0.0412771190431985, 'Recall@5': 0.05897617780349471, 'NDCG@5': 0.0434389744292606, 'MRR@5': 0.03833348676562309, 'Recall*@10': 0.08134743774479086, 'NDCG*@10': 0.05063163252039389, 'MRR*@10': 0.0412771190431985, 'Recall*@5': 0.05897617780349471, 'NDCG*@5': 0.0434389744292606, 'MRR*@5': 0.03833348676562309}
