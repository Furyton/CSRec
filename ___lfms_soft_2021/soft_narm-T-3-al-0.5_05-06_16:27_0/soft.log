INFO    [05-06 16:27:59] setup_train in utils:
{
    "experiment_dir": "___lfms_soft_2021",
    "experiment_description": "soft",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "lastfm_small.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "dvae_alpha": 0.5,
    "alpha": 0.5,
    "T": 3,
    "num_epochs": 80,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 20,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2021,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 256,
    "val_batch_size": 256,
    "test_batch_size": 256,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.lastfm_small/narm/config_distill.json",
    "task_id": -1,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-06 16:27:59] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-06 16:27:59] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/lastfm_small-5-5.pkl
INFO    [05-06 16:27:59] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-06 16:27:59] _check_dataset_cache in utils:
correct.
INFO    [05-06 16:27:59] __init__ in NextItemDataloader:
there are 3646 items in this dataset, 3173 users, padding_first? False
DEBUG   [05-06 16:28:00] generate_model in utils:
model_code_list=['pop']
INFO    [05-06 16:28:00] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-06 16:28:00] load_model_config in utils:
{}
WARNING [05-06 16:28:04] get_exist_path in utils:
dir ___lfms_soft_2021/soft_narm-T-3-al-0.5_05-06_16:27_0/teacher_pop_logs does not exist! Create one.
WARNING [05-06 16:28:04] get_exist_path in utils:
dir ___lfms_soft_2021/soft_narm-T-3-al-0.5_05-06_16:27_0/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-06 16:28:04] get_exist_path in utils:
dir ___lfms_soft_2021/soft_narm-T-3-al-0.5_05-06_16:27_0/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-06 16:28:04] get_path in utils:
Path is None
WARNING [05-06 16:28:04] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-06 16:28:04] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-06 16:28:04] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-06 16:28:04] __init__ in BasicTrainer:
48128 iter per epoch
DEBUG   [05-06 16:28:04] generate_model in utils:
model_code_list=['narm']
INFO    [05-06 16:28:04] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-06 16:28:04] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-06 16:28:05] get_exist_path in utils:
dir ___lfms_soft_2021/soft_narm-T-3-al-0.5_05-06_16:27_0/student_narm_logs does not exist! Create one.
WARNING [05-06 16:28:05] get_exist_path in utils:
dir ___lfms_soft_2021/soft_narm-T-3-al-0.5_05-06_16:27_0/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-06 16:28:05] get_exist_path in utils:
dir ___lfms_soft_2021/soft_narm-T-3-al-0.5_05-06_16:27_0/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-06 16:28:05] get_path in utils:
Path is None
WARNING [05-06 16:28:05] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-06 16:28:05] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(3647, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-06 16:28:05] assert_model_device in utils:
model student_narm has 1.359619140625 MB params.
INFO    [05-06 16:28:05] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-06 16:28:05] __init__ in DistillTrainer:
48128 iter per epoch
INFO    [05-06 16:28:05] _set_current_routine in Routine:
first routine: student
INFO    [05-06 16:28:05] run_routine in Routine:
Start routine student
INFO    [05-06 16:28:05] run_routine in Routine:
Start training
INFO    [05-06 16:28:05] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-06 16:28:07] test_mentor in DistillTrainer:
{'Recall@10': 0.03267505249151817, 'NDCG@10': 0.014886060944543434, 'MRR@10': 0.009547148437167589, 'Recall@5': 0.018231150049429674, 'NDCG@5': 0.010265986972416822, 'MRR@5': 0.007671780114133771, 'Recall*@10': 0.03267505249151817, 'NDCG*@10': 0.014886060944543434, 'MRR*@10': 0.009547148437167589, 'Recall*@5': 0.018231150049429674, 'NDCG*@5': 0.010265986972416822, 'MRR*@5': 0.007671780114133771}
INFO    [05-06 16:28:07] train in DistillTrainer:
result:
{'Recall@10': 0.03267505249151817, 'NDCG@10': 0.014886060944543434, 'MRR@10': 0.009547148437167589, 'Recall@5': 0.018231150049429674, 'NDCG@5': 0.010265986972416822, 'MRR@5': 0.007671780114133771, 'Recall*@10': 0.03267505249151817, 'NDCG*@10': 0.014886060944543434, 'MRR*@10': 0.009547148437167589, 'Recall*@5': 0.018231150049429674, 'NDCG*@5': 0.010265986972416822, 'MRR*@5': 0.007671780114133771}
INFO    [05-06 16:28:09] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-06 16:28:09] validate in BasicTrainer:
{'Recall@10': 0.0022640184570963564, 'NDCG@10': 0.0008515332324000505, 'MRR@10': 0.00044158938600538444, 'Recall@5': 0.0006009615384615385, 'NDCG@5': 0.00031899229193536134, 'MRR@5': 0.00022536057692307694, 'Recall*@10': 0.0022640184570963564, 'NDCG*@10': 0.0008515332324000505, 'MRR*@10': 0.00044158938600538444, 'Recall*@5': 0.0006009615384615385, 'NDCG*@5': 0.00031899229193536134, 'MRR*@5': 0.00022536057692307694}
INFO    [05-06 16:28:09] train in BasicTrainer:
epoch: 0
DEBUG   [05-06 16:28:09] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 610275
DEBUG   [05-06 16:28:09] calculate_loss in loss:
pred max in softmax: 0.0002818127104546875, argmax 732678
INFO    [05-06 16:28:12] _train_one_epoch in BasicTrainer:
loss = 5.598705763512469
INFO    [05-06 16:28:14] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-06 16:28:14] validate in BasicTrainer:
{'Recall@10': 0.03535855389558352, 'NDCG@10': 0.01724591664969921, 'MRR@10': 0.011747288195273051, 'Recall@5': 0.02271753606887964, 'NDCG@5': 0.013217450262835393, 'MRR@5': 0.010118219070136547, 'Recall*@10': 0.03535855389558352, 'NDCG*@10': 0.01724591664969921, 'MRR*@10': 0.011747288195273051, 'Recall*@5': 0.02271753606887964, 'NDCG*@5': 0.013217450262835393, 'MRR*@5': 0.010118219070136547}
INFO    [05-06 16:28:14] train in BasicTrainer:
duration: 5.189356803894043s
INFO    [05-06 16:28:14] train in BasicTrainer:
epoch: 1
INFO    [05-06 16:28:17] _train_one_epoch in BasicTrainer:
loss = 5.290056122110245
INFO    [05-06 16:28:19] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-06 16:28:19] validate in BasicTrainer:
{'Recall@10': 0.059138185129715845, 'NDCG@10': 0.02871846164075228, 'MRR@10': 0.019632173272279594, 'Recall@5': 0.033415841368528515, 'NDCG@5': 0.02061248946791658, 'MRR@5': 0.016407589356486615, 'Recall*@10': 0.059138185129715845, 'NDCG*@10': 0.02871846164075228, 'MRR*@10': 0.019632173272279594, 'Recall*@5': 0.033415841368528515, 'NDCG*@5': 0.02061248946791658, 'MRR*@5': 0.016407589356486615}
INFO    [05-06 16:28:19] train in BasicTrainer:
duration: 5.179914474487305s
INFO    [05-06 16:28:19] train in BasicTrainer:
epoch: 2
INFO    [05-06 16:28:22] _train_one_epoch in BasicTrainer:
loss = 5.090891171008982
INFO    [05-06 16:28:24] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-06 16:28:24] validate in BasicTrainer:
{'Recall@10': 0.0710175885603978, 'NDCG@10': 0.036310962616251066, 'MRR@10': 0.02584544297021169, 'Recall@5': 0.044233149060836204, 'NDCG@5': 0.027825403815278642, 'MRR@5': 0.02244878954325731, 'Recall*@10': 0.0710175885603978, 'NDCG*@10': 0.036310962616251066, 'MRR*@10': 0.02584544297021169, 'Recall*@5': 0.044233149060836204, 'NDCG*@5': 0.027825403815278642, 'MRR*@5': 0.02244878954325731}
INFO    [05-06 16:28:24] train in BasicTrainer:
duration: 5.3509931564331055s
INFO    [05-06 16:28:24] train in BasicTrainer:
epoch: 3
INFO    [05-06 16:28:28] _train_one_epoch in BasicTrainer:
loss = 4.956307048493243
INFO    [05-06 16:28:29] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-06 16:28:29] validate in BasicTrainer:
{'Recall@10': 0.08620227987949665, 'NDCG@10': 0.04528241532926376, 'MRR@10': 0.03310488579938045, 'Recall@5': 0.05220630249151817, 'NDCG@5': 0.034512907409897216, 'MRR@5': 0.02879190917771596, 'Recall*@10': 0.08620227987949665, 'NDCG*@10': 0.04528241532926376, 'MRR*@10': 0.03310488579938045, 'Recall*@5': 0.05220630249151817, 'NDCG*@5': 0.034512907409897216, 'MRR*@5': 0.02879190917771596}
INFO    [05-06 16:28:29] train in BasicTrainer:
duration: 5.146722316741943s
INFO    [05-06 16:28:29] train in BasicTrainer:
epoch: 4
INFO    [05-06 16:28:33] _train_one_epoch in BasicTrainer:
loss = 4.8588559754351355
INFO    [05-06 16:28:35] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-06 16:28:35] validate in BasicTrainer:
{'Recall@10': 0.10124714328692509, 'NDCG@10': 0.053814199968026236, 'MRR@10': 0.03942953164760883, 'Recall@5': 0.06456766449488126, 'NDCG@5': 0.04196937640125935, 'MRR@5': 0.034549785491365656, 'Recall*@10': 0.10124714328692509, 'NDCG*@10': 0.053814199968026236, 'MRR*@10': 0.03942953164760883, 'Recall*@5': 0.06456766449488126, 'NDCG*@5': 0.04196937640125935, 'MRR*@5': 0.034549785491365656}
INFO    [05-06 16:28:35] train in BasicTrainer:
duration: 5.324786424636841s
INFO    [05-06 16:28:35] train in BasicTrainer:
epoch: 5
DEBUG   [05-06 16:28:36] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 41343
DEBUG   [05-06 16:28:36] calculate_loss in loss:
pred max in softmax: 0.0787343829870224, argmax 742107
DEBUG   [05-06 16:28:36] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 74166
DEBUG   [05-06 16:28:36] calculate_loss in loss:
pred max in softmax: 0.08256710320711136, argmax 118470
INFO    [05-06 16:28:38] _train_one_epoch in BasicTrainer:
loss = 4.77598773164952
INFO    [05-06 16:28:40] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-06 16:28:40] validate in BasicTrainer:
{'Recall@10': 0.11236493174846356, 'NDCG@10': 0.05871694047863667, 'MRR@10': 0.04258795139881281, 'Recall@5': 0.06993466787613355, 'NDCG@5': 0.04517240249193632, 'MRR@5': 0.03709643463102671, 'Recall*@10': 0.11236493174846356, 'NDCG*@10': 0.05871694047863667, 'MRR*@10': 0.04258795139881281, 'Recall*@5': 0.06993466787613355, 'NDCG*@5': 0.04517240249193632, 'MRR*@5': 0.03709643463102671}
INFO    [05-06 16:28:40] train in BasicTrainer:
duration: 5.1318418979644775s
INFO    [05-06 16:28:40] train in BasicTrainer:
epoch: 6
INFO    [05-06 16:28:43] _train_one_epoch in BasicTrainer:
loss = 4.707281794953854
INFO    [05-06 16:28:45] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-06 16:28:45] validate in BasicTrainer:
{'Recall@10': 0.12278358179789323, 'NDCG@10': 0.0631412250491289, 'MRR@10': 0.04518421065921967, 'Recall@5': 0.07328160680257358, 'NDCG@5': 0.047279816693984546, 'MRR@5': 0.03872721176594496, 'Recall*@10': 0.12278358179789323, 'NDCG*@10': 0.0631412250491289, 'MRR*@10': 0.04518421065921967, 'Recall*@5': 0.07328160680257358, 'NDCG*@5': 0.047279816693984546, 'MRR*@5': 0.03872721176594496}
INFO    [05-06 16:28:45] train in BasicTrainer:
duration: 5.167457342147827s
INFO    [05-06 16:28:45] train in BasicTrainer:
epoch: 7
INFO    [05-06 16:28:48] _train_one_epoch in BasicTrainer:
loss = 4.651362921329254
INFO    [05-06 16:28:50] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-06 16:28:50] validate in BasicTrainer:
{'Recall@10': 0.131295220210002, 'NDCG@10': 0.06684840413240287, 'MRR@10': 0.04741552815987514, 'Recall@5': 0.0792495717222874, 'NDCG@5': 0.05007598735392094, 'MRR@5': 0.04052860877261712, 'Recall*@10': 0.131295220210002, 'NDCG*@10': 0.06684840413240287, 'MRR*@10': 0.04741552815987514, 'Recall*@5': 0.0792495717222874, 'NDCG*@5': 0.05007598735392094, 'MRR*@5': 0.04052860877261712}
INFO    [05-06 16:28:50] train in BasicTrainer:
duration: 5.066642761230469s
INFO    [05-06 16:28:50] train in BasicTrainer:
epoch: 8
INFO    [05-06 16:28:53] _train_one_epoch in BasicTrainer:
loss = 4.596205439973385
INFO    [05-06 16:28:55] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-06 16:28:55] validate in BasicTrainer:
{'Recall@10': 0.1423356578900264, 'NDCG@10': 0.07655220851302147, 'MRR@10': 0.056811767988480054, 'Recall@5': 0.08726437504474933, 'NDCG@5': 0.058870308101177216, 'MRR@5': 0.04958636915454498, 'Recall*@10': 0.1423356578900264, 'NDCG*@10': 0.07655220851302147, 'MRR*@10': 0.056811767988480054, 'Recall*@5': 0.08726437504474933, 'NDCG*@5': 0.058870308101177216, 'MRR*@5': 0.04958636915454498}
INFO    [05-06 16:28:55] train in BasicTrainer:
duration: 5.26890230178833s
INFO    [05-06 16:28:55] train in BasicTrainer:
epoch: 9
INFO    [05-06 16:28:58] _train_one_epoch in BasicTrainer:
loss = 4.542570847146054
INFO    [05-06 16:29:00] validate in BasicTrainer:
{'Recall@10': 0.14423671937905824, 'NDCG@10': 0.07641149226289529, 'MRR@10': 0.055788930218953356, 'Recall@5': 0.09267302889090318, 'NDCG@5': 0.05976811194649109, 'MRR@5': 0.048936567054345056, 'Recall*@10': 0.14423671937905824, 'NDCG*@10': 0.07641149226289529, 'MRR*@10': 0.055788930218953356, 'Recall*@5': 0.09267302889090318, 'NDCG*@5': 0.05976811194649109, 'MRR*@5': 0.048936567054345056}
INFO    [05-06 16:29:00] train in BasicTrainer:
duration: 4.929750680923462s
INFO    [05-06 16:29:00] train in BasicTrainer:
epoch: 10
DEBUG   [05-06 16:29:03] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 198164
DEBUG   [05-06 16:29:03] calculate_loss in loss:
pred max in softmax: 0.12094336003065109, argmax 120099
DEBUG   [05-06 16:29:03] calculate_loss in loss:
soft_target max: 0.501916766166687, argmax 595059
DEBUG   [05-06 16:29:03] calculate_loss in loss:
pred max in softmax: 0.2055949568748474, argmax 913943
INFO    [05-06 16:29:04] _train_one_epoch in BasicTrainer:
loss = 4.493811277633018
INFO    [05-06 16:29:05] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-06 16:29:05] validate in BasicTrainer:
{'Recall@10': 0.15269183195554292, 'NDCG@10': 0.08092374182664432, 'MRR@10': 0.059193033868303664, 'Recall@5': 0.10096748860982749, 'NDCG@5': 0.06447862876722446, 'MRR@5': 0.052571689136899434, 'Recall*@10': 0.15269183195554292, 'NDCG*@10': 0.08092374182664432, 'MRR*@10': 0.059193033868303664, 'Recall*@5': 0.10096748860982749, 'NDCG*@5': 0.06447862876722446, 'MRR*@5': 0.052571689136899434}
INFO    [05-06 16:29:05] train in BasicTrainer:
duration: 5.139840126037598s
INFO    [05-06 16:29:05] train in BasicTrainer:
epoch: 11
INFO    [05-06 16:29:09] _train_one_epoch in BasicTrainer:
loss = 4.444166345799223
INFO    [05-06 16:29:11] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-06 16:29:11] validate in BasicTrainer:
{'Recall@10': 0.16126594635156485, 'NDCG@10': 0.08620096399233891, 'MRR@10': 0.06337065192369315, 'Recall@5': 0.10683727608277248, 'NDCG@5': 0.06857199107225125, 'MRR@5': 0.056080026408800714, 'Recall*@10': 0.16126594635156485, 'NDCG*@10': 0.08620096399233891, 'MRR*@10': 0.06337065192369315, 'Recall*@5': 0.10683727608277248, 'NDCG*@5': 0.06857199107225125, 'MRR*@5': 0.056080026408800714}
INFO    [05-06 16:29:11] train in BasicTrainer:
duration: 5.26199746131897s
INFO    [05-06 16:29:11] train in BasicTrainer:
epoch: 12
INFO    [05-06 16:29:14] _train_one_epoch in BasicTrainer:
loss = 4.397351310608235
INFO    [05-06 16:29:16] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-06 16:29:16] validate in BasicTrainer:
{'Recall@10': 0.16200673580169678, 'NDCG@10': 0.08670947643426749, 'MRR@10': 0.06387018269071212, 'Recall@5': 0.10439177889090318, 'NDCG@5': 0.06819872443492596, 'MRR@5': 0.05630013031455187, 'Recall*@10': 0.16200673580169678, 'NDCG*@10': 0.08670947643426749, 'MRR*@10': 0.06387018269071212, 'Recall*@5': 0.10439177889090318, 'NDCG*@5': 0.06819872443492596, 'MRR*@5': 0.05630013031455187}
INFO    [05-06 16:29:16] train in BasicTrainer:
duration: 5.243729829788208s
INFO    [05-06 16:29:16] train in BasicTrainer:
epoch: 13
INFO    [05-06 16:29:19] _train_one_epoch in BasicTrainer:
loss = 4.3595016560655955
INFO    [05-06 16:29:21] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-06 16:29:21] validate in BasicTrainer:
{'Recall@10': 0.1722647318473229, 'NDCG@10': 0.09391022187012893, 'MRR@10': 0.07026793234623395, 'Recall@5': 0.10908046937905826, 'NDCG@5': 0.07357904171714416, 'MRR@5': 0.0619361291711147, 'Recall*@10': 0.1722647318473229, 'NDCG*@10': 0.09391022187012893, 'MRR*@10': 0.07026793234623395, 'Recall*@5': 0.10908046937905826, 'NDCG*@5': 0.07357904171714416, 'MRR*@5': 0.0619361291711147}
INFO    [05-06 16:29:21] train in BasicTrainer:
duration: 5.067487955093384s
INFO    [05-06 16:29:21] train in BasicTrainer:
epoch: 14
INFO    [05-06 16:29:24] _train_one_epoch in BasicTrainer:
loss = 4.3204571997865715
INFO    [05-06 16:29:26] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-06 16:29:26] validate in BasicTrainer:
{'Recall@10': 0.1763108097589933, 'NDCG@10': 0.09539841344723335, 'MRR@10': 0.07086297669089757, 'Recall@5': 0.11224592992892632, 'NDCG@5': 0.07468040344806817, 'MRR@5': 0.06231381142368683, 'Recall*@10': 0.1763108097589933, 'NDCG*@10': 0.09539841344723335, 'MRR*@10': 0.07086297669089757, 'Recall*@5': 0.11224592992892632, 'NDCG*@5': 0.07468040344806817, 'MRR*@5': 0.06231381142368683}
INFO    [05-06 16:29:26] train in BasicTrainer:
duration: 5.231924533843994s
INFO    [05-06 16:29:26] train in BasicTrainer:
epoch: 15
DEBUG   [05-06 16:29:29] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 312389
DEBUG   [05-06 16:29:29] calculate_loss in loss:
pred max in softmax: 0.36701419949531555, argmax 775377
DEBUG   [05-06 16:29:29] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 106989
DEBUG   [05-06 16:29:29] calculate_loss in loss:
pred max in softmax: 0.1987161934375763, argmax 443127
INFO    [05-06 16:29:29] _train_one_epoch in BasicTrainer:
loss = 4.281176759841594
INFO    [05-06 16:29:31] validate in BasicTrainer:
{'Recall@10': 0.17104198382450983, 'NDCG@10': 0.09342160878273156, 'MRR@10': 0.06987730270394912, 'Recall@5': 0.11430764427551857, 'NDCG@5': 0.07508672114748222, 'MRR@5': 0.062315001510656796, 'Recall*@10': 0.17104198382450983, 'NDCG*@10': 0.09342160878273156, 'MRR*@10': 0.06987730270394912, 'Recall*@5': 0.11430764427551857, 'NDCG*@5': 0.07508672114748222, 'MRR*@5': 0.062315001510656796}
INFO    [05-06 16:29:31] train in BasicTrainer:
duration: 5.0519256591796875s
INFO    [05-06 16:29:31] train in BasicTrainer:
epoch: 16
INFO    [05-06 16:29:35] _train_one_epoch in BasicTrainer:
loss = 4.248857315550459
INFO    [05-06 16:29:36] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-06 16:29:36] validate in BasicTrainer:
{'Recall@10': 0.17855400305527908, 'NDCG@10': 0.09804748342587398, 'MRR@10': 0.0736856426183994, 'Recall@5': 0.11627118174846356, 'NDCG@5': 0.07804670700660118, 'MRR@5': 0.06551422952459408, 'Recall*@10': 0.17855400305527908, 'NDCG*@10': 0.09804748342587398, 'MRR*@10': 0.0736856426183994, 'Recall*@5': 0.11627118174846356, 'NDCG*@5': 0.07804670700660118, 'MRR*@5': 0.06551422952459408}
INFO    [05-06 16:29:36] train in BasicTrainer:
duration: 5.147707223892212s
INFO    [05-06 16:29:36] train in BasicTrainer:
epoch: 17
INFO    [05-06 16:29:40] _train_one_epoch in BasicTrainer:
loss = 4.210795301072141
INFO    [05-06 16:29:42] validate in BasicTrainer:
{'Recall@10': 0.1782535222860483, 'NDCG@10': 0.09802112097923572, 'MRR@10': 0.07364767560592064, 'Recall@5': 0.12033808575226711, 'NDCG@5': 0.07934066022817905, 'MRR@5': 0.06596291781618045, 'Recall*@10': 0.1782535222860483, 'NDCG*@10': 0.09802112097923572, 'MRR*@10': 0.07364767560592064, 'Recall*@5': 0.12033808575226711, 'NDCG*@5': 0.07934066022817905, 'MRR*@5': 0.06596291781618045}
INFO    [05-06 16:29:42] train in BasicTrainer:
duration: 5.176820278167725s
INFO    [05-06 16:29:42] train in BasicTrainer:
epoch: 18
INFO    [05-06 16:29:45] _train_one_epoch in BasicTrainer:
loss = 4.189149585176022
INFO    [05-06 16:29:47] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-06 16:29:47] validate in BasicTrainer:
{'Recall@10': 0.18276073382450983, 'NDCG@10': 0.10075349761889531, 'MRR@10': 0.0757943930534216, 'Recall@5': 0.12047791251769432, 'NDCG@5': 0.08065188074341187, 'MRR@5': 0.06752150075939986, 'Recall*@10': 0.18276073382450983, 'NDCG*@10': 0.10075349761889531, 'MRR*@10': 0.0757943930534216, 'Recall*@5': 0.12047791251769432, 'NDCG*@5': 0.08065188074341187, 'MRR*@5': 0.06752150075939986}
INFO    [05-06 16:29:47] train in BasicTrainer:
duration: 5.349719047546387s
INFO    [05-06 16:29:47] train in BasicTrainer:
epoch: 19
INFO    [05-06 16:29:50] _train_one_epoch in BasicTrainer:
loss = 4.152931491111187
INFO    [05-06 16:29:52] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-06 16:29:52] validate in BasicTrainer:
{'Recall@10': 0.18548588569347674, 'NDCG@10': 0.10160677478863643, 'MRR@10': 0.07622431103999798, 'Recall@5': 0.12035891069815709, 'NDCG@5': 0.0806822868493887, 'MRR@5': 0.06766921167190258, 'Recall*@10': 0.18548588569347674, 'NDCG*@10': 0.10160677478863643, 'MRR*@10': 0.07622431103999798, 'Recall*@5': 0.12035891069815709, 'NDCG*@5': 0.0806822868493887, 'MRR*@5': 0.06766921167190258}
INFO    [05-06 16:29:52] train in BasicTrainer:
duration: 5.319337368011475s
INFO    [05-06 16:29:52] train in BasicTrainer:
epoch: 20
INFO    [05-06 16:29:56] _train_one_epoch in BasicTrainer:
loss = 4.129834857392819
INFO    [05-06 16:29:57] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-06 16:29:58] validate in BasicTrainer:
{'Recall@10': 0.19301873101637915, 'NDCG@10': 0.10755506215187219, 'MRR@10': 0.08158109967525189, 'Recall@5': 0.12919185482538664, 'NDCG@5': 0.08703112372985253, 'MRR@5': 0.07318234128447679, 'Recall*@10': 0.19301873101637915, 'NDCG*@10': 0.10755506215187219, 'MRR*@10': 0.08158109967525189, 'Recall*@5': 0.12919185482538664, 'NDCG*@5': 0.08703112372985253, 'MRR*@5': 0.07318234128447679}
INFO    [05-06 16:29:58] train in BasicTrainer:
duration: 5.24674391746521s
INFO    [05-06 16:29:58] train in BasicTrainer:
epoch: 21
DEBUG   [05-06 16:29:59] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 78981
DEBUG   [05-06 16:29:59] calculate_loss in loss:
pred max in softmax: 0.21504239737987518, argmax 295796
DEBUG   [05-06 16:29:59] calculate_loss in loss:
soft_target max: 0.5017096400260925, argmax 254564
DEBUG   [05-06 16:29:59] calculate_loss in loss:
pred max in softmax: 0.27950435876846313, argmax 864346
INFO    [05-06 16:30:01] _train_one_epoch in BasicTrainer:
loss = 4.105791411501296
INFO    [05-06 16:30:03] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-06 16:30:03] validate in BasicTrainer:
{'Recall@10': 0.19253677129745483, 'NDCG@10': 0.1092731488438753, 'MRR@10': 0.08393050644260186, 'Recall@5': 0.13147669915969556, 'NDCG@5': 0.08945504518655631, 'MRR@5': 0.07571208190459472, 'Recall*@10': 0.19253677129745483, 'NDCG*@10': 0.1092731488438753, 'MRR*@10': 0.08393050644260186, 'Recall*@5': 0.13147669915969556, 'NDCG*@5': 0.08945504518655631, 'MRR*@5': 0.07571208190459472}
INFO    [05-06 16:30:03] train in BasicTrainer:
duration: 5.1144118309021s
INFO    [05-06 16:30:03] train in BasicTrainer:
epoch: 22
INFO    [05-06 16:30:06] _train_one_epoch in BasicTrainer:
loss = 4.079601905447372
INFO    [05-06 16:30:08] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-06 16:30:08] validate in BasicTrainer:
{'Recall@10': 0.19852556173618024, 'NDCG@10': 0.11029781687718171, 'MRR@10': 0.08342363799993809, 'Recall@5': 0.13614456355571747, 'NDCG@5': 0.09018046924701104, 'MRR@5': 0.07515629123036678, 'Recall*@10': 0.19852556173618024, 'NDCG*@10': 0.11029781687718171, 'MRR*@10': 0.08342363799993809, 'Recall*@5': 0.13614456355571747, 'NDCG*@5': 0.09018046924701104, 'MRR*@5': 0.07515629123036678}
INFO    [05-06 16:30:08] train in BasicTrainer:
duration: 5.377970457077026s
INFO    [05-06 16:30:08] train in BasicTrainer:
epoch: 23
INFO    [05-06 16:30:11] _train_one_epoch in BasicTrainer:
loss = 4.057043728676248
INFO    [05-06 16:30:13] validate in BasicTrainer:
{'Recall@10': 0.19313773283591637, 'NDCG@10': 0.10914288862393452, 'MRR@10': 0.08359629202347535, 'Recall@5': 0.1305336058139801, 'NDCG@5': 0.0888168582549462, 'MRR@5': 0.07516199350357056, 'Recall*@10': 0.19313773283591637, 'NDCG*@10': 0.10914288862393452, 'MRR*@10': 0.08359629202347535, 'Recall*@5': 0.1305336058139801, 'NDCG*@5': 0.0888168582549462, 'MRR*@5': 0.07516199350357056}
INFO    [05-06 16:30:13] train in BasicTrainer:
duration: 4.96393895149231s
INFO    [05-06 16:30:13] train in BasicTrainer:
epoch: 24
INFO    [05-06 16:30:16] _train_one_epoch in BasicTrainer:
loss = 4.031872384091641
INFO    [05-06 16:30:18] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-06 16:30:18] validate in BasicTrainer:
{'Recall@10': 0.19798707503538865, 'NDCG@10': 0.1112735798725715, 'MRR@10': 0.08480471028731419, 'Recall@5': 0.1384294078900264, 'NDCG@5': 0.09200459546767749, 'MRR@5': 0.07684374314088088, 'Recall*@10': 0.19798707503538865, 'NDCG*@10': 0.1112735798725715, 'MRR*@10': 0.08480471028731419, 'Recall*@5': 0.1384294078900264, 'NDCG*@5': 0.09200459546767749, 'MRR*@5': 0.07684374314088088}
INFO    [05-06 16:30:18] train in BasicTrainer:
duration: 5.137713670730591s
INFO    [05-06 16:30:18] train in BasicTrainer:
epoch: 25
INFO    [05-06 16:30:21] _train_one_epoch in BasicTrainer:
loss = 4.010464918106161
INFO    [05-06 16:30:23] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-06 16:30:23] validate in BasicTrainer:
{'Recall@10': 0.19840655877039984, 'NDCG@10': 0.11257720108215626, 'MRR@10': 0.08631297974632336, 'Recall@5': 0.14153239245598132, 'NDCG@5': 0.09429322412380806, 'MRR@5': 0.07883405771393043, 'Recall*@10': 0.19840655877039984, 'NDCG*@10': 0.11257720108215626, 'MRR*@10': 0.08631297974632336, 'Recall*@5': 0.14153239245598132, 'NDCG*@5': 0.09429322412380806, 'MRR*@5': 0.07883405771393043}
INFO    [05-06 16:30:23] train in BasicTrainer:
duration: 5.2007365226745605s
INFO    [05-06 16:30:23] train in BasicTrainer:
epoch: 26
DEBUG   [05-06 16:30:26] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 505680
DEBUG   [05-06 16:30:26] calculate_loss in loss:
pred max in softmax: 0.20231764018535614, argmax 33693
DEBUG   [05-06 16:30:26] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 19461
DEBUG   [05-06 16:30:26] calculate_loss in loss:
pred max in softmax: 0.26394549012184143, argmax 8627
INFO    [05-06 16:30:27] _train_one_epoch in BasicTrainer:
loss = 3.9895219270219195
INFO    [05-06 16:30:29] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-06 16:30:29] validate in BasicTrainer:
{'Recall@10': 0.1997483097589933, 'NDCG@10': 0.1148728969005438, 'MRR@10': 0.08903961972548412, 'Recall@5': 0.1377867953135417, 'NDCG@5': 0.09491881613547985, 'MRR@5': 0.08085407288028644, 'Recall*@10': 0.1997483097589933, 'NDCG*@10': 0.1148728969005438, 'MRR*@10': 0.08903961972548412, 'Recall*@5': 0.1377867953135417, 'NDCG*@5': 0.09491881613547985, 'MRR*@5': 0.08085407288028644}
INFO    [05-06 16:30:29] train in BasicTrainer:
duration: 5.2978856563568115s
INFO    [05-06 16:30:29] train in BasicTrainer:
epoch: 27
INFO    [05-06 16:30:32] _train_one_epoch in BasicTrainer:
loss = 3.9736269826584674
INFO    [05-06 16:30:34] validate in BasicTrainer:
{'Recall@10': 0.19447948382450983, 'NDCG@10': 0.11213391044965157, 'MRR@10': 0.08720044934978852, 'Recall@5': 0.13418102608277246, 'NDCG@5': 0.09284475961556801, 'MRR@5': 0.07936089084698604, 'Recall*@10': 0.19447948382450983, 'NDCG*@10': 0.11213391044965157, 'MRR*@10': 0.08720044934978852, 'Recall*@5': 0.13418102608277246, 'NDCG*@5': 0.09284475961556801, 'MRR*@5': 0.07936089084698604}
INFO    [05-06 16:30:34] train in BasicTrainer:
duration: 5.283852577209473s
INFO    [05-06 16:30:34] train in BasicTrainer:
epoch: 28
INFO    [05-06 16:30:37] _train_one_epoch in BasicTrainer:
loss = 3.9506311809762997
INFO    [05-06 16:30:39] validate in BasicTrainer:
{'Recall@10': 0.2026132895396306, 'NDCG@10': 0.11466591977156125, 'MRR@10': 0.08806301939945954, 'Recall@5': 0.13413937504474932, 'NDCG@5': 0.09258230947531186, 'MRR@5': 0.07898345303076965, 'Recall*@10': 0.2026132895396306, 'NDCG*@10': 0.11466591977156125, 'MRR*@10': 0.08806301939945954, 'Recall*@5': 0.13413937504474932, 'NDCG*@5': 0.09258230947531186, 'MRR*@5': 0.07898345303076965}
INFO    [05-06 16:30:39] train in BasicTrainer:
duration: 5.276803970336914s
INFO    [05-06 16:30:39] train in BasicTrainer:
epoch: 29
INFO    [05-06 16:30:42] _train_one_epoch in BasicTrainer:
loss = 3.9369397898937795
INFO    [05-06 16:30:44] validate in BasicTrainer:
{'Recall@10': 0.20109006074758676, 'NDCG@10': 0.11396854714705394, 'MRR@10': 0.08755234113106361, 'Recall@5': 0.13580243174846357, 'NDCG@5': 0.0928106176165434, 'MRR@5': 0.07879498429023303, 'Recall*@10': 0.20109006074758676, 'NDCG*@10': 0.11396854714705394, 'MRR*@10': 0.08755234113106361, 'Recall*@5': 0.13580243174846357, 'NDCG*@5': 0.0928106176165434, 'MRR*@5': 0.07879498429023303}
INFO    [05-06 16:30:44] train in BasicTrainer:
duration: 5.083839416503906s
INFO    [05-06 16:30:44] train in BasicTrainer:
epoch: 30
INFO    [05-06 16:30:48] _train_one_epoch in BasicTrainer:
loss = 3.915969711668948
INFO    [05-06 16:30:49] validate in BasicTrainer:
{'Recall@10': 0.20020944338578445, 'NDCG@10': 0.11421188712120056, 'MRR@10': 0.08810636200583898, 'Recall@5': 0.13776597036765173, 'NDCG@5': 0.09420607525568742, 'MRR@5': 0.07995842941678487, 'Recall*@10': 0.20020944338578445, 'NDCG*@10': 0.11421188712120056, 'MRR*@10': 0.08810636200583898, 'Recall*@5': 0.13776597036765173, 'NDCG*@5': 0.09420607525568742, 'MRR*@5': 0.07995842941678487}
INFO    [05-06 16:30:49] train in BasicTrainer:
duration: 5.120604515075684s
INFO    [05-06 16:30:49] train in BasicTrainer:
epoch: 31
DEBUG   [05-06 16:30:52] calculate_loss in loss:
soft_target max: 0.5017096400260925, argmax 776085
DEBUG   [05-06 16:30:52] calculate_loss in loss:
pred max in softmax: 0.4011875092983246, argmax 62326
DEBUG   [05-06 16:30:52] calculate_loss in loss:
soft_target max: 0.501916766166687, argmax 606000
DEBUG   [05-06 16:30:52] calculate_loss in loss:
pred max in softmax: 0.6121297478675842, argmax 3063
INFO    [05-06 16:30:53] _train_one_epoch in BasicTrainer:
loss = 3.897049902601445
INFO    [05-06 16:30:55] validate in BasicTrainer:
{'Recall@10': 0.20048909920912522, 'NDCG@10': 0.11456508590624882, 'MRR@10': 0.0883215660086045, 'Recall@5': 0.14229400685200325, 'NDCG@5': 0.09590801653953698, 'MRR@5': 0.08071558177471161, 'Recall*@10': 0.20048909920912522, 'NDCG*@10': 0.11456508590624882, 'MRR*@10': 0.0883215660086045, 'Recall*@5': 0.14229400685200325, 'NDCG*@5': 0.09590801653953698, 'MRR*@5': 0.08071558177471161}
INFO    [05-06 16:30:55] train in BasicTrainer:
duration: 5.255687713623047s
INFO    [05-06 16:30:55] train in BasicTrainer:
epoch: 32
INFO    [05-06 16:30:58] _train_one_epoch in BasicTrainer:
loss = 3.8782895841497056
INFO    [05-06 16:31:00] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-06 16:31:00] validate in BasicTrainer:
{'Recall@10': 0.20533844255484068, 'NDCG@10': 0.11703497171401978, 'MRR@10': 0.0902293725655629, 'Recall@5': 0.1398693357522671, 'NDCG@5': 0.09599079535557674, 'MRR@5': 0.08161464390846399, 'Recall*@10': 0.20533844255484068, 'NDCG*@10': 0.11703497171401978, 'MRR*@10': 0.0902293725655629, 'Recall*@5': 0.1398693357522671, 'NDCG*@5': 0.09599079535557674, 'MRR*@5': 0.08161464390846399}
INFO    [05-06 16:31:00] train in BasicTrainer:
duration: 5.2769458293914795s
INFO    [05-06 16:31:00] train in BasicTrainer:
epoch: 33
INFO    [05-06 16:31:03] _train_one_epoch in BasicTrainer:
loss = 3.8669375130470764
INFO    [05-06 16:31:05] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-06 16:31:05] validate in BasicTrainer:
{'Recall@10': 0.2035147318473229, 'NDCG@10': 0.11779935314105107, 'MRR@10': 0.09172435219471271, 'Recall@5': 0.14061012405615586, 'NDCG@5': 0.09746340432992348, 'MRR@5': 0.0833370046546826, 'Recall*@10': 0.2035147318473229, 'NDCG*@10': 0.11779935314105107, 'MRR*@10': 0.09172435219471271, 'Recall*@5': 0.14061012405615586, 'NDCG*@5': 0.09746340432992348, 'MRR*@5': 0.0833370046546826}
INFO    [05-06 16:31:05] train in BasicTrainer:
duration: 5.186848163604736s
INFO    [05-06 16:31:05] train in BasicTrainer:
epoch: 34
INFO    [05-06 16:31:08] _train_one_epoch in BasicTrainer:
loss = 3.850007399599603
INFO    [05-06 16:31:10] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-06 16:31:10] validate in BasicTrainer:
{'Recall@10': 0.20499631074758676, 'NDCG@10': 0.11997000701152362, 'MRR@10': 0.09398242286764659, 'Recall@5': 0.14541781636384818, 'NDCG@5': 0.10074472713928956, 'MRR@5': 0.08607133076741146, 'Recall*@10': 0.20499631074758676, 'NDCG*@10': 0.11997000701152362, 'MRR*@10': 0.09398242286764659, 'Recall*@5': 0.14541781636384818, 'NDCG*@5': 0.10074472713928956, 'MRR*@5': 0.08607133076741146}
INFO    [05-06 16:31:10] train in BasicTrainer:
duration: 5.106822490692139s
INFO    [05-06 16:31:10] train in BasicTrainer:
epoch: 35
INFO    [05-06 16:31:14] _train_one_epoch in BasicTrainer:
loss = 3.8302799501317613
INFO    [05-06 16:31:15] validate in BasicTrainer:
{'Recall@10': 0.20305359822053176, 'NDCG@10': 0.11654790834738658, 'MRR@10': 0.09011378425818223, 'Recall@5': 0.14255283658321088, 'NDCG@5': 0.09689399542716834, 'MRR@5': 0.08194998250557826, 'Recall*@10': 0.20305359822053176, 'NDCG*@10': 0.11654790834738658, 'MRR*@10': 0.09011378425818223, 'Recall*@5': 0.14255283658321088, 'NDCG*@5': 0.09689399542716834, 'MRR*@5': 0.08194998250557826}
INFO    [05-06 16:31:15] train in BasicTrainer:
duration: 5.130939960479736s
INFO    [05-06 16:31:15] train in BasicTrainer:
epoch: 36
INFO    [05-06 16:31:19] _train_one_epoch in BasicTrainer:
loss = 3.8238601418251688
INFO    [05-06 16:31:20] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-06 16:31:20] validate in BasicTrainer:
{'Recall@10': 0.2054574443743779, 'NDCG@10': 0.12067353897369824, 'MRR@10': 0.09487557124633056, 'Recall@5': 0.1439362386098275, 'NDCG@5': 0.10078188605033435, 'MRR@5': 0.08666802598879887, 'Recall*@10': 0.2054574443743779, 'NDCG*@10': 0.12067353897369824, 'MRR*@10': 0.09487557124633056, 'Recall*@5': 0.1439362386098275, 'NDCG*@5': 0.10078188605033435, 'MRR*@5': 0.08666802598879887}
INFO    [05-06 16:31:20] train in BasicTrainer:
duration: 5.071502447128296s
INFO    [05-06 16:31:20] train in BasicTrainer:
epoch: 37
DEBUG   [05-06 16:31:21] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 902035
DEBUG   [05-06 16:31:21] calculate_loss in loss:
pred max in softmax: 0.5105165243148804, argmax 477119
DEBUG   [05-06 16:31:21] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 471689
DEBUG   [05-06 16:31:21] calculate_loss in loss:
pred max in softmax: 0.3482133448123932, argmax 687262
INFO    [05-06 16:31:24] _train_one_epoch in BasicTrainer:
loss = 3.8047671254645
INFO    [05-06 16:31:26] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [05-06 16:31:26] validate in BasicTrainer:
{'Recall@10': 0.20485648283591637, 'NDCG@10': 0.12090825002927047, 'MRR@10': 0.09522531525446819, 'Recall@5': 0.1496453732252121, 'NDCG@5': 0.1030609796826656, 'MRR@5': 0.08785998362761277, 'Recall*@10': 0.20485648283591637, 'NDCG*@10': 0.12090825002927047, 'MRR*@10': 0.09522531525446819, 'Recall*@5': 0.1496453732252121, 'NDCG*@5': 0.1030609796826656, 'MRR*@5': 0.08785998362761277}
INFO    [05-06 16:31:26] train in BasicTrainer:
duration: 5.250103712081909s
INFO    [05-06 16:31:26] train in BasicTrainer:
epoch: 38
INFO    [05-06 16:31:29] _train_one_epoch in BasicTrainer:
loss = 3.795995400307026
INFO    [05-06 16:31:32] validate in BasicTrainer:
{'Recall@10': 0.2025924645937406, 'NDCG@10': 0.11969627153414947, 'MRR@10': 0.09431408689572261, 'Recall@5': 0.14814296937905824, 'NDCG@5': 0.10209839848371652, 'MRR@5': 0.08705840374414738, 'Recall*@10': 0.2025924645937406, 'NDCG*@10': 0.11969627153414947, 'MRR*@10': 0.09431408689572261, 'Recall*@5': 0.14814296937905824, 'NDCG*@5': 0.10209839848371652, 'MRR*@5': 0.08705840374414738}
INFO    [05-06 16:31:32] train in BasicTrainer:
duration: 6.737273216247559s
INFO    [05-06 16:31:32] train in BasicTrainer:
epoch: 39
INFO    [05-06 16:31:36] _train_one_epoch in BasicTrainer:
loss = 3.7779786155578936
INFO    [05-06 16:31:38] validate in BasicTrainer:
{'Recall@10': 0.20499631074758676, 'NDCG@10': 0.1181199115056258, 'MRR@10': 0.09170110581012872, 'Recall@5': 0.14153239245598132, 'NDCG@5': 0.09770803153514862, 'MRR@5': 0.08333859134178895, 'Recall*@10': 0.20499631074758676, 'NDCG*@10': 0.1181199115056258, 'MRR*@10': 0.09170110581012872, 'Recall*@5': 0.14153239245598132, 'NDCG*@5': 0.09770803153514862, 'MRR*@5': 0.08333859134178895}
INFO    [05-06 16:31:38] train in BasicTrainer:
duration: 5.41515851020813s
INFO    [05-06 16:31:38] train in BasicTrainer:
epoch: 40
INFO    [05-06 16:31:41] _train_one_epoch in BasicTrainer:
loss = 3.7615523452454425
INFO    [05-06 16:31:43] validate in BasicTrainer:
{'Recall@10': 0.20635888668207023, 'NDCG@10': 0.12089535135489243, 'MRR@10': 0.0947237410224401, 'Recall@5': 0.15188856652149788, 'NDCG@5': 0.10343203579003994, 'MRR@5': 0.08760620997502254, 'Recall*@10': 0.20635888668207023, 'NDCG*@10': 0.12089535135489243, 'MRR*@10': 0.0947237410224401, 'Recall*@5': 0.15188856652149788, 'NDCG*@5': 0.10343203579003994, 'MRR*@5': 0.08760620997502254}
INFO    [05-06 16:31:43] train in BasicTrainer:
duration: 5.203803777694702s
INFO    [05-06 16:31:43] train in BasicTrainer:
epoch: 41
INFO    [05-06 16:31:46] _train_one_epoch in BasicTrainer:
loss = 3.7584603492249835
INFO    [05-06 16:31:48] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-06 16:31:48] validate in BasicTrainer:
{'Recall@10': 0.2119490194779176, 'NDCG@10': 0.1229430752304884, 'MRR@10': 0.09594472726950279, 'Recall@5': 0.14391541251769432, 'NDCG@5': 0.10110042473444572, 'MRR@5': 0.08702329890086101, 'Recall*@10': 0.2119490194779176, 'NDCG*@10': 0.1229430752304884, 'MRR*@10': 0.09594472726950279, 'Recall*@5': 0.14391541251769432, 'NDCG*@5': 0.10110042473444572, 'MRR*@5': 0.08702329890086101}
INFO    [05-06 16:31:48] train in BasicTrainer:
duration: 5.260605812072754s
INFO    [05-06 16:31:48] train in BasicTrainer:
epoch: 42
DEBUG   [05-06 16:31:50] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 493571
DEBUG   [05-06 16:31:50] calculate_loss in loss:
pred max in softmax: 0.363255113363266, argmax 514045
DEBUG   [05-06 16:31:50] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 891094
DEBUG   [05-06 16:31:50] calculate_loss in loss:
pred max in softmax: 0.5192225575447083, argmax 815379
INFO    [05-06 16:31:52] _train_one_epoch in BasicTrainer:
loss = 3.740830676352724
INFO    [05-06 16:31:53] validate in BasicTrainer:
{'Recall@10': 0.2110475771702253, 'NDCG@10': 0.1216193620975201, 'MRR@10': 0.09441316643586525, 'Recall@5': 0.14680121839046478, 'NDCG@5': 0.1011129142000125, 'MRR@5': 0.08610598742961884, 'Recall*@10': 0.2110475771702253, 'NDCG*@10': 0.1216193620975201, 'MRR*@10': 0.09441316643586525, 'Recall*@5': 0.14680121839046478, 'NDCG*@5': 0.1011129142000125, 'MRR*@5': 0.08610598742961884}
INFO    [05-06 16:31:53] train in BasicTrainer:
duration: 5.144007921218872s
INFO    [05-06 16:31:53] train in BasicTrainer:
epoch: 43
INFO    [05-06 16:31:57] _train_one_epoch in BasicTrainer:
loss = 3.733583279112552
INFO    [05-06 16:31:59] validate in BasicTrainer:
{'Recall@10': 0.20758163470488328, 'NDCG@10': 0.12229791111671008, 'MRR@10': 0.09623313236695069, 'Recall@5': 0.150406987621234, 'NDCG@5': 0.10384662162799102, 'MRR@5': 0.08864143204230529, 'Recall*@10': 0.20758163470488328, 'NDCG*@10': 0.12229791111671008, 'MRR*@10': 0.09623313236695069, 'Recall*@5': 0.150406987621234, 'NDCG*@5': 0.10384662162799102, 'MRR*@5': 0.08864143204230529}
INFO    [05-06 16:31:59] train in BasicTrainer:
duration: 5.114725351333618s
INFO    [05-06 16:31:59] train in BasicTrainer:
epoch: 44
INFO    [05-06 16:32:02] _train_one_epoch in BasicTrainer:
loss = 3.714761849413527
INFO    [05-06 16:32:04] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-06 16:32:04] validate in BasicTrainer:
{'Recall@10': 0.20607923085872942, 'NDCG@10': 0.12322958329549202, 'MRR@10': 0.09790966258599208, 'Recall@5': 0.14862492795173937, 'NDCG@5': 0.10460506666165131, 'MRR@5': 0.09020055887790826, 'Recall*@10': 0.20607923085872942, 'NDCG*@10': 0.12322958329549202, 'MRR*@10': 0.09790966258599208, 'Recall*@5': 0.14862492795173937, 'NDCG*@5': 0.10460506666165131, 'MRR*@5': 0.09020055887790826}
INFO    [05-06 16:32:04] train in BasicTrainer:
duration: 5.145577907562256s
INFO    [05-06 16:32:04] train in BasicTrainer:
epoch: 45
INFO    [05-06 16:32:07] _train_one_epoch in BasicTrainer:
loss = 3.712056573401106
INFO    [05-06 16:32:09] validate in BasicTrainer:
{'Recall@10': 0.20695984822053176, 'NDCG@10': 0.12281682972724621, 'MRR@10': 0.09707579303246278, 'Recall@5': 0.1478424886098275, 'NDCG@5': 0.10371256046570264, 'MRR@5': 0.08919687683765705, 'Recall*@10': 0.20695984822053176, 'NDCG*@10': 0.12281682972724621, 'MRR*@10': 0.09707579303246278, 'Recall*@5': 0.1478424886098275, 'NDCG*@5': 0.10371256046570264, 'MRR*@5': 0.08919687683765705}
INFO    [05-06 16:32:09] train in BasicTrainer:
duration: 5.031176567077637s
INFO    [05-06 16:32:09] train in BasicTrainer:
epoch: 46
INFO    [05-06 16:32:12] _train_one_epoch in BasicTrainer:
loss = 3.6956075518689255
INFO    [05-06 16:32:14] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-06 16:32:14] validate in BasicTrainer:
{'Recall@10': 0.2123893270125756, 'NDCG@10': 0.12497543772825828, 'MRR@10': 0.09825500788596961, 'Recall@5': 0.15054681553290442, 'NDCG@5': 0.10491023785792865, 'MRR@5': 0.0899380617416822, 'Recall*@10': 0.2123893270125756, 'NDCG*@10': 0.12497543772825828, 'MRR*@10': 0.09825500788596961, 'Recall*@5': 0.15054681553290442, 'NDCG*@5': 0.10491023785792865, 'MRR*@5': 0.0899380617416822}
INFO    [05-06 16:32:14] train in BasicTrainer:
duration: 5.379547595977783s
INFO    [05-06 16:32:14] train in BasicTrainer:
epoch: 47
DEBUG   [05-06 16:32:17] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 70519
DEBUG   [05-06 16:32:17] calculate_loss in loss:
pred max in softmax: 0.49806156754493713, argmax 211750
DEBUG   [05-06 16:32:17] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 720853
DEBUG   [05-06 16:32:17] calculate_loss in loss:
pred max in softmax: 0.5418577194213867, argmax 455573
INFO    [05-06 16:32:18] _train_one_epoch in BasicTrainer:
loss = 3.691340797759117
INFO    [05-06 16:32:19] validate in BasicTrainer:
{'Recall@10': 0.20577875008949867, 'NDCG@10': 0.12476587123595752, 'MRR@10': 0.09995994831507023, 'Recall@5': 0.15010650685200325, 'NDCG@5': 0.10679030819581105, 'MRR@5': 0.09256091943153968, 'Recall*@10': 0.20577875008949867, 'NDCG*@10': 0.12476587123595752, 'MRR*@10': 0.09995994831507023, 'Recall*@5': 0.15010650685200325, 'NDCG*@5': 0.10679030819581105, 'MRR*@5': 0.09256091943153968}
INFO    [05-06 16:32:19] train in BasicTrainer:
duration: 5.257946729660034s
INFO    [05-06 16:32:19] train in BasicTrainer:
epoch: 48
INFO    [05-06 16:32:23] _train_one_epoch in BasicTrainer:
loss = 3.6800615039277584
INFO    [05-06 16:32:25] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-06 16:32:25] validate in BasicTrainer:
{'Recall@10': 0.20922386646270752, 'NDCG@10': 0.126196393599877, 'MRR@10': 0.10087861980383213, 'Recall@5': 0.15204921937905824, 'NDCG@5': 0.10797524796082424, 'MRR@5': 0.09350927059467022, 'Recall*@10': 0.20922386646270752, 'NDCG*@10': 0.126196393599877, 'MRR*@10': 0.10087861980383213, 'Recall*@5': 0.15204921937905824, 'NDCG*@5': 0.10797524796082424, 'MRR*@5': 0.09350927059467022}
INFO    [05-06 16:32:25] train in BasicTrainer:
duration: 5.408486366271973s
INFO    [05-06 16:32:25] train in BasicTrainer:
epoch: 49
INFO    [05-06 16:32:28] _train_one_epoch in BasicTrainer:
loss = 3.672683556029137
INFO    [05-06 16:32:30] validate in BasicTrainer:
{'Recall@10': 0.21086609822053176, 'NDCG@10': 0.12592399693452394, 'MRR@10': 0.09992197729074039, 'Recall@5': 0.15234970014828902, 'NDCG@5': 0.10703833687763947, 'MRR@5': 0.09214947258050625, 'Recall*@10': 0.21086609822053176, 'NDCG*@10': 0.12592399693452394, 'MRR*@10': 0.09992197729074039, 'Recall*@5': 0.15234970014828902, 'NDCG*@5': 0.10703833687763947, 'MRR*@5': 0.09214947258050625}
INFO    [05-06 16:32:30] train in BasicTrainer:
duration: 5.136740684509277s
INFO    [05-06 16:32:30] train in BasicTrainer:
epoch: 50
INFO    [05-06 16:32:33] _train_one_epoch in BasicTrainer:
loss = 3.6610968315854984
INFO    [05-06 16:32:35] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-06 16:32:35] validate in BasicTrainer:
{'Recall@10': 0.2151144788815425, 'NDCG@10': 0.1284882351756096, 'MRR@10': 0.1019803577890763, 'Recall@5': 0.15475354630213517, 'NDCG@5': 0.10898773486797626, 'MRR@5': 0.09394273505761074, 'Recall*@10': 0.2151144788815425, 'NDCG*@10': 0.1284882351756096, 'MRR*@10': 0.1019803577890763, 'Recall*@5': 0.15475354630213517, 'NDCG*@5': 0.10898773486797626, 'MRR*@5': 0.09394273505761074}
INFO    [05-06 16:32:35] train in BasicTrainer:
duration: 5.110908269882202s
INFO    [05-06 16:32:35] train in BasicTrainer:
epoch: 51
INFO    [05-06 16:32:38] _train_one_epoch in BasicTrainer:
loss = 3.6497464902857515
INFO    [05-06 16:32:40] validate in BasicTrainer:
{'Recall@10': 0.20728115393565252, 'NDCG@10': 0.12583865855748838, 'MRR@10': 0.10080074461606833, 'Recall@5': 0.15429241267534402, 'NDCG@5': 0.10874300106213643, 'MRR@5': 0.0937653722671362, 'Recall*@10': 0.20728115393565252, 'NDCG*@10': 0.12583865855748838, 'MRR*@10': 0.10080074461606833, 'Recall*@5': 0.15429241267534402, 'NDCG*@5': 0.10874300106213643, 'MRR*@5': 0.0937653722671362}
INFO    [05-06 16:32:40] train in BasicTrainer:
duration: 4.99985146522522s
INFO    [05-06 16:32:40] train in BasicTrainer:
epoch: 52
INFO    [05-06 16:32:43] _train_one_epoch in BasicTrainer:
loss = 3.643965648843887
INFO    [05-06 16:32:45] validate in BasicTrainer:
{'Recall@10': 0.20770063767066368, 'NDCG@10': 0.12485947058751033, 'MRR@10': 0.09946177040155117, 'Recall@5': 0.1517487386098275, 'NDCG@5': 0.10680958456718005, 'MRR@5': 0.09203616930888249, 'Recall*@10': 0.20770063767066368, 'NDCG*@10': 0.12485947058751033, 'MRR*@10': 0.09946177040155117, 'Recall*@5': 0.1517487386098275, 'NDCG*@5': 0.10680958456718005, 'MRR*@5': 0.09203616930888249}
INFO    [05-06 16:32:45] train in BasicTrainer:
duration: 4.980813980102539s
INFO    [05-06 16:32:45] train in BasicTrainer:
epoch: 53
DEBUG   [05-06 16:32:46] calculate_loss in loss:
soft_target max: 0.5017096400260925, argmax 192565
DEBUG   [05-06 16:32:46] calculate_loss in loss:
pred max in softmax: 0.5554184913635254, argmax 594086
DEBUG   [05-06 16:32:46] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 489924
DEBUG   [05-06 16:32:46] calculate_loss in loss:
pred max in softmax: 0.5477169156074524, argmax 441382
INFO    [05-06 16:32:48] _train_one_epoch in BasicTrainer:
loss = 3.63670551776886
INFO    [05-06 16:32:50] validate in BasicTrainer:
{'Recall@10': 0.20758163470488328, 'NDCG@10': 0.12634805188729212, 'MRR@10': 0.1013120160653041, 'Recall@5': 0.15207004432494825, 'NDCG@5': 0.1081821362559612, 'MRR@5': 0.09368638407725555, 'Recall*@10': 0.20758163470488328, 'NDCG*@10': 0.12634805188729212, 'MRR*@10': 0.1013120160653041, 'Recall*@5': 0.15207004432494825, 'NDCG*@5': 0.1081821362559612, 'MRR*@5': 0.09368638407725555}
INFO    [05-06 16:32:50] train in BasicTrainer:
duration: 5.126827239990234s
INFO    [05-06 16:32:50] train in BasicTrainer:
epoch: 54
INFO    [05-06 16:32:54] _train_one_epoch in BasicTrainer:
loss = 3.6237190454564194
INFO    [05-06 16:32:55] log in loggers:
Update Best NDCG@10 Model at 54
INFO    [05-06 16:32:56] validate in BasicTrainer:
{'Recall@10': 0.21102675107809213, 'NDCG@10': 0.1289167690735597, 'MRR@10': 0.10365543170617177, 'Recall@5': 0.15747869817110208, 'NDCG@5': 0.11170270179326718, 'MRR@5': 0.09660903192483462, 'Recall*@10': 0.21102675107809213, 'NDCG*@10': 0.1289167690735597, 'MRR*@10': 0.10365543170617177, 'Recall*@5': 0.15747869817110208, 'NDCG*@5': 0.11170270179326718, 'MRR*@5': 0.09660903192483462}
INFO    [05-06 16:32:56] train in BasicTrainer:
duration: 5.3757970333099365s
INFO    [05-06 16:32:56] train in BasicTrainer:
epoch: 55
INFO    [05-06 16:32:59] _train_one_epoch in BasicTrainer:
loss = 3.617238959099384
INFO    [05-06 16:33:01] validate in BasicTrainer:
{'Recall@10': 0.20968500008949867, 'NDCG@10': 0.12711029671705687, 'MRR@10': 0.10180608584330632, 'Recall@5': 0.15265018091751978, 'NDCG@5': 0.10869264258788182, 'MRR@5': 0.09421966454157463, 'Recall*@10': 0.20968500008949867, 'NDCG*@10': 0.12711029671705687, 'MRR*@10': 0.10180608584330632, 'Recall*@5': 0.15265018091751978, 'NDCG*@5': 0.10869264258788182, 'MRR*@5': 0.09421966454157463}
INFO    [05-06 16:33:01] train in BasicTrainer:
duration: 5.172342300415039s
INFO    [05-06 16:33:01] train in BasicTrainer:
epoch: 56
INFO    [05-06 16:33:04] _train_one_epoch in BasicTrainer:
loss = 3.6076389500435364
INFO    [05-06 16:33:06] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-06 16:33:06] validate in BasicTrainer:
{'Recall@10': 0.21118740393565252, 'NDCG@10': 0.1291225145642574, 'MRR@10': 0.10395547575675525, 'Recall@5': 0.1573388702594317, 'NDCG@5': 0.11186566776954211, 'MRR@5': 0.09692607533473235, 'Recall*@10': 0.21118740393565252, 'NDCG*@10': 0.1291225145642574, 'MRR*@10': 0.10395547575675525, 'Recall*@5': 0.1573388702594317, 'NDCG*@5': 0.11186566776954211, 'MRR*@5': 0.09692607533473235}
INFO    [05-06 16:33:06] train in BasicTrainer:
duration: 5.330785512924194s
INFO    [05-06 16:33:06] train in BasicTrainer:
epoch: 57
INFO    [05-06 16:33:09] _train_one_epoch in BasicTrainer:
loss = 3.5965342255348856
INFO    [05-06 16:33:11] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-06 16:33:11] validate in BasicTrainer:
{'Recall@10': 0.20922386646270752, 'NDCG@10': 0.1300585321508921, 'MRR@10': 0.10567820014861914, 'Recall@5': 0.158240312567124, 'NDCG@5': 0.11358445080427024, 'MRR@5': 0.09888648642943455, 'Recall*@10': 0.20922386646270752, 'NDCG*@10': 0.1300585321508921, 'MRR*@10': 0.10567820014861914, 'Recall*@5': 0.158240312567124, 'NDCG*@5': 0.11358445080427024, 'MRR*@5': 0.09888648642943455}
INFO    [05-06 16:33:11] train in BasicTrainer:
duration: 5.219683885574341s
INFO    [05-06 16:33:11] train in BasicTrainer:
epoch: 58
DEBUG   [05-06 16:33:13] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 205458
DEBUG   [05-06 16:33:13] calculate_loss in loss:
pred max in softmax: 0.4597668945789337, argmax 342770
DEBUG   [05-06 16:33:13] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 352506
DEBUG   [05-06 16:33:13] calculate_loss in loss:
pred max in softmax: 0.4102872610092163, argmax 772894
INFO    [05-06 16:33:15] _train_one_epoch in BasicTrainer:
loss = 3.5967809063323
INFO    [05-06 16:33:17] validate in BasicTrainer:
{'Recall@10': 0.21315094255484068, 'NDCG@10': 0.12843518474927315, 'MRR@10': 0.10250225204687852, 'Recall@5': 0.15220987223661864, 'NDCG@5': 0.10863736615731166, 'MRR@5': 0.0942785688317739, 'Recall*@10': 0.21315094255484068, 'NDCG*@10': 0.12843518474927315, 'MRR*@10': 0.10250225204687852, 'Recall*@5': 0.15220987223661864, 'NDCG*@5': 0.10863736615731166, 'MRR*@5': 0.0942785688317739}
INFO    [05-06 16:33:17] train in BasicTrainer:
duration: 5.276612043380737s
INFO    [05-06 16:33:17] train in BasicTrainer:
epoch: 59
INFO    [05-06 16:33:20] _train_one_epoch in BasicTrainer:
loss = 3.583404944298115
INFO    [05-06 16:33:22] validate in BasicTrainer:
{'Recall@10': 0.2135704251436087, 'NDCG@10': 0.12910714688209388, 'MRR@10': 0.10315617517783092, 'Recall@5': 0.1580796597095636, 'NDCG@5': 0.11107799869317275, 'MRR@5': 0.0956692615380654, 'Recall*@10': 0.2135704251436087, 'NDCG*@10': 0.12910714688209388, 'MRR*@10': 0.10315617517783092, 'Recall*@5': 0.1580796597095636, 'NDCG*@5': 0.11107799869317275, 'MRR*@5': 0.0956692615380654}
INFO    [05-06 16:33:22] train in BasicTrainer:
duration: 5.28008246421814s
INFO    [05-06 16:33:22] train in BasicTrainer:
epoch: 60
INFO    [05-06 16:33:25] _train_one_epoch in BasicTrainer:
loss = 3.571418437551945
INFO    [05-06 16:33:27] validate in BasicTrainer:
{'Recall@10': 0.2132907693202679, 'NDCG@10': 0.1296540997349299, 'MRR@10': 0.10403541704783073, 'Recall@5': 0.15715739245598132, 'NDCG@5': 0.11173345778997128, 'MRR@5': 0.09677444398403168, 'Recall*@10': 0.2132907693202679, 'NDCG*@10': 0.1296540997349299, 'MRR*@10': 0.10403541704783073, 'Recall*@5': 0.15715739245598132, 'NDCG*@5': 0.11173345778997128, 'MRR*@5': 0.09677444398403168}
INFO    [05-06 16:33:27] train in BasicTrainer:
duration: 5.116762638092041s
INFO    [05-06 16:33:27] train in BasicTrainer:
epoch: 61
INFO    [05-06 16:33:30] _train_one_epoch in BasicTrainer:
loss = 3.5716752600162587
INFO    [05-06 16:33:32] validate in BasicTrainer:
{'Recall@10': 0.20800111843989447, 'NDCG@10': 0.12794201993025267, 'MRR@10': 0.1034006722844564, 'Recall@5': 0.150406987621234, 'NDCG@5': 0.10923435195134236, 'MRR@5': 0.09563261900956814, 'Recall*@10': 0.20800111843989447, 'NDCG*@10': 0.12794201993025267, 'MRR*@10': 0.1034006722844564, 'Recall*@5': 0.150406987621234, 'NDCG*@5': 0.10923435195134236, 'MRR*@5': 0.09563261900956814}
INFO    [05-06 16:33:32] train in BasicTrainer:
duration: 5.047768592834473s
INFO    [05-06 16:33:32] train in BasicTrainer:
epoch: 62
INFO    [05-06 16:33:35] _train_one_epoch in BasicTrainer:
loss = 3.561052553197171
INFO    [05-06 16:33:37] validate in BasicTrainer:
{'Recall@10': 0.20890256074758676, 'NDCG@10': 0.12984286707181197, 'MRR@10': 0.10557768723139396, 'Recall@5': 0.15371227608277246, 'NDCG@5': 0.11210451160485928, 'MRR@5': 0.09832246486957257, 'Recall*@10': 0.20890256074758676, 'NDCG*@10': 0.12984286707181197, 'MRR*@10': 0.10557768723139396, 'Recall*@5': 0.15371227608277246, 'NDCG*@5': 0.11210451160485928, 'MRR*@5': 0.09832246486957257}
INFO    [05-06 16:33:37] train in BasicTrainer:
duration: 5.0528178215026855s
INFO    [05-06 16:33:37] train in BasicTrainer:
epoch: 63
DEBUG   [05-06 16:33:40] calculate_loss in loss:
soft_target max: 0.501916766166687, argmax 296005
DEBUG   [05-06 16:33:40] calculate_loss in loss:
pred max in softmax: 0.32969310879707336, argmax 126781
DEBUG   [05-06 16:33:40] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 797440
DEBUG   [05-06 16:33:40] calculate_loss in loss:
pred max in softmax: 0.8650595545768738, argmax 591445
INFO    [05-06 16:33:40] _train_one_epoch in BasicTrainer:
loss = 3.5569598928410957
INFO    [05-06 16:33:42] validate in BasicTrainer:
{'Recall@10': 0.21100592613220215, 'NDCG@10': 0.1289458951124778, 'MRR@10': 0.1038234755396843, 'Recall@5': 0.15521467992892632, 'NDCG@5': 0.11121016167677365, 'MRR@5': 0.09668325862059227, 'Recall*@10': 0.21100592613220215, 'NDCG*@10': 0.1289458951124778, 'MRR*@10': 0.1038234755396843, 'Recall*@5': 0.15521467992892632, 'NDCG*@5': 0.11121016167677365, 'MRR*@5': 0.09668325862059227}
INFO    [05-06 16:33:42] train in BasicTrainer:
duration: 5.066819429397583s
INFO    [05-06 16:33:42] train in BasicTrainer:
epoch: 64
INFO    [05-06 16:33:45] _train_one_epoch in BasicTrainer:
loss = 3.552607517293159
INFO    [05-06 16:33:47] validate in BasicTrainer:
{'Recall@10': 0.21148788470488328, 'NDCG@10': 0.12980192785079664, 'MRR@10': 0.10471717210916373, 'Recall@5': 0.15581564146738786, 'NDCG@5': 0.11178960823095761, 'MRR@5': 0.09727990741913135, 'Recall*@10': 0.21148788470488328, 'NDCG*@10': 0.12980192785079664, 'MRR*@10': 0.10471717210916373, 'Recall*@5': 0.15581564146738786, 'NDCG*@5': 0.11178960823095761, 'MRR*@5': 0.09727990741913135}
INFO    [05-06 16:33:47] train in BasicTrainer:
duration: 5.13463020324707s
INFO    [05-06 16:33:47] train in BasicTrainer:
epoch: 65
INFO    [05-06 16:33:51] _train_one_epoch in BasicTrainer:
loss = 3.5432771647230106
INFO    [05-06 16:33:52] validate in BasicTrainer:
{'Recall@10': 0.21056561745130098, 'NDCG@10': 0.129033023921343, 'MRR@10': 0.10413910964360604, 'Recall@5': 0.15220987223661864, 'NDCG@5': 0.11029872928674404, 'MRR@5': 0.09648670485386482, 'Recall*@10': 0.21056561745130098, 'NDCG*@10': 0.129033023921343, 'MRR*@10': 0.10413910964360604, 'Recall*@5': 0.15220987223661864, 'NDCG*@5': 0.11029872928674404, 'MRR*@5': 0.09648670485386482}
INFO    [05-06 16:33:52] train in BasicTrainer:
duration: 5.204966306686401s
INFO    [05-06 16:33:52] train in BasicTrainer:
epoch: 66
INFO    [05-06 16:33:56] _train_one_epoch in BasicTrainer:
loss = 3.5362809718923365
INFO    [05-06 16:33:58] log in loggers:
Update Best NDCG@10 Model at 66
INFO    [05-06 16:33:58] validate in BasicTrainer:
{'Recall@10': 0.2134097722860483, 'NDCG@10': 0.13137270280948052, 'MRR@10': 0.1062671307187814, 'Recall@5': 0.15597629432494825, 'NDCG@5': 0.112998094696265, 'MRR@5': 0.09879788011312485, 'Recall*@10': 0.2134097722860483, 'NDCG*@10': 0.13137270280948052, 'MRR*@10': 0.1062671307187814, 'Recall*@5': 0.15597629432494825, 'NDCG*@5': 0.112998094696265, 'MRR*@5': 0.09879788011312485}
INFO    [05-06 16:33:58] train in BasicTrainer:
duration: 5.277600049972534s
INFO    [05-06 16:33:58] train in BasicTrainer:
epoch: 67
INFO    [05-06 16:34:01] _train_one_epoch in BasicTrainer:
loss = 3.526061054239882
INFO    [05-06 16:34:03] validate in BasicTrainer:
{'Recall@10': 0.20892338569347674, 'NDCG@10': 0.12856617054113975, 'MRR@10': 0.10390207343376599, 'Recall@5': 0.1555151606981571, 'NDCG@5': 0.11146700095671874, 'MRR@5': 0.09694620336477573, 'Recall*@10': 0.20892338569347674, 'NDCG*@10': 0.12856617054113975, 'MRR*@10': 0.10390207343376599, 'Recall*@5': 0.1555151606981571, 'NDCG*@5': 0.11146700095671874, 'MRR*@5': 0.09694620336477573}
INFO    [05-06 16:34:03] train in BasicTrainer:
duration: 5.080875635147095s
INFO    [05-06 16:34:03] train in BasicTrainer:
epoch: 68
INFO    [05-06 16:34:06] _train_one_epoch in BasicTrainer:
loss = 3.5224141630720585
INFO    [05-06 16:34:08] log in loggers:
Update Best NDCG@10 Model at 68
INFO    [05-06 16:34:08] validate in BasicTrainer:
{'Recall@10': 0.21070544536297137, 'NDCG@10': 0.13189841004518363, 'MRR@10': 0.10761603541099109, 'Recall@5': 0.15898110201725593, 'NDCG@5': 0.11524247721983837, 'MRR@5': 0.10078606296044129, 'Recall*@10': 0.21070544536297137, 'NDCG*@10': 0.13189841004518363, 'MRR*@10': 0.10761603541099109, 'Recall*@5': 0.15898110201725593, 'NDCG*@5': 0.11524247721983837, 'MRR*@5': 0.10078606296044129}
INFO    [05-06 16:34:08] train in BasicTrainer:
duration: 5.1841721534729s
INFO    [05-06 16:34:08] train in BasicTrainer:
epoch: 69
DEBUG   [05-06 16:34:09] calculate_loss in loss:
soft_target max: 0.501916766166687, argmax 168360
DEBUG   [05-06 16:34:09] calculate_loss in loss:
pred max in softmax: 0.7853550910949707, argmax 599209
DEBUG   [05-06 16:34:09] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 329456
DEBUG   [05-06 16:34:09] calculate_loss in loss:
pred max in softmax: 0.9368461966514587, argmax 613683
INFO    [05-06 16:34:11] _train_one_epoch in BasicTrainer:
loss = 3.5162482046066446
INFO    [05-06 16:34:13] validate in BasicTrainer:
{'Recall@10': 0.21236850206668562, 'NDCG@10': 0.13118200061412957, 'MRR@10': 0.10616452762713799, 'Recall@5': 0.15868062124802515, 'NDCG@5': 0.11407134452691445, 'MRR@5': 0.09925132932571265, 'Recall*@10': 0.21236850206668562, 'NDCG*@10': 0.13118200061412957, 'MRR*@10': 0.10616452762713799, 'Recall*@5': 0.15868062124802515, 'NDCG*@5': 0.11407134452691445, 'MRR*@5': 0.09925132932571265}
INFO    [05-06 16:34:13] train in BasicTrainer:
duration: 5.171582460403442s
INFO    [05-06 16:34:13] train in BasicTrainer:
epoch: 70
INFO    [05-06 16:34:16] _train_one_epoch in BasicTrainer:
loss = 3.5101588051369847
INFO    [05-06 16:34:18] validate in BasicTrainer:
{'Recall@10': 0.2143112145937406, 'NDCG@10': 0.13173565039267907, 'MRR@10': 0.10631605925468299, 'Recall@5': 0.1619859097095636, 'NDCG@5': 0.11509493681100699, 'MRR@5': 0.09961026849655005, 'Recall*@10': 0.2143112145937406, 'NDCG*@10': 0.13173565039267907, 'MRR*@10': 0.10631605925468299, 'Recall*@5': 0.1619859097095636, 'NDCG*@5': 0.11509493681100699, 'MRR*@5': 0.09961026849655005}
INFO    [05-06 16:34:18] train in BasicTrainer:
duration: 5.210258483886719s
INFO    [05-06 16:34:18] train in BasicTrainer:
epoch: 71
INFO    [05-06 16:34:22] _train_one_epoch in BasicTrainer:
loss = 3.506730411915069
INFO    [05-06 16:34:24] log in loggers:
Update Best NDCG@10 Model at 71
INFO    [05-06 16:34:24] validate in BasicTrainer:
{'Recall@10': 0.21735767332407144, 'NDCG@10': 0.13299342875297254, 'MRR@10': 0.10720154127249351, 'Recall@5': 0.15884127410558554, 'NDCG@5': 0.1143381056877283, 'MRR@5': 0.09965955580656345, 'Recall*@10': 0.21735767332407144, 'NDCG*@10': 0.13299342875297254, 'MRR*@10': 0.10720154127249351, 'Recall*@5': 0.15884127410558554, 'NDCG*@5': 0.1143381056877283, 'MRR*@5': 0.09965955580656345}
INFO    [05-06 16:34:24] train in BasicTrainer:
duration: 5.37401270866394s
INFO    [05-06 16:34:24] train in BasicTrainer:
epoch: 72
INFO    [05-06 16:34:27] _train_one_epoch in BasicTrainer:
loss = 3.5038251382239323
INFO    [05-06 16:34:29] validate in BasicTrainer:
{'Recall@10': 0.21206802129745483, 'NDCG@10': 0.13185059966949317, 'MRR@10': 0.10709807964471671, 'Recall@5': 0.1604835058634098, 'NDCG@5': 0.11529981574186912, 'MRR@5': 0.10033985399282895, 'Recall*@10': 0.21206802129745483, 'NDCG*@10': 0.13185059966949317, 'MRR*@10': 0.10709807964471671, 'Recall*@5': 0.1604835058634098, 'NDCG*@5': 0.11529981574186912, 'MRR*@5': 0.10033985399282895}
INFO    [05-06 16:34:29] train in BasicTrainer:
duration: 5.091954946517944s
INFO    [05-06 16:34:29] train in BasicTrainer:
epoch: 73
INFO    [05-06 16:34:32] _train_one_epoch in BasicTrainer:
loss = 3.497985412465765
INFO    [05-06 16:34:34] validate in BasicTrainer:
{'Recall@10': 0.2104257895396306, 'NDCG@10': 0.1313146364230376, 'MRR@10': 0.10694752920132417, 'Recall@5': 0.1604835058634098, 'NDCG@5': 0.11524909562789477, 'MRR@5': 0.10036821491443194, 'Recall*@10': 0.2104257895396306, 'NDCG*@10': 0.1313146364230376, 'MRR*@10': 0.10694752920132417, 'Recall*@5': 0.1604835058634098, 'NDCG*@5': 0.11524909562789477, 'MRR*@5': 0.10036821491443194}
INFO    [05-06 16:34:34] train in BasicTrainer:
duration: 5.366845369338989s
INFO    [05-06 16:34:34] train in BasicTrainer:
epoch: 74
DEBUG   [05-06 16:34:36] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 664980
DEBUG   [05-06 16:34:36] calculate_loss in loss:
pred max in softmax: 0.6155365109443665, argmax 726432
DEBUG   [05-06 16:34:36] calculate_loss in loss:
soft_target max: 0.501916766166687, argmax 219418
DEBUG   [05-06 16:34:36] calculate_loss in loss:
pred max in softmax: 0.6439446806907654, argmax 927151
INFO    [05-06 16:34:38] _train_one_epoch in BasicTrainer:
loss = 3.49248280804208
INFO    [05-06 16:34:39] validate in BasicTrainer:
{'Recall@10': 0.2132907693202679, 'NDCG@10': 0.12976960035470816, 'MRR@10': 0.10401224631529588, 'Recall@5': 0.15898110201725593, 'NDCG@5': 0.11242305659330808, 'MRR@5': 0.09698145893903878, 'Recall*@10': 0.2132907693202679, 'NDCG*@10': 0.12976960035470816, 'MRR*@10': 0.10401224631529588, 'Recall*@5': 0.15898110201725593, 'NDCG*@5': 0.11242305659330808, 'MRR*@5': 0.09698145893903878}
INFO    [05-06 16:34:39] train in BasicTrainer:
duration: 5.268462657928467s
INFO    [05-06 16:34:39] train in BasicTrainer:
epoch: 75
INFO    [05-06 16:34:43] _train_one_epoch in BasicTrainer:
loss = 3.485260196188663
INFO    [05-06 16:34:45] validate in BasicTrainer:
{'Recall@10': 0.21206802129745483, 'NDCG@10': 0.12960357448229423, 'MRR@10': 0.10416950686619832, 'Recall@5': 0.1583801404787944, 'NDCG@5': 0.11222531589177939, 'MRR@5': 0.09699102949637634, 'Recall*@10': 0.21206802129745483, 'NDCG*@10': 0.12960357448229423, 'MRR*@10': 0.10416950686619832, 'Recall*@5': 0.1583801404787944, 'NDCG*@5': 0.11222531589177939, 'MRR*@5': 0.09699102949637634}
INFO    [05-06 16:34:45] train in BasicTrainer:
duration: 5.357989072799683s
INFO    [05-06 16:34:45] train in BasicTrainer:
epoch: 76
INFO    [05-06 16:34:48] _train_one_epoch in BasicTrainer:
loss = 3.479465346387092
INFO    [05-06 16:34:50] validate in BasicTrainer:
{'Recall@10': 0.2113272318473229, 'NDCG@10': 0.13228854938195303, 'MRR@10': 0.10788640322593543, 'Recall@5': 0.1618669078900264, 'NDCG@5': 0.11640377228076641, 'MRR@5': 0.10139743467936149, 'Recall*@10': 0.2113272318473229, 'NDCG*@10': 0.13228854938195303, 'MRR*@10': 0.10788640322593543, 'Recall*@5': 0.1618669078900264, 'NDCG*@5': 0.11640377228076641, 'MRR*@5': 0.10139743467936149}
INFO    [05-06 16:34:50] train in BasicTrainer:
duration: 5.228816270828247s
INFO    [05-06 16:34:50] train in BasicTrainer:
epoch: 77
INFO    [05-06 16:34:53] _train_one_epoch in BasicTrainer:
loss = 3.4803461724139275
INFO    [05-06 16:34:55] validate in BasicTrainer:
{'Recall@10': 0.21583444338578445, 'NDCG@10': 0.13272189635496873, 'MRR@10': 0.10713108342427474, 'Recall@5': 0.1595612386098275, 'NDCG@5': 0.1145283763225262, 'MRR@5': 0.09962316029346906, 'Recall*@10': 0.21583444338578445, 'NDCG*@10': 0.13272189635496873, 'MRR*@10': 0.10713108342427474, 'Recall*@5': 0.1595612386098275, 'NDCG*@5': 0.1145283763225262, 'MRR*@5': 0.09962316029346906}
INFO    [05-06 16:34:55] train in BasicTrainer:
duration: 5.057801723480225s
INFO    [05-06 16:34:55] train in BasicTrainer:
epoch: 78
INFO    [05-06 16:34:58] _train_one_epoch in BasicTrainer:
loss = 3.475313591196182
INFO    [05-06 16:35:00] validate in BasicTrainer:
{'Recall@10': 0.21461169536297137, 'NDCG@10': 0.13215079960914758, 'MRR@10': 0.10676921560214116, 'Recall@5': 0.15655643091751978, 'NDCG@5': 0.1133232913338221, 'MRR@5': 0.09896874714356202, 'Recall*@10': 0.21461169536297137, 'NDCG*@10': 0.13215079960914758, 'MRR*@10': 0.10676921560214116, 'Recall*@5': 0.15655643091751978, 'NDCG*@5': 0.1133232913338221, 'MRR*@5': 0.09896874714356202}
INFO    [05-06 16:35:00] train in BasicTrainer:
duration: 5.114700794219971s
INFO    [05-06 16:35:00] train in BasicTrainer:
epoch: 79
DEBUG   [05-06 16:35:03] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 801087
DEBUG   [05-06 16:35:03] calculate_loss in loss:
pred max in softmax: 0.5185718536376953, argmax 756797
DEBUG   [05-06 16:35:03] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 410858
DEBUG   [05-06 16:35:03] calculate_loss in loss:
pred max in softmax: 0.45822641253471375, argmax 354841
INFO    [05-06 16:35:04] _train_one_epoch in BasicTrainer:
loss = 3.4699050340246647
INFO    [05-06 16:35:05] validate in BasicTrainer:
{'Recall@10': 0.21070544536297137, 'NDCG@10': 0.13289933307812765, 'MRR@10': 0.10880298224779275, 'Recall@5': 0.16258687124802515, 'NDCG@5': 0.1172723059470837, 'MRR@5': 0.1023133064691837, 'Recall*@10': 0.21070544536297137, 'NDCG*@10': 0.13289933307812765, 'MRR*@10': 0.10880298224779275, 'Recall*@5': 0.16258687124802515, 'NDCG*@5': 0.1172723059470837, 'MRR*@5': 0.1023133064691837}
INFO    [05-06 16:35:05] train in BasicTrainer:
duration: 5.205463647842407s
INFO    [05-06 16:35:05] close_training in BasicTrainer:
finished training
DEBUG   [05-06 16:35:05] debug_summary in loss:
loss nan summary: nan 0 times, not nan 15041 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-06 16:35:05] run_routine in Routine:
Finished training, Start final validation
INFO    [05-06 16:35:05] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-06 16:35:06] load_state_from_given_path in utils:
checkpoint epoch: 71
INFO    [05-06 16:35:06] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-06 16:35:07] validate in BasicTrainer:
{'Recall@10': 0.21735767332407144, 'NDCG@10': 0.13299342875297254, 'MRR@10': 0.10720154127249351, 'Recall@5': 0.15884127410558554, 'NDCG@5': 0.1143381056877283, 'MRR@5': 0.09965955580656345, 'Recall*@10': 0.21735767332407144, 'NDCG*@10': 0.13299342875297254, 'MRR*@10': 0.10720154127249351, 'Recall*@5': 0.15884127410558554, 'NDCG*@5': 0.1143381056877283, 'MRR*@5': 0.09965955580656345}
INFO    [05-06 16:35:07] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.21735767332407144, 'NDCG@10': 0.13299342875297254, 'MRR@10': 0.10720154127249351, 'Recall@5': 0.15884127410558554, 'NDCG@5': 0.1143381056877283, 'MRR@5': 0.09965955580656345, 'Recall*@10': 0.21735767332407144, 'NDCG*@10': 0.13299342875297254, 'MRR*@10': 0.10720154127249351, 'Recall*@5': 0.15884127410558554, 'NDCG*@5': 0.1143381056877283, 'MRR*@5': 0.09965955580656345}
INFO    [05-06 16:35:07] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-06 16:35:07] test in BasicTrainer:
Test model on test set!
INFO    [05-06 16:35:07] test_with_given_state_path in BasicTrainer:
Loading model params from ___lfms_soft_2021/soft_narm-T-3-al-0.5_05-06_16:27_0/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-06 16:35:07] load_state_from_given_path in utils:
checkpoint epoch: 71
INFO    [05-06 16:35:07] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-06 16:35:07] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-06 16:35:09] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.20605840591283944, 'NDCG@10': 0.12936366922580278, 'MRR@10': 0.1057499096943782, 'Recall@5': 0.156276775094179, 'NDCG@5': 0.11339233471797062, 'MRR@5': 0.09923605620861053, 'Recall*@10': 0.20605840591283944, 'NDCG*@10': 0.12936366922580278, 'MRR*@10': 0.1057499096943782, 'Recall*@5': 0.156276775094179, 'NDCG*@5': 0.11339233471797062, 'MRR*@5': 0.09923605620861053}
INFO    [05-06 16:35:09] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.20605840591283944, 'NDCG@10': 0.12936366922580278, 'MRR@10': 0.1057499096943782, 'Recall@5': 0.156276775094179, 'NDCG@5': 0.11339233471797062, 'MRR@5': 0.09923605620861053, 'Recall*@10': 0.20605840591283944, 'NDCG*@10': 0.12936366922580278, 'MRR*@10': 0.1057499096943782, 'Recall*@5': 0.156276775094179, 'NDCG*@5': 0.11339233471797062, 'MRR*@5': 0.09923605620861053}
