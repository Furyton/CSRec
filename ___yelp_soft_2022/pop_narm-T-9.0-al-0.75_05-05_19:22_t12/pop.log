INFO    [05-05 19:22:50] setup_train in utils:
{
    "experiment_dir": "___yelp_soft_2022",
    "experiment_description": "pop",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "yelp.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "alpha": 0.75,
    "T": 9.0,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.yelp/narm/config_distill.json",
    "task_id": 12,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "dvae_alpha": 0.5,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-05 19:22:50] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-05 19:22:50] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/yelp-5-5.pkl
INFO    [05-05 19:22:51] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-05 19:22:51] _check_dataset_cache in utils:
correct.
INFO    [05-05 19:22:51] __init__ in NextItemDataloader:
there are 20033 items in this dataset, 43947 users, padding_first? False
DEBUG   [05-05 19:22:57] generate_model in utils:
model_code_list=['pop']
INFO    [05-05 19:22:57] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-05 19:22:57] load_model_config in utils:
{}
WARNING [05-05 19:23:04] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.75_05-05_19:22_t12/teacher_pop_logs does not exist! Create one.
WARNING [05-05 19:23:04] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.75_05-05_19:22_t12/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-05 19:23:04] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.75_05-05_19:22_t12/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-05 19:23:04] get_path in utils:
Path is None
WARNING [05-05 19:23:04] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 19:23:04] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-05 19:23:04] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 19:23:04] __init__ in BasicTrainer:
229376 iter per epoch
DEBUG   [05-05 19:23:04] generate_model in utils:
model_code_list=['narm']
INFO    [05-05 19:23:04] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-05 19:23:04] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-05 19:23:06] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.75_05-05_19:22_t12/student_narm_logs does not exist! Create one.
WARNING [05-05 19:23:06] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.75_05-05_19:22_t12/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-05 19:23:06] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.75_05-05_19:22_t12/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-05 19:23:06] get_path in utils:
Path is None
WARNING [05-05 19:23:06] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 19:23:06] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(20034, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-05 19:23:06] assert_model_device in utils:
model student_narm has 5.3603515625 MB params.
INFO    [05-05 19:23:06] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 19:23:06] __init__ in DistillTrainer:
229376 iter per epoch
INFO    [05-05 19:23:06] _set_current_routine in Routine:
first routine: student
INFO    [05-05 19:23:06] run_routine in Routine:
Start routine student
INFO    [05-05 19:23:06] run_routine in Routine:
Start training
INFO    [05-05 19:23:06] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-05 19:23:25] test_mentor in DistillTrainer:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 19:23:25] train in DistillTrainer:
result:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 19:23:44] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 19:23:44] validate in BasicTrainer:
{'Recall@10': 0.00044389204545454544, 'NDCG@10': 0.0002111054676457901, 'MRR@10': 0.0001419221515044972, 'Recall@5': 0.0003107244318181818, 'NDCG@5': 0.0001693654326531528, 'MRR@5': 0.00012539950462682597, 'Recall*@10': 0.00044389204545454544, 'NDCG*@10': 0.0002111054676457901, 'MRR*@10': 0.0001419221515044972, 'Recall*@5': 0.0003107244318181818, 'NDCG*@5': 0.0001693654326531528, 'MRR*@5': 0.00012539950462682597}
INFO    [05-05 19:23:44] train in BasicTrainer:
epoch: 0
DEBUG   [05-05 19:23:45] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 9282877
DEBUG   [05-05 19:23:45] calculate_loss in loss:
pred max in softmax: 5.0027036195388064e-05, argmax 67393260
INFO    [05-05 19:23:58] _train_one_epoch in BasicTrainer:
loss = 5.665976541382926
INFO    [05-05 19:24:17] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 19:24:17] validate in BasicTrainer:
{'Recall@10': 0.008603146469051188, 'NDCG@10': 0.004419428571550684, 'MRR@10': 0.0031874774828214536, 'Recall@5': 0.004487701014361598, 'NDCG@5': 0.0031138870399445295, 'MRR@5': 0.0026637457141822033, 'Recall*@10': 0.008603146469051188, 'NDCG*@10': 0.004419428571550684, 'MRR*@10': 0.0031874774828214536, 'Recall*@5': 0.004487701014361598, 'NDCG*@5': 0.0031138870399445295, 'MRR*@5': 0.0026637457141822033}
INFO    [05-05 19:24:17] train in BasicTrainer:
duration: 32.68826222419739s
INFO    [05-05 19:24:17] train in BasicTrainer:
epoch: 1
INFO    [05-05 19:24:30] _train_one_epoch in BasicTrainer:
loss = 5.436269887856075
INFO    [05-05 19:24:49] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-05 19:24:49] validate in BasicTrainer:
{'Recall@10': 0.018858917819505387, 'NDCG@10': 0.009310642045668581, 'MRR@10': 0.0064588194205002355, 'Recall@5': 0.010790306778455322, 'NDCG@5': 0.0067381680604409085, 'MRR@5': 0.005418789594180204, 'Recall*@10': 0.018858917819505387, 'NDCG*@10': 0.009310642045668581, 'MRR*@10': 0.0064588194205002355, 'Recall*@5': 0.010790306778455322, 'NDCG*@5': 0.0067381680604409085, 'MRR*@5': 0.005418789594180204}
INFO    [05-05 19:24:49] train in BasicTrainer:
duration: 32.23655557632446s
INFO    [05-05 19:24:49] train in BasicTrainer:
epoch: 2
INFO    [05-05 19:25:02] _train_one_epoch in BasicTrainer:
loss = 5.199193060398102
INFO    [05-05 19:25:21] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-05 19:25:21] validate in BasicTrainer:
{'Recall@10': 0.02470048957250335, 'NDCG@10': 0.012337280945344404, 'MRR@10': 0.008649138649078932, 'Recall@5': 0.013924137096513401, 'NDCG@5': 0.00887758361006325, 'MRR@5': 0.007235645697536794, 'Recall*@10': 0.02470048957250335, 'NDCG*@10': 0.012337280945344404, 'MRR*@10': 0.008649138649078932, 'Recall*@5': 0.013924137096513401, 'NDCG*@5': 0.00887758361006325, 'MRR*@5': 0.007235645697536794}
INFO    [05-05 19:25:21] train in BasicTrainer:
duration: 31.946150541305542s
INFO    [05-05 19:25:21] train in BasicTrainer:
epoch: 3
INFO    [05-05 19:25:34] _train_one_epoch in BasicTrainer:
loss = 5.0911568573543
INFO    [05-05 19:25:53] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-05 19:25:53] validate in BasicTrainer:
{'Recall@10': 0.031076596880500965, 'NDCG@10': 0.015356254255907103, 'MRR@10': 0.010659140450033274, 'Recall@5': 0.017588111487301914, 'NDCG@5': 0.01102602727372538, 'MRR@5': 0.008890447164462372, 'Recall*@10': 0.031076596880500965, 'NDCG*@10': 0.015356254255907103, 'MRR*@10': 0.010659140450033274, 'Recall*@5': 0.017588111487301914, 'NDCG*@5': 0.01102602727372538, 'MRR*@5': 0.008890447164462372}
INFO    [05-05 19:25:53] train in BasicTrainer:
duration: 32.06911325454712s
INFO    [05-05 19:25:53] train in BasicTrainer:
epoch: 4
INFO    [05-05 19:26:07] _train_one_epoch in BasicTrainer:
loss = 5.011812082358769
INFO    [05-05 19:26:26] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-05 19:26:26] validate in BasicTrainer:
{'Recall@10': 0.035184463316744026, 'NDCG@10': 0.017490659332410854, 'MRR@10': 0.012208812023428354, 'Recall@5': 0.019915357062762432, 'NDCG@5': 0.012561943043362011, 'MRR@5': 0.010179618796841665, 'Recall*@10': 0.035184463316744026, 'NDCG*@10': 0.017490659332410854, 'MRR*@10': 0.012208812023428354, 'Recall*@5': 0.019915357062762432, 'NDCG*@5': 0.012561943043362011, 'MRR*@5': 0.010179618796841665}
INFO    [05-05 19:26:26] train in BasicTrainer:
duration: 32.59575366973877s
INFO    [05-05 19:26:26] train in BasicTrainer:
epoch: 5
INFO    [05-05 19:26:39] _train_one_epoch in BasicTrainer:
loss = 4.944841393402645
INFO    [05-05 19:26:58] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-05 19:26:58] validate in BasicTrainer:
{'Recall@10': 0.03914773430336605, 'NDCG@10': 0.019905712455511093, 'MRR@10': 0.014143442565744574, 'Recall@5': 0.023094237866726788, 'NDCG@5': 0.014769116247242147, 'MRR@5': 0.012055522000247782, 'Recall*@10': 0.03914773430336605, 'NDCG*@10': 0.019905712455511093, 'MRR*@10': 0.014143442565744574, 'Recall*@5': 0.023094237866726788, 'NDCG*@5': 0.014769116247242147, 'MRR*@5': 0.012055522000247782}
INFO    [05-05 19:26:58] train in BasicTrainer:
duration: 32.426060914993286s
INFO    [05-05 19:26:58] train in BasicTrainer:
epoch: 6
INFO    [05-05 19:27:12] _train_one_epoch in BasicTrainer:
loss = 4.892606777804239
INFO    [05-05 19:27:31] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-05 19:27:31] validate in BasicTrainer:
{'Recall@10': 0.04196139594370669, 'NDCG@10': 0.02129657481881705, 'MRR@10': 0.015081803229722109, 'Recall@5': 0.025394236160950226, 'NDCG@5': 0.015978578562763603, 'MRR@5': 0.012910029935565863, 'Recall*@10': 0.04196139594370669, 'NDCG*@10': 0.02129657481881705, 'MRR*@10': 0.015081803229722109, 'Recall*@5': 0.025394236160950226, 'NDCG*@5': 0.015978578562763603, 'MRR*@5': 0.012910029935565863}
INFO    [05-05 19:27:31] train in BasicTrainer:
duration: 32.781665325164795s
INFO    [05-05 19:27:31] train in BasicTrainer:
epoch: 7
INFO    [05-05 19:27:44] _train_one_epoch in BasicTrainer:
loss = 4.845352326120649
INFO    [05-05 19:28:03] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-05 19:28:03] validate in BasicTrainer:
{'Recall@10': 0.04470901631496169, 'NDCG@10': 0.022949150170792233, 'MRR@10': 0.016420588405294853, 'Recall@5': 0.026910386810248547, 'NDCG@5': 0.017252536575225266, 'MRR@5': 0.014104642735963518, 'Recall*@10': 0.04470901631496169, 'NDCG*@10': 0.022949150170792233, 'MRR*@10': 0.016420588405294853, 'Recall*@5': 0.026910386810248547, 'NDCG*@5': 0.017252536575225266, 'MRR*@5': 0.014104642735963518}
INFO    [05-05 19:28:03] train in BasicTrainer:
duration: 31.969998836517334s
INFO    [05-05 19:28:03] train in BasicTrainer:
epoch: 8
INFO    [05-05 19:28:17] _train_one_epoch in BasicTrainer:
loss = 4.802647735391345
INFO    [05-05 19:28:35] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-05 19:28:35] validate in BasicTrainer:
{'Recall@10': 0.04688156125220386, 'NDCG@10': 0.02448146502402696, 'MRR@10': 0.017763437195257706, 'Recall@5': 0.028652993792837315, 'NDCG@5': 0.018665071746165104, 'MRR@5': 0.015409122051840479, 'Recall*@10': 0.04688156125220386, 'NDCG*@10': 0.02448146502402696, 'MRR*@10': 0.017763437195257706, 'Recall*@5': 0.028652993792837315, 'NDCG*@5': 0.018665071746165104, 'MRR*@5': 0.015409122051840479}
INFO    [05-05 19:28:35] train in BasicTrainer:
duration: 32.473498582839966s
INFO    [05-05 19:28:35] train in BasicTrainer:
epoch: 9
INFO    [05-05 19:28:48] _train_one_epoch in BasicTrainer:
loss = 4.764150432177952
INFO    [05-05 19:29:08] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-05 19:29:08] validate in BasicTrainer:
{'Recall@10': 0.04898301173340191, 'NDCG@10': 0.025637811557813125, 'MRR@10': 0.018629685890945522, 'Recall@5': 0.02995038608258421, 'NDCG@5': 0.019542054696516556, 'MRR@5': 0.016148163005709648, 'Recall*@10': 0.04898301173340191, 'NDCG*@10': 0.025637811557813125, 'MRR*@10': 0.018629685890945522, 'Recall*@5': 0.02995038608258421, 'NDCG*@5': 0.019542054696516556, 'MRR*@5': 0.016148163005709648}
INFO    [05-05 19:29:08] train in BasicTrainer:
duration: 32.531477212905884s
INFO    [05-05 19:29:08] train in BasicTrainer:
epoch: 10
INFO    [05-05 19:29:21] _train_one_epoch in BasicTrainer:
loss = 4.727237360818045
INFO    [05-05 19:29:40] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-05 19:29:40] validate in BasicTrainer:
{'Recall@10': 0.051799199797890404, 'NDCG@10': 0.02700957537374713, 'MRR@10': 0.019560659473592586, 'Recall@5': 0.03161684626882726, 'NDCG@5': 0.0205251852219755, 'MRR@5': 0.01690901138565757, 'Recall*@10': 0.051799199797890404, 'NDCG*@10': 0.02700957537374713, 'MRR*@10': 0.019560659473592586, 'Recall*@5': 0.03161684626882726, 'NDCG*@5': 0.0205251852219755, 'MRR*@5': 0.01690901138565757}
INFO    [05-05 19:29:40] train in BasicTrainer:
duration: 31.769770622253418s
INFO    [05-05 19:29:40] train in BasicTrainer:
epoch: 11
INFO    [05-05 19:29:53] _train_one_epoch in BasicTrainer:
loss = 4.691400604588645
INFO    [05-05 19:30:13] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-05 19:30:13] validate in BasicTrainer:
{'Recall@10': 0.05458044294606556, 'NDCG@10': 0.02878173931755803, 'MRR@10': 0.021038343621925873, 'Recall@5': 0.033048728819597854, 'NDCG@5': 0.02187936549836939, 'MRR@5': 0.018225379965522072, 'Recall*@10': 0.05458044294606556, 'NDCG*@10': 0.02878173931755803, 'MRR*@10': 0.021038343621925873, 'Recall*@5': 0.033048728819597854, 'NDCG*@5': 0.02187936549836939, 'MRR*@5': 0.018225379965522072}
INFO    [05-05 19:30:13] train in BasicTrainer:
duration: 33.05612277984619s
INFO    [05-05 19:30:13] train in BasicTrainer:
epoch: 12
INFO    [05-05 19:30:26] _train_one_epoch in BasicTrainer:
loss = 4.656442880630493
INFO    [05-05 19:30:44] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-05 19:30:45] validate in BasicTrainer:
{'Recall@10': 0.0562887659127062, 'NDCG@10': 0.029883789067918606, 'MRR@10': 0.021960999139330604, 'Recall@5': 0.034543346274982796, 'NDCG@5': 0.022918704558502544, 'MRR@5': 0.01912595263936303, 'Recall*@10': 0.0562887659127062, 'NDCG*@10': 0.029883789067918606, 'MRR*@10': 0.021960999139330604, 'Recall*@5': 0.034543346274982796, 'NDCG*@5': 0.022918704558502544, 'MRR*@5': 0.01912595263936303}
INFO    [05-05 19:30:45] train in BasicTrainer:
duration: 31.83837580680847s
INFO    [05-05 19:30:45] train in BasicTrainer:
epoch: 13
INFO    [05-05 19:30:57] _train_one_epoch in BasicTrainer:
loss = 4.622018677847726
INFO    [05-05 19:31:16] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-05 19:31:17] validate in BasicTrainer:
{'Recall@10': 0.05884806303815408, 'NDCG@10': 0.03129258768802339, 'MRR@10': 0.023017380555922336, 'Recall@5': 0.03633473373272202, 'NDCG@5': 0.024091388183561237, 'MRR@5': 0.020091601393439552, 'Recall*@10': 0.05884806303815408, 'NDCG*@10': 0.03129258768802339, 'MRR*@10': 0.023017380555922336, 'Recall*@5': 0.03633473373272202, 'NDCG*@5': 0.024091388183561237, 'MRR*@5': 0.020091601393439552}
INFO    [05-05 19:31:17] train in BasicTrainer:
duration: 31.929255962371826s
INFO    [05-05 19:31:17] train in BasicTrainer:
epoch: 14
INFO    [05-05 19:31:29] _train_one_epoch in BasicTrainer:
loss = 4.588877047811236
INFO    [05-05 19:31:48] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-05 19:31:48] validate in BasicTrainer:
{'Recall@10': 0.060612203045324844, 'NDCG@10': 0.03279531493105672, 'MRR@10': 0.024402497505599804, 'Recall@5': 0.03885349021716551, 'NDCG@5': 0.025812878866087307, 'MRR@5': 0.02155242758718404, 'Recall*@10': 0.060612203045324844, 'NDCG*@10': 0.03279531493105672, 'MRR*@10': 0.024402497505599804, 'Recall*@5': 0.03885349021716551, 'NDCG*@5': 0.025812878866087307, 'MRR*@5': 0.02155242758718404}
INFO    [05-05 19:31:48] train in BasicTrainer:
duration: 31.347047090530396s
INFO    [05-05 19:31:48] train in BasicTrainer:
epoch: 15
INFO    [05-05 19:32:02] _train_one_epoch in BasicTrainer:
loss = 4.557354586465018
INFO    [05-05 19:32:21] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-05 19:32:21] validate in BasicTrainer:
{'Recall@10': 0.061971787701953544, 'NDCG@10': 0.033561275763945145, 'MRR@10': 0.02500284005972472, 'Recall@5': 0.03929672119292346, 'NDCG@5': 0.026306055824864994, 'MRR@5': 0.02205332504077391, 'Recall*@10': 0.061971787701953544, 'NDCG*@10': 0.033561275763945145, 'MRR*@10': 0.02500284005972472, 'Recall*@5': 0.03929672119292346, 'NDCG*@5': 0.026306055824864994, 'MRR*@5': 0.02205332504077391}
INFO    [05-05 19:32:21] train in BasicTrainer:
duration: 33.3861243724823s
INFO    [05-05 19:32:21] train in BasicTrainer:
epoch: 16
INFO    [05-05 19:32:34] _train_one_epoch in BasicTrainer:
loss = 4.52793151140213
INFO    [05-05 19:32:52] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-05 19:32:53] validate in BasicTrainer:
{'Recall@10': 0.065172863277522, 'NDCG@10': 0.03530657054348425, 'MRR@10': 0.026314081624150276, 'Recall@5': 0.04129357398910956, 'NDCG@5': 0.02764364044097337, 'MRR@5': 0.023186138407750564, 'Recall*@10': 0.065172863277522, 'NDCG*@10': 0.03530657054348425, 'MRR*@10': 0.026314081624150276, 'Recall*@5': 0.04129357398910956, 'NDCG*@5': 0.02764364044097337, 'MRR*@5': 0.023186138407750564}
INFO    [05-05 19:32:53] train in BasicTrainer:
duration: 31.31726861000061s
INFO    [05-05 19:32:53] train in BasicTrainer:
epoch: 17
DEBUG   [05-05 19:33:04] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 1109005
DEBUG   [05-05 19:33:04] calculate_loss in loss:
pred max in softmax: 0.8627614378929138, argmax 42084504
DEBUG   [05-05 19:33:04] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 5496451
DEBUG   [05-05 19:33:04] calculate_loss in loss:
pred max in softmax: 0.7293230891227722, argmax 54813108
INFO    [05-05 19:33:05] _train_one_epoch in BasicTrainer:
loss = 4.498451283999851
INFO    [05-05 19:33:24] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-05 19:33:24] validate in BasicTrainer:
{'Recall@10': 0.06495410474863919, 'NDCG@10': 0.0360682298513976, 'MRR@10': 0.027344761416316032, 'Recall@5': 0.04178251664746891, 'NDCG@5': 0.02859827368096872, 'MRR@5': 0.024275888434865257, 'Recall*@10': 0.06495410474863919, 'NDCG*@10': 0.0360682298513976, 'MRR*@10': 0.027344761416316032, 'Recall*@5': 0.04178251664746891, 'NDCG*@5': 0.02859827368096872, 'MRR*@5': 0.024275888434865257}
INFO    [05-05 19:33:24] train in BasicTrainer:
duration: 31.796467065811157s
INFO    [05-05 19:33:24] train in BasicTrainer:
epoch: 18
INFO    [05-05 19:33:37] _train_one_epoch in BasicTrainer:
loss = 4.471515561853137
INFO    [05-05 19:33:56] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-05 19:33:56] validate in BasicTrainer:
{'Recall@10': 0.06632698259570381, 'NDCG@10': 0.03658097982406616, 'MRR@10': 0.027624865147200497, 'Recall@5': 0.0430450825528665, 'NDCG@5': 0.02912163429639556, 'MRR@5': 0.024586896666071632, 'Recall*@10': 0.06632698259570381, 'NDCG*@10': 0.03658097982406616, 'MRR*@10': 0.027624865147200497, 'Recall*@5': 0.0430450825528665, 'NDCG*@5': 0.02912163429639556, 'MRR*@5': 0.024586896666071632}
INFO    [05-05 19:33:56] train in BasicTrainer:
duration: 31.734995126724243s
INFO    [05-05 19:33:56] train in BasicTrainer:
epoch: 19
INFO    [05-05 19:34:09] _train_one_epoch in BasicTrainer:
loss = 4.445746890136173
INFO    [05-05 19:34:28] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-05 19:34:28] validate in BasicTrainer:
{'Recall@10': 0.0675724067471244, 'NDCG@10': 0.03757311606949026, 'MRR@10': 0.02850990810177543, 'Recall@5': 0.04396516660397703, 'NDCG@5': 0.029980131848291916, 'MRR@5': 0.025400191206823696, 'Recall*@10': 0.0675724067471244, 'NDCG*@10': 0.03757311606949026, 'MRR*@10': 0.02850990810177543, 'Recall*@5': 0.04396516660397703, 'NDCG*@5': 0.029980131848291916, 'MRR*@5': 0.025400191206823696}
INFO    [05-05 19:34:28] train in BasicTrainer:
duration: 32.246217012405396s
INFO    [05-05 19:34:28] train in BasicTrainer:
epoch: 20
INFO    [05-05 19:34:41] _train_one_epoch in BasicTrainer:
loss = 4.42145437853677
INFO    [05-05 19:35:00] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-05 19:35:00] validate in BasicTrainer:
{'Recall@10': 0.06983944367278706, 'NDCG@10': 0.038997636938636955, 'MRR@10': 0.02970560961826281, 'Recall@5': 0.04543253677812489, 'NDCG@5': 0.03117926926775412, 'MRR@5': 0.026523121378638527, 'Recall*@10': 0.06983944367278706, 'NDCG*@10': 0.038997636938636955, 'MRR*@10': 0.02970560961826281, 'Recall*@5': 0.04543253677812489, 'NDCG*@5': 0.03117926926775412, 'MRR*@5': 0.026523121378638527}
INFO    [05-05 19:35:00] train in BasicTrainer:
duration: 31.720072031021118s
INFO    [05-05 19:35:00] train in BasicTrainer:
epoch: 21
INFO    [05-05 19:35:13] _train_one_epoch in BasicTrainer:
loss = 4.397849142551422
INFO    [05-05 19:35:32] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-05 19:35:32] validate in BasicTrainer:
{'Recall@10': 0.07102081044153734, 'NDCG@10': 0.03938950767571276, 'MRR@10': 0.02985214458947832, 'Recall@5': 0.04651435803283344, 'NDCG@5': 0.03153289414264939, 'MRR@5': 0.026649252765557983, 'Recall*@10': 0.07102081044153734, 'NDCG*@10': 0.03938950767571276, 'MRR*@10': 0.02985214458947832, 'Recall*@5': 0.04651435803283344, 'NDCG*@5': 0.03153289414264939, 'MRR*@5': 0.026649252765557983}
INFO    [05-05 19:35:32] train in BasicTrainer:
duration: 31.947590351104736s
INFO    [05-05 19:35:32] train in BasicTrainer:
epoch: 22
INFO    [05-05 19:35:47] _train_one_epoch in BasicTrainer:
loss = 4.374611079692841
INFO    [05-05 19:36:05] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-05 19:36:05] validate in BasicTrainer:
{'Recall@10': 0.07187112285332246, 'NDCG@10': 0.04036936739628965, 'MRR@10': 0.030864473601633854, 'Recall@5': 0.04713899472897703, 'NDCG@5': 0.032417393204840744, 'MRR@5': 0.0276097296313806, 'Recall*@10': 0.07187112285332246, 'NDCG*@10': 0.04036936739628965, 'MRR*@10': 0.030864473601633854, 'Recall*@5': 0.04713899472897703, 'NDCG*@5': 0.032417393204840744, 'MRR*@5': 0.0276097296313806}
INFO    [05-05 19:36:05] train in BasicTrainer:
duration: 33.21621012687683s
INFO    [05-05 19:36:05] train in BasicTrainer:
epoch: 23
INFO    [05-05 19:36:19] _train_one_epoch in BasicTrainer:
loss = 4.353493256228311
INFO    [05-05 19:36:39] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-05 19:36:39] validate in BasicTrainer:
{'Recall@10': 0.07378557256676933, 'NDCG@10': 0.04132168773900379, 'MRR@10': 0.031518386168913406, 'Recall@5': 0.04815742000937462, 'NDCG@5': 0.03307888792319731, 'MRR@5': 0.028142248026349327, 'Recall*@10': 0.07378557256676933, 'NDCG*@10': 0.04132168773900379, 'MRR*@10': 0.031518386168913406, 'Recall*@5': 0.04815742000937462, 'NDCG*@5': 0.03307888792319731, 'MRR*@5': 0.028142248026349327}
INFO    [05-05 19:36:39] train in BasicTrainer:
duration: 33.73792099952698s
INFO    [05-05 19:36:39] train in BasicTrainer:
epoch: 24
INFO    [05-05 19:36:52] _train_one_epoch in BasicTrainer:
loss = 4.332214866365705
INFO    [05-05 19:37:10] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-05 19:37:10] validate in BasicTrainer:
{'Recall@10': 0.07350528307936409, 'NDCG@10': 0.04180742698636922, 'MRR@10': 0.0322104213251309, 'Recall@5': 0.04914727569981055, 'NDCG@5': 0.033949593928727234, 'MRR@5': 0.028978325934572655, 'Recall*@10': 0.07350528307936409, 'NDCG*@10': 0.04180742698636922, 'MRR*@10': 0.0322104213251309, 'Recall*@5': 0.04914727569981055, 'NDCG*@5': 0.033949593928727234, 'MRR*@5': 0.028978325934572655}
INFO    [05-05 19:37:10] train in BasicTrainer:
duration: 31.353645086288452s
INFO    [05-05 19:37:10] train in BasicTrainer:
epoch: 25
INFO    [05-05 19:37:25] _train_one_epoch in BasicTrainer:
loss = 4.31425416469574
INFO    [05-05 19:37:45] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-05 19:37:45] validate in BasicTrainer:
{'Recall@10': 0.07493079047311436, 'NDCG@10': 0.042709785090251404, 'MRR@10': 0.032985204153440216, 'Recall@5': 0.05002297054637562, 'NDCG@5': 0.0347134992480278, 'MRR@5': 0.02971877936612476, 'Recall*@10': 0.07493079047311436, 'NDCG*@10': 0.042709785090251404, 'MRR*@10': 0.032985204153440216, 'Recall*@5': 0.05002297054637562, 'NDCG*@5': 0.0347134992480278, 'MRR*@5': 0.02971877936612476}
INFO    [05-05 19:37:45] train in BasicTrainer:
duration: 34.39764666557312s
INFO    [05-05 19:37:45] train in BasicTrainer:
epoch: 26
INFO    [05-05 19:37:58] _train_one_epoch in BasicTrainer:
loss = 4.293571761676243
INFO    [05-05 19:38:17] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-05 19:38:17] validate in BasicTrainer:
{'Recall@10': 0.076001184230501, 'NDCG@10': 0.04345889220183546, 'MRR@10': 0.033629246056079865, 'Recall@5': 0.05081692337989807, 'NDCG@5': 0.03537045419216156, 'MRR@5': 0.03032315962693908, 'Recall*@10': 0.076001184230501, 'NDCG*@10': 0.04345889220183546, 'MRR*@10': 0.033629246056079865, 'Recall*@5': 0.05081692337989807, 'NDCG*@5': 0.03537045419216156, 'MRR*@5': 0.03032315962693908}
INFO    [05-05 19:38:17] train in BasicTrainer:
duration: 31.998597383499146s
INFO    [05-05 19:38:17] train in BasicTrainer:
epoch: 27
INFO    [05-05 19:38:31] _train_one_epoch in BasicTrainer:
loss = 4.275558267320905
INFO    [05-05 19:38:50] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-05 19:38:50] validate in BasicTrainer:
{'Recall@10': 0.07687182589010759, 'NDCG@10': 0.04402532360770486, 'MRR@10': 0.03407225690104745, 'Recall@5': 0.05204773186282678, 'NDCG@5': 0.03601381792263551, 'MRR@5': 0.030774688517505474, 'Recall*@10': 0.07687182589010759, 'NDCG*@10': 0.04402532360770486, 'MRR*@10': 0.03407225690104745, 'Recall*@5': 0.05204773186282678, 'NDCG*@5': 0.03601381792263551, 'MRR*@5': 0.030774688517505474}
INFO    [05-05 19:38:50] train in BasicTrainer:
duration: 33.65436553955078s
INFO    [05-05 19:38:50] train in BasicTrainer:
epoch: 28
INFO    [05-05 19:39:05] _train_one_epoch in BasicTrainer:
loss = 4.257860328469958
INFO    [05-05 19:39:24] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-05 19:39:24] validate in BasicTrainer:
{'Recall@10': 0.07812296395952051, 'NDCG@10': 0.04479475759647109, 'MRR@10': 0.03474364599043673, 'Recall@5': 0.051795350895686584, 'NDCG@5': 0.03634297034957192, 'MRR@5': 0.03129199672151695, 'Recall*@10': 0.07812296395952051, 'NDCG*@10': 0.04479475759647109, 'MRR*@10': 0.03474364599043673, 'Recall*@5': 0.051795350895686584, 'NDCG*@5': 0.03634297034957192, 'MRR*@5': 0.03129199672151695}
INFO    [05-05 19:39:24] train in BasicTrainer:
duration: 33.54619312286377s
INFO    [05-05 19:39:24] train in BasicTrainer:
epoch: 29
INFO    [05-05 19:39:38] _train_one_epoch in BasicTrainer:
loss = 4.241933899266379
INFO    [05-05 19:39:57] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-05 19:39:57] validate in BasicTrainer:
{'Recall@10': 0.07882747731425545, 'NDCG@10': 0.045394236729903656, 'MRR@10': 0.03526933254166083, 'Recall@5': 0.05278268016197465, 'NDCG@5': 0.03698781742291017, 'MRR@5': 0.03180888667702675, 'Recall*@10': 0.07882747731425545, 'NDCG*@10': 0.045394236729903656, 'MRR*@10': 0.03526933254166083, 'Recall*@5': 0.05278268016197465, 'NDCG*@5': 0.03698781742291017, 'MRR*@5': 0.03180888667702675}
INFO    [05-05 19:39:57] train in BasicTrainer:
duration: 33.39457654953003s
INFO    [05-05 19:39:57] train in BasicTrainer:
epoch: 30
INFO    [05-05 19:40:11] _train_one_epoch in BasicTrainer:
loss = 4.223340800830296
INFO    [05-05 19:40:29] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [05-05 19:40:29] validate in BasicTrainer:
{'Recall@10': 0.0797342685135928, 'NDCG@10': 0.0461406253955581, 'MRR@10': 0.03598856824365529, 'Recall@5': 0.05349224602634257, 'NDCG@5': 0.03768523714759133, 'MRR@5': 0.03251643072475086, 'Recall*@10': 0.0797342685135928, 'NDCG*@10': 0.0461406253955581, 'MRR*@10': 0.03598856824365529, 'Recall*@5': 0.05349224602634257, 'NDCG*@5': 0.03768523714759133, 'MRR*@5': 0.03251643072475086}
INFO    [05-05 19:40:29] train in BasicTrainer:
duration: 32.100802421569824s
INFO    [05-05 19:40:29] train in BasicTrainer:
epoch: 31
INFO    [05-05 19:40:43] _train_one_epoch in BasicTrainer:
loss = 4.207571251051767
INFO    [05-05 19:41:02] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-05 19:41:03] validate in BasicTrainer:
{'Recall@10': 0.08049712533300574, 'NDCG@10': 0.046652942218563774, 'MRR@10': 0.03640316426753998, 'Recall@5': 0.054803592576221985, 'NDCG@5': 0.038408414884047073, 'MRR@5': 0.03303851102563468, 'Recall*@10': 0.08049712533300574, 'NDCG*@10': 0.046652942218563774, 'MRR*@10': 0.03640316426753998, 'Recall*@5': 0.054803592576221985, 'NDCG*@5': 0.038408414884047073, 'MRR*@5': 0.03303851102563468}
INFO    [05-05 19:41:03] train in BasicTrainer:
duration: 33.135931968688965s
INFO    [05-05 19:41:03] train in BasicTrainer:
epoch: 32
INFO    [05-05 19:41:15] _train_one_epoch in BasicTrainer:
loss = 4.19360077381134
INFO    [05-05 19:41:35] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-05 19:41:35] validate in BasicTrainer:
{'Recall@10': 0.08117691766132008, 'NDCG@10': 0.04726078530604189, 'MRR@10': 0.03698880936611782, 'Recall@5': 0.0555563440377062, 'NDCG@5': 0.039024092934348366, 'MRR@5': 0.033617448061704636, 'Recall*@10': 0.08117691766132008, 'NDCG*@10': 0.04726078530604189, 'MRR*@10': 0.03698880936611782, 'Recall*@5': 0.0555563440377062, 'NDCG*@5': 0.039024092934348366, 'MRR*@5': 0.033617448061704636}
INFO    [05-05 19:41:35] train in BasicTrainer:
duration: 32.44739532470703s
INFO    [05-05 19:41:35] train in BasicTrainer:
epoch: 33
INFO    [05-05 19:41:48] _train_one_epoch in BasicTrainer:
loss = 4.178916462830135
INFO    [05-05 19:42:06] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-05 19:42:07] validate in BasicTrainer:
{'Recall@10': 0.08245025033300574, 'NDCG@10': 0.04775830798528411, 'MRR@10': 0.037264320999383926, 'Recall@5': 0.05537626079537652, 'NDCG@5': 0.039043972099369224, 'MRR@5': 0.03369098613885316, 'Recall*@10': 0.08245025033300574, 'NDCG*@10': 0.04775830798528411, 'MRR*@10': 0.037264320999383926, 'Recall*@5': 0.05537626079537652, 'NDCG*@5': 0.039043972099369224, 'MRR*@5': 0.03369098613885316}
INFO    [05-05 19:42:07] train in BasicTrainer:
duration: 31.48561668395996s
INFO    [05-05 19:42:07] train in BasicTrainer:
epoch: 34
INFO    [05-05 19:42:20] _train_one_epoch in BasicTrainer:
loss = 4.1650624530656
INFO    [05-05 19:42:39] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-05 19:42:39] validate in BasicTrainer:
{'Recall@10': 0.08180089294910431, 'NDCG@10': 0.04786734384569255, 'MRR@10': 0.037587651813572105, 'Recall@5': 0.05576752329414541, 'NDCG@5': 0.03948428989811377, 'MRR@5': 0.03414888307452202, 'Recall*@10': 0.08180089294910431, 'NDCG*@10': 0.04786734384569255, 'MRR*@10': 0.037587651813572105, 'Recall*@5': 0.05576752329414541, 'NDCG*@5': 0.03948428989811377, 'MRR*@5': 0.03414888307452202}
INFO    [05-05 19:42:39] train in BasicTrainer:
duration: 32.38775849342346s
INFO    [05-05 19:42:39] train in BasicTrainer:
epoch: 35
DEBUG   [05-05 19:42:48] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 5997301
DEBUG   [05-05 19:42:48] calculate_loss in loss:
pred max in softmax: 0.6479819416999817, argmax 15935117
DEBUG   [05-05 19:42:48] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 27634021
DEBUG   [05-05 19:42:48] calculate_loss in loss:
pred max in softmax: 0.8611917495727539, argmax 12537041
INFO    [05-05 19:42:52] _train_one_epoch in BasicTrainer:
loss = 4.150090822151729
INFO    [05-05 19:43:10] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-05 19:43:10] validate in BasicTrainer:
{'Recall@10': 0.08288590203632008, 'NDCG@10': 0.04846042022109032, 'MRR@10': 0.038031370463696396, 'Recall@5': 0.05677770857106556, 'NDCG@5': 0.04005900364030491, 'MRR@5': 0.03458856486461379, 'Recall*@10': 0.08288590203632008, 'NDCG*@10': 0.04846042022109032, 'MRR*@10': 0.038031370463696396, 'Recall*@5': 0.05677770857106556, 'NDCG*@5': 0.04005900364030491, 'MRR*@5': 0.03458856486461379}
INFO    [05-05 19:43:10] train in BasicTrainer:
duration: 31.317973375320435s
INFO    [05-05 19:43:10] train in BasicTrainer:
epoch: 36
INFO    [05-05 19:43:23] _train_one_epoch in BasicTrainer:
loss = 4.137205762522561
INFO    [05-05 19:43:42] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-05 19:43:42] validate in BasicTrainer:
{'Recall@10': 0.08368996056643399, 'NDCG@10': 0.049309615045785904, 'MRR@10': 0.03888098285956816, 'Recall@5': 0.057839200577952644, 'NDCG@5': 0.04101891172203151, 'MRR@5': 0.03549946201118556, 'Recall*@10': 0.08368996056643399, 'NDCG*@10': 0.049309615045785904, 'MRR*@10': 0.03888098285956816, 'Recall*@5': 0.057839200577952644, 'NDCG*@5': 0.04101891172203151, 'MRR*@5': 0.03549946201118556}
INFO    [05-05 19:43:42] train in BasicTrainer:
duration: 31.737075805664062s
INFO    [05-05 19:43:42] train in BasicTrainer:
epoch: 37
INFO    [05-05 19:43:55] _train_one_epoch in BasicTrainer:
loss = 4.12654538665499
INFO    [05-05 19:44:13] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [05-05 19:44:14] validate in BasicTrainer:
{'Recall@10': 0.08392519910227168, 'NDCG@10': 0.04934654588049108, 'MRR@10': 0.03886152431368828, 'Recall@5': 0.05764329805970192, 'NDCG@5': 0.04089076546105472, 'MRR@5': 0.035397258163853126, 'Recall*@10': 0.08392519910227168, 'NDCG*@10': 0.04934654588049108, 'MRR*@10': 0.03886152431368828, 'Recall*@5': 0.05764329805970192, 'NDCG*@5': 0.04089076546105472, 'MRR*@5': 0.035397258163853126}
INFO    [05-05 19:44:14] train in BasicTrainer:
duration: 31.671360969543457s
INFO    [05-05 19:44:14] train in BasicTrainer:
epoch: 38
INFO    [05-05 19:44:27] _train_one_epoch in BasicTrainer:
loss = 4.112078896590641
INFO    [05-05 19:44:46] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-05 19:44:46] validate in BasicTrainer:
{'Recall@10': 0.08415923470800574, 'NDCG@10': 0.049612513997338036, 'MRR@10': 0.03910268639976328, 'Recall@5': 0.05929327756166458, 'NDCG@5': 0.04163018715652553, 'MRR@5': 0.03584264388138598, 'Recall*@10': 0.08415923470800574, 'NDCG*@10': 0.049612513997338036, 'MRR*@10': 0.03910268639976328, 'Recall*@5': 0.05929327756166458, 'NDCG*@5': 0.04163018715652553, 'MRR*@5': 0.03584264388138598}
INFO    [05-05 19:44:46] train in BasicTrainer:
duration: 32.34713339805603s
INFO    [05-05 19:44:46] train in BasicTrainer:
epoch: 39
INFO    [05-05 19:44:59] _train_one_epoch in BasicTrainer:
loss = 4.100629108292716
INFO    [05-05 19:45:17] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [05-05 19:45:18] validate in BasicTrainer:
{'Recall@10': 0.08517128500071439, 'NDCG@10': 0.05039513822306286, 'MRR@10': 0.03983151269229976, 'Recall@5': 0.05936491387811574, 'NDCG@5': 0.0421034267002886, 'MRR@5': 0.03644003786823966, 'Recall*@10': 0.08517128500071439, 'NDCG*@10': 0.05039513822306286, 'MRR*@10': 0.03983151269229976, 'Recall*@5': 0.05936491387811574, 'NDCG*@5': 0.0421034267002886, 'MRR*@5': 0.03644003786823966}
INFO    [05-05 19:45:18] train in BasicTrainer:
duration: 31.59343433380127s
INFO    [05-05 19:45:18] train in BasicTrainer:
epoch: 40
INFO    [05-05 19:45:30] _train_one_epoch in BasicTrainer:
loss = 4.087228621755328
INFO    [05-05 19:45:49] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [05-05 19:45:49] validate in BasicTrainer:
{'Recall@10': 0.08642813698811964, 'NDCG@10': 0.050902143798091194, 'MRR@10': 0.04012107070196758, 'Recall@5': 0.05984056368470192, 'NDCG@5': 0.04237598316235976, 'MRR@5': 0.03664369068362496, 'Recall*@10': 0.08642813698811964, 'NDCG*@10': 0.050902143798091194, 'MRR*@10': 0.04012107070196758, 'Recall*@5': 0.05984056368470192, 'NDCG*@5': 0.04237598316235976, 'MRR*@5': 0.03664369068362496}
INFO    [05-05 19:45:49] train in BasicTrainer:
duration: 31.839483499526978s
INFO    [05-05 19:45:49] train in BasicTrainer:
epoch: 41
INFO    [05-05 19:46:03] _train_one_epoch in BasicTrainer:
loss = 4.078414014407566
INFO    [05-05 19:46:21] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-05 19:46:21] validate in BasicTrainer:
{'Recall@10': 0.08571790971539238, 'NDCG@10': 0.05092590708624233, 'MRR@10': 0.04033235900781371, 'Recall@5': 0.060266652567820114, 'NDCG@5': 0.04273236509073864, 'MRR@5': 0.03697287460619753, 'Recall*@10': 0.08571790971539238, 'NDCG*@10': 0.05092590708624233, 'MRR*@10': 0.04033235900781371, 'Recall*@5': 0.060266652567820114, 'NDCG*@5': 0.04273236509073864, 'MRR*@5': 0.03697287460619753}
INFO    [05-05 19:46:21] train in BasicTrainer:
duration: 31.905959844589233s
INFO    [05-05 19:46:21] train in BasicTrainer:
epoch: 42
INFO    [05-05 19:46:34] _train_one_epoch in BasicTrainer:
loss = 4.068725058010647
INFO    [05-05 19:46:53] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-05 19:46:53] validate in BasicTrainer:
{'Recall@10': 0.08672171898863533, 'NDCG@10': 0.051329932768236504, 'MRR@10': 0.04057168317112056, 'Recall@5': 0.060935016721487045, 'NDCG@5': 0.04305207932537252, 'MRR@5': 0.037190730598839844, 'Recall*@10': 0.08672171898863533, 'NDCG*@10': 0.051329932768236504, 'MRR*@10': 0.04057168317112056, 'Recall*@5': 0.060935016721487045, 'NDCG*@5': 0.04305207932537252, 'MRR*@5': 0.037190730598839844}
INFO    [05-05 19:46:53] train in BasicTrainer:
duration: 31.83979845046997s
INFO    [05-05 19:46:53] train in BasicTrainer:
epoch: 43
INFO    [05-05 19:47:06] _train_one_epoch in BasicTrainer:
loss = 4.057379126548767
INFO    [05-05 19:47:25] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [05-05 19:47:25] validate in BasicTrainer:
{'Recall@10': 0.08837169882926074, 'NDCG@10': 0.05191083591092716, 'MRR@10': 0.04084923795678399, 'Recall@5': 0.06105170365084301, 'NDCG@5': 0.043109235777096314, 'MRR@5': 0.037236138839613304, 'Recall*@10': 0.08837169882926074, 'NDCG*@10': 0.05191083591092716, 'MRR*@10': 0.04084923795678399, 'Recall*@5': 0.06105170365084301, 'NDCG*@5': 0.043109235777096314, 'MRR*@5': 0.037236138839613304}
INFO    [05-05 19:47:25] train in BasicTrainer:
duration: 31.805561065673828s
INFO    [05-05 19:47:25] train in BasicTrainer:
epoch: 44
INFO    [05-05 19:47:38] _train_one_epoch in BasicTrainer:
loss = 4.0467013120651245
INFO    [05-05 19:47:58] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-05 19:47:58] validate in BasicTrainer:
{'Recall@10': 0.08857716416770761, 'NDCG@10': 0.052546356889334594, 'MRR@10': 0.04159159518100999, 'Recall@5': 0.06221911615946076, 'NDCG@5': 0.044064949520609596, 'MRR@5': 0.038115717470645905, 'Recall*@10': 0.08857716416770761, 'NDCG*@10': 0.052546356889334594, 'MRR*@10': 0.04159159518100999, 'Recall*@5': 0.06221911615946076, 'NDCG*@5': 0.044064949520609596, 'MRR*@5': 0.038115717470645905}
INFO    [05-05 19:47:58] train in BasicTrainer:
duration: 32.78815507888794s
INFO    [05-05 19:47:58] train in BasicTrainer:
epoch: 45
INFO    [05-05 19:48:10] _train_one_epoch in BasicTrainer:
loss = 4.035916664770672
INFO    [05-05 19:48:29] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-05 19:48:29] validate in BasicTrainer:
{'Recall@10': 0.08945352042263205, 'NDCG@10': 0.053086275404149834, 'MRR@10': 0.04204125770113685, 'Recall@5': 0.062404913319782776, 'NDCG@5': 0.04442256790670482, 'MRR@5': 0.03851443088867448, 'Recall*@10': 0.08945352042263205, 'NDCG*@10': 0.053086275404149834, 'MRR*@10': 0.04204125770113685, 'Recall*@5': 0.062404913319782776, 'NDCG*@5': 0.04442256790670482, 'MRR*@5': 0.03851443088867448}
INFO    [05-05 19:48:29] train in BasicTrainer:
duration: 31.577951908111572s
INFO    [05-05 19:48:29] train in BasicTrainer:
epoch: 46
INFO    [05-05 19:48:42] _train_one_epoch in BasicTrainer:
loss = 4.027160048484802
INFO    [05-05 19:49:01] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-05 19:49:02] validate in BasicTrainer:
{'Recall@10': 0.09012759883295406, 'NDCG@10': 0.05328004841100086, 'MRR@10': 0.042108838869766754, 'Recall@5': 0.0623218488286842, 'NDCG@5': 0.04434093866835941, 'MRR@5': 0.038450013507496224, 'Recall*@10': 0.09012759883295406, 'NDCG*@10': 0.05328004841100086, 'MRR*@10': 0.042108838869766754, 'Recall*@5': 0.0623218488286842, 'NDCG*@5': 0.04434093866835941, 'MRR*@5': 0.038450013507496224}
INFO    [05-05 19:49:02] train in BasicTrainer:
duration: 32.18259644508362s
INFO    [05-05 19:49:02] train in BasicTrainer:
epoch: 47
INFO    [05-05 19:49:15] _train_one_epoch in BasicTrainer:
loss = 4.0169283492224555
INFO    [05-05 19:49:34] validate in BasicTrainer:
{'Recall@10': 0.08908192610198801, 'NDCG@10': 0.05309776081280275, 'MRR@10': 0.04216041890057651, 'Recall@5': 0.06254379485141147, 'NDCG@5': 0.04456224089319056, 'MRR@5': 0.038664539767937225, 'Recall*@10': 0.08908192610198801, 'NDCG*@10': 0.05309776081280275, 'MRR*@10': 0.04216041890057651, 'Recall*@5': 0.06254379485141147, 'NDCG*@5': 0.04456224089319056, 'MRR*@5': 0.038664539767937225}
INFO    [05-05 19:49:34] train in BasicTrainer:
duration: 32.14806389808655s
INFO    [05-05 19:49:34] train in BasicTrainer:
epoch: 48
INFO    [05-05 19:49:47] _train_one_epoch in BasicTrainer:
loss = 4.008692707334246
INFO    [05-05 19:50:06] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-05 19:50:07] validate in BasicTrainer:
{'Recall@10': 0.0903520712798292, 'NDCG@10': 0.053694646805524826, 'MRR@10': 0.0425888103517619, 'Recall@5': 0.06263509968465025, 'NDCG@5': 0.04482849145477468, 'MRR@5': 0.03898685222322291, 'Recall*@10': 0.0903520712798292, 'NDCG*@10': 0.053694646805524826, 'MRR*@10': 0.0425888103517619, 'Recall*@5': 0.06263509968465025, 'NDCG*@5': 0.04482849145477468, 'MRR*@5': 0.03898685222322291}
INFO    [05-05 19:50:07] train in BasicTrainer:
duration: 32.905056953430176s
INFO    [05-05 19:50:07] train in BasicTrainer:
epoch: 49
INFO    [05-05 19:50:20] _train_one_epoch in BasicTrainer:
loss = 4.001353306429727
INFO    [05-05 19:50:38] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-05 19:50:38] validate in BasicTrainer:
{'Recall@10': 0.09032163633541627, 'NDCG@10': 0.05408784780989994, 'MRR@10': 0.043077987703410064, 'Recall@5': 0.06340619684620337, 'NDCG@5': 0.04544353959235278, 'MRR@5': 0.03954573449763385, 'Recall*@10': 0.09032163633541627, 'NDCG*@10': 0.05408784780989994, 'MRR*@10': 0.043077987703410064, 'Recall*@5': 0.06340619684620337, 'NDCG*@5': 0.04544353959235278, 'MRR*@5': 0.03954573449763385}
INFO    [05-05 19:50:38] train in BasicTrainer:
duration: 31.834001064300537s
INFO    [05-05 19:50:38] train in BasicTrainer:
epoch: 50
INFO    [05-05 19:50:51] _train_one_epoch in BasicTrainer:
loss = 3.991331445319312
INFO    [05-05 19:51:10] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-05 19:51:11] validate in BasicTrainer:
{'Recall@10': 0.0914757556535981, 'NDCG@10': 0.054399682716889816, 'MRR@10': 0.043118384751406585, 'Recall@5': 0.06446582349863919, 'NDCG@5': 0.0457109385593371, 'MRR@5': 0.03955952111970295, 'Recall*@10': 0.0914757556535981, 'NDCG*@10': 0.054399682716889816, 'MRR*@10': 0.043118384751406585, 'Recall*@5': 0.06446582349863919, 'NDCG*@5': 0.0457109385593371, 'MRR*@5': 0.03955952111970295}
INFO    [05-05 19:51:11] train in BasicTrainer:
duration: 32.23385667800903s
INFO    [05-05 19:51:11] train in BasicTrainer:
epoch: 51
INFO    [05-05 19:51:24] _train_one_epoch in BasicTrainer:
loss = 3.9821498223713467
INFO    [05-05 19:51:43] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [05-05 19:51:43] validate in BasicTrainer:
{'Recall@10': 0.09177823974327608, 'NDCG@10': 0.05531840940768069, 'MRR@10': 0.0442180372774601, 'Recall@5': 0.06500673429532484, 'NDCG@5': 0.0466689799319614, 'MRR@5': 0.04065314341675152, 'Recall*@10': 0.09177823974327608, 'NDCG*@10': 0.05531840940768069, 'MRR*@10': 0.0442180372774601, 'Recall*@5': 0.06500673429532484, 'NDCG*@5': 0.0466689799319614, 'MRR*@5': 0.04065314341675152}
INFO    [05-05 19:51:43] train in BasicTrainer:
duration: 32.267136335372925s
INFO    [05-05 19:51:43] train in BasicTrainer:
epoch: 52
INFO    [05-05 19:51:57] _train_one_epoch in BasicTrainer:
loss = 3.976100815193994
INFO    [05-05 19:52:17] validate in BasicTrainer:
{'Recall@10': 0.09224751388484781, 'NDCG@10': 0.05523126911033283, 'MRR@10': 0.0439724133095958, 'Recall@5': 0.06483423032543877, 'NDCG@5': 0.04640017043460499, 'MRR@5': 0.04034741222858429, 'Recall*@10': 0.09224751388484781, 'NDCG*@10': 0.05523126911033283, 'MRR*@10': 0.0439724133095958, 'Recall*@5': 0.06483423032543877, 'NDCG*@5': 0.04640017043460499, 'MRR*@5': 0.04034741222858429}
INFO    [05-05 19:52:17] train in BasicTrainer:
duration: 33.626437187194824s
INFO    [05-05 19:52:17] train in BasicTrainer:
epoch: 53
DEBUG   [05-05 19:52:24] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 6798661
DEBUG   [05-05 19:52:24] calculate_loss in loss:
pred max in softmax: 0.6113191246986389, argmax 81512072
DEBUG   [05-05 19:52:24] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 2511385
DEBUG   [05-05 19:52:24] calculate_loss in loss:
pred max in softmax: 0.5929161310195923, argmax 37504710
INFO    [05-05 19:52:29] _train_one_epoch in BasicTrainer:
loss = 3.968580995287214
INFO    [05-05 19:52:48] log in loggers:
Update Best NDCG@10 Model at 53
INFO    [05-05 19:52:48] validate in BasicTrainer:
{'Recall@10': 0.09309782629663294, 'NDCG@10': 0.05592799254439094, 'MRR@10': 0.044620452618057076, 'Recall@5': 0.06573025475848805, 'NDCG@5': 0.04714026573029431, 'MRR@5': 0.04102983020923354, 'Recall*@10': 0.09309782629663294, 'NDCG*@10': 0.05592799254439094, 'MRR*@10': 0.044620452618057076, 'Recall*@5': 0.06573025475848805, 'NDCG*@5': 0.04714026573029431, 'MRR*@5': 0.04102983020923354}
INFO    [05-05 19:52:48] train in BasicTrainer:
duration: 31.496901750564575s
INFO    [05-05 19:52:48] train in BasicTrainer:
epoch: 54
INFO    [05-05 19:53:01] _train_one_epoch in BasicTrainer:
loss = 3.9619194524628774
INFO    [05-05 19:53:21] log in loggers:
Update Best NDCG@10 Model at 54
INFO    [05-05 19:53:21] validate in BasicTrainer:
{'Recall@10': 0.09367741237987172, 'NDCG@10': 0.05643176355145194, 'MRR@10': 0.04510868035934188, 'Recall@5': 0.06594714793291959, 'NDCG@5': 0.04749647494066845, 'MRR@5': 0.041439563035964966, 'Recall*@10': 0.09367741237987172, 'NDCG*@10': 0.05643176355145194, 'MRR*@10': 0.04510868035934188, 'Recall*@5': 0.06594714793291959, 'NDCG*@5': 0.04749647494066845, 'MRR*@5': 0.041439563035964966}
INFO    [05-05 19:53:21] train in BasicTrainer:
duration: 32.6788432598114s
INFO    [05-05 19:53:21] train in BasicTrainer:
epoch: 55
INFO    [05-05 19:53:35] _train_one_epoch in BasicTrainer:
loss = 3.954567108835493
INFO    [05-05 19:53:53] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [05-05 19:53:53] validate in BasicTrainer:
{'Recall@10': 0.09381629391150041, 'NDCG@10': 0.05650815198367292, 'MRR@10': 0.04512984441085295, 'Recall@5': 0.06675373288718137, 'NDCG@5': 0.047768648036501625, 'MRR@5': 0.04152989353645931, 'Recall*@10': 0.09381629391150041, 'NDCG*@10': 0.05650815198367292, 'MRR*@10': 0.04512984441085295, 'Recall*@5': 0.06675373288718137, 'NDCG*@5': 0.047768648036501625, 'MRR*@5': 0.04152989353645931}
INFO    [05-05 19:53:53] train in BasicTrainer:
duration: 32.527079820632935s
INFO    [05-05 19:53:53] train in BasicTrainer:
epoch: 56
INFO    [05-05 19:54:06] _train_one_epoch in BasicTrainer:
loss = 3.9465394488402774
INFO    [05-05 19:54:26] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-05 19:54:26] validate in BasicTrainer:
{'Recall@10': 0.09501732885837555, 'NDCG@10': 0.057229107415134255, 'MRR@10': 0.04572375694459135, 'Recall@5': 0.06808793544769287, 'NDCG@5': 0.04859944365241311, 'MRR@5': 0.04220784997398203, 'Recall*@10': 0.09501732885837555, 'NDCG*@10': 0.057229107415134255, 'MRR*@10': 0.04572375694459135, 'Recall*@5': 0.06808793544769287, 'NDCG*@5': 0.04859944365241311, 'MRR*@5': 0.04220784997398203}
INFO    [05-05 19:54:26] train in BasicTrainer:
duration: 32.828203439712524s
INFO    [05-05 19:54:26] train in BasicTrainer:
epoch: 57
INFO    [05-05 19:54:39] _train_one_epoch in BasicTrainer:
loss = 3.9410644556794847
INFO    [05-05 19:54:58] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-05 19:54:58] validate in BasicTrainer:
{'Recall@10': 0.09516126323829997, 'NDCG@10': 0.057369183748960495, 'MRR@10': 0.04584659128026529, 'Recall@5': 0.06799091669646176, 'NDCG@5': 0.048626969145102936, 'MRR@5': 0.04226417771794579, 'Recall*@10': 0.09516126323829997, 'NDCG*@10': 0.057369183748960495, 'MRR*@10': 0.04584659128026529, 'Recall*@5': 0.06799091669646176, 'NDCG*@5': 0.048626969145102936, 'MRR*@5': 0.04226417771794579}
INFO    [05-05 19:54:58] train in BasicTrainer:
duration: 31.874619245529175s
INFO    [05-05 19:54:58] train in BasicTrainer:
epoch: 58
INFO    [05-05 19:55:12] _train_one_epoch in BasicTrainer:
loss = 3.9355706785406386
INFO    [05-05 19:55:32] log in loggers:
Update Best NDCG@10 Model at 58
INFO    [05-05 19:55:32] validate in BasicTrainer:
{'Recall@10': 0.09505919163877313, 'NDCG@10': 0.05752704597332261, 'MRR@10': 0.046093790368600326, 'Recall@5': 0.06780193136496977, 'NDCG@5': 0.048756956376812675, 'MRR@5': 0.042500297792933205, 'Recall*@10': 0.09505919163877313, 'NDCG*@10': 0.05752704597332261, 'MRR*@10': 0.046093790368600326, 'Recall*@5': 0.06780193136496977, 'NDCG*@5': 0.048756956376812675, 'MRR*@5': 0.042500297792933205}
INFO    [05-05 19:55:32] train in BasicTrainer:
duration: 34.36538076400757s
INFO    [05-05 19:55:32] train in BasicTrainer:
epoch: 59
INFO    [05-05 19:55:46] _train_one_epoch in BasicTrainer:
loss = 3.9279743007251193
INFO    [05-05 19:56:05] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [05-05 19:56:05] validate in BasicTrainer:
{'Recall@10': 0.09562163596803491, 'NDCG@10': 0.05775241553783417, 'MRR@10': 0.04622175171971321, 'Recall@5': 0.06783808022737503, 'NDCG@5': 0.04882661320946433, 'MRR@5': 0.04257230934771625, 'Recall*@10': 0.09562163596803491, 'NDCG*@10': 0.05775241553783417, 'MRR*@10': 0.04622175171971321, 'Recall*@5': 0.06783808022737503, 'NDCG*@5': 0.04882661320946433, 'MRR*@5': 0.04257230934771625}
INFO    [05-05 19:56:05] train in BasicTrainer:
duration: 32.579466104507446s
INFO    [05-05 19:56:05] close_training in BasicTrainer:
finished training
DEBUG   [05-05 19:56:05] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3361 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-05 19:56:05] run_routine in Routine:
Finished training, Start final validation
INFO    [05-05 19:56:05] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-05 19:56:05] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 19:56:05] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 19:56:24] validate in BasicTrainer:
{'Recall@10': 0.09562163596803491, 'NDCG@10': 0.05775241553783417, 'MRR@10': 0.04622175171971321, 'Recall@5': 0.06783808022737503, 'NDCG@5': 0.04882661320946433, 'MRR@5': 0.04257230934771625, 'Recall*@10': 0.09562163596803491, 'NDCG*@10': 0.05775241553783417, 'MRR*@10': 0.04622175171971321, 'Recall*@5': 0.06783808022737503, 'NDCG*@5': 0.04882661320946433, 'MRR*@5': 0.04257230934771625}
INFO    [05-05 19:56:24] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.09562163596803491, 'NDCG@10': 0.05775241553783417, 'MRR@10': 0.04622175171971321, 'Recall@5': 0.06783808022737503, 'NDCG@5': 0.04882661320946433, 'MRR@5': 0.04257230934771625, 'Recall*@10': 0.09562163596803491, 'NDCG*@10': 0.05775241553783417, 'MRR*@10': 0.04622175171971321, 'Recall*@5': 0.06783808022737503, 'NDCG*@5': 0.04882661320946433, 'MRR*@5': 0.04257230934771625}
INFO    [05-05 19:56:24] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-05 19:56:24] test in BasicTrainer:
Test model on test set!
INFO    [05-05 19:56:24] test_with_given_state_path in BasicTrainer:
Loading model params from ___yelp_soft_2022/pop_narm-T-9.0-al-0.75_05-05_19:22_t12/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-05 19:56:24] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 19:56:24] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 19:56:24] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-05 19:56:43] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.07958967306397179, 'NDCG@10': 0.047207282348112625, 'MRR@10': 0.0373877307230776, 'Recall@5': 0.05541998893022537, 'NDCG@5': 0.039447538893331184, 'MRR@5': 0.034217668189243836, 'Recall*@10': 0.07958967306397179, 'NDCG*@10': 0.047207282348112625, 'MRR*@10': 0.0373877307230776, 'Recall*@5': 0.05541998893022537, 'NDCG*@5': 0.039447538893331184, 'MRR*@5': 0.034217668189243836}
INFO    [05-05 19:56:43] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.07958967306397179, 'NDCG@10': 0.047207282348112625, 'MRR@10': 0.0373877307230776, 'Recall@5': 0.05541998893022537, 'NDCG@5': 0.039447538893331184, 'MRR@5': 0.034217668189243836, 'Recall*@10': 0.07958967306397179, 'NDCG*@10': 0.047207282348112625, 'MRR*@10': 0.0373877307230776, 'Recall*@5': 0.05541998893022537, 'NDCG*@5': 0.039447538893331184, 'MRR*@5': 0.034217668189243836}
