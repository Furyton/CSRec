INFO    [05-05 16:22:16] setup_train in utils:
{
    "experiment_dir": "___yelp_soft_2022",
    "experiment_description": "pop",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "yelp.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "alpha": 0.5,
    "T": 3.0,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.yelp/narm/config_distill.json",
    "task_id": 5,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "dvae_alpha": 0.5,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-05 16:22:16] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-05 16:22:16] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/yelp-5-5.pkl
INFO    [05-05 16:22:17] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-05 16:22:17] _check_dataset_cache in utils:
correct.
INFO    [05-05 16:22:17] __init__ in NextItemDataloader:
there are 20033 items in this dataset, 43947 users, padding_first? False
DEBUG   [05-05 16:22:24] generate_model in utils:
model_code_list=['pop']
INFO    [05-05 16:22:24] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-05 16:22:24] load_model_config in utils:
{}
WARNING [05-05 16:22:30] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.5_05-05_16:22_t5/teacher_pop_logs does not exist! Create one.
WARNING [05-05 16:22:30] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.5_05-05_16:22_t5/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-05 16:22:30] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.5_05-05_16:22_t5/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-05 16:22:30] get_path in utils:
Path is None
WARNING [05-05 16:22:30] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 16:22:30] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-05 16:22:30] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 16:22:30] __init__ in BasicTrainer:
229376 iter per epoch
DEBUG   [05-05 16:22:30] generate_model in utils:
model_code_list=['narm']
INFO    [05-05 16:22:30] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-05 16:22:30] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-05 16:22:33] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.5_05-05_16:22_t5/student_narm_logs does not exist! Create one.
WARNING [05-05 16:22:33] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.5_05-05_16:22_t5/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-05 16:22:33] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.5_05-05_16:22_t5/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-05 16:22:33] get_path in utils:
Path is None
WARNING [05-05 16:22:33] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 16:22:33] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(20034, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-05 16:22:33] assert_model_device in utils:
model student_narm has 5.3603515625 MB params.
INFO    [05-05 16:22:33] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 16:22:33] __init__ in DistillTrainer:
229376 iter per epoch
INFO    [05-05 16:22:33] _set_current_routine in Routine:
first routine: student
INFO    [05-05 16:22:33] run_routine in Routine:
Start routine student
INFO    [05-05 16:22:33] run_routine in Routine:
Start training
INFO    [05-05 16:22:33] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-05 16:22:52] test_mentor in DistillTrainer:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 16:22:52] train in DistillTrainer:
result:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 16:23:10] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 16:23:10] validate in BasicTrainer:
{'Recall@10': 0.00044389204545454544, 'NDCG@10': 0.0002111054676457901, 'MRR@10': 0.0001419221515044972, 'Recall@5': 0.0003107244318181818, 'NDCG@5': 0.0001693654326531528, 'MRR@5': 0.00012539950462682597, 'Recall*@10': 0.00044389204545454544, 'NDCG*@10': 0.0002111054676457901, 'MRR*@10': 0.0001419221515044972, 'Recall*@5': 0.0003107244318181818, 'NDCG*@5': 0.0001693654326531528, 'MRR*@5': 0.00012539950462682597}
INFO    [05-05 16:23:10] train in BasicTrainer:
epoch: 0
DEBUG   [05-05 16:23:11] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 9282877
DEBUG   [05-05 16:23:11] calculate_loss in loss:
pred max in softmax: 5.0033249863190576e-05, argmax 48228322
INFO    [05-05 16:23:19] _train_one_epoch in BasicTrainer:
loss = 7.056848168373108
INFO    [05-05 16:23:37] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 16:23:37] validate in BasicTrainer:
{'Recall@10': 0.011296933686191385, 'NDCG@10': 0.0059214058247479525, 'MRR@10': 0.004322941055182706, 'Recall@5': 0.006373580926182595, 'NDCG@5': 0.004336580401286483, 'MRR@5': 0.003673101013356989, 'Recall*@10': 0.011296933686191385, 'NDCG*@10': 0.0059214058247479525, 'MRR*@10': 0.004322941055182706, 'Recall*@5': 0.006373580926182595, 'NDCG*@5': 0.004336580401286483, 'MRR*@5': 0.003673101013356989}
INFO    [05-05 16:23:37] train in BasicTrainer:
duration: 26.771479606628418s
INFO    [05-05 16:23:37] train in BasicTrainer:
epoch: 1
INFO    [05-05 16:23:46] _train_one_epoch in BasicTrainer:
loss = 6.644858470984867
INFO    [05-05 16:24:05] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-05 16:24:05] validate in BasicTrainer:
{'Recall@10': 0.023601526055823673, 'NDCG@10': 0.011616721579974348, 'MRR@10': 0.008029536047781055, 'Recall@5': 0.013488485308533365, 'NDCG@5': 0.008377785074778578, 'MRR@5': 0.006711008958518505, 'Recall*@10': 0.023601526055823673, 'NDCG*@10': 0.011616721579974348, 'MRR*@10': 0.008029536047781055, 'Recall*@5': 0.013488485308533365, 'NDCG*@5': 0.008377785074778578, 'MRR*@5': 0.006711008958518505}
INFO    [05-05 16:24:05] train in BasicTrainer:
duration: 27.564332723617554s
INFO    [05-05 16:24:05] train in BasicTrainer:
epoch: 2
INFO    [05-05 16:24:14] _train_one_epoch in BasicTrainer:
loss = 6.325396478176117
INFO    [05-05 16:24:32] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-05 16:24:32] validate in BasicTrainer:
{'Recall@10': 0.030863552438941868, 'NDCG@10': 0.015451559458266605, 'MRR@10': 0.01082858011465181, 'Recall@5': 0.018323721025477756, 'NDCG@5': 0.011449569497596134, 'MRR@5': 0.009207949042320251, 'Recall*@10': 0.030863552438941868, 'NDCG*@10': 0.015451559458266605, 'MRR*@10': 0.01082858011465181, 'Recall*@5': 0.018323721025477756, 'NDCG*@5': 0.011449569497596134, 'MRR*@5': 0.009207949042320251}
INFO    [05-05 16:24:32] train in BasicTrainer:
duration: 27.4733726978302s
INFO    [05-05 16:24:32] train in BasicTrainer:
epoch: 3
INFO    [05-05 16:24:41] _train_one_epoch in BasicTrainer:
loss = 6.1672618218830655
INFO    [05-05 16:25:00] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-05 16:25:00] validate in BasicTrainer:
{'Recall@10': 0.03642164712602442, 'NDCG@10': 0.01818434132093733, 'MRR@10': 0.012708083895797079, 'Recall@5': 0.02172136018899354, 'NDCG@5': 0.013484284027733585, 'MRR@5': 0.010800084268504923, 'Recall*@10': 0.03642164712602442, 'NDCG*@10': 0.01818434132093733, 'MRR*@10': 0.012708083895797079, 'Recall*@5': 0.02172136018899354, 'NDCG*@5': 0.013484284027733585, 'MRR*@5': 0.010800084268504923}
INFO    [05-05 16:25:00] train in BasicTrainer:
duration: 27.51627492904663s
INFO    [05-05 16:25:00] train in BasicTrainer:
epoch: 4
INFO    [05-05 16:25:08] _train_one_epoch in BasicTrainer:
loss = 6.0685054404394965
INFO    [05-05 16:25:27] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-05 16:25:27] validate in BasicTrainer:
{'Recall@10': 0.03980719704519619, 'NDCG@10': 0.020101739262992687, 'MRR@10': 0.014206381514668465, 'Recall@5': 0.02360405247997154, 'NDCG@5': 0.01491464301943779, 'MRR@5': 0.01209603182294152, 'Recall*@10': 0.03980719704519619, 'NDCG*@10': 0.020101739262992687, 'MRR*@10': 0.014206381514668465, 'Recall*@5': 0.02360405247997154, 'NDCG*@5': 0.01491464301943779, 'MRR*@5': 0.01209603182294152}
INFO    [05-05 16:25:27] train in BasicTrainer:
duration: 27.057618618011475s
INFO    [05-05 16:25:27] train in BasicTrainer:
epoch: 5
INFO    [05-05 16:25:36] _train_one_epoch in BasicTrainer:
loss = 5.988785692623684
INFO    [05-05 16:25:55] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-05 16:25:55] validate in BasicTrainer:
{'Recall@10': 0.045189057222821495, 'NDCG@10': 0.02319207770580595, 'MRR@10': 0.016608751463619145, 'Recall@5': 0.026863471350886604, 'NDCG@5': 0.017314041710712692, 'MRR@5': 0.014210871674797752, 'Recall*@10': 0.045189057222821495, 'NDCG*@10': 0.02319207770580595, 'MRR*@10': 0.016608751463619145, 'Recall*@5': 0.026863471350886604, 'NDCG*@5': 0.017314041710712692, 'MRR*@5': 0.014210871674797752}
INFO    [05-05 16:25:55] train in BasicTrainer:
duration: 27.86015486717224s
INFO    [05-05 16:25:55] train in BasicTrainer:
epoch: 6
INFO    [05-05 16:26:03] _train_one_epoch in BasicTrainer:
loss = 5.916689515113831
INFO    [05-05 16:26:22] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-05 16:26:22] validate in BasicTrainer:
{'Recall@10': 0.04641162536361001, 'NDCG@10': 0.023813053288243034, 'MRR@10': 0.017052783884785393, 'Recall@5': 0.027365045621991158, 'NDCG@5': 0.017718278887596996, 'MRR@5': 0.014574657532979141, 'Recall*@10': 0.04641162536361001, 'NDCG*@10': 0.023813053288243034, 'MRR*@10': 0.017052783884785393, 'Recall*@5': 0.027365045621991158, 'NDCG*@5': 0.017718278887596996, 'MRR*@5': 0.014574657532979141}
INFO    [05-05 16:26:22] train in BasicTrainer:
duration: 27.28384566307068s
INFO    [05-05 16:26:22] train in BasicTrainer:
epoch: 7
INFO    [05-05 16:26:30] _train_one_epoch in BasicTrainer:
loss = 5.848677234990256
INFO    [05-05 16:26:49] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-05 16:26:49] validate in BasicTrainer:
{'Recall@10': 0.04929692365906455, 'NDCG@10': 0.025721098381009968, 'MRR@10': 0.01862266913733699, 'Recall@5': 0.03041647273031148, 'NDCG@5': 0.019664860415187748, 'MRR@5': 0.016151676885783672, 'Recall*@10': 0.04929692365906455, 'NDCG*@10': 0.025721098381009968, 'MRR*@10': 0.01862266913733699, 'Recall*@5': 0.03041647273031148, 'NDCG*@5': 0.019664860415187748, 'MRR*@5': 0.016151676885783672}
INFO    [05-05 16:26:49] train in BasicTrainer:
duration: 27.47177815437317s
INFO    [05-05 16:26:49] train in BasicTrainer:
epoch: 8
INFO    [05-05 16:26:58] _train_one_epoch in BasicTrainer:
loss = 5.784289053508213
INFO    [05-05 16:27:16] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-05 16:27:16] validate in BasicTrainer:
{'Recall@10': 0.05259501798586412, 'NDCG@10': 0.027935710142959248, 'MRR@10': 0.02052647705105218, 'Recall@5': 0.03258450701832771, 'NDCG@5': 0.02151878144253384, 'MRR@5': 0.017909338189796967, 'Recall*@10': 0.05259501798586412, 'NDCG*@10': 0.027935710142959248, 'MRR*@10': 0.02052647705105218, 'Recall*@5': 0.03258450701832771, 'NDCG*@5': 0.02151878144253384, 'MRR*@5': 0.017909338189796967}
INFO    [05-05 16:27:16] train in BasicTrainer:
duration: 26.98436212539673s
INFO    [05-05 16:27:16] train in BasicTrainer:
epoch: 9
INFO    [05-05 16:27:25] _train_one_epoch in BasicTrainer:
loss = 5.7241490483284
INFO    [05-05 16:27:44] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-05 16:27:44] validate in BasicTrainer:
{'Recall@10': 0.05717907642776316, 'NDCG@10': 0.030595358630472965, 'MRR@10': 0.022586121477864006, 'Recall@5': 0.03588831526311961, 'NDCG@5': 0.023745822127569805, 'MRR@5': 0.019779857248067856, 'Recall*@10': 0.05717907642776316, 'NDCG*@10': 0.030595358630472965, 'MRR*@10': 0.022586121477864006, 'Recall*@5': 0.03588831526311961, 'NDCG*@5': 0.023745822127569805, 'MRR*@5': 0.019779857248067856}
INFO    [05-05 16:27:44] train in BasicTrainer:
duration: 27.482313871383667s
INFO    [05-05 16:27:44] train in BasicTrainer:
epoch: 10
INFO    [05-05 16:27:53] _train_one_epoch in BasicTrainer:
loss = 5.665190781865801
INFO    [05-05 16:28:11] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-05 16:28:11] validate in BasicTrainer:
{'Recall@10': 0.06048541075804017, 'NDCG@10': 0.032359040934931145, 'MRR@10': 0.02389668436212973, 'Recall@5': 0.038256762379949745, 'NDCG@5': 0.02525020119818774, 'MRR@5': 0.021008629521185703, 'Recall*@10': 0.06048541075804017, 'NDCG*@10': 0.032359040934931145, 'MRR*@10': 0.02389668436212973, 'Recall*@5': 0.038256762379949745, 'NDCG*@5': 0.02525020119818774, 'MRR*@5': 0.021008629521185703}
INFO    [05-05 16:28:11] train in BasicTrainer:
duration: 27.0553035736084s
INFO    [05-05 16:28:11] train in BasicTrainer:
epoch: 11
INFO    [05-05 16:28:20] _train_one_epoch in BasicTrainer:
loss = 5.60782344852175
INFO    [05-05 16:28:39] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-05 16:28:39] validate in BasicTrainer:
{'Recall@10': 0.06537195362827995, 'NDCG@10': 0.035179654474962845, 'MRR@10': 0.02609386176548221, 'Recall@5': 0.04101647199554877, 'NDCG@5': 0.027364760637283325, 'MRR@5': 0.022903951731595127, 'Recall*@10': 0.06537195362827995, 'NDCG*@10': 0.035179654474962845, 'MRR*@10': 0.02609386176548221, 'Recall*@5': 0.04101647199554877, 'NDCG*@5': 0.027364760637283325, 'MRR*@5': 0.022903951731595127}
INFO    [05-05 16:28:39] train in BasicTrainer:
duration: 27.844611644744873s
INFO    [05-05 16:28:39] train in BasicTrainer:
epoch: 12
INFO    [05-05 16:28:47] _train_one_epoch in BasicTrainer:
loss = 5.554706845964704
INFO    [05-05 16:29:06] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-05 16:29:06] validate in BasicTrainer:
{'Recall@10': 0.06681460277600722, 'NDCG@10': 0.03683130714026364, 'MRR@10': 0.027805298228155483, 'Recall@5': 0.04277742484753782, 'NDCG@5': 0.029113199561834335, 'MRR@5': 0.024651912633668293, 'Recall*@10': 0.06681460277600722, 'NDCG*@10': 0.03683130714026364, 'MRR*@10': 0.027805298228155483, 'Recall*@5': 0.04277742484753782, 'NDCG*@5': 0.029113199561834335, 'MRR*@5': 0.024651912633668293}
INFO    [05-05 16:29:06] train in BasicTrainer:
duration: 27.173333168029785s
INFO    [05-05 16:29:06] train in BasicTrainer:
epoch: 13
INFO    [05-05 16:29:15] _train_one_epoch in BasicTrainer:
loss = 5.506913874830518
INFO    [05-05 16:29:33] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-05 16:29:34] validate in BasicTrainer:
{'Recall@10': 0.068914187902754, 'NDCG@10': 0.03812930495901541, 'MRR@10': 0.0288414503024383, 'Recall@5': 0.044903053817423905, 'NDCG@5': 0.03044668517329476, 'MRR@5': 0.025718524544076485, 'Recall*@10': 0.068914187902754, 'NDCG*@10': 0.03812930495901541, 'MRR*@10': 0.0288414503024383, 'Recall*@5': 0.044903053817423905, 'NDCG*@5': 0.03044668517329476, 'MRR*@5': 0.025718524544076485}
INFO    [05-05 16:29:34] train in BasicTrainer:
duration: 27.602925300598145s
INFO    [05-05 16:29:34] train in BasicTrainer:
epoch: 14
INFO    [05-05 16:29:42] _train_one_epoch in BasicTrainer:
loss = 5.4634184922490805
INFO    [05-05 16:30:00] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-05 16:30:01] validate in BasicTrainer:
{'Recall@10': 0.07022300836714832, 'NDCG@10': 0.03943107514218851, 'MRR@10': 0.030127959156578236, 'Recall@5': 0.046272743831981315, 'NDCG@5': 0.03173095123334364, 'MRR@5': 0.02697623944417997, 'Recall*@10': 0.07022300836714832, 'NDCG*@10': 0.03943107514218851, 'MRR*@10': 0.030127959156578236, 'Recall*@5': 0.046272743831981315, 'NDCG*@5': 0.03173095123334364, 'MRR*@5': 0.02697623944417997}
INFO    [05-05 16:30:01] train in BasicTrainer:
duration: 26.973166465759277s
INFO    [05-05 16:30:01] train in BasicTrainer:
epoch: 15
INFO    [05-05 16:30:09] _train_one_epoch in BasicTrainer:
loss = 5.419592916965485
INFO    [05-05 16:30:28] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-05 16:30:28] validate in BasicTrainer:
{'Recall@10': 0.07051219926639037, 'NDCG@10': 0.0400156636129726, 'MRR@10': 0.030804035846482624, 'Recall@5': 0.046608850698579445, 'NDCG@5': 0.03233064694160765, 'MRR@5': 0.02765799347649921, 'Recall*@10': 0.07051219926639037, 'NDCG*@10': 0.0400156636129726, 'MRR*@10': 0.030804035846482624, 'Recall*@5': 0.046608850698579445, 'NDCG*@5': 0.03233064694160765, 'MRR*@5': 0.02765799347649921}
INFO    [05-05 16:30:28] train in BasicTrainer:
duration: 27.585259914398193s
INFO    [05-05 16:30:28] train in BasicTrainer:
epoch: 16
INFO    [05-05 16:30:37] _train_one_epoch in BasicTrainer:
loss = 5.38271107843944
INFO    [05-05 16:30:55] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-05 16:30:56] validate in BasicTrainer:
{'Recall@10': 0.07274747910824689, 'NDCG@10': 0.04151767085899006, 'MRR@10': 0.03208284909752282, 'Recall@5': 0.04843386059457606, 'NDCG@5': 0.03370191292329268, 'MRR@5': 0.028884158046408134, 'Recall*@10': 0.07274747910824689, 'NDCG*@10': 0.04151767085899006, 'MRR*@10': 0.03208284909752282, 'Recall*@5': 0.04843386059457606, 'NDCG*@5': 0.03370191292329268, 'MRR*@5': 0.028884158046408134}
INFO    [05-05 16:30:56] train in BasicTrainer:
duration: 27.315547227859497s
INFO    [05-05 16:30:56] train in BasicTrainer:
epoch: 17
DEBUG   [05-05 16:31:03] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 1109005
DEBUG   [05-05 16:31:03] calculate_loss in loss:
pred max in softmax: 0.8162240386009216, argmax 48733992
DEBUG   [05-05 16:31:04] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 5496451
DEBUG   [05-05 16:31:04] calculate_loss in loss:
pred max in softmax: 0.6269598603248596, argmax 55833646
INFO    [05-05 16:31:05] _train_one_epoch in BasicTrainer:
loss = 5.347570887633732
INFO    [05-05 16:31:24] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-05 16:31:24] validate in BasicTrainer:
{'Recall@10': 0.07357120581648567, 'NDCG@10': 0.042216707020998, 'MRR@10': 0.032734647393226624, 'Recall@5': 0.049615888433022934, 'NDCG@5': 0.03453385152600028, 'MRR@5': 0.029601613398302685, 'Recall*@10': 0.07357120581648567, 'NDCG*@10': 0.042216707020998, 'MRR*@10': 0.032734647393226624, 'Recall*@5': 0.049615888433022934, 'NDCG*@5': 0.03453385152600028, 'MRR*@5': 0.029601613398302685}
INFO    [05-05 16:31:24] train in BasicTrainer:
duration: 28.40002703666687s
INFO    [05-05 16:31:24] train in BasicTrainer:
epoch: 18
INFO    [05-05 16:31:33] _train_one_epoch in BasicTrainer:
loss = 5.313255318573543
INFO    [05-05 16:31:51] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-05 16:31:51] validate in BasicTrainer:
{'Recall@10': 0.07410134984688325, 'NDCG@10': 0.043006259609352455, 'MRR@10': 0.03358588604764505, 'Recall@5': 0.05104644833640619, 'NDCG@5': 0.03562648238783533, 'MRR@5': 0.030584160746498543, 'Recall*@10': 0.07410134984688325, 'NDCG*@10': 0.043006259609352455, 'MRR*@10': 0.03358588604764505, 'Recall*@5': 0.05104644833640619, 'NDCG*@5': 0.03562648238783533, 'MRR*@5': 0.030584160746498543}
INFO    [05-05 16:31:51] train in BasicTrainer:
duration: 27.256620168685913s
INFO    [05-05 16:31:51] train in BasicTrainer:
epoch: 19
INFO    [05-05 16:32:00] _train_one_epoch in BasicTrainer:
loss = 5.282591640949249
INFO    [05-05 16:32:19] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-05 16:32:19] validate in BasicTrainer:
{'Recall@10': 0.07562958990985696, 'NDCG@10': 0.04411823404106227, 'MRR@10': 0.03455700081857768, 'Recall@5': 0.05193675885146314, 'NDCG@5': 0.03649293665181507, 'MRR@5': 0.031431259248744355, 'Recall*@10': 0.07562958990985696, 'NDCG*@10': 0.04411823404106227, 'MRR*@10': 0.03455700081857768, 'Recall*@5': 0.05193675885146314, 'NDCG*@5': 0.03649293665181507, 'MRR*@5': 0.031431259248744355}
INFO    [05-05 16:32:19] train in BasicTrainer:
duration: 27.85287070274353s
INFO    [05-05 16:32:19] train in BasicTrainer:
epoch: 20
INFO    [05-05 16:32:28] _train_one_epoch in BasicTrainer:
loss = 5.251690302576337
INFO    [05-05 16:32:46] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-05 16:32:46] validate in BasicTrainer:
{'Recall@10': 0.07699675316160376, 'NDCG@10': 0.044891871850598945, 'MRR@10': 0.035148183730515564, 'Recall@5': 0.05291584777561101, 'NDCG@5': 0.03715898299759084, 'MRR@5': 0.03198803775012493, 'Recall*@10': 0.07699675316160376, 'NDCG*@10': 0.044891871850598945, 'MRR*@10': 0.035148183730515564, 'Recall*@5': 0.05291584777561101, 'NDCG*@5': 0.03715898299759084, 'MRR*@5': 0.03198803775012493}
INFO    [05-05 16:32:46] train in BasicTrainer:
duration: 27.19661235809326s
INFO    [05-05 16:32:46] train in BasicTrainer:
epoch: 21
INFO    [05-05 16:32:55] _train_one_epoch in BasicTrainer:
loss = 5.22174928018025
INFO    [05-05 16:33:14] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-05 16:33:14] validate in BasicTrainer:
{'Recall@10': 0.07802275771444495, 'NDCG@10': 0.045624846084551376, 'MRR@10': 0.035800620913505554, 'Recall@5': 0.053772535513747825, 'NDCG@5': 0.037822636691006745, 'MRR@5': 0.03260413828221234, 'Recall*@10': 0.07802275771444495, 'NDCG*@10': 0.045624846084551376, 'MRR*@10': 0.035800620913505554, 'Recall*@5': 0.053772535513747825, 'NDCG*@5': 0.037822636691006745, 'MRR*@5': 0.03260413828221234}
INFO    [05-05 16:33:14] train in BasicTrainer:
duration: 27.476192712783813s
INFO    [05-05 16:33:14] train in BasicTrainer:
epoch: 22
INFO    [05-05 16:33:22] _train_one_epoch in BasicTrainer:
loss = 5.192421751362937
INFO    [05-05 16:33:41] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-05 16:33:41] validate in BasicTrainer:
{'Recall@10': 0.07948694039474834, 'NDCG@10': 0.046710693362084305, 'MRR@10': 0.03678747131065889, 'Recall@5': 0.05457791652191769, 'NDCG@5': 0.038718839260664856, 'MRR@5': 0.033526439050381836, 'Recall*@10': 0.07948694039474834, 'NDCG*@10': 0.046710693362084305, 'MRR*@10': 0.03678747131065889, 'Recall*@5': 0.05457791652191769, 'NDCG*@5': 0.038718839260664856, 'MRR*@5': 0.033526439050381836}
INFO    [05-05 16:33:41] train in BasicTrainer:
duration: 27.07816767692566s
INFO    [05-05 16:33:41] train in BasicTrainer:
epoch: 23
INFO    [05-05 16:33:50] _train_one_epoch in BasicTrainer:
loss = 5.165863565036228
INFO    [05-05 16:34:09] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-05 16:34:09] validate in BasicTrainer:
{'Recall@10': 0.07967911254275929, 'NDCG@10': 0.047276491807265716, 'MRR@10': 0.03745664351365783, 'Recall@5': 0.055246281014247375, 'NDCG@5': 0.03938845849849961, 'MRR@5': 0.034208421002734794, 'Recall*@10': 0.07967911254275929, 'NDCG*@10': 0.047276491807265716, 'MRR*@10': 0.03745664351365783, 'Recall*@5': 0.055246281014247375, 'NDCG*@5': 0.03938845849849961, 'MRR*@5': 0.034208421002734794}
INFO    [05-05 16:34:09] train in BasicTrainer:
duration: 28.313166856765747s
INFO    [05-05 16:34:09] train in BasicTrainer:
epoch: 24
INFO    [05-05 16:34:18] _train_one_epoch in BasicTrainer:
loss = 5.139049019132342
INFO    [05-05 16:34:36] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-05 16:34:37] validate in BasicTrainer:
{'Recall@10': 0.08143753897060048, 'NDCG@10': 0.04793883047320626, 'MRR@10': 0.03781934895298698, 'Recall@5': 0.055162555114789444, 'NDCG@5': 0.03949620879509232, 'MRR@5': 0.03436641852286729, 'Recall*@10': 0.08143753897060048, 'NDCG*@10': 0.04793883047320626, 'MRR*@10': 0.03781934895298698, 'Recall*@5': 0.055162555114789444, 'NDCG*@5': 0.03949620879509232, 'MRR*@5': 0.03436641852286729}
INFO    [05-05 16:34:37] train in BasicTrainer:
duration: 27.469829320907593s
INFO    [05-05 16:34:37] train in BasicTrainer:
epoch: 25
INFO    [05-05 16:34:45] _train_one_epoch in BasicTrainer:
loss = 5.115225570542472
INFO    [05-05 16:35:05] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-05 16:35:05] validate in BasicTrainer:
{'Recall@10': 0.08252254805781624, 'NDCG@10': 0.048724873160774056, 'MRR@10': 0.03851452402093194, 'Recall@5': 0.056153071874921974, 'NDCG@5': 0.04024853760545904, 'MRR@5': 0.03504564037377184, 'Recall*@10': 0.08252254805781624, 'NDCG*@10': 0.048724873160774056, 'MRR*@10': 0.03851452402093194, 'Recall*@5': 0.056153071874921974, 'NDCG*@5': 0.04024853760545904, 'MRR*@5': 0.03504564037377184}
INFO    [05-05 16:35:05] train in BasicTrainer:
duration: 28.35120725631714s
INFO    [05-05 16:35:05] train in BasicTrainer:
epoch: 26
INFO    [05-05 16:35:14] _train_one_epoch in BasicTrainer:
loss = 5.090632353510175
INFO    [05-05 16:35:32] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-05 16:35:32] validate in BasicTrainer:
{'Recall@10': 0.0829664401032708, 'NDCG@10': 0.04931624199856411, 'MRR@10': 0.03913034430959008, 'Recall@5': 0.0567498000508005, 'NDCG@5': 0.04086238213560798, 'MRR@5': 0.035654804753986274, 'Recall*@10': 0.0829664401032708, 'NDCG*@10': 0.04931624199856411, 'MRR*@10': 0.03913034430959008, 'Recall*@5': 0.0567498000508005, 'NDCG*@5': 0.04086238213560798, 'MRR*@5': 0.035654804753986274}
INFO    [05-05 16:35:32] train in BasicTrainer:
duration: 27.553635120391846s
INFO    [05-05 16:35:32] train in BasicTrainer:
epoch: 27
INFO    [05-05 16:35:42] _train_one_epoch in BasicTrainer:
loss = 5.0681195088795254
INFO    [05-05 16:36:01] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-05 16:36:01] validate in BasicTrainer:
{'Recall@10': 0.08403683386065743, 'NDCG@10': 0.04997136105190624, 'MRR@10': 0.03966800529848446, 'Recall@5': 0.05774976076050238, 'NDCG@5': 0.04151150956749916, 'MRR@5': 0.0362005697732622, 'Recall*@10': 0.08403683386065743, 'NDCG*@10': 0.04997136105190624, 'MRR*@10': 0.03966800529848446, 'Recall*@5': 0.05774976076050238, 'NDCG*@5': 0.04151150956749916, 'MRR*@5': 0.0362005697732622}
INFO    [05-05 16:36:01] train in BasicTrainer:
duration: 28.25615382194519s
INFO    [05-05 16:36:01] train in BasicTrainer:
epoch: 28
INFO    [05-05 16:36:09] _train_one_epoch in BasicTrainer:
loss = 5.045531077044351
INFO    [05-05 16:36:28] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-05 16:36:28] validate in BasicTrainer:
{'Recall@10': 0.08477430858395317, 'NDCG@10': 0.0508417124775323, 'MRR@10': 0.0405774400992827, 'Recall@5': 0.05829770795323632, 'NDCG@5': 0.04232033071192828, 'MRR@5': 0.037084037946029144, 'Recall*@10': 0.08477430858395317, 'NDCG*@10': 0.0508417124775323, 'MRR*@10': 0.0405774400992827, 'Recall*@5': 0.05829770795323632, 'NDCG*@5': 0.04232033071192828, 'MRR*@5': 0.037084037946029144}
INFO    [05-05 16:36:28] train in BasicTrainer:
duration: 27.3357834815979s
INFO    [05-05 16:36:28] train in BasicTrainer:
epoch: 29
INFO    [05-05 16:36:37] _train_one_epoch in BasicTrainer:
loss = 5.024495022637503
INFO    [05-05 16:36:57] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-05 16:36:57] validate in BasicTrainer:
{'Recall@10': 0.08544904806397179, 'NDCG@10': 0.051155301996252754, 'MRR@10': 0.04076371951536699, 'Recall@5': 0.05947149578820576, 'NDCG@5': 0.04280870001424442, 'MRR@5': 0.037349807945164765, 'Recall*@10': 0.08544904806397179, 'NDCG*@10': 0.051155301996252754, 'MRR*@10': 0.04076371951536699, 'Recall*@5': 0.05947149578820576, 'NDCG*@5': 0.04280870001424442, 'MRR*@5': 0.037349807945164765}
INFO    [05-05 16:36:57] train in BasicTrainer:
duration: 28.938778400421143s
INFO    [05-05 16:36:57] train in BasicTrainer:
epoch: 30
INFO    [05-05 16:37:05] _train_one_epoch in BasicTrainer:
loss = 5.00106452192579
INFO    [05-05 16:37:24] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [05-05 16:37:25] validate in BasicTrainer:
{'Recall@10': 0.08613960715857419, 'NDCG@10': 0.05191878906705163, 'MRR@10': 0.04154847494580529, 'Recall@5': 0.06031170284206217, 'NDCG@5': 0.0436125404455445, 'MRR@5': 0.038146599449894646, 'Recall*@10': 0.08613960715857419, 'NDCG*@10': 0.05191878906705163, 'MRR*@10': 0.04154847494580529, 'Recall*@5': 0.06031170284206217, 'NDCG*@5': 0.0436125404455445, 'MRR*@5': 0.038146599449894646}
INFO    [05-05 16:37:25] train in BasicTrainer:
duration: 27.577056646347046s
INFO    [05-05 16:37:25] train in BasicTrainer:
epoch: 31
INFO    [05-05 16:37:33] _train_one_epoch in BasicTrainer:
loss = 4.98332199880055
INFO    [05-05 16:37:52] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-05 16:37:52] validate in BasicTrainer:
{'Recall@10': 0.08750424466349861, 'NDCG@10': 0.05286588587544181, 'MRR@10': 0.04234974560412494, 'Recall@5': 0.061852574687112465, 'NDCG@5': 0.04459603571078994, 'MRR@5': 0.03895174813541499, 'Recall*@10': 0.08750424466349861, 'NDCG*@10': 0.05286588587544181, 'MRR*@10': 0.04234974560412494, 'Recall*@5': 0.061852574687112465, 'NDCG*@5': 0.04459603571078994, 'MRR*@5': 0.03895174813541499}
INFO    [05-05 16:37:52] train in BasicTrainer:
duration: 27.307718753814697s
INFO    [05-05 16:37:52] train in BasicTrainer:
epoch: 32
INFO    [05-05 16:38:01] _train_one_epoch in BasicTrainer:
loss = 4.963908204010555
INFO    [05-05 16:38:20] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-05 16:38:20] validate in BasicTrainer:
{'Recall@10': 0.08786056190729141, 'NDCG@10': 0.05289660394191742, 'MRR@10': 0.04231297461823984, 'Recall@5': 0.06094963238997893, 'NDCG@5': 0.0442080944776535, 'MRR@5': 0.03873488476330584, 'Recall*@10': 0.08786056190729141, 'NDCG*@10': 0.05289660394191742, 'MRR*@10': 0.04231297461823984, 'Recall*@5': 0.06094963238997893, 'NDCG*@5': 0.0442080944776535, 'MRR*@5': 0.03873488476330584}
INFO    [05-05 16:38:20] train in BasicTrainer:
duration: 28.047333002090454s
INFO    [05-05 16:38:20] train in BasicTrainer:
epoch: 33
INFO    [05-05 16:38:29] _train_one_epoch in BasicTrainer:
loss = 4.945122744355883
INFO    [05-05 16:38:47] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-05 16:38:47] validate in BasicTrainer:
{'Recall@10': 0.08901281587102196, 'NDCG@10': 0.05416273732076992, 'MRR@10': 0.043589777228507126, 'Recall@5': 0.06247149712660096, 'NDCG@5': 0.04561342840844935, 'MRR@5': 0.04008106176148762, 'Recall*@10': 0.08901281587102196, 'NDCG*@10': 0.05416273732076992, 'MRR*@10': 0.043589777228507126, 'Recall*@5': 0.06247149712660096, 'NDCG*@5': 0.04561342840844935, 'MRR*@5': 0.04008106176148762}
INFO    [05-05 16:38:47] train in BasicTrainer:
duration: 27.05703330039978s
INFO    [05-05 16:38:47] train in BasicTrainer:
epoch: 34
INFO    [05-05 16:38:56] _train_one_epoch in BasicTrainer:
loss = 4.9274097340447565
INFO    [05-05 16:39:14] validate in BasicTrainer:
{'Recall@10': 0.08832983604886314, 'NDCG@10': 0.053757412867112594, 'MRR@10': 0.04324551299214363, 'Recall@5': 0.06259961189194159, 'NDCG@5': 0.04548377713019198, 'MRR@5': 0.03985762968659401, 'Recall*@10': 0.08832983604886314, 'NDCG*@10': 0.053757412867112594, 'MRR*@10': 0.04324551299214363, 'Recall*@5': 0.06259961189194159, 'NDCG*@5': 0.04548377713019198, 'MRR*@5': 0.03985762968659401}
INFO    [05-05 16:39:14] train in BasicTrainer:
duration: 27.36883521080017s
INFO    [05-05 16:39:14] train in BasicTrainer:
epoch: 35
DEBUG   [05-05 16:39:20] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 5997301
DEBUG   [05-05 16:39:20] calculate_loss in loss:
pred max in softmax: 0.9536692500114441, argmax 46870830
DEBUG   [05-05 16:39:20] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 27634021
DEBUG   [05-05 16:39:20] calculate_loss in loss:
pred max in softmax: 0.9332786202430725, argmax 16094448
INFO    [05-05 16:39:23] _train_one_epoch in BasicTrainer:
loss = 4.910992511681148
INFO    [05-05 16:39:41] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-05 16:39:41] validate in BasicTrainer:
{'Recall@10': 0.08924739401448857, 'NDCG@10': 0.05419210954145952, 'MRR@10': 0.04355177960612557, 'Recall@5': 0.06264334002679045, 'NDCG@5': 0.04562780599702488, 'MRR@5': 0.04003995894031091, 'Recall*@10': 0.08924739401448857, 'NDCG*@10': 0.05419210954145952, 'MRR*@10': 0.04355177960612557, 'Recall*@5': 0.06264334002679045, 'NDCG*@5': 0.04562780599702488, 'MRR*@5': 0.04003995894031091}
INFO    [05-05 16:39:41] train in BasicTrainer:
duration: 27.07992124557495s
INFO    [05-05 16:39:41] train in BasicTrainer:
epoch: 36
INFO    [05-05 16:39:50] _train_one_epoch in BasicTrainer:
loss = 4.894370632512229
INFO    [05-05 16:40:09] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-05 16:40:09] validate in BasicTrainer:
{'Recall@10': 0.08980863405899568, 'NDCG@10': 0.05488679117777131, 'MRR@10': 0.044251245869831604, 'Recall@5': 0.06457427042451772, 'NDCG@5': 0.04676260866902091, 'MRR@5': 0.04091973602771759, 'Recall*@10': 0.08980863405899568, 'NDCG*@10': 0.05488679117777131, 'MRR*@10': 0.044251245869831604, 'Recall*@5': 0.06457427042451772, 'NDCG*@5': 0.04676260866902091, 'MRR*@5': 0.04091973602771759}
INFO    [05-05 16:40:09] train in BasicTrainer:
duration: 27.720648050308228s
INFO    [05-05 16:40:09] train in BasicTrainer:
epoch: 37
INFO    [05-05 16:40:18] _train_one_epoch in BasicTrainer:
loss = 4.8770909649985175
INFO    [05-05 16:40:36] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [05-05 16:40:36] validate in BasicTrainer:
{'Recall@10': 0.0899950922890143, 'NDCG@10': 0.05548458986661651, 'MRR@10': 0.044967300512573936, 'Recall@5': 0.06482665139165791, 'NDCG@5': 0.047378631816668945, 'MRR@5': 0.04164148900996555, 'Recall*@10': 0.0899950922890143, 'NDCG*@10': 0.05548458986661651, 'MRR*@10': 0.044967300512573936, 'Recall*@5': 0.06482665139165791, 'NDCG*@5': 0.047378631816668945, 'MRR*@5': 0.04164148900996555}
INFO    [05-05 16:40:36] train in BasicTrainer:
duration: 27.17158269882202s
INFO    [05-05 16:40:36] train in BasicTrainer:
epoch: 38
INFO    [05-05 16:40:45] _train_one_epoch in BasicTrainer:
loss = 4.860891623156411
INFO    [05-05 16:41:04] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-05 16:41:04] validate in BasicTrainer:
{'Recall@10': 0.09076234088702635, 'NDCG@10': 0.05592409826137803, 'MRR@10': 0.045302829620513047, 'Recall@5': 0.0659217658368024, 'NDCG@5': 0.04794502258300781, 'MRR@5': 0.042040894654664124, 'Recall*@10': 0.09076234088702635, 'NDCG*@10': 0.05592409826137803, 'MRR*@10': 0.045302829620513047, 'Recall*@5': 0.0659217658368024, 'NDCG*@5': 0.04794502258300781, 'MRR*@5': 0.042040894654664124}
INFO    [05-05 16:41:04] train in BasicTrainer:
duration: 27.615136861801147s
INFO    [05-05 16:41:04] train in BasicTrainer:
epoch: 39
INFO    [05-05 16:41:13] _train_one_epoch in BasicTrainer:
loss = 4.848567417689732
INFO    [05-05 16:41:31] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [05-05 16:41:31] validate in BasicTrainer:
{'Recall@10': 0.09105658463456413, 'NDCG@10': 0.0559822717173533, 'MRR@10': 0.04531819339502941, 'Recall@5': 0.0652179138904268, 'NDCG@5': 0.04767460579221899, 'MRR@5': 0.04191736538301815, 'Recall*@10': 0.09105658463456413, 'NDCG*@10': 0.0559822717173533, 'MRR*@10': 0.04531819339502941, 'Recall*@5': 0.0652179138904268, 'NDCG*@5': 0.04767460579221899, 'MRR*@5': 0.04191736538301815}
INFO    [05-05 16:41:31] train in BasicTrainer:
duration: 27.384013175964355s
INFO    [05-05 16:41:31] train in BasicTrainer:
epoch: 40
INFO    [05-05 16:41:40] _train_one_epoch in BasicTrainer:
loss = 4.835123138768332
INFO    [05-05 16:41:59] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [05-05 16:41:59] validate in BasicTrainer:
{'Recall@10': 0.0913622562180866, 'NDCG@10': 0.05651959844610908, 'MRR@10': 0.045947566628456116, 'Recall@5': 0.06513990190896121, 'NDCG@5': 0.04810844226316972, 'MRR@5': 0.04251631179993803, 'Recall*@10': 0.0913622562180866, 'NDCG*@10': 0.05651959844610908, 'MRR*@10': 0.045947566628456116, 'Recall*@5': 0.06513990190896121, 'NDCG*@5': 0.04810844226316972, 'MRR*@5': 0.04251631179993803}
INFO    [05-05 16:41:59] train in BasicTrainer:
duration: 27.894134998321533s
INFO    [05-05 16:41:59] train in BasicTrainer:
epoch: 41
INFO    [05-05 16:42:08] _train_one_epoch in BasicTrainer:
loss = 4.819884717464447
INFO    [05-05 16:42:26] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-05 16:42:26] validate in BasicTrainer:
{'Recall@10': 0.09173890338702635, 'NDCG@10': 0.056616578589786186, 'MRR@10': 0.045936886898495934, 'Recall@5': 0.06605812094428322, 'NDCG@5': 0.048364244401454926, 'MRR@5': 0.042561888694763184, 'Recall*@10': 0.09173890338702635, 'NDCG*@10': 0.056616578589786186, 'MRR*@10': 0.045936886898495934, 'Recall*@5': 0.06605812094428322, 'NDCG*@5': 0.048364244401454926, 'MRR*@5': 0.042561888694763184}
INFO    [05-05 16:42:26] train in BasicTrainer:
duration: 27.19226098060608s
INFO    [05-05 16:42:26] train in BasicTrainer:
epoch: 42
INFO    [05-05 16:42:35] _train_one_epoch in BasicTrainer:
loss = 4.804533890315464
INFO    [05-05 16:42:54] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-05 16:42:54] validate in BasicTrainer:
{'Recall@10': 0.09196084940975363, 'NDCG@10': 0.05694612047889016, 'MRR@10': 0.04628267376260324, 'Recall@5': 0.06688756157051433, 'NDCG@5': 0.048887995833700355, 'MRR@5': 0.04298626800829714, 'Recall*@10': 0.09196084940975363, 'NDCG*@10': 0.05694612047889016, 'MRR*@10': 0.04628267376260324, 'Recall*@5': 0.06688756157051433, 'NDCG*@5': 0.048887995833700355, 'MRR*@5': 0.04298626800829714}
INFO    [05-05 16:42:54] train in BasicTrainer:
duration: 27.990979194641113s
INFO    [05-05 16:42:54] train in BasicTrainer:
epoch: 43
INFO    [05-05 16:43:03] _train_one_epoch in BasicTrainer:
loss = 4.793811806610653
INFO    [05-05 16:43:21] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [05-05 16:43:22] validate in BasicTrainer:
{'Recall@10': 0.09229124201969667, 'NDCG@10': 0.057423477145758545, 'MRR@10': 0.04680629650300199, 'Recall@5': 0.06683174452998421, 'NDCG@5': 0.04923120784488591, 'MRR@5': 0.0434490560807965, 'Recall*@10': 0.09229124201969667, 'NDCG*@10': 0.057423477145758545, 'MRR*@10': 0.04680629650300199, 'Recall*@5': 0.06683174452998421, 'NDCG*@5': 0.04923120784488591, 'MRR*@5': 0.0434490560807965}
INFO    [05-05 16:43:22] train in BasicTrainer:
duration: 27.169646978378296s
INFO    [05-05 16:43:22] train in BasicTrainer:
epoch: 44
INFO    [05-05 16:43:30] _train_one_epoch in BasicTrainer:
loss = 4.7799553615706305
INFO    [05-05 16:43:49] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-05 16:43:49] validate in BasicTrainer:
{'Recall@10': 0.0933952582153407, 'NDCG@10': 0.057866237718950615, 'MRR@10': 0.047066976739601654, 'Recall@5': 0.06665803661400621, 'NDCG@5': 0.04927018386396495, 'MRR@5': 0.04354880851778117, 'Recall*@10': 0.0933952582153407, 'NDCG*@10': 0.057866237718950615, 'MRR*@10': 0.047066976739601654, 'Recall*@5': 0.06665803661400621, 'NDCG*@5': 0.04927018386396495, 'MRR*@5': 0.04354880851778117}
INFO    [05-05 16:43:49] train in BasicTrainer:
duration: 27.52639102935791s
INFO    [05-05 16:43:49] train in BasicTrainer:
epoch: 45
INFO    [05-05 16:43:58] _train_one_epoch in BasicTrainer:
loss = 4.767480373382568
INFO    [05-05 16:44:16] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-05 16:44:16] validate in BasicTrainer:
{'Recall@10': 0.09341745281761343, 'NDCG@10': 0.05819461901079525, 'MRR@10': 0.047452585941011254, 'Recall@5': 0.06792180646549571, 'NDCG@5': 0.0499795526266098, 'MRR@5': 0.04408022727478634, 'Recall*@10': 0.09341745281761343, 'NDCG*@10': 0.05819461901079525, 'MRR*@10': 0.047452585941011254, 'Recall*@5': 0.06792180646549571, 'NDCG*@5': 0.0499795526266098, 'MRR*@5': 0.04408022727478634}
INFO    [05-05 16:44:16] train in BasicTrainer:
duration: 27.283987760543823s
INFO    [05-05 16:44:16] train in BasicTrainer:
epoch: 46
INFO    [05-05 16:44:25] _train_one_epoch in BasicTrainer:
loss = 4.753699822085244
INFO    [05-05 16:44:44] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-05 16:44:44] validate in BasicTrainer:
{'Recall@10': 0.0948429595340382, 'NDCG@10': 0.05855043638836254, 'MRR@10': 0.04750688915902918, 'Recall@5': 0.06854072890498421, 'NDCG@5': 0.05010385371067307, 'MRR@5': 0.04405481910163706, 'Recall*@10': 0.0948429595340382, 'NDCG*@10': 0.05855043638836254, 'MRR*@10': 0.04750688915902918, 'Recall*@5': 0.06854072890498421, 'NDCG*@5': 0.05010385371067307, 'MRR*@5': 0.04405481910163706}
INFO    [05-05 16:44:44] train in BasicTrainer:
duration: 27.546942234039307s
INFO    [05-05 16:44:44] train in BasicTrainer:
epoch: 47
INFO    [05-05 16:44:52] _train_one_epoch in BasicTrainer:
loss = 4.741719799382346
INFO    [05-05 16:45:11] log in loggers:
Update Best NDCG@10 Model at 47
INFO    [05-05 16:45:11] validate in BasicTrainer:
{'Recall@10': 0.09482076493176547, 'NDCG@10': 0.05882246047258377, 'MRR@10': 0.047850008715282784, 'Recall@5': 0.0689649527723139, 'NDCG@5': 0.05052467029203068, 'MRR@5': 0.04446258395910263, 'Recall*@10': 0.09482076493176547, 'NDCG*@10': 0.05882246047258377, 'MRR*@10': 0.047850008715282784, 'Recall*@5': 0.0689649527723139, 'NDCG*@5': 0.05052467029203068, 'MRR*@5': 0.04446258395910263}
INFO    [05-05 16:45:11] train in BasicTrainer:
duration: 26.970797300338745s
INFO    [05-05 16:45:11] train in BasicTrainer:
epoch: 48
INFO    [05-05 16:45:20] _train_one_epoch in BasicTrainer:
loss = 4.730809126581464
INFO    [05-05 16:45:38] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-05 16:45:39] validate in BasicTrainer:
{'Recall@10': 0.09531915187835693, 'NDCG@10': 0.058947715908288956, 'MRR@10': 0.047855112701654434, 'Recall@5': 0.0699408535252918, 'NDCG@5': 0.050808136436072265, 'MRR@5': 0.04453497075221755, 'Recall*@10': 0.09531915187835693, 'NDCG*@10': 0.058947715908288956, 'MRR*@10': 0.047855112701654434, 'Recall*@5': 0.0699408535252918, 'NDCG*@5': 0.050808136436072265, 'MRR*@5': 0.04453497075221755}
INFO    [05-05 16:45:39] train in BasicTrainer:
duration: 27.612184524536133s
INFO    [05-05 16:45:39] train in BasicTrainer:
epoch: 49
INFO    [05-05 16:45:47] _train_one_epoch in BasicTrainer:
loss = 4.720634962831225
INFO    [05-05 16:46:06] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-05 16:46:06] validate in BasicTrainer:
{'Recall@10': 0.09535277431661432, 'NDCG@10': 0.05925990370186893, 'MRR@10': 0.0482274747707627, 'Recall@5': 0.06999667124314742, 'NDCG@5': 0.051093727350234985, 'MRR@5': 0.044876632703976196, 'Recall*@10': 0.09535277431661432, 'NDCG*@10': 0.05925990370186893, 'MRR*@10': 0.0482274747707627, 'Recall*@5': 0.06999667124314742, 'NDCG*@5': 0.051093727350234985, 'MRR*@5': 0.044876632703976196}
INFO    [05-05 16:46:06] train in BasicTrainer:
duration: 27.40511393547058s
INFO    [05-05 16:46:06] train in BasicTrainer:
epoch: 50
INFO    [05-05 16:46:15] _train_one_epoch in BasicTrainer:
loss = 4.708385237625667
INFO    [05-05 16:46:34] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-05 16:46:34] validate in BasicTrainer:
{'Recall@10': 0.09656138853593306, 'NDCG@10': 0.059683970768343315, 'MRR@10': 0.04846711253578013, 'Recall@5': 0.06952487000010231, 'NDCG@5': 0.051009016958149994, 'MRR@5': 0.04492692784829573, 'Recall*@10': 0.09656138853593306, 'NDCG*@10': 0.059683970768343315, 'MRR*@10': 0.04846711253578013, 'Recall*@5': 0.06952487000010231, 'NDCG*@5': 0.051009016958149994, 'MRR*@5': 0.04492692784829573}
INFO    [05-05 16:46:34] train in BasicTrainer:
duration: 28.55904245376587s
INFO    [05-05 16:46:34] train in BasicTrainer:
epoch: 51
INFO    [05-05 16:46:43] _train_one_epoch in BasicTrainer:
loss = 4.701227179595402
INFO    [05-05 16:47:01] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [05-05 16:47:02] validate in BasicTrainer:
{'Recall@10': 0.09673070501197469, 'NDCG@10': 0.06058351797136394, 'MRR@10': 0.04956201497804035, 'Recall@5': 0.0703543106263334, 'NDCG@5': 0.052101733670993286, 'MRR@5': 0.046088976616209205, 'Recall*@10': 0.09673070501197469, 'NDCG*@10': 0.06058351797136394, 'MRR*@10': 0.04956201497804035, 'Recall*@5': 0.0703543106263334, 'NDCG*@5': 0.052101733670993286, 'MRR*@5': 0.046088976616209205}
INFO    [05-05 16:47:02] train in BasicTrainer:
duration: 27.17139959335327s
INFO    [05-05 16:47:02] train in BasicTrainer:
epoch: 52
INFO    [05-05 16:47:11] _train_one_epoch in BasicTrainer:
loss = 4.688915201595852
INFO    [05-05 16:47:30] validate in BasicTrainer:
{'Recall@10': 0.09747774221680382, 'NDCG@10': 0.060512620278380135, 'MRR@10': 0.04928454011678696, 'Recall@5': 0.06965298544276845, 'NDCG@5': 0.05157899348573251, 'MRR@5': 0.0456346141343767, 'Recall*@10': 0.09747774221680382, 'NDCG*@10': 0.060512620278380135, 'MRR*@10': 0.04928454011678696, 'Recall*@5': 0.06965298544276845, 'NDCG*@5': 0.05157899348573251, 'MRR*@5': 0.0456346141343767}
INFO    [05-05 16:47:30] train in BasicTrainer:
duration: 28.091967582702637s
INFO    [05-05 16:47:30] train in BasicTrainer:
epoch: 53
DEBUG   [05-05 16:47:35] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 6798661
DEBUG   [05-05 16:47:35] calculate_loss in loss:
pred max in softmax: 0.8351589441299438, argmax 60509996
DEBUG   [05-05 16:47:35] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 2511385
DEBUG   [05-05 16:47:35] calculate_loss in loss:
pred max in softmax: 0.9062433242797852, argmax 9126348
INFO    [05-05 16:47:38] _train_one_epoch in BasicTrainer:
loss = 4.6774700198854715
INFO    [05-05 16:47:57] validate in BasicTrainer:
{'Recall@10': 0.09735852886329997, 'NDCG@10': 0.06042609702457081, 'MRR@10': 0.049168808555061165, 'Recall@5': 0.07034101811322299, 'NDCG@5': 0.051716873930259186, 'MRR@5': 0.04559021002867005, 'Recall*@10': 0.09735852886329997, 'NDCG*@10': 0.06042609702457081, 'MRR*@10': 0.049168808555061165, 'Recall*@5': 0.07034101811322299, 'NDCG*@5': 0.051716873930259186, 'MRR*@5': 0.04559021002867005}
INFO    [05-05 16:47:57] train in BasicTrainer:
duration: 26.924495935440063s
INFO    [05-05 16:47:57] train in BasicTrainer:
epoch: 54
INFO    [05-05 16:48:06] _train_one_epoch in BasicTrainer:
loss = 4.6713937265532355
INFO    [05-05 16:48:25] log in loggers:
Update Best NDCG@10 Model at 54
INFO    [05-05 16:48:25] validate in BasicTrainer:
{'Recall@10': 0.09768254648555409, 'NDCG@10': 0.060955173928629265, 'MRR@10': 0.049745949831875885, 'Recall@5': 0.07133592597462914, 'NDCG@5': 0.052480217069387436, 'MRR@5': 0.04627435281872749, 'Recall*@10': 0.09768254648555409, 'NDCG*@10': 0.060955173928629265, 'MRR*@10': 0.049745949831875885, 'Recall*@5': 0.07133592597462914, 'NDCG*@5': 0.052480217069387436, 'MRR*@5': 0.04627435281872749}
INFO    [05-05 16:48:25] train in BasicTrainer:
duration: 28.146774291992188s
INFO    [05-05 16:48:25] train in BasicTrainer:
epoch: 55
INFO    [05-05 16:48:33] _train_one_epoch in BasicTrainer:
loss = 4.6608609812600275
INFO    [05-05 16:48:52] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [05-05 16:48:52] validate in BasicTrainer:
{'Recall@10': 0.0982259837063876, 'NDCG@10': 0.06146876243027774, 'MRR@10': 0.050250955264676704, 'Recall@5': 0.07185464216904207, 'NDCG@5': 0.05299625444141301, 'MRR@5': 0.04678632522171194, 'Recall*@10': 0.0982259837063876, 'NDCG*@10': 0.06146876243027774, 'MRR*@10': 0.050250955264676704, 'Recall*@5': 0.07185464216904207, 'NDCG*@5': 0.05299625444141301, 'MRR*@5': 0.04678632522171194}
INFO    [05-05 16:48:52] train in BasicTrainer:
duration: 26.991565704345703s
INFO    [05-05 16:48:52] train in BasicTrainer:
epoch: 56
INFO    [05-05 16:49:01] _train_one_epoch in BasicTrainer:
loss = 4.651926474911826
INFO    [05-05 16:49:20] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-05 16:49:20] validate in BasicTrainer:
{'Recall@10': 0.09798503057523207, 'NDCG@10': 0.061672340739857064, 'MRR@10': 0.050583968447013336, 'Recall@5': 0.07225733250379562, 'NDCG@5': 0.05340945246544751, 'MRR@5': 0.04720620506189086, 'Recall*@10': 0.09798503057523207, 'NDCG*@10': 0.061672340739857064, 'MRR*@10': 0.050583968447013336, 'Recall*@5': 0.07225733250379562, 'NDCG*@5': 0.05340945246544751, 'MRR*@5': 0.04720620506189086}
INFO    [05-05 16:49:20] train in BasicTrainer:
duration: 28.392657995224s
INFO    [05-05 16:49:20] train in BasicTrainer:
epoch: 57
INFO    [05-05 16:49:29] _train_one_epoch in BasicTrainer:
loss = 4.642531088420323
INFO    [05-05 16:49:48] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-05 16:49:48] validate in BasicTrainer:
{'Recall@10': 0.09969335320320996, 'NDCG@10': 0.06243934787132523, 'MRR@10': 0.05106279761953787, 'Recall@5': 0.07300304756923155, 'NDCG@5': 0.05382872846993533, 'MRR@5': 0.04752143201502887, 'Recall*@10': 0.09969335320320996, 'NDCG*@10': 0.06243934787132523, 'MRR*@10': 0.05106279761953787, 'Recall*@5': 0.07300304756923155, 'NDCG*@5': 0.05382872846993533, 'MRR*@5': 0.04752143201502887}
INFO    [05-05 16:49:48] train in BasicTrainer:
duration: 28.29355764389038s
INFO    [05-05 16:49:48] train in BasicTrainer:
epoch: 58
INFO    [05-05 16:49:57] _train_one_epoch in BasicTrainer:
loss = 4.635616413184574
INFO    [05-05 16:50:15] validate in BasicTrainer:
{'Recall@10': 0.09970159354535016, 'NDCG@10': 0.06243907152251764, 'MRR@10': 0.05104518173770471, 'Recall@5': 0.07366064529527318, 'NDCG@5': 0.054056605832143265, 'MRR@5': 0.047608996656807984, 'Recall*@10': 0.09970159354535016, 'NDCG*@10': 0.06243907152251764, 'MRR*@10': 0.05104518173770471, 'Recall*@5': 0.07366064529527318, 'NDCG*@5': 0.054056605832143265, 'MRR*@5': 0.047608996656807984}
INFO    [05-05 16:50:15] train in BasicTrainer:
duration: 26.715351819992065s
INFO    [05-05 16:50:15] train in BasicTrainer:
epoch: 59
INFO    [05-05 16:50:24] _train_one_epoch in BasicTrainer:
loss = 4.625454017094204
INFO    [05-05 16:50:43] validate in BasicTrainer:
{'Recall@10': 0.09993177991021764, 'NDCG@10': 0.062422868203033104, 'MRR@10': 0.050973223691636864, 'Recall@5': 0.07350209558551962, 'NDCG@5': 0.05392301387407563, 'MRR@5': 0.047493111342191696, 'Recall*@10': 0.09993177991021764, 'NDCG*@10': 0.062422868203033104, 'MRR*@10': 0.050973223691636864, 'Recall*@5': 0.07350209558551962, 'NDCG*@5': 0.05392301387407563, 'MRR*@5': 0.047493111342191696}
INFO    [05-05 16:50:43] train in BasicTrainer:
duration: 27.867738246917725s
INFO    [05-05 16:50:43] close_training in BasicTrainer:
finished training
DEBUG   [05-05 16:50:43] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3361 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-05 16:50:43] run_routine in Routine:
Finished training, Start final validation
INFO    [05-05 16:50:43] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-05 16:50:43] load_state_from_given_path in utils:
checkpoint epoch: 57
INFO    [05-05 16:50:43] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 16:51:02] validate in BasicTrainer:
{'Recall@10': 0.09969335320320996, 'NDCG@10': 0.06243934787132523, 'MRR@10': 0.05106279761953787, 'Recall@5': 0.07300304756923155, 'NDCG@5': 0.05382872846993533, 'MRR@5': 0.04752143201502887, 'Recall*@10': 0.09969335320320996, 'NDCG*@10': 0.06243934787132523, 'MRR*@10': 0.05106279761953787, 'Recall*@5': 0.07300304756923155, 'NDCG*@5': 0.05382872846993533, 'MRR*@5': 0.04752143201502887}
INFO    [05-05 16:51:02] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.09969335320320996, 'NDCG@10': 0.06243934787132523, 'MRR@10': 0.05106279761953787, 'Recall@5': 0.07300304756923155, 'NDCG@5': 0.05382872846993533, 'MRR@5': 0.04752143201502887, 'Recall*@10': 0.09969335320320996, 'NDCG*@10': 0.06243934787132523, 'MRR*@10': 0.05106279761953787, 'Recall*@5': 0.07300304756923155, 'NDCG*@5': 0.05382872846993533, 'MRR*@5': 0.04752143201502887}
INFO    [05-05 16:51:02] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-05 16:51:02] test in BasicTrainer:
Test model on test set!
INFO    [05-05 16:51:02] test_with_given_state_path in BasicTrainer:
Loading model params from ___yelp_soft_2022/pop_narm-T-3.0-al-0.5_05-05_16:22_t5/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-05 16:51:02] load_state_from_given_path in utils:
checkpoint epoch: 57
INFO    [05-05 16:51:02] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 16:51:02] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-05 16:51:21] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.08305960961363533, 'NDCG@10': 0.050225042484023354, 'MRR@10': 0.04023384235121987, 'Recall@5': 0.05872060934251005, 'NDCG@5': 0.04239181903275577, 'MRR@5': 0.03702259436249733, 'Recall*@10': 0.08305960961363533, 'NDCG*@10': 0.050225042484023354, 'MRR*@10': 0.04023384235121987, 'Recall*@5': 0.05872060934251005, 'NDCG*@5': 0.04239181903275577, 'MRR*@5': 0.03702259436249733}
INFO    [05-05 16:51:21] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.08305960961363533, 'NDCG@10': 0.050225042484023354, 'MRR@10': 0.04023384235121987, 'Recall@5': 0.05872060934251005, 'NDCG@5': 0.04239181903275577, 'MRR@5': 0.03702259436249733, 'Recall*@10': 0.08305960961363533, 'NDCG*@10': 0.050225042484023354, 'MRR*@10': 0.04023384235121987, 'Recall*@5': 0.05872060934251005, 'NDCG*@5': 0.04239181903275577, 'MRR*@5': 0.03702259436249733}
