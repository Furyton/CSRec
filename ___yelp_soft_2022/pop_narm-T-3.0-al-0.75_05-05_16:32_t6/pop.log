INFO    [05-05 16:32:18] setup_train in utils:
{
    "experiment_dir": "___yelp_soft_2022",
    "experiment_description": "pop",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "yelp.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "alpha": 0.75,
    "T": 3.0,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.yelp/narm/config_distill.json",
    "task_id": 6,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "dvae_alpha": 0.5,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-05 16:32:18] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-05 16:32:18] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/yelp-5-5.pkl
INFO    [05-05 16:32:19] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-05 16:32:19] _check_dataset_cache in utils:
correct.
INFO    [05-05 16:32:19] __init__ in NextItemDataloader:
there are 20033 items in this dataset, 43947 users, padding_first? False
DEBUG   [05-05 16:32:26] generate_model in utils:
model_code_list=['pop']
INFO    [05-05 16:32:26] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-05 16:32:26] load_model_config in utils:
{}
WARNING [05-05 16:32:42] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.75_05-05_16:32_t6/teacher_pop_logs does not exist! Create one.
WARNING [05-05 16:32:42] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.75_05-05_16:32_t6/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-05 16:32:42] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.75_05-05_16:32_t6/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-05 16:32:42] get_path in utils:
Path is None
WARNING [05-05 16:32:42] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 16:32:42] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-05 16:32:42] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 16:32:42] __init__ in BasicTrainer:
229376 iter per epoch
DEBUG   [05-05 16:32:42] generate_model in utils:
model_code_list=['narm']
INFO    [05-05 16:32:42] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-05 16:32:42] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-05 16:32:45] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.75_05-05_16:32_t6/student_narm_logs does not exist! Create one.
WARNING [05-05 16:32:45] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.75_05-05_16:32_t6/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-05 16:32:45] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.75_05-05_16:32_t6/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-05 16:32:45] get_path in utils:
Path is None
WARNING [05-05 16:32:45] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 16:32:45] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(20034, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-05 16:32:45] assert_model_device in utils:
model student_narm has 5.3603515625 MB params.
INFO    [05-05 16:32:45] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 16:32:45] __init__ in DistillTrainer:
229376 iter per epoch
INFO    [05-05 16:32:45] _set_current_routine in Routine:
first routine: student
INFO    [05-05 16:32:45] run_routine in Routine:
Start routine student
INFO    [05-05 16:32:45] run_routine in Routine:
Start training
INFO    [05-05 16:32:45] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-05 16:33:05] test_mentor in DistillTrainer:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 16:33:05] train in DistillTrainer:
result:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 16:33:23] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 16:33:24] validate in BasicTrainer:
{'Recall@10': 0.00044389204545454544, 'NDCG@10': 0.0002111054676457901, 'MRR@10': 0.0001419221515044972, 'Recall@5': 0.0003107244318181818, 'NDCG@5': 0.0001693654326531528, 'MRR@5': 0.00012539950462682597, 'Recall*@10': 0.00044389204545454544, 'NDCG*@10': 0.0002111054676457901, 'MRR*@10': 0.0001419221515044972, 'Recall*@5': 0.0003107244318181818, 'NDCG*@5': 0.0001693654326531528, 'MRR*@5': 0.00012539950462682597}
INFO    [05-05 16:33:24] train in BasicTrainer:
epoch: 0
DEBUG   [05-05 16:33:25] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 9282877
DEBUG   [05-05 16:33:25] calculate_loss in loss:
pred max in softmax: 5.0027036195388064e-05, argmax 67393260
INFO    [05-05 16:33:37] _train_one_epoch in BasicTrainer:
loss = 5.670108607837132
INFO    [05-05 16:33:55] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 16:33:55] validate in BasicTrainer:
{'Recall@10': 0.008289895697750828, 'NDCG@10': 0.004386203998530453, 'MRR@10': 0.003222546815364198, 'Recall@5': 0.004792711485854604, 'NDCG@5': 0.0032613649117675695, 'MRR@5': 0.002761831972748041, 'Recall*@10': 0.008289895697750828, 'NDCG*@10': 0.004386203998530453, 'MRR*@10': 0.003222546815364198, 'Recall*@5': 0.004792711485854604, 'NDCG*@5': 0.0032613649117675695, 'MRR*@5': 0.002761831972748041}
INFO    [05-05 16:33:55] train in BasicTrainer:
duration: 31.640786170959473s
INFO    [05-05 16:33:55] train in BasicTrainer:
epoch: 1
INFO    [05-05 16:34:08] _train_one_epoch in BasicTrainer:
loss = 5.447530763489859
INFO    [05-05 16:34:27] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-05 16:34:27] validate in BasicTrainer:
{'Recall@10': 0.016442232511260292, 'NDCG@10': 0.00824269847097722, 'MRR@10': 0.005797029769217426, 'Recall@5': 0.009463683278723196, 'NDCG@5': 0.006011766550893133, 'MRR@5': 0.004891064356673847, 'Recall*@10': 0.016442232511260292, 'NDCG*@10': 0.00824269847097722, 'MRR*@10': 0.005797029769217426, 'Recall*@5': 0.009463683278723196, 'NDCG*@5': 0.006011766550893133, 'MRR*@5': 0.004891064356673847}
INFO    [05-05 16:34:27] train in BasicTrainer:
duration: 32.130834102630615s
INFO    [05-05 16:34:27] train in BasicTrainer:
epoch: 2
INFO    [05-05 16:34:40] _train_one_epoch in BasicTrainer:
loss = 5.221542077405112
INFO    [05-05 16:34:59] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-05 16:34:59] validate in BasicTrainer:
{'Recall@10': 0.024084754626859318, 'NDCG@10': 0.012055669657208702, 'MRR@10': 0.008463495537977327, 'Recall@5': 0.013887988149442455, 'NDCG@5': 0.008804620539938862, 'MRR@5': 0.0071486016227440404, 'Recall*@10': 0.024084754626859318, 'NDCG*@10': 0.012055669657208702, 'MRR*@10': 0.008463495537977327, 'Recall*@5': 0.013887988149442455, 'NDCG*@5': 0.008804620539938862, 'MRR*@5': 0.0071486016227440404}
INFO    [05-05 16:34:59] train in BasicTrainer:
duration: 31.98132562637329s
INFO    [05-05 16:34:59] train in BasicTrainer:
epoch: 3
INFO    [05-05 16:35:12] _train_one_epoch in BasicTrainer:
loss = 5.0983424953051975
INFO    [05-05 16:35:31] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-05 16:35:32] validate in BasicTrainer:
{'Recall@10': 0.030155851421031086, 'NDCG@10': 0.014930255203084513, 'MRR@10': 0.010394786061211065, 'Recall@5': 0.01681701441041448, 'NDCG@5': 0.010660581036724827, 'MRR@5': 0.008658445355567064, 'Recall*@10': 0.030155851421031086, 'NDCG*@10': 0.014930255203084513, 'MRR*@10': 0.010394786061211065, 'Recall*@5': 0.01681701441041448, 'NDCG*@5': 0.010660581036724827, 'MRR*@5': 0.008658445355567064}
INFO    [05-05 16:35:32] train in BasicTrainer:
duration: 32.20479893684387s
INFO    [05-05 16:35:32] train in BasicTrainer:
epoch: 4
INFO    [05-05 16:35:44] _train_one_epoch in BasicTrainer:
loss = 5.022992670536041
INFO    [05-05 16:36:02] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-05 16:36:03] validate in BasicTrainer:
{'Recall@10': 0.034349308772520584, 'NDCG@10': 0.017139240930026226, 'MRR@10': 0.011994140392000025, 'Recall@5': 0.01953233490613374, 'NDCG@5': 0.012377770532938566, 'MRR@5': 0.01004697848111391, 'Recall*@10': 0.034349308772520584, 'NDCG*@10': 0.017139240930026226, 'MRR*@10': 0.011994140392000025, 'Recall*@5': 0.01953233490613374, 'NDCG*@5': 0.012377770532938566, 'MRR*@5': 0.01004697848111391}
INFO    [05-05 16:36:03] train in BasicTrainer:
duration: 31.05880618095398s
INFO    [05-05 16:36:03] train in BasicTrainer:
epoch: 5
INFO    [05-05 16:36:17] _train_one_epoch in BasicTrainer:
loss = 4.949321993759701
INFO    [05-05 16:36:36] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-05 16:36:36] validate in BasicTrainer:
{'Recall@10': 0.03876152431423014, 'NDCG@10': 0.019579101523215122, 'MRR@10': 0.013853119940242985, 'Recall@5': 0.022453120824965565, 'NDCG@5': 0.014364956539462913, 'MRR@5': 0.011736067943274975, 'Recall*@10': 0.03876152431423014, 'NDCG*@10': 0.019579101523215122, 'MRR*@10': 0.013853119940242985, 'Recall*@5': 0.022453120824965565, 'NDCG*@5': 0.014364956539462913, 'MRR*@5': 0.011736067943274975}
INFO    [05-05 16:36:36] train in BasicTrainer:
duration: 33.63484501838684s
INFO    [05-05 16:36:36] train in BasicTrainer:
epoch: 6
INFO    [05-05 16:36:49] _train_one_epoch in BasicTrainer:
loss = 4.894981452396938
INFO    [05-05 16:37:07] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-05 16:37:07] validate in BasicTrainer:
{'Recall@10': 0.04153398458253254, 'NDCG@10': 0.02109117027033459, 'MRR@10': 0.014960780485787174, 'Recall@5': 0.024431627921082756, 'NDCG@5': 0.015587819062850693, 'MRR@5': 0.012705476023256779, 'Recall*@10': 0.04153398458253254, 'NDCG*@10': 0.02109117027033459, 'MRR*@10': 0.014960780485787174, 'Recall*@5': 0.024431627921082756, 'NDCG*@5': 0.015587819062850693, 'MRR*@5': 0.012705476023256779}
INFO    [05-05 16:37:07] train in BasicTrainer:
duration: 31.101640939712524s
INFO    [05-05 16:37:07] train in BasicTrainer:
epoch: 7
INFO    [05-05 16:37:20] _train_one_epoch in BasicTrainer:
loss = 4.848038026264736
INFO    [05-05 16:37:39] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-05 16:37:39] validate in BasicTrainer:
{'Recall@10': 0.04468748312104832, 'NDCG@10': 0.022788051854480396, 'MRR@10': 0.016201868399300358, 'Recall@5': 0.02711903981187127, 'NDCG@5': 0.017158637500622055, 'MRR@5': 0.01390894011340358, 'Recall*@10': 0.04468748312104832, 'NDCG*@10': 0.022788051854480396, 'MRR*@10': 0.016201868399300358, 'Recall*@5': 0.02711903981187127, 'NDCG*@5': 0.017158637500622055, 'MRR*@5': 0.01390894011340358}
INFO    [05-05 16:37:39] train in BasicTrainer:
duration: 31.864951133728027s
INFO    [05-05 16:37:39] train in BasicTrainer:
epoch: 8
INFO    [05-05 16:37:52] _train_one_epoch in BasicTrainer:
loss = 4.804114469460079
INFO    [05-05 16:38:10] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-05 16:38:11] validate in BasicTrainer:
{'Recall@10': 0.047340068627487526, 'NDCG@10': 0.024066971445625477, 'MRR@10': 0.017083031210032375, 'Recall@5': 0.028394898907704788, 'NDCG@5': 0.018028513951735062, 'MRR@5': 0.014641611582853577, 'Recall*@10': 0.047340068627487526, 'NDCG*@10': 0.024066971445625477, 'MRR*@10': 0.017083031210032375, 'Recall*@5': 0.028394898907704788, 'NDCG*@5': 0.018028513951735062, 'MRR*@5': 0.014641611582853577}
INFO    [05-05 16:38:11] train in BasicTrainer:
duration: 31.405027151107788s
INFO    [05-05 16:38:11] train in BasicTrainer:
epoch: 9
INFO    [05-05 16:38:23] _train_one_epoch in BasicTrainer:
loss = 4.766672645296369
INFO    [05-05 16:38:44] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-05 16:38:44] validate in BasicTrainer:
{'Recall@10': 0.0493140657517043, 'NDCG@10': 0.025034693493084473, 'MRR@10': 0.01776518283242529, 'Recall@5': 0.028796928003430367, 'NDCG@5': 0.018472766842354427, 'MRR@5': 0.015099278397180817, 'Recall*@10': 0.0493140657517043, 'NDCG*@10': 0.025034693493084473, 'MRR*@10': 0.01776518283242529, 'Recall*@5': 0.028796928003430367, 'NDCG*@5': 0.018472766842354427, 'MRR*@5': 0.015099278397180817}
INFO    [05-05 16:38:44] train in BasicTrainer:
duration: 33.329832315444946s
INFO    [05-05 16:38:44] train in BasicTrainer:
epoch: 10
INFO    [05-05 16:38:57] _train_one_epoch in BasicTrainer:
loss = 4.733449101448059
INFO    [05-05 16:39:16] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-05 16:39:16] validate in BasicTrainer:
{'Recall@10': 0.050372369926084175, 'NDCG@10': 0.02608223615044897, 'MRR@10': 0.018793697892264885, 'Recall@5': 0.030257922851226547, 'NDCG@5': 0.01963756555183367, 'MRR@5': 0.01616839539598335, 'Recall*@10': 0.050372369926084175, 'NDCG*@10': 0.02608223615044897, 'MRR*@10': 0.018793697892264885, 'Recall*@5': 0.030257922851226547, 'NDCG*@5': 0.01963756555183367, 'MRR*@5': 0.01616839539598335}
INFO    [05-05 16:39:16] train in BasicTrainer:
duration: 31.89441728591919s
INFO    [05-05 16:39:16] train in BasicTrainer:
epoch: 11
INFO    [05-05 16:39:28] _train_one_epoch in BasicTrainer:
loss = 4.702226758003235
INFO    [05-05 16:39:49] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-05 16:39:49] validate in BasicTrainer:
{'Recall@10': 0.05169580572030761, 'NDCG@10': 0.026941513981331478, 'MRR@10': 0.019516130739992314, 'Recall@5': 0.03147862597622655, 'NDCG@5': 0.020471571521325546, 'MRR@5': 0.01688524530353871, 'Recall*@10': 0.05169580572030761, 'NDCG*@10': 0.026941513981331478, 'MRR*@10': 0.019516130739992314, 'Recall*@5': 0.03147862597622655, 'NDCG*@5': 0.020471571521325546, 'MRR*@5': 0.01688524530353871}
INFO    [05-05 16:39:49] train in BasicTrainer:
duration: 33.32339262962341s
INFO    [05-05 16:39:49] train in BasicTrainer:
epoch: 12
INFO    [05-05 16:40:02] _train_one_epoch in BasicTrainer:
loss = 4.671763743673052
INFO    [05-05 16:40:21] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-05 16:40:21] validate in BasicTrainer:
{'Recall@10': 0.05370408669114113, 'NDCG@10': 0.02835421027107672, 'MRR@10': 0.020742952823638916, 'Recall@5': 0.03293204172091051, 'NDCG@5': 0.021692984822121533, 'MRR@5': 0.018026974390853535, 'Recall*@10': 0.05370408669114113, 'NDCG*@10': 0.02835421027107672, 'MRR*@10': 0.020742952823638916, 'Recall*@5': 0.03293204172091051, 'NDCG*@5': 0.021692984822121533, 'MRR*@5': 0.018026974390853535}
INFO    [05-05 16:40:21] train in BasicTrainer:
duration: 31.965771436691284s
INFO    [05-05 16:40:21] train in BasicTrainer:
epoch: 13
INFO    [05-05 16:40:34] _train_one_epoch in BasicTrainer:
loss = 4.639959326812199
INFO    [05-05 16:40:53] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-05 16:40:53] validate in BasicTrainer:
{'Recall@10': 0.05560392107475887, 'NDCG@10': 0.029423868452960796, 'MRR@10': 0.021558515388857235, 'Recall@5': 0.034285251051187515, 'NDCG@5': 0.022592818872495132, 'MRR@5': 0.018776833841746502, 'Recall*@10': 0.05560392107475887, 'NDCG*@10': 0.029423868452960796, 'MRR*@10': 0.021558515388857235, 'Recall*@5': 0.034285251051187515, 'NDCG*@5': 0.022592818872495132, 'MRR*@5': 0.018776833841746502}
INFO    [05-05 16:40:53] train in BasicTrainer:
duration: 32.37919521331787s
INFO    [05-05 16:40:53] train in BasicTrainer:
epoch: 14
INFO    [05-05 16:41:06] _train_one_epoch in BasicTrainer:
loss = 4.608055540493557
INFO    [05-05 16:41:25] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-05 16:41:25] validate in BasicTrainer:
{'Recall@10': 0.05715435540134257, 'NDCG@10': 0.030967530371113258, 'MRR@10': 0.0230776999484409, 'Recall@5': 0.035880074920979416, 'NDCG@5': 0.024146172980015927, 'MRR@5': 0.020296612923795528, 'Recall*@10': 0.05715435540134257, 'NDCG*@10': 0.030967530371113258, 'MRR*@10': 0.0230776999484409, 'Recall*@5': 0.035880074920979416, 'NDCG*@5': 0.024146172980015927, 'MRR*@5': 0.020296612923795528}
INFO    [05-05 16:41:25] train in BasicTrainer:
duration: 31.268923044204712s
INFO    [05-05 16:41:25] train in BasicTrainer:
epoch: 15
INFO    [05-05 16:41:37] _train_one_epoch in BasicTrainer:
loss = 4.578120027269636
INFO    [05-05 16:41:57] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-05 16:41:57] validate in BasicTrainer:
{'Recall@10': 0.05935348604213108, 'NDCG@10': 0.03193452649495818, 'MRR@10': 0.023686057803305714, 'Recall@5': 0.037422269244085656, 'NDCG@5': 0.02491440014405684, 'MRR@5': 0.02083061533895406, 'Recall*@10': 0.05935348604213108, 'NDCG*@10': 0.03193452649495818, 'MRR*@10': 0.023686057803305714, 'Recall*@5': 0.037422269244085656, 'NDCG*@5': 0.02491440014405684, 'MRR*@5': 0.02083061533895406}
INFO    [05-05 16:41:57] train in BasicTrainer:
duration: 32.01678776741028s
INFO    [05-05 16:41:57] train in BasicTrainer:
epoch: 16
INFO    [05-05 16:42:09] _train_one_epoch in BasicTrainer:
loss = 4.548859749521528
INFO    [05-05 16:42:28] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-05 16:42:28] validate in BasicTrainer:
{'Recall@10': 0.060770091685381805, 'NDCG@10': 0.03289970315315507, 'MRR@10': 0.02451375143771822, 'Recall@5': 0.03795999220826409, 'NDCG@5': 0.025575112720782108, 'MRR@5': 0.021520561623302372, 'Recall*@10': 0.060770091685381805, 'NDCG*@10': 0.03289970315315507, 'MRR*@10': 0.02451375143771822, 'Recall*@5': 0.03795999220826409, 'NDCG*@5': 0.025575112720782108, 'MRR*@5': 0.021520561623302372}
INFO    [05-05 16:42:28] train in BasicTrainer:
duration: 31.257992029190063s
INFO    [05-05 16:42:28] train in BasicTrainer:
epoch: 17
DEBUG   [05-05 16:42:39] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 1109005
DEBUG   [05-05 16:42:39] calculate_loss in loss:
pred max in softmax: 0.8800470232963562, argmax 42084504
DEBUG   [05-05 16:42:39] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 5496451
DEBUG   [05-05 16:42:39] calculate_loss in loss:
pred max in softmax: 0.5527382493019104, argmax 54813108
INFO    [05-05 16:42:41] _train_one_epoch in BasicTrainer:
loss = 4.51896151474544
INFO    [05-05 16:43:00] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-05 16:43:00] validate in BasicTrainer:
{'Recall@10': 0.062285699966278946, 'NDCG@10': 0.034076869149099694, 'MRR@10': 0.025551470843228428, 'Recall@5': 0.040573241358453575, 'NDCG@5': 0.027113637294281612, 'MRR@5': 0.022711833430962128, 'Recall*@10': 0.062285699966278946, 'NDCG*@10': 0.034076869149099694, 'MRR*@10': 0.025551470843228428, 'Recall*@5': 0.040573241358453575, 'NDCG*@5': 0.027113637294281612, 'MRR*@5': 0.022711833430962128}
INFO    [05-05 16:43:00] train in BasicTrainer:
duration: 32.039851665496826s
INFO    [05-05 16:43:00] train in BasicTrainer:
epoch: 18
INFO    [05-05 16:43:13] _train_one_epoch in BasicTrainer:
loss = 4.492253201348441
INFO    [05-05 16:43:31] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-05 16:43:31] validate in BasicTrainer:
{'Recall@10': 0.06393315304409374, 'NDCG@10': 0.0348060317337513, 'MRR@10': 0.0260294879024679, 'Recall@5': 0.04071464931423014, 'NDCG@5': 0.027357266369191082, 'MRR@5': 0.022990427233956078, 'Recall*@10': 0.06393315304409374, 'NDCG*@10': 0.0348060317337513, 'MRR*@10': 0.0260294879024679, 'Recall*@5': 0.04071464931423014, 'NDCG*@5': 0.027357266369191082, 'MRR*@5': 0.022990427233956078}
INFO    [05-05 16:43:31] train in BasicTrainer:
duration: 31.286789417266846s
INFO    [05-05 16:43:31] train in BasicTrainer:
epoch: 19
INFO    [05-05 16:43:44] _train_one_epoch in BasicTrainer:
loss = 4.465649783611298
INFO    [05-05 16:44:03] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-05 16:44:04] validate in BasicTrainer:
{'Recall@10': 0.0650669431144541, 'NDCG@10': 0.035835351794958115, 'MRR@10': 0.027030364186926323, 'Recall@5': 0.04149717431176792, 'NDCG@5': 0.02825824272903529, 'MRR@5': 0.02392912639135664, 'Recall*@10': 0.0650669431144541, 'NDCG*@10': 0.035835351794958115, 'MRR*@10': 0.027030364186926323, 'Recall*@5': 0.04149717431176792, 'NDCG*@5': 0.02825824272903529, 'MRR*@5': 0.02392912639135664}
INFO    [05-05 16:44:04] train in BasicTrainer:
duration: 32.212902545928955s
INFO    [05-05 16:44:04] train in BasicTrainer:
epoch: 20
INFO    [05-05 16:44:17] _train_one_epoch in BasicTrainer:
loss = 4.440351281847272
INFO    [05-05 16:44:36] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-05 16:44:36] validate in BasicTrainer:
{'Recall@10': 0.06702259453860196, 'NDCG@10': 0.03706509315154769, 'MRR@10': 0.028036664832722057, 'Recall@5': 0.04337228766896508, 'NDCG@5': 0.02949532646347176, 'MRR@5': 0.02495822547511621, 'Recall*@10': 0.06702259453860196, 'NDCG*@10': 0.03706509315154769, 'MRR*@10': 0.028036664832722057, 'Recall*@5': 0.04337228766896508, 'NDCG*@5': 0.02949532646347176, 'MRR*@5': 0.02495822547511621}
INFO    [05-05 16:44:36] train in BasicTrainer:
duration: 32.48614478111267s
INFO    [05-05 16:44:36] train in BasicTrainer:
epoch: 21
INFO    [05-05 16:44:49] _train_one_epoch in BasicTrainer:
loss = 4.416439950466156
INFO    [05-05 16:45:08] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-05 16:45:08] validate in BasicTrainer:
{'Recall@10': 0.06907526403665543, 'NDCG@10': 0.037987216968428, 'MRR@10': 0.028610489923845638, 'Recall@5': 0.04466210102493113, 'NDCG@5': 0.03018042157319459, 'MRR@5': 0.02543936991556124, 'Recall*@10': 0.06907526403665543, 'NDCG*@10': 0.037987216968428, 'MRR*@10': 0.028610489923845638, 'Recall*@5': 0.04466210102493113, 'NDCG*@5': 0.03018042157319459, 'MRR*@5': 0.02543936991556124}
INFO    [05-05 16:45:08] train in BasicTrainer:
duration: 32.39592742919922s
INFO    [05-05 16:45:08] train in BasicTrainer:
epoch: 22
INFO    [05-05 16:45:22] _train_one_epoch in BasicTrainer:
loss = 4.392252836908613
INFO    [05-05 16:45:40] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-05 16:45:41] validate in BasicTrainer:
{'Recall@10': 0.06904801726341248, 'NDCG@10': 0.03874452276663347, 'MRR@10': 0.029587854207916695, 'Recall@5': 0.04517005045305599, 'NDCG@5': 0.031060858714309605, 'MRR@5': 0.026438226584683765, 'Recall*@10': 0.06904801726341248, 'NDCG*@10': 0.03874452276663347, 'MRR*@10': 0.029587854207916695, 'Recall*@5': 0.04517005045305599, 'NDCG*@5': 0.031060858714309605, 'MRR*@5': 0.026438226584683765}
INFO    [05-05 16:45:41] train in BasicTrainer:
duration: 32.142635345458984s
INFO    [05-05 16:45:41] train in BasicTrainer:
epoch: 23
INFO    [05-05 16:45:53] _train_one_epoch in BasicTrainer:
loss = 4.370505358491625
INFO    [05-05 16:46:12] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-05 16:46:13] validate in BasicTrainer:
{'Recall@10': 0.07119770551269705, 'NDCG@10': 0.039996164766224945, 'MRR@10': 0.030578696422956207, 'Recall@5': 0.04650996693155982, 'NDCG@5': 0.032084147530523216, 'MRR@5': 0.027355556291612713, 'Recall*@10': 0.07119770551269705, 'NDCG*@10': 0.039996164766224945, 'MRR*@10': 0.030578696422956207, 'Recall*@5': 0.04650996693155982, 'NDCG*@5': 0.032084147530523216, 'MRR*@5': 0.027355556291612713}
INFO    [05-05 16:46:13] train in BasicTrainer:
duration: 32.06008529663086s
INFO    [05-05 16:46:13] train in BasicTrainer:
epoch: 24
INFO    [05-05 16:46:25] _train_one_epoch in BasicTrainer:
loss = 4.348714300564358
INFO    [05-05 16:46:44] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-05 16:46:44] validate in BasicTrainer:
{'Recall@10': 0.07068470391360196, 'NDCG@10': 0.04045277021147988, 'MRR@10': 0.03130818124521862, 'Recall@5': 0.04729820584708994, 'NDCG@5': 0.03293630429966883, 'MRR@5': 0.02823279459368099, 'Recall*@10': 0.07068470391360196, 'NDCG*@10': 0.04045277021147988, 'MRR*@10': 0.03130818124521862, 'Recall*@5': 0.04729820584708994, 'NDCG*@5': 0.03293630429966883, 'MRR*@5': 0.02823279459368099}
INFO    [05-05 16:46:44] train in BasicTrainer:
duration: 31.399978160858154s
INFO    [05-05 16:46:44] train in BasicTrainer:
epoch: 25
INFO    [05-05 16:46:58] _train_one_epoch in BasicTrainer:
loss = 4.330047965049744
INFO    [05-05 16:47:17] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-05 16:47:17] validate in BasicTrainer:
{'Recall@10': 0.07153886488892815, 'NDCG@10': 0.0407394522970373, 'MRR@10': 0.031428042629903015, 'Recall@5': 0.04788603227246891, 'NDCG@5': 0.03313968618485061, 'MRR@5': 0.028319835154847664, 'Recall*@10': 0.07153886488892815, 'NDCG*@10': 0.0407394522970373, 'MRR*@10': 0.031428042629903015, 'Recall*@5': 0.04788603227246891, 'NDCG*@5': 0.03313968618485061, 'MRR*@5': 0.028319835154847664}
INFO    [05-05 16:47:17] train in BasicTrainer:
duration: 33.02069544792175s
INFO    [05-05 16:47:17] train in BasicTrainer:
epoch: 26
INFO    [05-05 16:47:31] _train_one_epoch in BasicTrainer:
loss = 4.310006311961582
INFO    [05-05 16:47:49] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-05 16:47:49] validate in BasicTrainer:
{'Recall@10': 0.07321741431951523, 'NDCG@10': 0.0416606952520934, 'MRR@10': 0.03211664018983191, 'Recall@5': 0.04894499785520814, 'NDCG@5': 0.03386603261936794, 'MRR@5': 0.028931827369061382, 'Recall*@10': 0.07321741431951523, 'NDCG*@10': 0.0416606952520934, 'MRR*@10': 0.03211664018983191, 'Recall*@5': 0.04894499785520814, 'NDCG*@5': 0.03386603261936794, 'MRR*@5': 0.028931827369061382}
INFO    [05-05 16:47:49] train in BasicTrainer:
duration: 32.117072105407715s
INFO    [05-05 16:47:49] train in BasicTrainer:
epoch: 27
INFO    [05-05 16:48:04] _train_one_epoch in BasicTrainer:
loss = 4.2908768483570645
INFO    [05-05 16:48:23] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-05 16:48:23] validate in BasicTrainer:
{'Recall@10': 0.07417617399584163, 'NDCG@10': 0.042507210238413376, 'MRR@10': 0.03291821378198537, 'Recall@5': 0.050012203780087555, 'NDCG@5': 0.03473422879522497, 'MRR@5': 0.029734735800461334, 'Recall*@10': 0.07417617399584163, 'NDCG*@10': 0.042507210238413376, 'MRR*@10': 0.03291821378198537, 'Recall*@5': 0.050012203780087555, 'NDCG*@5': 0.03473422879522497, 'MRR*@5': 0.029734735800461334}
INFO    [05-05 16:48:23] train in BasicTrainer:
duration: 33.80469632148743s
INFO    [05-05 16:48:23] train in BasicTrainer:
epoch: 28
INFO    [05-05 16:48:36] _train_one_epoch in BasicTrainer:
loss = 4.273409928594317
INFO    [05-05 16:48:54] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-05 16:48:55] validate in BasicTrainer:
{'Recall@10': 0.07456809756430713, 'NDCG@10': 0.04271162098104304, 'MRR@10': 0.033067212186076424, 'Recall@5': 0.05008011006496169, 'NDCG@5': 0.03483285602520813, 'MRR@5': 0.029838539151982826, 'Recall*@10': 0.07456809756430713, 'NDCG*@10': 0.04271162098104304, 'MRR*@10': 0.033067212186076424, 'Recall*@5': 0.05008011006496169, 'NDCG*@5': 0.03483285602520813, 'MRR*@5': 0.029838539151982826}
INFO    [05-05 16:48:55] train in BasicTrainer:
duration: 31.671278953552246s
INFO    [05-05 16:48:55] train in BasicTrainer:
epoch: 29
INFO    [05-05 16:49:08] _train_one_epoch in BasicTrainer:
loss = 4.256968660014016
INFO    [05-05 16:49:27] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-05 16:49:27] validate in BasicTrainer:
{'Recall@10': 0.07584329559044405, 'NDCG@10': 0.04386610300703482, 'MRR@10': 0.03417580896480517, 'Recall@5': 0.05136926201256839, 'NDCG@5': 0.035966184328902855, 'MRR@5': 0.030923581597479908, 'Recall*@10': 0.07584329559044405, 'NDCG*@10': 0.04386610300703482, 'MRR*@10': 0.03417580896480517, 'Recall*@5': 0.05136926201256839, 'NDCG*@5': 0.035966184328902855, 'MRR*@5': 0.030923581597479908}
INFO    [05-05 16:49:27] train in BasicTrainer:
duration: 32.78871393203735s
INFO    [05-05 16:49:27] train in BasicTrainer:
epoch: 30
INFO    [05-05 16:49:40] _train_one_epoch in BasicTrainer:
loss = 4.238866865634918
INFO    [05-05 16:49:59] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [05-05 16:49:59] validate in BasicTrainer:
{'Recall@10': 0.07599480856548656, 'NDCG@10': 0.04399590905417095, 'MRR@10': 0.0342990578236905, 'Recall@5': 0.05140793729912151, 'NDCG@5': 0.03611334718086503, 'MRR@5': 0.031085506081581116, 'Recall*@10': 0.07599480856548656, 'NDCG*@10': 0.04399590905417095, 'MRR*@10': 0.0342990578236905, 'Recall*@5': 0.05140793729912151, 'NDCG*@5': 0.03611334718086503, 'MRR*@5': 0.031085506081581116}
INFO    [05-05 16:49:59] train in BasicTrainer:
duration: 31.37891387939453s
INFO    [05-05 16:49:59] train in BasicTrainer:
epoch: 31
INFO    [05-05 16:50:12] _train_one_epoch in BasicTrainer:
loss = 4.223121055534908
INFO    [05-05 16:50:32] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-05 16:50:32] validate in BasicTrainer:
{'Recall@10': 0.07741911235180768, 'NDCG@10': 0.04481056569652124, 'MRR@10': 0.034936251626773315, 'Recall@5': 0.052034439011053604, 'NDCG@5': 0.03663362664255229, 'MRR@5': 0.03157994591376998, 'Recall*@10': 0.07741911235180768, 'NDCG*@10': 0.04481056569652124, 'MRR*@10': 0.034936251626773315, 'Recall*@5': 0.052034439011053604, 'NDCG*@5': 0.03663362664255229, 'MRR*@5': 0.03157994591376998}
INFO    [05-05 16:50:32] train in BasicTrainer:
duration: 32.96977162361145s
INFO    [05-05 16:50:32] train in BasicTrainer:
epoch: 32
INFO    [05-05 16:50:45] _train_one_epoch in BasicTrainer:
loss = 4.2100217427526205
INFO    [05-05 16:51:04] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-05 16:51:04] validate in BasicTrainer:
{'Recall@10': 0.0784508308226412, 'NDCG@10': 0.045475577427582306, 'MRR@10': 0.03547720509496602, 'Recall@5': 0.05369903418150815, 'NDCG@5': 0.03751758045770905, 'MRR@5': 0.03221989863298156, 'Recall*@10': 0.0784508308226412, 'NDCG*@10': 0.045475577427582306, 'MRR*@10': 0.03547720509496602, 'Recall*@5': 0.05369903418150815, 'NDCG*@5': 0.03751758045770905, 'MRR*@5': 0.03221989863298156}
INFO    [05-05 16:51:04] train in BasicTrainer:
duration: 32.591495990753174s
INFO    [05-05 16:51:04] train in BasicTrainer:
epoch: 33
INFO    [05-05 16:51:17] _train_one_epoch in BasicTrainer:
loss = 4.195313913481576
INFO    [05-05 16:51:35] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-05 16:51:36] validate in BasicTrainer:
{'Recall@10': 0.07934366708452051, 'NDCG@10': 0.04597882790998979, 'MRR@10': 0.03586888347159733, 'Recall@5': 0.05379857901822437, 'NDCG@5': 0.03779267350381071, 'MRR@5': 0.032533021474426445, 'Recall*@10': 0.07934366708452051, 'NDCG*@10': 0.04597882790998979, 'MRR*@10': 0.03586888347159733, 'Recall*@5': 0.05379857901822437, 'NDCG*@5': 0.03779267350381071, 'MRR*@5': 0.032533021474426445}
INFO    [05-05 16:51:36] train in BasicTrainer:
duration: 31.19655680656433s
INFO    [05-05 16:51:36] train in BasicTrainer:
epoch: 34
INFO    [05-05 16:51:48] _train_one_epoch in BasicTrainer:
loss = 4.1813251205853055
INFO    [05-05 16:52:08] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-05 16:52:08] validate in BasicTrainer:
{'Recall@10': 0.07948892428116365, 'NDCG@10': 0.046742963858626106, 'MRR@10': 0.03682702305642041, 'Recall@5': 0.054508806290951645, 'NDCG@5': 0.03871905465017666, 'MRR@5': 0.03354746831411665, 'Recall*@10': 0.07948892428116365, 'NDCG*@10': 0.046742963858626106, 'MRR*@10': 0.03682702305642041, 'Recall*@5': 0.054508806290951645, 'NDCG*@5': 0.03871905465017666, 'MRR*@5': 0.03354746831411665}
INFO    [05-05 16:52:08] train in BasicTrainer:
duration: 32.18892168998718s
INFO    [05-05 16:52:08] train in BasicTrainer:
epoch: 35
DEBUG   [05-05 16:52:17] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 5997301
DEBUG   [05-05 16:52:17] calculate_loss in loss:
pred max in softmax: 0.573183536529541, argmax 46870830
DEBUG   [05-05 16:52:17] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 27634021
DEBUG   [05-05 16:52:17] calculate_loss in loss:
pred max in softmax: 0.5083574056625366, argmax 71262561
INFO    [05-05 16:52:21] _train_one_epoch in BasicTrainer:
loss = 4.166765740939549
INFO    [05-05 16:52:39] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-05 16:52:39] validate in BasicTrainer:
{'Recall@10': 0.08116362447088415, 'NDCG@10': 0.04754578017375686, 'MRR@10': 0.03736568174578927, 'Recall@5': 0.05525770885023204, 'NDCG@5': 0.039217207580804825, 'MRR@5': 0.03395635820925236, 'Recall*@10': 0.08116362447088415, 'NDCG*@10': 0.04754578017375686, 'MRR*@10': 0.03736568174578927, 'Recall*@5': 0.05525770885023204, 'NDCG*@5': 0.039217207580804825, 'MRR*@5': 0.03395635820925236}
INFO    [05-05 16:52:39] train in BasicTrainer:
duration: 31.670873403549194s
INFO    [05-05 16:52:39] train in BasicTrainer:
epoch: 36
INFO    [05-05 16:52:52] _train_one_epoch in BasicTrainer:
loss = 4.15366666657584
INFO    [05-05 16:53:11] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-05 16:53:11] validate in BasicTrainer:
{'Recall@10': 0.08108242533423683, 'NDCG@10': 0.04789583791385998, 'MRR@10': 0.03782322630286217, 'Recall@5': 0.05658048357475887, 'NDCG@5': 0.04003356735814701, 'MRR@5': 0.034614126282659446, 'Recall*@10': 0.08108242533423683, 'NDCG*@10': 0.04789583791385998, 'MRR*@10': 0.03782322630286217, 'Recall*@5': 0.05658048357475887, 'NDCG*@5': 0.04003356735814701, 'MRR*@5': 0.034614126282659446}
INFO    [05-05 16:53:11] train in BasicTrainer:
duration: 31.9789936542511s
INFO    [05-05 16:53:11] train in BasicTrainer:
epoch: 37
INFO    [05-05 16:53:24] _train_one_epoch in BasicTrainer:
loss = 4.142609230109623
INFO    [05-05 16:53:43] validate in BasicTrainer:
{'Recall@10': 0.08089662817391483, 'NDCG@10': 0.047852984883568504, 'MRR@10': 0.0378169176930731, 'Recall@5': 0.05675232613628561, 'NDCG@5': 0.04013018818064169, 'MRR@5': 0.0346789358353073, 'Recall*@10': 0.08089662817391483, 'NDCG*@10': 0.047852984883568504, 'MRR*@10': 0.0378169176930731, 'Recall*@5': 0.05675232613628561, 'NDCG*@5': 0.04013018818064169, 'MRR*@5': 0.0346789358353073}
INFO    [05-05 16:53:43] train in BasicTrainer:
duration: 31.087217330932617s
INFO    [05-05 16:53:43] train in BasicTrainer:
epoch: 38
INFO    [05-05 16:53:56] _train_one_epoch in BasicTrainer:
loss = 4.128449823175158
INFO    [05-05 16:54:15] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-05 16:54:15] validate in BasicTrainer:
{'Recall@10': 0.0827147202058272, 'NDCG@10': 0.04858500442721627, 'MRR@10': 0.03824002905325456, 'Recall@5': 0.05673079294237224, 'NDCG@5': 0.04024384001439268, 'MRR@5': 0.03483375043354251, 'Recall*@10': 0.0827147202058272, 'NDCG*@10': 0.04858500442721627, 'MRR*@10': 0.03824002905325456, 'Recall*@5': 0.05673079294237224, 'NDCG*@5': 0.04024384001439268, 'MRR*@5': 0.03483375043354251}
INFO    [05-05 16:54:15] train in BasicTrainer:
duration: 32.58771729469299s
INFO    [05-05 16:54:15] train in BasicTrainer:
epoch: 39
INFO    [05-05 16:54:28] _train_one_epoch in BasicTrainer:
loss = 4.117189364773886
INFO    [05-05 16:54:46] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [05-05 16:54:46] validate in BasicTrainer:
{'Recall@10': 0.08337923613461581, 'NDCG@10': 0.049257357689467346, 'MRR@10': 0.03889231857928363, 'Recall@5': 0.05755133181810379, 'NDCG@5': 0.040949073704806244, 'MRR@5': 0.035489400679414924, 'Recall*@10': 0.08337923613461581, 'NDCG*@10': 0.049257357689467346, 'MRR*@10': 0.03889231857928363, 'Recall*@5': 0.05755133181810379, 'NDCG*@5': 0.040949073704806244, 'MRR*@5': 0.035489400679414924}
INFO    [05-05 16:54:46] train in BasicTrainer:
duration: 31.34117555618286s
INFO    [05-05 16:54:46] train in BasicTrainer:
epoch: 40
INFO    [05-05 16:54:59] _train_one_epoch in BasicTrainer:
loss = 4.104489735194615
INFO    [05-05 16:55:18] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [05-05 16:55:19] validate in BasicTrainer:
{'Recall@10': 0.08394552902741866, 'NDCG@10': 0.04959433085539124, 'MRR@10': 0.03916073217988014, 'Recall@5': 0.05813091790134257, 'NDCG@5': 0.041294607587836006, 'MRR@5': 0.035763220861554146, 'Recall*@10': 0.08394552902741866, 'NDCG*@10': 0.04959433085539124, 'MRR*@10': 0.03916073217988014, 'Recall*@5': 0.05813091790134257, 'NDCG*@5': 0.041294607587836006, 'MRR*@5': 0.035763220861554146}
INFO    [05-05 16:55:19] train in BasicTrainer:
duration: 32.13486838340759s
INFO    [05-05 16:55:19] train in BasicTrainer:
epoch: 41
INFO    [05-05 16:55:31] _train_one_epoch in BasicTrainer:
loss = 4.095463386603764
INFO    [05-05 16:55:50] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-05 16:55:50] validate in BasicTrainer:
{'Recall@10': 0.08487956699999896, 'NDCG@10': 0.04998660731044682, 'MRR@10': 0.03939472037282857, 'Recall@5': 0.05875741961327466, 'NDCG@5': 0.041606651449745354, 'MRR@5': 0.03597550229592757, 'Recall*@10': 0.08487956699999896, 'NDCG*@10': 0.04998660731044682, 'MRR*@10': 0.03939472037282857, 'Recall*@5': 0.05875741961327466, 'NDCG*@5': 0.041606651449745354, 'MRR*@5': 0.03597550229592757}
INFO    [05-05 16:55:50] train in BasicTrainer:
duration: 31.30488681793213s
INFO    [05-05 16:55:50] train in BasicTrainer:
epoch: 42
INFO    [05-05 16:56:02] _train_one_epoch in BasicTrainer:
loss = 4.084084544863019
INFO    [05-05 16:56:21] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-05 16:56:22] validate in BasicTrainer:
{'Recall@10': 0.08477683433077553, 'NDCG@10': 0.050193290480158546, 'MRR@10': 0.039693940092216835, 'Recall@5': 0.05873522501100193, 'NDCG@5': 0.04180677031928843, 'MRR@5': 0.036253460428931496, 'Recall*@10': 0.08477683433077553, 'NDCG*@10': 0.050193290480158546, 'MRR*@10': 0.039693940092216835, 'Recall*@5': 0.05873522501100193, 'NDCG*@5': 0.04180677031928843, 'MRR*@5': 0.036253460428931496}
INFO    [05-05 16:56:22] train in BasicTrainer:
duration: 31.649528741836548s
INFO    [05-05 16:56:22] train in BasicTrainer:
epoch: 43
INFO    [05-05 16:56:35] _train_one_epoch in BasicTrainer:
loss = 4.072699648993356
INFO    [05-05 16:56:54] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [05-05 16:56:54] validate in BasicTrainer:
{'Recall@10': 0.08505778556520288, 'NDCG@10': 0.05072749812494625, 'MRR@10': 0.0403083163228902, 'Recall@5': 0.059512036090547386, 'NDCG@5': 0.042530744590542534, 'MRR@5': 0.03696267645467411, 'Recall*@10': 0.08505778556520288, 'NDCG*@10': 0.05072749812494625, 'MRR*@10': 0.0403083163228902, 'Recall*@5': 0.059512036090547386, 'NDCG*@5': 0.042530744590542534, 'MRR*@5': 0.03696267645467411}
INFO    [05-05 16:56:54] train in BasicTrainer:
duration: 32.41993761062622s
INFO    [05-05 16:56:54] train in BasicTrainer:
epoch: 44
INFO    [05-05 16:57:07] _train_one_epoch in BasicTrainer:
loss = 4.062171105827604
INFO    [05-05 16:57:26] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-05 16:57:26] validate in BasicTrainer:
{'Recall@10': 0.0860888422890143, 'NDCG@10': 0.05140866576270624, 'MRR@10': 0.04084956747564403, 'Recall@5': 0.060824043710123406, 'NDCG@5': 0.04329430582848462, 'MRR@5': 0.0375329391522841, 'Recall*@10': 0.0860888422890143, 'NDCG*@10': 0.05140866576270624, 'MRR*@10': 0.04084956747564403, 'Recall*@5': 0.060824043710123406, 'NDCG*@5': 0.04329430582848462, 'MRR*@5': 0.0375329391522841}
INFO    [05-05 16:57:26] train in BasicTrainer:
duration: 32.294121742248535s
INFO    [05-05 16:57:26] train in BasicTrainer:
epoch: 45
INFO    [05-05 16:57:39] _train_one_epoch in BasicTrainer:
loss = 4.050754078796932
INFO    [05-05 16:57:57] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-05 16:57:58] validate in BasicTrainer:
{'Recall@10': 0.08678006245331331, 'NDCG@10': 0.051971059292554855, 'MRR@10': 0.04139195280996236, 'Recall@5': 0.0609787448563359, 'NDCG@5': 0.043690612708980385, 'MRR@5': 0.03801159018819982, 'Recall*@10': 0.08678006245331331, 'NDCG*@10': 0.051971059292554855, 'MRR*@10': 0.04139195280996236, 'Recall*@5': 0.0609787448563359, 'NDCG*@5': 0.043690612708980385, 'MRR*@5': 0.03801159018819982}
INFO    [05-05 16:57:58] train in BasicTrainer:
duration: 31.367839336395264s
INFO    [05-05 16:57:58] train in BasicTrainer:
epoch: 46
INFO    [05-05 16:58:10] _train_one_epoch in BasicTrainer:
loss = 4.042539434773581
INFO    [05-05 16:58:29] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-05 16:58:29] validate in BasicTrainer:
{'Recall@10': 0.08748710223219612, 'NDCG@10': 0.052130020816217766, 'MRR@10': 0.04137790948152542, 'Recall@5': 0.06142516298727556, 'NDCG@5': 0.04371862045743249, 'MRR@5': 0.03791613368825479, 'Recall*@10': 0.08748710223219612, 'NDCG*@10': 0.052130020816217766, 'MRR*@10': 0.04137790948152542, 'Recall*@5': 0.06142516298727556, 'NDCG*@5': 0.04371862045743249, 'MRR*@5': 0.03791613368825479}
INFO    [05-05 16:58:29] train in BasicTrainer:
duration: 31.82574987411499s
INFO    [05-05 16:58:29] train in BasicTrainer:
epoch: 47
INFO    [05-05 16:58:42] _train_one_epoch in BasicTrainer:
loss = 4.0312877382550925
INFO    [05-05 16:59:01] log in loggers:
Update Best NDCG@10 Model at 47
INFO    [05-05 16:59:01] validate in BasicTrainer:
{'Recall@10': 0.08866594257679852, 'NDCG@10': 0.052780827338045296, 'MRR@10': 0.041897010396827354, 'Recall@5': 0.06149427321824161, 'NDCG@5': 0.04403287375515157, 'MRR@5': 0.03830940140919252, 'Recall*@10': 0.08866594257679852, 'NDCG*@10': 0.052780827338045296, 'MRR*@10': 0.041897010396827354, 'Recall*@5': 0.06149427321824161, 'NDCG*@5': 0.04403287375515157, 'MRR*@5': 0.03830940140919252}
INFO    [05-05 16:59:01] train in BasicTrainer:
duration: 31.634927988052368s
INFO    [05-05 16:59:01] train in BasicTrainer:
epoch: 48
INFO    [05-05 16:59:14] _train_one_epoch in BasicTrainer:
loss = 4.023541561194828
INFO    [05-05 16:59:33] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-05 16:59:33] validate in BasicTrainer:
{'Recall@10': 0.08872747353532097, 'NDCG@10': 0.05332236499948935, 'MRR@10': 0.04255272617394274, 'Recall@5': 0.06220516189932823, 'NDCG@5': 0.04478255591609261, 'MRR@5': 0.03905012153766372, 'Recall*@10': 0.08872747353532097, 'NDCG*@10': 0.05332236499948935, 'MRR*@10': 0.04255272617394274, 'Recall*@5': 0.06220516189932823, 'NDCG*@5': 0.04478255591609261, 'MRR*@5': 0.03905012153766372}
INFO    [05-05 16:59:33] train in BasicTrainer:
duration: 32.33114790916443s
INFO    [05-05 16:59:33] train in BasicTrainer:
epoch: 49
INFO    [05-05 16:59:46] _train_one_epoch in BasicTrainer:
loss = 4.016484375510897
INFO    [05-05 17:00:05] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-05 17:00:05] validate in BasicTrainer:
{'Recall@10': 0.08941737156022679, 'NDCG@10': 0.05387395180084489, 'MRR@10': 0.04308160292831334, 'Recall@5': 0.06237634339115836, 'NDCG@5': 0.04515993967652321, 'MRR@5': 0.039502653208645905, 'Recall*@10': 0.08941737156022679, 'NDCG*@10': 0.05387395180084489, 'MRR*@10': 0.04308160292831334, 'Recall*@5': 0.06237634339115836, 'NDCG*@5': 0.04515993967652321, 'MRR*@5': 0.039502653208645905}
INFO    [05-05 17:00:05] train in BasicTrainer:
duration: 31.545857429504395s
INFO    [05-05 17:00:05] train in BasicTrainer:
epoch: 50
INFO    [05-05 17:00:19] _train_one_epoch in BasicTrainer:
loss = 4.007136800459453
INFO    [05-05 17:00:38] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-05 17:00:38] validate in BasicTrainer:
{'Recall@10': 0.08979786729270761, 'NDCG@10': 0.053922848267988724, 'MRR@10': 0.043019267645749176, 'Recall@5': 0.06304536895318465, 'NDCG@5': 0.045303650200366974, 'MRR@5': 0.0394803062081337, 'Recall*@10': 0.08979786729270761, 'NDCG*@10': 0.053922848267988724, 'MRR*@10': 0.043019267645749176, 'Recall*@5': 0.06304536895318465, 'NDCG*@5': 0.045303650200366974, 'MRR*@5': 0.0394803062081337}
INFO    [05-05 17:00:38] train in BasicTrainer:
duration: 33.472758293151855s
INFO    [05-05 17:00:38] train in BasicTrainer:
epoch: 51
INFO    [05-05 17:00:51] _train_one_epoch in BasicTrainer:
loss = 3.996922948530742
INFO    [05-05 17:01:10] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [05-05 17:01:10] validate in BasicTrainer:
{'Recall@10': 0.08932606672698801, 'NDCG@10': 0.05422838303175839, 'MRR@10': 0.043533258478749885, 'Recall@5': 0.06414367123083635, 'NDCG@5': 0.04611688107252121, 'MRR@5': 0.04020446166396141, 'Recall*@10': 0.08932606672698801, 'NDCG*@10': 0.05422838303175839, 'MRR*@10': 0.043533258478749885, 'Recall*@5': 0.06414367123083635, 'NDCG*@5': 0.04611688107252121, 'MRR*@5': 0.04020446166396141}
INFO    [05-05 17:01:10] train in BasicTrainer:
duration: 31.523634433746338s
INFO    [05-05 17:01:10] train in BasicTrainer:
epoch: 52
INFO    [05-05 17:01:23] _train_one_epoch in BasicTrainer:
loss = 3.9901296326092313
INFO    [05-05 17:01:42] log in loggers:
Update Best NDCG@10 Model at 52
INFO    [05-05 17:01:43] validate in BasicTrainer:
{'Recall@10': 0.09071542525833304, 'NDCG@10': 0.054347258738496086, 'MRR@10': 0.04330137067220428, 'Recall@5': 0.06342267719182101, 'NDCG@5': 0.04558111794970252, 'MRR@5': 0.039717857133258476, 'Recall*@10': 0.09071542525833304, 'NDCG*@10': 0.054347258738496086, 'MRR*@10': 0.04330137067220428, 'Recall*@5': 0.06342267719182101, 'NDCG*@5': 0.04558111794970252, 'MRR*@5': 0.039717857133258476}
INFO    [05-05 17:01:43] train in BasicTrainer:
duration: 32.64236783981323s
INFO    [05-05 17:01:43] train in BasicTrainer:
epoch: 53
DEBUG   [05-05 17:01:50] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 6798661
DEBUG   [05-05 17:01:50] calculate_loss in loss:
pred max in softmax: 0.4535786211490631, argmax 75959754
DEBUG   [05-05 17:01:50] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 2511385
DEBUG   [05-05 17:01:50] calculate_loss in loss:
pred max in softmax: 0.5168250799179077, argmax 79151297
INFO    [05-05 17:01:55] _train_one_epoch in BasicTrainer:
loss = 3.9829336745398387
INFO    [05-05 17:02:13] log in loggers:
Update Best NDCG@10 Model at 53
INFO    [05-05 17:02:14] validate in BasicTrainer:
{'Recall@10': 0.0902379107746211, 'NDCG@10': 0.05463246967304836, 'MRR@10': 0.04381115971641107, 'Recall@5': 0.06338971616192297, 'NDCG@5': 0.045998854731971565, 'MRR@5': 0.040276853198354896, 'Recall*@10': 0.0902379107746211, 'NDCG*@10': 0.05463246967304836, 'MRR*@10': 0.04381115971641107, 'Recall*@5': 0.06338971616192297, 'NDCG*@5': 0.045998854731971565, 'MRR*@5': 0.040276853198354896}
INFO    [05-05 17:02:14] train in BasicTrainer:
duration: 30.9770724773407s
INFO    [05-05 17:02:14] train in BasicTrainer:
epoch: 54
INFO    [05-05 17:02:27] _train_one_epoch in BasicTrainer:
loss = 3.9747478663921356
INFO    [05-05 17:02:47] log in loggers:
Update Best NDCG@10 Model at 54
INFO    [05-05 17:02:47] validate in BasicTrainer:
{'Recall@10': 0.0922880545258522, 'NDCG@10': 0.05566089803522283, 'MRR@10': 0.04454150254076177, 'Recall@5': 0.06518363004381006, 'NDCG@5': 0.046985623172738335, 'MRR@5': 0.04101361402056434, 'Recall*@10': 0.0922880545258522, 'NDCG*@10': 0.05566089803522283, 'MRR*@10': 0.04454150254076177, 'Recall*@5': 0.06518363004381006, 'NDCG*@5': 0.046985623172738335, 'MRR*@5': 0.04101361402056434}
INFO    [05-05 17:02:47] train in BasicTrainer:
duration: 33.40370512008667s
INFO    [05-05 17:02:47] train in BasicTrainer:
epoch: 55
INFO    [05-05 17:03:00] _train_one_epoch in BasicTrainer:
loss = 3.9682028804506575
INFO    [05-05 17:03:18] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [05-05 17:03:18] validate in BasicTrainer:
{'Recall@10': 0.09219927611676129, 'NDCG@10': 0.05576145005497066, 'MRR@10': 0.044701721857894554, 'Recall@5': 0.06466557491909374, 'NDCG@5': 0.046902449293570084, 'MRR@5': 0.04107197780500759, 'Recall*@10': 0.09219927611676129, 'NDCG*@10': 0.05576145005497066, 'MRR*@10': 0.044701721857894554, 'Recall*@5': 0.06466557491909374, 'NDCG*@5': 0.046902449293570084, 'MRR*@5': 0.04107197780500759}
INFO    [05-05 17:03:18] train in BasicTrainer:
duration: 31.242406368255615s
INFO    [05-05 17:03:18] train in BasicTrainer:
epoch: 56
INFO    [05-05 17:03:33] _train_one_epoch in BasicTrainer:
loss = 3.9583113278661455
INFO    [05-05 17:03:52] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-05 17:03:52] validate in BasicTrainer:
{'Recall@10': 0.09245989674871619, 'NDCG@10': 0.056207804517312485, 'MRR@10': 0.04517256671732122, 'Recall@5': 0.06603845276615837, 'NDCG@5': 0.04769481312144886, 'MRR@5': 0.04167721623724157, 'Recall*@10': 0.09245989674871619, 'NDCG*@10': 0.056207804517312485, 'MRR*@10': 0.04517256671732122, 'Recall*@5': 0.06603845276615837, 'NDCG*@5': 0.04769481312144886, 'MRR*@5': 0.04167721623724157}
INFO    [05-05 17:03:52] train in BasicTrainer:
duration: 34.237427949905396s
INFO    [05-05 17:03:52] train in BasicTrainer:
epoch: 57
INFO    [05-05 17:04:05] _train_one_epoch in BasicTrainer:
loss = 3.952693862574441
INFO    [05-05 17:04:24] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-05 17:04:24] validate in BasicTrainer:
{'Recall@10': 0.09434896436604587, 'NDCG@10': 0.05681972984563221, 'MRR@10': 0.04541846059940078, 'Recall@5': 0.06673472577875311, 'NDCG@5': 0.04794835197654637, 'MRR@5': 0.04179180311885747, 'Recall*@10': 0.09434896436604587, 'NDCG*@10': 0.05681972984563221, 'MRR*@10': 0.04541846059940078, 'Recall*@5': 0.06673472577875311, 'NDCG*@5': 0.04794835197654637, 'MRR*@5': 0.04179180311885747}
INFO    [05-05 17:04:24] train in BasicTrainer:
duration: 31.41964817047119s
INFO    [05-05 17:04:24] train in BasicTrainer:
epoch: 58
INFO    [05-05 17:04:38] _train_one_epoch in BasicTrainer:
loss = 3.947286090680531
INFO    [05-05 17:04:57] log in loggers:
Update Best NDCG@10 Model at 58
INFO    [05-05 17:04:57] validate in BasicTrainer:
{'Recall@10': 0.09419041465629231, 'NDCG@10': 0.05702307278459722, 'MRR@10': 0.04572287811474367, 'Recall@5': 0.06652673401615837, 'NDCG@5': 0.048104163597930565, 'MRR@5': 0.042057341134006325, 'Recall*@10': 0.09419041465629231, 'NDCG*@10': 0.05702307278459722, 'MRR*@10': 0.04572287811474367, 'Recall*@5': 0.06652673401615837, 'NDCG*@5': 0.048104163597930565, 'MRR*@5': 0.042057341134006325}
INFO    [05-05 17:04:57] train in BasicTrainer:
duration: 33.45024847984314s
INFO    [05-05 17:04:57] train in BasicTrainer:
epoch: 59
INFO    [05-05 17:05:11] _train_one_epoch in BasicTrainer:
loss = 3.9395461678504944
INFO    [05-05 17:05:30] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [05-05 17:05:30] validate in BasicTrainer:
{'Recall@10': 0.09475352005525069, 'NDCG@10': 0.057129998776045715, 'MRR@10': 0.04571230946616693, 'Recall@5': 0.06596044112335551, 'NDCG@5': 0.04786013473163952, 'MRR@5': 0.04191073673692616, 'Recall*@10': 0.09475352005525069, 'NDCG*@10': 0.057129998776045715, 'MRR*@10': 0.04571230946616693, 'Recall*@5': 0.06596044112335551, 'NDCG*@5': 0.04786013473163952, 'MRR*@5': 0.04191073673692616}
INFO    [05-05 17:05:30] train in BasicTrainer:
duration: 32.63784193992615s
INFO    [05-05 17:05:30] close_training in BasicTrainer:
finished training
DEBUG   [05-05 17:05:30] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3361 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-05 17:05:30] run_routine in Routine:
Finished training, Start final validation
INFO    [05-05 17:05:30] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-05 17:05:30] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 17:05:30] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 17:05:49] validate in BasicTrainer:
{'Recall@10': 0.09475352005525069, 'NDCG@10': 0.057129998776045715, 'MRR@10': 0.04571230946616693, 'Recall@5': 0.06596044112335551, 'NDCG@5': 0.04786013473163952, 'MRR@5': 0.04191073673692616, 'Recall*@10': 0.09475352005525069, 'NDCG*@10': 0.057129998776045715, 'MRR*@10': 0.04571230946616693, 'Recall*@5': 0.06596044112335551, 'NDCG*@5': 0.04786013473163952, 'MRR*@5': 0.04191073673692616}
INFO    [05-05 17:05:49] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.09475352005525069, 'NDCG@10': 0.057129998776045715, 'MRR@10': 0.04571230946616693, 'Recall@5': 0.06596044112335551, 'NDCG@5': 0.04786013473163952, 'MRR@5': 0.04191073673692616, 'Recall*@10': 0.09475352005525069, 'NDCG*@10': 0.057129998776045715, 'MRR*@10': 0.04571230946616693, 'Recall*@5': 0.06596044112335551, 'NDCG*@5': 0.04786013473163952, 'MRR*@5': 0.04191073673692616}
INFO    [05-05 17:05:49] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-05 17:05:49] test in BasicTrainer:
Test model on test set!
INFO    [05-05 17:05:49] test_with_given_state_path in BasicTrainer:
Loading model params from ___yelp_soft_2022/pop_narm-T-3.0-al-0.75_05-05_16:32_t6/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-05 17:05:49] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 17:05:49] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 17:05:49] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-05 17:06:08] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.07895998385819522, 'NDCG@10': 0.046049160036173736, 'MRR@10': 0.03605271198532798, 'Recall@5': 0.05421071364121004, 'NDCG@5': 0.038068681278012016, 'MRR@5': 0.032772180031646385, 'Recall*@10': 0.07895998385819522, 'NDCG*@10': 0.046049160036173736, 'MRR*@10': 0.03605271198532798, 'Recall*@5': 0.05421071364121004, 'NDCG*@5': 0.038068681278012016, 'MRR*@5': 0.032772180031646385}
INFO    [05-05 17:06:08] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.07895998385819522, 'NDCG@10': 0.046049160036173736, 'MRR@10': 0.03605271198532798, 'Recall@5': 0.05421071364121004, 'NDCG@5': 0.038068681278012016, 'MRR@5': 0.032772180031646385, 'Recall*@10': 0.07895998385819522, 'NDCG*@10': 0.046049160036173736, 'MRR*@10': 0.03605271198532798, 'Recall*@5': 0.05421071364121004, 'NDCG*@5': 0.038068681278012016, 'MRR*@5': 0.032772180031646385}
