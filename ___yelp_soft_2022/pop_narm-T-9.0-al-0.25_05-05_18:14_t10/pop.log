INFO    [05-05 18:14:16] setup_train in utils:
{
    "experiment_dir": "___yelp_soft_2022",
    "experiment_description": "pop",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "yelp.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "alpha": 0.25,
    "T": 9.0,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.yelp/narm/config_distill.json",
    "task_id": 10,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "dvae_alpha": 0.5,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-05 18:14:16] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-05 18:14:16] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/yelp-5-5.pkl
INFO    [05-05 18:14:17] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-05 18:14:17] _check_dataset_cache in utils:
correct.
INFO    [05-05 18:14:17] __init__ in NextItemDataloader:
there are 20033 items in this dataset, 43947 users, padding_first? False
DEBUG   [05-05 18:14:24] generate_model in utils:
model_code_list=['pop']
INFO    [05-05 18:14:24] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-05 18:14:24] load_model_config in utils:
{}
WARNING [05-05 18:14:30] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.25_05-05_18:14_t10/teacher_pop_logs does not exist! Create one.
WARNING [05-05 18:14:30] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.25_05-05_18:14_t10/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-05 18:14:30] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.25_05-05_18:14_t10/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-05 18:14:30] get_path in utils:
Path is None
WARNING [05-05 18:14:30] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 18:14:30] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-05 18:14:30] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 18:14:30] __init__ in BasicTrainer:
229376 iter per epoch
DEBUG   [05-05 18:14:30] generate_model in utils:
model_code_list=['narm']
INFO    [05-05 18:14:30] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-05 18:14:30] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-05 18:14:33] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.25_05-05_18:14_t10/student_narm_logs does not exist! Create one.
WARNING [05-05 18:14:33] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.25_05-05_18:14_t10/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-05 18:14:33] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.25_05-05_18:14_t10/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-05 18:14:33] get_path in utils:
Path is None
WARNING [05-05 18:14:33] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 18:14:33] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(20034, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-05 18:14:33] assert_model_device in utils:
model student_narm has 5.3603515625 MB params.
INFO    [05-05 18:14:33] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 18:14:33] __init__ in DistillTrainer:
229376 iter per epoch
INFO    [05-05 18:14:33] _set_current_routine in Routine:
first routine: student
INFO    [05-05 18:14:33] run_routine in Routine:
Start routine student
INFO    [05-05 18:14:33] run_routine in Routine:
Start training
INFO    [05-05 18:14:33] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-05 18:14:54] test_mentor in DistillTrainer:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 18:14:54] train in DistillTrainer:
result:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 18:15:15] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 18:15:16] validate in BasicTrainer:
{'Recall@10': 0.00044389204545454544, 'NDCG@10': 0.0002111054676457901, 'MRR@10': 0.0001419221515044972, 'Recall@5': 0.0003107244318181818, 'NDCG@5': 0.0001693654326531528, 'MRR@5': 0.00012539950462682597, 'Recall*@10': 0.00044389204545454544, 'NDCG*@10': 0.0002111054676457901, 'MRR*@10': 0.0001419221515044972, 'Recall*@5': 0.0003107244318181818, 'NDCG*@5': 0.0001693654326531528, 'MRR*@5': 0.00012539950462682597}
INFO    [05-05 18:15:16] train in BasicTrainer:
epoch: 0
DEBUG   [05-05 18:15:17] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 9282877
DEBUG   [05-05 18:15:17] calculate_loss in loss:
pred max in softmax: 5.0027036195388064e-05, argmax 67393260
INFO    [05-05 18:15:29] _train_one_epoch in BasicTrainer:
loss = 8.481334669249398
INFO    [05-05 18:15:48] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 18:15:49] validate in BasicTrainer:
{'Recall@10': 0.008312090300023556, 'NDCG@10': 0.004360005026683211, 'MRR@10': 0.003185043323107741, 'Recall@5': 0.004532090218907053, 'NDCG@5': 0.0031386437635360794, 'MRR@5': 0.002681406140750782, 'Recall*@10': 0.008312090300023556, 'NDCG*@10': 0.004360005026683211, 'MRR*@10': 0.003185043323107741, 'Recall*@5': 0.004532090218907053, 'NDCG*@5': 0.0031386437635360794, 'MRR*@5': 0.002681406140750782}
INFO    [05-05 18:15:49] train in BasicTrainer:
duration: 33.30850052833557s
INFO    [05-05 18:15:49] train in BasicTrainer:
epoch: 1
INFO    [05-05 18:16:02] _train_one_epoch in BasicTrainer:
loss = 8.040650308132172
INFO    [05-05 18:16:22] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-05 18:16:24] validate in BasicTrainer:
{'Recall@10': 0.01654881408268755, 'NDCG@10': 0.008278763556683605, 'MRR@10': 0.005802964516492052, 'Recall@5': 0.009708485227416862, 'NDCG@5': 0.00609319115226919, 'MRR@5': 0.004916580161079764, 'Recall*@10': 0.01654881408268755, 'NDCG*@10': 0.008278763556683605, 'MRR*@10': 0.005802964516492052, 'Recall*@5': 0.009708485227416862, 'NDCG*@5': 0.00609319115226919, 'MRR*@5': 0.004916580161079764}
INFO    [05-05 18:16:24] train in BasicTrainer:
duration: 34.57628417015076s
INFO    [05-05 18:16:24] train in BasicTrainer:
epoch: 2
INFO    [05-05 18:16:36] _train_one_epoch in BasicTrainer:
loss = 7.57962829726083
INFO    [05-05 18:16:57] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-05 18:16:58] validate in BasicTrainer:
{'Recall@10': 0.023302229629321533, 'NDCG@10': 0.01162317374043844, 'MRR@10': 0.008137715345417912, 'Recall@5': 0.01355254277586937, 'NDCG@5': 0.00852095073258335, 'MRR@5': 0.006887442114847628, 'Recall*@10': 0.023302229629321533, 'NDCG*@10': 0.01162317374043844, 'MRR*@10': 0.008137715345417912, 'Recall*@5': 0.01355254277586937, 'NDCG*@5': 0.00852095073258335, 'MRR*@5': 0.006887442114847628}
INFO    [05-05 18:16:58] train in BasicTrainer:
duration: 34.19519782066345s
INFO    [05-05 18:16:58] train in BasicTrainer:
epoch: 3
INFO    [05-05 18:17:11] _train_one_epoch in BasicTrainer:
loss = 7.382549354008266
INFO    [05-05 18:17:31] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-05 18:17:32] validate in BasicTrainer:
{'Recall@10': 0.028996018184856934, 'NDCG@10': 0.014421496116979555, 'MRR@10': 0.0100614522499117, 'Recall@5': 0.01654496518048373, 'NDCG@5': 0.010452011092142626, 'MRR@5': 0.00845679911700162, 'Recall*@10': 0.028996018184856934, 'NDCG*@10': 0.014421496116979555, 'MRR*@10': 0.0100614522499117, 'Recall*@5': 0.01654496518048373, 'NDCG*@5': 0.010452011092142626, 'MRR*@5': 0.00845679911700162}
INFO    [05-05 18:17:32] train in BasicTrainer:
duration: 33.80177283287048s
INFO    [05-05 18:17:32] train in BasicTrainer:
epoch: 4
INFO    [05-05 18:17:44] _train_one_epoch in BasicTrainer:
loss = 7.259432562759945
INFO    [05-05 18:18:04] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-05 18:18:04] validate in BasicTrainer:
{'Recall@10': 0.03399100730364973, 'NDCG@10': 0.016975139945068142, 'MRR@10': 0.011879063804041256, 'Recall@5': 0.019753619520501656, 'NDCG@5': 0.012402491136030718, 'MRR@5': 0.010010458825325424, 'Recall*@10': 0.03399100730364973, 'NDCG*@10': 0.016975139945068142, 'MRR*@10': 0.011879063804041256, 'Recall*@5': 0.019753619520501656, 'NDCG*@5': 0.012402491136030718, 'MRR*@5': 0.010010458825325424}
INFO    [05-05 18:18:04] train in BasicTrainer:
duration: 32.86831307411194s
INFO    [05-05 18:18:04] train in BasicTrainer:
epoch: 5
INFO    [05-05 18:18:17] _train_one_epoch in BasicTrainer:
loss = 7.136161770139422
INFO    [05-05 18:18:37] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-05 18:18:38] validate in BasicTrainer:
{'Recall@10': 0.03870384225791151, 'NDCG@10': 0.019528251310641117, 'MRR@10': 0.013785196552899752, 'Recall@5': 0.02269220877100121, 'NDCG@5': 0.01440384408289736, 'MRR@5': 0.011701498688621954, 'Recall*@10': 0.03870384225791151, 'NDCG*@10': 0.019528251310641117, 'MRR*@10': 0.013785196552899752, 'Recall*@5': 0.02269220877100121, 'NDCG*@5': 0.01440384408289736, 'MRR*@5': 0.011701498688621954}
INFO    [05-05 18:18:38] train in BasicTrainer:
duration: 33.93138289451599s
INFO    [05-05 18:18:38] train in BasicTrainer:
epoch: 6
INFO    [05-05 18:18:51] _train_one_epoch in BasicTrainer:
loss = 7.037474087306431
INFO    [05-05 18:19:10] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-05 18:19:11] validate in BasicTrainer:
{'Recall@10': 0.04048446294936267, 'NDCG@10': 0.020757864652709526, 'MRR@10': 0.014852419749579647, 'Recall@5': 0.02395411343737082, 'NDCG@5': 0.01545940957624804, 'MRR@5': 0.012692570347677578, 'Recall*@10': 0.04048446294936267, 'NDCG*@10': 0.020757864652709526, 'MRR*@10': 0.014852419749579647, 'Recall*@5': 0.02395411343737082, 'NDCG*@5': 0.01545940957624804, 'MRR*@5': 0.012692570347677578}
INFO    [05-05 18:19:11] train in BasicTrainer:
duration: 32.40557527542114s
INFO    [05-05 18:19:11] train in BasicTrainer:
epoch: 7
INFO    [05-05 18:19:25] _train_one_epoch in BasicTrainer:
loss = 6.9531780396189005
INFO    [05-05 18:19:45] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-05 18:19:46] validate in BasicTrainer:
{'Recall@10': 0.04514214193279093, 'NDCG@10': 0.02265302295034582, 'MRR@10': 0.015907396223734726, 'Recall@5': 0.026516598056663166, 'NDCG@5': 0.016677361743694, 'MRR@5': 0.013468799350613897, 'Recall*@10': 0.04514214193279093, 'NDCG*@10': 0.02265302295034582, 'MRR*@10': 0.015907396223734726, 'Recall*@5': 0.026516598056663166, 'NDCG*@5': 0.016677361743694, 'MRR*@5': 0.013468799350613897}
INFO    [05-05 18:19:46] train in BasicTrainer:
duration: 35.27209496498108s
INFO    [05-05 18:19:46] train in BasicTrainer:
epoch: 8
INFO    [05-05 18:19:59] _train_one_epoch in BasicTrainer:
loss = 6.876066565513611
INFO    [05-05 18:20:18] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-05 18:20:20] validate in BasicTrainer:
{'Recall@10': 0.04639899392019619, 'NDCG@10': 0.024129842323335735, 'MRR@10': 0.017459782348437744, 'Recall@5': 0.027418336407704788, 'NDCG@5': 0.018051084808327934, 'MRR@5': 0.014985632913356478, 'Recall*@10': 0.04639899392019619, 'NDCG*@10': 0.024129842323335735, 'MRR*@10': 0.017459782348437744, 'Recall*@5': 0.027418336407704788, 'NDCG*@5': 0.018051084808327934, 'MRR*@5': 0.014985632913356478}
INFO    [05-05 18:20:20] train in BasicTrainer:
duration: 33.59147644042969s
INFO    [05-05 18:20:20] train in BasicTrainer:
epoch: 9
INFO    [05-05 18:20:32] _train_one_epoch in BasicTrainer:
loss = 6.806054038660867
INFO    [05-05 18:20:52] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-05 18:20:53] validate in BasicTrainer:
{'Recall@10': 0.04800963672724637, 'NDCG@10': 0.025292443788864395, 'MRR@10': 0.018485115671699696, 'Recall@5': 0.02902073904194615, 'NDCG@5': 0.019201307980851692, 'MRR@5': 0.0159999414939772, 'Recall*@10': 0.04800963672724637, 'NDCG*@10': 0.025292443788864395, 'MRR*@10': 0.018485115671699696, 'Recall*@5': 0.02902073904194615, 'NDCG*@5': 0.019201307980851692, 'MRR*@5': 0.0159999414939772}
INFO    [05-05 18:20:53] train in BasicTrainer:
duration: 33.328567028045654s
INFO    [05-05 18:20:53] train in BasicTrainer:
epoch: 10
INFO    [05-05 18:21:06] _train_one_epoch in BasicTrainer:
loss = 6.7398227878979275
INFO    [05-05 18:21:26] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-05 18:21:26] validate in BasicTrainer:
{'Recall@10': 0.0509881048717282, 'NDCG@10': 0.026995436711744827, 'MRR@10': 0.019763263619758865, 'Recall@5': 0.03200239484960383, 'NDCG@5': 0.02091902071102099, 'MRR@5': 0.017291940494694492, 'Recall*@10': 0.0509881048717282, 'NDCG*@10': 0.026995436711744827, 'MRR*@10': 0.019763263619758865, 'Recall*@5': 0.03200239484960383, 'NDCG*@5': 0.02091902071102099, 'MRR*@5': 0.017291940494694492}
INFO    [05-05 18:21:26] train in BasicTrainer:
duration: 33.09832286834717s
INFO    [05-05 18:21:26] train in BasicTrainer:
epoch: 11
INFO    [05-05 18:21:39] _train_one_epoch in BasicTrainer:
loss = 6.673128502709525
INFO    [05-05 18:21:58] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-05 18:21:58] validate in BasicTrainer:
{'Recall@10': 0.05445990677584301, 'NDCG@10': 0.029186630790883846, 'MRR@10': 0.021587773649529976, 'Recall@5': 0.03433721952817657, 'NDCG@5': 0.022770829837430607, 'MRR@5': 0.018992782655087383, 'Recall*@10': 0.05445990677584301, 'NDCG*@10': 0.029186630790883846, 'MRR*@10': 0.021587773649529976, 'Recall*@5': 0.03433721952817657, 'NDCG*@5': 0.022770829837430607, 'MRR*@5': 0.018992782655087383}
INFO    [05-05 18:21:58] train in BasicTrainer:
duration: 32.3501615524292s
INFO    [05-05 18:21:58] train in BasicTrainer:
epoch: 12
INFO    [05-05 18:22:11] _train_one_epoch in BasicTrainer:
loss = 6.609922392027719
INFO    [05-05 18:22:31] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-05 18:22:32] validate in BasicTrainer:
{'Recall@10': 0.05643841421062296, 'NDCG@10': 0.030875304883176632, 'MRR@10': 0.02317457002672282, 'Recall@5': 0.03603862463073297, 'NDCG@5': 0.02432698519392447, 'MRR@5': 0.020500023764642803, 'Recall*@10': 0.05643841421062296, 'NDCG*@10': 0.030875304883176632, 'MRR*@10': 0.02317457002672282, 'Recall*@5': 0.03603862463073297, 'NDCG*@5': 0.02432698519392447, 'MRR*@5': 0.020500023764642803}
INFO    [05-05 18:22:32] train in BasicTrainer:
duration: 33.433922290802s
INFO    [05-05 18:22:32] train in BasicTrainer:
epoch: 13
INFO    [05-05 18:22:45] _train_one_epoch in BasicTrainer:
loss = 6.546107692377908
INFO    [05-05 18:23:05] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-05 18:23:06] validate in BasicTrainer:
{'Recall@10': 0.0578924911943349, 'NDCG@10': 0.031546521254561165, 'MRR@10': 0.023608965799212456, 'Recall@5': 0.037219991399483246, 'NDCG@5': 0.024929901246320118, 'MRR@5': 0.020918743007562378, 'Recall*@10': 0.0578924911943349, 'NDCG*@10': 0.031546521254561165, 'MRR*@10': 0.023608965799212456, 'Recall*@5': 0.037219991399483246, 'NDCG*@5': 0.024929901246320118, 'MRR*@5': 0.020918743007562378}
INFO    [05-05 18:23:06] train in BasicTrainer:
duration: 34.045069217681885s
INFO    [05-05 18:23:06] train in BasicTrainer:
epoch: 14
INFO    [05-05 18:23:19] _train_one_epoch in BasicTrainer:
loss = 6.485150226524898
INFO    [05-05 18:23:38] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-05 18:23:39] validate in BasicTrainer:
{'Recall@10': 0.06198892979459329, 'NDCG@10': 0.033960338681936264, 'MRR@10': 0.02553722042251717, 'Recall@5': 0.038984131745316765, 'NDCG@5': 0.026572137393734672, 'MRR@5': 0.022518129003318874, 'Recall*@10': 0.06198892979459329, 'NDCG*@10': 0.033960338681936264, 'MRR*@10': 0.02553722042251717, 'Recall*@5': 0.038984131745316765, 'NDCG*@5': 0.026572137393734672, 'MRR*@5': 0.022518129003318874}
INFO    [05-05 18:23:39] train in BasicTrainer:
duration: 33.070953369140625s
INFO    [05-05 18:23:39] train in BasicTrainer:
epoch: 15
INFO    [05-05 18:23:51] _train_one_epoch in BasicTrainer:
loss = 6.424853026866913
INFO    [05-05 18:24:11] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-05 18:24:11] validate in BasicTrainer:
{'Recall@10': 0.06303207610141147, 'NDCG@10': 0.03522773188623515, 'MRR@10': 0.026849991895935753, 'Recall@5': 0.041026035154407677, 'NDCG@5': 0.02819121442735195, 'MRR@5': 0.0239926278591156, 'Recall*@10': 0.06303207610141147, 'NDCG*@10': 0.03522773188623515, 'MRR*@10': 0.026849991895935753, 'Recall*@5': 0.041026035154407677, 'NDCG*@5': 0.02819121442735195, 'MRR*@5': 0.0239926278591156}
INFO    [05-05 18:24:11] train in BasicTrainer:
duration: 31.868110179901123s
INFO    [05-05 18:24:11] train in BasicTrainer:
epoch: 16
INFO    [05-05 18:24:25] _train_one_epoch in BasicTrainer:
loss = 6.369174931730543
INFO    [05-05 18:24:43] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-05 18:24:44] validate in BasicTrainer:
{'Recall@10': 0.0667328607629646, 'NDCG@10': 0.03728874230926687, 'MRR@10': 0.02840621363032948, 'Recall@5': 0.044170631942423905, 'NDCG@5': 0.030059666626832703, 'MRR@5': 0.025461968034505844, 'Recall*@10': 0.0667328607629646, 'NDCG*@10': 0.03728874230926687, 'MRR*@10': 0.02840621363032948, 'Recall*@5': 0.044170631942423905, 'NDCG*@5': 0.030059666626832703, 'MRR*@5': 0.025461968034505844}
INFO    [05-05 18:24:44] train in BasicTrainer:
duration: 33.608675718307495s
INFO    [05-05 18:24:44] train in BasicTrainer:
epoch: 17
DEBUG   [05-05 18:24:56] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 1109005
DEBUG   [05-05 18:24:56] calculate_loss in loss:
pred max in softmax: 0.9881876111030579, argmax 76712937
DEBUG   [05-05 18:24:56] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 5496451
DEBUG   [05-05 18:24:56] calculate_loss in loss:
pred max in softmax: 0.563823401927948, argmax 75550933
INFO    [05-05 18:24:57] _train_one_epoch in BasicTrainer:
loss = 6.31300334419523
INFO    [05-05 18:25:19] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-05 18:25:20] validate in BasicTrainer:
{'Recall@10': 0.06767261299219998, 'NDCG@10': 0.03840562870556658, 'MRR@10': 0.0295634020797231, 'Recall@5': 0.04536156153137034, 'NDCG@5': 0.031245993619615383, 'MRR@5': 0.02664036490023136, 'Recall*@10': 0.06767261299219998, 'NDCG*@10': 0.03840562870556658, 'MRR*@10': 0.0295634020797231, 'Recall*@5': 0.04536156153137034, 'NDCG*@5': 0.031245993619615383, 'MRR*@5': 0.02664036490023136}
INFO    [05-05 18:25:20] train in BasicTrainer:
duration: 35.176602363586426s
INFO    [05-05 18:25:20] train in BasicTrainer:
epoch: 18
INFO    [05-05 18:25:32] _train_one_epoch in BasicTrainer:
loss = 6.262378394603729
INFO    [05-05 18:25:53] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-05 18:25:54] validate in BasicTrainer:
{'Recall@10': 0.06908801502802155, 'NDCG@10': 0.03951268202879212, 'MRR@10': 0.030586000023917717, 'Recall@5': 0.04593290727246891, 'NDCG@5': 0.032057008960030296, 'MRR@5': 0.027528272095051678, 'Recall*@10': 0.06908801502802155, 'NDCG*@10': 0.03951268202879212, 'MRR*@10': 0.030586000023917717, 'Recall*@5': 0.04593290727246891, 'NDCG*@5': 0.032057008960030296, 'MRR*@5': 0.027528272095051678}
INFO    [05-05 18:25:54] train in BasicTrainer:
duration: 33.94218039512634s
INFO    [05-05 18:25:54] train in BasicTrainer:
epoch: 19
INFO    [05-05 18:26:07] _train_one_epoch in BasicTrainer:
loss = 6.214444560664041
INFO    [05-05 18:26:27] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-05 18:26:27] validate in BasicTrainer:
{'Recall@10': 0.0709091756831516, 'NDCG@10': 0.04065502536567775, 'MRR@10': 0.03149766762825576, 'Recall@5': 0.04784350808371197, 'NDCG@5': 0.033254580572247505, 'MRR@5': 0.028477414426478474, 'Recall*@10': 0.0709091756831516, 'NDCG*@10': 0.04065502536567775, 'MRR*@10': 0.03149766762825576, 'Recall*@5': 0.04784350808371197, 'NDCG*@5': 0.033254580572247505, 'MRR*@5': 0.028477414426478474}
INFO    [05-05 18:26:27] train in BasicTrainer:
duration: 33.65997886657715s
INFO    [05-05 18:26:27] train in BasicTrainer:
epoch: 20
INFO    [05-05 18:26:40] _train_one_epoch in BasicTrainer:
loss = 6.168732932635716
INFO    [05-05 18:27:02] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-05 18:27:03] validate in BasicTrainer:
{'Recall@10': 0.07322631640867754, 'NDCG@10': 0.04194960370659828, 'MRR@10': 0.032471414655447006, 'Recall@5': 0.04952205751429905, 'NDCG@5': 0.0343179717998613, 'MRR@5': 0.02934146299958229, 'Recall*@10': 0.07322631640867754, 'NDCG*@10': 0.04194960370659828, 'MRR*@10': 0.032471414655447006, 'Recall*@5': 0.04952205751429905, 'NDCG*@5': 0.0343179717998613, 'MRR*@5': 0.02934146299958229}
INFO    [05-05 18:27:03] train in BasicTrainer:
duration: 35.8611216545105s
INFO    [05-05 18:27:03] train in BasicTrainer:
epoch: 21
INFO    [05-05 18:27:16] _train_one_epoch in BasicTrainer:
loss = 6.123183344091688
INFO    [05-05 18:27:35] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-05 18:27:35] validate in BasicTrainer:
{'Recall@10': 0.07415145296942104, 'NDCG@10': 0.042933155528523705, 'MRR@10': 0.033459985120729965, 'Recall@5': 0.050808683037757874, 'NDCG@5': 0.035416506569493904, 'MRR@5': 0.030376623807982964, 'Recall*@10': 0.07415145296942104, 'NDCG*@10': 0.042933155528523705, 'MRR*@10': 0.033459985120729965, 'Recall*@5': 0.050808683037757874, 'NDCG*@5': 0.035416506569493904, 'MRR*@5': 0.030376623807982964}
INFO    [05-05 18:27:35] train in BasicTrainer:
duration: 32.14655089378357s
INFO    [05-05 18:27:35] train in BasicTrainer:
epoch: 22
INFO    [05-05 18:27:49] _train_one_epoch in BasicTrainer:
loss = 6.081212052277157
INFO    [05-05 18:28:08] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-05 18:28:08] validate in BasicTrainer:
{'Recall@10': 0.07445525987581773, 'NDCG@10': 0.04396465386856686, 'MRR@10': 0.03471096994524652, 'Recall@5': 0.05183282257481055, 'NDCG@5': 0.036692787131125275, 'MRR@5': 0.03173543766818263, 'Recall*@10': 0.07445525987581773, 'NDCG*@10': 0.04396465386856686, 'MRR*@10': 0.03471096994524652, 'Recall*@5': 0.05183282257481055, 'NDCG*@5': 0.036692787131125275, 'MRR*@5': 0.03173543766818263}
INFO    [05-05 18:28:08] train in BasicTrainer:
duration: 32.924628257751465s
INFO    [05-05 18:28:08] train in BasicTrainer:
epoch: 23
INFO    [05-05 18:28:21] _train_one_epoch in BasicTrainer:
loss = 6.042257530348642
INFO    [05-05 18:28:41] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-05 18:28:41] validate in BasicTrainer:
{'Recall@10': 0.07543940097093582, 'NDCG@10': 0.0447512607682835, 'MRR@10': 0.03543113747780973, 'Recall@5': 0.052556342699311, 'NDCG@5': 0.037387970834970474, 'MRR@5': 0.03241374343633652, 'Recall*@10': 0.07543940097093582, 'NDCG*@10': 0.0447512607682835, 'MRR*@10': 0.03543113747780973, 'Recall*@5': 0.052556342699311, 'NDCG*@5': 0.037387970834970474, 'MRR*@5': 0.03241374343633652}
INFO    [05-05 18:28:41] train in BasicTrainer:
duration: 33.078662395477295s
INFO    [05-05 18:28:41] train in BasicTrainer:
epoch: 24
INFO    [05-05 18:28:54] _train_one_epoch in BasicTrainer:
loss = 6.00441404751369
INFO    [05-05 18:29:12] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-05 18:29:13] validate in BasicTrainer:
{'Recall@10': 0.0761318254199895, 'NDCG@10': 0.04517546600916169, 'MRR@10': 0.03575805439190431, 'Recall@5': 0.05370408669114113, 'NDCG@5': 0.037976890125057915, 'MRR@5': 0.03281916864216328, 'Recall*@10': 0.0761318254199895, 'NDCG*@10': 0.04517546600916169, 'MRR*@10': 0.03575805439190431, 'Recall*@5': 0.05370408669114113, 'NDCG*@5': 0.037976890125057915, 'MRR*@5': 0.03281916864216328}
INFO    [05-05 18:29:13] train in BasicTrainer:
duration: 31.48730182647705s
INFO    [05-05 18:29:13] train in BasicTrainer:
epoch: 25
INFO    [05-05 18:29:26] _train_one_epoch in BasicTrainer:
loss = 5.969605207443237
INFO    [05-05 18:29:46] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-05 18:29:46] validate in BasicTrainer:
{'Recall@10': 0.07706147229129617, 'NDCG@10': 0.04598278416828676, 'MRR@10': 0.03656349737535824, 'Recall@5': 0.05360706793991002, 'NDCG@5': 0.0384231609376994, 'MRR@5': 0.03345774351195856, 'Recall*@10': 0.07706147229129617, 'NDCG*@10': 0.04598278416828676, 'MRR*@10': 0.03656349737535824, 'Recall*@5': 0.05360706793991002, 'NDCG*@5': 0.0384231609376994, 'MRR*@5': 0.03345774351195856}
INFO    [05-05 18:29:46] train in BasicTrainer:
duration: 33.22303533554077s
INFO    [05-05 18:29:46] train in BasicTrainer:
epoch: 26
INFO    [05-05 18:29:59] _train_one_epoch in BasicTrainer:
loss = 5.934366158076695
INFO    [05-05 18:30:18] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-05 18:30:20] validate in BasicTrainer:
{'Recall@10': 0.0780931907621297, 'NDCG@10': 0.04661052911119028, 'MRR@10': 0.0370418405668302, 'Recall@5': 0.05453352731737224, 'NDCG@5': 0.03902653469280763, 'MRR@5': 0.03393240967257456, 'Recall*@10': 0.0780931907621297, 'NDCG*@10': 0.04661052911119028, 'MRR*@10': 0.0370418405668302, 'Recall*@5': 0.05453352731737224, 'NDCG*@5': 0.03902653469280763, 'MRR*@5': 0.03393240967257456}
INFO    [05-05 18:30:20] train in BasicTrainer:
duration: 33.87356638908386s
INFO    [05-05 18:30:20] train in BasicTrainer:
epoch: 27
INFO    [05-05 18:30:33] _train_one_epoch in BasicTrainer:
loss = 5.900025538035801
INFO    [05-05 18:30:53] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-05 18:30:53] validate in BasicTrainer:
{'Recall@10': 0.07905832542614503, 'NDCG@10': 0.04724074832417748, 'MRR@10': 0.03757091611623764, 'Recall@5': 0.056042098863558334, 'NDCG@5': 0.03987787697802891, 'MRR@5': 0.034578917886723175, 'Recall*@10': 0.07905832542614503, 'NDCG*@10': 0.04724074832417748, 'MRR*@10': 0.03757091611623764, 'Recall*@5': 0.056042098863558334, 'NDCG*@5': 0.03987787697802891, 'MRR*@5': 0.034578917886723175}
INFO    [05-05 18:30:53] train in BasicTrainer:
duration: 33.03850197792053s
INFO    [05-05 18:30:53] train in BasicTrainer:
epoch: 28
INFO    [05-05 18:31:05] _train_one_epoch in BasicTrainer:
loss = 5.868087896278927
INFO    [05-05 18:31:24] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-05 18:31:25] validate in BasicTrainer:
{'Recall@10': 0.07925807684659958, 'NDCG@10': 0.047828827391971244, 'MRR@10': 0.03827371211214499, 'Recall@5': 0.05603704635392536, 'NDCG@5': 0.04037621752782301, 'MRR@5': 0.035230525853959, 'Recall*@10': 0.07925807684659958, 'NDCG*@10': 0.047828827391971244, 'MRR*@10': 0.03827371211214499, 'Recall*@5': 0.05603704635392536, 'NDCG*@5': 0.04037621752782301, 'MRR*@5': 0.035230525853959}
INFO    [05-05 18:31:25] train in BasicTrainer:
duration: 31.821057558059692s
INFO    [05-05 18:31:25] train in BasicTrainer:
epoch: 29
INFO    [05-05 18:31:38] _train_one_epoch in BasicTrainer:
loss = 5.84040048292705
INFO    [05-05 18:31:57] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-05 18:31:58] validate in BasicTrainer:
{'Recall@10': 0.08056052164597945, 'NDCG@10': 0.04817052524198185, 'MRR@10': 0.03830248219045726, 'Recall@5': 0.05731795795939185, 'NDCG@5': 0.04068861766295, 'MRR@5': 0.03523439524525946, 'Recall*@10': 0.08056052164597945, 'NDCG*@10': 0.04817052524198185, 'MRR*@10': 0.03830248219045726, 'Recall*@5': 0.05731795795939185, 'NDCG*@5': 0.04068861766295, 'MRR*@5': 0.03523439524525946}
INFO    [05-05 18:31:58] train in BasicTrainer:
duration: 32.85408163070679s
INFO    [05-05 18:31:58] train in BasicTrainer:
epoch: 30
INFO    [05-05 18:32:12] _train_one_epoch in BasicTrainer:
loss = 5.805521769183023
INFO    [05-05 18:32:30] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [05-05 18:32:30] validate in BasicTrainer:
{'Recall@10': 0.08210524171590805, 'NDCG@10': 0.049124911088835106, 'MRR@10': 0.0391049710187045, 'Recall@5': 0.0576666962694038, 'NDCG@5': 0.04125472767786546, 'MRR@5': 0.03587547384879806, 'Recall*@10': 0.08210524171590805, 'NDCG*@10': 0.049124911088835106, 'MRR*@10': 0.0391049710187045, 'Recall*@5': 0.0576666962694038, 'NDCG*@5': 0.04125472767786546, 'MRR*@5': 0.03587547384879806}
INFO    [05-05 18:32:30] train in BasicTrainer:
duration: 32.8502836227417s
INFO    [05-05 18:32:30] train in BasicTrainer:
epoch: 31
INFO    [05-05 18:32:44] _train_one_epoch in BasicTrainer:
loss = 5.776354559830257
INFO    [05-05 18:33:05] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-05 18:33:07] validate in BasicTrainer:
{'Recall@10': 0.08239124579863115, 'NDCG@10': 0.04944058744744821, 'MRR@10': 0.03944269499995492, 'Recall@5': 0.05739849602634257, 'NDCG@5': 0.041419986974109306, 'MRR@5': 0.036168626086278396, 'Recall*@10': 0.08239124579863115, 'NDCG*@10': 0.04944058744744821, 'MRR*@10': 0.03944269499995492, 'Recall*@5': 0.05739849602634257, 'NDCG*@5': 0.041419986974109306, 'MRR*@5': 0.036168626086278396}
INFO    [05-05 18:33:07] train in BasicTrainer:
duration: 36.34748673439026s
INFO    [05-05 18:33:07] train in BasicTrainer:
epoch: 32
INFO    [05-05 18:33:19] _train_one_epoch in BasicTrainer:
loss = 5.750928342342377
INFO    [05-05 18:33:38] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-05 18:33:39] validate in BasicTrainer:
{'Recall@10': 0.08325045962225307, 'NDCG@10': 0.05016538839448582, 'MRR@10': 0.04010893743146549, 'Recall@5': 0.059101766483350235, 'NDCG@5': 0.04242490977048874, 'MRR@5': 0.036954824897375976, 'Recall*@10': 0.08325045962225307, 'NDCG*@10': 0.05016538839448582, 'MRR*@10': 0.04010893743146549, 'Recall*@5': 0.059101766483350235, 'NDCG*@5': 0.04242490977048874, 'MRR*@5': 0.036954824897375976}
INFO    [05-05 18:33:39] train in BasicTrainer:
duration: 31.82983112335205s
INFO    [05-05 18:33:39] train in BasicTrainer:
epoch: 33
INFO    [05-05 18:33:51] _train_one_epoch in BasicTrainer:
loss = 5.72570013148444
INFO    [05-05 18:34:10] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-05 18:34:10] validate in BasicTrainer:
{'Recall@10': 0.08416867865757509, 'NDCG@10': 0.05067154528065161, 'MRR@10': 0.040504480627450073, 'Recall@5': 0.05914549427953633, 'NDCG@5': 0.04262353242798285, 'MRR@5': 0.03720837729898366, 'Recall*@10': 0.08416867865757509, 'NDCG*@10': 0.05067154528065161, 'MRR*@10': 0.040504480627450073, 'Recall*@5': 0.05914549427953633, 'NDCG*@5': 0.04262353242798285, 'MRR*@5': 0.03720837729898366}
INFO    [05-05 18:34:10] train in BasicTrainer:
duration: 31.692700624465942s
INFO    [05-05 18:34:10] train in BasicTrainer:
epoch: 34
INFO    [05-05 18:34:24] _train_one_epoch in BasicTrainer:
loss = 5.697072284562247
INFO    [05-05 18:34:43] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-05 18:34:43] validate in BasicTrainer:
{'Recall@10': 0.08427712524479086, 'NDCG@10': 0.0510781238024885, 'MRR@10': 0.040993429043076256, 'Recall@5': 0.05950445681810379, 'NDCG@5': 0.0431013974276456, 'MRR@5': 0.037721348757093605, 'Recall*@10': 0.08427712524479086, 'NDCG*@10': 0.0510781238024885, 'MRR*@10': 0.040993429043076256, 'Recall*@5': 0.05950445681810379, 'NDCG*@5': 0.0431013974276456, 'MRR*@5': 0.037721348757093605}
INFO    [05-05 18:34:43] train in BasicTrainer:
duration: 32.55822491645813s
INFO    [05-05 18:34:43] train in BasicTrainer:
epoch: 35
DEBUG   [05-05 18:34:53] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 5997301
DEBUG   [05-05 18:34:53] calculate_loss in loss:
pred max in softmax: 0.9707425832748413, argmax 46870830
DEBUG   [05-05 18:34:53] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 27634021
DEBUG   [05-05 18:34:53] calculate_loss in loss:
pred max in softmax: 0.9632887244224548, argmax 63609816
INFO    [05-05 18:34:56] _train_one_epoch in BasicTrainer:
loss = 5.674548787730081
INFO    [05-05 18:35:15] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-05 18:35:15] validate in BasicTrainer:
{'Recall@10': 0.08496834540908987, 'NDCG@10': 0.051832029087976975, 'MRR@10': 0.041759985075755554, 'Recall@5': 0.06054122779857029, 'NDCG@5': 0.043966629965738815, 'MRR@5': 0.03853342106396502, 'Recall*@10': 0.08496834540908987, 'NDCG*@10': 0.051832029087976975, 'MRR*@10': 0.041759985075755554, 'Recall*@5': 0.06054122779857029, 'NDCG*@5': 0.043966629965738815, 'MRR*@5': 0.03853342106396502}
INFO    [05-05 18:35:15] train in BasicTrainer:
duration: 32.26845908164978s
INFO    [05-05 18:35:15] train in BasicTrainer:
epoch: 36
INFO    [05-05 18:35:28] _train_one_epoch in BasicTrainer:
loss = 5.647475404398782
INFO    [05-05 18:35:47] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-05 18:35:47] validate in BasicTrainer:
{'Recall@10': 0.08500515601851723, 'NDCG@10': 0.05209952796047384, 'MRR@10': 0.042089805345643654, 'Recall@5': 0.0612228854813359, 'NDCG@5': 0.04446185685016892, 'MRR@5': 0.038968772712078964, 'Recall*@10': 0.08500515601851723, 'NDCG*@10': 0.05209952796047384, 'MRR*@10': 0.042089805345643654, 'Recall*@5': 0.0612228854813359, 'NDCG*@5': 0.04446185685016892, 'MRR*@5': 0.038968772712078964}
INFO    [05-05 18:35:47] train in BasicTrainer:
duration: 32.3321897983551s
INFO    [05-05 18:35:47] train in BasicTrainer:
epoch: 37
INFO    [05-05 18:36:00] _train_one_epoch in BasicTrainer:
loss = 5.626323163509369
INFO    [05-05 18:36:19] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [05-05 18:36:19] validate in BasicTrainer:
{'Recall@10': 0.08567033233967694, 'NDCG@10': 0.052311550825834274, 'MRR@10': 0.04217438298192891, 'Recall@5': 0.0602469840510325, 'NDCG@5': 0.044105234471234406, 'MRR@5': 0.03879702091217041, 'Recall*@10': 0.08567033233967694, 'NDCG*@10': 0.052311550825834274, 'MRR*@10': 0.04217438298192891, 'Recall*@5': 0.0602469840510325, 'NDCG*@5': 0.044105234471234406, 'MRR*@5': 0.03879702091217041}
INFO    [05-05 18:36:19] train in BasicTrainer:
duration: 31.409737825393677s
INFO    [05-05 18:36:19] train in BasicTrainer:
epoch: 38
INFO    [05-05 18:36:32] _train_one_epoch in BasicTrainer:
loss = 5.602161109447479
INFO    [05-05 18:36:51] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-05 18:36:52] validate in BasicTrainer:
{'Recall@10': 0.08638374778357419, 'NDCG@10': 0.05279850079254671, 'MRR@10': 0.042569184506481346, 'Recall@5': 0.06231613491069187, 'NDCG@5': 0.04507048326459798, 'MRR@5': 0.03941213136369532, 'Recall*@10': 0.08638374778357419, 'NDCG*@10': 0.05279850079254671, 'MRR*@10': 0.042569184506481346, 'Recall*@5': 0.06231613491069187, 'NDCG*@5': 0.04507048326459798, 'MRR*@5': 0.03941213136369532}
INFO    [05-05 18:36:52] train in BasicTrainer:
duration: 32.77802300453186s
INFO    [05-05 18:36:52] train in BasicTrainer:
epoch: 39
INFO    [05-05 18:37:05] _train_one_epoch in BasicTrainer:
loss = 5.580369344779423
INFO    [05-05 18:37:23] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [05-05 18:37:23] validate in BasicTrainer:
{'Recall@10': 0.08705078945918517, 'NDCG@10': 0.05330939895727418, 'MRR@10': 0.04302057725462047, 'Recall@5': 0.0628779178315943, 'NDCG@5': 0.045539369637315925, 'MRR@5': 0.039840825240720405, 'Recall*@10': 0.08705078945918517, 'NDCG*@10': 0.05330939895727418, 'MRR*@10': 0.04302057725462047, 'Recall*@5': 0.0628779178315943, 'NDCG*@5': 0.045539369637315925, 'MRR*@5': 0.039840825240720405}
INFO    [05-05 18:37:23] train in BasicTrainer:
duration: 31.573837518692017s
INFO    [05-05 18:37:23] train in BasicTrainer:
epoch: 40
INFO    [05-05 18:37:37] _train_one_epoch in BasicTrainer:
loss = 5.557597994804382
INFO    [05-05 18:37:56] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [05-05 18:37:57] validate in BasicTrainer:
{'Recall@10': 0.08627211302518845, 'NDCG@10': 0.05334369397976182, 'MRR@10': 0.043326577002351936, 'Recall@5': 0.062069467861544, 'NDCG@5': 0.0455607223239812, 'MRR@5': 0.04014013064178554, 'Recall*@10': 0.08627211302518845, 'NDCG*@10': 0.05334369397976182, 'MRR*@10': 0.043326577002351936, 'Recall*@5': 0.062069467861544, 'NDCG*@5': 0.0455607223239812, 'MRR*@5': 0.04014013064178554}
INFO    [05-05 18:37:57] train in BasicTrainer:
duration: 33.47206234931946s
INFO    [05-05 18:37:57] train in BasicTrainer:
epoch: 41
INFO    [05-05 18:38:10] _train_one_epoch in BasicTrainer:
loss = 5.536837339401245
INFO    [05-05 18:38:28] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-05 18:38:28] validate in BasicTrainer:
{'Recall@10': 0.08759927885098891, 'NDCG@10': 0.054114186628298325, 'MRR@10': 0.043929428878155624, 'Recall@5': 0.06289000673727556, 'NDCG@5': 0.046185515143654564, 'MRR@5': 0.04069338840517131, 'Recall*@10': 0.08759927885098891, 'NDCG*@10': 0.054114186628298325, 'MRR*@10': 0.043929428878155624, 'Recall*@5': 0.06289000673727556, 'NDCG*@5': 0.046185515143654564, 'MRR*@5': 0.04069338840517131}
INFO    [05-05 18:38:28] train in BasicTrainer:
duration: 31.58492636680603s
INFO    [05-05 18:38:28] train in BasicTrainer:
epoch: 42
INFO    [05-05 18:38:41] _train_one_epoch in BasicTrainer:
loss = 5.520916887692043
INFO    [05-05 18:39:00] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-05 18:39:00] validate in BasicTrainer:
{'Recall@10': 0.08811613036827608, 'NDCG@10': 0.05438316071575338, 'MRR@10': 0.04412562467835166, 'Recall@5': 0.06339795650406317, 'NDCG@5': 0.046463272788307884, 'MRR@5': 0.04089961675080386, 'Recall*@10': 0.08811613036827608, 'NDCG*@10': 0.05438316071575338, 'MRR*@10': 0.04412562467835166, 'Recall*@5': 0.06339795650406317, 'NDCG*@5': 0.046463272788307884, 'MRR*@5': 0.04089961675080386}
INFO    [05-05 18:39:00] train in BasicTrainer:
duration: 32.150156021118164s
INFO    [05-05 18:39:00] train in BasicTrainer:
epoch: 43
INFO    [05-05 18:39:13] _train_one_epoch in BasicTrainer:
loss = 5.4981944390705655
INFO    [05-05 18:39:31] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [05-05 18:39:31] validate in BasicTrainer:
{'Recall@10': 0.08890370821410959, 'NDCG@10': 0.05505963448773731, 'MRR@10': 0.04475307938727466, 'Recall@5': 0.06409675560214302, 'NDCG@5': 0.04707516357302666, 'MRR@5': 0.041478969495404854, 'Recall*@10': 0.08890370821410959, 'NDCG*@10': 0.05505963448773731, 'MRR*@10': 0.04475307938727466, 'Recall*@5': 0.06409675560214302, 'NDCG*@5': 0.04707516357302666, 'MRR*@5': 0.041478969495404854}
INFO    [05-05 18:39:31] train in BasicTrainer:
duration: 31.023527145385742s
INFO    [05-05 18:39:31] train in BasicTrainer:
epoch: 44
INFO    [05-05 18:39:44] _train_one_epoch in BasicTrainer:
loss = 5.473551903452192
INFO    [05-05 18:40:03] validate in BasicTrainer:
{'Recall@10': 0.08922267298806798, 'NDCG@10': 0.05503484809940511, 'MRR@10': 0.044628255407918586, 'Recall@5': 0.06429650702259758, 'NDCG@5': 0.04702258042313836, 'MRR@5': 0.04134982045401226, 'Recall*@10': 0.08922267298806798, 'NDCG*@10': 0.05503484809940511, 'MRR*@10': 0.044628255407918586, 'Recall*@5': 0.06429650702259758, 'NDCG*@5': 0.04702258042313836, 'MRR*@5': 0.04134982045401226}
INFO    [05-05 18:40:03] train in BasicTrainer:
duration: 31.811805248260498s
INFO    [05-05 18:40:03] train in BasicTrainer:
epoch: 45
INFO    [05-05 18:40:16] _train_one_epoch in BasicTrainer:
loss = 5.459933340549469
INFO    [05-05 18:40:34] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-05 18:40:34] validate in BasicTrainer:
{'Recall@10': 0.08932979675856503, 'NDCG@10': 0.05540210990743204, 'MRR@10': 0.04505896636030891, 'Recall@5': 0.06480379538102583, 'NDCG@5': 0.047507263042710045, 'MRR@5': 0.041821794415062126, 'Recall*@10': 0.08932979675856503, 'NDCG*@10': 0.05540210990743204, 'MRR*@10': 0.04505896636030891, 'Recall*@5': 0.06480379538102583, 'NDCG*@5': 0.047507263042710045, 'MRR*@5': 0.041821794415062126}
INFO    [05-05 18:40:34] train in BasicTrainer:
duration: 31.111984491348267s
INFO    [05-05 18:40:34] train in BasicTrainer:
epoch: 46
INFO    [05-05 18:40:47] _train_one_epoch in BasicTrainer:
loss = 5.440023592540196
INFO    [05-05 18:41:06] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-05 18:41:06] validate in BasicTrainer:
{'Recall@10': 0.09015923738479614, 'NDCG@10': 0.055759513581340965, 'MRR@10': 0.04527601701292125, 'Recall@5': 0.06575816327875311, 'NDCG@5': 0.04791868444193493, 'MRR@5': 0.042069186879829926, 'Recall*@10': 0.09015923738479614, 'NDCG*@10': 0.055759513581340965, 'MRR*@10': 0.04527601701292125, 'Recall*@5': 0.06575816327875311, 'NDCG*@5': 0.04791868444193493, 'MRR*@5': 0.042069186879829926}
INFO    [05-05 18:41:06] train in BasicTrainer:
duration: 31.864055156707764s
INFO    [05-05 18:41:06] train in BasicTrainer:
epoch: 47
INFO    [05-05 18:41:19] _train_one_epoch in BasicTrainer:
loss = 5.420060319559915
INFO    [05-05 18:41:38] log in loggers:
Update Best NDCG@10 Model at 47
INFO    [05-05 18:41:38] validate in BasicTrainer:
{'Recall@10': 0.09024933861060576, 'NDCG@10': 0.05642037804831158, 'MRR@10': 0.046101203696294266, 'Recall@5': 0.0657993649894541, 'NDCG@5': 0.048554046926173294, 'MRR@5': 0.04287767715074799, 'Recall*@10': 0.09024933861060576, 'NDCG*@10': 0.05642037804831158, 'MRR*@10': 0.046101203696294266, 'Recall*@5': 0.0657993649894541, 'NDCG*@5': 0.048554046926173294, 'MRR*@5': 0.04287767715074799}
INFO    [05-05 18:41:38] train in BasicTrainer:
duration: 31.91512107849121s
INFO    [05-05 18:41:38] train in BasicTrainer:
epoch: 48
INFO    [05-05 18:41:52] _train_one_epoch in BasicTrainer:
loss = 5.40467141355787
INFO    [05-05 18:42:11] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-05 18:42:11] validate in BasicTrainer:
{'Recall@10': 0.09153277630155737, 'NDCG@10': 0.057048351588574325, 'MRR@10': 0.04652592099525712, 'Recall@5': 0.06719124926762148, 'NDCG@5': 0.049225787886164406, 'MRR@5': 0.043325318870219315, 'Recall*@10': 0.09153277630155737, 'NDCG*@10': 0.057048351588574325, 'MRR*@10': 0.04652592099525712, 'Recall*@5': 0.06719124926762148, 'NDCG*@5': 0.049225787886164406, 'MRR*@5': 0.043325318870219315}
INFO    [05-05 18:42:11] train in BasicTrainer:
duration: 33.25608944892883s
INFO    [05-05 18:42:11] train in BasicTrainer:
epoch: 49
INFO    [05-05 18:42:24] _train_one_epoch in BasicTrainer:
loss = 5.389071183545249
INFO    [05-05 18:42:42] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-05 18:42:43] validate in BasicTrainer:
{'Recall@10': 0.09149157459085638, 'NDCG@10': 0.057617205449125984, 'MRR@10': 0.0473033111881126, 'Recall@5': 0.06698831035332246, 'NDCG@5': 0.04973774471066215, 'MRR@5': 0.044077108868143776, 'Recall*@10': 0.09149157459085638, 'NDCG*@10': 0.057617205449125984, 'MRR*@10': 0.0473033111881126, 'Recall*@5': 0.06698831035332246, 'NDCG*@5': 0.04973774471066215, 'MRR*@5': 0.044077108868143776}
INFO    [05-05 18:42:43] train in BasicTrainer:
duration: 31.34279704093933s
INFO    [05-05 18:42:43] train in BasicTrainer:
epoch: 50
INFO    [05-05 18:42:57] _train_one_epoch in BasicTrainer:
loss = 5.372155828135354
INFO    [05-05 18:43:16] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-05 18:43:16] validate in BasicTrainer:
{'Recall@10': 0.09272051805799658, 'NDCG@10': 0.05781796303662387, 'MRR@10': 0.047195265238935295, 'Recall@5': 0.06690271943807602, 'NDCG@5': 0.0495129217478362, 'MRR@5': 0.04379269142042507, 'Recall*@10': 0.09272051805799658, 'NDCG*@10': 0.05781796303662387, 'MRR*@10': 0.047195265238935295, 'Recall*@5': 0.06690271943807602, 'NDCG*@5': 0.0495129217478362, 'MRR*@5': 0.04379269142042507}
INFO    [05-05 18:43:16] train in BasicTrainer:
duration: 33.23461031913757s
INFO    [05-05 18:43:16] train in BasicTrainer:
epoch: 51
INFO    [05-05 18:43:29] _train_one_epoch in BasicTrainer:
loss = 5.35392393384661
INFO    [05-05 18:43:47] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [05-05 18:43:48] validate in BasicTrainer:
{'Recall@10': 0.09319671040231531, 'NDCG@10': 0.0581130673262206, 'MRR@10': 0.04741626673124053, 'Recall@5': 0.0678653276779435, 'NDCG@5': 0.04995915259827267, 'MRR@5': 0.04407250542532314, 'Recall*@10': 0.09319671040231531, 'NDCG*@10': 0.0581130673262206, 'MRR*@10': 0.04741626673124053, 'Recall*@5': 0.0678653276779435, 'NDCG*@5': 0.04995915259827267, 'MRR*@5': 0.04407250542532314}
INFO    [05-05 18:43:48] train in BasicTrainer:
duration: 31.605548858642578s
INFO    [05-05 18:43:48] train in BasicTrainer:
epoch: 52
INFO    [05-05 18:44:01] _train_one_epoch in BasicTrainer:
loss = 5.340244182518551
INFO    [05-05 18:44:21] validate in BasicTrainer:
{'Recall@10': 0.09262668747793544, 'NDCG@10': 0.05799074403264306, 'MRR@10': 0.04741289737549695, 'Recall@5': 0.0681094683029435, 'NDCG@5': 0.050079269842668014, 'MRR@5': 0.04415725408629938, 'Recall*@10': 0.09262668747793544, 'NDCG*@10': 0.05799074403264306, 'MRR*@10': 0.04741289737549695, 'Recall*@5': 0.0681094683029435, 'NDCG*@5': 0.050079269842668014, 'MRR*@5': 0.04415725408629938}
INFO    [05-05 18:44:21] train in BasicTrainer:
duration: 33.20793271064758s
INFO    [05-05 18:44:21] train in BasicTrainer:
epoch: 53
DEBUG   [05-05 18:44:28] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 6798661
DEBUG   [05-05 18:44:28] calculate_loss in loss:
pred max in softmax: 0.9628139734268188, argmax 45234683
DEBUG   [05-05 18:44:29] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 2511385
DEBUG   [05-05 18:44:29] calculate_loss in loss:
pred max in softmax: 0.9377008676528931, argmax 75983593
INFO    [05-05 18:44:34] _train_one_epoch in BasicTrainer:
loss = 5.324980556964874
INFO    [05-05 18:44:52] log in loggers:
Update Best NDCG@10 Model at 53
INFO    [05-05 18:44:53] validate in BasicTrainer:
{'Recall@10': 0.09393231977115978, 'NDCG@10': 0.0588140111755241, 'MRR@10': 0.048079006373882294, 'Recall@5': 0.06900483166629617, 'NDCG@5': 0.05078779228708961, 'MRR@5': 0.04478684541853992, 'Recall*@10': 0.09393231977115978, 'NDCG*@10': 0.0588140111755241, 'MRR*@10': 0.048079006373882294, 'Recall*@5': 0.06900483166629617, 'NDCG*@5': 0.05078779228708961, 'MRR*@5': 0.04478684541853992}
INFO    [05-05 18:44:53] train in BasicTrainer:
duration: 32.018883228302s
INFO    [05-05 18:44:53] train in BasicTrainer:
epoch: 54
INFO    [05-05 18:45:06] _train_one_epoch in BasicTrainer:
loss = 5.311321931225913
INFO    [05-05 18:45:26] log in loggers:
Update Best NDCG@10 Model at 54
INFO    [05-05 18:45:26] validate in BasicTrainer:
{'Recall@10': 0.09384167668494311, 'NDCG@10': 0.05933158336715265, 'MRR@10': 0.04880320517854257, 'Recall@5': 0.06939104131676933, 'NDCG@5': 0.05150097913362763, 'MRR@5': 0.045616077428514305, 'Recall*@10': 0.09384167668494311, 'NDCG*@10': 0.05933158336715265, 'MRR*@10': 0.04880320517854257, 'Recall*@5': 0.06939104131676933, 'NDCG*@5': 0.05150097913362763, 'MRR*@5': 0.045616077428514305}
INFO    [05-05 18:45:26] train in BasicTrainer:
duration: 32.99177885055542s
INFO    [05-05 18:45:26] train in BasicTrainer:
epoch: 55
INFO    [05-05 18:45:39] _train_one_epoch in BasicTrainer:
loss = 5.298139359269824
INFO    [05-05 18:45:57] validate in BasicTrainer:
{'Recall@10': 0.0944256538694555, 'NDCG@10': 0.05931886183944615, 'MRR@10': 0.04860225015065887, 'Recall@5': 0.06936565922065215, 'NDCG@5': 0.05125763165679845, 'MRR@5': 0.04530030522834171, 'Recall*@10': 0.0944256538694555, 'NDCG*@10': 0.05931886183944615, 'MRR*@10': 0.04860225015065887, 'Recall*@5': 0.06936565922065215, 'NDCG*@5': 0.05125763165679845, 'MRR*@5': 0.04530030522834171}
INFO    [05-05 18:45:57] train in BasicTrainer:
duration: 31.23967218399048s
INFO    [05-05 18:45:57] train in BasicTrainer:
epoch: 56
INFO    [05-05 18:46:10] _train_one_epoch in BasicTrainer:
loss = 5.2824903811727255
INFO    [05-05 18:46:30] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-05 18:46:30] validate in BasicTrainer:
{'Recall@10': 0.09377443113110283, 'NDCG@10': 0.05947093293070793, 'MRR@10': 0.048976526680317795, 'Recall@5': 0.06946905295957219, 'NDCG@5': 0.05164251611991362, 'MRR@5': 0.04576426981524988, 'Recall*@10': 0.09377443113110283, 'NDCG*@10': 0.05947093293070793, 'MRR*@10': 0.048976526680317795, 'Recall*@5': 0.06946905295957219, 'NDCG*@5': 0.05164251611991362, 'MRR*@5': 0.04576426981524988}
INFO    [05-05 18:46:30] train in BasicTrainer:
duration: 33.27170181274414s
INFO    [05-05 18:46:30] train in BasicTrainer:
epoch: 57
INFO    [05-05 18:46:43] _train_one_epoch in BasicTrainer:
loss = 5.272024265357426
INFO    [05-05 18:47:02] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-05 18:47:02] validate in BasicTrainer:
{'Recall@10': 0.09517521749843251, 'NDCG@10': 0.06002233279022304, 'MRR@10': 0.049294084987857124, 'Recall@5': 0.06993447853760286, 'NDCG@5': 0.05190028792077845, 'MRR@5': 0.04596507413820787, 'Recall*@10': 0.09517521749843251, 'NDCG*@10': 0.06002233279022304, 'MRR*@10': 0.049294084987857124, 'Recall*@5': 0.06993447853760286, 'NDCG*@5': 0.05190028792077845, 'MRR*@5': 0.04596507413820787}
INFO    [05-05 18:47:02] train in BasicTrainer:
duration: 31.62887215614319s
INFO    [05-05 18:47:02] train in BasicTrainer:
epoch: 58
INFO    [05-05 18:47:15] _train_one_epoch in BasicTrainer:
loss = 5.262561729976109
INFO    [05-05 18:47:35] log in loggers:
Update Best NDCG@10 Model at 58
INFO    [05-05 18:47:35] validate in BasicTrainer:
{'Recall@10': 0.09610991721803491, 'NDCG@10': 0.060400758954611694, 'MRR@10': 0.04955253242091699, 'Recall@5': 0.0695660717108033, 'NDCG@5': 0.05189874226396734, 'MRR@5': 0.04609008268876509, 'Recall*@10': 0.09610991721803491, 'NDCG*@10': 0.060400758954611694, 'MRR*@10': 0.04955253242091699, 'Recall*@5': 0.0695660717108033, 'NDCG*@5': 0.05189874226396734, 'MRR*@5': 0.04609008268876509}
INFO    [05-05 18:47:35] train in BasicTrainer:
duration: 33.148789405822754s
INFO    [05-05 18:47:35] train in BasicTrainer:
epoch: 59
INFO    [05-05 18:47:48] _train_one_epoch in BasicTrainer:
loss = 5.244442880153656
INFO    [05-05 18:48:07] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [05-05 18:48:07] validate in BasicTrainer:
{'Recall@10': 0.09637625244530765, 'NDCG@10': 0.06041943586685441, 'MRR@10': 0.04947870258580555, 'Recall@5': 0.06976516206156123, 'NDCG@5': 0.051864677532152695, 'MRR@5': 0.04597730866887353, 'Recall*@10': 0.09637625244530765, 'NDCG*@10': 0.06041943586685441, 'MRR*@10': 0.04947870258580555, 'Recall*@5': 0.06976516206156123, 'NDCG*@5': 0.051864677532152695, 'MRR*@5': 0.04597730866887353}
INFO    [05-05 18:48:07] train in BasicTrainer:
duration: 32.128002882003784s
INFO    [05-05 18:48:07] close_training in BasicTrainer:
finished training
DEBUG   [05-05 18:48:07] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3361 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-05 18:48:07] run_routine in Routine:
Finished training, Start final validation
INFO    [05-05 18:48:07] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-05 18:48:07] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 18:48:07] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 18:48:26] validate in BasicTrainer:
{'Recall@10': 0.09637625244530765, 'NDCG@10': 0.06041943586685441, 'MRR@10': 0.04947870258580555, 'Recall@5': 0.06976516206156123, 'NDCG@5': 0.051864677532152695, 'MRR@5': 0.04597730866887353, 'Recall*@10': 0.09637625244530765, 'NDCG*@10': 0.06041943586685441, 'MRR*@10': 0.04947870258580555, 'Recall*@5': 0.06976516206156123, 'NDCG*@5': 0.051864677532152695, 'MRR*@5': 0.04597730866887353}
INFO    [05-05 18:48:26] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.09637625244530765, 'NDCG@10': 0.06041943586685441, 'MRR@10': 0.04947870258580555, 'Recall@5': 0.06976516206156123, 'NDCG@5': 0.051864677532152695, 'MRR@5': 0.04597730866887353, 'Recall*@10': 0.09637625244530765, 'NDCG*@10': 0.06041943586685441, 'MRR*@10': 0.04947870258580555, 'Recall*@5': 0.06976516206156123, 'NDCG*@5': 0.051864677532152695, 'MRR*@5': 0.04597730866887353}
INFO    [05-05 18:48:26] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-05 18:48:26] test in BasicTrainer:
Test model on test set!
INFO    [05-05 18:48:26] test_with_given_state_path in BasicTrainer:
Loading model params from ___yelp_soft_2022/pop_narm-T-9.0-al-0.25_05-05_18:14_t10/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-05 18:48:26] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 18:48:26] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 18:48:26] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-05 18:48:45] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.07892383499578996, 'NDCG@10': 0.047844112596728584, 'MRR@10': 0.03840286758812991, 'Recall@5': 0.05578081648458134, 'NDCG@5': 0.040398772128603676, 'MRR@5': 0.03535252470861782, 'Recall*@10': 0.07892383499578996, 'NDCG*@10': 0.047844112596728584, 'MRR*@10': 0.03840286758812991, 'Recall*@5': 0.05578081648458134, 'NDCG*@5': 0.040398772128603676, 'MRR*@5': 0.03535252470861782}
INFO    [05-05 18:48:45] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.07892383499578996, 'NDCG@10': 0.047844112596728584, 'MRR@10': 0.03840286758812991, 'Recall@5': 0.05578081648458134, 'NDCG@5': 0.040398772128603676, 'MRR@5': 0.03535252470861782, 'Recall*@10': 0.07892383499578996, 'NDCG*@10': 0.047844112596728584, 'MRR*@10': 0.03840286758812991, 'Recall*@5': 0.05578081648458134, 'NDCG*@5': 0.040398772128603676, 'MRR*@5': 0.03535252470861782}
