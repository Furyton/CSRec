INFO    [05-05 17:06:18] setup_train in utils:
{
    "experiment_dir": "___yelp_soft_2022",
    "experiment_description": "pop",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "yelp.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "alpha": 0.5,
    "T": 6.0,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.yelp/narm/config_distill.json",
    "task_id": 8,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "dvae_alpha": 0.5,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-05 17:06:18] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-05 17:06:18] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/yelp-5-5.pkl
INFO    [05-05 17:06:19] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-05 17:06:19] _check_dataset_cache in utils:
correct.
INFO    [05-05 17:06:19] __init__ in NextItemDataloader:
there are 20033 items in this dataset, 43947 users, padding_first? False
DEBUG   [05-05 17:06:26] generate_model in utils:
model_code_list=['pop']
INFO    [05-05 17:06:26] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-05 17:06:26] load_model_config in utils:
{}
WARNING [05-05 17:06:32] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.5_05-05_17:06_t8/teacher_pop_logs does not exist! Create one.
WARNING [05-05 17:06:32] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.5_05-05_17:06_t8/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-05 17:06:32] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.5_05-05_17:06_t8/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-05 17:06:32] get_path in utils:
Path is None
WARNING [05-05 17:06:32] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 17:06:32] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-05 17:06:32] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 17:06:32] __init__ in BasicTrainer:
229376 iter per epoch
DEBUG   [05-05 17:06:32] generate_model in utils:
model_code_list=['narm']
INFO    [05-05 17:06:32] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-05 17:06:32] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-05 17:06:35] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.5_05-05_17:06_t8/student_narm_logs does not exist! Create one.
WARNING [05-05 17:06:35] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.5_05-05_17:06_t8/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-05 17:06:35] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.5_05-05_17:06_t8/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-05 17:06:35] get_path in utils:
Path is None
WARNING [05-05 17:06:35] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 17:06:35] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(20034, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-05 17:06:35] assert_model_device in utils:
model student_narm has 5.3603515625 MB params.
INFO    [05-05 17:06:35] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 17:06:35] __init__ in DistillTrainer:
229376 iter per epoch
INFO    [05-05 17:06:35] _set_current_routine in Routine:
first routine: student
INFO    [05-05 17:06:35] run_routine in Routine:
Start routine student
INFO    [05-05 17:06:35] run_routine in Routine:
Start training
INFO    [05-05 17:06:35] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-05 17:06:54] test_mentor in DistillTrainer:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 17:06:54] train in DistillTrainer:
result:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 17:07:12] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 17:07:12] validate in BasicTrainer:
{'Recall@10': 0.00044389204545454544, 'NDCG@10': 0.0002111054676457901, 'MRR@10': 0.0001419221515044972, 'Recall@5': 0.0003107244318181818, 'NDCG@5': 0.0001693654326531528, 'MRR@5': 0.00012539950462682597, 'Recall*@10': 0.00044389204545454544, 'NDCG*@10': 0.0002111054676457901, 'MRR*@10': 0.0001419221515044972, 'Recall*@5': 0.0003107244318181818, 'NDCG*@5': 0.0001693654326531528, 'MRR*@5': 0.00012539950462682597}
INFO    [05-05 17:07:12] train in BasicTrainer:
epoch: 0
DEBUG   [05-05 17:07:13] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 9282877
DEBUG   [05-05 17:07:13] calculate_loss in loss:
pred max in softmax: 5.0027036195388064e-05, argmax 67393260
INFO    [05-05 17:07:26] _train_one_epoch in BasicTrainer:
loss = 7.0741947889328
INFO    [05-05 17:07:44] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 17:07:44] validate in BasicTrainer:
{'Recall@10': 0.008148487826639956, 'NDCG@10': 0.004294955806637352, 'MRR@10': 0.0031499163967303252, 'Recall@5': 0.004532090218907053, 'NDCG@5': 0.003133214586837725, 'MRR@5': 0.002675117639062757, 'Recall*@10': 0.008148487826639956, 'NDCG*@10': 0.004294955806637352, 'MRR*@10': 0.0031499163967303252, 'Recall*@5': 0.004532090218907053, 'NDCG*@5': 0.003133214586837725, 'MRR*@5': 0.002675117639062757}
INFO    [05-05 17:07:44] train in BasicTrainer:
duration: 32.13072085380554s
INFO    [05-05 17:07:44] train in BasicTrainer:
epoch: 1
INFO    [05-05 17:07:57] _train_one_epoch in BasicTrainer:
loss = 6.753280750342777
INFO    [05-05 17:08:16] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-05 17:08:17] validate in BasicTrainer:
{'Recall@10': 0.016995232467624275, 'NDCG@10': 0.008384277705441822, 'MRR@10': 0.005812473997304385, 'Recall@5': 0.009539168751375242, 'NDCG@5': 0.005992113654925065, 'MRR@5': 0.004836393774233081, 'Recall*@10': 0.016995232467624275, 'NDCG*@10': 0.008384277705441822, 'MRR*@10': 0.005812473997304385, 'Recall*@5': 0.009539168751375242, 'NDCG*@5': 0.005992113654925065, 'MRR*@5': 0.004836393774233081}
INFO    [05-05 17:08:17] train in BasicTrainer:
duration: 32.24089336395264s
INFO    [05-05 17:08:17] train in BasicTrainer:
epoch: 2
INFO    [05-05 17:08:30] _train_one_epoch in BasicTrainer:
loss = 6.4209640962736945
INFO    [05-05 17:08:48] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-05 17:08:48] validate in BasicTrainer:
{'Recall@10': 0.023602187464183026, 'NDCG@10': 0.011685563166710463, 'MRR@10': 0.008130377370186827, 'Recall@5': 0.012981197119436481, 'NDCG@5': 0.008269159588962793, 'MRR@5': 0.006731572772630237, 'Recall*@10': 0.023602187464183026, 'NDCG*@10': 0.011685563166710463, 'MRR*@10': 0.008130377370186827, 'Recall*@5': 0.012981197119436481, 'NDCG*@5': 0.008269159588962793, 'MRR*@5': 0.006731572772630237}
INFO    [05-05 17:08:48] train in BasicTrainer:
duration: 31.568939924240112s
INFO    [05-05 17:08:48] train in BasicTrainer:
epoch: 3
INFO    [05-05 17:09:01] _train_one_epoch in BasicTrainer:
loss = 6.271696848528726
INFO    [05-05 17:09:20] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-05 17:09:20] validate in BasicTrainer:
{'Recall@10': 0.02973162772303278, 'NDCG@10': 0.014503750950098038, 'MRR@10': 0.00995771341364492, 'Recall@5': 0.016622976907952267, 'NDCG@5': 0.01031582582403313, 'MRR@5': 0.008259149903262203, 'Recall*@10': 0.02973162772303278, 'NDCG*@10': 0.014503750950098038, 'MRR*@10': 0.00995771341364492, 'Recall*@5': 0.016622976907952267, 'NDCG*@5': 0.01031582582403313, 'MRR*@5': 0.008259149903262203}
INFO    [05-05 17:09:20] train in BasicTrainer:
duration: 32.16297101974487s
INFO    [05-05 17:09:20] train in BasicTrainer:
epoch: 4
INFO    [05-05 17:09:33] _train_one_epoch in BasicTrainer:
loss = 6.173133330685752
INFO    [05-05 17:09:51] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-05 17:09:51] validate in BasicTrainer:
{'Recall@10': 0.03391937098719857, 'NDCG@10': 0.01683400749144229, 'MRR@10': 0.011716090058061209, 'Recall@5': 0.019637593830173664, 'NDCG@5': 0.012254356237297708, 'MRR@5': 0.009848827834833752, 'Recall*@10': 0.03391937098719857, 'NDCG*@10': 0.01683400749144229, 'MRR*@10': 0.011716090058061209, 'Recall*@5': 0.019637593830173664, 'NDCG*@5': 0.012254356237297708, 'MRR*@5': 0.009848827834833752}
INFO    [05-05 17:09:51] train in BasicTrainer:
duration: 30.942278385162354s
INFO    [05-05 17:09:51] train in BasicTrainer:
epoch: 5
INFO    [05-05 17:10:05] _train_one_epoch in BasicTrainer:
loss = 6.079873016902378
INFO    [05-05 17:10:23] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-05 17:10:24] validate in BasicTrainer:
{'Recall@10': 0.03916674107313156, 'NDCG@10': 0.019876845688982445, 'MRR@10': 0.014110387048938057, 'Recall@5': 0.022661773826588284, 'NDCG@5': 0.01459075908430598, 'MRR@5': 0.011958623558960178, 'Recall*@10': 0.03916674107313156, 'NDCG*@10': 0.019876845688982445, 'MRR*@10': 0.014110387048938057, 'Recall*@5': 0.022661773826588284, 'NDCG*@5': 0.01459075908430598, 'MRR*@5': 0.011958623558960178}
INFO    [05-05 17:10:24] train in BasicTrainer:
duration: 32.26701521873474s
INFO    [05-05 17:10:24] train in BasicTrainer:
epoch: 6
INFO    [05-05 17:10:37] _train_one_epoch in BasicTrainer:
loss = 6.007534742355347
INFO    [05-05 17:10:55] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-05 17:10:55] validate in BasicTrainer:
{'Recall@10': 0.04110591181299903, 'NDCG@10': 0.021117509766058487, 'MRR@10': 0.015126280740580776, 'Recall@5': 0.024500738152048805, 'NDCG@5': 0.01579519242725589, 'MRR@5': 0.012957252477380362, 'Recall*@10': 0.04110591181299903, 'NDCG*@10': 0.021117509766058487, 'MRR*@10': 0.015126280740580776, 'Recall*@5': 0.024500738152048805, 'NDCG*@5': 0.01579519242725589, 'MRR*@5': 0.012957252477380362}
INFO    [05-05 17:10:55] train in BasicTrainer:
duration: 31.786696672439575s
INFO    [05-05 17:10:55] train in BasicTrainer:
epoch: 7
INFO    [05-05 17:11:08] _train_one_epoch in BasicTrainer:
loss = 5.944140451295035
INFO    [05-05 17:11:27] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-05 17:11:27] validate in BasicTrainer:
{'Recall@10': 0.04507808421145786, 'NDCG@10': 0.022992062975059856, 'MRR@10': 0.01637978284535083, 'Recall@5': 0.026380904018878937, 'NDCG@5': 0.017006491988219997, 'MRR@5': 0.013944482092152943, 'Recall*@10': 0.04507808421145786, 'NDCG*@10': 0.022992062975059856, 'MRR*@10': 0.01637978284535083, 'Recall*@5': 0.026380904018878937, 'NDCG*@5': 0.017006491988219997, 'MRR*@5': 0.013944482092152943}
INFO    [05-05 17:11:27] train in BasicTrainer:
duration: 32.06257605552673s
INFO    [05-05 17:11:27] train in BasicTrainer:
epoch: 8
INFO    [05-05 17:11:40] _train_one_epoch in BasicTrainer:
loss = 5.88483864068985
INFO    [05-05 17:11:58] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-05 17:11:59] validate in BasicTrainer:
{'Recall@10': 0.04645414955236695, 'NDCG@10': 0.02435748753222552, 'MRR@10': 0.017726883715526623, 'Recall@5': 0.02828645215115764, 'NDCG@5': 0.018547183834016323, 'MRR@5': 0.015366405587304722, 'Recall*@10': 0.04645414955236695, 'NDCG*@10': 0.02435748753222552, 'MRR*@10': 0.017726883715526623, 'Recall*@5': 0.02828645215115764, 'NDCG*@5': 0.018547183834016323, 'MRR*@5': 0.015366405587304722}
INFO    [05-05 17:11:59] train in BasicTrainer:
duration: 31.157893419265747s
INFO    [05-05 17:11:59] train in BasicTrainer:
epoch: 9
INFO    [05-05 17:12:12] _train_one_epoch in BasicTrainer:
loss = 5.8301782097135275
INFO    [05-05 17:12:31] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-05 17:12:31] validate in BasicTrainer:
{'Recall@10': 0.04898301173340191, 'NDCG@10': 0.025594178587198257, 'MRR@10': 0.01857840743931857, 'Recall@5': 0.029539455236359077, 'NDCG@5': 0.019348473034121773, 'MRR@5': 0.016025447201999752, 'Recall*@10': 0.04898301173340191, 'NDCG*@10': 0.025594178587198257, 'MRR*@10': 0.01857840743931857, 'Recall*@5': 0.029539455236359077, 'NDCG*@5': 0.019348473034121773, 'MRR*@5': 0.016025447201999752}
INFO    [05-05 17:12:31] train in BasicTrainer:
duration: 32.69681215286255s
INFO    [05-05 17:12:31] train in BasicTrainer:
epoch: 10
INFO    [05-05 17:12:44] _train_one_epoch in BasicTrainer:
loss = 5.779142115797315
INFO    [05-05 17:13:02] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-05 17:13:02] validate in BasicTrainer:
{'Recall@10': 0.05160131339322437, 'NDCG@10': 0.026904200796376575, 'MRR@10': 0.019484001127156345, 'Recall@5': 0.031774734908884224, 'NDCG@5': 0.0205608858642253, 'MRR@5': 0.016905255277048458, 'Recall*@10': 0.05160131339322437, 'NDCG*@10': 0.026904200796376575, 'MRR*@10': 0.019484001127156345, 'Recall*@5': 0.031774734908884224, 'NDCG*@5': 0.0205608858642253, 'MRR*@5': 0.016905255277048458}
INFO    [05-05 17:13:02] train in BasicTrainer:
duration: 31.10189199447632s
INFO    [05-05 17:13:02] train in BasicTrainer:
epoch: 11
INFO    [05-05 17:13:16] _train_one_epoch in BasicTrainer:
loss = 5.729631662368774
INFO    [05-05 17:13:35] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-05 17:13:35] validate in BasicTrainer:
{'Recall@10': 0.05446056818420237, 'NDCG@10': 0.028938070278276096, 'MRR@10': 0.02129129117185419, 'Recall@5': 0.03325605934316462, 'NDCG@5': 0.0221668944101442, 'MRR@5': 0.01854650303721428, 'Recall*@10': 0.05446056818420237, 'NDCG*@10': 0.028938070278276096, 'MRR*@10': 0.02129129117185419, 'Recall*@5': 0.03325605934316462, 'NDCG*@5': 0.0221668944101442, 'MRR*@5': 0.01854650303721428}
INFO    [05-05 17:13:35] train in BasicTrainer:
duration: 32.63963603973389s
INFO    [05-05 17:13:35] train in BasicTrainer:
epoch: 12
INFO    [05-05 17:13:48] _train_one_epoch in BasicTrainer:
loss = 5.682526741709028
INFO    [05-05 17:14:06] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-05 17:14:06] validate in BasicTrainer:
{'Recall@10': 0.056491043757308616, 'NDCG@10': 0.030554108490998096, 'MRR@10': 0.0227611589838158, 'Recall@5': 0.03571141985329715, 'NDCG@5': 0.023912577466531235, 'MRR@5': 0.020065559074282646, 'Recall*@10': 0.056491043757308616, 'NDCG*@10': 0.030554108490998096, 'MRR*@10': 0.0227611589838158, 'Recall*@5': 0.03571141985329715, 'NDCG*@5': 0.023912577466531235, 'MRR*@5': 0.020065559074282646}
INFO    [05-05 17:14:06] train in BasicTrainer:
duration: 31.309523344039917s
INFO    [05-05 17:14:06] train in BasicTrainer:
epoch: 13
INFO    [05-05 17:14:19] _train_one_epoch in BasicTrainer:
loss = 5.6354215656008035
INFO    [05-05 17:14:38] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-05 17:14:38] validate in BasicTrainer:
{'Recall@10': 0.05872698466886173, 'NDCG@10': 0.03130494989454746, 'MRR@10': 0.02306059036742557, 'Recall@5': 0.03661502322012728, 'NDCG@5': 0.024228240617296913, 'MRR@5': 0.02018302408131686, 'Recall*@10': 0.05872698466886173, 'NDCG*@10': 0.03130494989454746, 'MRR*@10': 0.02306059036742557, 'Recall*@5': 0.03661502322012728, 'NDCG*@5': 0.024228240617296913, 'MRR*@5': 0.02018302408131686}
INFO    [05-05 17:14:38] train in BasicTrainer:
duration: 31.914724588394165s
INFO    [05-05 17:14:38] train in BasicTrainer:
epoch: 14
INFO    [05-05 17:14:52] _train_one_epoch in BasicTrainer:
loss = 5.58988082408905
INFO    [05-05 17:15:10] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-05 17:15:11] validate in BasicTrainer:
{'Recall@10': 0.06149427321824161, 'NDCG@10': 0.03317785025997595, 'MRR@10': 0.024671064181761307, 'Recall@5': 0.03823522918603637, 'NDCG@5': 0.025709265165708282, 'MRR@5': 0.02161918038671667, 'Recall*@10': 0.06149427321824161, 'NDCG*@10': 0.03317785025997595, 'MRR*@10': 0.024671064181761307, 'Recall*@5': 0.03823522918603637, 'NDCG*@5': 0.025709265165708282, 'MRR*@5': 0.02161918038671667}
INFO    [05-05 17:15:11] train in BasicTrainer:
duration: 32.39250707626343s
INFO    [05-05 17:15:11] train in BasicTrainer:
epoch: 15
INFO    [05-05 17:15:23] _train_one_epoch in BasicTrainer:
loss = 5.54618136371885
INFO    [05-05 17:15:42] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-05 17:15:43] validate in BasicTrainer:
{'Recall@10': 0.0625824701379646, 'NDCG@10': 0.03420274704694748, 'MRR@10': 0.02565816231071949, 'Recall@5': 0.04038997062227943, 'NDCG@5': 0.027118737386031586, 'MRR@5': 0.02278839491985061, 'Recall*@10': 0.0625824701379646, 'NDCG*@10': 0.03420274704694748, 'MRR*@10': 0.02565816231071949, 'Recall*@5': 0.04038997062227943, 'NDCG*@5': 0.027118737386031586, 'MRR*@5': 0.02278839491985061}
INFO    [05-05 17:15:43] train in BasicTrainer:
duration: 31.966477155685425s
INFO    [05-05 17:15:43] train in BasicTrainer:
epoch: 16
INFO    [05-05 17:15:56] _train_one_epoch in BasicTrainer:
loss = 5.505554897444589
INFO    [05-05 17:16:15] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-05 17:16:15] validate in BasicTrainer:
{'Recall@10': 0.06654892861843109, 'NDCG@10': 0.03624356605789878, 'MRR@10': 0.027129170738837936, 'Recall@5': 0.041452123698863114, 'NDCG@5': 0.028176966207948597, 'MRR@5': 0.023829642683267593, 'Recall*@10': 0.06654892861843109, 'NDCG*@10': 0.03624356605789878, 'MRR*@10': 0.027129170738837936, 'Recall*@5': 0.041452123698863114, 'NDCG*@5': 0.028176966207948597, 'MRR*@5': 0.023829642683267593}
INFO    [05-05 17:16:15] train in BasicTrainer:
duration: 32.17060708999634s
INFO    [05-05 17:16:15] train in BasicTrainer:
epoch: 17
DEBUG   [05-05 17:16:26] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 1109005
DEBUG   [05-05 17:16:26] calculate_loss in loss:
pred max in softmax: 0.9393683075904846, argmax 42084504
DEBUG   [05-05 17:16:26] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 5496451
DEBUG   [05-05 17:16:26] calculate_loss in loss:
pred max in softmax: 0.6336525678634644, argmax 54813108
INFO    [05-05 17:16:28] _train_one_epoch in BasicTrainer:
loss = 5.464258815561022
INFO    [05-05 17:16:47] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-05 17:16:47] validate in BasicTrainer:
{'Recall@10': 0.06723124737089331, 'NDCG@10': 0.037378374487161636, 'MRR@10': 0.02837920222770084, 'Recall@5': 0.043277795341881836, 'NDCG@5': 0.02967961962250146, 'MRR@5': 0.025229133665561676, 'Recall*@10': 0.06723124737089331, 'NDCG*@10': 0.037378374487161636, 'MRR*@10': 0.02837920222770084, 'Recall*@5': 0.043277795341881836, 'NDCG*@5': 0.02967961962250146, 'MRR*@5': 0.025229133665561676}
INFO    [05-05 17:16:47] train in BasicTrainer:
duration: 31.956300258636475s
INFO    [05-05 17:16:47] train in BasicTrainer:
epoch: 18
INFO    [05-05 17:17:00] _train_one_epoch in BasicTrainer:
loss = 5.4267037851469855
INFO    [05-05 17:17:18] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-05 17:17:18] validate in BasicTrainer:
{'Recall@10': 0.06871070678938519, 'NDCG@10': 0.03807645257223736, 'MRR@10': 0.028863471509380775, 'Recall@5': 0.04397154193032871, 'NDCG@5': 0.030154058201746506, 'MRR@5': 0.025639012455940247, 'Recall*@10': 0.06871070678938519, 'NDCG*@10': 0.03807645257223736, 'MRR*@10': 0.028863471509380775, 'Recall*@5': 0.04397154193032871, 'NDCG*@5': 0.030154058201746506, 'MRR*@5': 0.025639012455940247}
INFO    [05-05 17:17:18] train in BasicTrainer:
duration: 31.39997410774231s
INFO    [05-05 17:17:18] train in BasicTrainer:
epoch: 19
INFO    [05-05 17:17:31] _train_one_epoch in BasicTrainer:
loss = 5.391134210995266
INFO    [05-05 17:17:50] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-05 17:17:50] validate in BasicTrainer:
{'Recall@10': 0.06915712492032484, 'NDCG@10': 0.03889394957910885, 'MRR@10': 0.029756438833746044, 'Recall@5': 0.04513576660643925, 'NDCG@5': 0.031160998920148068, 'MRR@5': 0.02658519538288767, 'Recall*@10': 0.06915712492032484, 'NDCG*@10': 0.03889394957910885, 'MRR*@10': 0.029756438833746044, 'Recall*@5': 0.04513576660643925, 'NDCG*@5': 0.031160998920148068, 'MRR*@5': 0.02658519538288767}
INFO    [05-05 17:17:50] train in BasicTrainer:
duration: 31.87978196144104s
INFO    [05-05 17:17:50] train in BasicTrainer:
epoch: 20
INFO    [05-05 17:18:03] _train_one_epoch in BasicTrainer:
loss = 5.35720191683088
INFO    [05-05 17:18:21] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-05 17:18:22] validate in BasicTrainer:
{'Recall@10': 0.07147546925327995, 'NDCG@10': 0.0405623201619495, 'MRR@10': 0.031229349530555985, 'Recall@5': 0.04737489501183683, 'NDCG@5': 0.032846840945157135, 'MRR@5': 0.028090764006430454, 'Recall*@10': 0.07147546925327995, 'NDCG*@10': 0.0405623201619495, 'MRR*@10': 0.031229349530555985, 'Recall*@5': 0.04737489501183683, 'NDCG*@5': 0.032846840945157135, 'MRR*@5': 0.028090764006430454}
INFO    [05-05 17:18:22] train in BasicTrainer:
duration: 31.50368309020996s
INFO    [05-05 17:18:22] train in BasicTrainer:
epoch: 21
INFO    [05-05 17:18:35] _train_one_epoch in BasicTrainer:
loss = 5.323783440249307
INFO    [05-05 17:18:54] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-05 17:18:54] validate in BasicTrainer:
{'Recall@10': 0.07242983715100722, 'NDCG@10': 0.04125176810405471, 'MRR@10': 0.03182698329063979, 'Recall@5': 0.048423093828287994, 'NDCG@5': 0.03352632001042366, 'MRR@5': 0.028660426085645504, 'Recall*@10': 0.07242983715100722, 'NDCG*@10': 0.04125176810405471, 'MRR*@10': 0.03182698329063979, 'Recall*@5': 0.048423093828287994, 'NDCG*@5': 0.03352632001042366, 'MRR*@5': 0.028660426085645504}
INFO    [05-05 17:18:54] train in BasicTrainer:
duration: 32.686776638031006s
INFO    [05-05 17:18:54] train in BasicTrainer:
epoch: 22
INFO    [05-05 17:19:07] _train_one_epoch in BasicTrainer:
loss = 5.29138719184058
INFO    [05-05 17:19:25] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-05 17:19:26] validate in BasicTrainer:
{'Recall@10': 0.0726016800511967, 'NDCG@10': 0.041811520741744476, 'MRR@10': 0.03248048235069622, 'Recall@5': 0.04928615723143925, 'NDCG@5': 0.034303130243312226, 'MRR@5': 0.02940019592642784, 'Recall*@10': 0.0726016800511967, 'NDCG*@10': 0.041811520741744476, 'MRR*@10': 0.03248048235069622, 'Recall*@5': 0.04928615723143925, 'NDCG*@5': 0.034303130243312226, 'MRR*@5': 0.02940019592642784}
INFO    [05-05 17:19:26] train in BasicTrainer:
duration: 31.460155487060547s
INFO    [05-05 17:19:26] train in BasicTrainer:
epoch: 23
INFO    [05-05 17:19:38] _train_one_epoch in BasicTrainer:
loss = 5.261458405426571
INFO    [05-05 17:19:57] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-05 17:19:57] validate in BasicTrainer:
{'Recall@10': 0.07459919425574216, 'NDCG@10': 0.0430224592035467, 'MRR@10': 0.03349938802421093, 'Recall@5': 0.04890379614450715, 'NDCG@5': 0.03472761454230005, 'MRR@5': 0.03008423000574112, 'Recall*@10': 0.07459919425574216, 'NDCG*@10': 0.0430224592035467, 'MRR*@10': 0.03349938802421093, 'Recall*@5': 0.04890379614450715, 'NDCG*@5': 0.03472761454230005, 'MRR*@5': 0.03008423000574112}
INFO    [05-05 17:19:57] train in BasicTrainer:
duration: 31.47666049003601s
INFO    [05-05 17:19:57] train in BasicTrainer:
epoch: 24
INFO    [05-05 17:20:10] _train_one_epoch in BasicTrainer:
loss = 5.233165775026594
INFO    [05-05 17:20:28] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-05 17:20:29] validate in BasicTrainer:
{'Recall@10': 0.07538611035455357, 'NDCG@10': 0.04341935772787441, 'MRR@10': 0.033777641132473946, 'Recall@5': 0.050459944727745926, 'NDCG@5': 0.03543009100989862, 'MRR@5': 0.030521518635478886, 'Recall*@10': 0.07538611035455357, 'NDCG*@10': 0.04341935772787441, 'MRR*@10': 0.033777641132473946, 'Recall*@5': 0.050459944727745926, 'NDCG*@5': 0.03543009100989862, 'MRR*@5': 0.030521518635478886}
INFO    [05-05 17:20:29] train in BasicTrainer:
duration: 31.377103805541992s
INFO    [05-05 17:20:29] train in BasicTrainer:
epoch: 25
INFO    [05-05 17:20:43] _train_one_epoch in BasicTrainer:
loss = 5.207178584166935
INFO    [05-05 17:21:02] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-05 17:21:02] validate in BasicTrainer:
{'Recall@10': 0.0751648254015229, 'NDCG@10': 0.043647237460721626, 'MRR@10': 0.03410643203692003, 'Recall@5': 0.05128619752146981, 'NDCG@5': 0.0359663785519925, 'MRR@5': 0.03096068040891127, 'Recall*@10': 0.0751648254015229, 'NDCG*@10': 0.043647237460721626, 'MRR*@10': 0.03410643203692003, 'Recall*@5': 0.05128619752146981, 'NDCG*@5': 0.0359663785519925, 'MRR*@5': 0.03096068040891127}
INFO    [05-05 17:21:02] train in BasicTrainer:
duration: 33.799676179885864s
INFO    [05-05 17:21:02] train in BasicTrainer:
epoch: 26
INFO    [05-05 17:21:16] _train_one_epoch in BasicTrainer:
loss = 5.179267857755933
INFO    [05-05 17:21:34] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-05 17:21:34] validate in BasicTrainer:
{'Recall@10': 0.07693907144394788, 'NDCG@10': 0.044779649512334305, 'MRR@10': 0.035038076849146324, 'Recall@5': 0.05301671542904594, 'NDCG@5': 0.03708979859948158, 'MRR@5': 0.03189126080410047, 'Recall*@10': 0.07693907144394788, 'NDCG*@10': 0.044779649512334305, 'MRR*@10': 0.035038076849146324, 'Recall*@5': 0.05301671542904594, 'NDCG*@5': 0.03708979859948158, 'MRR*@5': 0.03189126080410047}
INFO    [05-05 17:21:34] train in BasicTrainer:
duration: 31.801364183425903s
INFO    [05-05 17:21:34] train in BasicTrainer:
epoch: 27
INFO    [05-05 17:21:48] _train_one_epoch in BasicTrainer:
loss = 5.153906847749438
INFO    [05-05 17:22:07] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-05 17:22:07] validate in BasicTrainer:
{'Recall@10': 0.07759414274584163, 'NDCG@10': 0.045309342443943024, 'MRR@10': 0.03553734736686403, 'Recall@5': 0.05299957333640619, 'NDCG@5': 0.037432529709555885, 'MRR@5': 0.032330572097138924, 'Recall*@10': 0.07759414274584163, 'NDCG*@10': 0.045309342443943024, 'MRR*@10': 0.03553734736686403, 'Recall*@5': 0.05299957333640619, 'NDCG*@5': 0.037432529709555885, 'MRR*@5': 0.032330572097138924}
INFO    [05-05 17:22:07] train in BasicTrainer:
duration: 32.97654056549072s
INFO    [05-05 17:22:07] train in BasicTrainer:
epoch: 28
INFO    [05-05 17:22:20] _train_one_epoch in BasicTrainer:
loss = 5.129590153694153
INFO    [05-05 17:22:39] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-05 17:22:39] validate in BasicTrainer:
{'Recall@10': 0.07824855297803879, 'NDCG@10': 0.04561832614920356, 'MRR@10': 0.035739891908385536, 'Recall@5': 0.05327162248167125, 'NDCG@5': 0.03758919442241842, 'MRR@5': 0.03245458464053544, 'Recall*@10': 0.07824855297803879, 'NDCG*@10': 0.04561832614920356, 'MRR*@10': 0.035739891908385536, 'Recall*@5': 0.05327162248167125, 'NDCG*@5': 0.03758919442241842, 'MRR*@5': 0.03245458464053544}
INFO    [05-05 17:22:39] train in BasicTrainer:
duration: 31.626442909240723s
INFO    [05-05 17:22:39] train in BasicTrainer:
epoch: 29
INFO    [05-05 17:22:52] _train_one_epoch in BasicTrainer:
loss = 5.106992747102465
INFO    [05-05 17:23:12] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-05 17:23:12] validate in BasicTrainer:
{'Recall@10': 0.07976283810355446, 'NDCG@10': 0.046512952243739906, 'MRR@10': 0.036438958888704125, 'Recall@5': 0.0538987856019627, 'NDCG@5': 0.03818358548662879, 'MRR@5': 0.033021651208400726, 'Recall*@10': 0.07976283810355446, 'NDCG*@10': 0.046512952243739906, 'MRR*@10': 0.036438958888704125, 'Recall*@5': 0.0538987856019627, 'NDCG*@5': 0.03818358548662879, 'MRR*@5': 0.033021651208400726}
INFO    [05-05 17:23:12] train in BasicTrainer:
duration: 32.97550892829895s
INFO    [05-05 17:23:12] train in BasicTrainer:
epoch: 30
INFO    [05-05 17:23:24] _train_one_epoch in BasicTrainer:
loss = 5.081683925219944
INFO    [05-05 17:23:43] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [05-05 17:23:43] validate in BasicTrainer:
{'Recall@10': 0.0808497125452215, 'NDCG@10': 0.04702983559532599, 'MRR@10': 0.03679757497527383, 'Recall@5': 0.054932368749921974, 'NDCG@5': 0.03870787302201444, 'MRR@5': 0.03339806588535959, 'Recall*@10': 0.0808497125452215, 'NDCG*@10': 0.04702983559532599, 'MRR*@10': 0.03679757497527383, 'Recall*@5': 0.054932368749921974, 'NDCG*@5': 0.03870787302201444, 'MRR*@5': 0.03339806588535959}
INFO    [05-05 17:23:43] train in BasicTrainer:
duration: 31.634831190109253s
INFO    [05-05 17:23:43] train in BasicTrainer:
epoch: 31
INFO    [05-05 17:23:57] _train_one_epoch in BasicTrainer:
loss = 5.059895983764103
INFO    [05-05 17:24:15] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-05 17:24:15] validate in BasicTrainer:
{'Recall@10': 0.08077994124455885, 'NDCG@10': 0.04758660292083567, 'MRR@10': 0.037518306211991745, 'Recall@5': 0.05558172647248615, 'NDCG@5': 0.03947112302888523, 'MRR@5': 0.03418843194165013, 'Recall*@10': 0.08077994124455885, 'NDCG*@10': 0.04758660292083567, 'MRR*@10': 0.037518306211991745, 'Recall*@5': 0.05558172647248615, 'NDCG*@5': 0.03947112302888523, 'MRR*@5': 0.03418843194165013}
INFO    [05-05 17:24:15] train in BasicTrainer:
duration: 31.753958702087402s
INFO    [05-05 17:24:15] train in BasicTrainer:
epoch: 32
INFO    [05-05 17:24:28] _train_one_epoch in BasicTrainer:
loss = 5.04021544115884
INFO    [05-05 17:24:47] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-05 17:24:47] validate in BasicTrainer:
{'Recall@10': 0.0819733969189904, 'NDCG@10': 0.048220483755523506, 'MRR@10': 0.03797586770220236, 'Recall@5': 0.0566115795888684, 'NDCG@5': 0.04006230627948588, 'MRR@5': 0.03463363139466806, 'Recall*@10': 0.0819733969189904, 'NDCG*@10': 0.048220483755523506, 'MRR*@10': 0.03797586770220236, 'Recall*@5': 0.0566115795888684, 'NDCG*@5': 0.04006230627948588, 'MRR*@5': 0.03463363139466806}
INFO    [05-05 17:24:47] train in BasicTrainer:
duration: 32.013996839523315s
INFO    [05-05 17:24:47] train in BasicTrainer:
epoch: 33
INFO    [05-05 17:25:00] _train_one_epoch in BasicTrainer:
loss = 5.02070198740278
INFO    [05-05 17:25:18] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-05 17:25:18] validate in BasicTrainer:
{'Recall@10': 0.08281613073565743, 'NDCG@10': 0.04892574995756149, 'MRR@10': 0.03862760588526726, 'Recall@5': 0.057770751755345955, 'NDCG@5': 0.0408768274567344, 'MRR@5': 0.035334843803535805, 'Recall*@10': 0.08281613073565743, 'NDCG*@10': 0.04892574995756149, 'MRR*@10': 0.03862760588526726, 'Recall*@5': 0.057770751755345955, 'NDCG*@5': 0.0408768274567344, 'MRR*@5': 0.035334843803535805}
INFO    [05-05 17:25:18] train in BasicTrainer:
duration: 31.149762868881226s
INFO    [05-05 17:25:18] train in BasicTrainer:
epoch: 34
INFO    [05-05 17:25:31] _train_one_epoch in BasicTrainer:
loss = 5.0006795184952875
INFO    [05-05 17:25:50] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-05 17:25:50] validate in BasicTrainer:
{'Recall@10': 0.08341472324999896, 'NDCG@10': 0.04945467920465903, 'MRR@10': 0.039155368439175865, 'Recall@5': 0.05762615596706217, 'NDCG@5': 0.04115897857330062, 'MRR@5': 0.035756690935655075, 'Recall*@10': 0.08341472324999896, 'NDCG*@10': 0.04945467920465903, 'MRR*@10': 0.039155368439175865, 'Recall*@5': 0.05762615596706217, 'NDCG*@5': 0.04115897857330062, 'MRR*@5': 0.035756690935655075}
INFO    [05-05 17:25:50] train in BasicTrainer:
duration: 31.916237115859985s
INFO    [05-05 17:25:50] train in BasicTrainer:
epoch: 35
DEBUG   [05-05 17:25:59] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 5997301
DEBUG   [05-05 17:25:59] calculate_loss in loss:
pred max in softmax: 0.7014694213867188, argmax 46870830
DEBUG   [05-05 17:26:00] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 27634021
DEBUG   [05-05 17:26:00] calculate_loss in loss:
pred max in softmax: 0.9159942269325256, argmax 12537041
INFO    [05-05 17:26:03] _train_one_epoch in BasicTrainer:
loss = 4.980416664055416
INFO    [05-05 17:26:21] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-05 17:26:22] validate in BasicTrainer:
{'Recall@10': 0.08380159464749423, 'NDCG@10': 0.04959377612579952, 'MRR@10': 0.0391962162472985, 'Recall@5': 0.05839472670446743, 'NDCG@5': 0.04141624136404558, 'MRR@5': 0.035842625254934486, 'Recall*@10': 0.08380159464749423, 'NDCG*@10': 0.04959377612579952, 'MRR*@10': 0.0391962162472985, 'Recall*@5': 0.05839472670446743, 'NDCG*@5': 0.04141624136404558, 'MRR*@5': 0.035842625254934486}
INFO    [05-05 17:26:22] train in BasicTrainer:
duration: 31.48551654815674s
INFO    [05-05 17:26:22] train in BasicTrainer:
epoch: 36
INFO    [05-05 17:26:36] _train_one_epoch in BasicTrainer:
loss = 4.961845202105386
INFO    [05-05 17:26:55] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-05 17:26:55] validate in BasicTrainer:
{'Recall@10': 0.08445853130383925, 'NDCG@10': 0.050478381189433014, 'MRR@10': 0.04014181785962798, 'Recall@5': 0.05924251303076744, 'NDCG@5': 0.04236100072210485, 'MRR@5': 0.03681351786310023, 'Recall*@10': 0.08445853130383925, 'NDCG*@10': 0.050478381189433014, 'MRR*@10': 0.04014181785962798, 'Recall*@5': 0.05924251303076744, 'NDCG*@5': 0.04236100072210485, 'MRR*@5': 0.03681351786310023}
INFO    [05-05 17:26:55] train in BasicTrainer:
duration: 33.18414044380188s
INFO    [05-05 17:26:55] train in BasicTrainer:
epoch: 37
INFO    [05-05 17:27:08] _train_one_epoch in BasicTrainer:
loss = 4.9463310071400235
INFO    [05-05 17:27:26] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [05-05 17:27:27] validate in BasicTrainer:
{'Recall@10': 0.0854616795073856, 'NDCG@10': 0.05093445764346556, 'MRR@10': 0.04043957286260345, 'Recall@5': 0.060479696840047836, 'NDCG@5': 0.042935344983230934, 'MRR@5': 0.03718419406901707, 'Recall*@10': 0.0854616795073856, 'NDCG*@10': 0.05093445764346556, 'MRR*@10': 0.04043957286260345, 'Recall*@5': 0.060479696840047836, 'NDCG*@5': 0.042935344983230934, 'MRR*@5': 0.03718419406901707}
INFO    [05-05 17:27:27] train in BasicTrainer:
duration: 31.83612823486328s
INFO    [05-05 17:27:27] train in BasicTrainer:
epoch: 38
INFO    [05-05 17:27:40] _train_one_epoch in BasicTrainer:
loss = 4.9279193963323324
INFO    [05-05 17:27:59] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-05 17:27:59] validate in BasicTrainer:
{'Recall@10': 0.08653910999948328, 'NDCG@10': 0.05143706128001213, 'MRR@10': 0.04077580537308346, 'Recall@5': 0.06051650711081245, 'NDCG@5': 0.043094989928332245, 'MRR@5': 0.03737513111396269, 'Recall*@10': 0.08653910999948328, 'NDCG*@10': 0.05143706128001213, 'MRR*@10': 0.04077580537308346, 'Recall*@5': 0.06051650711081245, 'NDCG*@5': 0.043094989928332245, 'MRR*@5': 0.03737513111396269}
INFO    [05-05 17:27:59] train in BasicTrainer:
duration: 32.5515615940094s
INFO    [05-05 17:27:59] train in BasicTrainer:
epoch: 39
INFO    [05-05 17:28:12] _train_one_epoch in BasicTrainer:
loss = 4.910755906786237
INFO    [05-05 17:28:30] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [05-05 17:28:31] validate in BasicTrainer:
{'Recall@10': 0.08661898631941188, 'NDCG@10': 0.05205047841776501, 'MRR@10': 0.04152247580614957, 'Recall@5': 0.06112652779980139, 'NDCG@5': 0.04384202577851035, 'MRR@5': 0.03815498236905445, 'Recall*@10': 0.08661898631941188, 'NDCG*@10': 0.05205047841776501, 'MRR*@10': 0.04152247580614957, 'Recall*@5': 0.06112652779980139, 'NDCG*@5': 0.04384202577851035, 'MRR*@5': 0.03815498236905445}
INFO    [05-05 17:28:31] train in BasicTrainer:
duration: 31.377636194229126s
INFO    [05-05 17:28:31] train in BasicTrainer:
epoch: 40
INFO    [05-05 17:28:43] _train_one_epoch in BasicTrainer:
loss = 4.893311628273556
INFO    [05-05 17:29:02] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [05-05 17:29:03] validate in BasicTrainer:
{'Recall@10': 0.08746238120577553, 'NDCG@10': 0.05249372971328822, 'MRR@10': 0.04187843169678341, 'Recall@5': 0.06142901188947938, 'NDCG@5': 0.04414366388862783, 'MRR@5': 0.03847279128703204, 'Recall*@10': 0.08746238120577553, 'NDCG*@10': 0.05249372971328822, 'MRR*@10': 0.04187843169678341, 'Recall*@5': 0.06142901188947938, 'NDCG*@5': 0.04414366388862783, 'MRR*@5': 0.03847279128703204}
INFO    [05-05 17:29:03] train in BasicTrainer:
duration: 31.95896005630493s
INFO    [05-05 17:29:03] train in BasicTrainer:
epoch: 41
INFO    [05-05 17:29:15] _train_one_epoch in BasicTrainer:
loss = 4.879652747086117
INFO    [05-05 17:29:35] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-05 17:29:35] validate in BasicTrainer:
{'Recall@10': 0.08772805536335165, 'NDCG@10': 0.05281068113717166, 'MRR@10': 0.04217854345386678, 'Recall@5': 0.06224955110387369, 'NDCG@5': 0.04461746324192394, 'MRR@5': 0.03882302005182613, 'Recall*@10': 0.08772805536335165, 'NDCG*@10': 0.05281068113717166, 'MRR*@10': 0.04217854345386678, 'Recall*@5': 0.06224955110387369, 'NDCG*@5': 0.04461746324192394, 'MRR*@5': 0.03882302005182613}
INFO    [05-05 17:29:35] train in BasicTrainer:
duration: 32.599347829818726s
INFO    [05-05 17:29:35] train in BasicTrainer:
epoch: 42
INFO    [05-05 17:29:49] _train_one_epoch in BasicTrainer:
loss = 4.8666291662624905
INFO    [05-05 17:30:08] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-05 17:30:08] validate in BasicTrainer:
{'Recall@10': 0.08819985592907126, 'NDCG@10': 0.05316888236186721, 'MRR@10': 0.04249441454356367, 'Recall@5': 0.062252738597718155, 'NDCG@5': 0.04477830569852482, 'MRR@5': 0.0390309715135531, 'Recall*@10': 0.08819985592907126, 'NDCG*@10': 0.05316888236186721, 'MRR*@10': 0.04249441454356367, 'Recall*@5': 0.062252738597718155, 'NDCG*@5': 0.04477830569852482, 'MRR*@5': 0.0390309715135531}
INFO    [05-05 17:30:08] train in BasicTrainer:
duration: 32.57348275184631s
INFO    [05-05 17:30:08] train in BasicTrainer:
epoch: 43
INFO    [05-05 17:30:21] _train_one_epoch in BasicTrainer:
loss = 4.849189170769283
INFO    [05-05 17:30:39] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [05-05 17:30:39] validate in BasicTrainer:
{'Recall@10': 0.08828039399602196, 'NDCG@10': 0.05341363596645268, 'MRR@10': 0.04279474270614711, 'Recall@5': 0.06297625906088135, 'NDCG@5': 0.04529458792372183, 'MRR@5': 0.039481814273379066, 'Recall*@10': 0.08828039399602196, 'NDCG*@10': 0.05341363596645268, 'MRR*@10': 0.04279474270614711, 'Recall*@5': 0.06297625906088135, 'NDCG*@5': 0.04529458792372183, 'MRR*@5': 0.039481814273379066}
INFO    [05-05 17:30:39] train in BasicTrainer:
duration: 31.516244411468506s
INFO    [05-05 17:30:39] train in BasicTrainer:
epoch: 44
INFO    [05-05 17:30:52] _train_one_epoch in BasicTrainer:
loss = 4.8319743020193915
INFO    [05-05 17:31:11] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-05 17:31:11] validate in BasicTrainer:
{'Recall@10': 0.08839455450123007, 'NDCG@10': 0.05408023738048293, 'MRR@10': 0.04362521252848885, 'Recall@5': 0.06402193145318465, 'NDCG@5': 0.04625256325710903, 'MRR@5': 0.040426384657621384, 'Recall*@10': 0.08839455450123007, 'NDCG*@10': 0.05408023738048293, 'MRR*@10': 0.04362521252848885, 'Recall*@5': 0.06402193145318465, 'NDCG*@5': 0.04625256325710903, 'MRR*@5': 0.040426384657621384}
INFO    [05-05 17:31:11] train in BasicTrainer:
duration: 31.7726309299469s
INFO    [05-05 17:31:11] train in BasicTrainer:
epoch: 45
INFO    [05-05 17:31:24] _train_one_epoch in BasicTrainer:
loss = 4.819232191358294
INFO    [05-05 17:31:42] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-05 17:31:42] validate in BasicTrainer:
{'Recall@10': 0.0891649905930866, 'NDCG@10': 0.0545388866554607, 'MRR@10': 0.044002845883369446, 'Recall@5': 0.06357485191388564, 'NDCG@5': 0.046317487277767876, 'MRR@5': 0.04064133966510946, 'Recall*@10': 0.0891649905930866, 'NDCG*@10': 0.0545388866554607, 'MRR*@10': 0.044002845883369446, 'Recall*@5': 0.06357485191388564, 'NDCG*@5': 0.046317487277767876, 'MRR*@5': 0.04064133966510946}
INFO    [05-05 17:31:42] train in BasicTrainer:
duration: 31.09005308151245s
INFO    [05-05 17:31:42] train in BasicTrainer:
epoch: 46
INFO    [05-05 17:31:55] _train_one_epoch in BasicTrainer:
loss = 4.806437960692814
INFO    [05-05 17:32:14] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-05 17:32:14] validate in BasicTrainer:
{'Recall@10': 0.08953724598342722, 'NDCG@10': 0.054928145964037285, 'MRR@10': 0.04438124969601631, 'Recall@5': 0.06488180702382867, 'NDCG@5': 0.047006489539688286, 'MRR@5': 0.04114179177717729, 'Recall*@10': 0.08953724598342722, 'NDCG*@10': 0.054928145964037285, 'MRR*@10': 0.04438124969601631, 'Recall*@5': 0.06488180702382867, 'NDCG*@5': 0.047006489539688286, 'MRR*@5': 0.04114179177717729}
INFO    [05-05 17:32:14] train in BasicTrainer:
duration: 31.93794322013855s
INFO    [05-05 17:32:14] train in BasicTrainer:
epoch: 47
INFO    [05-05 17:32:27] _train_one_epoch in BasicTrainer:
loss = 4.790561505726406
INFO    [05-05 17:32:45] log in loggers:
Update Best NDCG@10 Model at 47
INFO    [05-05 17:32:45] validate in BasicTrainer:
{'Recall@10': 0.09090693633664738, 'NDCG@10': 0.0553448000414805, 'MRR@10': 0.04453044113787738, 'Recall@5': 0.06505364992401817, 'NDCG@5': 0.04706056517633525, 'MRR@5': 0.04115594517100941, 'Recall*@10': 0.09090693633664738, 'NDCG*@10': 0.0553448000414805, 'MRR*@10': 0.04453044113787738, 'Recall*@5': 0.06505364992401817, 'NDCG*@5': 0.04706056517633525, 'MRR*@5': 0.04115594517100941}
INFO    [05-05 17:32:45] train in BasicTrainer:
duration: 30.933882236480713s
INFO    [05-05 17:32:45] train in BasicTrainer:
epoch: 48
INFO    [05-05 17:32:58] _train_one_epoch in BasicTrainer:
loss = 4.779724385057177
INFO    [05-05 17:33:17] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-05 17:33:17] validate in BasicTrainer:
{'Recall@10': 0.09104395251382481, 'NDCG@10': 0.056102619591084396, 'MRR@10': 0.04545773972164501, 'Recall@5': 0.06582474708557129, 'NDCG@5': 0.047989885238083924, 'MRR@5': 0.04213429716500369, 'Recall*@10': 0.09104395251382481, 'NDCG*@10': 0.056102619591084396, 'MRR*@10': 0.04545773972164501, 'Recall*@5': 0.06582474708557129, 'NDCG*@5': 0.047989885238083924, 'MRR*@5': 0.04213429716500369}
INFO    [05-05 17:33:17] train in BasicTrainer:
duration: 32.12048387527466s
INFO    [05-05 17:33:17] train in BasicTrainer:
epoch: 49
INFO    [05-05 17:33:30] _train_one_epoch in BasicTrainer:
loss = 4.770966410636902
INFO    [05-05 17:33:48] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-05 17:33:48] validate in BasicTrainer:
{'Recall@10': 0.0915315726941282, 'NDCG@10': 0.05628487772562287, 'MRR@10': 0.045575098557905716, 'Recall@5': 0.06537195362827995, 'NDCG@5': 0.047869760881770744, 'MRR@5': 0.04212784699418328, 'Recall*@10': 0.0915315726941282, 'NDCG*@10': 0.05628487772562287, 'MRR*@10': 0.045575098557905716, 'Recall*@5': 0.06537195362827995, 'NDCG*@5': 0.047869760881770744, 'MRR*@5': 0.04212784699418328}
INFO    [05-05 17:33:48] train in BasicTrainer:
duration: 31.183011054992676s
INFO    [05-05 17:33:48] train in BasicTrainer:
epoch: 50
INFO    [05-05 17:34:01] _train_one_epoch in BasicTrainer:
loss = 4.755850272519248
INFO    [05-05 17:34:21] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-05 17:34:21] validate in BasicTrainer:
{'Recall@10': 0.09249099344015121, 'NDCG@10': 0.05666991424831477, 'MRR@10': 0.04575585912574421, 'Recall@5': 0.06632126867771149, 'NDCG@5': 0.04822367802262306, 'MRR@5': 0.04227966679768129, 'Recall*@10': 0.09249099344015121, 'NDCG*@10': 0.05666991424831477, 'MRR*@10': 0.04575585912574421, 'Recall*@5': 0.06632126867771149, 'NDCG*@5': 0.04822367802262306, 'MRR*@5': 0.04227966679768129}
INFO    [05-05 17:34:21] train in BasicTrainer:
duration: 32.65029191970825s
INFO    [05-05 17:34:21] train in BasicTrainer:
epoch: 51
INFO    [05-05 17:34:34] _train_one_epoch in BasicTrainer:
loss = 4.742360072476523
INFO    [05-05 17:34:52] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [05-05 17:34:52] validate in BasicTrainer:
{'Recall@10': 0.09325132383541627, 'NDCG@10': 0.05726220289414579, 'MRR@10': 0.04630613699555397, 'Recall@5': 0.06703402237458662, 'NDCG@5': 0.048826664008877495, 'MRR@5': 0.04284959184852513, 'Recall*@10': 0.09325132383541627, 'NDCG*@10': 0.05726220289414579, 'MRR*@10': 0.04630613699555397, 'Recall*@5': 0.06703402237458662, 'NDCG*@5': 0.048826664008877495, 'MRR*@5': 0.04284959184852513}
INFO    [05-05 17:34:52] train in BasicTrainer:
duration: 31.08048152923584s
INFO    [05-05 17:34:52] train in BasicTrainer:
epoch: 52
INFO    [05-05 17:35:06] _train_one_epoch in BasicTrainer:
loss = 4.732510941369193
INFO    [05-05 17:35:25] log in loggers:
Update Best NDCG@10 Model at 52
INFO    [05-05 17:35:25] validate in BasicTrainer:
{'Recall@10': 0.09303256530653346, 'NDCG@10': 0.057413342662832954, 'MRR@10': 0.04657407951625911, 'Recall@5': 0.06747286157174544, 'NDCG@5': 0.049232804639772934, 'MRR@5': 0.04324754530733282, 'Recall*@10': 0.09303256530653346, 'NDCG*@10': 0.057413342662832954, 'MRR*@10': 0.04657407951625911, 'Recall*@5': 0.06747286157174544, 'NDCG*@5': 0.049232804639772934, 'MRR*@5': 0.04324754530733282}
INFO    [05-05 17:35:25] train in BasicTrainer:
duration: 33.17623519897461s
INFO    [05-05 17:35:25] train in BasicTrainer:
epoch: 53
DEBUG   [05-05 17:35:33] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 6798661
DEBUG   [05-05 17:35:33] calculate_loss in loss:
pred max in softmax: 0.7737320065498352, argmax 52993019
DEBUG   [05-05 17:35:33] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 2511385
DEBUG   [05-05 17:35:33] calculate_loss in loss:
pred max in softmax: 0.6789988279342651, argmax 37504710
INFO    [05-05 17:35:38] _train_one_epoch in BasicTrainer:
loss = 4.722217525754656
INFO    [05-05 17:35:56] log in loggers:
Update Best NDCG@10 Model at 53
INFO    [05-05 17:35:57] validate in BasicTrainer:
{'Recall@10': 0.0931511175903407, 'NDCG@10': 0.057516169141639366, 'MRR@10': 0.046647265892137184, 'Recall@5': 0.06766118515621532, 'NDCG@5': 0.04932877793908119, 'MRR@5': 0.043300790204243225, 'Recall*@10': 0.0931511175903407, 'NDCG*@10': 0.057516169141639366, 'MRR*@10': 0.046647265892137184, 'Recall*@5': 0.06766118515621532, 'NDCG*@5': 0.04932877793908119, 'MRR*@5': 0.043300790204243225}
INFO    [05-05 17:35:57] train in BasicTrainer:
duration: 31.397105932235718s
INFO    [05-05 17:35:57] train in BasicTrainer:
epoch: 54
INFO    [05-05 17:36:10] _train_one_epoch in BasicTrainer:
loss = 4.7116634249687195
INFO    [05-05 17:36:29] log in loggers:
Update Best NDCG@10 Model at 54
INFO    [05-05 17:36:29] validate in BasicTrainer:
{'Recall@10': 0.09401923350312492, 'NDCG@10': 0.05821875787594102, 'MRR@10': 0.04729802703315562, 'Recall@5': 0.06832449680024927, 'NDCG@5': 0.049972869117151604, 'MRR@5': 0.043931378559632736, 'Recall*@10': 0.09401923350312492, 'NDCG*@10': 0.05821875787594102, 'MRR*@10': 0.04729802703315562, 'Recall*@5': 0.06832449680024927, 'NDCG*@5': 0.049972869117151604, 'MRR*@5': 0.043931378559632736}
INFO    [05-05 17:36:29] train in BasicTrainer:
duration: 32.732743978500366s
INFO    [05-05 17:36:29] train in BasicTrainer:
epoch: 55
INFO    [05-05 17:36:42] _train_one_epoch in BasicTrainer:
loss = 4.702578570161547
INFO    [05-05 17:37:00] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [05-05 17:37:00] validate in BasicTrainer:
{'Recall@10': 0.09506237980994311, 'NDCG@10': 0.058469240977005524, 'MRR@10': 0.04729668558998541, 'Recall@5': 0.0687036697160114, 'NDCG@5': 0.04999687150120735, 'MRR@5': 0.04383012584664605, 'Recall*@10': 0.09506237980994311, 'NDCG*@10': 0.058469240977005524, 'MRR*@10': 0.04729668558998541, 'Recall*@5': 0.0687036697160114, 'NDCG*@5': 0.04999687150120735, 'MRR*@5': 0.04383012584664605}
INFO    [05-05 17:37:00] train in BasicTrainer:
duration: 31.157093048095703s
INFO    [05-05 17:37:00] train in BasicTrainer:
epoch: 56
INFO    [05-05 17:37:14] _train_one_epoch in BasicTrainer:
loss = 4.690679260662624
INFO    [05-05 17:37:33] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-05 17:37:33] validate in BasicTrainer:
{'Recall@10': 0.09492415934801102, 'NDCG@10': 0.05892005664381114, 'MRR@10': 0.0479009903290055, 'Recall@5': 0.0697138553315943, 'NDCG@5': 0.05079462548548525, 'MRR@5': 0.04456349089741707, 'Recall*@10': 0.09492415934801102, 'NDCG*@10': 0.05892005664381114, 'MRR*@10': 0.0479009903290055, 'Recall*@5': 0.0697138553315943, 'NDCG*@5': 0.05079462548548525, 'MRR*@5': 0.04456349089741707}
INFO    [05-05 17:37:33] train in BasicTrainer:
duration: 32.58897876739502s
INFO    [05-05 17:37:33] train in BasicTrainer:
epoch: 57
INFO    [05-05 17:37:46] _train_one_epoch in BasicTrainer:
loss = 4.682301751204899
INFO    [05-05 17:38:04] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-05 17:38:04] validate in BasicTrainer:
{'Recall@10': 0.09552275186235254, 'NDCG@10': 0.059311831200664696, 'MRR@10': 0.0482479797845537, 'Recall@5': 0.06982416659593582, 'NDCG@5': 0.05105280605229465, 'MRR@5': 0.04486998644742099, 'Recall*@10': 0.09552275186235254, 'NDCG*@10': 0.059311831200664696, 'MRR*@10': 0.0482479797845537, 'Recall*@5': 0.06982416659593582, 'NDCG*@5': 0.05105280605229465, 'MRR*@5': 0.04486998644742099}
INFO    [05-05 17:38:04] train in BasicTrainer:
duration: 31.0507652759552s
INFO    [05-05 17:38:04] train in BasicTrainer:
epoch: 58
INFO    [05-05 17:38:18] _train_one_epoch in BasicTrainer:
loss = 4.675448068550655
INFO    [05-05 17:38:37] log in loggers:
Update Best NDCG@10 Model at 58
INFO    [05-05 17:38:37] validate in BasicTrainer:
{'Recall@10': 0.09604970839890567, 'NDCG@10': 0.0595046186989004, 'MRR@10': 0.04837215048345653, 'Recall@5': 0.0701184103434736, 'NDCG@5': 0.0511817681518468, 'MRR@5': 0.04497393457726999, 'Recall*@10': 0.09604970839890567, 'NDCG*@10': 0.0595046186989004, 'MRR*@10': 0.04837215048345653, 'Recall*@5': 0.0701184103434736, 'NDCG*@5': 0.0511817681518468, 'MRR*@5': 0.04497393457726999}
INFO    [05-05 17:38:37] train in BasicTrainer:
duration: 32.93371891975403s
INFO    [05-05 17:38:37] train in BasicTrainer:
epoch: 59
INFO    [05-05 17:38:50] _train_one_epoch in BasicTrainer:
loss = 4.663079048906054
INFO    [05-05 17:39:09] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [05-05 17:39:09] validate in BasicTrainer:
{'Recall@10': 0.09616002034057271, 'NDCG@10': 0.059616406532851135, 'MRR@10': 0.048451528291810646, 'Recall@5': 0.07016785239631479, 'NDCG@5': 0.05124201693318107, 'MRR@5': 0.0450128089975227, 'Recall*@10': 0.09616002034057271, 'NDCG*@10': 0.059616406532851135, 'MRR*@10': 0.048451528291810646, 'Recall*@5': 0.07016785239631479, 'NDCG*@5': 0.05124201693318107, 'MRR*@5': 0.0450128089975227}
INFO    [05-05 17:39:09] train in BasicTrainer:
duration: 31.97209596633911s
INFO    [05-05 17:39:09] close_training in BasicTrainer:
finished training
DEBUG   [05-05 17:39:09] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3361 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-05 17:39:09] run_routine in Routine:
Finished training, Start final validation
INFO    [05-05 17:39:09] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-05 17:39:09] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 17:39:09] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 17:39:27] validate in BasicTrainer:
{'Recall@10': 0.09616002034057271, 'NDCG@10': 0.059616406532851135, 'MRR@10': 0.048451528291810646, 'Recall@5': 0.07016785239631479, 'NDCG@5': 0.05124201693318107, 'MRR@5': 0.0450128089975227, 'Recall*@10': 0.09616002034057271, 'NDCG*@10': 0.059616406532851135, 'MRR*@10': 0.048451528291810646, 'Recall*@5': 0.07016785239631479, 'NDCG*@5': 0.05124201693318107, 'MRR*@5': 0.0450128089975227}
INFO    [05-05 17:39:27] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.09616002034057271, 'NDCG@10': 0.059616406532851135, 'MRR@10': 0.048451528291810646, 'Recall@5': 0.07016785239631479, 'NDCG@5': 0.05124201693318107, 'MRR@5': 0.0450128089975227, 'Recall*@10': 0.09616002034057271, 'NDCG*@10': 0.059616406532851135, 'MRR*@10': 0.048451528291810646, 'Recall*@5': 0.07016785239631479, 'NDCG*@5': 0.05124201693318107, 'MRR*@5': 0.0450128089975227}
INFO    [05-05 17:39:27] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-05 17:39:27] test in BasicTrainer:
Test model on test set!
INFO    [05-05 17:39:27] test_with_given_state_path in BasicTrainer:
Loading model params from ___yelp_soft_2022/pop_narm-T-6.0-al-0.5_05-05_17:06_t8/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-05 17:39:27] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 17:39:27] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 17:39:27] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-05 17:39:46] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.07970635999332774, 'NDCG@10': 0.0475360094146295, 'MRR@10': 0.037758368998765945, 'Recall@5': 0.0561061565848914, 'NDCG@5': 0.03994945301250978, 'MRR@5': 0.03465369174426252, 'Recall*@10': 0.07970635999332774, 'NDCG*@10': 0.0475360094146295, 'MRR*@10': 0.037758368998765945, 'Recall*@5': 0.0561061565848914, 'NDCG*@5': 0.03994945301250978, 'MRR*@5': 0.03465369174426252}
INFO    [05-05 17:39:46] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.07970635999332774, 'NDCG@10': 0.0475360094146295, 'MRR@10': 0.037758368998765945, 'Recall@5': 0.0561061565848914, 'NDCG@5': 0.03994945301250978, 'MRR@5': 0.03465369174426252, 'Recall*@10': 0.07970635999332774, 'NDCG*@10': 0.0475360094146295, 'MRR*@10': 0.037758368998765945, 'Recall*@5': 0.0561061565848914, 'NDCG*@5': 0.03994945301250978, 'MRR*@5': 0.03465369174426252}
