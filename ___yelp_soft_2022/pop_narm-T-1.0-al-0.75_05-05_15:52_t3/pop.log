INFO    [05-05 15:52:49] setup_train in utils:
{
    "experiment_dir": "___yelp_soft_2022",
    "experiment_description": "pop",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "yelp.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "alpha": 0.75,
    "T": 1.0,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.yelp/narm/config_distill.json",
    "task_id": 3,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "dvae_alpha": 0.5,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-05 15:52:49] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-05 15:52:49] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/yelp-5-5.pkl
INFO    [05-05 15:52:50] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-05 15:52:50] _check_dataset_cache in utils:
correct.
INFO    [05-05 15:52:50] __init__ in NextItemDataloader:
there are 20033 items in this dataset, 43947 users, padding_first? False
DEBUG   [05-05 15:52:57] generate_model in utils:
model_code_list=['pop']
INFO    [05-05 15:52:57] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-05 15:52:57] load_model_config in utils:
{}
WARNING [05-05 15:53:03] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.75_05-05_15:52_t3/teacher_pop_logs does not exist! Create one.
WARNING [05-05 15:53:03] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.75_05-05_15:52_t3/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-05 15:53:03] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.75_05-05_15:52_t3/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-05 15:53:03] get_path in utils:
Path is None
WARNING [05-05 15:53:03] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 15:53:03] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-05 15:53:03] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 15:53:03] __init__ in BasicTrainer:
229376 iter per epoch
DEBUG   [05-05 15:53:03] generate_model in utils:
model_code_list=['narm']
INFO    [05-05 15:53:03] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-05 15:53:03] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-05 15:53:06] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.75_05-05_15:52_t3/student_narm_logs does not exist! Create one.
WARNING [05-05 15:53:06] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.75_05-05_15:52_t3/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-05 15:53:06] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.75_05-05_15:52_t3/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-05 15:53:06] get_path in utils:
Path is None
WARNING [05-05 15:53:06] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 15:53:06] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(20034, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-05 15:53:06] assert_model_device in utils:
model student_narm has 5.3603515625 MB params.
INFO    [05-05 15:53:06] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 15:53:06] __init__ in DistillTrainer:
229376 iter per epoch
INFO    [05-05 15:53:06] _set_current_routine in Routine:
first routine: student
INFO    [05-05 15:53:06] run_routine in Routine:
Start routine student
INFO    [05-05 15:53:06] run_routine in Routine:
Start training
INFO    [05-05 15:53:06] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-05 15:53:25] test_mentor in DistillTrainer:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 15:53:25] train in DistillTrainer:
result:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 15:53:44] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 15:53:44] validate in BasicTrainer:
{'Recall@10': 0.00044389204545454544, 'NDCG@10': 0.0002111054676457901, 'MRR@10': 0.0001419221515044972, 'Recall@5': 0.0003107244318181818, 'NDCG@5': 0.0001693654326531528, 'MRR@5': 0.00012539950462682597, 'Recall*@10': 0.00044389204545454544, 'NDCG*@10': 0.0002111054676457901, 'MRR*@10': 0.0001419221515044972, 'Recall*@5': 0.0003107244318181818, 'NDCG*@5': 0.0001693654326531528, 'MRR*@5': 0.00012539950462682597}
INFO    [05-05 15:53:44] train in BasicTrainer:
epoch: 0
DEBUG   [05-05 15:53:44] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 9282877
DEBUG   [05-05 15:53:44] calculate_loss in loss:
pred max in softmax: 5.0033249863190576e-05, argmax 48228322
INFO    [05-05 15:53:52] _train_one_epoch in BasicTrainer:
loss = 6.775615973131997
INFO    [05-05 15:54:11] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 15:54:11] validate in BasicTrainer:
{'Recall@10': 0.010017887096513401, 'NDCG@10': 0.004963590932840651, 'MRR@10': 0.0034678235904059625, 'Recall@5': 0.005410972728647969, 'NDCG@5': 0.0034994707569818606, 'MRR@5': 0.002878829942677509, 'Recall*@10': 0.010017887096513401, 'NDCG*@10': 0.004963590932840651, 'MRR*@10': 0.0034678235904059625, 'Recall*@5': 0.005410972728647969, 'NDCG*@5': 0.0034994707569818606, 'MRR*@5': 0.002878829942677509}
INFO    [05-05 15:54:11] train in BasicTrainer:
duration: 27.122531175613403s
INFO    [05-05 15:54:11] train in BasicTrainer:
epoch: 1
INFO    [05-05 15:54:20] _train_one_epoch in BasicTrainer:
loss = 6.06694506747382
INFO    [05-05 15:54:39] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-05 15:54:39] validate in BasicTrainer:
{'Recall@10': 0.009898673743009567, 'NDCG@10': 0.00499120189554312, 'MRR@10': 0.0035341307732530618, 'Recall@5': 0.005574575244364413, 'NDCG@5': 0.0036174048330973496, 'MRR@5': 0.0029817160049622708, 'Recall*@10': 0.009898673743009567, 'NDCG*@10': 0.00499120189554312, 'MRR*@10': 0.0035341307732530618, 'Recall*@5': 0.005574575244364413, 'NDCG*@5': 0.0036174048330973496, 'MRR*@5': 0.0029817160049622708}
INFO    [05-05 15:54:39] train in BasicTrainer:
duration: 27.976008892059326s
INFO    [05-05 15:54:39] train in BasicTrainer:
epoch: 2
INFO    [05-05 15:54:48] _train_one_epoch in BasicTrainer:
loss = 5.728791798864092
INFO    [05-05 15:55:06] validate in BasicTrainer:
{'Recall@10': 0.009751551869240675, 'NDCG@10': 0.004949672824957154, 'MRR@10': 0.003522953399541703, 'Recall@5': 0.005499751137738878, 'NDCG@5': 0.0035927237688817763, 'MRR@5': 0.0029738306237215347, 'Recall*@10': 0.009751551869240675, 'NDCG*@10': 0.004949672824957154, 'MRR*@10': 0.003522953399541703, 'Recall*@5': 0.005499751137738878, 'NDCG*@5': 0.0035927237688817763, 'MRR*@5': 0.0029738306237215347}
INFO    [05-05 15:55:06] train in BasicTrainer:
duration: 27.369475841522217s
INFO    [05-05 15:55:06] train in BasicTrainer:
epoch: 3
INFO    [05-05 15:55:14] _train_one_epoch in BasicTrainer:
loss = 5.658702066966465
INFO    [05-05 15:55:33] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-05 15:55:34] validate in BasicTrainer:
{'Recall@10': 0.010511221025477756, 'NDCG@10': 0.005191492340104146, 'MRR@10': 0.0036214902912351217, 'Recall@5': 0.005574575244364413, 'NDCG@5': 0.0036275892052799463, 'MRR@5': 0.0029951921791176906, 'Recall*@10': 0.010511221025477756, 'NDCG*@10': 0.005191492340104146, 'MRR*@10': 0.0036214902912351217, 'Recall*@5': 0.005574575244364413, 'NDCG*@5': 0.0036275892052799463, 'MRR*@5': 0.0029951921791176906}
INFO    [05-05 15:55:34] train in BasicTrainer:
duration: 27.457783937454224s
INFO    [05-05 15:55:34] train in BasicTrainer:
epoch: 4
INFO    [05-05 15:55:43] _train_one_epoch in BasicTrainer:
loss = 5.62224007504327
INFO    [05-05 15:56:01] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-05 15:56:01] validate in BasicTrainer:
{'Recall@10': 0.011140910146588629, 'NDCG@10': 0.005420075094496662, 'MRR@10': 0.0037256065036424184, 'Recall@5': 0.006048902191899039, 'NDCG@5': 0.0037969966969368133, 'MRR@5': 0.0030696903863413768, 'Recall*@10': 0.011140910146588629, 'NDCG*@10': 0.005420075094496662, 'MRR*@10': 0.0037256065036424184, 'Recall*@5': 0.006048902191899039, 'NDCG*@5': 0.0037969966969368133, 'MRR*@5': 0.0030696903863413768}
INFO    [05-05 15:56:01] train in BasicTrainer:
duration: 27.89692258834839s
INFO    [05-05 15:56:01] train in BasicTrainer:
epoch: 5
INFO    [05-05 15:56:10] _train_one_epoch in BasicTrainer:
loss = 5.54388370684215
INFO    [05-05 15:56:30] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-05 15:56:30] validate in BasicTrainer:
{'Recall@10': 0.012295029464770447, 'NDCG@10': 0.005843780638480728, 'MRR@10': 0.003933065782555125, 'Recall@5': 0.006426210430535403, 'NDCG@5': 0.003965276145291599, 'MRR@5': 0.0031689214731820607, 'Recall*@10': 0.012295029464770447, 'NDCG*@10': 0.005843780638480728, 'MRR*@10': 0.003933065782555125, 'Recall*@5': 0.006426210430535403, 'NDCG*@5': 0.003965276145291599, 'MRR*@5': 0.0031689214731820607}
INFO    [05-05 15:56:30] train in BasicTrainer:
duration: 28.31500816345215s
INFO    [05-05 15:56:30] train in BasicTrainer:
epoch: 6
INFO    [05-05 15:56:38] _train_one_epoch in BasicTrainer:
loss = 5.457353915487017
INFO    [05-05 15:56:57] validate in BasicTrainer:
{'Recall@10': 0.011617763475938276, 'NDCG@10': 0.005667056888341904, 'MRR@10': 0.0038951925764029675, 'Recall@5': 0.006856148215857419, 'NDCG@5': 0.00415246823633259, 'MRR@5': 0.0032847765621475196, 'Recall*@10': 0.011617763475938276, 'NDCG*@10': 0.005667056888341904, 'MRR*@10': 0.0038951925764029675, 'Recall*@5': 0.006856148215857419, 'NDCG*@5': 0.00415246823633259, 'MRR*@5': 0.0032847765621475196}
INFO    [05-05 15:56:57] train in BasicTrainer:
duration: 27.10558271408081s
INFO    [05-05 15:56:57] train in BasicTrainer:
epoch: 7
INFO    [05-05 15:57:06] _train_one_epoch in BasicTrainer:
loss = 5.407103257519858
INFO    [05-05 15:57:25] validate in BasicTrainer:
{'Recall@10': 0.012198010798205029, 'NDCG@10': 0.005820190237665718, 'MRR@10': 0.003937236668372696, 'Recall@5': 0.006717266599563035, 'NDCG@5': 0.004094686401499944, 'MRR@5': 0.0032522445544600487, 'Recall*@10': 0.012198010798205029, 'NDCG*@10': 0.005820190237665718, 'MRR*@10': 0.003937236668372696, 'Recall*@5': 0.006717266599563035, 'NDCG*@5': 0.004094686401499944, 'MRR*@5': 0.0032522445544600487}
INFO    [05-05 15:57:25] train in BasicTrainer:
duration: 28.388304948806763s
INFO    [05-05 15:57:25] train in BasicTrainer:
epoch: 8
INFO    [05-05 15:57:34] _train_one_epoch in BasicTrainer:
loss = 5.380002983978817
INFO    [05-05 15:57:53] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-05 15:57:53] validate in BasicTrainer:
{'Recall@10': 0.013582316396588629, 'NDCG@10': 0.006296085998077284, 'MRR@10': 0.004153224237432534, 'Recall@5': 0.006842193871059201, 'NDCG@5': 0.00415929038585587, 'MRR@5': 0.003296465380117297, 'Recall*@10': 0.013582316396588629, 'NDCG*@10': 0.006296085998077284, 'MRR*@10': 0.004153224237432534, 'Recall*@5': 0.006842193871059201, 'NDCG*@5': 0.00415929038585587, 'MRR*@5': 0.003296465380117297}
INFO    [05-05 15:57:53] train in BasicTrainer:
duration: 27.45115065574646s
INFO    [05-05 15:57:53] train in BasicTrainer:
epoch: 9
INFO    [05-05 15:58:01] _train_one_epoch in BasicTrainer:
loss = 5.35261024747576
INFO    [05-05 15:58:20] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-05 15:58:20] validate in BasicTrainer:
{'Recall@10': 0.01428111574866555, 'NDCG@10': 0.00653961758044633, 'MRR@10': 0.0042790778997269545, 'Recall@5': 0.006886583075604655, 'NDCG@5': 0.0042296450966122475, 'MRR@5': 0.003373025641353293, 'Recall*@10': 0.01428111574866555, 'NDCG*@10': 0.00653961758044633, 'MRR*@10': 0.0042790778997269545, 'Recall*@5': 0.006886583075604655, 'NDCG*@5': 0.0042296450966122475, 'MRR*@5': 0.003373025641353293}
INFO    [05-05 15:58:20] train in BasicTrainer:
duration: 27.709941864013672s
INFO    [05-05 15:58:20] train in BasicTrainer:
epoch: 10
INFO    [05-05 15:58:29] _train_one_epoch in BasicTrainer:
loss = 5.316159342016492
INFO    [05-05 15:58:48] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-05 15:58:48] validate in BasicTrainer:
{'Recall@10': 0.014727534048936584, 'NDCG@10': 0.006706514692103321, 'MRR@10': 0.004352129530161619, 'Recall@5': 0.00676165580410849, 'NDCG@5': 0.004150398710573261, 'MRR@5': 0.003308501983569427, 'Recall*@10': 0.014727534048936584, 'NDCG*@10': 0.006706514692103321, 'MRR*@10': 0.004352129530161619, 'Recall*@5': 0.00676165580410849, 'NDCG*@5': 0.004150398710573261, 'MRR*@5': 0.003308501983569427}
INFO    [05-05 15:58:48] train in BasicTrainer:
duration: 27.274598836898804s
INFO    [05-05 15:58:48] train in BasicTrainer:
epoch: 11
INFO    [05-05 15:58:56] _train_one_epoch in BasicTrainer:
loss = 5.269484554018293
INFO    [05-05 15:59:15] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-05 15:59:15] validate in BasicTrainer:
{'Recall@10': 0.015404800122434443, 'NDCG@10': 0.0069649499333040285, 'MRR@10': 0.004490271951495247, 'Recall@5': 0.007322234863584692, 'NDCG@5': 0.00439756306480955, 'MRR@5': 0.0034576087597418914, 'Recall*@10': 0.015404800122434443, 'NDCG*@10': 0.0069649499333040285, 'MRR*@10': 0.004490271951495247, 'Recall*@5': 0.007322234863584692, 'NDCG*@5': 0.00439756306480955, 'MRR*@5': 0.0034576087597418914}
INFO    [05-05 15:59:15] train in BasicTrainer:
duration: 27.762666702270508s
INFO    [05-05 15:59:15] train in BasicTrainer:
epoch: 12
INFO    [05-05 15:59:24] _train_one_epoch in BasicTrainer:
loss = 5.223173992974417
INFO    [05-05 15:59:43] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-05 15:59:43] validate in BasicTrainer:
{'Recall@10': 0.016769437458027493, 'NDCG@10': 0.007399493574418805, 'MRR@10': 0.004667511929503896, 'Recall@5': 0.007338715463199399, 'NDCG@5': 0.004417660857804797, 'MRR@5': 0.003475743472914804, 'Recall*@10': 0.016769437458027493, 'NDCG*@10': 0.007399493574418805, 'MRR*@10': 0.004667511929503896, 'Recall*@5': 0.007338715463199399, 'NDCG*@5': 0.004417660857804797, 'MRR*@5': 0.003475743472914804}
INFO    [05-05 15:59:43] train in BasicTrainer:
duration: 27.588079929351807s
INFO    [05-05 15:59:43] train in BasicTrainer:
epoch: 13
INFO    [05-05 15:59:52] _train_one_epoch in BasicTrainer:
loss = 5.1860596878187994
INFO    [05-05 16:00:11] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-05 16:00:11] validate in BasicTrainer:
{'Recall@10': 0.017149272120811722, 'NDCG@10': 0.007585971700874242, 'MRR@10': 0.004788140237162059, 'Recall@5': 0.007566375488584692, 'NDCG@5': 0.004528102718970992, 'MRR@5': 0.003549937920814211, 'Recall*@10': 0.017149272120811722, 'NDCG*@10': 0.007585971700874242, 'MRR*@10': 0.004788140237162059, 'Recall*@5': 0.007566375488584692, 'NDCG*@5': 0.004528102718970992, 'MRR*@5': 0.003549937920814211}
INFO    [05-05 16:00:11] train in BasicTrainer:
duration: 27.9627845287323s
INFO    [05-05 16:00:11] train in BasicTrainer:
epoch: 14
INFO    [05-05 16:00:20] _train_one_epoch in BasicTrainer:
loss = 5.158818858010428
INFO    [05-05 16:00:38] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-05 16:00:39] validate in BasicTrainer:
{'Recall@10': 0.017393412745811722, 'NDCG@10': 0.0077283771454610605, 'MRR@10': 0.004904642320153388, 'Recall@5': 0.007716023701835762, 'NDCG@5': 0.004657485479996963, 'MRR@5': 0.00367137264798988, 'Recall*@10': 0.017393412745811722, 'NDCG*@10': 0.0077283771454610605, 'MRR*@10': 0.004904642320153388, 'Recall*@5': 0.007716023701835762, 'NDCG*@5': 0.004657485479996963, 'MRR*@5': 0.00367137264798988}
INFO    [05-05 16:00:39] train in BasicTrainer:
duration: 27.631632566452026s
INFO    [05-05 16:00:39] train in BasicTrainer:
epoch: 15
INFO    [05-05 16:00:47] _train_one_epoch in BasicTrainer:
loss = 5.13251793384552
INFO    [05-05 16:01:06] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-05 16:01:06] validate in BasicTrainer:
{'Recall@10': 0.018899458037181335, 'NDCG@10': 0.008161287670108404, 'MRR@10': 0.005042610160837119, 'Recall@5': 0.007865671915086832, 'NDCG@5': 0.004671072227541696, 'MRR@5': 0.0036473174748772926, 'Recall*@10': 0.018899458037181335, 'NDCG*@10': 0.008161287670108404, 'MRR*@10': 0.005042610160837119, 'Recall*@5': 0.007865671915086832, 'NDCG*@5': 0.004671072227541696, 'MRR*@5': 0.0036473174748772926}
INFO    [05-05 16:01:06] train in BasicTrainer:
duration: 27.698046445846558s
INFO    [05-05 16:01:06] train in BasicTrainer:
epoch: 16
INFO    [05-05 16:01:15] _train_one_epoch in BasicTrainer:
loss = 5.105139979294369
INFO    [05-05 16:01:33] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-05 16:01:33] validate in BasicTrainer:
{'Recall@10': 0.0194296022369103, 'NDCG@10': 0.008433225437660109, 'MRR@10': 0.005231830587779934, 'Recall@5': 0.008348239247094501, 'NDCG@5': 0.004923164442350919, 'MRR@5': 0.0038261083801361647, 'Recall*@10': 0.0194296022369103, 'NDCG*@10': 0.008433225437660109, 'MRR*@10': 0.005231830587779934, 'Recall*@5': 0.008348239247094501, 'NDCG*@5': 0.004923164442350919, 'MRR*@5': 0.0038261083801361647}
INFO    [05-05 16:01:33] train in BasicTrainer:
duration: 27.04654622077942s
INFO    [05-05 16:01:33] train in BasicTrainer:
epoch: 17
DEBUG   [05-05 16:01:41] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 1109005
DEBUG   [05-05 16:01:41] calculate_loss in loss:
pred max in softmax: 0.6624945402145386, argmax 27153205
DEBUG   [05-05 16:01:41] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 7399681
DEBUG   [05-05 16:01:41] calculate_loss in loss:
pred max in softmax: 0.7069762349128723, argmax 62413045
INFO    [05-05 16:01:42] _train_one_epoch in BasicTrainer:
loss = 5.078620169843946
INFO    [05-05 16:02:01] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-05 16:02:01] validate in BasicTrainer:
{'Recall@10': 0.020769518546082756, 'NDCG@10': 0.008908396544442936, 'MRR@10': 0.005464407446032221, 'Recall@5': 0.008442731574177742, 'NDCG@5': 0.005002996376292272, 'MRR@5': 0.0038999129002067175, 'Recall*@10': 0.020769518546082756, 'NDCG*@10': 0.008908396544442936, 'MRR*@10': 0.005464407446032221, 'Recall*@5': 0.008442731574177742, 'NDCG*@5': 0.005002996376292272, 'MRR*@5': 0.0038999129002067175}
INFO    [05-05 16:02:01] train in BasicTrainer:
duration: 27.54572105407715s
INFO    [05-05 16:02:01] train in BasicTrainer:
epoch: 18
INFO    [05-05 16:02:10] _train_one_epoch in BasicTrainer:
loss = 5.054782152175903
INFO    [05-05 16:02:28] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-05 16:02:28] validate in BasicTrainer:
{'Recall@10': 0.021210223097692837, 'NDCG@10': 0.009053279053081165, 'MRR@10': 0.0055217236195775595, 'Recall@5': 0.008642482994632288, 'NDCG@5': 0.005059489853341471, 'MRR@5': 0.003914518853310834, 'Recall*@10': 0.021210223097692837, 'NDCG*@10': 0.009053279053081165, 'MRR*@10': 0.0055217236195775595, 'Recall*@5': 0.008642482994632288, 'NDCG*@5': 0.005059489853341471, 'MRR*@5': 0.003914518853310834}
INFO    [05-05 16:02:28] train in BasicTrainer:
duration: 27.190720081329346s
INFO    [05-05 16:02:28] train in BasicTrainer:
epoch: 19
INFO    [05-05 16:02:37] _train_one_epoch in BasicTrainer:
loss = 5.032278137547629
INFO    [05-05 16:02:56] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-05 16:02:56] validate in BasicTrainer:
{'Recall@10': 0.02210943502458659, 'NDCG@10': 0.009375841060483997, 'MRR@10': 0.005675940097055652, 'Recall@5': 0.009066706777296284, 'NDCG@5': 0.005252887833524834, 'MRR@5': 0.004029240184040232, 'Recall*@10': 0.02210943502458659, 'NDCG*@10': 0.009375841060483997, 'MRR*@10': 0.005675940097055652, 'Recall*@5': 0.009066706777296284, 'NDCG*@5': 0.005252887833524834, 'MRR*@5': 0.004029240184040232}
INFO    [05-05 16:02:56] train in BasicTrainer:
duration: 28.314500093460083s
INFO    [05-05 16:02:56] train in BasicTrainer:
epoch: 20
INFO    [05-05 16:03:05] _train_one_epoch in BasicTrainer:
loss = 5.009298622608185
INFO    [05-05 16:03:24] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-05 16:03:24] validate in BasicTrainer:
{'Recall@10': 0.0238285247575153, 'NDCG@10': 0.009984572333368387, 'MRR@10': 0.0059549483385953035, 'Recall@5': 0.009962731210345572, 'NDCG@5': 0.0055924704806371165, 'MRR@5': 0.004196501569822431, 'Recall*@10': 0.0238285247575153, 'NDCG*@10': 0.009984572333368387, 'MRR*@10': 0.0059549483385953035, 'Recall*@5': 0.009962731210345572, 'NDCG*@5': 0.0055924704806371165, 'MRR*@5': 0.004196501569822431}
INFO    [05-05 16:03:24] train in BasicTrainer:
duration: 27.529173374176025s
INFO    [05-05 16:03:24] train in BasicTrainer:
epoch: 21
INFO    [05-05 16:03:33] _train_one_epoch in BasicTrainer:
loss = 4.985183443341937
INFO    [05-05 16:03:52] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-05 16:03:52] validate in BasicTrainer:
{'Recall@10': 0.02562628754160621, 'NDCG@10': 0.010721283880147066, 'MRR@10': 0.006370844065465711, 'Recall@5': 0.011003351177681576, 'NDCG@5': 0.006077886135740714, 'MRR@5': 0.004504669838669625, 'Recall*@10': 0.02562628754160621, 'NDCG*@10': 0.010721283880147066, 'MRR*@10': 0.006370844065465711, 'Recall*@5': 0.011003351177681576, 'NDCG*@5': 0.006077886135740714, 'MRR*@5': 0.004504669838669625}
INFO    [05-05 16:03:52] train in BasicTrainer:
duration: 27.925979137420654s
INFO    [05-05 16:03:52] train in BasicTrainer:
epoch: 22
INFO    [05-05 16:04:00] _train_one_epoch in BasicTrainer:
loss = 4.962971295629229
INFO    [05-05 16:04:19] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-05 16:04:19] validate in BasicTrainer:
{'Recall@10': 0.025725832547653805, 'NDCG@10': 0.010739663700488481, 'MRR@10': 0.006366271059960127, 'Recall@5': 0.010853702964430506, 'NDCG@5': 0.005992951548912309, 'MRR@5': 0.004443288780748844, 'Recall*@10': 0.025725832547653805, 'NDCG*@10': 0.010739663700488481, 'MRR*@10': 0.006366271059960127, 'Recall*@5': 0.010853702964430506, 'NDCG*@5': 0.005992951548912309, 'MRR*@5': 0.004443288780748844}
INFO    [05-05 16:04:19] train in BasicTrainer:
duration: 27.198155164718628s
INFO    [05-05 16:04:19] train in BasicTrainer:
epoch: 23
INFO    [05-05 16:04:28] _train_one_epoch in BasicTrainer:
loss = 4.943600858960833
INFO    [05-05 16:04:47] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-05 16:04:47] validate in BasicTrainer:
{'Recall@10': 0.027143099599263885, 'NDCG@10': 0.011201407421718945, 'MRR@10': 0.006555259905078195, 'Recall@5': 0.011496685106645931, 'NDCG@5': 0.006242912051013925, 'MRR@5': 0.004567583578384735, 'Recall*@10': 0.027143099599263885, 'NDCG*@10': 0.011201407421718945, 'MRR*@10': 0.006555259905078195, 'Recall*@5': 0.011496685106645931, 'NDCG*@5': 0.006242912051013925, 'MRR*@5': 0.004567583578384735}
INFO    [05-05 16:04:47] train in BasicTrainer:
duration: 28.351252794265747s
INFO    [05-05 16:04:47] train in BasicTrainer:
epoch: 24
INFO    [05-05 16:04:56] _train_one_epoch in BasicTrainer:
loss = 4.924889419760023
INFO    [05-05 16:05:15] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-05 16:05:15] validate in BasicTrainer:
{'Recall@10': 0.027484258806163616, 'NDCG@10': 0.01140849825672128, 'MRR@10': 0.006709561132910577, 'Recall@5': 0.011718631129373203, 'NDCG@5': 0.006368721538985317, 'MRR@5': 0.004663496511057019, 'Recall*@10': 0.027484258806163616, 'NDCG*@10': 0.01140849825672128, 'MRR*@10': 0.006709561132910577, 'Recall*@5': 0.011718631129373203, 'NDCG*@5': 0.006368721538985317, 'MRR*@5': 0.004663496511057019}
INFO    [05-05 16:05:15] train in BasicTrainer:
duration: 27.344712734222412s
INFO    [05-05 16:05:15] train in BasicTrainer:
epoch: 25
INFO    [05-05 16:05:24] _train_one_epoch in BasicTrainer:
loss = 4.908472657203674
INFO    [05-05 16:05:43] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-05 16:05:43] validate in BasicTrainer:
{'Recall@10': 0.02778421664102511, 'NDCG@10': 0.01158735520121726, 'MRR@10': 0.006839349188587882, 'Recall@5': 0.012489728206260637, 'NDCG@5': 0.00670028283176097, 'MRR@5': 0.004856545456939123, 'Recall*@10': 0.02778421664102511, 'NDCG*@10': 0.01158735520121726, 'MRR*@10': 0.006839349188587882, 'Recall*@5': 0.012489728206260637, 'NDCG*@5': 0.00670028283176097, 'MRR*@5': 0.004856545456939123}
INFO    [05-05 16:05:43] train in BasicTrainer:
duration: 28.374062061309814s
INFO    [05-05 16:05:43] train in BasicTrainer:
epoch: 26
INFO    [05-05 16:05:52] _train_one_epoch in BasicTrainer:
loss = 4.892124320779528
INFO    [05-05 16:06:10] validate in BasicTrainer:
{'Recall@10': 0.027867281132123688, 'NDCG@10': 0.01157184893434698, 'MRR@10': 0.006810452365739779, 'Recall@5': 0.011988154019821774, 'NDCG@5': 0.0065101147205992175, 'MRR@5': 0.004764009775085883, 'Recall*@10': 0.027867281132123688, 'NDCG*@10': 0.01157184893434698, 'MRR*@10': 0.006810452365739779, 'Recall*@5': 0.011988154019821774, 'NDCG*@5': 0.0065101147205992175, 'MRR*@5': 0.004764009775085883}
INFO    [05-05 16:06:10] train in BasicTrainer:
duration: 27.235265254974365s
INFO    [05-05 16:06:10] train in BasicTrainer:
epoch: 27
INFO    [05-05 16:06:19] _train_one_epoch in BasicTrainer:
loss = 4.878917344978878
INFO    [05-05 16:06:38] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-05 16:06:39] validate in BasicTrainer:
{'Recall@10': 0.02875253879888491, 'NDCG@10': 0.011916314082389528, 'MRR@10': 0.006986958313394676, 'Recall@5': 0.012822647240351547, 'NDCG@5': 0.006836907514794307, 'MRR@5': 0.0049318588254126635, 'Recall*@10': 0.02875253879888491, 'NDCG*@10': 0.011916314082389528, 'MRR*@10': 0.006986958313394676, 'Recall*@5': 0.012822647240351547, 'NDCG*@5': 0.006836907514794307, 'MRR*@5': 0.0049318588254126635}
INFO    [05-05 16:06:39] train in BasicTrainer:
duration: 28.218753337860107s
INFO    [05-05 16:06:39] train in BasicTrainer:
epoch: 28
INFO    [05-05 16:06:48] _train_one_epoch in BasicTrainer:
loss = 4.864649338381631
INFO    [05-05 16:07:06] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-05 16:07:07] validate in BasicTrainer:
{'Recall@10': 0.02994214574044401, 'NDCG@10': 0.012393781491978602, 'MRR@10': 0.0072617216289720754, 'Recall@5': 0.013138424351134083, 'NDCG@5': 0.0070394512943246145, 'MRR@5': 0.0050982923924245615, 'Recall*@10': 0.02994214574044401, 'NDCG*@10': 0.012393781491978602, 'MRR*@10': 0.0072617216289720754, 'Recall*@5': 0.013138424351134083, 'NDCG*@5': 0.0070394512943246145, 'MRR*@5': 0.0050982923924245615}
INFO    [05-05 16:07:07] train in BasicTrainer:
duration: 27.980759620666504s
INFO    [05-05 16:07:07] train in BasicTrainer:
epoch: 29
INFO    [05-05 16:07:16] _train_one_epoch in BasicTrainer:
loss = 4.852249775614057
INFO    [05-05 16:07:35] validate in BasicTrainer:
{'Recall@10': 0.029805790463631802, 'NDCG@10': 0.012375561012463137, 'MRR@10': 0.007273814217610793, 'Recall@5': 0.01240666379982775, 'NDCG@5': 0.0067793702368031845, 'MRR@5': 0.004981659395112233, 'Recall*@10': 0.029805790463631802, 'NDCG*@10': 0.012375561012463137, 'MRR*@10': 0.007273814217610793, 'Recall*@5': 0.01240666379982775, 'NDCG*@5': 0.0067793702368031845, 'MRR*@5': 0.004981659395112233}
INFO    [05-05 16:07:35] train in BasicTrainer:
duration: 28.486249208450317s
INFO    [05-05 16:07:35] train in BasicTrainer:
epoch: 30
INFO    [05-05 16:07:44] _train_one_epoch in BasicTrainer:
loss = 4.840309951986585
INFO    [05-05 16:08:03] validate in BasicTrainer:
{'Recall@10': 0.029859081249345432, 'NDCG@10': 0.012303708713840355, 'MRR@10': 0.007173114837231961, 'Recall@5': 0.012844841842624273, 'NDCG@5': 0.006870177913118492, 'MRR@5': 0.004970655226233331, 'Recall*@10': 0.029859081249345432, 'NDCG*@10': 0.012303708713840355, 'MRR*@10': 0.007173114837231961, 'Recall*@5': 0.012844841842624273, 'NDCG*@5': 0.006870177913118492, 'MRR*@5': 0.004970655226233331}
INFO    [05-05 16:08:03] train in BasicTrainer:
duration: 27.770134687423706s
INFO    [05-05 16:08:03] train in BasicTrainer:
epoch: 31
INFO    [05-05 16:08:11] _train_one_epoch in BasicTrainer:
loss = 4.829219443457467
INFO    [05-05 16:08:30] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-05 16:08:30] validate in BasicTrainer:
{'Recall@10': 0.030449433929540894, 'NDCG@10': 0.012596060945229097, 'MRR@10': 0.007380178790878166, 'Recall@5': 0.012886043468659574, 'NDCG@5': 0.006988550621000203, 'MRR@5': 0.005108439236540686, 'Recall*@10': 0.030449433929540894, 'NDCG*@10': 0.012596060945229097, 'MRR*@10': 0.007380178790878166, 'Recall*@5': 0.012886043468659574, 'NDCG*@5': 0.006988550621000203, 'MRR*@5': 0.005108439236540686}
INFO    [05-05 16:08:30] train in BasicTrainer:
duration: 27.406153917312622s
INFO    [05-05 16:08:30] train in BasicTrainer:
epoch: 32
INFO    [05-05 16:08:40] _train_one_epoch in BasicTrainer:
loss = 4.817684471607208
INFO    [05-05 16:08:59] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-05 16:08:59] validate in BasicTrainer:
{'Recall@10': 0.03106264245103706, 'NDCG@10': 0.012842749753458933, 'MRR@10': 0.007507332854650237, 'Recall@5': 0.01349925199015574, 'NDCG@5': 0.0072172756984152575, 'MRR@5': 0.005217383404008367, 'Recall*@10': 0.03106264245103706, 'NDCG*@10': 0.012842749753458933, 'MRR*@10': 0.007507332854650237, 'Recall*@5': 0.01349925199015574, 'NDCG*@5': 0.0072172756984152575, 'MRR*@5': 0.005217383404008367}
INFO    [05-05 16:08:59] train in BasicTrainer:
duration: 28.8039710521698s
INFO    [05-05 16:08:59] train in BasicTrainer:
epoch: 33
INFO    [05-05 16:09:08] _train_one_epoch in BasicTrainer:
loss = 4.808333763054439
INFO    [05-05 16:09:26] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-05 16:09:26] validate in BasicTrainer:
{'Recall@10': 0.031173615462400696, 'NDCG@10': 0.01294845003973354, 'MRR@10': 0.007618183439428156, 'Recall@5': 0.01389875483106483, 'NDCG@5': 0.007444195280020887, 'MRR@5': 0.0053939546924084425, 'Recall*@10': 0.031173615462400696, 'NDCG*@10': 0.01294845003973354, 'MRR*@10': 0.007618183439428156, 'Recall*@5': 0.01389875483106483, 'NDCG*@5': 0.007444195280020887, 'MRR*@5': 0.0053939546924084425}
INFO    [05-05 16:09:26] train in BasicTrainer:
duration: 27.38999080657959s
INFO    [05-05 16:09:26] train in BasicTrainer:
epoch: 34
INFO    [05-05 16:09:35] _train_one_epoch in BasicTrainer:
loss = 4.797367198126657
INFO    [05-05 16:09:54] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-05 16:09:54] validate in BasicTrainer:
{'Recall@10': 0.03149258023635908, 'NDCG@10': 0.01298889306119897, 'MRR@10': 0.007579408247362484, 'Recall@5': 0.013937430032952265, 'NDCG@5': 0.007393064443022013, 'MRR@5': 0.005317593840035525, 'Recall*@10': 0.03149258023635908, 'NDCG*@10': 0.01298889306119897, 'MRR*@10': 0.007579408247362484, 'Recall*@5': 0.013937430032952265, 'NDCG*@5': 0.007393064443022013, 'MRR*@5': 0.005317593840035525}
INFO    [05-05 16:09:54] train in BasicTrainer:
duration: 27.780284643173218s
INFO    [05-05 16:09:54] train in BasicTrainer:
epoch: 35
DEBUG   [05-05 16:10:01] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 5997301
DEBUG   [05-05 16:10:01] calculate_loss in loss:
pred max in softmax: 0.6349467039108276, argmax 35487349
DEBUG   [05-05 16:10:01] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 27634021
DEBUG   [05-05 16:10:01] calculate_loss in loss:
pred max in softmax: 0.5931460857391357, argmax 12528385
INFO    [05-05 16:10:03] _train_one_epoch in BasicTrainer:
loss = 4.786777896540506
INFO    [05-05 16:10:22] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-05 16:10:22] validate in BasicTrainer:
{'Recall@10': 0.03199349309910427, 'NDCG@10': 0.01329317299479788, 'MRR@10': 0.007822464643554254, 'Recall@5': 0.01411179927262393, 'NDCG@5': 0.0076061312786557455, 'MRR@5': 0.005530908788469705, 'Recall*@10': 0.03199349309910427, 'NDCG*@10': 0.01329317299479788, 'MRR*@10': 0.007822464643554254, 'Recall*@5': 0.01411179927262393, 'NDCG*@5': 0.0076061312786557455, 'MRR*@5': 0.005530908788469705}
INFO    [05-05 16:10:22] train in BasicTrainer:
duration: 27.94259476661682s
INFO    [05-05 16:10:22] train in BasicTrainer:
epoch: 36
INFO    [05-05 16:10:31] _train_one_epoch in BasicTrainer:
loss = 4.776901066303253
INFO    [05-05 16:10:50] validate in BasicTrainer:
{'Recall@10': 0.030895852399143307, 'NDCG@10': 0.012933341193605553, 'MRR@10': 0.007664400279860605, 'Recall@5': 0.013704717413268307, 'NDCG@5': 0.007429335351017388, 'MRR@5': 0.005425439068031582, 'Recall*@10': 0.030895852399143307, 'NDCG*@10': 0.012933341193605553, 'MRR*@10': 0.007664400279860605, 'Recall*@5': 0.013704717413268307, 'NDCG*@5': 0.007429335351017388, 'MRR*@5': 0.005425439068031582}
INFO    [05-05 16:10:50] train in BasicTrainer:
duration: 27.641275644302368s
INFO    [05-05 16:10:50] train in BasicTrainer:
epoch: 37
INFO    [05-05 16:10:59] _train_one_epoch in BasicTrainer:
loss = 4.765473101820264
INFO    [05-05 16:11:17] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [05-05 16:11:17] validate in BasicTrainer:
{'Recall@10': 0.033036639405922455, 'NDCG@10': 0.013730717145583847, 'MRR@10': 0.008073420263826847, 'Recall@5': 0.014584261162037199, 'NDCG@5': 0.007833140944554047, 'MRR@5': 0.005680171730504794, 'Recall*@10': 0.033036639405922455, 'NDCG*@10': 0.013730717145583847, 'MRR*@10': 0.008073420263826847, 'Recall*@5': 0.014584261162037199, 'NDCG*@5': 0.007833140944554047, 'MRR*@5': 0.005680171730504794}
INFO    [05-05 16:11:17] train in BasicTrainer:
duration: 27.541654586791992s
INFO    [05-05 16:11:17] train in BasicTrainer:
epoch: 38
INFO    [05-05 16:11:27] _train_one_epoch in BasicTrainer:
loss = 4.756012260913849
INFO    [05-05 16:11:46] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-05 16:11:46] validate in BasicTrainer:
{'Recall@10': 0.03290665962479331, 'NDCG@10': 0.013762901367788965, 'MRR@10': 0.008151402781632814, 'Recall@5': 0.015041446228596296, 'NDCG@5': 0.008079729381610046, 'MRR@5': 0.005861058915880593, 'Recall*@10': 0.03290665962479331, 'NDCG*@10': 0.013762901367788965, 'MRR*@10': 0.008151402781632814, 'Recall*@5': 0.015041446228596296, 'NDCG*@5': 0.008079729381610046, 'MRR*@5': 0.005861058915880593}
INFO    [05-05 16:11:46] train in BasicTrainer:
duration: 28.70757818222046s
INFO    [05-05 16:11:46] train in BasicTrainer:
epoch: 39
INFO    [05-05 16:11:54] _train_one_epoch in BasicTrainer:
loss = 4.745442407471793
INFO    [05-05 16:12:13] validate in BasicTrainer:
{'Recall@10': 0.03316728093407371, 'NDCG@10': 0.013743767599490557, 'MRR@10': 0.008058598730713129, 'Recall@5': 0.014486581171778116, 'NDCG@5': 0.007775954775173555, 'MRR@5': 0.0056382798674431715, 'Recall*@10': 0.03316728093407371, 'NDCG*@10': 0.013743767599490557, 'MRR*@10': 0.008058598730713129, 'Recall*@5': 0.014486581171778116, 'NDCG*@5': 0.007775954775173555, 'MRR*@5': 0.0056382798674431715}
INFO    [05-05 16:12:13] train in BasicTrainer:
duration: 26.97287082672119s
INFO    [05-05 16:12:13] train in BasicTrainer:
epoch: 40
INFO    [05-05 16:12:21] _train_one_epoch in BasicTrainer:
loss = 4.735230343682425
INFO    [05-05 16:12:40] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [05-05 16:12:41] validate in BasicTrainer:
{'Recall@10': 0.03375258059664206, 'NDCG@10': 0.014030959033830599, 'MRR@10': 0.008248316251080145, 'Recall@5': 0.014716767451979897, 'NDCG@5': 0.007933083625341003, 'MRR@5': 0.005765547044575214, 'Recall*@10': 0.03375258059664206, 'NDCG*@10': 0.014030959033830599, 'MRR*@10': 0.008248316251080145, 'Recall*@5': 0.014716767451979897, 'NDCG*@5': 0.007933083625341003, 'MRR*@5': 0.005765547044575214}
INFO    [05-05 16:12:41] train in BasicTrainer:
duration: 27.494672060012817s
INFO    [05-05 16:12:41] train in BasicTrainer:
epoch: 41
INFO    [05-05 16:12:50] _train_one_epoch in BasicTrainer:
loss = 4.723892578056881
INFO    [05-05 16:13:08] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-05 16:13:08] validate in BasicTrainer:
{'Recall@10': 0.03456740589304404, 'NDCG@10': 0.014422691088508476, 'MRR@10': 0.008513859854164448, 'Recall@5': 0.015685089694505387, 'NDCG@5': 0.008384958417578177, 'MRR@5': 0.006061521104790948, 'Recall*@10': 0.03456740589304404, 'NDCG*@10': 0.014422691088508476, 'MRR*@10': 0.008513859854164448, 'Recall*@5': 0.015685089694505387, 'NDCG*@5': 0.008384958417578177, 'MRR*@5': 0.006061521104790948}
INFO    [05-05 16:13:08] train in BasicTrainer:
duration: 27.92829966545105s
INFO    [05-05 16:13:08] train in BasicTrainer:
epoch: 42
INFO    [05-05 16:13:17] _train_one_epoch in BasicTrainer:
loss = 4.714638641902378
INFO    [05-05 16:13:36] validate in BasicTrainer:
{'Recall@10': 0.0340987928211689, 'NDCG@10': 0.014302029951729557, 'MRR@10': 0.00848920482464812, 'Recall@5': 0.015540494160218672, 'NDCG@5': 0.008371895517815243, 'MRR@5': 0.006083603398027745, 'Recall*@10': 0.0340987928211689, 'NDCG*@10': 0.014302029951729557, 'MRR*@10': 0.00848920482464812, 'Recall*@5': 0.015540494160218672, 'NDCG*@5': 0.008371895517815243, 'MRR*@5': 0.006083603398027745}
INFO    [05-05 16:13:36] train in BasicTrainer:
duration: 27.477356910705566s
INFO    [05-05 16:13:36] train in BasicTrainer:
epoch: 43
INFO    [05-05 16:13:44] _train_one_epoch in BasicTrainer:
loss = 4.703160175255367
INFO    [05-05 16:14:03] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [05-05 16:14:03] validate in BasicTrainer:
{'Recall@10': 0.034424132921478966, 'NDCG@10': 0.014466442337090319, 'MRR@10': 0.008592622481625189, 'Recall@5': 0.015918463637883015, 'NDCG@5': 0.00852630249309269, 'MRR@5': 0.006166874219409444, 'Recall*@10': 0.034424132921478966, 'NDCG*@10': 0.014466442337090319, 'MRR*@10': 0.008592622481625189, 'Recall*@5': 0.015918463637883015, 'NDCG*@5': 0.00852630249309269, 'MRR*@5': 0.006166874219409444}
INFO    [05-05 16:14:03] train in BasicTrainer:
duration: 27.083319187164307s
INFO    [05-05 16:14:03] train in BasicTrainer:
epoch: 44
INFO    [05-05 16:14:12] _train_one_epoch in BasicTrainer:
loss = 4.69173356464931
INFO    [05-05 16:14:31] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-05 16:14:31] validate in BasicTrainer:
{'Recall@10': 0.0348483564501459, 'NDCG@10': 0.014668716795065186, 'MRR@10': 0.008732071400366047, 'Recall@5': 0.016597594727169384, 'NDCG@5': 0.008844656023112211, 'MRR@5': 0.006373772270638834, 'Recall*@10': 0.0348483564501459, 'NDCG*@10': 0.014668716795065186, 'MRR*@10': 0.008732071400366047, 'Recall*@5': 0.016597594727169384, 'NDCG*@5': 0.008844656023112211, 'MRR*@5': 0.006373772270638834}
INFO    [05-05 16:14:31] train in BasicTrainer:
duration: 27.794456720352173s
INFO    [05-05 16:14:31] train in BasicTrainer:
epoch: 45
INFO    [05-05 16:14:40] _train_one_epoch in BasicTrainer:
loss = 4.682183478559766
INFO    [05-05 16:14:58] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-05 16:14:59] validate in BasicTrainer:
{'Recall@10': 0.03555858372287317, 'NDCG@10': 0.01494688710028475, 'MRR@10': 0.008886550764807245, 'Recall@5': 0.016387076625092464, 'NDCG@5': 0.008812201294032011, 'MRR@5': 0.006392280909825455, 'Recall*@10': 0.03555858372287317, 'NDCG*@10': 0.01494688710028475, 'MRR*@10': 0.008886550764807245, 'Recall*@5': 0.016387076625092464, 'NDCG*@5': 0.008812201294032011, 'MRR*@5': 0.006392280909825455}
INFO    [05-05 16:14:59] train in BasicTrainer:
duration: 27.6757755279541s
INFO    [05-05 16:14:59] train in BasicTrainer:
epoch: 46
INFO    [05-05 16:15:08] _train_one_epoch in BasicTrainer:
loss = 4.669871721948896
INFO    [05-05 16:15:26] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-05 16:15:27] validate in BasicTrainer:
{'Recall@10': 0.036339786242355, 'NDCG@10': 0.01531923638487404, 'MRR@10': 0.009126186497848143, 'Recall@5': 0.016955895942043175, 'NDCG@5': 0.00911497405137528, 'MRR@5': 0.006603014401414178, 'Recall*@10': 0.036339786242355, 'NDCG*@10': 0.01531923638487404, 'MRR*@10': 0.009126186497848143, 'Recall*@5': 0.016955895942043175, 'NDCG*@5': 0.00911497405137528, 'MRR*@5': 0.006603014401414178}
INFO    [05-05 16:15:27] train in BasicTrainer:
duration: 28.060498476028442s
INFO    [05-05 16:15:27] train in BasicTrainer:
epoch: 47
INFO    [05-05 16:15:35] _train_one_epoch in BasicTrainer:
loss = 4.6596885578972955
INFO    [05-05 16:15:53] log in loggers:
Update Best NDCG@10 Model at 47
INFO    [05-05 16:15:54] validate in BasicTrainer:
{'Recall@10': 0.0366461192342368, 'NDCG@10': 0.015454975041476164, 'MRR@10': 0.009213230445642363, 'Recall@5': 0.01708906355567954, 'NDCG@5': 0.009184949142350391, 'MRR@5': 0.006656896661628376, 'Recall*@10': 0.0366461192342368, 'NDCG*@10': 0.015454975041476164, 'MRR*@10': 0.009213230445642363, 'Recall*@5': 0.01708906355567954, 'NDCG*@5': 0.009184949142350391, 'MRR*@5': 0.006656896661628376}
INFO    [05-05 16:15:54] train in BasicTrainer:
duration: 27.01003336906433s
INFO    [05-05 16:15:54] train in BasicTrainer:
epoch: 48
INFO    [05-05 16:16:02] _train_one_epoch in BasicTrainer:
loss = 4.648975346769605
INFO    [05-05 16:16:21] validate in BasicTrainer:
{'Recall@10': 0.036975850774483246, 'NDCG@10': 0.015406818213787947, 'MRR@10': 0.009076304564421827, 'Recall@5': 0.016506289978596298, 'NDCG@5': 0.008857598062604666, 'MRR@5': 0.006414495535533537, 'Recall*@10': 0.036975850774483246, 'NDCG*@10': 0.015406818213787947, 'MRR*@10': 0.009076304564421827, 'Recall*@5': 0.016506289978596298, 'NDCG*@5': 0.008857598062604666, 'MRR*@5': 0.006414495535533537}
INFO    [05-05 16:16:21] train in BasicTrainer:
duration: 27.66209888458252s
INFO    [05-05 16:16:21] train in BasicTrainer:
epoch: 49
INFO    [05-05 16:16:30] _train_one_epoch in BasicTrainer:
loss = 4.638749378068106
INFO    [05-05 16:16:48] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-05 16:16:48] validate in BasicTrainer:
{'Recall@10': 0.037758375772021034, 'NDCG@10': 0.015952783128754658, 'MRR@10': 0.009541565044359728, 'Recall@5': 0.01737440580671484, 'NDCG@5': 0.00943549345670776, 'MRR@5': 0.006894920571622523, 'Recall*@10': 0.037758375772021034, 'NDCG*@10': 0.015952783128754658, 'MRR*@10': 0.009541565044359728, 'Recall*@5': 0.01737440580671484, 'NDCG*@5': 0.00943549345670776, 'MRR*@5': 0.006894920571622523}
INFO    [05-05 16:16:48] train in BasicTrainer:
duration: 27.216538429260254s
INFO    [05-05 16:16:48] train in BasicTrainer:
epoch: 50
INFO    [05-05 16:16:57] _train_one_epoch in BasicTrainer:
loss = 4.628099160534995
INFO    [05-05 16:17:16] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-05 16:17:17] validate in BasicTrainer:
{'Recall@10': 0.037946699356490914, 'NDCG@10': 0.016013860448517582, 'MRR@10': 0.009558245666663755, 'Recall@5': 0.017357925122434444, 'NDCG@5': 0.009416792457076635, 'MRR@5': 0.0068711711686443196, 'Recall*@10': 0.037946699356490914, 'NDCG*@10': 0.016013860448517582, 'MRR*@10': 0.009558245666663755, 'Recall*@5': 0.017357925122434444, 'NDCG*@5': 0.009416792457076635, 'MRR*@5': 0.0068711711686443196}
INFO    [05-05 16:17:17] train in BasicTrainer:
duration: 28.037885665893555s
INFO    [05-05 16:17:17] train in BasicTrainer:
epoch: 51
INFO    [05-05 16:17:25] _train_one_epoch in BasicTrainer:
loss = 4.617510804108211
INFO    [05-05 16:17:44] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [05-05 16:17:44] validate in BasicTrainer:
{'Recall@10': 0.03843816810033538, 'NDCG@10': 0.016350234012034805, 'MRR@10': 0.00983819484033368, 'Recall@5': 0.018378876826979897, 'NDCG@5': 0.00994597002863884, 'MRR@5': 0.007242626933888955, 'Recall*@10': 0.03843816810033538, 'NDCG*@10': 0.016350234012034805, 'MRR*@10': 0.00983819484033368, 'Recall*@5': 0.018378876826979897, 'NDCG*@5': 0.00994597002863884, 'MRR*@5': 0.007242626933888955}
INFO    [05-05 16:17:44] train in BasicTrainer:
duration: 27.53234624862671s
INFO    [05-05 16:17:44] train in BasicTrainer:
epoch: 52
INFO    [05-05 16:17:53] _train_one_epoch in BasicTrainer:
loss = 4.606251043932779
INFO    [05-05 16:18:12] log in loggers:
Update Best NDCG@10 Model at 52
INFO    [05-05 16:18:13] validate in BasicTrainer:
{'Recall@10': 0.039445165544748306, 'NDCG@10': 0.016723924485797233, 'MRR@10': 0.010026532182977959, 'Recall@5': 0.018570387989959934, 'NDCG@5': 0.010020785965025425, 'MRR@5': 0.007287217600440437, 'Recall*@10': 0.039445165544748306, 'NDCG*@10': 0.016723924485797233, 'MRR*@10': 0.010026532182977959, 'Recall*@5': 0.018570387989959934, 'NDCG*@5': 0.010020785965025425, 'MRR*@5': 0.007287217600440437}
INFO    [05-05 16:18:13] train in BasicTrainer:
duration: 28.514979124069214s
INFO    [05-05 16:18:13] train in BasicTrainer:
epoch: 53
DEBUG   [05-05 16:18:18] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 6798661
DEBUG   [05-05 16:18:18] calculate_loss in loss:
pred max in softmax: 0.7135301232337952, argmax 61892161
DEBUG   [05-05 16:18:18] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 2511385
DEBUG   [05-05 16:18:18] calculate_loss in loss:
pred max in softmax: 0.6073164343833923, argmax 43240507
INFO    [05-05 16:18:21] _train_one_epoch in BasicTrainer:
loss = 4.5957732285772055
INFO    [05-05 16:18:40] log in loggers:
Update Best NDCG@10 Model at 53
INFO    [05-05 16:18:40] validate in BasicTrainer:
{'Recall@10': 0.039744462140581825, 'NDCG@10': 0.017009736970067024, 'MRR@10': 0.010291961445049807, 'Recall@5': 0.019404881210489708, 'NDCG@5': 0.010501264001835476, 'MRR@5': 0.007645967374132438, 'Recall*@10': 0.039744462140581825, 'NDCG*@10': 0.017009736970067024, 'MRR*@10': 0.010291961445049807, 'Recall*@5': 0.019404881210489708, 'NDCG*@5': 0.010501264001835476, 'MRR*@5': 0.007645967374132438}
INFO    [05-05 16:18:40] train in BasicTrainer:
duration: 27.43934440612793s
INFO    [05-05 16:18:40] train in BasicTrainer:
epoch: 54
INFO    [05-05 16:18:49] _train_one_epoch in BasicTrainer:
loss = 4.586505378995623
INFO    [05-05 16:19:08] validate in BasicTrainer:
{'Recall@10': 0.03917883031747558, 'NDCG@10': 0.01672292873263359, 'MRR@10': 0.0100829770619219, 'Recall@5': 0.01905800791626627, 'NDCG@5': 0.0102669400670989, 'MRR@5': 0.007447750519283793, 'Recall*@10': 0.03917883031747558, 'NDCG*@10': 0.01672292873263359, 'MRR*@10': 0.0100829770619219, 'Recall*@5': 0.01905800791626627, 'NDCG*@5': 0.0102669400670989, 'MRR*@5': 0.007447750519283793}
INFO    [05-05 16:19:08] train in BasicTrainer:
duration: 28.141533613204956s
INFO    [05-05 16:19:08] train in BasicTrainer:
epoch: 55
INFO    [05-05 16:19:16] _train_one_epoch in BasicTrainer:
loss = 4.57636022567749
INFO    [05-05 16:19:35] validate in BasicTrainer:
{'Recall@10': 0.03976094282486222, 'NDCG@10': 0.01689421741122549, 'MRR@10': 0.010157621126960625, 'Recall@5': 0.018383929505944252, 'NDCG@5': 0.010053359141403978, 'MRR@5': 0.007376284973526543, 'Recall*@10': 0.03976094282486222, 'NDCG*@10': 0.01689421741122549, 'MRR*@10': 0.010157621126960625, 'Recall*@5': 0.018383929505944252, 'NDCG*@5': 0.010053359141403978, 'MRR*@5': 0.007376284973526543}
INFO    [05-05 16:19:35] train in BasicTrainer:
duration: 26.8281991481781s
INFO    [05-05 16:19:35] train in BasicTrainer:
epoch: 56
INFO    [05-05 16:19:45] _train_one_epoch in BasicTrainer:
loss = 4.566928514412472
INFO    [05-05 16:20:04] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-05 16:20:04] validate in BasicTrainer:
{'Recall@10': 0.04111800105734305, 'NDCG@10': 0.017405604435638947, 'MRR@10': 0.01041452307254076, 'Recall@5': 0.01923051205548373, 'NDCG@5': 0.010382816661149263, 'MRR@5': 0.007548582655462352, 'Recall*@10': 0.04111800105734305, 'NDCG*@10': 0.017405604435638947, 'MRR*@10': 0.01041452307254076, 'Recall*@5': 0.01923051205548373, 'NDCG*@5': 0.010382816661149263, 'MRR*@5': 0.007548582655462352}
INFO    [05-05 16:20:04] train in BasicTrainer:
duration: 28.986698627471924s
INFO    [05-05 16:20:04] train in BasicTrainer:
epoch: 57
INFO    [05-05 16:20:12] _train_one_epoch in BasicTrainer:
loss = 4.556790820189884
INFO    [05-05 16:20:31] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-05 16:20:31] validate in BasicTrainer:
{'Recall@10': 0.040530174631964073, 'NDCG@10': 0.017523127608001232, 'MRR@10': 0.01070132843134078, 'Recall@5': 0.020364963026209312, 'NDCG@5': 0.011035935021936893, 'MRR@5': 0.008043518247590824, 'Recall*@10': 0.040530174631964073, 'NDCG*@10': 0.017523127608001232, 'MRR*@10': 0.01070132843134078, 'Recall*@5': 0.020364963026209312, 'NDCG*@5': 0.011035935021936893, 'MRR*@5': 0.008043518247590824}
INFO    [05-05 16:20:31] train in BasicTrainer:
duration: 27.286564588546753s
INFO    [05-05 16:20:31] train in BasicTrainer:
epoch: 58
INFO    [05-05 16:20:40] _train_one_epoch in BasicTrainer:
loss = 4.5457541176251
INFO    [05-05 16:21:00] log in loggers:
Update Best NDCG@10 Model at 58
INFO    [05-05 16:21:00] validate in BasicTrainer:
{'Recall@10': 0.04099878770383922, 'NDCG@10': 0.01757674604992975, 'MRR@10': 0.01065009171989831, 'Recall@5': 0.020137303085489708, 'NDCG@5': 0.010890049182555893, 'MRR@5': 0.007925515063107014, 'Recall*@10': 0.04099878770383922, 'NDCG*@10': 0.01757674604992975, 'MRR*@10': 0.01065009171989831, 'Recall*@5': 0.020137303085489708, 'NDCG*@5': 0.010890049182555893, 'MRR*@5': 0.007925515063107014}
INFO    [05-05 16:21:00] train in BasicTrainer:
duration: 28.659295558929443s
INFO    [05-05 16:21:00] train in BasicTrainer:
epoch: 59
INFO    [05-05 16:21:08] _train_one_epoch in BasicTrainer:
loss = 4.535101498876299
INFO    [05-05 16:21:27] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [05-05 16:21:27] validate in BasicTrainer:
{'Recall@10': 0.04186943004077131, 'NDCG@10': 0.01786032784730196, 'MRR@10': 0.010770596225153316, 'Recall@5': 0.019771422852169384, 'NDCG@5': 0.010757382535798983, 'MRR@5': 0.007864020764827728, 'Recall*@10': 0.04186943004077131, 'NDCG*@10': 0.01786032784730196, 'MRR*@10': 0.010770596225153316, 'Recall*@5': 0.019771422852169384, 'NDCG*@5': 0.010757382535798983, 'MRR*@5': 0.007864020764827728}
INFO    [05-05 16:21:27] train in BasicTrainer:
duration: 27.51162362098694s
INFO    [05-05 16:21:28] close_training in BasicTrainer:
finished training
DEBUG   [05-05 16:21:28] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3361 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-05 16:21:28] run_routine in Routine:
Finished training, Start final validation
INFO    [05-05 16:21:28] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-05 16:21:28] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 16:21:28] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 16:21:46] validate in BasicTrainer:
{'Recall@10': 0.04186943004077131, 'NDCG@10': 0.01786032784730196, 'MRR@10': 0.010770596225153316, 'Recall@5': 0.019771422852169384, 'NDCG@5': 0.010757382535798983, 'MRR@5': 0.007864020764827728, 'Recall*@10': 0.04186943004077131, 'NDCG*@10': 0.01786032784730196, 'MRR*@10': 0.010770596225153316, 'Recall*@5': 0.019771422852169384, 'NDCG*@5': 0.010757382535798983, 'MRR*@5': 0.007864020764827728}
INFO    [05-05 16:21:46] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.04186943004077131, 'NDCG@10': 0.01786032784730196, 'MRR@10': 0.010770596225153316, 'Recall@5': 0.019771422852169384, 'NDCG@5': 0.010757382535798983, 'MRR@5': 0.007864020764827728, 'Recall*@10': 0.04186943004077131, 'NDCG*@10': 0.01786032784730196, 'MRR*@10': 0.010770596225153316, 'Recall*@5': 0.019771422852169384, 'NDCG*@5': 0.010757382535798983, 'MRR*@5': 0.007864020764827728}
INFO    [05-05 16:21:46] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-05 16:21:46] test in BasicTrainer:
Test model on test set!
INFO    [05-05 16:21:46] test_with_given_state_path in BasicTrainer:
Loading model params from ___yelp_soft_2022/pop_narm-T-1.0-al-0.75_05-05_15:52_t3/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-05 16:21:46] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 16:21:46] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 16:21:46] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-05 16:22:05] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.03594918515194546, 'NDCG@10': 0.01541353381154212, 'MRR@10': 0.00935317042537711, 'Recall@5': 0.01709092865613374, 'NDCG@5': 0.009394135072150013, 'MRR@5': 0.006915264805270867, 'Recall*@10': 0.03594918515194546, 'NDCG*@10': 0.01541353381154212, 'MRR*@10': 0.00935317042537711, 'Recall*@5': 0.01709092865613374, 'NDCG*@5': 0.009394135072150013, 'MRR*@5': 0.006915264805270867}
INFO    [05-05 16:22:05] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.03594918515194546, 'NDCG@10': 0.01541353381154212, 'MRR@10': 0.00935317042537711, 'Recall@5': 0.01709092865613374, 'NDCG@5': 0.009394135072150013, 'MRR@5': 0.006915264805270867, 'Recall*@10': 0.03594918515194546, 'NDCG*@10': 0.01541353381154212, 'MRR*@10': 0.00935317042537711, 'Recall*@5': 0.01709092865613374, 'NDCG*@5': 0.009394135072150013, 'MRR*@5': 0.006915264805270867}
