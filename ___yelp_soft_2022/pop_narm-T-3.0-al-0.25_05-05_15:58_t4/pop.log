INFO    [05-05 15:58:19] setup_train in utils:
{
    "experiment_dir": "___yelp_soft_2022",
    "experiment_description": "pop",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "yelp.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "alpha": 0.25,
    "T": 3.0,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.yelp/narm/config_distill.json",
    "task_id": 4,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "dvae_alpha": 0.5,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-05 15:58:19] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-05 15:58:19] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/yelp-5-5.pkl
INFO    [05-05 15:58:19] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-05 15:58:19] _check_dataset_cache in utils:
correct.
INFO    [05-05 15:58:19] __init__ in NextItemDataloader:
there are 20033 items in this dataset, 43947 users, padding_first? False
DEBUG   [05-05 15:58:26] generate_model in utils:
model_code_list=['pop']
INFO    [05-05 15:58:26] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-05 15:58:26] load_model_config in utils:
{}
WARNING [05-05 15:58:50] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.25_05-05_15:58_t4/teacher_pop_logs does not exist! Create one.
WARNING [05-05 15:58:50] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.25_05-05_15:58_t4/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-05 15:58:50] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.25_05-05_15:58_t4/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-05 15:58:50] get_path in utils:
Path is None
WARNING [05-05 15:58:50] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 15:58:50] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-05 15:58:50] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 15:58:50] __init__ in BasicTrainer:
229376 iter per epoch
DEBUG   [05-05 15:58:50] generate_model in utils:
model_code_list=['narm']
INFO    [05-05 15:58:50] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-05 15:58:50] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-05 15:58:55] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.25_05-05_15:58_t4/student_narm_logs does not exist! Create one.
WARNING [05-05 15:58:55] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.25_05-05_15:58_t4/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-05 15:58:55] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-3.0-al-0.25_05-05_15:58_t4/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-05 15:58:55] get_path in utils:
Path is None
WARNING [05-05 15:58:55] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 15:58:55] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(20034, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-05 15:58:55] assert_model_device in utils:
model student_narm has 5.3603515625 MB params.
INFO    [05-05 15:58:55] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 15:58:55] __init__ in DistillTrainer:
229376 iter per epoch
INFO    [05-05 15:58:55] _set_current_routine in Routine:
first routine: student
INFO    [05-05 15:58:55] run_routine in Routine:
Start routine student
INFO    [05-05 15:58:55] run_routine in Routine:
Start training
INFO    [05-05 15:58:55] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-05 15:59:14] test_mentor in DistillTrainer:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 15:59:14] train in DistillTrainer:
result:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 15:59:33] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 15:59:33] validate in BasicTrainer:
{'Recall@10': 0.00044389204545454544, 'NDCG@10': 0.0002111054676457901, 'MRR@10': 0.0001419221515044972, 'Recall@5': 0.0003107244318181818, 'NDCG@5': 0.0001693654326531528, 'MRR@5': 0.00012539950462682597, 'Recall*@10': 0.00044389204545454544, 'NDCG*@10': 0.0002111054676457901, 'MRR*@10': 0.0001419221515044972, 'Recall*@5': 0.0003107244318181818, 'NDCG*@5': 0.0001693654326531528, 'MRR*@5': 0.00012539950462682597}
INFO    [05-05 15:59:33] train in BasicTrainer:
epoch: 0
DEBUG   [05-05 15:59:34] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 9282877
DEBUG   [05-05 15:59:34] calculate_loss in loss:
pred max in softmax: 5.0027036195388064e-05, argmax 67393260
INFO    [05-05 15:59:46] _train_one_epoch in BasicTrainer:
loss = 8.482492685317993
INFO    [05-05 16:00:05] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 16:00:05] validate in BasicTrainer:
{'Recall@10': 0.008312090300023556, 'NDCG@10': 0.004358688559891148, 'MRR@10': 0.003183155426416885, 'Recall@5': 0.004548570860854604, 'NDCG@5': 0.0031408783556385474, 'MRR@5': 0.0026799776083366437, 'Recall*@10': 0.008312090300023556, 'NDCG*@10': 0.004358688559891148, 'MRR*@10': 0.003183155426416885, 'Recall*@5': 0.004548570860854604, 'NDCG*@5': 0.0031408783556385474, 'MRR*@5': 0.0026799776083366437}
INFO    [05-05 16:00:05] train in BasicTrainer:
duration: 32.3657009601593s
INFO    [05-05 16:00:05] train in BasicTrainer:
epoch: 1
INFO    [05-05 16:00:18] _train_one_epoch in BasicTrainer:
loss = 8.044021231787545
INFO    [05-05 16:00:37] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-05 16:00:37] validate in BasicTrainer:
{'Recall@10': 0.016148650002750484, 'NDCG@10': 0.007982615762474861, 'MRR@10': 0.005539736181328242, 'Recall@5': 0.009422481737353584, 'NDCG@5': 0.005834980867803097, 'MRR@5': 0.004669086076319218, 'Recall*@10': 0.016148650002750484, 'NDCG*@10': 0.007982615762474861, 'MRR*@10': 0.005539736181328242, 'Recall*@5': 0.009422481737353584, 'NDCG*@5': 0.005834980867803097, 'MRR*@5': 0.004669086076319218}
INFO    [05-05 16:00:37] train in BasicTrainer:
duration: 32.02457785606384s
INFO    [05-05 16:00:37] train in BasicTrainer:
epoch: 2
INFO    [05-05 16:00:50] _train_one_epoch in BasicTrainer:
loss = 7.593122661113739
INFO    [05-05 16:01:09] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-05 16:01:09] validate in BasicTrainer:
{'Recall@10': 0.022736597975546665, 'NDCG@10': 0.01126951863989234, 'MRR@10': 0.00785581801425327, 'Recall@5': 0.012848029505800117, 'NDCG@5': 0.008123054211451248, 'MRR@5': 0.006587077228521759, 'Recall*@10': 0.022736597975546665, 'NDCG*@10': 0.01126951863989234, 'MRR*@10': 0.00785581801425327, 'Recall*@5': 0.012848029505800117, 'NDCG*@5': 0.008123054211451248, 'MRR*@5': 0.006587077228521759}
INFO    [05-05 16:01:09] train in BasicTrainer:
duration: 31.853201866149902s
INFO    [05-05 16:01:09] train in BasicTrainer:
epoch: 3
INFO    [05-05 16:01:22] _train_one_epoch in BasicTrainer:
loss = 7.383440179484231
INFO    [05-05 16:01:41] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-05 16:01:41] validate in BasicTrainer:
{'Recall@10': 0.028979537500576538, 'NDCG@10': 0.014252209104597569, 'MRR@10': 0.009856382469561968, 'Recall@5': 0.016120741397819736, 'NDCG@5': 0.010143175636502829, 'MRR@5': 0.008189017291773449, 'Recall*@10': 0.028979537500576538, 'NDCG*@10': 0.014252209104597569, 'MRR*@10': 0.009856382469561968, 'Recall*@5': 0.016120741397819736, 'NDCG*@5': 0.010143175636502829, 'MRR*@5': 0.008189017291773449}
INFO    [05-05 16:01:41] train in BasicTrainer:
duration: 32.26351523399353s
INFO    [05-05 16:01:41] train in BasicTrainer:
epoch: 4
INFO    [05-05 16:01:54] _train_one_epoch in BasicTrainer:
loss = 7.257352454321725
INFO    [05-05 16:02:12] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-05 16:02:13] validate in BasicTrainer:
{'Recall@10': 0.03407154537060044, 'NDCG@10': 0.017003802667287262, 'MRR@10': 0.011890235949646343, 'Recall@5': 0.019850638271732765, 'NDCG@5': 0.012435464273122225, 'MRR@5': 0.010022422171790491, 'Recall*@10': 0.03407154537060044, 'NDCG*@10': 0.017003802667287262, 'MRR*@10': 0.011890235949646343, 'Recall*@5': 0.019850638271732765, 'NDCG*@5': 0.012435464273122225, 'MRR*@5': 0.010022422171790491}
INFO    [05-05 16:02:13] train in BasicTrainer:
duration: 31.371559381484985s
INFO    [05-05 16:02:13] train in BasicTrainer:
epoch: 5
INFO    [05-05 16:02:25] _train_one_epoch in BasicTrainer:
loss = 7.133038708141872
INFO    [05-05 16:02:44] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-05 16:02:44] validate in BasicTrainer:
{'Recall@10': 0.03817688572135838, 'NDCG@10': 0.019459468227895824, 'MRR@10': 0.013844478452070192, 'Recall@5': 0.0226034303619103, 'NDCG@5': 0.014464667320928791, 'MRR@5': 0.011807116510515863, 'Recall*@10': 0.03817688572135838, 'NDCG*@10': 0.019459468227895824, 'MRR*@10': 0.013844478452070192, 'Recall*@5': 0.0226034303619103, 'NDCG*@5': 0.014464667320928791, 'MRR*@5': 0.011807116510515863}
INFO    [05-05 16:02:44] train in BasicTrainer:
duration: 31.865362405776978s
INFO    [05-05 16:02:44] train in BasicTrainer:
epoch: 6
INFO    [05-05 16:02:58] _train_one_epoch in BasicTrainer:
loss = 7.032626109463828
INFO    [05-05 16:03:16] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-05 16:03:17] validate in BasicTrainer:
{'Recall@10': 0.04082880981943824, 'NDCG@10': 0.02096115933223204, 'MRR@10': 0.015010134062983772, 'Recall@5': 0.024508978494189003, 'NDCG@5': 0.0157340398396958, 'MRR@5': 0.012881850739094343, 'Recall*@10': 0.04082880981943824, 'NDCG*@10': 0.02096115933223204, 'MRR*@10': 0.015010134062983772, 'Recall*@5': 0.024508978494189003, 'NDCG*@5': 0.0157340398396958, 'MRR*@5': 0.012881850739094343}
INFO    [05-05 16:03:17] train in BasicTrainer:
duration: 32.16736841201782s
INFO    [05-05 16:03:17] train in BasicTrainer:
epoch: 7
INFO    [05-05 16:03:29] _train_one_epoch in BasicTrainer:
loss = 6.948156876223428
INFO    [05-05 16:03:48] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-05 16:03:48] validate in BasicTrainer:
{'Recall@10': 0.04529178989204494, 'NDCG@10': 0.02284429222345352, 'MRR@10': 0.01611287697133693, 'Recall@5': 0.026708109134977513, 'NDCG@5': 0.016887985508550297, 'MRR@5': 0.013685730709270998, 'Recall*@10': 0.04529178989204494, 'NDCG*@10': 0.02284429222345352, 'MRR*@10': 0.01611287697133693, 'Recall*@5': 0.026708109134977513, 'NDCG*@5': 0.016887985508550297, 'MRR*@5': 0.013685730709270998}
INFO    [05-05 16:03:48] train in BasicTrainer:
duration: 31.82385754585266s
INFO    [05-05 16:03:48] train in BasicTrainer:
epoch: 8
INFO    [05-05 16:04:01] _train_one_epoch in BasicTrainer:
loss = 6.871271925313132
INFO    [05-05 16:04:20] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-05 16:04:20] validate in BasicTrainer:
{'Recall@10': 0.04673510044813156, 'NDCG@10': 0.02433670600029555, 'MRR@10': 0.01762158931656317, 'Recall@5': 0.027867942371151665, 'NDCG@5': 0.01828271540051157, 'MRR@5': 0.015150710178369825, 'Recall*@10': 0.04673510044813156, 'NDCG*@10': 0.02433670600029555, 'MRR*@10': 0.01762158931656317, 'Recall*@5': 0.027867942371151665, 'NDCG*@5': 0.01828271540051157, 'MRR*@5': 0.015150710178369825}
INFO    [05-05 16:04:20] train in BasicTrainer:
duration: 31.468467473983765s
INFO    [05-05 16:04:20] train in BasicTrainer:
epoch: 9
INFO    [05-05 16:04:34] _train_one_epoch in BasicTrainer:
loss = 6.801516890525818
INFO    [05-05 16:04:53] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-05 16:04:53] validate in BasicTrainer:
{'Recall@10': 0.04846176911484112, 'NDCG@10': 0.025496720251711933, 'MRR@10': 0.018622594462199646, 'Recall@5': 0.02927059375426986, 'NDCG@5': 0.019334371794353832, 'MRR@5': 0.016104841689494522, 'Recall*@10': 0.04846176911484112, 'NDCG*@10': 0.025496720251711933, 'MRR*@10': 0.018622594462199646, 'Recall*@5': 0.02927059375426986, 'NDCG*@5': 0.019334371794353832, 'MRR*@5': 0.016104841689494522}
INFO    [05-05 16:04:53] train in BasicTrainer:
duration: 33.01488900184631s
INFO    [05-05 16:04:53] train in BasicTrainer:
epoch: 10
INFO    [05-05 16:05:06] _train_one_epoch in BasicTrainer:
loss = 6.7355479683194845
INFO    [05-05 16:05:24] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-05 16:05:24] validate in BasicTrainer:
{'Recall@10': 0.05111303214322437, 'NDCG@10': 0.027103338898582893, 'MRR@10': 0.019868390634655952, 'Recall@5': 0.03220214627005837, 'NDCG@5': 0.021055824038657276, 'MRR@5': 0.01741166277365251, 'Recall*@10': 0.05111303214322437, 'NDCG*@10': 0.027103338898582893, 'MRR*@10': 0.019868390634655952, 'Recall*@5': 0.03220214627005837, 'NDCG*@5': 0.021055824038657276, 'MRR*@5': 0.01741166277365251}
INFO    [05-05 16:05:24] train in BasicTrainer:
duration: 31.035959243774414s
INFO    [05-05 16:05:24] train in BasicTrainer:
epoch: 11
INFO    [05-05 16:05:37] _train_one_epoch in BasicTrainer:
loss = 6.668781169823238
INFO    [05-05 16:05:56] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-05 16:05:56] validate in BasicTrainer:
{'Recall@10': 0.05471228774298321, 'NDCG@10': 0.029195693575523117, 'MRR@10': 0.021526021713560276, 'Recall@5': 0.03391870957883922, 'NDCG@5': 0.022539492019198158, 'MRR@5': 0.018818154084411533, 'Recall*@10': 0.05471228774298321, 'NDCG*@10': 0.029195693575523117, 'MRR*@10': 0.021526021713560276, 'Recall*@5': 0.03391870957883922, 'NDCG*@5': 0.022539492019198158, 'MRR*@5': 0.018818154084411533}
INFO    [05-05 16:05:56] train in BasicTrainer:
duration: 31.784896850585938s
INFO    [05-05 16:05:56] train in BasicTrainer:
epoch: 12
INFO    [05-05 16:06:09] _train_one_epoch in BasicTrainer:
loss = 6.605747018541608
INFO    [05-05 16:06:28] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-05 16:06:28] validate in BasicTrainer:
{'Recall@10': 0.056863299147649246, 'NDCG@10': 0.031067536297169598, 'MRR@10': 0.023324787447398358, 'Recall@5': 0.0359917093407024, 'NDCG@5': 0.02439523149620403, 'MRR@5': 0.020615594969554382, 'Recall*@10': 0.056863299147649246, 'NDCG*@10': 0.031067536297169598, 'MRR*@10': 0.023324787447398358, 'Recall*@5': 0.0359917093407024, 'NDCG*@5': 0.02439523149620403, 'MRR*@5': 0.020615594969554382}
INFO    [05-05 16:06:28] train in BasicTrainer:
duration: 32.25638699531555s
INFO    [05-05 16:06:28] train in BasicTrainer:
epoch: 13
INFO    [05-05 16:06:41] _train_one_epoch in BasicTrainer:
loss = 6.5414454851831705
INFO    [05-05 16:07:00] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-05 16:07:00] validate in BasicTrainer:
{'Recall@10': 0.05863886732946743, 'NDCG@10': 0.03179704177786003, 'MRR@10': 0.023727132346142422, 'Recall@5': 0.03673808547583493, 'NDCG@5': 0.024794413962147453, 'MRR@5': 0.020882917737418957, 'Recall*@10': 0.05863886732946743, 'NDCG*@10': 0.03179704177786003, 'MRR*@10': 0.023727132346142422, 'Recall*@5': 0.03673808547583493, 'NDCG*@5': 0.024794413962147453, 'MRR*@5': 0.020882917737418957}
INFO    [05-05 16:07:00] train in BasicTrainer:
duration: 32.16037082672119s
INFO    [05-05 16:07:00] train in BasicTrainer:
epoch: 14
INFO    [05-05 16:07:13] _train_one_epoch in BasicTrainer:
loss = 6.481440569673266
INFO    [05-05 16:07:31] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-05 16:07:31] validate in BasicTrainer:
{'Recall@10': 0.062155719846487045, 'NDCG@10': 0.03410413590344516, 'MRR@10': 0.02566103400154547, 'Recall@5': 0.03968040475791151, 'NDCG@5': 0.026888804171573032, 'MRR@5': 0.022713930430737408, 'Recall*@10': 0.062155719846487045, 'NDCG*@10': 0.03410413590344516, 'MRR*@10': 0.02566103400154547, 'Recall*@5': 0.03968040475791151, 'NDCG*@5': 0.026888804171573032, 'MRR*@5': 0.022713930430737408}
INFO    [05-05 16:07:31] train in BasicTrainer:
duration: 31.349241495132446s
INFO    [05-05 16:07:31] train in BasicTrainer:
epoch: 15
INFO    [05-05 16:07:44] _train_one_epoch in BasicTrainer:
loss = 6.421143012387412
INFO    [05-05 16:08:03] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-05 16:08:03] validate in BasicTrainer:
{'Recall@10': 0.06341762468218803, 'NDCG@10': 0.03532589091496034, 'MRR@10': 0.02686183239248666, 'Recall@5': 0.04077618027275259, 'NDCG@5': 0.028053641319274902, 'MRR@5': 0.023888541385531425, 'Recall*@10': 0.06341762468218803, 'NDCG*@10': 0.03532589091496034, 'MRR*@10': 0.02686183239248666, 'Recall*@5': 0.04077618027275259, 'NDCG*@5': 0.028053641319274902, 'MRR*@5': 0.023888541385531425}
INFO    [05-05 16:08:03] train in BasicTrainer:
duration: 31.967398166656494s
INFO    [05-05 16:08:03] train in BasicTrainer:
epoch: 16
INFO    [05-05 16:08:17] _train_one_epoch in BasicTrainer:
loss = 6.365618433271136
INFO    [05-05 16:08:35] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-05 16:08:35] validate in BasicTrainer:
{'Recall@10': 0.06679373065179045, 'NDCG@10': 0.037489248609000984, 'MRR@10': 0.028649400411681694, 'Recall@5': 0.0441516251726584, 'NDCG@5': 0.030218119648369877, 'MRR@5': 0.02567855946042321, 'Recall*@10': 0.06679373065179045, 'NDCG*@10': 0.037489248609000984, 'MRR*@10': 0.028649400411681694, 'Recall*@5': 0.0441516251726584, 'NDCG*@5': 0.030218119648369877, 'MRR*@5': 0.02567855946042321}
INFO    [05-05 16:08:35] train in BasicTrainer:
duration: 31.96301531791687s
INFO    [05-05 16:08:35] train in BasicTrainer:
epoch: 17
DEBUG   [05-05 16:08:46] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 1109005
DEBUG   [05-05 16:08:46] calculate_loss in loss:
pred max in softmax: 0.9899317026138306, argmax 76712937
DEBUG   [05-05 16:08:46] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 5496451
DEBUG   [05-05 16:08:46] calculate_loss in loss:
pred max in softmax: 0.7641255855560303, argmax 75550933
INFO    [05-05 16:08:48] _train_one_epoch in BasicTrainer:
loss = 6.310163472379957
INFO    [05-05 16:09:07] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-05 16:09:07] validate in BasicTrainer:
{'Recall@10': 0.066935138607567, 'NDCG@10': 0.03832120041955601, 'MRR@10': 0.029675787314772606, 'Recall@5': 0.0451370890844952, 'NDCG@5': 0.03132897225970572, 'MRR@5': 0.02682324160229076, 'Recall*@10': 0.066935138607567, 'NDCG*@10': 0.03832120041955601, 'MRR*@10': 0.029675787314772606, 'Recall*@5': 0.0451370890844952, 'NDCG*@5': 0.03132897225970572, 'MRR*@5': 0.02682324160229076}
INFO    [05-05 16:09:07] train in BasicTrainer:
duration: 32.00563597679138s
INFO    [05-05 16:09:07] train in BasicTrainer:
epoch: 18
INFO    [05-05 16:09:20] _train_one_epoch in BasicTrainer:
loss = 6.259511709213257
INFO    [05-05 16:09:39] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-05 16:09:39] validate in BasicTrainer:
{'Recall@10': 0.06905186582695354, 'NDCG@10': 0.03968878293579275, 'MRR@10': 0.030827668072147804, 'Recall@5': 0.045894231985915794, 'NDCG@5': 0.03222974017262459, 'MRR@5': 0.027766529301350765, 'Recall*@10': 0.06905186582695354, 'NDCG*@10': 0.03968878293579275, 'MRR*@10': 0.030827668072147804, 'Recall*@5': 0.045894231985915794, 'NDCG*@5': 0.03222974017262459, 'MRR*@5': 0.027766529301350765}
INFO    [05-05 16:09:39] train in BasicTrainer:
duration: 31.52229619026184s
INFO    [05-05 16:09:39] train in BasicTrainer:
epoch: 19
INFO    [05-05 16:09:52] _train_one_epoch in BasicTrainer:
loss = 6.211602866649628
INFO    [05-05 16:10:11] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-05 16:10:11] validate in BasicTrainer:
{'Recall@10': 0.07077600806951523, 'NDCG@10': 0.04070729220455343, 'MRR@10': 0.03160787170583552, 'Recall@5': 0.047793404961174187, 'NDCG@5': 0.0333323861387643, 'MRR@5': 0.028598069467327812, 'Recall*@10': 0.07077600806951523, 'NDCG*@10': 0.04070729220455343, 'MRR*@10': 0.03160787170583552, 'Recall*@5': 0.047793404961174187, 'NDCG*@5': 0.0333323861387643, 'MRR*@5': 0.028598069467327812}
INFO    [05-05 16:10:11] train in BasicTrainer:
duration: 31.958961963653564s
INFO    [05-05 16:10:11] train in BasicTrainer:
epoch: 20
INFO    [05-05 16:10:23] _train_one_epoch in BasicTrainer:
loss = 6.166751035622188
INFO    [05-05 16:10:42] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-05 16:10:42] validate in BasicTrainer:
{'Recall@10': 0.07252432947809045, 'NDCG@10': 0.04183421148495241, 'MRR@10': 0.03254121711308306, 'Recall@5': 0.04901476915587078, 'NDCG@5': 0.03427245027639649, 'MRR@5': 0.02944412962956862, 'Recall*@10': 0.07252432947809045, 'NDCG*@10': 0.04183421148495241, 'MRR*@10': 0.03254121711308306, 'Recall*@5': 0.04901476915587078, 'NDCG*@5': 0.03427245027639649, 'MRR*@5': 0.02944412962956862}
INFO    [05-05 16:10:42] train in BasicTrainer:
duration: 31.37273359298706s
INFO    [05-05 16:10:42] train in BasicTrainer:
epoch: 21
INFO    [05-05 16:10:55] _train_one_epoch in BasicTrainer:
loss = 6.12131553036826
INFO    [05-05 16:11:14] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-05 16:11:14] validate in BasicTrainer:
{'Recall@10': 0.07387501204555685, 'NDCG@10': 0.043035395104776726, 'MRR@10': 0.03368950059468096, 'Recall@5': 0.050897461446848785, 'NDCG@5': 0.035660867325284264, 'MRR@5': 0.030678135088898918, 'Recall*@10': 0.07387501204555685, 'NDCG*@10': 0.043035395104776726, 'MRR*@10': 0.03368950059468096, 'Recall*@5': 0.050897461446848785, 'NDCG*@5': 0.035660867325284264, 'MRR*@5': 0.030678135088898918}
INFO    [05-05 16:11:14] train in BasicTrainer:
duration: 32.029072284698486s
INFO    [05-05 16:11:14] train in BasicTrainer:
epoch: 22
INFO    [05-05 16:11:28] _train_one_epoch in BasicTrainer:
loss = 6.078760376998356
INFO    [05-05 16:11:46] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-05 16:11:46] validate in BasicTrainer:
{'Recall@10': 0.07516229897737503, 'NDCG@10': 0.04403758150610057, 'MRR@10': 0.03461062620309266, 'Recall@5': 0.05142760547724637, 'NDCG@5': 0.03643516586585478, 'MRR@5': 0.03151594932106408, 'Recall*@10': 0.07516229897737503, 'NDCG*@10': 0.04403758150610057, 'MRR*@10': 0.03461062620309266, 'Recall*@5': 0.05142760547724637, 'NDCG*@5': 0.03643516586585478, 'MRR*@5': 0.03151594932106408}
INFO    [05-05 16:11:46] train in BasicTrainer:
duration: 32.14178705215454s
INFO    [05-05 16:11:46] train in BasicTrainer:
epoch: 23
INFO    [05-05 16:11:59] _train_one_epoch in BasicTrainer:
loss = 6.040297976561955
INFO    [05-05 16:12:18] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-05 16:12:19] validate in BasicTrainer:
{'Recall@10': 0.0766207677396861, 'NDCG@10': 0.04489529031244191, 'MRR@10': 0.03530642187053507, 'Recall@5': 0.05194313417781483, 'NDCG@5': 0.03698843107982115, 'MRR@5': 0.03208583288572051, 'Recall*@10': 0.0766207677396861, 'NDCG*@10': 0.04489529031244191, 'MRR*@10': 0.03530642187053507, 'Recall*@5': 0.05194313417781483, 'NDCG*@5': 0.03698843107982115, 'MRR*@5': 0.03208583288572051}
INFO    [05-05 16:12:19] train in BasicTrainer:
duration: 32.24903726577759s
INFO    [05-05 16:12:19] train in BasicTrainer:
epoch: 24
INFO    [05-05 16:12:31] _train_one_epoch in BasicTrainer:
loss = 6.0031330074582785
INFO    [05-05 16:12:50] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-05 16:12:50] validate in BasicTrainer:
{'Recall@10': 0.07645331661809575, 'NDCG@10': 0.045103884556076744, 'MRR@10': 0.03560431504791433, 'Recall@5': 0.0529304634441029, 'NDCG@5': 0.03756679729981856, 'MRR@5': 0.0325349300083789, 'Recall*@10': 0.07645331661809575, 'NDCG*@10': 0.045103884556076744, 'MRR*@10': 0.03560431504791433, 'Recall*@5': 0.0529304634441029, 'NDCG*@5': 0.03756679729981856, 'MRR*@5': 0.0325349300083789}
INFO    [05-05 16:12:50] train in BasicTrainer:
duration: 31.280183792114258s
INFO    [05-05 16:12:50] train in BasicTrainer:
epoch: 25
INFO    [05-05 16:13:03] _train_one_epoch in BasicTrainer:
loss = 5.967850012438638
INFO    [05-05 16:13:22] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-05 16:13:23] validate in BasicTrainer:
{'Recall@10': 0.07708366689356891, 'NDCG@10': 0.04578479684211991, 'MRR@10': 0.03629362481561574, 'Recall@5': 0.053338206288489426, 'NDCG@5': 0.03814554959535599, 'MRR@5': 0.03316363522952253, 'Recall*@10': 0.07708366689356891, 'NDCG*@10': 0.04578479684211991, 'MRR*@10': 0.03629362481561574, 'Recall*@5': 0.053338206288489426, 'NDCG*@5': 0.03814554959535599, 'MRR*@5': 0.03316363522952253}
INFO    [05-05 16:13:23] train in BasicTrainer:
duration: 32.6041944026947s
INFO    [05-05 16:13:23] train in BasicTrainer:
epoch: 26
INFO    [05-05 16:13:35] _train_one_epoch in BasicTrainer:
loss = 5.9325389095715115
INFO    [05-05 16:13:54] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-05 16:13:54] validate in BasicTrainer:
{'Recall@10': 0.07852884246544405, 'NDCG@10': 0.0466424704275348, 'MRR@10': 0.03696368770165877, 'Recall@5': 0.05497994578697465, 'NDCG@5': 0.03908153928138993, 'MRR@5': 0.03387442163445733, 'Recall*@10': 0.07852884246544405, 'NDCG*@10': 0.0466424704275348, 'MRR*@10': 0.03696368770165877, 'Recall*@5': 0.05497994578697465, 'NDCG*@5': 0.03908153928138993, 'MRR*@5': 0.03387442163445733}
INFO    [05-05 16:13:54] train in BasicTrainer:
duration: 31.212749481201172s
INFO    [05-05 16:13:54] train in BasicTrainer:
epoch: 27
INFO    [05-05 16:14:07] _train_one_epoch in BasicTrainer:
loss = 5.897669068404606
INFO    [05-05 16:14:26] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-05 16:14:26] validate in BasicTrainer:
{'Recall@10': 0.07890296321023595, 'NDCG@10': 0.046881013295867226, 'MRR@10': 0.03714891760186716, 'Recall@5': 0.05524880743839524, 'NDCG@5': 0.03930666907267137, 'MRR@5': 0.034066247161139145, 'Recall*@10': 0.07890296321023595, 'NDCG*@10': 0.046881013295867226, 'MRR*@10': 0.03714891760186716, 'Recall*@5': 0.05524880743839524, 'NDCG*@5': 0.03930666907267137, 'MRR*@5': 0.034066247161139145}
INFO    [05-05 16:14:26] train in BasicTrainer:
duration: 32.536664962768555s
INFO    [05-05 16:14:26] train in BasicTrainer:
epoch: 28
INFO    [05-05 16:14:39] _train_one_epoch in BasicTrainer:
loss = 5.865859133856637
INFO    [05-05 16:14:57] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-05 16:14:57] validate in BasicTrainer:
{'Recall@10': 0.07936586168679324, 'NDCG@10': 0.04759722609411587, 'MRR@10': 0.03795943375338207, 'Recall@5': 0.05500785430723971, 'NDCG@5': 0.03975610062479973, 'MRR@5': 0.034744670275937424, 'Recall*@10': 0.07936586168679324, 'NDCG*@10': 0.04759722609411587, 'MRR*@10': 0.03795943375338207, 'Recall*@5': 0.05500785430723971, 'NDCG*@5': 0.03975610062479973, 'MRR*@5': 0.034744670275937424}
INFO    [05-05 16:14:57] train in BasicTrainer:
duration: 31.18353843688965s
INFO    [05-05 16:14:57] train in BasicTrainer:
epoch: 29
INFO    [05-05 16:15:10] _train_one_epoch in BasicTrainer:
loss = 5.837763675621578
INFO    [05-05 16:15:30] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-05 16:15:30] validate in BasicTrainer:
{'Recall@10': 0.08067786964503201, 'NDCG@10': 0.04832145097580823, 'MRR@10': 0.038480588658289475, 'Recall@5': 0.0572735687548464, 'NDCG@5': 0.04083394597877155, 'MRR@5': 0.03543697416105054, 'Recall*@10': 0.08067786964503201, 'NDCG*@10': 0.04832145097580823, 'MRR*@10': 0.038480588658289475, 'Recall*@5': 0.0572735687548464, 'NDCG*@5': 0.04083394597877155, 'MRR*@5': 0.03543697416105054}
INFO    [05-05 16:15:30] train in BasicTrainer:
duration: 32.464115142822266s
INFO    [05-05 16:15:30] train in BasicTrainer:
epoch: 30
INFO    [05-05 16:15:43] _train_one_epoch in BasicTrainer:
loss = 5.802987354142325
INFO    [05-05 16:16:01] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [05-05 16:16:02] validate in BasicTrainer:
{'Recall@10': 0.08120416511188853, 'NDCG@10': 0.04857088523832234, 'MRR@10': 0.038644127547740936, 'Recall@5': 0.05733949115330523, 'NDCG@5': 0.04087794470516118, 'MRR@5': 0.035483795133504, 'Recall*@10': 0.08120416511188853, 'NDCG*@10': 0.04857088523832234, 'MRR*@10': 0.038644127547740936, 'Recall*@5': 0.05733949115330523, 'NDCG*@5': 0.04087794470516118, 'MRR*@5': 0.035483795133504}
INFO    [05-05 16:16:02] train in BasicTrainer:
duration: 31.635966300964355s
INFO    [05-05 16:16:02] train in BasicTrainer:
epoch: 31
INFO    [05-05 16:16:15] _train_one_epoch in BasicTrainer:
loss = 5.77397939988545
INFO    [05-05 16:16:33] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-05 16:16:33] validate in BasicTrainer:
{'Recall@10': 0.08114076879891483, 'NDCG@10': 0.0492481379346414, 'MRR@10': 0.0395671772685918, 'Recall@5': 0.05724313381043347, 'NDCG@5': 0.04156678237698295, 'MRR@5': 0.036424093287099495, 'Recall*@10': 0.08114076879891483, 'NDCG*@10': 0.0492481379346414, 'MRR*@10': 0.0395671772685918, 'Recall*@5': 0.05724313381043347, 'NDCG*@5': 0.04156678237698295, 'MRR*@5': 0.036424093287099495}
INFO    [05-05 16:16:33] train in BasicTrainer:
duration: 31.623619556427002s
INFO    [05-05 16:16:33] train in BasicTrainer:
epoch: 32
INFO    [05-05 16:16:47] _train_one_epoch in BasicTrainer:
loss = 5.748271243912833
INFO    [05-05 16:17:06] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-05 16:17:06] validate in BasicTrainer:
{'Recall@10': 0.08251045915213498, 'NDCG@10': 0.0500194945118644, 'MRR@10': 0.04013989696448499, 'Recall@5': 0.058696549724448814, 'NDCG@5': 0.04235978627746755, 'MRR@5': 0.0370026095346971, 'Recall*@10': 0.08251045915213498, 'NDCG*@10': 0.0500194945118644, 'MRR*@10': 0.04013989696448499, 'Recall*@5': 0.058696549724448814, 'NDCG*@5': 0.04235978627746755, 'MRR*@5': 0.0370026095346971}
INFO    [05-05 16:17:06] train in BasicTrainer:
duration: 32.55397415161133s
INFO    [05-05 16:17:06] train in BasicTrainer:
epoch: 33
INFO    [05-05 16:17:19] _train_one_epoch in BasicTrainer:
loss = 5.723069821085248
INFO    [05-05 16:17:38] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-05 16:17:38] validate in BasicTrainer:
{'Recall@10': 0.08284656568007036, 'NDCG@10': 0.050469444218007004, 'MRR@10': 0.040631321343508636, 'Recall@5': 0.05859129063107751, 'NDCG@5': 0.04265539517456835, 'MRR@5': 0.037423650988123634, 'Recall*@10': 0.08284656568007036, 'NDCG*@10': 0.050469444218007004, 'MRR*@10': 0.040631321343508636, 'Recall*@5': 0.05859129063107751, 'NDCG*@5': 0.04265539517456835, 'MRR*@5': 0.037423650988123634}
INFO    [05-05 16:17:38] train in BasicTrainer:
duration: 32.0226149559021s
INFO    [05-05 16:17:38] train in BasicTrainer:
epoch: 34
INFO    [05-05 16:17:50] _train_one_epoch in BasicTrainer:
loss = 5.69430810213089
INFO    [05-05 16:18:09] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-05 16:18:09] validate in BasicTrainer:
{'Recall@10': 0.08405331454493782, 'NDCG@10': 0.05113139511509375, 'MRR@10': 0.04112630235877904, 'Recall@5': 0.05987286364490336, 'NDCG@5': 0.04336510259996761, 'MRR@5': 0.037951931696046486, 'Recall*@10': 0.08405331454493782, 'NDCG*@10': 0.05113139511509375, 'MRR*@10': 0.04112630235877904, 'Recall*@5': 0.05987286364490336, 'NDCG*@5': 0.04336510259996761, 'MRR*@5': 0.037951931696046486}
INFO    [05-05 16:18:09] train in BasicTrainer:
duration: 31.490075826644897s
INFO    [05-05 16:18:09] train in BasicTrainer:
epoch: 35
DEBUG   [05-05 16:18:19] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 5997301
DEBUG   [05-05 16:18:19] calculate_loss in loss:
pred max in softmax: 0.9689778685569763, argmax 46870830
DEBUG   [05-05 16:18:19] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 27634021
DEBUG   [05-05 16:18:19] calculate_loss in loss:
pred max in softmax: 0.940751850605011, argmax 63609816
INFO    [05-05 16:18:23] _train_one_epoch in BasicTrainer:
loss = 5.671800851821899
INFO    [05-05 16:18:41] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-05 16:18:41] validate in BasicTrainer:
{'Recall@10': 0.08400068499825218, 'NDCG@10': 0.051175539127805016, 'MRR@10': 0.04119915887713432, 'Recall@5': 0.05922416733069853, 'NDCG@5': 0.04319612614133141, 'MRR@5': 0.037924898280338806, 'Recall*@10': 0.08400068499825218, 'NDCG*@10': 0.051175539127805016, 'MRR*@10': 0.04119915887713432, 'Recall*@5': 0.05922416733069853, 'NDCG*@5': 0.04319612614133141, 'MRR*@5': 0.037924898280338806}
INFO    [05-05 16:18:41] train in BasicTrainer:
duration: 32.09623193740845s
INFO    [05-05 16:18:41] train in BasicTrainer:
epoch: 36
INFO    [05-05 16:18:54] _train_one_epoch in BasicTrainer:
loss = 5.645663755280631
INFO    [05-05 16:19:13] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-05 16:19:13] validate in BasicTrainer:
{'Recall@10': 0.08497472107410431, 'NDCG@10': 0.05205718529495326, 'MRR@10': 0.042047677730972115, 'Recall@5': 0.060782842338085175, 'NDCG@5': 0.04427797076377002, 'MRR@5': 0.03886218809268691, 'Recall*@10': 0.08497472107410431, 'NDCG*@10': 0.05205718529495326, 'MRR*@10': 0.042047677730972115, 'Recall*@5': 0.060782842338085175, 'NDCG*@5': 0.04427797076377002, 'MRR*@5': 0.03886218809268691}
INFO    [05-05 16:19:13] train in BasicTrainer:
duration: 32.037145137786865s
INFO    [05-05 16:19:13] train in BasicTrainer:
epoch: 37
INFO    [05-05 16:19:26] _train_one_epoch in BasicTrainer:
loss = 5.624574039663587
INFO    [05-05 16:19:45] validate in BasicTrainer:
{'Recall@10': 0.08441919494758952, 'NDCG@10': 0.05195691571994261, 'MRR@10': 0.04209756851196289, 'Recall@5': 0.05990582467480139, 'NDCG@5': 0.04408206790685654, 'MRR@5': 0.03887827152555639, 'Recall*@10': 0.08441919494758952, 'NDCG*@10': 0.05195691571994261, 'MRR*@10': 0.04209756851196289, 'Recall*@5': 0.05990582467480139, 'NDCG*@5': 0.04408206790685654, 'MRR*@5': 0.03887827152555639}
INFO    [05-05 16:19:45] train in BasicTrainer:
duration: 31.33841848373413s
INFO    [05-05 16:19:45] train in BasicTrainer:
epoch: 38
INFO    [05-05 16:19:57] _train_one_epoch in BasicTrainer:
loss = 5.600085582051959
INFO    [05-05 16:20:17] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-05 16:20:17] validate in BasicTrainer:
{'Recall@10': 0.0852765440940857, 'NDCG@10': 0.052361133085055786, 'MRR@10': 0.04235031320290132, 'Recall@5': 0.06101555478843776, 'NDCG@5': 0.04455459490418434, 'MRR@5': 0.03915068845857273, 'Recall*@10': 0.0852765440940857, 'NDCG*@10': 0.052361133085055786, 'MRR*@10': 0.04235031320290132, 'Recall*@5': 0.06101555478843776, 'NDCG*@5': 0.04455459490418434, 'MRR*@5': 0.03915068845857273}
INFO    [05-05 16:20:17] train in BasicTrainer:
duration: 32.00526189804077s
INFO    [05-05 16:20:17] train in BasicTrainer:
epoch: 39
INFO    [05-05 16:20:30] _train_one_epoch in BasicTrainer:
loss = 5.5781093920980185
INFO    [05-05 16:20:49] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [05-05 16:20:49] validate in BasicTrainer:
{'Recall@10': 0.08590304512869228, 'NDCG@10': 0.0528390688652342, 'MRR@10': 0.042754163457588715, 'Recall@5': 0.06215253235264258, 'NDCG@5': 0.04519901864907958, 'MRR@5': 0.03962484374642372, 'Recall*@10': 0.08590304512869228, 'NDCG*@10': 0.0528390688652342, 'MRR*@10': 0.042754163457588715, 'Recall*@5': 0.06215253235264258, 'NDCG*@5': 0.04519901864907958, 'MRR*@5': 0.03962484374642372}
INFO    [05-05 16:20:49] train in BasicTrainer:
duration: 32.33345603942871s
INFO    [05-05 16:20:49] train in BasicTrainer:
epoch: 40
INFO    [05-05 16:21:02] _train_one_epoch in BasicTrainer:
loss = 5.555173473698752
INFO    [05-05 16:21:21] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [05-05 16:21:21] validate in BasicTrainer:
{'Recall@10': 0.08637484569441188, 'NDCG@10': 0.0534333468160846, 'MRR@10': 0.04342723942615769, 'Recall@5': 0.06179170479828661, 'NDCG@5': 0.04552682489156723, 'MRR@5': 0.04018953544172374, 'Recall*@10': 0.08637484569441188, 'NDCG*@10': 0.0534333468160846, 'MRR*@10': 0.04342723942615769, 'Recall*@5': 0.06179170479828661, 'NDCG*@5': 0.04552682489156723, 'MRR*@5': 0.04018953544172374}
INFO    [05-05 16:21:21] train in BasicTrainer:
duration: 32.27673673629761s
INFO    [05-05 16:21:21] train in BasicTrainer:
epoch: 41
INFO    [05-05 16:21:34] _train_one_epoch in BasicTrainer:
loss = 5.535508573055267
INFO    [05-05 16:21:53] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-05 16:21:53] validate in BasicTrainer:
{'Recall@10': 0.08692080933939327, 'NDCG@10': 0.05368000980127941, 'MRR@10': 0.043551005423069, 'Recall@5': 0.06256851587783206, 'NDCG@5': 0.0458433712747964, 'MRR@5': 0.04033968970179558, 'Recall*@10': 0.08692080933939327, 'NDCG*@10': 0.05368000980127941, 'MRR*@10': 0.043551005423069, 'Recall*@5': 0.06256851587783206, 'NDCG*@5': 0.0458433712747964, 'MRR*@5': 0.04033968970179558}
INFO    [05-05 16:21:53] train in BasicTrainer:
duration: 31.77395009994507s
INFO    [05-05 16:21:53] train in BasicTrainer:
epoch: 42
INFO    [05-05 16:22:06] _train_one_epoch in BasicTrainer:
loss = 5.518115775925772
INFO    [05-05 16:22:25] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-05 16:22:25] validate in BasicTrainer:
{'Recall@10': 0.08695761927149513, 'NDCG@10': 0.05376633019609885, 'MRR@10': 0.043674379248510704, 'Recall@5': 0.06269091672518036, 'NDCG@5': 0.045989946885542435, 'MRR@5': 0.04050603441216729, 'Recall*@10': 0.08695761927149513, 'NDCG*@10': 0.05376633019609885, 'MRR*@10': 0.043674379248510704, 'Recall*@5': 0.06269091672518036, 'NDCG*@5': 0.045989946885542435, 'MRR*@5': 0.04050603441216729}
INFO    [05-05 16:22:25] train in BasicTrainer:
duration: 31.94431447982788s
INFO    [05-05 16:22:25] train in BasicTrainer:
epoch: 43
INFO    [05-05 16:22:38] _train_one_epoch in BasicTrainer:
loss = 5.495684955801282
INFO    [05-05 16:22:56] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [05-05 16:22:56] validate in BasicTrainer:
{'Recall@10': 0.08773629570549185, 'NDCG@10': 0.054558369585058906, 'MRR@10': 0.04445444724776528, 'Recall@5': 0.06357870081608946, 'NDCG@5': 0.04680268737402829, 'MRR@5': 0.04128621552478184, 'Recall*@10': 0.08773629570549185, 'NDCG*@10': 0.054558369585058906, 'MRR*@10': 0.04445444724776528, 'Recall*@5': 0.06357870081608946, 'NDCG*@5': 0.04680268737402829, 'MRR*@5': 0.04128621552478184}
INFO    [05-05 16:22:56] train in BasicTrainer:
duration: 31.355141639709473s
INFO    [05-05 16:22:56] train in BasicTrainer:
epoch: 44
INFO    [05-05 16:23:09] _train_one_epoch in BasicTrainer:
loss = 5.471946980272021
INFO    [05-05 16:23:28] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-05 16:23:28] validate in BasicTrainer:
{'Recall@10': 0.0884243283759464, 'NDCG@10': 0.054820843040943146, 'MRR@10': 0.04459987479177388, 'Recall@5': 0.06355331871997226, 'NDCG@5': 0.04683470353484154, 'MRR@5': 0.04133642701940103, 'Recall*@10': 0.0884243283759464, 'NDCG*@10': 0.054820843040943146, 'MRR*@10': 0.04459987479177388, 'Recall*@5': 0.06355331871997226, 'NDCG*@5': 0.04683470353484154, 'MRR*@5': 0.04133642701940103}
INFO    [05-05 16:23:28] train in BasicTrainer:
duration: 31.87844491004944s
INFO    [05-05 16:23:28] train in BasicTrainer:
epoch: 45
INFO    [05-05 16:23:41] _train_one_epoch in BasicTrainer:
loss = 5.458456005368914
INFO    [05-05 16:24:00] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-05 16:24:00] validate in BasicTrainer:
{'Recall@10': 0.08846553008664738, 'NDCG@10': 0.05488080429759892, 'MRR@10': 0.04464318061416799, 'Recall@5': 0.06415828689932823, 'NDCG@5': 0.04707148569551381, 'MRR@5': 0.041449918327006424, 'Recall*@10': 0.08846553008664738, 'NDCG*@10': 0.05488080429759892, 'MRR*@10': 0.04464318061416799, 'Recall*@5': 0.06415828689932823, 'NDCG*@5': 0.04707148569551381, 'MRR*@5': 0.041449918327006424}
INFO    [05-05 16:24:00] train in BasicTrainer:
duration: 31.378906726837158s
INFO    [05-05 16:24:00] train in BasicTrainer:
epoch: 46
INFO    [05-05 16:24:13] _train_one_epoch in BasicTrainer:
loss = 5.437692821025848
INFO    [05-05 16:24:32] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-05 16:24:32] validate in BasicTrainer:
{'Recall@10': 0.09000519798560576, 'NDCG@10': 0.055654523047533905, 'MRR@10': 0.04521427337418903, 'Recall@5': 0.06465162065896121, 'NDCG@5': 0.04750784892927517, 'MRR@5': 0.04188255389983004, 'Recall*@10': 0.09000519798560576, 'NDCG*@10': 0.055654523047533905, 'MRR*@10': 0.04521427337418903, 'Recall*@5': 0.06465162065896121, 'NDCG*@5': 0.04750784892927517, 'MRR*@5': 0.04188255389983004}
INFO    [05-05 16:24:32] train in BasicTrainer:
duration: 32.06309628486633s
INFO    [05-05 16:24:32] train in BasicTrainer:
epoch: 47
INFO    [05-05 16:24:45] _train_one_epoch in BasicTrainer:
loss = 5.418923318386078
INFO    [05-05 16:25:03] log in loggers:
Update Best NDCG@10 Model at 47
INFO    [05-05 16:25:03] validate in BasicTrainer:
{'Recall@10': 0.08960635621439327, 'NDCG@10': 0.055691546337171036, 'MRR@10': 0.04533321986144239, 'Recall@5': 0.06533965332941576, 'NDCG@5': 0.047887260602279144, 'MRR@5': 0.042136979712681336, 'Recall*@10': 0.08960635621439327, 'NDCG*@10': 0.055691546337171036, 'MRR*@10': 0.04533321986144239, 'Recall*@5': 0.06533965332941576, 'NDCG*@5': 0.047887260602279144, 'MRR*@5': 0.042136979712681336}
INFO    [05-05 16:25:03] train in BasicTrainer:
duration: 31.678245544433594s
INFO    [05-05 16:25:03] train in BasicTrainer:
epoch: 48
INFO    [05-05 16:25:17] _train_one_epoch in BasicTrainer:
loss = 5.403609301362719
INFO    [05-05 16:25:37] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-05 16:25:37] validate in BasicTrainer:
{'Recall@10': 0.09036031162196939, 'NDCG@10': 0.05649204145778309, 'MRR@10': 0.04613943736661564, 'Recall@5': 0.06698325750502673, 'NDCG@5': 0.04896312884309075, 'MRR@5': 0.04305091974410144, 'Recall*@10': 0.09036031162196939, 'NDCG*@10': 0.05649204145778309, 'MRR*@10': 0.04613943736661564, 'Recall*@5': 0.06698325750502673, 'NDCG*@5': 0.04896312884309075, 'MRR*@5': 0.04305091974410144}
INFO    [05-05 16:25:37] train in BasicTrainer:
duration: 33.270328760147095s
INFO    [05-05 16:25:37] train in BasicTrainer:
epoch: 49
INFO    [05-05 16:25:49] _train_one_epoch in BasicTrainer:
loss = 5.387964989457812
INFO    [05-05 16:26:08] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-05 16:26:08] validate in BasicTrainer:
{'Recall@10': 0.09101977402513678, 'NDCG@10': 0.057311174205758354, 'MRR@10': 0.04705426333980127, 'Recall@5': 0.06660594926639037, 'NDCG@5': 0.04948176308111711, 'MRR@5': 0.04386055232449011, 'Recall*@10': 0.09101977402513678, 'NDCG*@10': 0.057311174205758354, 'MRR*@10': 0.04705426333980127, 'Recall*@5': 0.06660594926639037, 'NDCG*@5': 0.04948176308111711, 'MRR*@5': 0.04386055232449011}
INFO    [05-05 16:26:08] train in BasicTrainer:
duration: 31.307239294052124s
INFO    [05-05 16:26:08] train in BasicTrainer:
epoch: 50
INFO    [05-05 16:26:21] _train_one_epoch in BasicTrainer:
loss = 5.370974114962986
INFO    [05-05 16:26:40] validate in BasicTrainer:
{'Recall@10': 0.09098428690975363, 'NDCG@10': 0.05699610981074246, 'MRR@10': 0.04662236774509603, 'Recall@5': 0.06672901186076077, 'NDCG@5': 0.04919771613045172, 'MRR@5': 0.04342992129650983, 'Recall*@10': 0.09098428690975363, 'NDCG*@10': 0.05699610981074246, 'MRR*@10': 0.04662236774509603, 'Recall*@5': 0.06672901186076077, 'NDCG*@5': 0.04919771613045172, 'MRR*@5': 0.04342992129650983}
INFO    [05-05 16:26:40] train in BasicTrainer:
duration: 31.967759370803833s
INFO    [05-05 16:26:40] train in BasicTrainer:
epoch: 51
INFO    [05-05 16:26:54] _train_one_epoch in BasicTrainer:
loss = 5.352564377444131
INFO    [05-05 16:27:12] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [05-05 16:27:13] validate in BasicTrainer:
{'Recall@10': 0.09282896464521234, 'NDCG@10': 0.05772672017866915, 'MRR@10': 0.04704752903092991, 'Recall@5': 0.06667890873822299, 'NDCG@5': 0.049317130649631676, 'MRR@5': 0.043603970245881515, 'Recall*@10': 0.09282896464521234, 'NDCG*@10': 0.05772672017866915, 'MRR*@10': 0.04704752903092991, 'Recall*@5': 0.06667890873822299, 'NDCG*@5': 0.049317130649631676, 'MRR*@5': 0.043603970245881515}
INFO    [05-05 16:27:13] train in BasicTrainer:
duration: 32.58750081062317s
INFO    [05-05 16:27:13] train in BasicTrainer:
epoch: 52
INFO    [05-05 16:27:26] _train_one_epoch in BasicTrainer:
loss = 5.339160255023411
INFO    [05-05 16:27:46] validate in BasicTrainer:
{'Recall@10': 0.0915315726941282, 'NDCG@10': 0.05752637745304541, 'MRR@10': 0.04714301702651111, 'Recall@5': 0.06754702465100722, 'NDCG@5': 0.04981763864105398, 'MRR@5': 0.043989363719116555, 'Recall*@10': 0.0915315726941282, 'NDCG*@10': 0.05752637745304541, 'MRR*@10': 0.04714301702651111, 'Recall*@5': 0.06754702465100722, 'NDCG*@5': 0.04981763864105398, 'MRR*@5': 0.043989363719116555}
INFO    [05-05 16:27:46] train in BasicTrainer:
duration: 33.024089336395264s
INFO    [05-05 16:27:46] train in BasicTrainer:
epoch: 53
DEBUG   [05-05 16:27:53] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 6798661
DEBUG   [05-05 16:27:53] calculate_loss in loss:
pred max in softmax: 0.9739543199539185, argmax 45234683
DEBUG   [05-05 16:27:53] calculate_loss in loss:
soft_target max: 0.5006210207939148, argmax 2511385
DEBUG   [05-05 16:27:53] calculate_loss in loss:
pred max in softmax: 0.9488710165023804, argmax 75983593
INFO    [05-05 16:27:58] _train_one_epoch in BasicTrainer:
loss = 5.324597690786634
INFO    [05-05 16:28:17] log in loggers:
Update Best NDCG@10 Model at 53
INFO    [05-05 16:28:17] validate in BasicTrainer:
{'Recall@10': 0.09306486560539766, 'NDCG@10': 0.05850292674519799, 'MRR@10': 0.04795906455679373, 'Recall@5': 0.06855907426639037, 'NDCG@5': 0.05061067132787271, 'MRR@5': 0.044720467857339165, 'Recall*@10': 0.09306486560539766, 'NDCG*@10': 0.05850292674519799, 'MRR*@10': 0.04795906455679373, 'Recall*@5': 0.06855907426639037, 'NDCG*@5': 0.05061067132787271, 'MRR*@5': 0.044720467857339165}
INFO    [05-05 16:28:17] train in BasicTrainer:
duration: 31.282087326049805s
INFO    [05-05 16:28:17] train in BasicTrainer:
epoch: 54
INFO    [05-05 16:28:30] _train_one_epoch in BasicTrainer:
loss = 5.312114936964853
INFO    [05-05 16:28:49] log in loggers:
Update Best NDCG@10 Model at 54
INFO    [05-05 16:28:50] validate in BasicTrainer:
{'Recall@10': 0.092768095433712, 'NDCG@10': 0.058615907010706986, 'MRR@10': 0.048174366016279564, 'Recall@5': 0.0689896737987345, 'NDCG@5': 0.0509544082663276, 'MRR@5': 0.04502875865860419, 'Recall*@10': 0.092768095433712, 'NDCG*@10': 0.058615907010706986, 'MRR*@10': 0.048174366016279564, 'Recall*@5': 0.0689896737987345, 'NDCG*@5': 0.0509544082663276, 'MRR*@5': 0.04502875865860419}
INFO    [05-05 16:28:50] train in BasicTrainer:
duration: 32.827462911605835s
INFO    [05-05 16:28:50] train in BasicTrainer:
epoch: 55
INFO    [05-05 16:29:02] _train_one_epoch in BasicTrainer:
loss = 5.297353506088257
INFO    [05-05 16:29:21] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [05-05 16:29:21] validate in BasicTrainer:
{'Recall@10': 0.09355314685539766, 'NDCG@10': 0.05873005600138144, 'MRR@10': 0.04813331128521399, 'Recall@5': 0.06818495419892398, 'NDCG@5': 0.050592848523096604, 'MRR@5': 0.04481418566270308, 'Recall*@10': 0.09355314685539766, 'NDCG*@10': 0.05873005600138144, 'MRR*@10': 0.04813331128521399, 'Recall*@5': 0.06818495419892398, 'NDCG*@5': 0.050592848523096604, 'MRR*@5': 0.04481418566270308}
INFO    [05-05 16:29:21] train in BasicTrainer:
duration: 31.185287952423096s
INFO    [05-05 16:29:21] train in BasicTrainer:
epoch: 56
INFO    [05-05 16:29:34] _train_one_epoch in BasicTrainer:
loss = 5.282698018210275
INFO    [05-05 16:29:53] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-05 16:29:54] validate in BasicTrainer:
{'Recall@10': 0.0938835394653407, 'NDCG@10': 0.05913064324043014, 'MRR@10': 0.04852156713604927, 'Recall@5': 0.06923700191757896, 'NDCG@5': 0.051206447861411354, 'MRR@5': 0.04527728699825027, 'Recall*@10': 0.0938835394653407, 'NDCG*@10': 0.05913064324043014, 'MRR*@10': 0.04852156713604927, 'Recall*@5': 0.06923700191757896, 'NDCG*@5': 0.051206447861411354, 'MRR*@5': 0.04527728699825027}
INFO    [05-05 16:29:54] train in BasicTrainer:
duration: 32.68379831314087s
INFO    [05-05 16:29:54] train in BasicTrainer:
epoch: 57
INFO    [05-05 16:30:07] _train_one_epoch in BasicTrainer:
loss = 5.271851233073643
INFO    [05-05 16:30:26] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-05 16:30:26] validate in BasicTrainer:
{'Recall@10': 0.09384672885591333, 'NDCG@10': 0.05958939072760669, 'MRR@10': 0.049124895510348404, 'Recall@5': 0.06929215788841248, 'NDCG@5': 0.05166531658985398, 'MRR@5': 0.04586413875222206, 'Recall*@10': 0.09384672885591333, 'NDCG*@10': 0.05958939072760669, 'MRR*@10': 0.049124895510348404, 'Recall*@5': 0.06929215788841248, 'NDCG*@5': 0.05166531658985398, 'MRR*@5': 0.04586413875222206}
INFO    [05-05 16:30:26] train in BasicTrainer:
duration: 32.408422231674194s
INFO    [05-05 16:30:26] train in BasicTrainer:
epoch: 58
INFO    [05-05 16:30:39] _train_one_epoch in BasicTrainer:
loss = 5.262066108839853
INFO    [05-05 16:30:59] log in loggers:
Update Best NDCG@10 Model at 58
INFO    [05-05 16:30:59] validate in BasicTrainer:
{'Recall@10': 0.09456014362248508, 'NDCG@10': 0.05973850495435975, 'MRR@10': 0.0491208058189262, 'Recall@5': 0.0691336075013334, 'NDCG@5': 0.05157232758673755, 'MRR@5': 0.04578239606185393, 'Recall*@10': 0.09456014362248508, 'NDCG*@10': 0.05973850495435975, 'MRR*@10': 0.0491208058189262, 'Recall*@5': 0.0691336075013334, 'NDCG*@5': 0.05157232758673755, 'MRR*@5': 0.04578239606185393}
INFO    [05-05 16:30:59] train in BasicTrainer:
duration: 32.82935070991516s
INFO    [05-05 16:30:59] train in BasicTrainer:
epoch: 59
INFO    [05-05 16:31:11] _train_one_epoch in BasicTrainer:
loss = 5.244433326380594
INFO    [05-05 16:31:30] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [05-05 16:31:31] validate in BasicTrainer:
{'Recall@10': 0.09503447061235254, 'NDCG@10': 0.059850812635638496, 'MRR@10': 0.04912874712185426, 'Recall@5': 0.06962441517548128, 'NDCG@5': 0.051687929101965645, 'MRR@5': 0.045790962197563866, 'Recall*@10': 0.09503447061235254, 'NDCG*@10': 0.059850812635638496, 'MRR*@10': 0.04912874712185426, 'Recall*@5': 0.06962441517548128, 'NDCG*@5': 0.051687929101965645, 'MRR*@5': 0.045790962197563866}
INFO    [05-05 16:31:31] train in BasicTrainer:
duration: 31.693883895874023s
INFO    [05-05 16:31:31] close_training in BasicTrainer:
finished training
DEBUG   [05-05 16:31:31] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3361 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-05 16:31:31] run_routine in Routine:
Finished training, Start final validation
INFO    [05-05 16:31:31] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-05 16:31:31] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 16:31:31] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 16:31:49] validate in BasicTrainer:
{'Recall@10': 0.09503447061235254, 'NDCG@10': 0.059850812635638496, 'MRR@10': 0.04912874712185426, 'Recall@5': 0.06962441517548128, 'NDCG@5': 0.051687929101965645, 'MRR@5': 0.045790962197563866, 'Recall*@10': 0.09503447061235254, 'NDCG*@10': 0.059850812635638496, 'MRR*@10': 0.04912874712185426, 'Recall*@5': 0.06962441517548128, 'NDCG*@5': 0.051687929101965645, 'MRR*@5': 0.045790962197563866}
INFO    [05-05 16:31:49] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.09503447061235254, 'NDCG@10': 0.059850812635638496, 'MRR@10': 0.04912874712185426, 'Recall@5': 0.06962441517548128, 'NDCG@5': 0.051687929101965645, 'MRR@5': 0.045790962197563866, 'Recall*@10': 0.09503447061235254, 'NDCG*@10': 0.059850812635638496, 'MRR*@10': 0.04912874712185426, 'Recall*@5': 0.06962441517548128, 'NDCG*@5': 0.051687929101965645, 'MRR*@5': 0.045790962197563866}
INFO    [05-05 16:31:49] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-05 16:31:49] test in BasicTrainer:
Test model on test set!
INFO    [05-05 16:31:49] test_with_given_state_path in BasicTrainer:
Loading model params from ___yelp_soft_2022/pop_narm-T-3.0-al-0.25_05-05_15:58_t4/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-05 16:31:49] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 16:31:49] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 16:31:49] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-05 16:32:08] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.0786524469202215, 'NDCG@10': 0.04766197976740924, 'MRR@10': 0.038246230306950485, 'Recall@5': 0.05625195564194159, 'NDCG@5': 0.04048872502012686, 'MRR@5': 0.03532650423320857, 'Recall*@10': 0.0786524469202215, 'NDCG*@10': 0.04766197976740924, 'MRR*@10': 0.038246230306950485, 'Recall*@5': 0.05625195564194159, 'NDCG*@5': 0.04048872502012686, 'MRR*@5': 0.03532650423320857}
INFO    [05-05 16:32:08] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.0786524469202215, 'NDCG@10': 0.04766197976740924, 'MRR@10': 0.038246230306950485, 'Recall@5': 0.05625195564194159, 'NDCG@5': 0.04048872502012686, 'MRR@5': 0.03532650423320857, 'Recall*@10': 0.0786524469202215, 'NDCG*@10': 0.04766197976740924, 'MRR*@10': 0.038246230306950485, 'Recall*@5': 0.05625195564194159, 'NDCG*@5': 0.04048872502012686, 'MRR*@5': 0.03532650423320857}
