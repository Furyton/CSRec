INFO    [05-05 15:23:53] setup_train in utils:
{
    "experiment_dir": "___yelp_soft_2022",
    "experiment_description": "pop",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "yelp.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "alpha": 0.5,
    "T": 1.0,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.yelp/narm/config_distill.json",
    "task_id": 2,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "dvae_alpha": 0.5,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-05 15:23:53] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-05 15:23:53] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/yelp-5-5.pkl
INFO    [05-05 15:23:54] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-05 15:23:54] _check_dataset_cache in utils:
correct.
INFO    [05-05 15:23:54] __init__ in NextItemDataloader:
there are 20033 items in this dataset, 43947 users, padding_first? False
DEBUG   [05-05 15:24:00] generate_model in utils:
model_code_list=['pop']
INFO    [05-05 15:24:00] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-05 15:24:00] load_model_config in utils:
{}
WARNING [05-05 15:24:26] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.5_05-05_15:23_t2/teacher_pop_logs does not exist! Create one.
WARNING [05-05 15:24:26] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.5_05-05_15:23_t2/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-05 15:24:26] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.5_05-05_15:23_t2/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-05 15:24:26] get_path in utils:
Path is None
WARNING [05-05 15:24:26] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 15:24:26] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-05 15:24:26] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 15:24:26] __init__ in BasicTrainer:
229376 iter per epoch
DEBUG   [05-05 15:24:26] generate_model in utils:
model_code_list=['narm']
INFO    [05-05 15:24:26] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-05 15:24:26] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-05 15:24:33] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.5_05-05_15:23_t2/student_narm_logs does not exist! Create one.
WARNING [05-05 15:24:33] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.5_05-05_15:23_t2/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-05 15:24:33] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.5_05-05_15:23_t2/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-05 15:24:33] get_path in utils:
Path is None
WARNING [05-05 15:24:33] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 15:24:33] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(20034, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-05 15:24:33] assert_model_device in utils:
model student_narm has 5.3603515625 MB params.
INFO    [05-05 15:24:33] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 15:24:33] __init__ in DistillTrainer:
229376 iter per epoch
INFO    [05-05 15:24:33] _set_current_routine in Routine:
first routine: student
INFO    [05-05 15:24:33] run_routine in Routine:
Start routine student
INFO    [05-05 15:24:33] run_routine in Routine:
Start training
INFO    [05-05 15:24:33] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-05 15:24:55] test_mentor in DistillTrainer:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 15:24:55] train in DistillTrainer:
result:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 15:25:14] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 15:25:14] validate in BasicTrainer:
{'Recall@10': 0.00044389204545454544, 'NDCG@10': 0.0002111054676457901, 'MRR@10': 0.0001419221515044972, 'Recall@5': 0.0003107244318181818, 'NDCG@5': 0.0001693654326531528, 'MRR@5': 0.00012539950462682597, 'Recall*@10': 0.00044389204545454544, 'NDCG*@10': 0.0002111054676457901, 'MRR*@10': 0.0001419221515044972, 'Recall*@5': 0.0003107244318181818, 'NDCG*@5': 0.0001693654326531528, 'MRR*@5': 0.00012539950462682597}
INFO    [05-05 15:25:14] train in BasicTrainer:
epoch: 0
DEBUG   [05-05 15:25:15] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 9282877
DEBUG   [05-05 15:25:15] calculate_loss in loss:
pred max in softmax: 5.0027036195388064e-05, argmax 67393260
INFO    [05-05 15:25:27] _train_one_epoch in BasicTrainer:
loss = 7.845633702618735
INFO    [05-05 15:25:46] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 15:25:46] validate in BasicTrainer:
{'Recall@10': 0.009329854426058855, 'NDCG@10': 0.004789399512281472, 'MRR@10': 0.0034332684960893607, 'Recall@5': 0.005455361933193423, 'NDCG@5': 0.003545588475059379, 'MRR@5': 0.0029254806524311953, 'Recall*@10': 0.009329854426058855, 'NDCG*@10': 0.004789399512281472, 'MRR*@10': 0.0034332684960893607, 'Recall*@5': 0.005455361933193423, 'NDCG*@5': 0.003545588475059379, 'MRR*@5': 0.0029254806524311953}
INFO    [05-05 15:25:46] train in BasicTrainer:
duration: 31.993193864822388s
INFO    [05-05 15:25:46] train in BasicTrainer:
epoch: 1
INFO    [05-05 15:25:59] _train_one_epoch in BasicTrainer:
loss = 7.29361628634589
INFO    [05-05 15:26:18] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-05 15:26:18] validate in BasicTrainer:
{'Recall@10': 0.010619667697359215, 'NDCG@10': 0.005241863831708377, 'MRR@10': 0.0036537418438291006, 'Recall@5': 0.005400206047025594, 'NDCG@5': 0.00357506386089054, 'MRR@5': 0.0029784017242491245, 'Recall*@10': 0.010619667697359215, 'NDCG*@10': 0.005241863831708377, 'MRR*@10': 0.0036537418438291006, 'Recall*@5': 0.005400206047025594, 'NDCG*@5': 0.00357506386089054, 'MRR*@5': 0.0029784017242491245}
INFO    [05-05 15:26:18] train in BasicTrainer:
duration: 31.779844284057617s
INFO    [05-05 15:26:18] train in BasicTrainer:
epoch: 2
INFO    [05-05 15:26:30] _train_one_epoch in BasicTrainer:
loss = 7.0143996732575555
INFO    [05-05 15:26:49] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-05 15:26:49] validate in BasicTrainer:
{'Recall@10': 0.011340661567043175, 'NDCG@10': 0.00558513445271687, 'MRR@10': 0.0038745859002863817, 'Recall@5': 0.006270848214626312, 'NDCG@5': 0.003968539626591585, 'MRR@5': 0.0032210106834430585, 'Recall*@10': 0.011340661567043175, 'NDCG*@10': 0.00558513445271687, 'MRR*@10': 0.0038745859002863817, 'Recall*@5': 0.006270848214626312, 'NDCG*@5': 0.003968539626591585, 'MRR*@5': 0.0032210106834430585}
INFO    [05-05 15:26:49] train in BasicTrainer:
duration: 31.26475977897644s
INFO    [05-05 15:26:49] train in BasicTrainer:
epoch: 3
INFO    [05-05 15:27:02] _train_one_epoch in BasicTrainer:
loss = 6.863671966961452
INFO    [05-05 15:27:20] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-05 15:27:21] validate in BasicTrainer:
{'Recall@10': 0.012688818387687206, 'NDCG@10': 0.006061197851191868, 'MRR@10': 0.004088689551942728, 'Recall@5': 0.006914491680535403, 'NDCG@5': 0.004213323858989911, 'MRR@5': 0.003337428100745786, 'Recall*@10': 0.012688818387687206, 'NDCG*@10': 0.006061197851191868, 'MRR*@10': 0.004088689551942728, 'Recall*@5': 0.006914491680535403, 'NDCG*@5': 0.004213323858989911, 'MRR*@5': 0.003337428100745786}
INFO    [05-05 15:27:21] train in BasicTrainer:
duration: 31.560043334960938s
INFO    [05-05 15:27:21] train in BasicTrainer:
epoch: 4
INFO    [05-05 15:27:33] _train_one_epoch in BasicTrainer:
loss = 6.710055300167629
INFO    [05-05 15:27:51] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-05 15:27:52] validate in BasicTrainer:
{'Recall@10': 0.013742731376127764, 'NDCG@10': 0.0063436235385862265, 'MRR@10': 0.004161624703556299, 'Recall@5': 0.007244223051450469, 'NDCG@5': 0.004286048595200886, 'MRR@5': 0.0033380597491155972, 'Recall*@10': 0.013742731376127764, 'NDCG*@10': 0.0063436235385862265, 'MRR*@10': 0.004161624703556299, 'Recall*@5': 0.007244223051450469, 'NDCG*@5': 0.004286048595200886, 'MRR*@5': 0.0033380597491155972}
INFO    [05-05 15:27:52] train in BasicTrainer:
duration: 30.897010803222656s
INFO    [05-05 15:27:52] train in BasicTrainer:
epoch: 5
INFO    [05-05 15:28:04] _train_one_epoch in BasicTrainer:
loss = 6.626087503773825
INFO    [05-05 15:28:23] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-05 15:28:23] validate in BasicTrainer:
{'Recall@10': 0.01409213092516769, 'NDCG@10': 0.006539403460919857, 'MRR@10': 0.00430534807541831, 'Recall@5': 0.007324761203066869, 'NDCG@5': 0.004366101993417198, 'MRR@5': 0.003417359728535468, 'Recall*@10': 0.01409213092516769, 'NDCG*@10': 0.006539403460919857, 'MRR*@10': 0.00430534807541831, 'Recall*@5': 0.007324761203066869, 'NDCG*@5': 0.004366101993417198, 'MRR*@5': 0.003417359728535468}
INFO    [05-05 15:28:23] train in BasicTrainer:
duration: 31.91887378692627s
INFO    [05-05 15:28:23] train in BasicTrainer:
epoch: 6
INFO    [05-05 15:28:36] _train_one_epoch in BasicTrainer:
loss = 6.573960789612362
INFO    [05-05 15:28:55] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-05 15:28:55] validate in BasicTrainer:
{'Recall@10': 0.0160946978086775, 'NDCG@10': 0.007261971477419138, 'MRR@10': 0.004662966059351509, 'Recall@5': 0.008004553531381216, 'NDCG@5': 0.004683329575610432, 'MRR@5': 0.003620566694404591, 'Recall*@10': 0.0160946978086775, 'NDCG*@10': 0.007261971477419138, 'MRR*@10': 0.004662966059351509, 'Recall*@5': 0.008004553531381216, 'NDCG*@5': 0.004683329575610432, 'MRR*@5': 0.003620566694404591}
INFO    [05-05 15:28:55] train in BasicTrainer:
duration: 31.360791206359863s
INFO    [05-05 15:28:55] train in BasicTrainer:
epoch: 7
INFO    [05-05 15:29:08] _train_one_epoch in BasicTrainer:
loss = 6.505625239440373
INFO    [05-05 15:29:27] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-05 15:29:28] validate in BasicTrainer:
{'Recall@10': 0.018305917693810028, 'NDCG@10': 0.008160898207940838, 'MRR@10': 0.005172321255403486, 'Recall@5': 0.008997596630995924, 'NDCG@5': 0.005185106134211475, 'MRR@5': 0.003964242250235243, 'Recall*@10': 0.018305917693810028, 'NDCG*@10': 0.008160898207940838, 'MRR*@10': 0.005172321255403486, 'Recall*@5': 0.008997596630995924, 'NDCG*@5': 0.005185106134211475, 'MRR*@5': 0.003964242250235243}
INFO    [05-05 15:29:28] train in BasicTrainer:
duration: 32.77043437957764s
INFO    [05-05 15:29:28] train in BasicTrainer:
epoch: 8
INFO    [05-05 15:29:41] _train_one_epoch in BasicTrainer:
loss = 6.424998300416129
INFO    [05-05 15:30:00] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-05 15:30:00] validate in BasicTrainer:
{'Recall@10': 0.019837345250628212, 'NDCG@10': 0.008809829384765842, 'MRR@10': 0.005566593047908761, 'Recall@5': 0.009291840463199398, 'NDCG@5': 0.0054410064846954565, 'MRR@5': 0.004200594647872177, 'Recall*@10': 0.019837345250628212, 'NDCG*@10': 0.008809829384765842, 'MRR*@10': 0.005566593047908761, 'Recall*@5': 0.009291840463199398, 'NDCG*@5': 0.0054410064846954565, 'MRR*@5': 0.004200594647872177}
INFO    [05-05 15:30:00] train in BasicTrainer:
duration: 32.124539852142334s
INFO    [05-05 15:30:00] train in BasicTrainer:
epoch: 9
INFO    [05-05 15:30:13] _train_one_epoch in BasicTrainer:
loss = 6.350623173373086
INFO    [05-05 15:30:32] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-05 15:30:32] validate in BasicTrainer:
{'Recall@10': 0.02095784213055264, 'NDCG@10': 0.00903247432275252, 'MRR@10': 0.005548652473159812, 'Recall@5': 0.008906291882422838, 'NDCG@5': 0.0051955238450318575, 'MRR@5': 0.004000275755639781, 'Recall*@10': 0.02095784213055264, 'NDCG*@10': 0.00903247432275252, 'MRR*@10': 0.005548652473159812, 'Recall*@5': 0.008906291882422838, 'NDCG*@5': 0.0051955238450318575, 'MRR*@5': 0.004000275755639781}
INFO    [05-05 15:30:32] train in BasicTrainer:
duration: 32.59776306152344s
INFO    [05-05 15:30:32] train in BasicTrainer:
epoch: 10
INFO    [05-05 15:30:45] _train_one_epoch in BasicTrainer:
loss = 6.2954230308532715
INFO    [05-05 15:31:03] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-05 15:31:03] validate in BasicTrainer:
{'Recall@10': 0.022286330603740433, 'NDCG@10': 0.009580719708041712, 'MRR@10': 0.005857404575429179, 'Recall@5': 0.009863186119632288, 'NDCG@5': 0.005611328323456374, 'MRR@5': 0.004247214391150258, 'Recall*@10': 0.022286330603740433, 'NDCG*@10': 0.009580719708041712, 'MRR*@10': 0.005857404575429179, 'Recall*@5': 0.009863186119632288, 'NDCG*@5': 0.005611328323456374, 'MRR*@5': 0.004247214391150258}
INFO    [05-05 15:31:03] train in BasicTrainer:
duration: 30.990894079208374s
INFO    [05-05 15:31:03] train in BasicTrainer:
epoch: 11
INFO    [05-05 15:31:16] _train_one_epoch in BasicTrainer:
loss = 6.250380303178515
INFO    [05-05 15:31:35] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-05 15:31:35] validate in BasicTrainer:
{'Recall@10': 0.022608483040874653, 'NDCG@10': 0.009765727149153297, 'MRR@10': 0.006001313386315649, 'Recall@5': 0.01032927276735956, 'NDCG@5': 0.005846558773720806, 'MRR@5': 0.00441405481912873, 'Recall*@10': 0.022608483040874653, 'NDCG*@10': 0.009765727149153297, 'MRR*@10': 0.006001313386315649, 'Recall*@5': 0.01032927276735956, 'NDCG*@5': 0.005846558773720806, 'MRR*@5': 0.00441405481912873}
INFO    [05-05 15:31:35] train in BasicTrainer:
duration: 32.086386919021606s
INFO    [05-05 15:31:35] train in BasicTrainer:
epoch: 12
INFO    [05-05 15:31:49] _train_one_epoch in BasicTrainer:
loss = 6.21190823827471
INFO    [05-05 15:32:07] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-05 15:32:07] validate in BasicTrainer:
{'Recall@10': 0.024533699351278217, 'NDCG@10': 0.010503925467756662, 'MRR@10': 0.006391332908110185, 'Recall@5': 0.011058507063849405, 'NDCG@5': 0.006187604443932121, 'MRR@5': 0.004633861636234956, 'Recall*@10': 0.024533699351278217, 'NDCG*@10': 0.010503925467756662, 'MRR*@10': 0.006391332908110185, 'Recall*@5': 0.011058507063849405, 'NDCG*@5': 0.006187604443932121, 'MRR*@5': 0.004633861636234956}
INFO    [05-05 15:32:07] train in BasicTrainer:
duration: 31.945536375045776s
INFO    [05-05 15:32:07] train in BasicTrainer:
epoch: 13
INFO    [05-05 15:32:20] _train_one_epoch in BasicTrainer:
loss = 6.176751026085445
INFO    [05-05 15:32:40] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-05 15:32:40] validate in BasicTrainer:
{'Recall@10': 0.025961732999844986, 'NDCG@10': 0.010925648479976437, 'MRR@10': 0.006524664434519681, 'Recall@5': 0.01151063936677846, 'NDCG@5': 0.006305888845500621, 'MRR@5': 0.004648941928859462, 'Recall*@10': 0.025961732999844986, 'NDCG*@10': 0.010925648479976437, 'MRR*@10': 0.006524664434519681, 'Recall*@5': 0.01151063936677846, 'NDCG*@5': 0.006305888845500621, 'MRR*@5': 0.004648941928859462}
INFO    [05-05 15:32:40] train in BasicTrainer:
duration: 32.36676216125488s
INFO    [05-05 15:32:40] train in BasicTrainer:
epoch: 14
INFO    [05-05 15:32:54] _train_one_epoch in BasicTrainer:
loss = 6.145319700241089
INFO    [05-05 15:33:13] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-05 15:33:13] validate in BasicTrainer:
{'Recall@10': 0.026447487825697117, 'NDCG@10': 0.011362268674102697, 'MRR@10': 0.006918167653070254, 'Recall@5': 0.01233183965086937, 'NDCG@5': 0.0068314474668692456, 'MRR@5': 0.0050678593953224745, 'Recall*@10': 0.026447487825697117, 'NDCG*@10': 0.011362268674102697, 'MRR*@10': 0.006918167653070254, 'Recall*@5': 0.01233183965086937, 'NDCG*@5': 0.0068314474668692456, 'MRR*@5': 0.0050678593953224745}
INFO    [05-05 15:33:13] train in BasicTrainer:
duration: 33.02323532104492s
INFO    [05-05 15:33:13] train in BasicTrainer:
epoch: 15
INFO    [05-05 15:33:26] _train_one_epoch in BasicTrainer:
loss = 6.114230717931475
INFO    [05-05 15:33:46] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-05 15:33:46] validate in BasicTrainer:
{'Recall@10': 0.0266795392063531, 'NDCG@10': 0.011472869918427685, 'MRR@10': 0.006990666501224041, 'Recall@5': 0.012653330764309927, 'NDCG@5': 0.006985368291762742, 'MRR@5': 0.0051668870516798715, 'Recall*@10': 0.0266795392063531, 'NDCG*@10': 0.011472869918427685, 'MRR*@10': 0.006990666501224041, 'Recall*@5': 0.012653330764309927, 'NDCG*@5': 0.006985368291762742, 'MRR*@5': 0.0051668870516798715}
INFO    [05-05 15:33:46] train in BasicTrainer:
duration: 32.98167848587036s
INFO    [05-05 15:33:46] train in BasicTrainer:
epoch: 16
INFO    [05-05 15:33:59] _train_one_epoch in BasicTrainer:
loss = 6.082281478813717
INFO    [05-05 15:34:17] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-05 15:34:17] validate in BasicTrainer:
{'Recall@10': 0.028549599715254524, 'NDCG@10': 0.012178319760344246, 'MRR@10': 0.0073609540916301985, 'Recall@5': 0.013430141843855381, 'NDCG@5': 0.007363585712896152, 'MRR@5': 0.005417048423127694, 'Recall*@10': 0.028549599715254524, 'NDCG*@10': 0.012178319760344246, 'MRR*@10': 0.0073609540916301985, 'Recall*@5': 0.013430141843855381, 'NDCG*@5': 0.007363585712896152, 'MRR*@5': 0.005417048423127694}
INFO    [05-05 15:34:17] train in BasicTrainer:
duration: 31.632978439331055s
INFO    [05-05 15:34:17] train in BasicTrainer:
epoch: 17
DEBUG   [05-05 15:34:28] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 1109005
DEBUG   [05-05 15:34:28] calculate_loss in loss:
pred max in softmax: 0.6582835912704468, argmax 58266007
DEBUG   [05-05 15:34:28] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 7399681
DEBUG   [05-05 15:34:28] calculate_loss in loss:
pred max in softmax: 0.6092187762260437, argmax 6898831
INFO    [05-05 15:34:30] _train_one_epoch in BasicTrainer:
loss = 6.049915926797049
INFO    [05-05 15:34:49] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-05 15:34:49] validate in BasicTrainer:
{'Recall@10': 0.030338460918177258, 'NDCG@10': 0.012935270555317402, 'MRR@10': 0.007807683834636753, 'Recall@5': 0.01436736781827428, 'NDCG@5': 0.007838735822588205, 'MRR@5': 0.005743506787852807, 'Recall*@10': 0.030338460918177258, 'NDCG*@10': 0.012935270555317402, 'MRR*@10': 0.007807683834636753, 'Recall*@5': 0.01436736781827428, 'NDCG*@5': 0.007838735822588205, 'MRR*@5': 0.005743506787852807}
INFO    [05-05 15:34:49] train in BasicTrainer:
duration: 31.906753063201904s
INFO    [05-05 15:34:49] train in BasicTrainer:
epoch: 18
INFO    [05-05 15:35:02] _train_one_epoch in BasicTrainer:
loss = 6.018326086657388
INFO    [05-05 15:35:21] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-05 15:35:21] validate in BasicTrainer:
{'Recall@10': 0.030510965057394722, 'NDCG@10': 0.012954477559436451, 'MRR@10': 0.007780303289605813, 'Recall@5': 0.014534157954833725, 'NDCG@5': 0.007836980787529186, 'MRR@5': 0.005697008349340071, 'Recall*@10': 0.030510965057394722, 'NDCG*@10': 0.012954477559436451, 'MRR*@10': 0.007780303289605813, 'Recall*@5': 0.014534157954833725, 'NDCG*@5': 0.007836980787529186, 'MRR*@5': 0.005697008349340071}
INFO    [05-05 15:35:21] train in BasicTrainer:
duration: 31.46597194671631s
INFO    [05-05 15:35:21] train in BasicTrainer:
epoch: 19
INFO    [05-05 15:35:33] _train_one_epoch in BasicTrainer:
loss = 5.986788077013833
INFO    [05-05 15:35:52] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-05 15:35:53] validate in BasicTrainer:
{'Recall@10': 0.03096815012395382, 'NDCG@10': 0.013171405785463074, 'MRR@10': 0.007930131375112316, 'Recall@5': 0.01471424111249772, 'NDCG@5': 0.007991032166914507, 'MRR@5': 0.005836077457801862, 'Recall*@10': 0.03096815012395382, 'NDCG*@10': 0.013171405785463074, 'MRR*@10': 0.007930131375112316, 'Recall*@5': 0.01471424111249772, 'NDCG*@5': 0.007991032166914507, 'MRR*@5': 0.005836077457801862}
INFO    [05-05 15:35:53] train in BasicTrainer:
duration: 31.95839762687683s
INFO    [05-05 15:35:53] train in BasicTrainer:
epoch: 20
INFO    [05-05 15:36:05] _train_one_epoch in BasicTrainer:
loss = 5.955600338322776
INFO    [05-05 15:36:24] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-05 15:36:24] validate in BasicTrainer:
{'Recall@10': 0.03314827382564545, 'NDCG@10': 0.014081143689426508, 'MRR@10': 0.008453718217259104, 'Recall@5': 0.01575167350132357, 'NDCG@5': 0.008506092666225, 'MRR@5': 0.006182419432496483, 'Recall*@10': 0.03314827382564545, 'NDCG*@10': 0.014081143689426508, 'MRR*@10': 0.008453718217259104, 'Recall*@5': 0.01575167350132357, 'NDCG*@5': 0.008506092666225, 'MRR*@5': 0.006182419432496483}
INFO    [05-05 15:36:24] train in BasicTrainer:
duration: 31.158571243286133s
INFO    [05-05 15:36:24] train in BasicTrainer:
epoch: 21
INFO    [05-05 15:36:36] _train_one_epoch in BasicTrainer:
loss = 5.929081899779184
INFO    [05-05 15:36:56] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-05 15:36:56] validate in BasicTrainer:
{'Recall@10': 0.03321551887149161, 'NDCG@10': 0.014349662698805332, 'MRR@10': 0.008764083454893394, 'Recall@5': 0.016359168020161716, 'NDCG@5': 0.008947645187039267, 'MRR@5': 0.0065635491839864035, 'Recall*@10': 0.03321551887149161, 'NDCG*@10': 0.014349662698805332, 'MRR*@10': 0.008764083454893394, 'Recall*@5': 0.016359168020161716, 'NDCG*@5': 0.008947645187039267, 'MRR*@5': 0.0065635491839864035}
INFO    [05-05 15:36:56] train in BasicTrainer:
duration: 31.903454542160034s
INFO    [05-05 15:36:56] train in BasicTrainer:
epoch: 22
INFO    [05-05 15:37:09] _train_one_epoch in BasicTrainer:
loss = 5.904223731585911
INFO    [05-05 15:37:27] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-05 15:37:28] validate in BasicTrainer:
{'Recall@10': 0.034321400252255524, 'NDCG@10': 0.014573275534944101, 'MRR@10': 0.008745642548257654, 'Recall@5': 0.01649233563379808, 'NDCG@5': 0.008869389537721872, 'MRR@5': 0.006427614822645079, 'Recall*@10': 0.034321400252255524, 'NDCG*@10': 0.014573275534944101, 'MRR*@10': 0.008745642548257654, 'Recall*@5': 0.01649233563379808, 'NDCG*@5': 0.008869389537721872, 'MRR*@5': 0.006427614822645079}
INFO    [05-05 15:37:28] train in BasicTrainer:
duration: 31.858091592788696s
INFO    [05-05 15:37:28] train in BasicTrainer:
epoch: 23
INFO    [05-05 15:37:40] _train_one_epoch in BasicTrainer:
loss = 5.878858983516693
INFO    [05-05 15:37:59] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-05 15:38:00] validate in BasicTrainer:
{'Recall@10': 0.03436073660850525, 'NDCG@10': 0.014720786193555052, 'MRR@10': 0.008911912964487618, 'Recall@5': 0.016611548987301914, 'NDCG@5': 0.009013810364360159, 'MRR@5': 0.006575917740437118, 'Recall*@10': 0.03436073660850525, 'NDCG*@10': 0.014720786193555052, 'MRR*@10': 0.008911912964487618, 'Recall*@5': 0.016611548987301914, 'NDCG*@5': 0.009013810364360159, 'MRR*@5': 0.006575917740437118}
INFO    [05-05 15:38:00] train in BasicTrainer:
duration: 31.98610281944275s
INFO    [05-05 15:38:00] train in BasicTrainer:
epoch: 24
INFO    [05-05 15:38:12] _train_one_epoch in BasicTrainer:
loss = 5.856876143387386
INFO    [05-05 15:38:31] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-05 15:38:31] validate in BasicTrainer:
{'Recall@10': 0.035150840539823876, 'NDCG@10': 0.015232757411219856, 'MRR@10': 0.009336318439719353, 'Recall@5': 0.017382646148855038, 'NDCG@5': 0.009552167982540348, 'MRR@5': 0.007029649928550829, 'Recall*@10': 0.035150840539823876, 'NDCG*@10': 0.015232757411219856, 'MRR*@10': 0.009336318439719353, 'Recall*@5': 0.017382646148855038, 'NDCG*@5': 0.009552167982540348, 'MRR*@5': 0.007029649928550829}
INFO    [05-05 15:38:31] train in BasicTrainer:
duration: 31.14197540283203s
INFO    [05-05 15:38:31] train in BasicTrainer:
epoch: 25
INFO    [05-05 15:38:44] _train_one_epoch in BasicTrainer:
loss = 5.835817933082581
INFO    [05-05 15:39:03] validate in BasicTrainer:
{'Recall@10': 0.0351457880301909, 'NDCG@10': 0.015173896215856075, 'MRR@10': 0.009266888384114613, 'Recall@5': 0.01704720069061626, 'NDCG@5': 0.009380342608148401, 'MRR@5': 0.006910598117180846, 'Recall*@10': 0.0351457880301909, 'NDCG*@10': 0.015173896215856075, 'MRR*@10': 0.009266888384114613, 'Recall*@5': 0.01704720069061626, 'NDCG*@5': 0.009380342608148401, 'MRR*@5': 0.006910598117180846}
INFO    [05-05 15:39:03] train in BasicTrainer:
duration: 32.50267553329468s
INFO    [05-05 15:39:03] train in BasicTrainer:
epoch: 26
INFO    [05-05 15:39:16] _train_one_epoch in BasicTrainer:
loss = 5.815454116889408
INFO    [05-05 15:39:35] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-05 15:39:35] validate in BasicTrainer:
{'Recall@10': 0.03608048774979331, 'NDCG@10': 0.0155309240587733, 'MRR@10': 0.009443506598472595, 'Recall@5': 0.017921030521392822, 'NDCG@5': 0.00971170836551623, 'MRR@5': 0.007072913460433483, 'Recall*@10': 0.03608048774979331, 'NDCG*@10': 0.0155309240587733, 'MRR*@10': 0.009443506598472595, 'Recall*@5': 0.017921030521392822, 'NDCG*@5': 0.00971170836551623, 'MRR*@5': 0.007072913460433483}
INFO    [05-05 15:39:35] train in BasicTrainer:
duration: 31.67343282699585s
INFO    [05-05 15:39:35] train in BasicTrainer:
epoch: 27
INFO    [05-05 15:39:49] _train_one_epoch in BasicTrainer:
loss = 5.797414081437247
INFO    [05-05 15:40:08] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-05 15:40:08] validate in BasicTrainer:
{'Recall@10': 0.03678752719001337, 'NDCG@10': 0.015859896571121433, 'MRR@10': 0.00966073606501926, 'Recall@5': 0.018284384499896656, 'NDCG@5': 0.009942689233205536, 'MRR@5': 0.0072575606490400705, 'Recall*@10': 0.03678752719001337, 'NDCG*@10': 0.015859896571121433, 'MRR*@10': 0.00966073606501926, 'Recall*@5': 0.018284384499896656, 'NDCG*@5': 0.009942689233205536, 'MRR*@5': 0.0072575606490400705}
INFO    [05-05 15:40:08] train in BasicTrainer:
duration: 33.37521553039551s
INFO    [05-05 15:40:08] train in BasicTrainer:
epoch: 28
INFO    [05-05 15:40:21] _train_one_epoch in BasicTrainer:
loss = 5.777594770703997
INFO    [05-05 15:40:40] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-05 15:40:40] validate in BasicTrainer:
{'Recall@10': 0.037833199920979416, 'NDCG@10': 0.016326103274795143, 'MRR@10': 0.00994389478794553, 'Recall@5': 0.01919370178471912, 'NDCG@5': 0.010373743293298916, 'MRR@5': 0.0075309825214472685, 'Recall*@10': 0.037833199920979416, 'NDCG*@10': 0.016326103274795143, 'MRR*@10': 0.00994389478794553, 'Recall*@5': 0.01919370178471912, 'NDCG*@5': 0.010373743293298916, 'MRR*@5': 0.0075309825214472685}
INFO    [05-05 15:40:40] train in BasicTrainer:
duration: 31.432783365249634s
INFO    [05-05 15:40:40] train in BasicTrainer:
epoch: 29
INFO    [05-05 15:40:53] _train_one_epoch in BasicTrainer:
loss = 5.761272098336901
INFO    [05-05 15:41:13] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-05 15:41:13] validate in BasicTrainer:
{'Recall@10': 0.03801075673916123, 'NDCG@10': 0.0165220389819958, 'MRR@10': 0.010136918757449497, 'Recall@5': 0.019288855520161716, 'NDCG@5': 0.01050496440042149, 'MRR@5': 0.007675328461283987, 'Recall*@10': 0.03801075673916123, 'NDCG*@10': 0.0165220389819958, 'MRR*@10': 0.010136918757449497, 'Recall*@5': 0.019288855520161716, 'NDCG*@5': 0.01050496440042149, 'MRR*@5': 0.007675328461283987}
INFO    [05-05 15:41:13] train in BasicTrainer:
duration: 33.093915700912476s
INFO    [05-05 15:41:13] train in BasicTrainer:
epoch: 30
INFO    [05-05 15:41:26] _train_one_epoch in BasicTrainer:
loss = 5.741409736020224
INFO    [05-05 15:41:44] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [05-05 15:41:44] validate in BasicTrainer:
{'Recall@10': 0.03853452544320713, 'NDCG@10': 0.016756418415091255, 'MRR@10': 0.01028981584716927, 'Recall@5': 0.019182935187762432, 'NDCG@5': 0.010526467368684032, 'MRR@5': 0.0077346032908694315, 'Recall*@10': 0.03853452544320713, 'NDCG*@10': 0.016756418415091255, 'MRR*@10': 0.01028981584716927, 'Recall*@5': 0.019182935187762432, 'NDCG*@5': 0.010526467368684032, 'MRR*@5': 0.0077346032908694315}
INFO    [05-05 15:41:44] train in BasicTrainer:
duration: 31.661821842193604s
INFO    [05-05 15:41:44] train in BasicTrainer:
epoch: 31
INFO    [05-05 15:41:58] _train_one_epoch in BasicTrainer:
loss = 5.724072345665523
INFO    [05-05 15:42:18] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-05 15:42:18] validate in BasicTrainer:
{'Recall@10': 0.03884777629917318, 'NDCG@10': 0.016788630322976547, 'MRR@10': 0.010249884629791433, 'Recall@5': 0.019476517696272243, 'NDCG@5': 0.010578840970993042, 'MRR@5': 0.007718808440999551, 'Recall*@10': 0.03884777629917318, 'NDCG*@10': 0.016788630322976547, 'MRR*@10': 0.010249884629791433, 'Recall*@5': 0.019476517696272243, 'NDCG*@5': 0.010578840970993042, 'MRR*@5': 0.007718808440999551}
INFO    [05-05 15:42:18] train in BasicTrainer:
duration: 33.30381369590759s
INFO    [05-05 15:42:18] train in BasicTrainer:
epoch: 32
INFO    [05-05 15:42:31] _train_one_epoch in BasicTrainer:
loss = 5.705923318862915
INFO    [05-05 15:42:49] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-05 15:42:49] validate in BasicTrainer:
{'Recall@10': 0.039375394244085656, 'NDCG@10': 0.01714493901553479, 'MRR@10': 0.010533462363210592, 'Recall@5': 0.020430885593999516, 'NDCG@5': 0.011063168333335356, 'MRR@5': 0.008049072105098854, 'Recall*@10': 0.039375394244085656, 'NDCG*@10': 0.01714493901553479, 'MRR*@10': 0.010533462363210592, 'Recall*@5': 0.020430885593999516, 'NDCG*@5': 0.011063168333335356, 'MRR*@5': 0.008049072105098854}
INFO    [05-05 15:42:49] train in BasicTrainer:
duration: 31.752110958099365s
INFO    [05-05 15:42:49] train in BasicTrainer:
epoch: 33
INFO    [05-05 15:43:02] _train_one_epoch in BasicTrainer:
loss = 5.686473565442221
INFO    [05-05 15:43:21] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-05 15:43:21] validate in BasicTrainer:
{'Recall@10': 0.040587195618586105, 'NDCG@10': 0.017625238407741894, 'MRR@10': 0.010805701836943626, 'Recall@5': 0.020328814163804054, 'NDCG@5': 0.01113198214972561, 'MRR@5': 0.008159534963355823, 'Recall*@10': 0.040587195618586105, 'NDCG*@10': 0.017625238407741894, 'MRR*@10': 0.010805701836943626, 'Recall*@5': 0.020328814163804054, 'NDCG*@5': 0.01113198214972561, 'MRR*@5': 0.008159534963355823}
INFO    [05-05 15:43:21] train in BasicTrainer:
duration: 31.729993104934692s
INFO    [05-05 15:43:21] train in BasicTrainer:
epoch: 34
INFO    [05-05 15:43:34] _train_one_epoch in BasicTrainer:
loss = 5.669047338621957
INFO    [05-05 15:43:53] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-05 15:43:53] validate in BasicTrainer:
{'Recall@10': 0.04176350953904065, 'NDCG@10': 0.018244390629909256, 'MRR@10': 0.011272595602680336, 'Recall@5': 0.02107771672308445, 'NDCG@5': 0.011641687205569311, 'MRR@5': 0.008597996678542007, 'Recall*@10': 0.04176350953904065, 'NDCG*@10': 0.018244390629909256, 'MRR*@10': 0.011272595602680336, 'Recall*@5': 0.02107771672308445, 'NDCG*@5': 0.011641687205569311, 'MRR*@5': 0.008597996678542007}
INFO    [05-05 15:43:53] train in BasicTrainer:
duration: 31.935980558395386s
INFO    [05-05 15:43:53] train in BasicTrainer:
epoch: 35
DEBUG   [05-05 15:44:02] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 5997301
DEBUG   [05-05 15:44:02] calculate_loss in loss:
pred max in softmax: 0.9293884634971619, argmax 57881251
DEBUG   [05-05 15:44:02] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 27634021
DEBUG   [05-05 15:44:02] calculate_loss in loss:
pred max in softmax: 0.8802464008331299, argmax 12537041
INFO    [05-05 15:44:06] _train_one_epoch in BasicTrainer:
loss = 5.649023788315909
INFO    [05-05 15:44:24] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-05 15:44:24] validate in BasicTrainer:
{'Recall@10': 0.042098293588920074, 'NDCG@10': 0.018600120801817287, 'MRR@10': 0.011600325392051176, 'Recall@5': 0.022275564006783745, 'NDCG@5': 0.012281193313273516, 'MRR@5': 0.009045649065890095, 'Recall*@10': 0.042098293588920074, 'NDCG*@10': 0.018600120801817287, 'MRR*@10': 0.011600325392051176, 'Recall*@5': 0.022275564006783745, 'NDCG*@5': 0.012281193313273516, 'MRR*@5': 0.009045649065890095}
INFO    [05-05 15:44:24] train in BasicTrainer:
duration: 31.1292884349823s
INFO    [05-05 15:44:24] train in BasicTrainer:
epoch: 36
INFO    [05-05 15:44:37] _train_one_epoch in BasicTrainer:
loss = 5.63076035465513
INFO    [05-05 15:44:56] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-05 15:44:56] validate in BasicTrainer:
{'Recall@10': 0.042826324023983696, 'NDCG@10': 0.018996517089280216, 'MRR@10': 0.011898321607573465, 'Recall@5': 0.021929351951588284, 'NDCG@5': 0.012282533232461323, 'MRR@5': 0.009152839468284086, 'Recall*@10': 0.042826324023983696, 'NDCG*@10': 0.018996517089280216, 'MRR*@10': 0.011898321607573465, 'Recall*@5': 0.021929351951588284, 'NDCG*@5': 0.012282533232461323, 'MRR*@5': 0.009152839468284086}
INFO    [05-05 15:44:56] train in BasicTrainer:
duration: 31.691402435302734s
INFO    [05-05 15:44:56] train in BasicTrainer:
epoch: 37
INFO    [05-05 15:45:09] _train_one_epoch in BasicTrainer:
loss = 5.612365211759295
INFO    [05-05 15:45:27] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [05-05 15:45:28] validate in BasicTrainer:
{'Recall@10': 0.043871335346590386, 'NDCG@10': 0.019395957446911118, 'MRR@10': 0.012117735872214491, 'Recall@5': 0.02220392752100121, 'NDCG@5': 0.012458197433840145, 'MRR@5': 0.009294145232574507, 'Recall*@10': 0.043871335346590386, 'NDCG*@10': 0.019395957446911118, 'MRR*@10': 0.012117735872214491, 'Recall*@5': 0.02220392752100121, 'NDCG*@5': 0.012458197433840145, 'MRR*@5': 0.009294145232574507}
INFO    [05-05 15:45:28] train in BasicTrainer:
duration: 31.542688608169556s
INFO    [05-05 15:45:28] train in BasicTrainer:
epoch: 38
INFO    [05-05 15:45:40] _train_one_epoch in BasicTrainer:
loss = 5.593552478722164
INFO    [05-05 15:45:59] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-05 15:46:00] validate in BasicTrainer:
{'Recall@10': 0.04457903653383255, 'NDCG@10': 0.019878131760792297, 'MRR@10': 0.01251858752220869, 'Recall@5': 0.023207737302238293, 'NDCG@5': 0.013030468401583757, 'MRR@5': 0.00972900116308169, 'Recall*@10': 0.04457903653383255, 'NDCG*@10': 0.019878131760792297, 'MRR*@10': 0.01251858752220869, 'Recall*@5': 0.023207737302238293, 'NDCG*@5': 0.013030468401583757, 'MRR*@5': 0.00972900116308169}
INFO    [05-05 15:46:00] train in BasicTrainer:
duration: 32.00705099105835s
INFO    [05-05 15:46:00] train in BasicTrainer:
epoch: 39
INFO    [05-05 15:46:12] _train_one_epoch in BasicTrainer:
loss = 5.576139492647989
INFO    [05-05 15:46:30] validate in BasicTrainer:
{'Recall@10': 0.044917008077556435, 'NDCG@10': 0.019720814275470646, 'MRR@10': 0.01224308190020648, 'Recall@5': 0.02239730361510407, 'NDCG@5': 0.012501453134146604, 'MRR@5': 0.00930032671683214, 'Recall*@10': 0.044917008077556435, 'NDCG*@10': 0.019720814275470646, 'MRR*@10': 0.01224308190020648, 'Recall*@5': 0.02239730361510407, 'NDCG*@5': 0.012501453134146604, 'MRR*@5': 0.00930032671683214}
INFO    [05-05 15:46:30] train in BasicTrainer:
duration: 30.910440921783447s
INFO    [05-05 15:46:30] train in BasicTrainer:
epoch: 40
INFO    [05-05 15:46:45] _train_one_epoch in BasicTrainer:
loss = 5.557731739112309
INFO    [05-05 15:47:04] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [05-05 15:47:04] validate in BasicTrainer:
{'Recall@10': 0.0448840470476584, 'NDCG@10': 0.020122322338548573, 'MRR@10': 0.012723607095805082, 'Recall@5': 0.023950925774194977, 'NDCG@5': 0.01341579050164331, 'MRR@5': 0.009992468340153044, 'Recall*@10': 0.0448840470476584, 'NDCG*@10': 0.020122322338548573, 'MRR*@10': 0.012723607095805082, 'Recall*@5': 0.023950925774194977, 'NDCG*@5': 0.01341579050164331, 'MRR*@5': 0.009992468340153044}
INFO    [05-05 15:47:04] train in BasicTrainer:
duration: 33.76829385757446s
INFO    [05-05 15:47:04] train in BasicTrainer:
epoch: 41
INFO    [05-05 15:47:17] _train_one_epoch in BasicTrainer:
loss = 5.540971543107714
INFO    [05-05 15:47:35] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-05 15:47:35] validate in BasicTrainer:
{'Recall@10': 0.04622011428529566, 'NDCG@10': 0.020843471654436806, 'MRR@10': 0.013256872665475716, 'Recall@5': 0.024960449473424393, 'NDCG@5': 0.01402602039954879, 'MRR@5': 0.010476747866381298, 'Recall*@10': 0.04622011428529566, 'NDCG*@10': 0.020843471654436806, 'MRR*@10': 0.013256872665475716, 'Recall*@5': 0.024960449473424393, 'NDCG*@5': 0.01402602039954879, 'MRR*@5': 0.010476747866381298}
INFO    [05-05 15:47:35] train in BasicTrainer:
duration: 31.042209148406982s
INFO    [05-05 15:47:35] train in BasicTrainer:
epoch: 42
INFO    [05-05 15:47:48] _train_one_epoch in BasicTrainer:
loss = 5.524003233228411
INFO    [05-05 15:48:07] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-05 15:48:07] validate in BasicTrainer:
{'Recall@10': 0.04640338502146981, 'NDCG@10': 0.02086327208036726, 'MRR@10': 0.013239745050668716, 'Recall@5': 0.024491175162521275, 'NDCG@5': 0.013835683380338278, 'MRR@5': 0.01037350788035176, 'Recall*@10': 0.04640338502146981, 'NDCG*@10': 0.02086327208036726, 'MRR*@10': 0.013239745050668716, 'Recall*@5': 0.024491175162521275, 'NDCG*@5': 0.013835683380338278, 'MRR*@5': 0.01037350788035176}
INFO    [05-05 15:48:07] train in BasicTrainer:
duration: 31.969168663024902s
INFO    [05-05 15:48:07] train in BasicTrainer:
epoch: 43
INFO    [05-05 15:48:20] _train_one_epoch in BasicTrainer:
loss = 5.503841170242855
INFO    [05-05 15:48:39] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [05-05 15:48:39] validate in BasicTrainer:
{'Recall@10': 0.047308311205018654, 'NDCG@10': 0.021363374184478413, 'MRR@10': 0.01362407131289894, 'Recall@5': 0.024852002886208622, 'NDCG@5': 0.014156130142509937, 'MRR@5': 0.010680807754397392, 'Recall*@10': 0.047308311205018654, 'NDCG*@10': 0.021363374184478413, 'MRR*@10': 0.01362407131289894, 'Recall*@5': 0.024852002886208622, 'NDCG*@5': 0.014156130142509937, 'MRR*@5': 0.010680807754397392}
INFO    [05-05 15:48:39] train in BasicTrainer:
duration: 31.55954384803772s
INFO    [05-05 15:48:39] train in BasicTrainer:
epoch: 44
INFO    [05-05 15:48:51] _train_one_epoch in BasicTrainer:
loss = 5.488417369978769
INFO    [05-05 15:49:11] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-05 15:49:11] validate in BasicTrainer:
{'Recall@10': 0.04840847849845886, 'NDCG@10': 0.02168989824977788, 'MRR@10': 0.013721147806129673, 'Recall@5': 0.025357426059516994, 'NDCG@5': 0.014302800240164453, 'MRR@5': 0.010711602612652561, 'Recall*@10': 0.04840847849845886, 'NDCG*@10': 0.02168989824977788, 'MRR*@10': 0.013721147806129673, 'Recall*@5': 0.025357426059516994, 'NDCG*@5': 0.014302800240164453, 'MRR*@5': 0.010711602612652561}
INFO    [05-05 15:49:11] train in BasicTrainer:
duration: 32.163806676864624s
INFO    [05-05 15:49:11] train in BasicTrainer:
epoch: 45
INFO    [05-05 15:49:23] _train_one_epoch in BasicTrainer:
loss = 5.471939316817692
INFO    [05-05 15:49:42] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-05 15:49:42] validate in BasicTrainer:
{'Recall@10': 0.04792909866029566, 'NDCG@10': 0.021753945641896942, 'MRR@10': 0.013919604434208437, 'Recall@5': 0.026113907552578232, 'NDCG@5': 0.01474704872816801, 'MRR@5': 0.01105580445040356, 'Recall*@10': 0.04792909866029566, 'NDCG*@10': 0.021753945641896942, 'MRR*@10': 0.013919604434208437, 'Recall*@5': 0.026113907552578232, 'NDCG*@5': 0.01474704872816801, 'MRR*@5': 0.01105580445040356}
INFO    [05-05 15:49:42] train in BasicTrainer:
duration: 30.95904302597046s
INFO    [05-05 15:49:42] train in BasicTrainer:
epoch: 46
INFO    [05-05 15:49:55] _train_one_epoch in BasicTrainer:
loss = 5.453025783811297
INFO    [05-05 15:50:14] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-05 15:50:14] validate in BasicTrainer:
{'Recall@10': 0.04979344525120475, 'NDCG@10': 0.022525045851414852, 'MRR@10': 0.014377232386984608, 'Recall@5': 0.027129145169799977, 'NDCG@5': 0.015283364209939133, 'MRR@5': 0.011440045877613804, 'Recall*@10': 0.04979344525120475, 'NDCG*@10': 0.022525045851414852, 'MRR*@10': 0.014377232386984608, 'Recall*@5': 0.027129145169799977, 'NDCG*@5': 0.015283364209939133, 'MRR*@5': 0.011440045877613804}
INFO    [05-05 15:50:14] train in BasicTrainer:
duration: 32.12180423736572s
INFO    [05-05 15:50:14] train in BasicTrainer:
epoch: 47
INFO    [05-05 15:50:28] _train_one_epoch in BasicTrainer:
loss = 5.436495968273708
INFO    [05-05 15:50:46] log in loggers:
Update Best NDCG@10 Model at 47
INFO    [05-05 15:50:46] validate in BasicTrainer:
{'Recall@10': 0.04991013218056072, 'NDCG@10': 0.022806364196267994, 'MRR@10': 0.01469421081922271, 'Recall@5': 0.02702069858258421, 'NDCG@5': 0.015463586727326567, 'MRR@5': 0.01169854478741234, 'Recall*@10': 0.04991013218056072, 'NDCG*@10': 0.022806364196267994, 'MRR*@10': 0.01469421081922271, 'Recall*@5': 0.02702069858258421, 'NDCG*@5': 0.015463586727326567, 'MRR*@5': 0.01169854478741234}
INFO    [05-05 15:50:46] train in BasicTrainer:
duration: 32.181883096694946s
INFO    [05-05 15:50:46] train in BasicTrainer:
epoch: 48
INFO    [05-05 15:50:59] _train_one_epoch in BasicTrainer:
loss = 5.420433180672782
INFO    [05-05 15:51:18] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-05 15:51:18] validate in BasicTrainer:
{'Recall@10': 0.04991771145300432, 'NDCG@10': 0.022906361147761345, 'MRR@10': 0.014800142242827198, 'Recall@5': 0.028069558807394722, 'NDCG@5': 0.01589531341398304, 'MRR@5': 0.011938109316609123, 'Recall*@10': 0.04991771145300432, 'NDCG*@10': 0.022906361147761345, 'MRR*@10': 0.014800142242827198, 'Recall*@5': 0.028069558807394722, 'NDCG*@5': 0.01589531341398304, 'MRR*@5': 0.011938109316609123}
INFO    [05-05 15:51:18] train in BasicTrainer:
duration: 31.830090284347534s
INFO    [05-05 15:51:18] train in BasicTrainer:
epoch: 49
INFO    [05-05 15:51:32] _train_one_epoch in BasicTrainer:
loss = 5.403192383902414
INFO    [05-05 15:51:50] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-05 15:51:51] validate in BasicTrainer:
{'Recall@10': 0.05101414837620475, 'NDCG@10': 0.023443457077849995, 'MRR@10': 0.015174123035235838, 'Recall@5': 0.02831941351971843, 'NDCG@5': 0.01614943544634364, 'MRR@5': 0.012189820324155417, 'Recall*@10': 0.05101414837620475, 'NDCG*@10': 0.023443457077849995, 'MRR*@10': 0.015174123035235838, 'Recall*@5': 0.02831941351971843, 'NDCG*@5': 0.01614943544634364, 'MRR*@5': 0.012189820324155417}
INFO    [05-05 15:51:51] train in BasicTrainer:
duration: 32.56280493736267s
INFO    [05-05 15:51:51] train in BasicTrainer:
epoch: 50
INFO    [05-05 15:52:03] _train_one_epoch in BasicTrainer:
loss = 5.38661242382867
INFO    [05-05 15:52:22] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-05 15:52:23] validate in BasicTrainer:
{'Recall@10': 0.05140222338112918, 'NDCG@10': 0.023826615038243206, 'MRR@10': 0.015561128289184788, 'Recall@5': 0.02861299602822824, 'NDCG@5': 0.016520103270357304, 'MRR@5': 0.012582395395094698, 'Recall*@10': 0.05140222338112918, 'NDCG*@10': 0.023826615038243206, 'MRR*@10': 0.015561128289184788, 'Recall*@5': 0.02861299602822824, 'NDCG*@5': 0.016520103270357304, 'MRR*@5': 0.012582395395094698}
INFO    [05-05 15:52:23] train in BasicTrainer:
duration: 31.989717960357666s
INFO    [05-05 15:52:23] train in BasicTrainer:
epoch: 51
INFO    [05-05 15:52:36] _train_one_epoch in BasicTrainer:
loss = 5.370793129716601
INFO    [05-05 15:52:54] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [05-05 15:52:54] validate in BasicTrainer:
{'Recall@10': 0.051918413151394234, 'NDCG@10': 0.024372263049537487, 'MRR@10': 0.016079238361933014, 'Recall@5': 0.030252870172262192, 'NDCG@5': 0.017418892292136497, 'MRR@5': 0.013240305960855701, 'Recall*@10': 0.051918413151394234, 'NDCG*@10': 0.024372263049537487, 'MRR*@10': 0.016079238361933014, 'Recall*@5': 0.030252870172262192, 'NDCG*@5': 0.017418892292136497, 'MRR*@5': 0.013240305960855701}
INFO    [05-05 15:52:54] train in BasicTrainer:
duration: 31.684032201766968s
INFO    [05-05 15:52:54] train in BasicTrainer:
epoch: 52
INFO    [05-05 15:53:07] _train_one_epoch in BasicTrainer:
loss = 5.3563054374286105
INFO    [05-05 15:53:26] validate in BasicTrainer:
{'Recall@10': 0.05137497593056072, 'NDCG@10': 0.024050758304921063, 'MRR@10': 0.015838953158394856, 'Recall@5': 0.029231918467716736, 'NDCG@5': 0.016941031695089558, 'MRR@5': 0.01293413984504613, 'Recall*@10': 0.05137497593056072, 'NDCG*@10': 0.024050758304921063, 'MRR*@10': 0.015838953158394856, 'Recall*@5': 0.029231918467716736, 'NDCG*@5': 0.016941031695089558, 'MRR*@5': 0.01293413984504613}
INFO    [05-05 15:53:26] train in BasicTrainer:
duration: 32.025468587875366s
INFO    [05-05 15:53:26] train in BasicTrainer:
epoch: 53
DEBUG   [05-05 15:53:35] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 6798661
DEBUG   [05-05 15:53:35] calculate_loss in loss:
pred max in softmax: 0.9799153208732605, argmax 4080977
DEBUG   [05-05 15:53:35] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 2511385
DEBUG   [05-05 15:53:35] calculate_loss in loss:
pred max in softmax: 0.6425149440765381, argmax 41036133
INFO    [05-05 15:53:40] _train_one_epoch in BasicTrainer:
loss = 5.337833975042615
INFO    [05-05 15:53:58] log in loggers:
Update Best NDCG@10 Model at 53
INFO    [05-05 15:53:59] validate in BasicTrainer:
{'Recall@10': 0.052647647532549774, 'NDCG@10': 0.024824154647913845, 'MRR@10': 0.016452213579958134, 'Recall@5': 0.030521731823682785, 'NDCG@5': 0.017739072526720436, 'MRR@5': 0.013567965054376558, 'Recall*@10': 0.052647647532549774, 'NDCG*@10': 0.024824154647913845, 'MRR*@10': 0.016452213579958134, 'Recall*@5': 0.030521731823682785, 'NDCG*@5': 0.017739072526720436, 'MRR*@5': 0.013567965054376558}
INFO    [05-05 15:53:59] train in BasicTrainer:
duration: 32.325302839279175s
INFO    [05-05 15:53:59] train in BasicTrainer:
epoch: 54
INFO    [05-05 15:54:12] _train_one_epoch in BasicTrainer:
loss = 5.322973166193281
INFO    [05-05 15:54:31] validate in BasicTrainer:
{'Recall@10': 0.05222595008936795, 'NDCG@10': 0.02472776377742941, 'MRR@10': 0.016436257568950004, 'Recall@5': 0.030552166598764332, 'NDCG@5': 0.01775892028077082, 'MRR@5': 0.01358366266570308, 'Recall*@10': 0.05222595008936795, 'NDCG*@10': 0.02472776377742941, 'MRR*@10': 0.016436257568950004, 'Recall*@5': 0.030552166598764332, 'NDCG*@5': 0.01775892028077082, 'MRR*@5': 0.01358366266570308}
INFO    [05-05 15:54:31] train in BasicTrainer:
duration: 32.64292073249817s
INFO    [05-05 15:54:31] train in BasicTrainer:
epoch: 55
INFO    [05-05 15:54:44] _train_one_epoch in BasicTrainer:
loss = 5.304963665349143
INFO    [05-05 15:55:03] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [05-05 15:55:03] validate in BasicTrainer:
{'Recall@10': 0.05255886912345886, 'NDCG@10': 0.024928965013135563, 'MRR@10': 0.016614065336232834, 'Recall@5': 0.030502063476226547, 'NDCG@5': 0.017840535887940365, 'MRR@5': 0.013714150864292275, 'Recall*@10': 0.05255886912345886, 'NDCG*@10': 0.024928965013135563, 'MRR*@10': 0.016614065336232834, 'Recall*@5': 0.030502063476226547, 'NDCG*@5': 0.017840535887940365, 'MRR*@5': 0.013714150864292275}
INFO    [05-05 15:55:03] train in BasicTrainer:
duration: 31.641945362091064s
INFO    [05-05 15:55:03] train in BasicTrainer:
epoch: 56
INFO    [05-05 15:55:16] _train_one_epoch in BasicTrainer:
loss = 5.290195405483246
INFO    [05-05 15:55:36] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-05 15:55:36] validate in BasicTrainer:
{'Recall@10': 0.05265841396017508, 'NDCG@10': 0.024961058050394058, 'MRR@10': 0.016611241312189537, 'Recall@5': 0.030658086931163616, 'NDCG@5': 0.017887819981710476, 'MRR@5': 0.013716504401104017, 'Recall*@10': 0.05265841396017508, 'NDCG*@10': 0.024961058050394058, 'MRR*@10': 0.016611241312189537, 'Recall*@5': 0.030658086931163616, 'NDCG*@5': 0.017887819981710476, 'MRR*@5': 0.013716504401104017}
INFO    [05-05 15:55:36] train in BasicTrainer:
duration: 33.13495111465454s
INFO    [05-05 15:55:36] train in BasicTrainer:
epoch: 57
INFO    [05-05 15:55:49] _train_one_epoch in BasicTrainer:
loss = 5.274600531373705
INFO    [05-05 15:56:08] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-05 15:56:08] validate in BasicTrainer:
{'Recall@10': 0.05391273986209522, 'NDCG@10': 0.025730438699776478, 'MRR@10': 0.017250379801473835, 'Recall@5': 0.03117108920758421, 'NDCG@5': 0.01844378374516964, 'MRR@5': 0.014282503419301727, 'Recall*@10': 0.05391273986209522, 'NDCG*@10': 0.025730438699776478, 'MRR*@10': 0.017250379801473835, 'Recall*@5': 0.03117108920758421, 'NDCG*@5': 0.01844378374516964, 'MRR*@5': 0.014282503419301727}
INFO    [05-05 15:56:08] train in BasicTrainer:
duration: 32.16397213935852s
INFO    [05-05 15:56:08] train in BasicTrainer:
epoch: 58
INFO    [05-05 15:56:21] _train_one_epoch in BasicTrainer:
loss = 5.257837550980704
INFO    [05-05 15:56:41] log in loggers:
Update Best NDCG@10 Model at 58
INFO    [05-05 15:56:41] validate in BasicTrainer:
{'Recall@10': 0.05408644777807323, 'NDCG@10': 0.025923624804074116, 'MRR@10': 0.017431318505921146, 'Recall@5': 0.03172848051921888, 'NDCG@5': 0.018739992583339863, 'MRR@5': 0.014493930238214407, 'Recall*@10': 0.05408644777807323, 'NDCG*@10': 0.025923624804074116, 'MRR*@10': 0.017431318505921146, 'Recall*@5': 0.03172848051921888, 'NDCG*@5': 0.018739992583339863, 'MRR*@5': 0.014493930238214407}
INFO    [05-05 15:56:41] train in BasicTrainer:
duration: 32.75379467010498s
INFO    [05-05 15:56:41] train in BasicTrainer:
epoch: 59
INFO    [05-05 15:56:54] _train_one_epoch in BasicTrainer:
loss = 5.242536570344653
INFO    [05-05 15:57:12] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [05-05 15:57:13] validate in BasicTrainer:
{'Recall@10': 0.053853734989057885, 'NDCG@10': 0.026084568012844433, 'MRR@10': 0.017698609016158363, 'Recall@5': 0.031805831092325126, 'NDCG@5': 0.01899238413369114, 'MRR@5': 0.01479406553235921, 'Recall*@10': 0.053853734989057885, 'NDCG*@10': 0.026084568012844433, 'MRR*@10': 0.017698609016158363, 'Recall*@5': 0.031805831092325126, 'NDCG*@5': 0.01899238413369114, 'MRR*@5': 0.01479406553235921}
INFO    [05-05 15:57:13] train in BasicTrainer:
duration: 31.673157453536987s
INFO    [05-05 15:57:13] close_training in BasicTrainer:
finished training
DEBUG   [05-05 15:57:13] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3361 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-05 15:57:13] run_routine in Routine:
Finished training, Start final validation
INFO    [05-05 15:57:13] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-05 15:57:13] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 15:57:13] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 15:57:33] validate in BasicTrainer:
{'Recall@10': 0.053853734989057885, 'NDCG@10': 0.026084568012844433, 'MRR@10': 0.017698609016158363, 'Recall@5': 0.031805831092325126, 'NDCG@5': 0.01899238413369114, 'MRR@5': 0.01479406553235921, 'Recall*@10': 0.053853734989057885, 'NDCG*@10': 0.026084568012844433, 'MRR*@10': 0.017698609016158363, 'Recall*@5': 0.031805831092325126, 'NDCG*@5': 0.01899238413369114, 'MRR*@5': 0.01479406553235921}
INFO    [05-05 15:57:33] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.053853734989057885, 'NDCG@10': 0.026084568012844433, 'MRR@10': 0.017698609016158363, 'Recall@5': 0.031805831092325126, 'NDCG@5': 0.01899238413369114, 'MRR@5': 0.01479406553235921, 'Recall*@10': 0.053853734989057885, 'NDCG*@10': 0.026084568012844433, 'MRR*@10': 0.017698609016158363, 'Recall*@5': 0.031805831092325126, 'NDCG*@5': 0.01899238413369114, 'MRR*@5': 0.01479406553235921}
INFO    [05-05 15:57:33] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-05 15:57:33] test in BasicTrainer:
Test model on test set!
INFO    [05-05 15:57:33] test_with_given_state_path in BasicTrainer:
Loading model params from ___yelp_soft_2022/pop_narm-T-1.0-al-0.5_05-05_15:23_t2/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-05 15:57:33] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 15:57:33] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 15:57:33] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-05 15:57:51] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.04647754810073159, 'NDCG@10': 0.02168971198526296, 'MRR@10': 0.014233569360592148, 'Recall@5': 0.026621195741675117, 'NDCG@5': 0.015332463874735615, 'MRR@5': 0.011647254905917427, 'Recall*@10': 0.04647754810073159, 'NDCG*@10': 0.02168971198526296, 'MRR*@10': 0.014233569360592148, 'Recall*@5': 0.026621195741675117, 'NDCG*@5': 0.015332463874735615, 'MRR*@5': 0.011647254905917427}
INFO    [05-05 15:57:52] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.04647754810073159, 'NDCG@10': 0.02168971198526296, 'MRR@10': 0.014233569360592148, 'Recall@5': 0.026621195741675117, 'NDCG@5': 0.015332463874735615, 'MRR@5': 0.011647254905917427, 'Recall*@10': 0.04647754810073159, 'NDCG*@10': 0.02168971198526296, 'MRR*@10': 0.014233569360592148, 'Recall*@5': 0.026621195741675117, 'NDCG*@5': 0.015332463874735615, 'MRR*@5': 0.011647254905917427}
