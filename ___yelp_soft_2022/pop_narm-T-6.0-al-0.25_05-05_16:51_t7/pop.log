INFO    [05-05 16:51:47] setup_train in utils:
{
    "experiment_dir": "___yelp_soft_2022",
    "experiment_description": "pop",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "yelp.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "alpha": 0.25,
    "T": 6.0,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.yelp/narm/config_distill.json",
    "task_id": 7,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "dvae_alpha": 0.5,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-05 16:51:47] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-05 16:51:47] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/yelp-5-5.pkl
INFO    [05-05 16:51:47] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-05 16:51:47] _check_dataset_cache in utils:
correct.
INFO    [05-05 16:51:47] __init__ in NextItemDataloader:
there are 20033 items in this dataset, 43947 users, padding_first? False
DEBUG   [05-05 16:51:55] generate_model in utils:
model_code_list=['pop']
INFO    [05-05 16:51:55] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-05 16:51:55] load_model_config in utils:
{}
WARNING [05-05 16:52:00] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.25_05-05_16:51_t7/teacher_pop_logs does not exist! Create one.
WARNING [05-05 16:52:00] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.25_05-05_16:51_t7/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-05 16:52:00] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.25_05-05_16:51_t7/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-05 16:52:00] get_path in utils:
Path is None
WARNING [05-05 16:52:00] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 16:52:00] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-05 16:52:00] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 16:52:00] __init__ in BasicTrainer:
229376 iter per epoch
DEBUG   [05-05 16:52:00] generate_model in utils:
model_code_list=['narm']
INFO    [05-05 16:52:00] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-05 16:52:00] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-05 16:52:03] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.25_05-05_16:51_t7/student_narm_logs does not exist! Create one.
WARNING [05-05 16:52:03] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.25_05-05_16:51_t7/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-05 16:52:03] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.25_05-05_16:51_t7/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-05 16:52:03] get_path in utils:
Path is None
WARNING [05-05 16:52:03] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 16:52:03] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(20034, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-05 16:52:03] assert_model_device in utils:
model student_narm has 5.3603515625 MB params.
INFO    [05-05 16:52:03] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 16:52:03] __init__ in DistillTrainer:
229376 iter per epoch
INFO    [05-05 16:52:03] _set_current_routine in Routine:
first routine: student
INFO    [05-05 16:52:03] run_routine in Routine:
Start routine student
INFO    [05-05 16:52:03] run_routine in Routine:
Start training
INFO    [05-05 16:52:03] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-05 16:52:22] test_mentor in DistillTrainer:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 16:52:22] train in DistillTrainer:
result:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 16:52:41] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 16:52:41] validate in BasicTrainer:
{'Recall@10': 0.00044389204545454544, 'NDCG@10': 0.0002111054676457901, 'MRR@10': 0.0001419221515044972, 'Recall@5': 0.0003107244318181818, 'NDCG@5': 0.0001693654326531528, 'MRR@5': 0.00012539950462682597, 'Recall*@10': 0.00044389204545454544, 'NDCG*@10': 0.0002111054676457901, 'MRR*@10': 0.0001419221515044972, 'Recall*@5': 0.0003107244318181818, 'NDCG*@5': 0.0001693654326531528, 'MRR*@5': 0.00012539950462682597}
INFO    [05-05 16:52:41] train in BasicTrainer:
epoch: 0
DEBUG   [05-05 16:52:41] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 9282877
DEBUG   [05-05 16:52:41] calculate_loss in loss:
pred max in softmax: 5.0033249863190576e-05, argmax 48228322
INFO    [05-05 16:52:49] _train_one_epoch in BasicTrainer:
loss = 8.455405337469918
INFO    [05-05 16:53:08] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 16:53:08] validate in BasicTrainer:
{'Recall@10': 0.010739542289891026, 'NDCG@10': 0.0056339727545326405, 'MRR@10': 0.004121316194703633, 'Recall@5': 0.0060907650569623165, 'NDCG@5': 0.004143860995430838, 'MRR@5': 0.0035138862969523125, 'Recall*@10': 0.010739542289891026, 'NDCG*@10': 0.0056339727545326405, 'MRR*@10': 0.004121316194703633, 'Recall*@5': 0.0060907650569623165, 'NDCG*@5': 0.004143860995430838, 'MRR*@5': 0.0035138862969523125}
INFO    [05-05 16:53:08] train in BasicTrainer:
duration: 27.41722345352173s
INFO    [05-05 16:53:08] train in BasicTrainer:
epoch: 1
INFO    [05-05 16:53:16] _train_one_epoch in BasicTrainer:
loss = 7.904125060353961
INFO    [05-05 16:53:35] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-05 16:53:36] validate in BasicTrainer:
{'Recall@10': 0.022297758609056473, 'NDCG@10': 0.011240368200974031, 'MRR@10': 0.00791993834586306, 'Recall@5': 0.01304459326307882, 'NDCG@5': 0.008261637084863403, 'MRR@5': 0.006698582490736788, 'Recall*@10': 0.022297758609056473, 'NDCG*@10': 0.011240368200974031, 'MRR*@10': 0.00791993834586306, 'Recall*@5': 0.01304459326307882, 'NDCG*@5': 0.008261637084863403, 'MRR*@5': 0.006698582490736788}
INFO    [05-05 16:53:36] train in BasicTrainer:
duration: 27.562906980514526s
INFO    [05-05 16:53:36] train in BasicTrainer:
epoch: 2
INFO    [05-05 16:53:44] _train_one_epoch in BasicTrainer:
loss = 7.463723250797817
INFO    [05-05 16:54:02] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-05 16:54:02] validate in BasicTrainer:
{'Recall@10': 0.031091212379661472, 'NDCG@10': 0.015521425669166174, 'MRR@10': 0.010868551675230265, 'Recall@5': 0.017837966114959934, 'NDCG@5': 0.011260904752734032, 'MRR@5': 0.009125198660926386, 'Recall*@10': 0.031091212379661472, 'NDCG*@10': 0.015521425669166174, 'MRR*@10': 0.010868551675230265, 'Recall*@5': 0.017837966114959934, 'NDCG*@5': 0.011260904752734032, 'MRR*@5': 0.009125198660926386}
INFO    [05-05 16:54:02] train in BasicTrainer:
duration: 26.845760107040405s
INFO    [05-05 16:54:02] train in BasicTrainer:
epoch: 3
INFO    [05-05 16:54:11] _train_one_epoch in BasicTrainer:
loss = 7.245492202895028
INFO    [05-05 16:54:30] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-05 16:54:30] validate in BasicTrainer:
{'Recall@10': 0.03591622378338467, 'NDCG@10': 0.017878836020827293, 'MRR@10': 0.012461788867684927, 'Recall@5': 0.021371960470622235, 'NDCG@5': 0.013219286179678007, 'MRR@5': 0.010564428415488113, 'Recall*@10': 0.03591622378338467, 'NDCG*@10': 0.017878836020827293, 'MRR*@10': 0.012461788867684927, 'Recall*@5': 0.021371960470622235, 'NDCG*@5': 0.013219286179678007, 'MRR*@5': 0.010564428415488113}
INFO    [05-05 16:54:30] train in BasicTrainer:
duration: 27.448829174041748s
INFO    [05-05 16:54:30] train in BasicTrainer:
epoch: 4
INFO    [05-05 16:54:39] _train_one_epoch in BasicTrainer:
loss = 7.117648686681475
INFO    [05-05 16:54:57] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-05 16:54:58] validate in BasicTrainer:
{'Recall@10': 0.03944384306669235, 'NDCG@10': 0.019788532263853333, 'MRR@10': 0.013900114223361015, 'Recall@5': 0.02316521311348135, 'NDCG@5': 0.014556906778704037, 'MRR@5': 0.01176020951772278, 'Recall*@10': 0.03944384306669235, 'NDCG*@10': 0.019788532263853333, 'MRR*@10': 0.013900114223361015, 'Recall*@5': 0.02316521311348135, 'NDCG*@5': 0.014556906778704037, 'MRR*@5': 0.01176020951772278}
INFO    [05-05 16:54:58] train in BasicTrainer:
duration: 27.65076184272766s
INFO    [05-05 16:54:58] train in BasicTrainer:
epoch: 5
INFO    [05-05 16:55:06] _train_one_epoch in BasicTrainer:
loss = 7.014325252601078
INFO    [05-05 16:55:25] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-05 16:55:25] validate in BasicTrainer:
{'Recall@10': 0.044240403581749306, 'NDCG@10': 0.022567512128840794, 'MRR@10': 0.016077304682271046, 'Recall@5': 0.02594525231556459, 'NDCG@5': 0.016699994490905243, 'MRR@5': 0.01368406889113513, 'Recall*@10': 0.044240403581749306, 'NDCG*@10': 0.022567512128840794, 'MRR*@10': 0.016077304682271046, 'Recall*@5': 0.02594525231556459, 'NDCG*@5': 0.016699994490905243, 'MRR*@5': 0.01368406889113513}
INFO    [05-05 16:55:25] train in BasicTrainer:
duration: 27.73686146736145s
INFO    [05-05 16:55:25] train in BasicTrainer:
epoch: 6
INFO    [05-05 16:55:34] _train_one_epoch in BasicTrainer:
loss = 6.92046867949622
INFO    [05-05 16:55:52] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-05 16:55:52] validate in BasicTrainer:
{'Recall@10': 0.04575216262177988, 'NDCG@10': 0.023423943837935276, 'MRR@10': 0.01673144872554324, 'Recall@5': 0.02703212658790025, 'NDCG@5': 0.017417111180045387, 'MRR@5': 0.014279801313850012, 'Recall*@10': 0.04575216262177988, 'NDCG*@10': 0.023423943837935276, 'MRR*@10': 0.01673144872554324, 'Recall*@5': 0.02703212658790025, 'NDCG*@5': 0.017417111180045387, 'MRR*@5': 0.014279801313850012}
INFO    [05-05 16:55:52] train in BasicTrainer:
duration: 26.9390389919281s
INFO    [05-05 16:55:52] train in BasicTrainer:
epoch: 7
INFO    [05-05 16:56:01] _train_one_epoch in BasicTrainer:
loss = 6.832704722881317
INFO    [05-05 16:56:20] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-05 16:56:20] validate in BasicTrainer:
{'Recall@10': 0.04901916059580716, 'NDCG@10': 0.02560759640552781, 'MRR@10': 0.018595816821537235, 'Recall@5': 0.029153906655582516, 'NDCG@5': 0.019225611774758858, 'MRR@5': 0.01598572570153258, 'Recall*@10': 0.04901916059580716, 'NDCG*@10': 0.02560759640552781, 'MRR*@10': 0.018595816821537235, 'Recall*@5': 0.029153906655582516, 'NDCG*@5': 0.019225611774758858, 'MRR*@5': 0.01598572570153258}
INFO    [05-05 16:56:20] train in BasicTrainer:
duration: 28.104945182800293s
INFO    [05-05 16:56:20] train in BasicTrainer:
epoch: 8
INFO    [05-05 16:56:29] _train_one_epoch in BasicTrainer:
loss = 6.747673102787563
INFO    [05-05 16:56:47] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-05 16:56:47] validate in BasicTrainer:
{'Recall@10': 0.05207882821559906, 'NDCG@10': 0.027884553440592506, 'MRR@10': 0.02062486196783456, 'Recall@5': 0.03196943365037441, 'NDCG@5': 0.021447412161664528, 'MRR@5': 0.018006322905421257, 'Recall*@10': 0.05207882821559906, 'NDCG*@10': 0.027884553440592506, 'MRR*@10': 0.02062486196783456, 'Recall*@5': 0.03196943365037441, 'NDCG*@5': 0.021447412161664528, 'MRR*@5': 0.018006322905421257}
INFO    [05-05 16:56:47] train in BasicTrainer:
duration: 26.896719932556152s
INFO    [05-05 16:56:47] train in BasicTrainer:
epoch: 9
INFO    [05-05 16:56:56] _train_one_epoch in BasicTrainer:
loss = 6.66749255997794
INFO    [05-05 16:57:15] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-05 16:57:15] validate in BasicTrainer:
{'Recall@10': 0.0567852875048464, 'NDCG@10': 0.03077065555209463, 'MRR@10': 0.022931497205387463, 'Recall@5': 0.03645142066207799, 'NDCG@5': 0.024252602153203705, 'MRR@5': 0.020275037227706474, 'Recall*@10': 0.0567852875048464, 'NDCG*@10': 0.03077065555209463, 'MRR*@10': 0.022931497205387463, 'Recall*@5': 0.03645142066207799, 'NDCG*@5': 0.024252602153203705, 'MRR*@5': 0.020275037227706474}
INFO    [05-05 16:57:15] train in BasicTrainer:
duration: 27.61290979385376s
INFO    [05-05 16:57:15] train in BasicTrainer:
epoch: 10
INFO    [05-05 16:57:24] _train_one_epoch in BasicTrainer:
loss = 6.58826652594975
INFO    [05-05 16:57:42] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-05 16:57:42] validate in BasicTrainer:
{'Recall@10': 0.06136110560460524, 'NDCG@10': 0.03315998004241423, 'MRR@10': 0.024679419161243873, 'Recall@5': 0.03864483738487417, 'NDCG@5': 0.025867919691584328, 'MRR@5': 0.021701656620610844, 'Recall*@10': 0.06136110560460524, 'NDCG*@10': 0.03315998004241423, 'MRR*@10': 0.024679419161243873, 'Recall*@5': 0.03864483738487417, 'NDCG*@5': 0.025867919691584328, 'MRR*@5': 0.021701656620610844}
INFO    [05-05 16:57:42] train in BasicTrainer:
duration: 27.12666630744934s
INFO    [05-05 16:57:42] train in BasicTrainer:
epoch: 11
INFO    [05-05 16:57:50] _train_one_epoch in BasicTrainer:
loss = 6.5116069487163
INFO    [05-05 16:58:09] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-05 16:58:09] validate in BasicTrainer:
{'Recall@10': 0.06453998657790097, 'NDCG@10': 0.035738364200700416, 'MRR@10': 0.027058759196238083, 'Recall@5': 0.04185349155556072, 'NDCG@5': 0.02848554893650792, 'MRR@5': 0.02411371520297094, 'Recall*@10': 0.06453998657790097, 'NDCG*@10': 0.035738364200700416, 'MRR*@10': 0.027058759196238083, 'Recall*@5': 0.04185349155556072, 'NDCG*@5': 0.02848554893650792, 'MRR*@5': 0.02411371520297094}
INFO    [05-05 16:58:09] train in BasicTrainer:
duration: 27.372621059417725s
INFO    [05-05 16:58:09] train in BasicTrainer:
epoch: 12
INFO    [05-05 16:58:18] _train_one_epoch in BasicTrainer:
loss = 6.43947970867157
INFO    [05-05 16:58:36] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-05 16:58:36] validate in BasicTrainer:
{'Recall@10': 0.06690590693192049, 'NDCG@10': 0.03728790818290277, 'MRR@10': 0.02837070721116933, 'Recall@5': 0.04324669898910956, 'NDCG@5': 0.0297084990888834, 'MRR@5': 0.025284534658898006, 'Recall*@10': 0.06690590693192049, 'NDCG*@10': 0.03728790818290277, 'MRR*@10': 0.02837070721116933, 'Recall*@5': 0.04324669898910956, 'NDCG*@5': 0.0297084990888834, 'MRR*@5': 0.025284534658898006}
INFO    [05-05 16:58:36] train in BasicTrainer:
duration: 26.91084337234497s
INFO    [05-05 16:58:36] train in BasicTrainer:
epoch: 13
INFO    [05-05 16:58:45] _train_one_epoch in BasicTrainer:
loss = 6.375255601746695
INFO    [05-05 16:59:04] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-05 16:59:04] validate in BasicTrainer:
{'Recall@10': 0.06935555352406068, 'NDCG@10': 0.03914865174076774, 'MRR@10': 0.030023755505681038, 'Recall@5': 0.046175725080750206, 'NDCG@5': 0.03171243027529933, 'MRR@5': 0.026989857920191505, 'Recall*@10': 0.06935555352406068, 'NDCG*@10': 0.03914865174076774, 'MRR*@10': 0.030023755505681038, 'Recall*@5': 0.046175725080750206, 'NDCG*@5': 0.03171243027529933, 'MRR*@5': 0.026989857920191505}
INFO    [05-05 16:59:04] train in BasicTrainer:
duration: 27.67512607574463s
INFO    [05-05 16:59:04] train in BasicTrainer:
epoch: 14
INFO    [05-05 16:59:12] _train_one_epoch in BasicTrainer:
loss = 6.316509451184954
INFO    [05-05 16:59:31] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-05 16:59:31] validate in BasicTrainer:
{'Recall@10': 0.07126110182567076, 'NDCG@10': 0.0409208783371882, 'MRR@10': 0.031741021539677276, 'Recall@5': 0.0480311702598225, 'NDCG@5': 0.03346059640700167, 'MRR@5': 0.028692427683960308, 'Recall*@10': 0.07126110182567076, 'NDCG*@10': 0.0409208783371882, 'MRR*@10': 0.031741021539677276, 'Recall*@5': 0.0480311702598225, 'NDCG*@5': 0.03346059640700167, 'MRR*@5': 0.028692427683960308}
INFO    [05-05 16:59:31] train in BasicTrainer:
duration: 27.347407579421997s
INFO    [05-05 16:59:31] train in BasicTrainer:
epoch: 15
INFO    [05-05 16:59:40] _train_one_epoch in BasicTrainer:
loss = 6.256374648639134
INFO    [05-05 16:59:58] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-05 16:59:59] validate in BasicTrainer:
{'Recall@10': 0.07239302654157985, 'NDCG@10': 0.041523357345299286, 'MRR@10': 0.032206699760122734, 'Recall@5': 0.0477794503623789, 'NDCG@5': 0.033630245280536736, 'MRR@5': 0.028987564993175594, 'Recall*@10': 0.07239302654157985, 'NDCG*@10': 0.041523357345299286, 'MRR*@10': 0.032206699760122734, 'Recall*@5': 0.0477794503623789, 'NDCG*@5': 0.033630245280536736, 'MRR*@5': 0.028987564993175594}
INFO    [05-05 16:59:59] train in BasicTrainer:
duration: 27.2743136882782s
INFO    [05-05 16:59:59] train in BasicTrainer:
epoch: 16
INFO    [05-05 17:00:07] _train_one_epoch in BasicTrainer:
loss = 6.207219532557896
INFO    [05-05 17:00:26] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-05 17:00:26] validate in BasicTrainer:
{'Recall@10': 0.0751298808238723, 'NDCG@10': 0.04337820309129628, 'MRR@10': 0.033781704577532684, 'Recall@5': 0.05099063129587607, 'NDCG@5': 0.035637671635909515, 'MRR@5': 0.03062464347617193, 'Recall*@10': 0.0751298808238723, 'NDCG*@10': 0.04337820309129628, 'MRR*@10': 0.033781704577532684, 'Recall*@5': 0.05099063129587607, 'NDCG*@5': 0.035637671635909515, 'MRR*@5': 0.03062464347617193}
INFO    [05-05 17:00:26] train in BasicTrainer:
duration: 27.27687644958496s
INFO    [05-05 17:00:26] train in BasicTrainer:
epoch: 17
DEBUG   [05-05 17:00:33] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 1109005
DEBUG   [05-05 17:00:33] calculate_loss in loss:
pred max in softmax: 0.7662491798400879, argmax 48733992
DEBUG   [05-05 17:00:33] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 5496451
DEBUG   [05-05 17:00:33] calculate_loss in loss:
pred max in softmax: 0.7877078652381897, argmax 18392142
INFO    [05-05 17:00:34] _train_one_epoch in BasicTrainer:
loss = 6.160595050879887
INFO    [05-05 17:00:53] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-05 17:00:53] validate in BasicTrainer:
{'Recall@10': 0.07499803534962914, 'NDCG@10': 0.04362369328737259, 'MRR@10': 0.03411678258668293, 'Recall@5': 0.05103249407627366, 'NDCG@5': 0.035924769937992096, 'MRR@5': 0.030968454412438652, 'Recall*@10': 0.07499803534962914, 'NDCG*@10': 0.04362369328737259, 'MRR*@10': 0.03411678258668293, 'Recall*@5': 0.05103249407627366, 'NDCG*@5': 0.035924769937992096, 'MRR*@5': 0.030968454412438652}
INFO    [05-05 17:00:53] train in BasicTrainer:
duration: 27.429191827774048s
INFO    [05-05 17:00:53] train in BasicTrainer:
epoch: 18
INFO    [05-05 17:01:02] _train_one_epoch in BasicTrainer:
loss = 6.11460953950882
INFO    [05-05 17:01:21] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-05 17:01:21] validate in BasicTrainer:
{'Recall@10': 0.07624851234934547, 'NDCG@10': 0.044819027185440063, 'MRR@10': 0.03531633893197233, 'Recall@5': 0.052034439011053604, 'NDCG@5': 0.03707065907391635, 'MRR@5': 0.03216614591127092, 'Recall*@10': 0.07624851234934547, 'NDCG*@10': 0.044819027185440063, 'MRR*@10': 0.03531633893197233, 'Recall*@5': 0.052034439011053604, 'NDCG*@5': 0.03707065907391635, 'MRR*@5': 0.03216614591127092}
INFO    [05-05 17:01:21] train in BasicTrainer:
duration: 27.523560047149658s
INFO    [05-05 17:01:21] train in BasicTrainer:
epoch: 19
INFO    [05-05 17:01:29] _train_one_epoch in BasicTrainer:
loss = 6.073823102882931
INFO    [05-05 17:01:48] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-05 17:01:48] validate in BasicTrainer:
{'Recall@10': 0.07739944417368282, 'NDCG@10': 0.04580482129346241, 'MRR@10': 0.03623292696746913, 'Recall@5': 0.05342379720373587, 'NDCG@5': 0.03810051523826339, 'MRR@5': 0.033081177452748474, 'Recall*@10': 0.07739944417368282, 'NDCG*@10': 0.04580482129346241, 'MRR*@10': 0.03623292696746913, 'Recall*@5': 0.05342379720373587, 'NDCG*@5': 0.03810051523826339, 'MRR*@5': 0.033081177452748474}
INFO    [05-05 17:01:48] train in BasicTrainer:
duration: 27.485978841781616s
INFO    [05-05 17:01:48] train in BasicTrainer:
epoch: 20
INFO    [05-05 17:01:57] _train_one_epoch in BasicTrainer:
loss = 6.033191910811833
INFO    [05-05 17:02:15] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-05 17:02:15] validate in BasicTrainer:
{'Recall@10': 0.07969306680289182, 'NDCG@10': 0.04645578224550594, 'MRR@10': 0.036418142982504585, 'Recall@5': 0.05356267873536457, 'NDCG@5': 0.038060539148070595, 'MRR@5': 0.0329852762886069, 'Recall*@10': 0.07969306680289182, 'NDCG*@10': 0.04645578224550594, 'MRR*@10': 0.036418142982504585, 'Recall*@5': 0.05356267873536457, 'NDCG*@5': 0.038060539148070595, 'MRR*@5': 0.0329852762886069}
INFO    [05-05 17:02:15] train in BasicTrainer:
duration: 27.037821769714355s
INFO    [05-05 17:02:15] train in BasicTrainer:
epoch: 21
INFO    [05-05 17:02:24] _train_one_epoch in BasicTrainer:
loss = 5.995849873338427
INFO    [05-05 17:02:42] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-05 17:02:43] validate in BasicTrainer:
{'Recall@10': 0.07977107844569466, 'NDCG@10': 0.047392757440155205, 'MRR@10': 0.037568282674659385, 'Recall@5': 0.05529067021879283, 'NDCG@5': 0.03949777138504115, 'MRR@5': 0.03432205370204015, 'Recall*@10': 0.07977107844569466, 'NDCG*@10': 0.047392757440155205, 'MRR*@10': 0.037568282674659385, 'Recall*@5': 0.05529067021879283, 'NDCG*@5': 0.03949777138504115, 'MRR*@5': 0.03432205370204015}
INFO    [05-05 17:02:43] train in BasicTrainer:
duration: 27.319119215011597s
INFO    [05-05 17:02:43] train in BasicTrainer:
epoch: 22
INFO    [05-05 17:02:51] _train_one_epoch in BasicTrainer:
loss = 5.956411812986646
INFO    [05-05 17:03:09] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-05 17:03:10] validate in BasicTrainer:
{'Recall@10': 0.07993468100374396, 'NDCG@10': 0.048261662775819954, 'MRR@10': 0.0386197455227375, 'Recall@5': 0.05695207755674015, 'NDCG@5': 0.04084449532357129, 'MRR@5': 0.03556804612956264, 'Recall*@10': 0.07993468100374396, 'NDCG*@10': 0.048261662775819954, 'MRR*@10': 0.0386197455227375, 'Recall*@5': 0.05695207755674015, 'NDCG*@5': 0.04084449532357129, 'MRR*@5': 0.03556804612956264}
INFO    [05-05 17:03:10] train in BasicTrainer:
duration: 27.01898503303528s
INFO    [05-05 17:03:10] train in BasicTrainer:
epoch: 23
INFO    [05-05 17:03:19] _train_one_epoch in BasicTrainer:
loss = 5.922638263021197
INFO    [05-05 17:03:38] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-05 17:03:38] validate in BasicTrainer:
{'Recall@10': 0.080997495488687, 'NDCG@10': 0.04872909154404293, 'MRR@10': 0.03892185132611881, 'Recall@5': 0.05747650766914541, 'NDCG@5': 0.0411535349081863, 'MRR@5': 0.03581338341940533, 'Recall*@10': 0.080997495488687, 'NDCG*@10': 0.04872909154404293, 'MRR*@10': 0.03892185132611881, 'Recall*@5': 0.05747650766914541, 'NDCG*@5': 0.0411535349081863, 'MRR*@5': 0.03581338341940533}
INFO    [05-05 17:03:38] train in BasicTrainer:
duration: 28.686649322509766s
INFO    [05-05 17:03:38] train in BasicTrainer:
epoch: 24
INFO    [05-05 17:03:47] _train_one_epoch in BasicTrainer:
loss = 5.887768379279545
INFO    [05-05 17:04:05] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-05 17:04:06] validate in BasicTrainer:
{'Recall@10': 0.08235257051207802, 'NDCG@10': 0.04968513683839278, 'MRR@10': 0.039792450991543854, 'Recall@5': 0.057453651997176086, 'NDCG@5': 0.04170516031709584, 'MRR@5': 0.03654096851294691, 'Recall*@10': 0.08235257051207802, 'NDCG*@10': 0.04968513683839278, 'MRR*@10': 0.039792450991543854, 'Recall*@5': 0.057453651997176086, 'NDCG*@5': 0.04170516031709584, 'MRR*@5': 0.03654096851294691}
INFO    [05-05 17:04:06] train in BasicTrainer:
duration: 27.22133183479309s
INFO    [05-05 17:04:06] train in BasicTrainer:
epoch: 25
INFO    [05-05 17:04:14] _train_one_epoch in BasicTrainer:
loss = 5.854761779308319
INFO    [05-05 17:04:34] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-05 17:04:34] validate in BasicTrainer:
{'Recall@10': 0.08413451368158514, 'NDCG@10': 0.050543148747899315, 'MRR@10': 0.04035598446022381, 'Recall@5': 0.05868325653401288, 'NDCG@5': 0.04234664175998081, 'MRR@5': 0.03699156879024072, 'Recall*@10': 0.08413451368158514, 'NDCG*@10': 0.050543148747899315, 'MRR*@10': 0.04035598446022381, 'Recall*@5': 0.05868325653401288, 'NDCG*@5': 0.04234664175998081, 'MRR*@5': 0.03699156879024072}
INFO    [05-05 17:04:34] train in BasicTrainer:
duration: 28.260612726211548s
INFO    [05-05 17:04:34] train in BasicTrainer:
epoch: 26
INFO    [05-05 17:04:42] _train_one_epoch in BasicTrainer:
loss = 5.82258415222168
INFO    [05-05 17:05:01] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-05 17:05:01] validate in BasicTrainer:
{'Recall@10': 0.08419857106425545, 'NDCG@10': 0.05151566388932141, 'MRR@10': 0.041576573117212814, 'Recall@5': 0.06069340252063491, 'NDCG@5': 0.04399097575382753, 'MRR@5': 0.038515619933605194, 'Recall*@10': 0.08419857106425545, 'NDCG*@10': 0.05151566388932141, 'MRR*@10': 0.041576573117212814, 'Recall*@5': 0.06069340252063491, 'NDCG*@5': 0.04399097575382753, 'MRR*@5': 0.038515619933605194}
INFO    [05-05 17:05:01] train in BasicTrainer:
duration: 27.483514308929443s
INFO    [05-05 17:05:01] train in BasicTrainer:
epoch: 27
INFO    [05-05 17:05:10] _train_one_epoch in BasicTrainer:
loss = 5.794527590274811
INFO    [05-05 17:05:29] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-05 17:05:29] validate in BasicTrainer:
{'Recall@10': 0.08544519882310521, 'NDCG@10': 0.05179494246840477, 'MRR@10': 0.041594846682115036, 'Recall@5': 0.05984110588377172, 'NDCG@5': 0.043564283373680984, 'MRR@5': 0.03822613846171986, 'Recall*@10': 0.08544519882310521, 'NDCG*@10': 0.05179494246840477, 'MRR*@10': 0.041594846682115036, 'Recall*@5': 0.05984110588377172, 'NDCG*@5': 0.043564283373680984, 'MRR*@5': 0.03822613846171986}
INFO    [05-05 17:05:29] train in BasicTrainer:
duration: 28.164700508117676s
INFO    [05-05 17:05:29] train in BasicTrainer:
epoch: 28
INFO    [05-05 17:05:38] _train_one_epoch in BasicTrainer:
loss = 5.764089635440281
INFO    [05-05 17:05:57] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-05 17:05:57] validate in BasicTrainer:
{'Recall@10': 0.08653592182831331, 'NDCG@10': 0.052722604098645126, 'MRR@10': 0.04244052449410612, 'Recall@5': 0.06185894967480139, 'NDCG@5': 0.04481292007998987, 'MRR@5': 0.03921733932061629, 'Recall*@10': 0.08653592182831331, 'NDCG*@10': 0.052722604098645126, 'MRR*@10': 0.04244052449410612, 'Recall*@5': 0.06185894967480139, 'NDCG*@5': 0.04481292007998987, 'MRR*@5': 0.03921733932061629}
INFO    [05-05 17:05:57] train in BasicTrainer:
duration: 27.685332536697388s
INFO    [05-05 17:05:57] train in BasicTrainer:
epoch: 29
INFO    [05-05 17:06:06] _train_one_epoch in BasicTrainer:
loss = 5.7359216042927335
INFO    [05-05 17:06:25] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-05 17:06:26] validate in BasicTrainer:
{'Recall@10': 0.08676424351605502, 'NDCG@10': 0.05318541858683933, 'MRR@10': 0.04297642782330513, 'Recall@5': 0.06179555370049043, 'NDCG@5': 0.04514581100507216, 'MRR@5': 0.03967894071882421, 'Recall*@10': 0.08676424351605502, 'NDCG*@10': 0.05318541858683933, 'MRR*@10': 0.04297642782330513, 'Recall*@5': 0.06179555370049043, 'NDCG*@5': 0.04514581100507216, 'MRR*@5': 0.03967894071882421}
INFO    [05-05 17:06:26] train in BasicTrainer:
duration: 28.42549228668213s
INFO    [05-05 17:06:26] train in BasicTrainer:
epoch: 30
INFO    [05-05 17:06:34] _train_one_epoch in BasicTrainer:
loss = 5.705365487507412
INFO    [05-05 17:06:53] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [05-05 17:06:54] validate in BasicTrainer:
{'Recall@10': 0.08794494853778319, 'NDCG@10': 0.05406342379071496, 'MRR@10': 0.0437443849037994, 'Recall@5': 0.06333708661523732, 'NDCG@5': 0.046138395301320335, 'MRR@5': 0.0404928441752087, 'Recall*@10': 0.08794494853778319, 'NDCG*@10': 0.05406342379071496, 'MRR*@10': 0.0437443849037994, 'Recall*@5': 0.06333708661523732, 'NDCG*@5': 0.046138395301320335, 'MRR*@5': 0.0404928441752087}
INFO    [05-05 17:06:54] train in BasicTrainer:
duration: 27.939714670181274s
INFO    [05-05 17:06:54] train in BasicTrainer:
epoch: 31
INFO    [05-05 17:07:03] _train_one_epoch in BasicTrainer:
loss = 5.680647875581469
INFO    [05-05 17:07:21] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-05 17:07:21] validate in BasicTrainer:
{'Recall@10': 0.08846619115634398, 'NDCG@10': 0.05436765199357813, 'MRR@10': 0.04398684982549061, 'Recall@5': 0.06334785304286263, 'NDCG@5': 0.046300475231625816, 'MRR@5': 0.04068952392448078, 'Recall*@10': 0.08846619115634398, 'NDCG*@10': 0.05436765199357813, 'MRR*@10': 0.04398684982549061, 'Recall*@5': 0.06334785304286263, 'NDCG*@5': 0.046300475231625816, 'MRR*@5': 0.04068952392448078}
INFO    [05-05 17:07:21] train in BasicTrainer:
duration: 27.521665573120117s
INFO    [05-05 17:07:21] train in BasicTrainer:
epoch: 32
INFO    [05-05 17:07:30] _train_one_epoch in BasicTrainer:
loss = 5.653689912387303
INFO    [05-05 17:07:49] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-05 17:07:49] validate in BasicTrainer:
{'Recall@10': 0.089384410191666, 'NDCG@10': 0.05492038144306703, 'MRR@10': 0.04444594613530419, 'Recall@5': 0.06364781104705551, 'NDCG@5': 0.04662212627855214, 'MRR@5': 0.0410355461592024, 'Recall*@10': 0.089384410191666, 'NDCG*@10': 0.05492038144306703, 'MRR*@10': 0.04444594613530419, 'Recall*@5': 0.06364781104705551, 'NDCG*@5': 0.04662212627855214, 'MRR*@5': 0.0410355461592024}
INFO    [05-05 17:07:49] train in BasicTrainer:
duration: 28.30172872543335s
INFO    [05-05 17:07:49] train in BasicTrainer:
epoch: 33
INFO    [05-05 17:07:58] _train_one_epoch in BasicTrainer:
loss = 5.628396247114454
INFO    [05-05 17:08:16] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-05 17:08:16] validate in BasicTrainer:
{'Recall@10': 0.08998871730132536, 'NDCG@10': 0.055469961667602714, 'MRR@10': 0.04494939338077198, 'Recall@5': 0.06535360758954828, 'NDCG@5': 0.04753537306731397, 'MRR@5': 0.04169273173267191, 'Recall*@10': 0.08998871730132536, 'NDCG*@10': 0.055469961667602714, 'MRR*@10': 0.04494939338077198, 'Recall*@5': 0.06535360758954828, 'NDCG*@5': 0.04753537306731397, 'MRR*@5': 0.04169273173267191}
INFO    [05-05 17:08:16] train in BasicTrainer:
duration: 27.091858625411987s
INFO    [05-05 17:08:16] train in BasicTrainer:
epoch: 34
INFO    [05-05 17:08:25] _train_one_epoch in BasicTrainer:
loss = 5.60564375775201
INFO    [05-05 17:08:44] validate in BasicTrainer:
{'Recall@10': 0.09048018604516983, 'NDCG@10': 0.05546338686888868, 'MRR@10': 0.04481455345045437, 'Recall@5': 0.06486027382991531, 'NDCG@5': 0.047241641716523605, 'MRR@5': 0.04145881432023915, 'Recall*@10': 0.09048018604516983, 'NDCG*@10': 0.05546338686888868, 'MRR*@10': 0.04481455345045437, 'Recall*@5': 0.06486027382991531, 'NDCG*@5': 0.047241641716523605, 'MRR*@5': 0.04145881432023915}
INFO    [05-05 17:08:44] train in BasicTrainer:
duration: 27.9115571975708s
INFO    [05-05 17:08:44] train in BasicTrainer:
epoch: 35
DEBUG   [05-05 17:08:50] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 5997301
DEBUG   [05-05 17:08:50] calculate_loss in loss:
pred max in softmax: 0.972233772277832, argmax 46870830
DEBUG   [05-05 17:08:51] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 27634021
DEBUG   [05-05 17:08:51] calculate_loss in loss:
pred max in softmax: 0.9543687105178833, argmax 22832122
INFO    [05-05 17:08:53] _train_one_epoch in BasicTrainer:
loss = 5.581305376120976
INFO    [05-05 17:09:11] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-05 17:09:11] validate in BasicTrainer:
{'Recall@10': 0.09011364457282153, 'NDCG@10': 0.05588697811419314, 'MRR@10': 0.045471316372806374, 'Recall@5': 0.06490785052830522, 'NDCG@5': 0.047755549577149475, 'MRR@5': 0.042127171700650994, 'Recall*@10': 0.09011364457282153, 'NDCG*@10': 0.05588697811419314, 'MRR*@10': 0.045471316372806374, 'Recall*@5': 0.06490785052830522, 'NDCG*@5': 0.047755549577149475, 'MRR*@5': 0.042127171700650994}
INFO    [05-05 17:09:11] train in BasicTrainer:
duration: 26.905461072921753s
INFO    [05-05 17:09:11] train in BasicTrainer:
epoch: 36
INFO    [05-05 17:09:20] _train_one_epoch in BasicTrainer:
loss = 5.558854426656451
INFO    [05-05 17:09:39] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-05 17:09:39] validate in BasicTrainer:
{'Recall@10': 0.09140664542263205, 'NDCG@10': 0.05692129853096875, 'MRR@10': 0.046421376818960365, 'Recall@5': 0.06642147492278706, 'NDCG@5': 0.04886422204700383, 'MRR@5': 0.043109561570666054, 'Recall*@10': 0.09140664542263205, 'NDCG*@10': 0.05692129853096875, 'MRR*@10': 0.046421376818960365, 'Recall*@5': 0.06642147492278706, 'NDCG*@5': 0.04886422204700383, 'MRR*@5': 0.043109561570666054}
INFO    [05-05 17:09:39] train in BasicTrainer:
duration: 27.96210265159607s
INFO    [05-05 17:09:39] train in BasicTrainer:
epoch: 37
INFO    [05-05 17:09:48] _train_one_epoch in BasicTrainer:
loss = 5.536205189568656
INFO    [05-05 17:10:06] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [05-05 17:10:07] validate in BasicTrainer:
{'Recall@10': 0.09206610850312492, 'NDCG@10': 0.05727734145793048, 'MRR@10': 0.046658985994078896, 'Recall@5': 0.06690470366315408, 'NDCG@5': 0.0491470606489615, 'MRR@5': 0.04330709745938128, 'Recall*@10': 0.09206610850312492, 'NDCG*@10': 0.05727734145793048, 'MRR*@10': 0.046658985994078896, 'Recall*@5': 0.06690470366315408, 'NDCG*@5': 0.0491470606489615, 'MRR*@5': 0.04330709745938128}
INFO    [05-05 17:10:07] train in BasicTrainer:
duration: 27.5415358543396s
INFO    [05-05 17:10:07] train in BasicTrainer:
epoch: 38
INFO    [05-05 17:10:15] _train_one_epoch in BasicTrainer:
loss = 5.513552478381565
INFO    [05-05 17:10:35] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-05 17:10:35] validate in BasicTrainer:
{'Recall@10': 0.09327538311481476, 'NDCG@10': 0.05803666263818741, 'MRR@10': 0.04727698727087541, 'Recall@5': 0.06758317351341248, 'NDCG@5': 0.04973794045773419, 'MRR@5': 0.04385744577104395, 'Recall*@10': 0.09327538311481476, 'NDCG*@10': 0.05803666263818741, 'MRR*@10': 0.04727698727087541, 'Recall*@5': 0.06758317351341248, 'NDCG*@5': 0.04973794045773419, 'MRR*@5': 0.04385744577104395}
INFO    [05-05 17:10:35] train in BasicTrainer:
duration: 27.942436695098877s
INFO    [05-05 17:10:35] train in BasicTrainer:
epoch: 39
INFO    [05-05 17:10:43] _train_one_epoch in BasicTrainer:
loss = 5.497181262288775
INFO    [05-05 17:11:02] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [05-05 17:11:02] validate in BasicTrainer:
{'Recall@10': 0.0932385731827129, 'NDCG@10': 0.058161297643726524, 'MRR@10': 0.04746994477781383, 'Recall@5': 0.06779435276985168, 'NDCG@5': 0.04995736784555695, 'MRR@5': 0.04409792206504128, 'Recall*@10': 0.0932385731827129, 'NDCG*@10': 0.058161297643726524, 'MRR*@10': 0.04746994477781383, 'Recall*@5': 0.06779435276985168, 'NDCG*@5': 0.04995736784555695, 'MRR*@5': 0.04409792206504128}
INFO    [05-05 17:11:02] train in BasicTrainer:
duration: 26.9950213432312s
INFO    [05-05 17:11:02] train in BasicTrainer:
epoch: 40
INFO    [05-05 17:11:10] _train_one_epoch in BasicTrainer:
loss = 5.475252296243395
INFO    [05-05 17:11:29] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [05-05 17:11:29] validate in BasicTrainer:
{'Recall@10': 0.09305848994038322, 'NDCG@10': 0.05816374922340566, 'MRR@10': 0.04753761772405018, 'Recall@5': 0.0677201896905899, 'NDCG@5': 0.05001535198905251, 'MRR@5': 0.04420138184319843, 'Recall*@10': 0.09305848994038322, 'NDCG*@10': 0.05816374922340566, 'MRR*@10': 0.04753761772405018, 'Recall*@5': 0.0677201896905899, 'NDCG*@5': 0.05001535198905251, 'MRR*@5': 0.04420138184319843}
INFO    [05-05 17:11:29] train in BasicTrainer:
duration: 27.599547147750854s
INFO    [05-05 17:11:29] train in BasicTrainer:
epoch: 41
INFO    [05-05 17:11:38] _train_one_epoch in BasicTrainer:
loss = 5.454969789300646
INFO    [05-05 17:11:57] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-05 17:11:57] validate in BasicTrainer:
{'Recall@10': 0.0937110348181291, 'NDCG@10': 0.05839933184060184, 'MRR@10': 0.047650310464880684, 'Recall@5': 0.0683714124289426, 'NDCG@5': 0.05024806748736988, 'MRR@5': 0.04431131922385909, 'Recall*@10': 0.0937110348181291, 'NDCG*@10': 0.05839933184060184, 'MRR*@10': 0.047650310464880684, 'Recall*@5': 0.0683714124289426, 'NDCG*@5': 0.05024806748736988, 'MRR*@5': 0.04431131922385909}
INFO    [05-05 17:11:57] train in BasicTrainer:
duration: 27.54983901977539s
INFO    [05-05 17:11:57] train in BasicTrainer:
epoch: 42
INFO    [05-05 17:12:06] _train_one_epoch in BasicTrainer:
loss = 5.436526928629194
INFO    [05-05 17:12:24] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-05 17:12:24] validate in BasicTrainer:
{'Recall@10': 0.09416250613602725, 'NDCG@10': 0.05856928906657479, 'MRR@10': 0.047734155573628166, 'Recall@5': 0.06823505732146176, 'NDCG@5': 0.05022566291418942, 'MRR@5': 0.044314024123278534, 'Recall*@10': 0.09416250613602725, 'NDCG*@10': 0.05856928906657479, 'MRR*@10': 0.047734155573628166, 'Recall*@5': 0.06823505732146176, 'NDCG*@5': 0.05022566291418942, 'MRR*@5': 0.044314024123278534}
INFO    [05-05 17:12:24] train in BasicTrainer:
duration: 27.56761932373047s
INFO    [05-05 17:12:24] train in BasicTrainer:
epoch: 43
INFO    [05-05 17:12:33] _train_one_epoch in BasicTrainer:
loss = 5.416817358561924
INFO    [05-05 17:12:51] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [05-05 17:12:52] validate in BasicTrainer:
{'Recall@10': 0.09396275471557271, 'NDCG@10': 0.058968217874115166, 'MRR@10': 0.04828560081395236, 'Recall@5': 0.06906768544153734, 'NDCG@5': 0.050962210378863594, 'MRR@5': 0.04500713775103742, 'Recall*@10': 0.09396275471557271, 'NDCG*@10': 0.058968217874115166, 'MRR*@10': 0.04828560081395236, 'Recall*@5': 0.06906768544153734, 'NDCG*@5': 0.050962210378863594, 'MRR*@5': 0.04500713775103742}
INFO    [05-05 17:12:52] train in BasicTrainer:
duration: 27.166638374328613s
INFO    [05-05 17:12:52] train in BasicTrainer:
epoch: 44
INFO    [05-05 17:13:00] _train_one_epoch in BasicTrainer:
loss = 5.399097536291395
INFO    [05-05 17:13:19] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-05 17:13:19] validate in BasicTrainer:
{'Recall@10': 0.09470022943886844, 'NDCG@10': 0.05953969535502521, 'MRR@10': 0.04882764985615557, 'Recall@5': 0.06917294453490865, 'NDCG@5': 0.05133540284904567, 'MRR@5': 0.04547144235535101, 'Recall*@10': 0.09470022943886844, 'NDCG*@10': 0.05953969535502521, 'MRR*@10': 0.04882764985615557, 'Recall*@5': 0.06917294453490865, 'NDCG*@5': 0.05133540284904567, 'MRR*@5': 0.04547144235535101}
INFO    [05-05 17:13:19] train in BasicTrainer:
duration: 27.473208904266357s
INFO    [05-05 17:13:19] train in BasicTrainer:
epoch: 45
INFO    [05-05 17:13:28] _train_one_epoch in BasicTrainer:
loss = 5.380252420902252
INFO    [05-05 17:13:46] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-05 17:13:46] validate in BasicTrainer:
{'Recall@10': 0.09521389278498563, 'NDCG@10': 0.060047614642164925, 'MRR@10': 0.049320957538756455, 'Recall@5': 0.07026300647042015, 'NDCG@5': 0.05202878672968258, 'MRR@5': 0.04604079134084962, 'Recall*@10': 0.09521389278498563, 'NDCG*@10': 0.060047614642164925, 'MRR*@10': 0.049320957538756455, 'Recall*@5': 0.07026300647042015, 'NDCG*@5': 0.05202878672968258, 'MRR*@5': 0.04604079134084962}
INFO    [05-05 17:13:46] train in BasicTrainer:
duration: 27.247600078582764s
INFO    [05-05 17:13:46] train in BasicTrainer:
epoch: 46
INFO    [05-05 17:13:55] _train_one_epoch in BasicTrainer:
loss = 5.360638090542385
INFO    [05-05 17:14:14] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-05 17:14:14] validate in BasicTrainer:
{'Recall@10': 0.09576117856936021, 'NDCG@10': 0.06038749861446294, 'MRR@10': 0.04960923574187539, 'Recall@5': 0.06980834765867754, 'NDCG@5': 0.0520517998798327, 'MRR@5': 0.046202611178159714, 'Recall*@10': 0.09576117856936021, 'NDCG*@10': 0.06038749861446294, 'MRR*@10': 0.04960923574187539, 'Recall*@5': 0.06980834765867754, 'NDCG*@5': 0.0520517998798327, 'MRR*@5': 0.046202611178159714}
INFO    [05-05 17:14:14] train in BasicTrainer:
duration: 28.120222091674805s
INFO    [05-05 17:14:14] train in BasicTrainer:
epoch: 47
INFO    [05-05 17:14:23] _train_one_epoch in BasicTrainer:
loss = 5.343993263585227
INFO    [05-05 17:14:41] log in loggers:
Update Best NDCG@10 Model at 47
INFO    [05-05 17:14:42] validate in BasicTrainer:
{'Recall@10': 0.09699012203650041, 'NDCG@10': 0.06072090159762989, 'MRR@10': 0.049683038822629234, 'Recall@5': 0.07093137028542432, 'NDCG@5': 0.05235237526622685, 'MRR@5': 0.046262590383941475, 'Recall*@10': 0.09699012203650041, 'NDCG*@10': 0.06072090159762989, 'MRR*@10': 0.049683038822629234, 'Recall*@5': 0.07093137028542432, 'NDCG*@5': 0.05235237526622685, 'MRR*@5': 0.046262590383941475}
INFO    [05-05 17:14:42] train in BasicTrainer:
duration: 27.25619101524353s
INFO    [05-05 17:14:42] train in BasicTrainer:
epoch: 48
INFO    [05-05 17:14:50] _train_one_epoch in BasicTrainer:
loss = 5.328408939497812
INFO    [05-05 17:15:09] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-05 17:15:09] validate in BasicTrainer:
{'Recall@10': 0.09683157232674686, 'NDCG@10': 0.06100200658494776, 'MRR@10': 0.050091912800615486, 'Recall@5': 0.0707620538093827, 'NDCG@5': 0.05261976271867752, 'MRR@5': 0.04666007987477563, 'Recall*@10': 0.09683157232674686, 'NDCG*@10': 0.06100200658494776, 'MRR*@10': 0.050091912800615486, 'Recall*@5': 0.0707620538093827, 'NDCG*@5': 0.05261976271867752, 'MRR*@5': 0.04666007987477563}
INFO    [05-05 17:15:09] train in BasicTrainer:
duration: 27.65753197669983s
INFO    [05-05 17:15:09] train in BasicTrainer:
epoch: 49
INFO    [05-05 17:15:18] _train_one_epoch in BasicTrainer:
loss = 5.313582692827497
INFO    [05-05 17:15:36] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-05 17:15:36] validate in BasicTrainer:
{'Recall@10': 0.09758552773432298, 'NDCG@10': 0.06136129627173597, 'MRR@10': 0.050317078828811646, 'Recall@5': 0.07183816148476167, 'NDCG@5': 0.05308162285522981, 'MRR@5': 0.04692573946985332, 'Recall*@10': 0.09758552773432298, 'NDCG*@10': 0.06136129627173597, 'MRR*@10': 0.050317078828811646, 'Recall*@5': 0.07183816148476167, 'NDCG*@5': 0.05308162285522981, 'MRR*@5': 0.04692573946985332}
INFO    [05-05 17:15:36] train in BasicTrainer:
duration: 27.110277891159058s
INFO    [05-05 17:15:36] train in BasicTrainer:
epoch: 50
INFO    [05-05 17:15:45] _train_one_epoch in BasicTrainer:
loss = 5.296836461339678
INFO    [05-05 17:16:04] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-05 17:16:04] validate in BasicTrainer:
{'Recall@10': 0.09743906693025069, 'NDCG@10': 0.06175843998789787, 'MRR@10': 0.05087381127205762, 'Recall@5': 0.07171070778911764, 'NDCG@5': 0.05348251624540849, 'MRR@5': 0.04748375036499717, 'Recall*@10': 0.09743906693025069, 'NDCG*@10': 0.06175843998789787, 'MRR*@10': 0.05087381127205762, 'Recall*@5': 0.07171070778911764, 'NDCG*@5': 0.05348251624540849, 'MRR*@5': 0.04748375036499717}
INFO    [05-05 17:16:04] train in BasicTrainer:
duration: 27.5488862991333s
INFO    [05-05 17:16:04] train in BasicTrainer:
epoch: 51
INFO    [05-05 17:16:13] _train_one_epoch in BasicTrainer:
loss = 5.285734525748661
INFO    [05-05 17:16:31] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [05-05 17:16:31] validate in BasicTrainer:
{'Recall@10': 0.09705351834947412, 'NDCG@10': 0.06197724491357803, 'MRR@10': 0.05124664645303379, 'Recall@5': 0.07249828563495116, 'NDCG@5': 0.054040320894934914, 'MRR@5': 0.04797321930527687, 'Recall*@10': 0.09705351834947412, 'NDCG*@10': 0.06197724491357803, 'MRR*@10': 0.05124664645303379, 'Recall*@5': 0.07249828563495116, 'NDCG*@5': 0.054040320894934914, 'MRR*@5': 0.04797321930527687}
INFO    [05-05 17:16:31] train in BasicTrainer:
duration: 27.21312713623047s
INFO    [05-05 17:16:31] train in BasicTrainer:
epoch: 52
INFO    [05-05 17:16:40] _train_one_epoch in BasicTrainer:
loss = 5.269352614879608
INFO    [05-05 17:16:59] validate in BasicTrainer:
{'Recall@10': 0.09817401522939856, 'NDCG@10': 0.061796137555079025, 'MRR@10': 0.05070891028100794, 'Recall@5': 0.07200429046695883, 'NDCG@5': 0.05338080295107581, 'MRR@5': 0.04726460000330752, 'Recall*@10': 0.09817401522939856, 'NDCG*@10': 0.061796137555079025, 'MRR*@10': 0.05070891028100794, 'Recall*@5': 0.07200429046695883, 'NDCG*@5': 0.05338080295107581, 'MRR*@5': 0.04726460000330752}
INFO    [05-05 17:16:59] train in BasicTrainer:
duration: 27.835448503494263s
INFO    [05-05 17:16:59] train in BasicTrainer:
epoch: 53
DEBUG   [05-05 17:17:04] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 6798661
DEBUG   [05-05 17:17:04] calculate_loss in loss:
pred max in softmax: 0.931573212146759, argmax 4080977
DEBUG   [05-05 17:17:04] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 2511385
DEBUG   [05-05 17:17:04] calculate_loss in loss:
pred max in softmax: 0.9476698040962219, argmax 54826557
INFO    [05-05 17:17:08] _train_one_epoch in BasicTrainer:
loss = 5.253168514796665
INFO    [05-05 17:17:26] log in loggers:
Update Best NDCG@10 Model at 53
INFO    [05-05 17:17:26] validate in BasicTrainer:
{'Recall@10': 0.09843144904483449, 'NDCG@10': 0.06244380602782423, 'MRR@10': 0.05147494680502198, 'Recall@5': 0.0725927779620344, 'NDCG@5': 0.05412651429122144, 'MRR@5': 0.04806484959342263, 'Recall*@10': 0.09843144904483449, 'NDCG*@10': 0.06244380602782423, 'MRR*@10': 0.05147494680502198, 'Recall*@5': 0.0725927779620344, 'NDCG*@5': 0.05412651429122144, 'MRR*@5': 0.04806484959342263}
INFO    [05-05 17:17:26] train in BasicTrainer:
duration: 27.23678469657898s
INFO    [05-05 17:17:26] train in BasicTrainer:
epoch: 54
INFO    [05-05 17:17:35] _train_one_epoch in BasicTrainer:
loss = 5.243112223488944
INFO    [05-05 17:17:54] validate in BasicTrainer:
{'Recall@10': 0.0978765839880163, 'NDCG@10': 0.06214539943770929, 'MRR@10': 0.05120883136987686, 'Recall@5': 0.07284263250502673, 'NDCG@5': 0.05408947542309761, 'MRR@5': 0.04790744151581417, 'Recall*@10': 0.0978765839880163, 'NDCG*@10': 0.06214539943770929, 'MRR*@10': 0.05120883136987686, 'Recall*@5': 0.07284263250502673, 'NDCG*@5': 0.05408947542309761, 'MRR*@5': 0.04790744151581417}
INFO    [05-05 17:17:54] train in BasicTrainer:
duration: 27.889030933380127s
INFO    [05-05 17:17:54] train in BasicTrainer:
epoch: 55
INFO    [05-05 17:18:03] _train_one_epoch in BasicTrainer:
loss = 5.229444691113064
INFO    [05-05 17:18:21] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [05-05 17:18:22] validate in BasicTrainer:
{'Recall@10': 0.09765529903498563, 'NDCG@10': 0.06267635490406644, 'MRR@10': 0.05200279605659572, 'Recall@5': 0.07285021177747032, 'NDCG@5': 0.0546769384633411, 'MRR@5': 0.04871413348750635, 'Recall*@10': 0.09765529903498563, 'NDCG*@10': 0.06267635490406644, 'MRR*@10': 0.05200279605659572, 'Recall*@5': 0.07285021177747032, 'NDCG*@5': 0.0546769384633411, 'MRR*@5': 0.04871413348750635}
INFO    [05-05 17:18:22] train in BasicTrainer:
duration: 27.468017101287842s
INFO    [05-05 17:18:22] train in BasicTrainer:
epoch: 56
INFO    [05-05 17:18:31] _train_one_epoch in BasicTrainer:
loss = 5.215474375656673
INFO    [05-05 17:18:50] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-05 17:18:50] validate in BasicTrainer:
{'Recall@10': 0.09862548654729669, 'NDCG@10': 0.06310064684260976, 'MRR@10': 0.05225102400237864, 'Recall@5': 0.07364921745928851, 'NDCG@5': 0.05507793853228742, 'MRR@5': 0.04897100376811894, 'Recall*@10': 0.09862548654729669, 'NDCG*@10': 0.06310064684260976, 'MRR*@10': 0.05225102400237864, 'Recall*@5': 0.07364921745928851, 'NDCG*@5': 0.05507793853228742, 'MRR*@5': 0.04897100376811894}
INFO    [05-05 17:18:50] train in BasicTrainer:
duration: 28.32328462600708s
INFO    [05-05 17:18:50] train in BasicTrainer:
epoch: 57
INFO    [05-05 17:18:59] _train_one_epoch in BasicTrainer:
loss = 5.201050511428288
INFO    [05-05 17:19:17] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-05 17:19:17] validate in BasicTrainer:
{'Recall@10': 0.09865405613725836, 'NDCG@10': 0.06324501234022054, 'MRR@10': 0.05242309414527633, 'Recall@5': 0.07367207313125784, 'NDCG@5': 0.055209842256524345, 'MRR@5': 0.04913166605613448, 'Recall*@10': 0.09865405613725836, 'NDCG*@10': 0.06324501234022054, 'MRR*@10': 0.05242309414527633, 'Recall*@5': 0.07367207313125784, 'NDCG*@5': 0.055209842256524345, 'MRR*@5': 0.04913166605613448}
INFO    [05-05 17:19:17] train in BasicTrainer:
duration: 27.13348650932312s
INFO    [05-05 17:19:17] train in BasicTrainer:
epoch: 58
INFO    [05-05 17:19:26] _train_one_epoch in BasicTrainer:
loss = 5.189481777804239
INFO    [05-05 17:19:45] log in loggers:
Update Best NDCG@10 Model at 58
INFO    [05-05 17:19:46] validate in BasicTrainer:
{'Recall@10': 0.0990808064287359, 'NDCG@10': 0.06349152732979167, 'MRR@10': 0.052587719464843925, 'Recall@5': 0.07469236376610669, 'NDCG@5': 0.055644126778299156, 'MRR@5': 0.04937173358418725, 'Recall*@10': 0.0990808064287359, 'NDCG*@10': 0.06349152732979167, 'MRR*@10': 0.052587719464843925, 'Recall*@5': 0.07469236376610669, 'NDCG*@5': 0.055644126778299156, 'MRR*@5': 0.04937173358418725}
INFO    [05-05 17:19:46] train in BasicTrainer:
duration: 28.536195993423462s
INFO    [05-05 17:19:46] train in BasicTrainer:
epoch: 59
INFO    [05-05 17:19:54] _train_one_epoch in BasicTrainer:
loss = 5.180242257458823
INFO    [05-05 17:20:13] validate in BasicTrainer:
{'Recall@10': 0.09868196465752342, 'NDCG@10': 0.06339974295009267, 'MRR@10': 0.052613585171374405, 'Recall@5': 0.0736993205818263, 'NDCG@5': 0.05533668872984973, 'MRR@5': 0.04929546537724408, 'Recall*@10': 0.09868196465752342, 'NDCG*@10': 0.06339974295009267, 'MRR*@10': 0.052613585171374405, 'Recall*@5': 0.0736993205818263, 'NDCG*@5': 0.05533668872984973, 'MRR*@5': 0.04929546537724408}
INFO    [05-05 17:20:13] train in BasicTrainer:
duration: 27.332765102386475s
INFO    [05-05 17:20:13] close_training in BasicTrainer:
finished training
DEBUG   [05-05 17:20:13] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3361 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-05 17:20:13] run_routine in Routine:
Finished training, Start final validation
INFO    [05-05 17:20:13] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-05 17:20:13] load_state_from_given_path in utils:
checkpoint epoch: 58
INFO    [05-05 17:20:13] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 17:20:32] validate in BasicTrainer:
{'Recall@10': 0.0990808064287359, 'NDCG@10': 0.06349152732979167, 'MRR@10': 0.052587719464843925, 'Recall@5': 0.07469236376610669, 'NDCG@5': 0.055644126778299156, 'MRR@5': 0.04937173358418725, 'Recall*@10': 0.0990808064287359, 'NDCG*@10': 0.06349152732979167, 'MRR*@10': 0.052587719464843925, 'Recall*@5': 0.07469236376610669, 'NDCG*@5': 0.055644126778299156, 'MRR*@5': 0.04937173358418725}
INFO    [05-05 17:20:32] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.0990808064287359, 'NDCG@10': 0.06349152732979167, 'MRR@10': 0.052587719464843925, 'Recall@5': 0.07469236376610669, 'NDCG@5': 0.055644126778299156, 'MRR@5': 0.04937173358418725, 'Recall*@10': 0.0990808064287359, 'NDCG*@10': 0.06349152732979167, 'MRR*@10': 0.052587719464843925, 'Recall*@5': 0.07469236376610669, 'NDCG*@5': 0.055644126778299156, 'MRR*@5': 0.04937173358418725}
INFO    [05-05 17:20:32] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-05 17:20:32] test in BasicTrainer:
Test model on test set!
INFO    [05-05 17:20:32] test_with_given_state_path in BasicTrainer:
Loading model params from ___yelp_soft_2022/pop_narm-T-6.0-al-0.25_05-05_16:51_t7/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-05 17:20:32] load_state_from_given_path in utils:
checkpoint epoch: 58
INFO    [05-05 17:20:32] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 17:20:32] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-05 17:20:51] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.08192834664474834, 'NDCG@10': 0.050761091776869514, 'MRR@10': 0.041233695704828606, 'Recall@5': 0.059802430935881355, 'NDCG@5': 0.043639944696968254, 'MRR@5': 0.038313877853480255, 'Recall*@10': 0.08192834664474834, 'NDCG*@10': 0.050761091776869514, 'MRR*@10': 0.041233695704828606, 'Recall*@5': 0.059802430935881355, 'NDCG*@5': 0.043639944696968254, 'MRR*@5': 0.038313877853480255}
INFO    [05-05 17:20:51] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.08192834664474834, 'NDCG@10': 0.050761091776869514, 'MRR@10': 0.041233695704828606, 'Recall@5': 0.059802430935881355, 'NDCG@5': 0.043639944696968254, 'MRR@5': 0.038313877853480255, 'Recall*@10': 0.08192834664474834, 'NDCG*@10': 0.050761091776869514, 'MRR*@10': 0.041233695704828606, 'Recall*@5': 0.059802430935881355, 'NDCG*@5': 0.043639944696968254, 'MRR*@5': 0.038313877853480255}
