INFO    [05-05 18:48:52] setup_train in utils:
{
    "experiment_dir": "___yelp_soft_2022",
    "experiment_description": "pop",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "yelp.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "alpha": 0.5,
    "T": 9.0,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.yelp/narm/config_distill.json",
    "task_id": 11,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "dvae_alpha": 0.5,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-05 18:48:52] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-05 18:48:52] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/yelp-5-5.pkl
INFO    [05-05 18:48:52] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-05 18:48:52] _check_dataset_cache in utils:
correct.
INFO    [05-05 18:48:52] __init__ in NextItemDataloader:
there are 20033 items in this dataset, 43947 users, padding_first? False
DEBUG   [05-05 18:48:59] generate_model in utils:
model_code_list=['pop']
INFO    [05-05 18:48:59] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-05 18:48:59] load_model_config in utils:
{}
WARNING [05-05 18:49:06] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.5_05-05_18:48_t11/teacher_pop_logs does not exist! Create one.
WARNING [05-05 18:49:06] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.5_05-05_18:48_t11/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-05 18:49:06] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.5_05-05_18:48_t11/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-05 18:49:06] get_path in utils:
Path is None
WARNING [05-05 18:49:06] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 18:49:06] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-05 18:49:06] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 18:49:06] __init__ in BasicTrainer:
229376 iter per epoch
DEBUG   [05-05 18:49:06] generate_model in utils:
model_code_list=['narm']
INFO    [05-05 18:49:06] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-05 18:49:06] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-05 18:49:08] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.5_05-05_18:48_t11/student_narm_logs does not exist! Create one.
WARNING [05-05 18:49:08] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.5_05-05_18:48_t11/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-05 18:49:08] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-9.0-al-0.5_05-05_18:48_t11/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-05 18:49:08] get_path in utils:
Path is None
WARNING [05-05 18:49:08] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 18:49:08] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(20034, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-05 18:49:08] assert_model_device in utils:
model student_narm has 5.3603515625 MB params.
INFO    [05-05 18:49:08] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 18:49:08] __init__ in DistillTrainer:
229376 iter per epoch
INFO    [05-05 18:49:08] _set_current_routine in Routine:
first routine: student
INFO    [05-05 18:49:08] run_routine in Routine:
Start routine student
INFO    [05-05 18:49:08] run_routine in Routine:
Start training
INFO    [05-05 18:49:08] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-05 18:49:27] test_mentor in DistillTrainer:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 18:49:27] train in DistillTrainer:
result:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 18:49:46] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 18:49:46] validate in BasicTrainer:
{'Recall@10': 0.00044389204545454544, 'NDCG@10': 0.0002111054676457901, 'MRR@10': 0.0001419221515044972, 'Recall@5': 0.0003107244318181818, 'NDCG@5': 0.0001693654326531528, 'MRR@5': 0.00012539950462682597, 'Recall*@10': 0.00044389204545454544, 'NDCG*@10': 0.0002111054676457901, 'MRR*@10': 0.0001419221515044972, 'Recall*@5': 0.0003107244318181818, 'NDCG*@5': 0.0001693654326531528, 'MRR*@5': 0.00012539950462682597}
INFO    [05-05 18:49:46] train in BasicTrainer:
epoch: 0
DEBUG   [05-05 18:49:47] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 9282877
DEBUG   [05-05 18:49:47] calculate_loss in loss:
pred max in softmax: 5.0027036195388064e-05, argmax 67393260
INFO    [05-05 18:49:59] _train_one_epoch in BasicTrainer:
loss = 7.074093052319118
INFO    [05-05 18:50:17] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 18:50:17] validate in BasicTrainer:
{'Recall@10': 0.008178922686387192, 'NDCG@10': 0.004303584848953919, 'MRR@10': 0.003152683186768131, 'Recall@5': 0.004540330561047251, 'NDCG@5': 0.003135429695248604, 'MRR@5': 0.0026756559435108847, 'Recall*@10': 0.008178922686387192, 'NDCG*@10': 0.004303584848953919, 'MRR*@10': 0.003152683186768131, 'Recall*@5': 0.004540330561047251, 'NDCG*@5': 0.003135429695248604, 'MRR*@5': 0.0026756559435108847}
INFO    [05-05 18:50:17] train in BasicTrainer:
duration: 31.227895736694336s
INFO    [05-05 18:50:17] train in BasicTrainer:
epoch: 1
INFO    [05-05 18:50:30] _train_one_epoch in BasicTrainer:
loss = 6.754520918641772
INFO    [05-05 18:50:48] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-05 18:50:49] validate in BasicTrainer:
{'Recall@10': 0.017039621672169727, 'NDCG@10': 0.008447248530997471, 'MRR@10': 0.0058815191838551655, 'Recall@5': 0.009392046835273504, 'NDCG@5': 0.005984879014166919, 'MRR@5': 0.0048712695610116825, 'Recall*@10': 0.017039621672169727, 'NDCG*@10': 0.008447248530997471, 'MRR*@10': 0.0058815191838551655, 'Recall*@5': 0.009392046835273504, 'NDCG*@5': 0.005984879014166919, 'MRR*@5': 0.0048712695610116825}
INFO    [05-05 18:50:49] train in BasicTrainer:
duration: 31.402095317840576s
INFO    [05-05 18:50:49] train in BasicTrainer:
epoch: 2
INFO    [05-05 18:51:02] _train_one_epoch in BasicTrainer:
loss = 6.419520369597843
INFO    [05-05 18:51:20] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-05 18:51:20] validate in BasicTrainer:
{'Recall@10': 0.024004216559908607, 'NDCG@10': 0.011832578785040161, 'MRR@10': 0.008207893761044199, 'Recall@5': 0.013147326016967947, 'NDCG@5': 0.008354686835611408, 'MRR@5': 0.006792339919642968, 'Recall*@10': 0.024004216559908607, 'NDCG*@10': 0.011832578785040161, 'MRR*@10': 0.008207893761044199, 'Recall*@5': 0.013147326016967947, 'NDCG*@5': 0.008354686835611408, 'MRR*@5': 0.006792339919642968}
INFO    [05-05 18:51:20] train in BasicTrainer:
duration: 31.75797462463379s
INFO    [05-05 18:51:20] train in BasicTrainer:
epoch: 3
INFO    [05-05 18:51:33] _train_one_epoch in BasicTrainer:
loss = 6.27149145092283
INFO    [05-05 18:51:52] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-05 18:51:53] validate in BasicTrainer:
{'Recall@10': 0.02978425726971843, 'NDCG@10': 0.014631476676599546, 'MRR@10': 0.01010847379538146, 'Recall@5': 0.016772625205869026, 'NDCG@5': 0.0104786976325241, 'MRR@5': 0.008426887406544252, 'Recall*@10': 0.02978425726971843, 'NDCG*@10': 0.014631476676599546, 'MRR*@10': 0.01010847379538146, 'Recall*@5': 0.016772625205869026, 'NDCG*@5': 0.0104786976325241, 'MRR*@5': 0.008426887406544252}
INFO    [05-05 18:51:53] train in BasicTrainer:
duration: 32.25770974159241s
INFO    [05-05 18:51:53] train in BasicTrainer:
epoch: 4
INFO    [05-05 18:52:06] _train_one_epoch in BasicTrainer:
loss = 6.171827707971845
INFO    [05-05 18:52:25] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-05 18:52:25] validate in BasicTrainer:
{'Recall@10': 0.03388069570064545, 'NDCG@10': 0.016768729060210964, 'MRR@10': 0.0116459834812717, 'Recall@5': 0.019493659619580616, 'NDCG@5': 0.012147190049290657, 'MRR@5': 0.009756848597052422, 'Recall*@10': 0.03388069570064545, 'NDCG*@10': 0.016768729060210964, 'MRR*@10': 0.0116459834812717, 'Recall*@5': 0.019493659619580616, 'NDCG*@5': 0.012147190049290657, 'MRR*@5': 0.009756848597052422}
INFO    [05-05 18:52:25] train in BasicTrainer:
duration: 32.192017793655396s
INFO    [05-05 18:52:25] train in BasicTrainer:
epoch: 5
INFO    [05-05 18:52:37] _train_one_epoch in BasicTrainer:
loss = 6.07855531999043
INFO    [05-05 18:52:56] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-05 18:52:56] validate in BasicTrainer:
{'Recall@10': 0.03919464959339662, 'NDCG@10': 0.019873841919682243, 'MRR@10': 0.014097474007443949, 'Recall@5': 0.02242587354372848, 'NDCG@5': 0.014499634588983927, 'MRR@5': 0.011907872489907524, 'Recall*@10': 0.03919464959339662, 'NDCG*@10': 0.019873841919682243, 'MRR*@10': 0.014097474007443949, 'Recall*@5': 0.02242587354372848, 'NDCG*@5': 0.014499634588983927, 'MRR*@5': 0.011907872489907524}
INFO    [05-05 18:52:56] train in BasicTrainer:
duration: 31.56783676147461s
INFO    [05-05 18:52:56] train in BasicTrainer:
epoch: 6
INFO    [05-05 18:53:09] _train_one_epoch in BasicTrainer:
loss = 6.006513323102679
INFO    [05-05 18:53:28] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-05 18:53:28] validate in BasicTrainer:
{'Recall@10': 0.04070135646245696, 'NDCG@10': 0.020911272953857075, 'MRR@10': 0.014966682700270956, 'Recall@5': 0.0246396196836775, 'NDCG@5': 0.015764178877527065, 'MRR@5': 0.012869327244433489, 'Recall*@10': 0.04070135646245696, 'NDCG*@10': 0.020911272953857075, 'MRR*@10': 0.014966682700270956, 'Recall*@5': 0.0246396196836775, 'NDCG*@5': 0.015764178877527065, 'MRR*@5': 0.012869327244433489}
INFO    [05-05 18:53:28] train in BasicTrainer:
duration: 31.52756953239441s
INFO    [05-05 18:53:28] train in BasicTrainer:
epoch: 7
INFO    [05-05 18:53:42] _train_one_epoch in BasicTrainer:
loss = 5.943744548729488
INFO    [05-05 18:54:01] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-05 18:54:01] validate in BasicTrainer:
{'Recall@10': 0.044484544206749306, 'NDCG@10': 0.022628281434828586, 'MRR@10': 0.016084015369415283, 'Recall@5': 0.025851421227509327, 'NDCG@5': 0.016661426221782513, 'MRR@5': 0.013655416159467264, 'Recall*@10': 0.044484544206749306, 'NDCG*@10': 0.022628281434828586, 'MRR*@10': 0.016084015369415283, 'Recall*@5': 0.025851421227509327, 'NDCG*@5': 0.016661426221782513, 'MRR*@5': 0.013655416159467264}
INFO    [05-05 18:54:01] train in BasicTrainer:
duration: 32.875357151031494s
INFO    [05-05 18:54:01] train in BasicTrainer:
epoch: 8
INFO    [05-05 18:54:13] _train_one_epoch in BasicTrainer:
loss = 5.885221379143851
INFO    [05-05 18:54:32] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-05 18:54:32] validate in BasicTrainer:
{'Recall@10': 0.04676806181669235, 'NDCG@10': 0.024422940882769497, 'MRR@10': 0.017716754566539417, 'Recall@5': 0.02845324237238277, 'NDCG@5': 0.018583109433000736, 'MRR@5': 0.015355046923187647, 'Recall*@10': 0.04676806181669235, 'NDCG*@10': 0.024422940882769497, 'MRR*@10': 0.017716754566539417, 'Recall*@5': 0.02845324237238277, 'NDCG*@5': 0.018583109433000736, 'MRR*@5': 0.015355046923187647}
INFO    [05-05 18:54:32] train in BasicTrainer:
duration: 30.999677658081055s
INFO    [05-05 18:54:32] train in BasicTrainer:
epoch: 9
INFO    [05-05 18:54:45] _train_one_epoch in BasicTrainer:
loss = 5.830913296767643
INFO    [05-05 18:55:04] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-05 18:55:04] validate in BasicTrainer:
{'Recall@10': 0.0492518733848225, 'NDCG@10': 0.025690915232354946, 'MRR@10': 0.01863405480980873, 'Recall@5': 0.029359372163360768, 'NDCG@5': 0.019319708882407707, 'MRR@5': 0.016040513207289307, 'Recall*@10': 0.0492518733848225, 'NDCG*@10': 0.025690915232354946, 'MRR*@10': 0.01863405480980873, 'Recall*@5': 0.029359372163360768, 'NDCG*@5': 0.019319708882407707, 'MRR*@5': 0.016040513207289307}
INFO    [05-05 18:55:04] train in BasicTrainer:
duration: 32.36111068725586s
INFO    [05-05 18:55:04] train in BasicTrainer:
epoch: 10
INFO    [05-05 18:55:18] _train_one_epoch in BasicTrainer:
loss = 5.779566577502659
INFO    [05-05 18:55:36] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-05 18:55:37] validate in BasicTrainer:
{'Recall@10': 0.05137365345250477, 'NDCG@10': 0.026975777169520206, 'MRR@10': 0.019630187275734814, 'Recall@5': 0.032143802805380386, 'NDCG@5': 0.02081715027717027, 'MRR@5': 0.017123706300150265, 'Recall*@10': 0.05137365345250477, 'NDCG*@10': 0.026975777169520206, 'MRR*@10': 0.019630187275734814, 'Recall*@5': 0.032143802805380386, 'NDCG*@5': 0.02081715027717027, 'MRR*@5': 0.017123706300150265}
INFO    [05-05 18:55:37] train in BasicTrainer:
duration: 32.428592920303345s
INFO    [05-05 18:55:37] train in BasicTrainer:
epoch: 11
INFO    [05-05 18:55:50] _train_one_epoch in BasicTrainer:
loss = 5.7290143966674805
INFO    [05-05 18:56:09] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-05 18:56:10] validate in BasicTrainer:
{'Recall@10': 0.05456011335958134, 'NDCG@10': 0.029126392677426338, 'MRR@10': 0.021499447524547577, 'Recall@5': 0.03356930986046791, 'NDCG@5': 0.022417131472717632, 'MRR@5': 0.018775797195055267, 'Recall*@10': 0.05456011335958134, 'NDCG*@10': 0.029126392677426338, 'MRR*@10': 0.021499447524547577, 'Recall*@5': 0.03356930986046791, 'NDCG*@5': 0.022417131472717632, 'MRR*@5': 0.018775797195055267}
INFO    [05-05 18:56:10] train in BasicTrainer:
duration: 33.00237488746643s
INFO    [05-05 18:56:10] train in BasicTrainer:
epoch: 12
INFO    [05-05 18:56:22] _train_one_epoch in BasicTrainer:
loss = 5.681023870195661
INFO    [05-05 18:56:41] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-05 18:56:41] validate in BasicTrainer:
{'Recall@10': 0.05671232837167653, 'NDCG@10': 0.030637993223287842, 'MRR@10': 0.022805741734125397, 'Recall@5': 0.035358832302418625, 'NDCG@5': 0.02380355396731333, 'MRR@5': 0.020025938071987846, 'Recall*@10': 0.05671232837167653, 'NDCG*@10': 0.030637993223287842, 'MRR*@10': 0.022805741734125397, 'Recall*@5': 0.035358832302418625, 'NDCG*@5': 0.02380355396731333, 'MRR*@5': 0.020025938071987846}
INFO    [05-05 18:56:41] train in BasicTrainer:
duration: 31.205808401107788s
INFO    [05-05 18:56:41] train in BasicTrainer:
epoch: 13
INFO    [05-05 18:56:53] _train_one_epoch in BasicTrainer:
loss = 5.633117096764701
INFO    [05-05 18:57:13] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-05 18:57:13] validate in BasicTrainer:
{'Recall@10': 0.05907824940302155, 'NDCG@10': 0.031755792823704804, 'MRR@10': 0.02354390360414982, 'Recall@5': 0.03666446493430571, 'NDCG@5': 0.024578540501269428, 'MRR@5': 0.020623197271065277, 'Recall*@10': 0.05907824940302155, 'NDCG*@10': 0.031755792823704804, 'MRR*@10': 0.02354390360414982, 'Recall*@5': 0.03666446493430571, 'NDCG*@5': 0.024578540501269428, 'MRR*@5': 0.020623197271065277}
INFO    [05-05 18:57:13] train in BasicTrainer:
duration: 32.4386260509491s
INFO    [05-05 18:57:13] train in BasicTrainer:
epoch: 14
INFO    [05-05 18:57:26] _train_one_epoch in BasicTrainer:
loss = 5.586626172065735
INFO    [05-05 18:57:45] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-05 18:57:45] validate in BasicTrainer:
{'Recall@10': 0.06209858032790097, 'NDCG@10': 0.03374651430005377, 'MRR@10': 0.025220803747122936, 'Recall@5': 0.038712082261388954, 'NDCG@5': 0.0262291646477851, 'MRR@5': 0.022144602103666824, 'Recall*@10': 0.06209858032790097, 'NDCG*@10': 0.03374651430005377, 'MRR*@10': 0.025220803747122936, 'Recall*@5': 0.038712082261388954, 'NDCG*@5': 0.0262291646477851, 'MRR*@5': 0.022144602103666824}
INFO    [05-05 18:57:45] train in BasicTrainer:
duration: 31.55722451210022s
INFO    [05-05 18:57:45] train in BasicTrainer:
epoch: 15
INFO    [05-05 18:57:58] _train_one_epoch in BasicTrainer:
loss = 5.54252415895462
INFO    [05-05 18:58:18] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-05 18:58:18] validate in BasicTrainer:
{'Recall@10': 0.06276002695614641, 'NDCG@10': 0.03457733683965423, 'MRR@10': 0.026083564893765884, 'Recall@5': 0.04037348993799903, 'NDCG@5': 0.02737830240618099, 'MRR@5': 0.023135547102852302, 'Recall*@10': 0.06276002695614641, 'NDCG*@10': 0.03457733683965423, 'MRR*@10': 0.026083564893765884, 'Recall*@5': 0.04037348993799903, 'NDCG*@5': 0.02737830240618099, 'MRR*@5': 0.023135547102852302}
INFO    [05-05 18:58:18] train in BasicTrainer:
duration: 32.90881824493408s
INFO    [05-05 18:58:18] train in BasicTrainer:
epoch: 16
INFO    [05-05 18:58:31] _train_one_epoch in BasicTrainer:
loss = 5.501430928707123
INFO    [05-05 18:58:49] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-05 18:58:50] validate in BasicTrainer:
{'Recall@10': 0.06698963317004117, 'NDCG@10': 0.03674794496460394, 'MRR@10': 0.027647134255279194, 'Recall@5': 0.04224794188683683, 'NDCG@5': 0.028793422674590893, 'MRR@5': 0.02439160357144746, 'Recall*@10': 0.06698963317004117, 'NDCG*@10': 0.03674794496460394, 'MRR*@10': 0.027647134255279194, 'Recall*@5': 0.04224794188683683, 'NDCG*@5': 0.028793422674590893, 'MRR*@5': 0.02439160357144746}
INFO    [05-05 18:58:50] train in BasicTrainer:
duration: 32.00341868400574s
INFO    [05-05 18:58:50] train in BasicTrainer:
epoch: 17
DEBUG   [05-05 18:59:02] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 1109005
DEBUG   [05-05 18:59:02] calculate_loss in loss:
pred max in softmax: 0.935315728187561, argmax 42084504
DEBUG   [05-05 18:59:02] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 5496451
DEBUG   [05-05 18:59:02] calculate_loss in loss:
pred max in softmax: 0.7193372845649719, argmax 54813108
INFO    [05-05 18:59:03] _train_one_epoch in BasicTrainer:
loss = 5.459576785564423
INFO    [05-05 18:59:22] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-05 18:59:22] validate in BasicTrainer:
{'Recall@10': 0.06585265560583635, 'NDCG@10': 0.037197924134406174, 'MRR@10': 0.028509237041527576, 'Recall@5': 0.043632908978245476, 'NDCG@5': 0.03000172007490288, 'MRR@5': 0.02553326856683601, 'Recall*@10': 0.06585265560583635, 'NDCG*@10': 0.037197924134406174, 'MRR*@10': 0.028509237041527576, 'Recall*@5': 0.043632908978245476, 'NDCG*@5': 0.03000172007490288, 'MRR*@5': 0.02553326856683601}
INFO    [05-05 18:59:22] train in BasicTrainer:
duration: 32.37521409988403s
INFO    [05-05 18:59:22] train in BasicTrainer:
epoch: 18
INFO    [05-05 18:59:35] _train_one_epoch in BasicTrainer:
loss = 5.4224442754473
INFO    [05-05 18:59:53] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-05 18:59:53] validate in BasicTrainer:
{'Recall@10': 0.06915899027477611, 'NDCG@10': 0.03841994804414836, 'MRR@10': 0.02917504209009084, 'Recall@5': 0.043844088234684685, 'NDCG@5': 0.030280828137289394, 'MRR@5': 0.025843860073523087, 'Recall*@10': 0.06915899027477611, 'NDCG*@10': 0.03841994804414836, 'MRR*@10': 0.02917504209009084, 'Recall*@5': 0.043844088234684685, 'NDCG*@5': 0.030280828137289394, 'MRR*@5': 0.025843860073523087}
INFO    [05-05 18:59:53] train in BasicTrainer:
duration: 30.76241135597229s
INFO    [05-05 18:59:53] train in BasicTrainer:
epoch: 19
INFO    [05-05 19:00:06] _train_one_epoch in BasicTrainer:
loss = 5.386757952826364
INFO    [05-05 19:00:25] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-05 19:00:25] validate in BasicTrainer:
{'Recall@10': 0.07009435106407512, 'NDCG@10': 0.03934664719484069, 'MRR@10': 0.03005184317854318, 'Recall@5': 0.04662533104419708, 'NDCG@5': 0.03183164108883251, 'MRR@5': 0.026993815702470867, 'Recall*@10': 0.07009435106407512, 'NDCG*@10': 0.03934664719484069, 'MRR*@10': 0.03005184317854318, 'Recall*@5': 0.04662533104419708, 'NDCG*@5': 0.03183164108883251, 'MRR*@5': 0.026993815702470867}
INFO    [05-05 19:00:25] train in BasicTrainer:
duration: 31.89561915397644s
INFO    [05-05 19:00:25] train in BasicTrainer:
epoch: 20
INFO    [05-05 19:00:38] _train_one_epoch in BasicTrainer:
loss = 5.35217388187136
INFO    [05-05 19:00:56] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-05 19:00:56] validate in BasicTrainer:
{'Recall@10': 0.07193331555886702, 'NDCG@10': 0.041072324934330856, 'MRR@10': 0.03174463524059816, 'Recall@5': 0.04803820665587078, 'NDCG@5': 0.033412847498601135, 'MRR@5': 0.02862321212887764, 'Recall*@10': 0.07193331555886702, 'NDCG*@10': 0.041072324934330856, 'MRR*@10': 0.03174463524059816, 'Recall*@5': 0.04803820665587078, 'NDCG*@5': 0.033412847498601135, 'MRR*@5': 0.02862321212887764}
INFO    [05-05 19:00:56] train in BasicTrainer:
duration: 31.561909675598145s
INFO    [05-05 19:00:56] train in BasicTrainer:
epoch: 21
INFO    [05-05 19:01:10] _train_one_epoch in BasicTrainer:
loss = 5.319343038967678
INFO    [05-05 19:01:29] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-05 19:01:29] validate in BasicTrainer:
{'Recall@10': 0.0732288428328254, 'NDCG@10': 0.041756573048504914, 'MRR@10': 0.0322375629435886, 'Recall@5': 0.04909717223861001, 'NDCG@5': 0.033997280353849586, 'MRR@5': 0.029061091725121845, 'Recall*@10': 0.0732288428328254, 'NDCG*@10': 0.041756573048504914, 'MRR*@10': 0.0322375629435886, 'Recall*@5': 0.04909717223861001, 'NDCG*@5': 0.033997280353849586, 'MRR*@5': 0.029061091725121845}
INFO    [05-05 19:01:29] train in BasicTrainer:
duration: 32.608964681625366s
INFO    [05-05 19:01:29] train in BasicTrainer:
epoch: 22
INFO    [05-05 19:01:42] _train_one_epoch in BasicTrainer:
loss = 5.287179512637002
INFO    [05-05 19:02:00] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-05 19:02:00] validate in BasicTrainer:
{'Recall@10': 0.0739104998382655, 'NDCG@10': 0.04270316558805379, 'MRR@10': 0.033258051526817406, 'Recall@5': 0.0498543151400306, 'NDCG@5': 0.0349588468670845, 'MRR@5': 0.03008259189399806, 'Recall*@10': 0.0739104998382655, 'NDCG*@10': 0.04270316558805379, 'MRR*@10': 0.033258051526817406, 'Recall*@5': 0.0498543151400306, 'NDCG*@5': 0.0349588468670845, 'MRR*@5': 0.03008259189399806}
INFO    [05-05 19:02:00] train in BasicTrainer:
duration: 31.207743167877197s
INFO    [05-05 19:02:00] train in BasicTrainer:
epoch: 23
INFO    [05-05 19:02:13] _train_one_epoch in BasicTrainer:
loss = 5.257102855614254
INFO    [05-05 19:02:32] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-05 19:02:32] validate in BasicTrainer:
{'Recall@10': 0.07607480409470471, 'NDCG@10': 0.043475953354076904, 'MRR@10': 0.03363995643501932, 'Recall@5': 0.05058487199924209, 'NDCG@5': 0.035319009626453575, 'MRR@5': 0.030323404310779137, 'Recall*@10': 0.07607480409470471, 'NDCG*@10': 0.043475953354076904, 'MRR*@10': 0.03363995643501932, 'Recall*@5': 0.05058487199924209, 'NDCG*@5': 0.035319009626453575, 'MRR*@5': 0.030323404310779137}
INFO    [05-05 19:02:32] train in BasicTrainer:
duration: 31.974956035614014s
INFO    [05-05 19:02:32] train in BasicTrainer:
epoch: 24
INFO    [05-05 19:02:45] _train_one_epoch in BasicTrainer:
loss = 5.228180289268494
INFO    [05-05 19:03:03] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-05 19:03:03] validate in BasicTrainer:
{'Recall@10': 0.07625994018533012, 'NDCG@10': 0.044085640121590004, 'MRR@10': 0.03434199060906063, 'Recall@5': 0.05218727480281483, 'NDCG@5': 0.03636496547948231, 'MRR@5': 0.031193050132556396, 'Recall*@10': 0.07625994018533012, 'NDCG*@10': 0.044085640121590004, 'MRR*@10': 0.03434199060906063, 'Recall*@5': 0.05218727480281483, 'NDCG*@5': 0.03636496547948231, 'MRR*@5': 0.031193050132556396}
INFO    [05-05 19:03:03] train in BasicTrainer:
duration: 31.016129970550537s
INFO    [05-05 19:03:03] train in BasicTrainer:
epoch: 25
INFO    [05-05 19:03:16] _train_one_epoch in BasicTrainer:
loss = 5.202757690634046
INFO    [05-05 19:03:36] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-05 19:03:36] validate in BasicTrainer:
{'Recall@10': 0.07646221802993254, 'NDCG@10': 0.044597716494040054, 'MRR@10': 0.03496103428981521, 'Recall@5': 0.052200567654588005, 'NDCG@5': 0.036813112822445954, 'MRR@5': 0.03178339400752024, 'Recall*@10': 0.07646221802993254, 'NDCG*@10': 0.044597716494040054, 'MRR*@10': 0.03496103428981521, 'Recall*@5': 0.052200567654588005, 'NDCG*@5': 0.036813112822445954, 'MRR*@5': 0.03178339400752024}
INFO    [05-05 19:03:36] train in BasicTrainer:
duration: 33.28530693054199s
INFO    [05-05 19:03:36] train in BasicTrainer:
epoch: 26
INFO    [05-05 19:03:51] _train_one_epoch in BasicTrainer:
loss = 5.173820342336382
INFO    [05-05 19:04:09] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-05 19:04:09] validate in BasicTrainer:
{'Recall@10': 0.07787948508154262, 'NDCG@10': 0.04516245052218437, 'MRR@10': 0.03523651273413138, 'Recall@5': 0.053297004916451195, 'NDCG@5': 0.037244719876484436, 'MRR@5': 0.03198827024210583, 'Recall*@10': 0.07787948508154262, 'NDCG*@10': 0.04516245052218437, 'MRR*@10': 0.03523651273413138, 'Recall*@5': 0.053297004916451195, 'NDCG*@5': 0.037244719876484436, 'MRR*@5': 0.03198827024210583}
INFO    [05-05 19:04:09] train in BasicTrainer:
duration: 32.56644916534424s
INFO    [05-05 19:04:09] train in BasicTrainer:
epoch: 27
INFO    [05-05 19:04:23] _train_one_epoch in BasicTrainer:
loss = 5.148345836571285
INFO    [05-05 19:04:43] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-05 19:04:43] validate in BasicTrainer:
{'Recall@10': 0.0792802714488723, 'NDCG@10': 0.04593216593969952, 'MRR@10': 0.0358468084172769, 'Recall@5': 0.053504335270686584, 'NDCG@5': 0.037657281891866165, 'MRR@5': 0.03246692601930012, 'Recall*@10': 0.0792802714488723, 'NDCG*@10': 0.04593216593969952, 'MRR*@10': 0.0358468084172769, 'Recall*@5': 0.053504335270686584, 'NDCG*@5': 0.037657281891866165, 'MRR*@5': 0.03246692601930012}
INFO    [05-05 19:04:43] train in BasicTrainer:
duration: 34.18854069709778s
INFO    [05-05 19:04:43] train in BasicTrainer:
epoch: 28
INFO    [05-05 19:04:56] _train_one_epoch in BasicTrainer:
loss = 5.123721642153604
INFO    [05-05 19:05:14] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-05 19:05:14] validate in BasicTrainer:
{'Recall@10': 0.07876155525445938, 'NDCG@10': 0.046125922690738334, 'MRR@10': 0.03621725602583452, 'Recall@5': 0.054316634142940697, 'NDCG@5': 0.038244154981591484, 'MRR@5': 0.03297824531116269, 'Recall*@10': 0.07876155525445938, 'NDCG*@10': 0.046125922690738334, 'MRR*@10': 0.03621725602583452, 'Recall*@5': 0.054316634142940697, 'NDCG*@5': 0.038244154981591484, 'MRR*@5': 0.03297824531116269}
INFO    [05-05 19:05:14] train in BasicTrainer:
duration: 31.277283906936646s
INFO    [05-05 19:05:14] train in BasicTrainer:
epoch: 29
INFO    [05-05 19:05:28] _train_one_epoch in BasicTrainer:
loss = 5.101194415773664
INFO    [05-05 19:05:47] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-05 19:05:47] validate in BasicTrainer:
{'Recall@10': 0.08095244521444495, 'NDCG@10': 0.04721332713961601, 'MRR@10': 0.036975876512852585, 'Recall@5': 0.05518793754956939, 'NDCG@5': 0.03891270031983202, 'MRR@5': 0.033568387512456284, 'Recall*@10': 0.08095244521444495, 'NDCG*@10': 0.04721332713961601, 'MRR*@10': 0.036975876512852585, 'Recall*@5': 0.05518793754956939, 'NDCG*@5': 0.03891270031983202, 'MRR*@5': 0.033568387512456284}
INFO    [05-05 19:05:47] train in BasicTrainer:
duration: 33.02253603935242s
INFO    [05-05 19:05:47] train in BasicTrainer:
epoch: 30
INFO    [05-05 19:06:00] _train_one_epoch in BasicTrainer:
loss = 5.0752667273793906
INFO    [05-05 19:06:18] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [05-05 19:06:18] validate in BasicTrainer:
{'Recall@10': 0.08136776766993782, 'NDCG@10': 0.04789634489200332, 'MRR@10': 0.037750430066477166, 'Recall@5': 0.055711706253615295, 'NDCG@5': 0.03964909233830192, 'MRR@5': 0.034374929117885505, 'Recall*@10': 0.08136776766993782, 'NDCG*@10': 0.04789634489200332, 'MRR*@10': 0.037750430066477166, 'Recall*@5': 0.055711706253615295, 'NDCG*@5': 0.03964909233830192, 'MRR*@5': 0.034374929117885505}
INFO    [05-05 19:06:18] train in BasicTrainer:
duration: 30.82311177253723s
INFO    [05-05 19:06:18] train in BasicTrainer:
epoch: 31
INFO    [05-05 19:06:31] _train_one_epoch in BasicTrainer:
loss = 5.053350406033652
INFO    [05-05 19:06:51] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-05 19:06:51] validate in BasicTrainer:
{'Recall@10': 0.08117944408546794, 'NDCG@10': 0.04821090942079371, 'MRR@10': 0.03819745508107272, 'Recall@5': 0.05634963580153205, 'NDCG@5': 0.04023335162888874, 'MRR@5': 0.03493530980565331, 'Recall*@10': 0.08117944408546794, 'NDCG*@10': 0.04821090942079371, 'MRR*@10': 0.03819745508107272, 'Recall*@5': 0.05634963580153205, 'NDCG*@5': 0.04023335162888874, 'MRR*@5': 0.03493530980565331}
INFO    [05-05 19:06:51] train in BasicTrainer:
duration: 32.805349826812744s
INFO    [05-05 19:06:51] train in BasicTrainer:
epoch: 32
INFO    [05-05 19:07:05] _train_one_epoch in BasicTrainer:
loss = 5.033489091055734
INFO    [05-05 19:07:24] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-05 19:07:24] validate in BasicTrainer:
{'Recall@10': 0.0826969173821536, 'NDCG@10': 0.048997846178033135, 'MRR@10': 0.03875848007473079, 'Recall@5': 0.0581283914771947, 'NDCG@5': 0.0411193502897566, 'MRR@5': 0.03554585389792919, 'Recall*@10': 0.0826969173821536, 'NDCG*@10': 0.048997846178033135, 'MRR*@10': 0.03875848007473079, 'Recall*@5': 0.0581283914771947, 'NDCG*@5': 0.0411193502897566, 'MRR*@5': 0.03554585389792919}
INFO    [05-05 19:07:24] train in BasicTrainer:
duration: 32.65859413146973s
INFO    [05-05 19:07:24] train in BasicTrainer:
epoch: 33
INFO    [05-05 19:07:38] _train_one_epoch in BasicTrainer:
loss = 5.013905320848737
INFO    [05-05 19:07:56] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-05 19:07:56] validate in BasicTrainer:
{'Recall@10': 0.08333803442391483, 'NDCG@10': 0.04927059398456053, 'MRR@10': 0.038904183290221474, 'Recall@5': 0.05806686051867225, 'NDCG@5': 0.04114705866033381, 'MRR@5': 0.03557977893135764, 'Recall*@10': 0.08333803442391483, 'NDCG*@10': 0.04927059398456053, 'MRR*@10': 0.038904183290221474, 'Recall*@5': 0.05806686051867225, 'NDCG*@5': 0.04114705866033381, 'MRR*@5': 0.03557977893135764}
INFO    [05-05 19:07:56] train in BasicTrainer:
duration: 32.39613747596741s
INFO    [05-05 19:07:56] train in BasicTrainer:
epoch: 34
INFO    [05-05 19:08:09] _train_one_epoch in BasicTrainer:
loss = 4.993853901113782
INFO    [05-05 19:08:28] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-05 19:08:28] validate in BasicTrainer:
{'Recall@10': 0.08363666927272623, 'NDCG@10': 0.050043186003511604, 'MRR@10': 0.039840112355622376, 'Recall@5': 0.058718744326721535, 'NDCG@5': 0.04203483665531332, 'MRR@5': 0.03656325116753578, 'Recall*@10': 0.08363666927272623, 'NDCG*@10': 0.050043186003511604, 'MRR*@10': 0.039840112355622376, 'Recall*@5': 0.058718744326721535, 'NDCG*@5': 0.04203483665531332, 'MRR*@5': 0.03656325116753578}
INFO    [05-05 19:08:28] train in BasicTrainer:
duration: 32.213059425354004s
INFO    [05-05 19:08:28] train in BasicTrainer:
epoch: 35
DEBUG   [05-05 19:08:37] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 5997301
DEBUG   [05-05 19:08:37] calculate_loss in loss:
pred max in softmax: 0.7903691530227661, argmax 46870830
DEBUG   [05-05 19:08:37] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 27634021
DEBUG   [05-05 19:08:37] calculate_loss in loss:
pred max in softmax: 0.9176986217498779, argmax 36510869
INFO    [05-05 19:08:41] _train_one_epoch in BasicTrainer:
loss = 4.973936694008963
INFO    [05-05 19:08:59] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-05 19:08:59] validate in BasicTrainer:
{'Recall@10': 0.08463861454616893, 'NDCG@10': 0.050214422020045196, 'MRR@10': 0.0397401980378411, 'Recall@5': 0.05920131165872921, 'NDCG@5': 0.0420364917001941, 'MRR@5': 0.03639298101717776, 'Recall*@10': 0.08463861454616893, 'NDCG*@10': 0.050214422020045196, 'MRR*@10': 0.0397401980378411, 'Recall*@5': 0.05920131165872921, 'NDCG*@5': 0.0420364917001941, 'MRR*@5': 0.03639298101717776}
INFO    [05-05 19:08:59] train in BasicTrainer:
duration: 30.933234214782715s
INFO    [05-05 19:08:59] train in BasicTrainer:
epoch: 36
INFO    [05-05 19:09:12] _train_one_epoch in BasicTrainer:
loss = 4.95519414969853
INFO    [05-05 19:09:31] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-05 19:09:31] validate in BasicTrainer:
{'Recall@10': 0.0855124443769455, 'NDCG@10': 0.051045148548754776, 'MRR@10': 0.04055508124557408, 'Recall@5': 0.06053298779509284, 'NDCG@5': 0.04302133822982961, 'MRR@5': 0.037274314937266434, 'Recall*@10': 0.0855124443769455, 'NDCG*@10': 0.051045148548754776, 'MRR*@10': 0.04055508124557408, 'Recall*@5': 0.06053298779509284, 'NDCG*@5': 0.04302133822982961, 'MRR*@5': 0.037274314937266434}
INFO    [05-05 19:09:31] train in BasicTrainer:
duration: 32.08320999145508s
INFO    [05-05 19:09:31] train in BasicTrainer:
epoch: 37
INFO    [05-05 19:09:44] _train_one_epoch in BasicTrainer:
loss = 4.939828676836831
INFO    [05-05 19:10:02] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [05-05 19:10:02] validate in BasicTrainer:
{'Recall@10': 0.08614784750071439, 'NDCG@10': 0.0515356334772977, 'MRR@10': 0.041005505418235604, 'Recall@5': 0.06013029712167653, 'NDCG@5': 0.043134396387772125, 'MRR@5': 0.03754527697508985, 'Recall*@10': 0.08614784750071439, 'NDCG*@10': 0.0515356334772977, 'MRR*@10': 0.041005505418235604, 'Recall*@5': 0.06013029712167653, 'NDCG*@5': 0.043134396387772125, 'MRR*@5': 0.03754527697508985}
INFO    [05-05 19:10:02] train in BasicTrainer:
duration: 31.081664323806763s
INFO    [05-05 19:10:02] train in BasicTrainer:
epoch: 38
INFO    [05-05 19:10:16] _train_one_epoch in BasicTrainer:
loss = 4.921727853161948
INFO    [05-05 19:10:35] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-05 19:10:36] validate in BasicTrainer:
{'Recall@10': 0.08634946359829469, 'NDCG@10': 0.05202090841802684, 'MRR@10': 0.041572017764503304, 'Recall@5': 0.061520316722718155, 'NDCG@5': 0.04403860121965408, 'MRR@5': 0.038304010914130646, 'Recall*@10': 0.08634946359829469, 'NDCG*@10': 0.05202090841802684, 'MRR*@10': 0.041572017764503304, 'Recall*@5': 0.061520316722718155, 'NDCG*@5': 0.04403860121965408, 'MRR*@5': 0.038304010914130646}
INFO    [05-05 19:10:36] train in BasicTrainer:
duration: 33.069032430648804s
INFO    [05-05 19:10:36] train in BasicTrainer:
epoch: 39
INFO    [05-05 19:10:48] _train_one_epoch in BasicTrainer:
loss = 4.904901163918631
INFO    [05-05 19:11:07] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [05-05 19:11:07] validate in BasicTrainer:
{'Recall@10': 0.08735140819441188, 'NDCG@10': 0.052615470506928184, 'MRR@10': 0.0420394360341809, 'Recall@5': 0.06253808093341914, 'NDCG@5': 0.04465289888056842, 'MRR@5': 0.03878934241153977, 'Recall*@10': 0.08735140819441188, 'NDCG*@10': 0.052615470506928184, 'MRR*@10': 0.0420394360341809, 'Recall*@5': 0.06253808093341914, 'NDCG*@5': 0.04465289888056842, 'MRR*@5': 0.03878934241153977}
INFO    [05-05 19:11:07] train in BasicTrainer:
duration: 31.278815746307373s
INFO    [05-05 19:11:07] train in BasicTrainer:
epoch: 40
INFO    [05-05 19:11:20] _train_one_epoch in BasicTrainer:
loss = 4.887806568826948
INFO    [05-05 19:11:39] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [05-05 19:11:39] validate in BasicTrainer:
{'Recall@10': 0.08783144910227168, 'NDCG@10': 0.052816776050762695, 'MRR@10': 0.04217715222727169, 'Recall@5': 0.06208342212167653, 'NDCG@5': 0.04457805102521723, 'MRR@5': 0.03882794285362417, 'Recall*@10': 0.08783144910227168, 'NDCG*@10': 0.052816776050762695, 'MRR*@10': 0.04217715222727169, 'Recall*@5': 0.06208342212167653, 'NDCG*@5': 0.04457805102521723, 'MRR*@5': 0.03882794285362417}
INFO    [05-05 19:11:39] train in BasicTrainer:
duration: 31.90960693359375s
INFO    [05-05 19:11:39] train in BasicTrainer:
epoch: 41
INFO    [05-05 19:11:52] _train_one_epoch in BasicTrainer:
loss = 4.8733672840254645
INFO    [05-05 19:12:10] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-05 19:12:10] validate in BasicTrainer:
{'Recall@10': 0.08771157467907126, 'NDCG@10': 0.053073940967971626, 'MRR@10': 0.04252355376427824, 'Recall@5': 0.06257104196331718, 'NDCG@5': 0.04498005827719515, 'MRR@5': 0.03920414366505363, 'Recall*@10': 0.08771157467907126, 'NDCG*@10': 0.053073940967971626, 'MRR*@10': 0.04252355376427824, 'Recall*@5': 0.06257104196331718, 'NDCG*@5': 0.04498005827719515, 'MRR*@5': 0.03920414366505363}
INFO    [05-05 19:12:10] train in BasicTrainer:
duration: 31.715170860290527s
INFO    [05-05 19:12:10] train in BasicTrainer:
epoch: 42
INFO    [05-05 19:12:24] _train_one_epoch in BasicTrainer:
loss = 4.861702910491398
INFO    [05-05 19:12:43] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-05 19:12:43] validate in BasicTrainer:
{'Recall@10': 0.08819732950492339, 'NDCG@10': 0.053473623300140556, 'MRR@10': 0.0428832390091636, 'Recall@5': 0.06352793628519232, 'NDCG@5': 0.045536583458835427, 'MRR@5': 0.039630624719641426, 'Recall*@10': 0.08819732950492339, 'NDCG*@10': 0.053473623300140556, 'MRR*@10': 0.0428832390091636, 'Recall*@5': 0.06352793628519232, 'NDCG*@5': 0.045536583458835427, 'MRR*@5': 0.039630624719641426}
INFO    [05-05 19:12:43] train in BasicTrainer:
duration: 32.44051003456116s
INFO    [05-05 19:12:43] train in BasicTrainer:
epoch: 43
INFO    [05-05 19:12:56] _train_one_epoch in BasicTrainer:
loss = 4.843681641987392
INFO    [05-05 19:13:14] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [05-05 19:13:14] validate in BasicTrainer:
{'Recall@10': 0.08848904682831331, 'NDCG@10': 0.05393585359508341, 'MRR@10': 0.04340616579760204, 'Recall@5': 0.06355584480545738, 'NDCG@5': 0.04592626609585502, 'MRR@5': 0.040131979367949745, 'Recall*@10': 0.08848904682831331, 'NDCG*@10': 0.05393585359508341, 'MRR*@10': 0.04340616579760204, 'Recall*@5': 0.06355584480545738, 'NDCG*@5': 0.04592626609585502, 'MRR*@5': 0.040131979367949745}
INFO    [05-05 19:13:14] train in BasicTrainer:
duration: 31.323322296142578s
INFO    [05-05 19:13:14] train in BasicTrainer:
epoch: 44
INFO    [05-05 19:13:27] _train_one_epoch in BasicTrainer:
loss = 4.827543565205166
INFO    [05-05 19:13:46] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-05 19:13:46] validate in BasicTrainer:
{'Recall@10': 0.08879724551330913, 'NDCG@10': 0.0545271211727099, 'MRR@10': 0.044075123627077446, 'Recall@5': 0.06454570049589331, 'NDCG@5': 0.04674374312162399, 'MRR@5': 0.04089775715361942, 'Recall*@10': 0.08879724551330913, 'NDCG*@10': 0.0545271211727099, 'MRR*@10': 0.044075123627077446, 'Recall*@5': 0.06454570049589331, 'NDCG*@5': 0.04674374312162399, 'MRR*@5': 0.04089775715361942}
INFO    [05-05 19:13:46] train in BasicTrainer:
duration: 32.17383098602295s
INFO    [05-05 19:13:46] train in BasicTrainer:
epoch: 45
INFO    [05-05 19:14:00] _train_one_epoch in BasicTrainer:
loss = 4.814948167119708
INFO    [05-05 19:14:18] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-05 19:14:18] validate in BasicTrainer:
{'Recall@10': 0.08965074541893872, 'NDCG@10': 0.05513440275734121, 'MRR@10': 0.04462775960564613, 'Recall@5': 0.06402193145318465, 'NDCG@5': 0.04688978364521807, 'MRR@5': 0.04125022888183594, 'Recall*@10': 0.08965074541893872, 'NDCG*@10': 0.05513440275734121, 'MRR*@10': 0.04462775960564613, 'Recall*@5': 0.06402193145318465, 'NDCG*@5': 0.04688978364521807, 'MRR*@5': 0.04125022888183594}
INFO    [05-05 19:14:18] train in BasicTrainer:
duration: 31.917094230651855s
INFO    [05-05 19:14:18] train in BasicTrainer:
epoch: 46
INFO    [05-05 19:14:31] _train_one_epoch in BasicTrainer:
loss = 4.801705837249756
INFO    [05-05 19:14:50] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-05 19:14:50] validate in BasicTrainer:
{'Recall@10': 0.09008639712225307, 'NDCG@10': 0.05551058358766816, 'MRR@10': 0.0449958165938204, 'Recall@5': 0.06459580361843109, 'NDCG@5': 0.047321468253027306, 'MRR@5': 0.04164747893810272, 'Recall*@10': 0.09008639712225307, 'NDCG*@10': 0.05551058358766816, 'MRR*@10': 0.0449958165938204, 'Recall*@5': 0.06459580361843109, 'NDCG*@5': 0.047321468253027306, 'MRR*@5': 0.04164747893810272}
INFO    [05-05 19:14:50] train in BasicTrainer:
duration: 31.890456914901733s
INFO    [05-05 19:14:50] train in BasicTrainer:
epoch: 47
INFO    [05-05 19:15:03] _train_one_epoch in BasicTrainer:
loss = 4.786552165235792
INFO    [05-05 19:15:21] log in loggers:
Update Best NDCG@10 Model at 47
INFO    [05-05 19:15:22] validate in BasicTrainer:
{'Recall@10': 0.09150047668001869, 'NDCG@10': 0.05573553050106222, 'MRR@10': 0.044862821020863274, 'Recall@5': 0.0649616840210828, 'NDCG@5': 0.0472409687936306, 'MRR@5': 0.04140756821090525, 'Recall*@10': 0.09150047668001869, 'NDCG*@10': 0.05573553050106222, 'MRR*@10': 0.044862821020863274, 'Recall*@5': 0.0649616840210828, 'NDCG*@5': 0.0472409687936306, 'MRR*@5': 0.04140756821090525}
INFO    [05-05 19:15:22] train in BasicTrainer:
duration: 31.498039722442627s
INFO    [05-05 19:15:22] train in BasicTrainer:
epoch: 48
INFO    [05-05 19:15:34] _train_one_epoch in BasicTrainer:
loss = 4.775803327560425
INFO    [05-05 19:15:54] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-05 19:15:54] validate in BasicTrainer:
{'Recall@10': 0.0916063968430866, 'NDCG@10': 0.056331512264230034, 'MRR@10': 0.045582569458267906, 'Recall@5': 0.06639103997837413, 'NDCG@5': 0.04823907532475211, 'MRR@5': 0.042278904129158364, 'Recall*@10': 0.0916063968430866, 'NDCG*@10': 0.056331512264230034, 'MRR*@10': 0.045582569458267906, 'Recall*@5': 0.06639103997837413, 'NDCG*@5': 0.04823907532475211, 'MRR*@5': 0.042278904129158364}
INFO    [05-05 19:15:54] train in BasicTrainer:
duration: 32.037991523742676s
INFO    [05-05 19:15:54] train in BasicTrainer:
epoch: 49
INFO    [05-05 19:16:07] _train_one_epoch in BasicTrainer:
loss = 4.767104864120483
INFO    [05-05 19:16:25] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-05 19:16:26] validate in BasicTrainer:
{'Recall@10': 0.09208391132679852, 'NDCG@10': 0.056508492678403854, 'MRR@10': 0.04568473419005221, 'Recall@5': 0.0660270249301737, 'NDCG@5': 0.04815000295639038, 'MRR@5': 0.04227473078803583, 'Recall*@10': 0.09208391132679852, 'NDCG*@10': 0.056508492678403854, 'MRR*@10': 0.04568473419005221, 'Recall*@5': 0.0660270249301737, 'NDCG*@5': 0.04815000295639038, 'MRR*@5': 0.04227473078803583}
INFO    [05-05 19:16:26] train in BasicTrainer:
duration: 31.854085445404053s
INFO    [05-05 19:16:26] train in BasicTrainer:
epoch: 50
INFO    [05-05 19:16:38] _train_one_epoch in BasicTrainer:
loss = 4.751710065773556
INFO    [05-05 19:16:57] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-05 19:16:57] validate in BasicTrainer:
{'Recall@10': 0.09287654202092778, 'NDCG@10': 0.05691831829872998, 'MRR@10': 0.045962954786690796, 'Recall@5': 0.06632950901985168, 'NDCG@5': 0.04836490106853572, 'MRR@5': 0.04245202311060645, 'Recall*@10': 0.09287654202092778, 'NDCG*@10': 0.05691831829872998, 'MRR*@10': 0.045962954786690796, 'Recall*@5': 0.06632950901985168, 'NDCG*@5': 0.04836490106853572, 'MRR*@5': 0.04245202311060645}
INFO    [05-05 19:16:57] train in BasicTrainer:
duration: 31.784682035446167s
INFO    [05-05 19:16:57] train in BasicTrainer:
epoch: 51
INFO    [05-05 19:17:10] _train_one_epoch in BasicTrainer:
loss = 4.738531700202397
INFO    [05-05 19:17:29] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [05-05 19:17:29] validate in BasicTrainer:
{'Recall@10': 0.09356138652021234, 'NDCG@10': 0.0574479882012714, 'MRR@10': 0.046439025551080704, 'Recall@5': 0.06692052293907512, 'NDCG@5': 0.04885868795893409, 'MRR@5': 0.04290888085961342, 'Recall*@10': 0.09356138652021234, 'NDCG*@10': 0.0574479882012714, 'MRR*@10': 0.046439025551080704, 'Recall*@5': 0.06692052293907512, 'NDCG*@5': 0.04885868795893409, 'MRR*@5': 0.04290888085961342}
INFO    [05-05 19:17:29] train in BasicTrainer:
duration: 31.459178924560547s
INFO    [05-05 19:17:29] train in BasicTrainer:
epoch: 52
INFO    [05-05 19:17:42] _train_one_epoch in BasicTrainer:
loss = 4.728896617889404
INFO    [05-05 19:18:01] validate in BasicTrainer:
{'Recall@10': 0.09261910820549185, 'NDCG@10': 0.05742399326779626, 'MRR@10': 0.046693109991875564, 'Recall@5': 0.06745253232392398, 'NDCG@5': 0.0493464127860286, 'MRR@5': 0.043394644152034416, 'Recall*@10': 0.09261910820549185, 'NDCG*@10': 0.05742399326779626, 'MRR*@10': 0.046693109991875564, 'Recall*@5': 0.06745253232392398, 'NDCG*@5': 0.0493464127860286, 'MRR*@5': 0.043394644152034416}
INFO    [05-05 19:18:01] train in BasicTrainer:
duration: 32.56943869590759s
INFO    [05-05 19:18:01] train in BasicTrainer:
epoch: 53
DEBUG   [05-05 19:18:10] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 6798661
DEBUG   [05-05 19:18:10] calculate_loss in loss:
pred max in softmax: 0.780410647392273, argmax 52993019
DEBUG   [05-05 19:18:10] calculate_loss in loss:
soft_target max: 0.5000730752944946, argmax 2511385
DEBUG   [05-05 19:18:11] calculate_loss in loss:
pred max in softmax: 0.74167799949646, argmax 49915860
INFO    [05-05 19:18:15] _train_one_epoch in BasicTrainer:
loss = 4.718013899666922
INFO    [05-05 19:18:34] log in loggers:
Update Best NDCG@10 Model at 53
INFO    [05-05 19:18:34] validate in BasicTrainer:
{'Recall@10': 0.0931346369060603, 'NDCG@10': 0.05767837877977978, 'MRR@10': 0.04686689918691462, 'Recall@5': 0.06791609254750339, 'NDCG@5': 0.04959000985730778, 'MRR@5': 0.043567069213498726, 'Recall*@10': 0.0931346369060603, 'NDCG*@10': 0.05767837877977978, 'MRR*@10': 0.04686689918691462, 'Recall*@5': 0.06791609254750339, 'NDCG*@5': 0.04959000985730778, 'MRR*@5': 0.043567069213498726}
INFO    [05-05 19:18:34] train in BasicTrainer:
duration: 32.58947253227234s
INFO    [05-05 19:18:34] train in BasicTrainer:
epoch: 54
INFO    [05-05 19:18:48] _train_one_epoch in BasicTrainer:
loss = 4.707984949861254
INFO    [05-05 19:19:07] log in loggers:
Update Best NDCG@10 Model at 54
INFO    [05-05 19:19:07] validate in BasicTrainer:
{'Recall@10': 0.09427095272324303, 'NDCG@10': 0.0584992989897728, 'MRR@10': 0.04758377813480117, 'Recall@5': 0.06847414509816603, 'NDCG@5': 0.05019336024468595, 'MRR@5': 0.0441771498457952, 'Recall*@10': 0.09427095272324303, 'NDCG*@10': 0.0584992989897728, 'MRR*@10': 0.04758377813480117, 'Recall*@5': 0.06847414509816603, 'NDCG*@5': 0.05019336024468595, 'MRR*@5': 0.0441771498457952}
INFO    [05-05 19:19:07] train in BasicTrainer:
duration: 33.064444065093994s
INFO    [05-05 19:19:07] train in BasicTrainer:
epoch: 55
INFO    [05-05 19:19:20] _train_one_epoch in BasicTrainer:
loss = 4.698779080595289
INFO    [05-05 19:19:38] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [05-05 19:19:38] validate in BasicTrainer:
{'Recall@10': 0.09525894305922768, 'NDCG@10': 0.05886344476179643, 'MRR@10': 0.04776641455563632, 'Recall@5': 0.06939675523476167, 'NDCG@5': 0.05055063556541096, 'MRR@5': 0.044364656914364205, 'Recall*@10': 0.09525894305922768, 'NDCG*@10': 0.05886344476179643, 'MRR*@10': 0.04776641455563632, 'Recall*@5': 0.06939675523476167, 'NDCG*@5': 0.05055063556541096, 'MRR*@5': 0.044364656914364205}
INFO    [05-05 19:19:38] train in BasicTrainer:
duration: 31.151099681854248s
INFO    [05-05 19:19:38] train in BasicTrainer:
epoch: 56
INFO    [05-05 19:19:51] _train_one_epoch in BasicTrainer:
loss = 4.686799372945513
INFO    [05-05 19:20:11] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-05 19:20:11] validate in BasicTrainer:
{'Recall@10': 0.0953648638996211, 'NDCG@10': 0.059346091679551384, 'MRR@10': 0.04834326661445878, 'Recall@5': 0.06997128846970471, 'NDCG@5': 0.05117678439075297, 'MRR@5': 0.04499688507481055, 'Recall*@10': 0.0953648638996211, 'NDCG*@10': 0.059346091679551384, 'MRR*@10': 0.04834326661445878, 'Recall*@5': 0.06997128846970471, 'NDCG*@5': 0.05117678439075297, 'MRR*@5': 0.04499688507481055}
INFO    [05-05 19:20:11] train in BasicTrainer:
duration: 32.523680210113525s
INFO    [05-05 19:20:11] train in BasicTrainer:
epoch: 57
INFO    [05-05 19:20:23] _train_one_epoch in BasicTrainer:
loss = 4.679138123989105
INFO    [05-05 19:20:42] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-05 19:20:42] validate in BasicTrainer:
{'Recall@10': 0.09648975188081915, 'NDCG@10': 0.05989708107980815, 'MRR@10': 0.04872942411086776, 'Recall@5': 0.07082545012235641, 'NDCG@5': 0.05167994275689125, 'MRR@5': 0.04538629407232458, 'Recall*@10': 0.09648975188081915, 'NDCG*@10': 0.05989708107980815, 'MRR*@10': 0.04872942411086776, 'Recall*@5': 0.07082545012235641, 'NDCG*@5': 0.05167994275689125, 'MRR*@5': 0.04538629407232458}
INFO    [05-05 19:20:42] train in BasicTrainer:
duration: 30.99400496482849s
INFO    [05-05 19:20:42] train in BasicTrainer:
epoch: 58
INFO    [05-05 19:20:55] _train_one_epoch in BasicTrainer:
loss = 4.671677265848432
INFO    [05-05 19:21:14] validate in BasicTrainer:
{'Recall@10': 0.09544726664369757, 'NDCG@10': 0.05956177616661245, 'MRR@10': 0.04861856285821308, 'Recall@5': 0.07016279954801906, 'NDCG@5': 0.05145637250759385, 'MRR@5': 0.045314950021830475, 'Recall*@10': 0.09544726664369757, 'NDCG*@10': 0.05956177616661245, 'MRR*@10': 0.04861856285821308, 'Recall*@5': 0.07016279954801906, 'NDCG*@5': 0.05145637250759385, 'MRR*@5': 0.045314950021830475}
INFO    [05-05 19:21:14] train in BasicTrainer:
duration: 32.54414224624634s
INFO    [05-05 19:21:14] train in BasicTrainer:
epoch: 59
INFO    [05-05 19:21:27] _train_one_epoch in BasicTrainer:
loss = 4.659127414226532
INFO    [05-05 19:21:46] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [05-05 19:21:46] validate in BasicTrainer:
{'Recall@10': 0.09645931693640622, 'NDCG@10': 0.05992985076524995, 'MRR@10': 0.048772826452146874, 'Recall@5': 0.06995733420957219, 'NDCG@5': 0.051364950158379295, 'MRR@5': 0.0452414486895908, 'Recall*@10': 0.09645931693640622, 'NDCG*@10': 0.05992985076524995, 'MRR*@10': 0.048772826452146874, 'Recall*@5': 0.06995733420957219, 'NDCG*@5': 0.051364950158379295, 'MRR*@5': 0.0452414486895908}
INFO    [05-05 19:21:46] train in BasicTrainer:
duration: 31.57189393043518s
INFO    [05-05 19:21:46] close_training in BasicTrainer:
finished training
DEBUG   [05-05 19:21:46] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3361 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-05 19:21:46] run_routine in Routine:
Finished training, Start final validation
INFO    [05-05 19:21:46] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-05 19:21:46] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 19:21:46] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 19:22:04] validate in BasicTrainer:
{'Recall@10': 0.09645931693640622, 'NDCG@10': 0.05992985076524995, 'MRR@10': 0.048772826452146874, 'Recall@5': 0.06995733420957219, 'NDCG@5': 0.051364950158379295, 'MRR@5': 0.0452414486895908, 'Recall*@10': 0.09645931693640622, 'NDCG*@10': 0.05992985076524995, 'MRR*@10': 0.048772826452146874, 'Recall*@5': 0.06995733420957219, 'NDCG*@5': 0.051364950158379295, 'MRR*@5': 0.0452414486895908}
INFO    [05-05 19:22:04] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.09645931693640622, 'NDCG@10': 0.05992985076524995, 'MRR@10': 0.048772826452146874, 'Recall@5': 0.06995733420957219, 'NDCG@5': 0.051364950158379295, 'MRR@5': 0.0452414486895908, 'Recall*@10': 0.09645931693640622, 'NDCG*@10': 0.05992985076524995, 'MRR*@10': 0.048772826452146874, 'Recall*@5': 0.06995733420957219, 'NDCG*@5': 0.051364950158379295, 'MRR*@5': 0.0452414486895908}
INFO    [05-05 19:22:04] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-05 19:22:04] test in BasicTrainer:
Test model on test set!
INFO    [05-05 19:22:04] test_with_given_state_path in BasicTrainer:
Loading model params from ___yelp_soft_2022/pop_narm-T-9.0-al-0.5_05-05_18:48_t11/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-05 19:22:04] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 19:22:04] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 19:22:04] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-05 19:22:23] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.07996950772675601, 'NDCG@10': 0.04796669124202295, 'MRR@10': 0.0382386903193864, 'Recall@5': 0.056011002849448814, 'NDCG@5': 0.04023597084663131, 'MRR@5': 0.03505841202356599, 'Recall*@10': 0.07996950772675601, 'NDCG*@10': 0.04796669124202295, 'MRR*@10': 0.0382386903193864, 'Recall*@5': 0.056011002849448814, 'NDCG*@5': 0.04023597084663131, 'MRR*@5': 0.03505841202356599}
INFO    [05-05 19:22:23] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.07996950772675601, 'NDCG@10': 0.04796669124202295, 'MRR@10': 0.0382386903193864, 'Recall@5': 0.056011002849448814, 'NDCG@5': 0.04023597084663131, 'MRR@5': 0.03505841202356599, 'Recall*@10': 0.07996950772675601, 'NDCG*@10': 0.04796669124202295, 'MRR*@10': 0.0382386903193864, 'Recall*@5': 0.056011002849448814, 'NDCG*@5': 0.04023597084663131, 'MRR*@5': 0.03505841202356599}
