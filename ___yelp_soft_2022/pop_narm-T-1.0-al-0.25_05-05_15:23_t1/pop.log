INFO    [05-05 15:23:30] setup_train in utils:
{
    "experiment_dir": "___yelp_soft_2022",
    "experiment_description": "pop",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "yelp.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "alpha": 0.25,
    "T": 1.0,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.yelp/narm/config_distill.json",
    "task_id": 1,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "dvae_alpha": 0.5,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-05 15:23:30] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-05 15:23:30] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/yelp-5-5.pkl
INFO    [05-05 15:23:31] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-05 15:23:31] _check_dataset_cache in utils:
correct.
INFO    [05-05 15:23:31] __init__ in NextItemDataloader:
there are 20033 items in this dataset, 43947 users, padding_first? False
DEBUG   [05-05 15:23:39] generate_model in utils:
model_code_list=['pop']
INFO    [05-05 15:23:39] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-05 15:23:39] load_model_config in utils:
{}
WARNING [05-05 15:23:44] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.25_05-05_15:23_t1/teacher_pop_logs does not exist! Create one.
WARNING [05-05 15:23:44] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.25_05-05_15:23_t1/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-05 15:23:44] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.25_05-05_15:23_t1/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-05 15:23:44] get_path in utils:
Path is None
WARNING [05-05 15:23:44] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 15:23:44] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-05 15:23:44] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 15:23:44] __init__ in BasicTrainer:
229376 iter per epoch
DEBUG   [05-05 15:23:44] generate_model in utils:
model_code_list=['narm']
INFO    [05-05 15:23:44] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-05 15:23:44] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-05 15:23:47] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.25_05-05_15:23_t1/student_narm_logs does not exist! Create one.
WARNING [05-05 15:23:47] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.25_05-05_15:23_t1/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-05 15:23:47] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-1.0-al-0.25_05-05_15:23_t1/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-05 15:23:47] get_path in utils:
Path is None
WARNING [05-05 15:23:47] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 15:23:47] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(20034, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-05 15:23:47] assert_model_device in utils:
model student_narm has 5.3603515625 MB params.
INFO    [05-05 15:23:47] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 15:23:47] __init__ in DistillTrainer:
229376 iter per epoch
INFO    [05-05 15:23:47] _set_current_routine in Routine:
first routine: student
INFO    [05-05 15:23:47] run_routine in Routine:
Start routine student
INFO    [05-05 15:23:47] run_routine in Routine:
Start training
INFO    [05-05 15:23:47] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-05 15:24:06] test_mentor in DistillTrainer:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 15:24:06] train in DistillTrainer:
result:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 15:24:25] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 15:24:25] validate in BasicTrainer:
{'Recall@10': 0.00044389204545454544, 'NDCG@10': 0.0002111054676457901, 'MRR@10': 0.0001419221515044972, 'Recall@5': 0.0003107244318181818, 'NDCG@5': 0.0001693654326531528, 'MRR@5': 0.00012539950462682597, 'Recall*@10': 0.00044389204545454544, 'NDCG*@10': 0.0002111054676457901, 'MRR*@10': 0.0001419221515044972, 'Recall*@5': 0.0003107244318181818, 'NDCG*@5': 0.0001693654326531528, 'MRR*@5': 0.00012539950462682597}
INFO    [05-05 15:24:25] train in BasicTrainer:
epoch: 0
DEBUG   [05-05 15:24:26] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 9282877
DEBUG   [05-05 15:24:26] calculate_loss in loss:
pred max in softmax: 5.0033249863190576e-05, argmax 48228322
INFO    [05-05 15:24:34] _train_one_epoch in BasicTrainer:
loss = 8.85965291091374
INFO    [05-05 15:24:52] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 15:24:52] validate in BasicTrainer:
{'Recall@10': 0.00892529890618541, 'NDCG@10': 0.004392979941754179, 'MRR@10': 0.003025907472791997, 'Recall@5': 0.005178260024298321, 'NDCG@5': 0.0031931207049638033, 'MRR@5': 0.002537306525151838, 'Recall*@10': 0.00892529890618541, 'NDCG*@10': 0.004392979941754179, 'MRR*@10': 0.003025907472791997, 'Recall*@5': 0.005178260024298321, 'NDCG*@5': 0.0031931207049638033, 'MRR*@5': 0.002537306525151838}
INFO    [05-05 15:24:52] train in BasicTrainer:
duration: 27.25223159790039s
INFO    [05-05 15:24:52] train in BasicTrainer:
epoch: 1
INFO    [05-05 15:25:01] _train_one_epoch in BasicTrainer:
loss = 8.418814812387739
INFO    [05-05 15:25:20] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-05 15:25:20] validate in BasicTrainer:
{'Recall@10': 0.011494158767163754, 'NDCG@10': 0.0056796847757968035, 'MRR@10': 0.003943441456861116, 'Recall@5': 0.006565092046829787, 'NDCG@5': 0.004111294444142418, 'MRR@5': 0.003311049235476689, 'Recall*@10': 0.011494158767163754, 'NDCG*@10': 0.0056796847757968035, 'MRR*@10': 0.003943441456861116, 'Recall*@5': 0.006565092046829787, 'NDCG*@5': 0.004111294444142418, 'MRR*@5': 0.003311049235476689}
INFO    [05-05 15:25:20] train in BasicTrainer:
duration: 27.754870414733887s
INFO    [05-05 15:25:20] train in BasicTrainer:
epoch: 2
INFO    [05-05 15:25:29] _train_one_epoch in BasicTrainer:
loss = 8.058894796030861
INFO    [05-05 15:25:47] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-05 15:25:48] validate in BasicTrainer:
{'Recall@10': 0.015335689976134083, 'NDCG@10': 0.007129441438750787, 'MRR@10': 0.0047072908544743605, 'Recall@5': 0.007771840869364413, 'NDCG@5': 0.0047283760610629215, 'MRR@5': 0.003742847591638565, 'Recall*@10': 0.015335689976134083, 'NDCG*@10': 0.007129441438750787, 'MRR*@10': 0.0047072908544743605, 'Recall*@5': 0.007771840869364413, 'NDCG*@5': 0.0047283760610629215, 'MRR*@5': 0.003742847591638565}
INFO    [05-05 15:25:48] train in BasicTrainer:
duration: 27.41981291770935s
INFO    [05-05 15:25:48] train in BasicTrainer:
epoch: 3
INFO    [05-05 15:25:56] _train_one_epoch in BasicTrainer:
loss = 7.794513276645115
INFO    [05-05 15:26:15] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-05 15:26:16] validate in BasicTrainer:
{'Recall@10': 0.019482231614264576, 'NDCG@10': 0.009011202364821325, 'MRR@10': 0.0059005805629898204, 'Recall@5': 0.010087658481841738, 'NDCG@5': 0.006003193049268289, 'MRR@5': 0.0046766468916427, 'Recall*@10': 0.019482231614264576, 'NDCG*@10': 0.009011202364821325, 'MRR*@10': 0.0059005805629898204, 'Recall*@5': 0.010087658481841738, 'NDCG*@5': 0.006003193049268289, 'MRR*@5': 0.0046766468916427}
INFO    [05-05 15:26:16] train in BasicTrainer:
duration: 28.00456142425537s
INFO    [05-05 15:26:16] train in BasicTrainer:
epoch: 4
INFO    [05-05 15:26:25] _train_one_epoch in BasicTrainer:
loss = 7.617954679897854
INFO    [05-05 15:26:43] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-05 15:26:43] validate in BasicTrainer:
{'Recall@10': 0.02279109236868945, 'NDCG@10': 0.010368193499743938, 'MRR@10': 0.006690185771069743, 'Recall@5': 0.01151063936677846, 'NDCG@5': 0.006772712931375612, 'MRR@5': 0.005236931399188258, 'Recall*@10': 0.02279109236868945, 'NDCG*@10': 0.010368193499743938, 'MRR*@10': 0.006690185771069743, 'Recall*@5': 0.01151063936677846, 'NDCG*@5': 0.006772712931375612, 'MRR*@5': 0.005236931399188258}
INFO    [05-05 15:26:43] train in BasicTrainer:
duration: 27.761677980422974s
INFO    [05-05 15:26:43] train in BasicTrainer:
epoch: 5
INFO    [05-05 15:26:52] _train_one_epoch in BasicTrainer:
loss = 7.483845881053379
INFO    [05-05 15:27:11] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-05 15:27:11] validate in BasicTrainer:
{'Recall@10': 0.02433900060978803, 'NDCG@10': 0.010802020911465992, 'MRR@10': 0.006787210110236298, 'Recall@5': 0.012231633321128109, 'NDCG@5': 0.006911184977401386, 'MRR@5': 0.005195481448688291, 'Recall*@10': 0.02433900060978803, 'NDCG*@10': 0.010802020911465992, 'MRR*@10': 0.006787210110236298, 'Recall*@5': 0.012231633321128109, 'NDCG*@5': 0.006911184977401386, 'MRR*@5': 0.005195481448688291}
INFO    [05-05 15:27:11] train in BasicTrainer:
duration: 27.722811937332153s
INFO    [05-05 15:27:11] train in BasicTrainer:
epoch: 6
INFO    [05-05 15:27:20] _train_one_epoch in BasicTrainer:
loss = 7.379538919244494
INFO    [05-05 15:27:39] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-05 15:27:39] validate in BasicTrainer:
{'Recall@10': 0.02621664022180167, 'NDCG@10': 0.011727442118254576, 'MRR@10': 0.0074181267991662025, 'Recall@5': 0.01350496599281376, 'NDCG@5': 0.007654081987725062, 'MRR@5': 0.005758694965731014, 'Recall*@10': 0.02621664022180167, 'NDCG*@10': 0.011727442118254576, 'MRR*@10': 0.0074181267991662025, 'Recall*@5': 0.01350496599281376, 'NDCG*@5': 0.007654081987725062, 'MRR*@5': 0.005758694965731014}
INFO    [05-05 15:27:39] train in BasicTrainer:
duration: 27.826400995254517s
INFO    [05-05 15:27:39] train in BasicTrainer:
epoch: 7
INFO    [05-05 15:27:48] _train_one_epoch in BasicTrainer:
loss = 7.2731053829193115
INFO    [05-05 15:28:07] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-05 15:28:07] validate in BasicTrainer:
{'Recall@10': 0.028327653692527252, 'NDCG@10': 0.0130880196494135, 'MRR@10': 0.008532485755329782, 'Recall@5': 0.01567684935236519, 'NDCG@5': 0.009042417715218935, 'MRR@5': 0.0068891434083608065, 'Recall*@10': 0.028327653692527252, 'NDCG*@10': 0.0130880196494135, 'MRR*@10': 0.008532485755329782, 'Recall*@5': 0.01567684935236519, 'NDCG*@5': 0.009042417715218935, 'MRR*@5': 0.0068891434083608065}
INFO    [05-05 15:28:07] train in BasicTrainer:
duration: 27.9973042011261s
INFO    [05-05 15:28:07] train in BasicTrainer:
epoch: 8
INFO    [05-05 15:28:16] _train_one_epoch in BasicTrainer:
loss = 7.156517914363316
INFO    [05-05 15:28:34] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-05 15:28:35] validate in BasicTrainer:
{'Recall@10': 0.03270504301921888, 'NDCG@10': 0.015001376836814663, 'MRR@10': 0.009709965098987926, 'Recall@5': 0.01767117597840049, 'NDCG@5': 0.010174873284995556, 'MRR@5': 0.007738682314414869, 'Recall*@10': 0.03270504301921888, 'NDCG*@10': 0.015001376836814663, 'MRR*@10': 0.009709965098987926, 'Recall*@5': 0.01767117597840049, 'NDCG*@5': 0.010174873284995556, 'MRR*@5': 0.007738682314414869}
INFO    [05-05 15:28:35] train in BasicTrainer:
duration: 27.607988119125366s
INFO    [05-05 15:28:35] train in BasicTrainer:
epoch: 9
INFO    [05-05 15:28:43] _train_one_epoch in BasicTrainer:
loss = 7.042075412614005
INFO    [05-05 15:29:02] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-05 15:29:02] validate in BasicTrainer:
{'Recall@10': 0.03552562269297513, 'NDCG@10': 0.016170708039267498, 'MRR@10': 0.01039720902388746, 'Recall@5': 0.018933080644770103, 'NDCG@5': 0.010874765417115255, 'MRR@5': 0.008252254898913881, 'Recall*@10': 0.03552562269297513, 'NDCG*@10': 0.016170708039267498, 'MRR*@10': 0.01039720902388746, 'Recall*@5': 0.018933080644770103, 'NDCG*@5': 0.010874765417115255, 'MRR*@5': 0.008252254898913881}
INFO    [05-05 15:29:02] train in BasicTrainer:
duration: 27.826114892959595s
INFO    [05-05 15:29:02] train in BasicTrainer:
epoch: 10
INFO    [05-05 15:29:11] _train_one_epoch in BasicTrainer:
loss = 6.947399982384273
INFO    [05-05 15:29:30] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-05 15:29:30] validate in BasicTrainer:
{'Recall@10': 0.03854848004200242, 'NDCG@10': 0.017409482716836712, 'MRR@10': 0.011094718155535784, 'Recall@5': 0.02055009894750335, 'NDCG@5': 0.01164238281886686, 'MRR@5': 0.008745698088949377, 'Recall*@10': 0.03854848004200242, 'NDCG*@10': 0.017409482716836712, 'MRR*@10': 0.011094718155535784, 'Recall*@5': 0.02055009894750335, 'NDCG*@5': 0.01164238281886686, 'MRR*@5': 0.008745698088949377}
INFO    [05-05 15:29:30] train in BasicTrainer:
duration: 27.711697578430176s
INFO    [05-05 15:29:30] train in BasicTrainer:
epoch: 11
INFO    [05-05 15:29:39] _train_one_epoch in BasicTrainer:
loss = 6.874058791569301
INFO    [05-05 15:29:58] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-05 15:29:58] validate in BasicTrainer:
{'Recall@10': 0.04113887318155982, 'NDCG@10': 0.01891224170950326, 'MRR@10': 0.01226587068628181, 'Recall@5': 0.021943306211720814, 'NDCG@5': 0.012753805907612497, 'MRR@5': 0.009752774611115456, 'Recall*@10': 0.04113887318155982, 'NDCG*@10': 0.01891224170950326, 'MRR*@10': 0.01226587068628181, 'Recall*@5': 0.021943306211720814, 'NDCG*@5': 0.012753805907612497, 'MRR*@5': 0.009752774611115456}
INFO    [05-05 15:29:58] train in BasicTrainer:
duration: 28.017205715179443s
INFO    [05-05 15:29:58] train in BasicTrainer:
epoch: 12
INFO    [05-05 15:30:06] _train_one_epoch in BasicTrainer:
loss = 6.821007294314248
INFO    [05-05 15:30:25] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-05 15:30:25] validate in BasicTrainer:
{'Recall@10': 0.041835807263851166, 'NDCG@10': 0.019029728560285133, 'MRR@10': 0.012210797349160368, 'Recall@5': 0.022691547362641853, 'NDCG@5': 0.012902695854956453, 'MRR@5': 0.009719013659791513, 'Recall*@10': 0.041835807263851166, 'NDCG*@10': 0.019029728560285133, 'MRR*@10': 0.012210797349160368, 'Recall*@5': 0.022691547362641853, 'NDCG*@5': 0.012902695854956453, 'MRR*@5': 0.009719013659791513}
INFO    [05-05 15:30:25] train in BasicTrainer:
duration: 27.142476081848145s
INFO    [05-05 15:30:25] train in BasicTrainer:
epoch: 13
INFO    [05-05 15:30:34] _train_one_epoch in BasicTrainer:
loss = 6.777797264712198
INFO    [05-05 15:30:53] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-05 15:30:53] validate in BasicTrainer:
{'Recall@10': 0.04348139566454021, 'NDCG@10': 0.019924585114825855, 'MRR@10': 0.012870581651275808, 'Recall@5': 0.024020035835829647, 'NDCG@5': 0.013703593814914877, 'MRR@5': 0.010345077819444916, 'Recall*@10': 0.04348139566454021, 'NDCG*@10': 0.019924585114825855, 'MRR*@10': 0.012870581651275808, 'Recall*@5': 0.024020035835829647, 'NDCG*@5': 0.013703593814914877, 'MRR*@5': 0.010345077819444916}
INFO    [05-05 15:30:53] train in BasicTrainer:
duration: 27.863258123397827s
INFO    [05-05 15:30:53] train in BasicTrainer:
epoch: 14
INFO    [05-05 15:31:02] _train_one_epoch in BasicTrainer:
loss = 6.740744761058262
INFO    [05-05 15:31:20] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-05 15:31:21] validate in BasicTrainer:
{'Recall@10': 0.04410152171145786, 'NDCG@10': 0.020379017869179897, 'MRR@10': 0.013257939199155027, 'Recall@5': 0.024536225775426083, 'NDCG@5': 0.014088838191872293, 'MRR@5': 0.010683174668387934, 'Recall*@10': 0.04410152171145786, 'NDCG*@10': 0.020379017869179897, 'MRR*@10': 0.013257939199155027, 'Recall*@5': 0.024536225775426083, 'NDCG*@5': 0.014088838191872293, 'MRR*@5': 0.010683174668387934}
INFO    [05-05 15:31:21] train in BasicTrainer:
duration: 27.555340051651s
INFO    [05-05 15:31:21] train in BasicTrainer:
epoch: 15
INFO    [05-05 15:31:29] _train_one_epoch in BasicTrainer:
loss = 6.704018439565386
INFO    [05-05 15:31:48] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-05 15:31:48] validate in BasicTrainer:
{'Recall@10': 0.04445477033203298, 'NDCG@10': 0.02050083977254954, 'MRR@10': 0.013322934084995226, 'Recall@5': 0.02482728185978803, 'NDCG@5': 0.014221069148995659, 'MRR@5': 0.01077084234831008, 'Recall*@10': 0.04445477033203298, 'NDCG*@10': 0.02050083977254954, 'MRR*@10': 0.013322934084995226, 'Recall*@5': 0.02482728185978803, 'NDCG*@5': 0.014221069148995659, 'MRR*@5': 0.01077084234831008}
INFO    [05-05 15:31:48] train in BasicTrainer:
duration: 27.613067626953125s
INFO    [05-05 15:31:48] train in BasicTrainer:
epoch: 16
INFO    [05-05 15:31:57] _train_one_epoch in BasicTrainer:
loss = 6.673841255051749
INFO    [05-05 15:32:15] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-05 15:32:16] validate in BasicTrainer:
{'Recall@10': 0.04551692374727943, 'NDCG@10': 0.02121603742919185, 'MRR@10': 0.013948115096850828, 'Recall@5': 0.024957923218607903, 'NDCG@5': 0.014641334048726341, 'MRR@5': 0.011277456005865877, 'Recall*@10': 0.04551692374727943, 'NDCG*@10': 0.02121603742919185, 'MRR*@10': 0.013948115096850828, 'Recall*@5': 0.024957923218607903, 'NDCG*@5': 0.014641334048726341, 'MRR*@5': 0.011277456005865877}
INFO    [05-05 15:32:16] train in BasicTrainer:
duration: 27.24052906036377s
INFO    [05-05 15:32:16] train in BasicTrainer:
epoch: 17
DEBUG   [05-05 15:32:23] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 1109005
DEBUG   [05-05 15:32:23] calculate_loss in loss:
pred max in softmax: 0.9440032243728638, argmax 51410269
DEBUG   [05-05 15:32:24] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 7399681
DEBUG   [05-05 15:32:24] calculate_loss in loss:
pred max in softmax: 0.631898045539856, argmax 7579987
INFO    [05-05 15:32:25] _train_one_epoch in BasicTrainer:
loss = 6.6421972172600885
INFO    [05-05 15:32:44] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-05 15:32:44] validate in BasicTrainer:
{'Recall@10': 0.045769304714419624, 'NDCG@10': 0.02144226160916415, 'MRR@10': 0.014127499254589731, 'Recall@5': 0.0262781713496555, 'NDCG@5': 0.015186501836234873, 'MRR@5': 0.011572856540707025, 'Recall*@10': 0.045769304714419624, 'NDCG*@10': 0.02144226160916415, 'MRR*@10': 0.014127499254589731, 'Recall*@5': 0.0262781713496555, 'NDCG*@5': 0.015186501836234873, 'MRR*@5': 0.011572856540707025}
INFO    [05-05 15:32:44] train in BasicTrainer:
duration: 28.266475200653076s
INFO    [05-05 15:32:44] train in BasicTrainer:
epoch: 18
INFO    [05-05 15:32:52] _train_one_epoch in BasicTrainer:
loss = 6.6122873936380655
INFO    [05-05 15:33:11] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-05 15:33:11] validate in BasicTrainer:
{'Recall@10': 0.045727441934022034, 'NDCG@10': 0.021490145136009563, 'MRR@10': 0.014215405437756668, 'Recall@5': 0.025756928900426083, 'NDCG@5': 0.015088875947350805, 'MRR@5': 0.011606917377899994, 'Recall*@10': 0.045727441934022034, 'NDCG*@10': 0.021490145136009563, 'MRR*@10': 0.014215405437756668, 'Recall*@5': 0.025756928900426083, 'NDCG*@5': 0.015088875947350805, 'MRR*@5': 0.011606917377899994}
INFO    [05-05 15:33:11] train in BasicTrainer:
duration: 27.208069324493408s
INFO    [05-05 15:33:11] train in BasicTrainer:
epoch: 19
INFO    [05-05 15:33:19] _train_one_epoch in BasicTrainer:
loss = 6.582454068320138
INFO    [05-05 15:33:38] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-05 15:33:39] validate in BasicTrainer:
{'Recall@10': 0.047073072330518204, 'NDCG@10': 0.022063753990964455, 'MRR@10': 0.014562675221399828, 'Recall@5': 0.026477922770110043, 'NDCG@5': 0.015462668019939552, 'MRR@5': 0.011873021891171282, 'Recall*@10': 0.047073072330518204, 'NDCG*@10': 0.022063753990964455, 'MRR*@10': 0.014562675221399828, 'Recall*@5': 0.026477922770110043, 'NDCG*@5': 0.015462668019939552, 'MRR*@5': 0.011873021891171282}
INFO    [05-05 15:33:39] train in BasicTrainer:
duration: 27.64924693107605s
INFO    [05-05 15:33:39] train in BasicTrainer:
epoch: 20
INFO    [05-05 15:33:47] _train_one_epoch in BasicTrainer:
loss = 6.5528168593134195
INFO    [05-05 15:34:06] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-05 15:34:06] validate in BasicTrainer:
{'Recall@10': 0.04827344586903399, 'NDCG@10': 0.022983646189624615, 'MRR@10': 0.015382021157578989, 'Recall@5': 0.0277430150996555, 'NDCG@5': 0.016407847065817226, 'MRR@5': 0.012704789553853598, 'Recall*@10': 0.04827344586903399, 'NDCG*@10': 0.022983646189624615, 'MRR*@10': 0.015382021157578989, 'Recall*@5': 0.0277430150996555, 'NDCG*@5': 0.016407847065817226, 'MRR*@5': 0.012704789553853598}
INFO    [05-05 15:34:06] train in BasicTrainer:
duration: 27.47418761253357s
INFO    [05-05 15:34:06] train in BasicTrainer:
epoch: 21
INFO    [05-05 15:34:14] _train_one_epoch in BasicTrainer:
loss = 6.520603733403342
INFO    [05-05 15:34:34] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-05 15:34:34] validate in BasicTrainer:
{'Recall@10': 0.04993232678283344, 'NDCG@10': 0.024080560796640137, 'MRR@10': 0.016326410272582012, 'Recall@5': 0.02855212613940239, 'NDCG@5': 0.017214477570219475, 'MRR@5': 0.013520766134289179, 'Recall*@10': 0.04993232678283344, 'NDCG*@10': 0.024080560796640137, 'MRR*@10': 0.016326410272582012, 'Recall*@5': 0.02855212613940239, 'NDCG*@5': 0.017214477570219475, 'MRR*@5': 0.013520766134289179}
INFO    [05-05 15:34:34] train in BasicTrainer:
duration: 27.760517358779907s
INFO    [05-05 15:34:34] train in BasicTrainer:
epoch: 22
INFO    [05-05 15:34:42] _train_one_epoch in BasicTrainer:
loss = 6.488602885178158
INFO    [05-05 15:35:01] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-05 15:35:01] validate in BasicTrainer:
{'Recall@10': 0.049860029058022934, 'NDCG@10': 0.024107027460228313, 'MRR@10': 0.016361240297555923, 'Recall@5': 0.028791214085438034, 'NDCG@5': 0.01736702761528167, 'MRR@5': 0.013622361912646076, 'Recall*@10': 0.049860029058022934, 'NDCG*@10': 0.024107027460228313, 'MRR*@10': 0.016361240297555923, 'Recall*@5': 0.028791214085438034, 'NDCG*@5': 0.01736702761528167, 'MRR*@5': 0.013622361912646076}
INFO    [05-05 15:35:01] train in BasicTrainer:
duration: 27.25022530555725s
INFO    [05-05 15:35:01] train in BasicTrainer:
epoch: 23
INFO    [05-05 15:35:10] _train_one_epoch in BasicTrainer:
loss = 6.456714485372816
INFO    [05-05 15:35:29] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-05 15:35:29] validate in BasicTrainer:
{'Recall@10': 0.05127410827712579, 'NDCG@10': 0.025002918121489612, 'MRR@10': 0.017088619568808514, 'Recall@5': 0.030278252437710762, 'NDCG@5': 0.018265699544413525, 'MRR@5': 0.01433903021229939, 'Recall*@10': 0.05127410827712579, 'NDCG*@10': 0.025002918121489612, 'MRR*@10': 0.017088619568808514, 'Recall*@5': 0.030278252437710762, 'NDCG*@5': 0.018265699544413525, 'MRR*@5': 0.01433903021229939}
INFO    [05-05 15:35:29] train in BasicTrainer:
duration: 27.89137291908264s
INFO    [05-05 15:35:29] train in BasicTrainer:
epoch: 24
INFO    [05-05 15:35:37] _train_one_epoch in BasicTrainer:
loss = 6.425848160471235
INFO    [05-05 15:35:56] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-05 15:35:56] validate in BasicTrainer:
{'Recall@10': 0.05219485373659567, 'NDCG@10': 0.02557234042747454, 'MRR@10': 0.017548324878920208, 'Recall@5': 0.03137270564382726, 'NDCG@5': 0.018889370289715855, 'MRR@5': 0.014818878929046068, 'Recall*@10': 0.05219485373659567, 'NDCG*@10': 0.02557234042747454, 'MRR*@10': 0.017548324878920208, 'Recall*@5': 0.03137270564382726, 'NDCG*@5': 0.018889370289715855, 'MRR*@5': 0.014818878929046068}
INFO    [05-05 15:35:56] train in BasicTrainer:
duration: 27.207067728042603s
INFO    [05-05 15:35:56] train in BasicTrainer:
epoch: 25
INFO    [05-05 15:36:05] _train_one_epoch in BasicTrainer:
loss = 6.394464365073612
INFO    [05-05 15:36:24] validate in BasicTrainer:
{'Recall@10': 0.05211684209379283, 'NDCG@10': 0.025435172868045895, 'MRR@10': 0.017403928986327213, 'Recall@5': 0.030838170173493298, 'NDCG@5': 0.018596379763700745, 'MRR@5': 0.014605676331980661, 'Recall*@10': 0.05211684209379283, 'NDCG*@10': 0.025435172868045895, 'MRR*@10': 0.017403928986327213, 'Recall*@5': 0.030838170173493298, 'NDCG*@5': 0.018596379763700745, 'MRR*@5': 0.014605676331980661}
INFO    [05-05 15:36:24] train in BasicTrainer:
duration: 27.89827036857605s
INFO    [05-05 15:36:24] train in BasicTrainer:
epoch: 26
INFO    [05-05 15:36:32] _train_one_epoch in BasicTrainer:
loss = 6.360825947352818
INFO    [05-05 15:36:51] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-05 15:36:51] validate in BasicTrainer:
{'Recall@10': 0.054338828745213424, 'NDCG@10': 0.026666213334961372, 'MRR@10': 0.018372252922166477, 'Recall@5': 0.03130106915804473, 'NDCG@5': 0.019282753494652836, 'MRR@5': 0.015363706783814863, 'Recall*@10': 0.054338828745213424, 'NDCG*@10': 0.026666213334961372, 'MRR*@10': 0.018372252922166477, 'Recall*@5': 0.03130106915804473, 'NDCG*@5': 0.019282753494652836, 'MRR*@5': 0.015363706783814863}
INFO    [05-05 15:36:51] train in BasicTrainer:
duration: 27.269761085510254s
INFO    [05-05 15:36:51] train in BasicTrainer:
epoch: 27
INFO    [05-05 15:37:01] _train_one_epoch in BasicTrainer:
loss = 6.331320345401764
INFO    [05-05 15:37:20] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-05 15:37:20] validate in BasicTrainer:
{'Recall@10': 0.0538118722086603, 'NDCG@10': 0.026707391000606796, 'MRR@10': 0.018535681068897247, 'Recall@5': 0.03241837837479331, 'NDCG@5': 0.019855267960916866, 'MRR@5': 0.01574637960981239, 'Recall*@10': 0.0538118722086603, 'NDCG*@10': 0.026707391000606796, 'MRR*@10': 0.018535681068897247, 'Recall*@5': 0.03241837837479331, 'NDCG*@5': 0.019855267960916866, 'MRR*@5': 0.01574637960981239}
INFO    [05-05 15:37:20] train in BasicTrainer:
duration: 28.922755002975464s
INFO    [05-05 15:37:20] train in BasicTrainer:
epoch: 28
INFO    [05-05 15:37:29] _train_one_epoch in BasicTrainer:
loss = 6.30025611604963
INFO    [05-05 15:37:47] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-05 15:37:47] validate in BasicTrainer:
{'Recall@10': 0.054803050038489426, 'NDCG@10': 0.02762376313859766, 'MRR@10': 0.019419362091205337, 'Recall@5': 0.03360359387641603, 'NDCG@5': 0.020809500901536507, 'MRR@5': 0.016631526449187237, 'Recall*@10': 0.054803050038489426, 'NDCG*@10': 0.02762376313859766, 'MRR*@10': 0.019419362091205337, 'Recall*@5': 0.03360359387641603, 'NDCG*@5': 0.020809500901536507, 'MRR*@5': 0.016631526449187237}
INFO    [05-05 15:37:47] train in BasicTrainer:
duration: 27.160857677459717s
INFO    [05-05 15:37:47] train in BasicTrainer:
epoch: 29
INFO    [05-05 15:37:56] _train_one_epoch in BasicTrainer:
loss = 6.26974937745503
INFO    [05-05 15:38:16] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-05 15:38:16] validate in BasicTrainer:
{'Recall@10': 0.0550408156758005, 'NDCG@10': 0.027673284777186134, 'MRR@10': 0.019418672235174614, 'Recall@5': 0.0336891846223311, 'NDCG@5': 0.02082040448757735, 'MRR@5': 0.016621171581474217, 'Recall*@10': 0.0550408156758005, 'NDCG*@10': 0.027673284777186134, 'MRR*@10': 0.019418672235174614, 'Recall*@5': 0.0336891846223311, 'NDCG*@5': 0.02082040448757735, 'MRR*@5': 0.016621171581474217}
INFO    [05-05 15:38:16] train in BasicTrainer:
duration: 28.53311777114868s
INFO    [05-05 15:38:16] train in BasicTrainer:
epoch: 30
INFO    [05-05 15:38:25] _train_one_epoch in BasicTrainer:
loss = 6.237350727830615
INFO    [05-05 15:38:44] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [05-05 15:38:44] validate in BasicTrainer:
{'Recall@10': 0.05656652897596359, 'NDCG@10': 0.028472565283829517, 'MRR@10': 0.020015404136343437, 'Recall@5': 0.03417680446397175, 'NDCG@5': 0.021285466172478416, 'MRR@5': 0.017080338587137787, 'Recall*@10': 0.05656652897596359, 'NDCG*@10': 0.028472565283829517, 'MRR*@10': 0.020015404136343437, 'Recall*@5': 0.03417680446397175, 'NDCG*@5': 0.021285466172478416, 'MRR*@5': 0.017080338587137787}
INFO    [05-05 15:38:44] train in BasicTrainer:
duration: 27.91143798828125s
INFO    [05-05 15:38:44] train in BasicTrainer:
epoch: 31
INFO    [05-05 15:38:52] _train_one_epoch in BasicTrainer:
loss = 6.210013943059104
INFO    [05-05 15:39:11] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-05 15:39:11] validate in BasicTrainer:
{'Recall@10': 0.057825246317820114, 'NDCG@10': 0.028850424526767296, 'MRR@10': 0.020131049169735474, 'Recall@5': 0.03450400958007032, 'NDCG@5': 0.021368856287815353, 'MRR@5': 0.01707844918763096, 'Recall*@10': 0.057825246317820114, 'NDCG*@10': 0.028850424526767296, 'MRR*@10': 0.020131049169735474, 'Recall*@5': 0.03450400958007032, 'NDCG*@5': 0.021368856287815353, 'MRR*@5': 0.01707844918763096}
INFO    [05-05 15:39:11] train in BasicTrainer:
duration: 27.299262762069702s
INFO    [05-05 15:39:11] train in BasicTrainer:
epoch: 32
INFO    [05-05 15:39:20] _train_one_epoch in BasicTrainer:
loss = 6.183327291693006
INFO    [05-05 15:39:39] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-05 15:39:39] validate in BasicTrainer:
{'Recall@10': 0.0579977502877062, 'NDCG@10': 0.02946299212900075, 'MRR@10': 0.02086564322764223, 'Recall@5': 0.03503986752846024, 'NDCG@5': 0.022075367414138534, 'MRR@5': 0.0178384045985612, 'Recall*@10': 0.0579977502877062, 'NDCG*@10': 0.02946299212900075, 'MRR*@10': 0.02086564322764223, 'Recall*@5': 0.03503986752846024, 'NDCG*@5': 0.022075367414138534, 'MRR*@5': 0.0178384045985612}
INFO    [05-05 15:39:39] train in BasicTrainer:
duration: 28.267364025115967s
INFO    [05-05 15:39:39] train in BasicTrainer:
epoch: 33
INFO    [05-05 15:39:48] _train_one_epoch in BasicTrainer:
loss = 6.154398458344596
INFO    [05-05 15:40:07] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-05 15:40:07] validate in BasicTrainer:
{'Recall@10': 0.05899837240576744, 'NDCG@10': 0.02996134791861881, 'MRR@10': 0.02120028216053139, 'Recall@5': 0.03594984622164206, 'NDCG@5': 0.022539377043193035, 'MRR@5': 0.01815568113868887, 'Recall*@10': 0.05899837240576744, 'NDCG*@10': 0.02996134791861881, 'MRR*@10': 0.02120028216053139, 'Recall*@5': 0.03594984622164206, 'NDCG*@5': 0.022539377043193035, 'MRR*@5': 0.01815568113868887}
INFO    [05-05 15:40:07] train in BasicTrainer:
duration: 27.24497389793396s
INFO    [05-05 15:40:07] train in BasicTrainer:
epoch: 34
INFO    [05-05 15:40:15] _train_one_epoch in BasicTrainer:
loss = 6.128137103148869
INFO    [05-05 15:40:34] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-05 15:40:34] validate in BasicTrainer:
{'Recall@10': 0.06126474826173349, 'NDCG@10': 0.03102779168296944, 'MRR@10': 0.02191887101666494, 'Recall@5': 0.03710901838811961, 'NDCG@5': 0.023260102353312752, 'MRR@5': 0.018738676878538998, 'Recall*@10': 0.06126474826173349, 'NDCG*@10': 0.03102779168296944, 'MRR*@10': 0.02191887101666494, 'Recall*@5': 0.03710901838811961, 'NDCG*@5': 0.023260102353312752, 'MRR*@5': 0.018738676878538998}
INFO    [05-05 15:40:34] train in BasicTrainer:
duration: 27.7593092918396s
INFO    [05-05 15:40:34] train in BasicTrainer:
epoch: 35
DEBUG   [05-05 15:40:41] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 5997301
DEBUG   [05-05 15:40:41] calculate_loss in loss:
pred max in softmax: 0.9328033328056335, argmax 46870830
DEBUG   [05-05 15:40:41] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 27634021
DEBUG   [05-05 15:40:41] calculate_loss in loss:
pred max in softmax: 0.9612716436386108, argmax 68507106
INFO    [05-05 15:40:43] _train_one_epoch in BasicTrainer:
loss = 6.100930350167411
INFO    [05-05 15:41:02] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-05 15:41:02] validate in BasicTrainer:
{'Recall@10': 0.06039982018145648, 'NDCG@10': 0.031080930578437718, 'MRR@10': 0.022239117459817367, 'Recall@5': 0.03747555986046791, 'NDCG@5': 0.023712911219759422, 'MRR@5': 0.019224592061205345, 'Recall*@10': 0.06039982018145648, 'NDCG*@10': 0.031080930578437718, 'MRR*@10': 0.022239117459817367, 'Recall*@5': 0.03747555986046791, 'NDCG*@5': 0.023712911219759422, 'MRR*@5': 0.019224592061205345}
INFO    [05-05 15:41:02] train in BasicTrainer:
duration: 27.2166588306427s
INFO    [05-05 15:41:02] train in BasicTrainer:
epoch: 36
INFO    [05-05 15:41:10] _train_one_epoch in BasicTrainer:
loss = 6.075826781136649
INFO    [05-05 15:41:29] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-05 15:41:29] validate in BasicTrainer:
{'Recall@10': 0.061604042622176086, 'NDCG@10': 0.031829137693751945, 'MRR@10': 0.022847280583598396, 'Recall@5': 0.03835763003338467, 'NDCG@5': 0.024354700845750896, 'MRR@5': 0.019787865098227154, 'Recall*@10': 0.061604042622176086, 'NDCG*@10': 0.031829137693751945, 'MRR*@10': 0.022847280583598396, 'Recall*@5': 0.03835763003338467, 'NDCG*@5': 0.024354700845750896, 'MRR*@5': 0.019787865098227154}
INFO    [05-05 15:41:29] train in BasicTrainer:
duration: 27.772632837295532s
INFO    [05-05 15:41:29] train in BasicTrainer:
epoch: 37
INFO    [05-05 15:41:38] _train_one_epoch in BasicTrainer:
loss = 6.050263064248221
INFO    [05-05 15:41:56] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [05-05 15:41:57] validate in BasicTrainer:
{'Recall@10': 0.06258060512217609, 'NDCG@10': 0.032104237005114555, 'MRR@10': 0.02289803901856596, 'Recall@5': 0.03846036270260811, 'NDCG@5': 0.024336573921821335, 'MRR@5': 0.019711230966177853, 'Recall*@10': 0.06258060512217609, 'NDCG*@10': 0.032104237005114555, 'MRR*@10': 0.02289803901856596, 'Recall*@5': 0.03846036270260811, 'NDCG*@5': 0.024336573921821335, 'MRR*@5': 0.019711230966177853}
INFO    [05-05 15:41:57] train in BasicTrainer:
duration: 27.088749885559082s
INFO    [05-05 15:41:57] train in BasicTrainer:
epoch: 38
INFO    [05-05 15:42:05] _train_one_epoch in BasicTrainer:
loss = 6.022459481443677
INFO    [05-05 15:42:24] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-05 15:42:25] validate in BasicTrainer:
{'Recall@10': 0.06427431242032484, 'NDCG@10': 0.03362652676349336, 'MRR@10': 0.024359100752256134, 'Recall@5': 0.04031075503338467, 'NDCG@5': 0.025903098115866833, 'MRR@5': 0.021187400276010685, 'Recall*@10': 0.06427431242032484, 'NDCG*@10': 0.03362652676349336, 'MRR*@10': 0.024359100752256134, 'Recall*@5': 0.04031075503338467, 'NDCG*@5': 0.025903098115866833, 'MRR*@5': 0.021187400276010685}
INFO    [05-05 15:42:25] train in BasicTrainer:
duration: 28.311908721923828s
INFO    [05-05 15:42:25] train in BasicTrainer:
epoch: 39
INFO    [05-05 15:42:33] _train_one_epoch in BasicTrainer:
loss = 5.999958540712084
INFO    [05-05 15:42:52] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [05-05 15:42:52] validate in BasicTrainer:
{'Recall@10': 0.06478544968095692, 'NDCG@10': 0.03371512517333031, 'MRR@10': 0.024348808791149746, 'Recall@5': 0.04034624282609333, 'NDCG@5': 0.025878057222474705, 'MRR@5': 0.02115278233858672, 'Recall*@10': 0.06478544968095692, 'NDCG*@10': 0.03371512517333031, 'MRR*@10': 0.024348808791149746, 'Recall*@5': 0.04034624282609333, 'NDCG*@5': 0.025878057222474705, 'MRR*@5': 0.02115278233858672}
INFO    [05-05 15:42:52] train in BasicTrainer:
duration: 27.529539585113525s
INFO    [05-05 15:42:52] train in BasicTrainer:
epoch: 40
INFO    [05-05 15:43:01] _train_one_epoch in BasicTrainer:
loss = 5.977166388716016
INFO    [05-05 15:43:20] validate in BasicTrainer:
{'Recall@10': 0.06452988121997226, 'NDCG@10': 0.03369338031519543, 'MRR@10': 0.02440491234037009, 'Recall@5': 0.03969502008774064, 'NDCG@5': 0.025714186443523926, 'MRR@5': 0.02114254811947996, 'Recall*@10': 0.06452988121997226, 'NDCG*@10': 0.03369338031519543, 'MRR*@10': 0.02440491234037009, 'Recall*@5': 0.03969502008774064, 'NDCG*@5': 0.025714186443523926, 'MRR*@5': 0.02114254811947996}
INFO    [05-05 15:43:20] train in BasicTrainer:
duration: 27.759105920791626s
INFO    [05-05 15:43:20] train in BasicTrainer:
epoch: 41
INFO    [05-05 15:43:29] _train_one_epoch in BasicTrainer:
loss = 5.952123037406376
INFO    [05-05 15:43:47] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-05 15:43:48] validate in BasicTrainer:
{'Recall@10': 0.0650346428155899, 'NDCG@10': 0.034375895830717956, 'MRR@10': 0.025103441862897438, 'Recall@5': 0.041444544765082275, 'NDCG@5': 0.026774243197657845, 'MRR@5': 0.021982809698039837, 'Recall*@10': 0.0650346428155899, 'NDCG*@10': 0.034375895830717956, 'MRR*@10': 0.025103441862897438, 'Recall*@5': 0.041444544765082275, 'NDCG*@5': 0.026774243197657845, 'MRR*@5': 0.021982809698039837}
INFO    [05-05 15:43:48] train in BasicTrainer:
duration: 27.4295973777771s
INFO    [05-05 15:43:48] train in BasicTrainer:
epoch: 42
INFO    [05-05 15:43:56] _train_one_epoch in BasicTrainer:
loss = 5.9333018234797885
INFO    [05-05 15:44:15] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-05 15:44:15] validate in BasicTrainer:
{'Recall@10': 0.06590594656088135, 'NDCG@10': 0.0347501833669164, 'MRR@10': 0.025329901921478184, 'Recall@5': 0.041991169479760254, 'NDCG@5': 0.027045344933867455, 'MRR@5': 0.022166524082422256, 'Recall*@10': 0.06590594656088135, 'NDCG*@10': 0.0347501833669164, 'MRR*@10': 0.025329901921478184, 'Recall*@5': 0.041991169479760254, 'NDCG*@5': 0.027045344933867455, 'MRR*@5': 0.022166524082422256}
INFO    [05-05 15:44:15] train in BasicTrainer:
duration: 27.538054704666138s
INFO    [05-05 15:44:15] train in BasicTrainer:
epoch: 43
INFO    [05-05 15:44:23] _train_one_epoch in BasicTrainer:
loss = 5.906247445515224
INFO    [05-05 15:44:42] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [05-05 15:44:42] validate in BasicTrainer:
{'Recall@10': 0.06679878316142342, 'NDCG@10': 0.035552637482231315, 'MRR@10': 0.02613454752347686, 'Recall@5': 0.04163605584339662, 'NDCG@5': 0.02749017405916344, 'MRR@5': 0.022849896922707558, 'Recall*@10': 0.06679878316142342, 'NDCG*@10': 0.035552637482231315, 'MRR*@10': 0.02613454752347686, 'Recall*@5': 0.04163605584339662, 'NDCG*@5': 0.02749017405916344, 'MRR*@5': 0.022849896922707558}
INFO    [05-05 15:44:42] train in BasicTrainer:
duration: 27.004881858825684s
INFO    [05-05 15:44:42] train in BasicTrainer:
epoch: 44
INFO    [05-05 15:44:51] _train_one_epoch in BasicTrainer:
loss = 5.88540426322392
INFO    [05-05 15:45:10] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-05 15:45:10] validate in BasicTrainer:
{'Recall@10': 0.06642147492278706, 'NDCG@10': 0.03570487553423101, 'MRR@10': 0.026425985450094395, 'Recall@5': 0.04294740239327604, 'NDCG@5': 0.02818112566389821, 'MRR@5': 0.023360682820731945, 'Recall*@10': 0.06642147492278706, 'NDCG*@10': 0.03570487553423101, 'MRR*@10': 0.026425985450094395, 'Recall*@5': 0.04294740239327604, 'NDCG*@5': 0.02818112566389821, 'MRR*@5': 0.023360682820731945}
INFO    [05-05 15:45:10] train in BasicTrainer:
duration: 27.935067415237427s
INFO    [05-05 15:45:10] train in BasicTrainer:
epoch: 45
INFO    [05-05 15:45:18] _train_one_epoch in BasicTrainer:
loss = 5.863104590347835
INFO    [05-05 15:45:37] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-05 15:45:37] validate in BasicTrainer:
{'Recall@10': 0.0667594468051737, 'NDCG@10': 0.035814336416396225, 'MRR@10': 0.026440385898405857, 'Recall@5': 0.04326570609753782, 'NDCG@5': 0.028284596956589005, 'MRR@5': 0.02337302216752009, 'Recall*@10': 0.0667594468051737, 'NDCG*@10': 0.035814336416396225, 'MRR*@10': 0.026440385898405857, 'Recall*@5': 0.04326570609753782, 'NDCG*@5': 0.028284596956589005, 'MRR*@5': 0.02337302216752009}
INFO    [05-05 15:45:37] train in BasicTrainer:
duration: 27.19482421875s
INFO    [05-05 15:45:37] train in BasicTrainer:
epoch: 46
INFO    [05-05 15:45:46] _train_one_epoch in BasicTrainer:
loss = 5.839001638548715
INFO    [05-05 15:46:05] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-05 15:46:05] validate in BasicTrainer:
{'Recall@10': 0.06923194906928322, 'NDCG@10': 0.03713689371943474, 'MRR@10': 0.027451281012459236, 'Recall@5': 0.04401593113487417, 'NDCG@5': 0.029069328172640366, 'MRR@5': 0.02417218532751907, 'Recall*@10': 0.06923194906928322, 'NDCG*@10': 0.03713689371943474, 'MRR*@10': 0.027451281012459236, 'Recall*@5': 0.04401593113487417, 'NDCG*@5': 0.029069328172640366, 'MRR*@5': 0.02417218532751907}
INFO    [05-05 15:46:05] train in BasicTrainer:
duration: 27.590576648712158s
INFO    [05-05 15:46:05] train in BasicTrainer:
epoch: 47
INFO    [05-05 15:46:13] _train_one_epoch in BasicTrainer:
loss = 5.824085567678724
INFO    [05-05 15:46:32] log in loggers:
Update Best NDCG@10 Model at 47
INFO    [05-05 15:46:32] validate in BasicTrainer:
{'Recall@10': 0.06902582266113975, 'NDCG@10': 0.03719913349910216, 'MRR@10': 0.027575672350146553, 'Recall@5': 0.04469758847897703, 'NDCG@5': 0.029389008033004673, 'MRR@5': 0.02438629079948772, 'Recall*@10': 0.06902582266113975, 'NDCG*@10': 0.03719913349910216, 'MRR*@10': 0.027575672350146553, 'Recall*@5': 0.04469758847897703, 'NDCG*@5': 0.029389008033004673, 'MRR*@5': 0.02438629079948772}
INFO    [05-05 15:46:32] train in BasicTrainer:
duration: 27.44442057609558s
INFO    [05-05 15:46:32] train in BasicTrainer:
epoch: 48
INFO    [05-05 15:46:41] _train_one_epoch in BasicTrainer:
loss = 5.799437139715467
INFO    [05-05 15:47:00] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-05 15:47:00] validate in BasicTrainer:
{'Recall@10': 0.06983559443192049, 'NDCG@10': 0.0377752658995715, 'MRR@10': 0.02806338481605053, 'Recall@5': 0.04556383937597275, 'NDCG@5': 0.029980941590937702, 'MRR@5': 0.02487899058244445, 'Recall*@10': 0.06983559443192049, 'NDCG*@10': 0.0377752658995715, 'MRR*@10': 0.02806338481605053, 'Recall*@5': 0.04556383937597275, 'NDCG*@5': 0.029980941590937702, 'MRR*@5': 0.02487899058244445}
INFO    [05-05 15:47:00] train in BasicTrainer:
duration: 27.576708793640137s
INFO    [05-05 15:47:00] train in BasicTrainer:
epoch: 49
INFO    [05-05 15:47:09] _train_one_epoch in BasicTrainer:
loss = 5.782583722046444
INFO    [05-05 15:47:28] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-05 15:47:28] validate in BasicTrainer:
{'Recall@10': 0.07048176432197745, 'NDCG@10': 0.038621960377151314, 'MRR@10': 0.028977246447042984, 'Recall@5': 0.046161770820617676, 'NDCG@5': 0.03082808835262602, 'MRR@5': 0.025801556862213394, 'Recall*@10': 0.07048176432197745, 'NDCG*@10': 0.038621960377151314, 'MRR*@10': 0.028977246447042984, 'Recall*@5': 0.046161770820617676, 'NDCG*@5': 0.03082808835262602, 'MRR*@5': 0.025801556862213394}
INFO    [05-05 15:47:28] train in BasicTrainer:
duration: 27.829821825027466s
INFO    [05-05 15:47:28] train in BasicTrainer:
epoch: 50
INFO    [05-05 15:47:36] _train_one_epoch in BasicTrainer:
loss = 5.760727618421827
INFO    [05-05 15:47:55] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-05 15:47:55] validate in BasicTrainer:
{'Recall@10': 0.07017356631430713, 'NDCG@10': 0.03874140266667713, 'MRR@10': 0.02922045879743316, 'Recall@5': 0.04649216343056072, 'NDCG@5': 0.031119951978325844, 'MRR@5': 0.026096761565316807, 'Recall*@10': 0.07017356631430713, 'NDCG*@10': 0.03874140266667713, 'MRR*@10': 0.02922045879743316, 'Recall*@5': 0.04649216343056072, 'NDCG*@5': 0.031119951978325844, 'MRR*@5': 0.026096761565316807}
INFO    [05-05 15:47:55] train in BasicTrainer:
duration: 27.629270315170288s
INFO    [05-05 15:47:55] train in BasicTrainer:
epoch: 51
INFO    [05-05 15:48:04] _train_one_epoch in BasicTrainer:
loss = 5.741358186517443
INFO    [05-05 15:48:23] validate in BasicTrainer:
{'Recall@10': 0.07067008790644733, 'NDCG@10': 0.038714034990830856, 'MRR@10': 0.029024881903420795, 'Recall@5': 0.04637042399157177, 'NDCG@5': 0.030910726128654045, 'MRR@5': 0.025836581364274025, 'Recall*@10': 0.07067008790644733, 'NDCG*@10': 0.038714034990830856, 'MRR*@10': 0.029024881903420795, 'Recall*@5': 0.04637042399157177, 'NDCG*@5': 0.030910726128654045, 'MRR*@5': 0.025836581364274025}
INFO    [05-05 15:48:23] train in BasicTrainer:
duration: 27.486295461654663s
INFO    [05-05 15:48:23] train in BasicTrainer:
epoch: 52
INFO    [05-05 15:48:32] _train_one_epoch in BasicTrainer:
loss = 5.725118006978716
INFO    [05-05 15:48:51] log in loggers:
Update Best NDCG@10 Model at 52
INFO    [05-05 15:48:51] validate in BasicTrainer:
{'Recall@10': 0.07202901149337942, 'NDCG@10': 0.039681241254914894, 'MRR@10': 0.029850433326580307, 'Recall@5': 0.048510549759322945, 'NDCG@5': 0.03211356276138262, 'MRR@5': 0.026749164712699978, 'Recall*@10': 0.07202901149337942, 'NDCG*@10': 0.039681241254914894, 'MRR*@10': 0.029850433326580307, 'Recall*@5': 0.048510549759322945, 'NDCG*@5': 0.03211356276138262, 'MRR*@5': 0.026749164712699978}
INFO    [05-05 15:48:51] train in BasicTrainer:
duration: 28.414987802505493s
INFO    [05-05 15:48:51] train in BasicTrainer:
epoch: 53
DEBUG   [05-05 15:48:56] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 6798661
DEBUG   [05-05 15:48:56] calculate_loss in loss:
pred max in softmax: 0.9403465986251831, argmax 21937673
DEBUG   [05-05 15:48:56] calculate_loss in loss:
soft_target max: 0.6836225390434265, argmax 2511385
DEBUG   [05-05 15:48:56] calculate_loss in loss:
pred max in softmax: 0.9195632338523865, argmax 54826557
INFO    [05-05 15:49:00] _train_one_epoch in BasicTrainer:
loss = 5.702563549791064
INFO    [05-05 15:49:18] log in loggers:
Update Best NDCG@10 Model at 53
INFO    [05-05 15:49:18] validate in BasicTrainer:
{'Recall@10': 0.07199605012481863, 'NDCG@10': 0.04003673148426143, 'MRR@10': 0.03034067763523622, 'Recall@5': 0.048012163151394234, 'NDCG@5': 0.0323417836969549, 'MRR@5': 0.027200629426674408, 'Recall*@10': 0.07199605012481863, 'NDCG*@10': 0.04003673148426143, 'MRR*@10': 0.03034067763523622, 'Recall*@5': 0.048012163151394234, 'NDCG*@5': 0.0323417836969549, 'MRR*@5': 0.027200629426674408}
INFO    [05-05 15:49:18] train in BasicTrainer:
duration: 27.21436858177185s
INFO    [05-05 15:49:18] train in BasicTrainer:
epoch: 54
INFO    [05-05 15:49:27] _train_one_epoch in BasicTrainer:
loss = 5.6862921714782715
INFO    [05-05 15:49:47] log in loggers:
Update Best NDCG@10 Model at 54
INFO    [05-05 15:49:47] validate in BasicTrainer:
{'Recall@10': 0.07298085296695883, 'NDCG@10': 0.0405895354395563, 'MRR@10': 0.030773388560522686, 'Recall@5': 0.04871162365783344, 'NDCG@5': 0.03281733427535404, 'MRR@5': 0.027610170908949593, 'Recall*@10': 0.07298085296695883, 'NDCG*@10': 0.0405895354395563, 'MRR*@10': 0.030773388560522686, 'Recall*@5': 0.04871162365783344, 'NDCG*@5': 0.03281733427535404, 'MRR*@5': 0.027610170908949593}
INFO    [05-05 15:49:47] train in BasicTrainer:
duration: 28.272807359695435s
INFO    [05-05 15:49:47] train in BasicTrainer:
epoch: 55
INFO    [05-05 15:49:55] _train_one_epoch in BasicTrainer:
loss = 5.667083382606506
INFO    [05-05 15:50:14] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [05-05 15:50:14] validate in BasicTrainer:
{'Recall@10': 0.07324971461837942, 'NDCG@10': 0.04108080200173638, 'MRR@10': 0.031324377791448074, 'Recall@5': 0.049035641280087555, 'NDCG@5': 0.033296126533638344, 'MRR@5': 0.028137971901080826, 'Recall*@10': 0.07324971461837942, 'NDCG*@10': 0.04108080200173638, 'MRR*@10': 0.031324377791448074, 'Recall*@5': 0.049035641280087555, 'NDCG*@5': 0.033296126533638344, 'MRR*@5': 0.028137971901080826}
INFO    [05-05 15:50:14] train in BasicTrainer:
duration: 27.463807582855225s
INFO    [05-05 15:50:14] train in BasicTrainer:
epoch: 56
INFO    [05-05 15:50:23] _train_one_epoch in BasicTrainer:
loss = 5.649326401097434
INFO    [05-05 15:50:42] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-05 15:50:43] validate in BasicTrainer:
{'Recall@10': 0.07317741689356891, 'NDCG@10': 0.041199581189589066, 'MRR@10': 0.03148549608886242, 'Recall@5': 0.049487773667682304, 'NDCG@5': 0.03359304317696528, 'MRR@5': 0.028378193351355465, 'Recall*@10': 0.07317741689356891, 'NDCG*@10': 0.041199581189589066, 'MRR*@10': 0.03148549608886242, 'Recall*@5': 0.049487773667682304, 'NDCG*@5': 0.03359304317696528, 'MRR*@5': 0.028378193351355465}
INFO    [05-05 15:50:43] train in BasicTrainer:
duration: 28.377842664718628s
INFO    [05-05 15:50:43] train in BasicTrainer:
epoch: 57
INFO    [05-05 15:50:51] _train_one_epoch in BasicTrainer:
loss = 5.63591023002352
INFO    [05-05 15:51:10] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-05 15:51:10] validate in BasicTrainer:
{'Recall@10': 0.07408739558675072, 'NDCG@10': 0.042228632352568886, 'MRR@10': 0.03253570300611583, 'Recall@5': 0.050344461405819114, 'NDCG@5': 0.034562279216267845, 'MRR@5': 0.029378492893143135, 'Recall*@10': 0.07408739558675072, 'NDCG*@10': 0.042228632352568886, 'MRR*@10': 0.03253570300611583, 'Recall*@5': 0.050344461405819114, 'NDCG*@5': 0.034562279216267845, 'MRR*@5': 0.029378492893143135}
INFO    [05-05 15:51:10] train in BasicTrainer:
duration: 27.598408937454224s
INFO    [05-05 15:51:10] train in BasicTrainer:
epoch: 58
INFO    [05-05 15:51:19] _train_one_epoch in BasicTrainer:
loss = 5.619210762637002
INFO    [05-05 15:51:39] validate in BasicTrainer:
{'Recall@10': 0.07486739416014064, 'NDCG@10': 0.04213453084230423, 'MRR@10': 0.03220589950003407, 'Recall@5': 0.05039841343056072, 'NDCG@5': 0.03427872434258461, 'MRR@5': 0.028996565463868054, 'Recall*@10': 0.07486739416014064, 'NDCG*@10': 0.04213453084230423, 'MRR*@10': 0.03220589950003407, 'Recall*@5': 0.05039841343056072, 'NDCG*@5': 0.03427872434258461, 'MRR*@5': 0.028996565463868054}
INFO    [05-05 15:51:39] train in BasicTrainer:
duration: 28.42474365234375s
INFO    [05-05 15:51:39] train in BasicTrainer:
epoch: 59
INFO    [05-05 15:51:48] _train_one_epoch in BasicTrainer:
loss = 5.601808377674648
INFO    [05-05 15:52:07] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [05-05 15:52:07] validate in BasicTrainer:
{'Recall@10': 0.0751394433054057, 'NDCG@10': 0.04261981526559049, 'MRR@10': 0.03272740068760785, 'Recall@5': 0.05137244984507561, 'NDCG@5': 0.034974184056574646, 'MRR@5': 0.029595299369909546, 'Recall*@10': 0.0751394433054057, 'NDCG*@10': 0.04261981526559049, 'MRR*@10': 0.03272740068760785, 'Recall*@5': 0.05137244984507561, 'NDCG*@5': 0.034974184056574646, 'MRR*@5': 0.029595299369909546}
INFO    [05-05 15:52:07] train in BasicTrainer:
duration: 28.099067449569702s
INFO    [05-05 15:52:07] close_training in BasicTrainer:
finished training
DEBUG   [05-05 15:52:07] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3361 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-05 15:52:07] run_routine in Routine:
Finished training, Start final validation
INFO    [05-05 15:52:07] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-05 15:52:07] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 15:52:07] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 15:52:26] validate in BasicTrainer:
{'Recall@10': 0.0751394433054057, 'NDCG@10': 0.04261981526559049, 'MRR@10': 0.03272740068760785, 'Recall@5': 0.05137244984507561, 'NDCG@5': 0.034974184056574646, 'MRR@5': 0.029595299369909546, 'Recall*@10': 0.0751394433054057, 'NDCG*@10': 0.04261981526559049, 'MRR*@10': 0.03272740068760785, 'Recall*@5': 0.05137244984507561, 'NDCG*@5': 0.034974184056574646, 'MRR*@5': 0.029595299369909546}
INFO    [05-05 15:52:26] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.0751394433054057, 'NDCG@10': 0.04261981526559049, 'MRR@10': 0.03272740068760785, 'Recall@5': 0.05137244984507561, 'NDCG@5': 0.034974184056574646, 'MRR@5': 0.029595299369909546, 'Recall*@10': 0.0751394433054057, 'NDCG*@10': 0.04261981526559049, 'MRR*@10': 0.03272740068760785, 'Recall*@5': 0.05137244984507561, 'NDCG*@5': 0.034974184056574646, 'MRR*@5': 0.029595299369909546}
INFO    [05-05 15:52:26] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-05 15:52:26] test in BasicTrainer:
Test model on test set!
INFO    [05-05 15:52:26] test_with_given_state_path in BasicTrainer:
Loading model params from ___yelp_soft_2022/pop_narm-T-1.0-al-0.25_05-05_15:23_t1/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-05 15:52:26] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 15:52:26] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 15:52:26] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-05 15:52:45] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.06137626347216693, 'NDCG@10': 0.03314737755466591, 'MRR@10': 0.02459041029214859, 'Recall@5': 0.040422270582480865, 'NDCG@5': 0.02644258077171716, 'MRR@5': 0.021864480592987755, 'Recall*@10': 0.06137626347216693, 'NDCG*@10': 0.03314737755466591, 'MRR*@10': 0.02459041029214859, 'Recall*@5': 0.040422270582480865, 'NDCG*@5': 0.02644258077171716, 'MRR*@5': 0.021864480592987755}
INFO    [05-05 15:52:45] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.06137626347216693, 'NDCG@10': 0.03314737755466591, 'MRR@10': 0.02459041029214859, 'Recall@5': 0.040422270582480865, 'NDCG@5': 0.02644258077171716, 'MRR@5': 0.021864480592987755, 'Recall*@10': 0.06137626347216693, 'NDCG*@10': 0.03314737755466591, 'MRR*@10': 0.02459041029214859, 'Recall*@5': 0.040422270582480865, 'NDCG*@5': 0.02644258077171716, 'MRR*@5': 0.021864480592987755}
