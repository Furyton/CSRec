INFO    [05-05 17:40:18] setup_train in utils:
{
    "experiment_dir": "___yelp_soft_2022",
    "experiment_description": "pop",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "yelp.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "alpha": 0.75,
    "T": 6.0,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.yelp/narm/config_distill.json",
    "task_id": 9,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "dvae_alpha": 0.5,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-05 17:40:18] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-05 17:40:18] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/yelp-5-5.pkl
INFO    [05-05 17:40:19] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-05 17:40:19] _check_dataset_cache in utils:
correct.
INFO    [05-05 17:40:19] __init__ in NextItemDataloader:
there are 20033 items in this dataset, 43947 users, padding_first? False
DEBUG   [05-05 17:40:25] generate_model in utils:
model_code_list=['pop']
INFO    [05-05 17:40:25] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-05 17:40:25] load_model_config in utils:
{}
WARNING [05-05 17:40:32] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.75_05-05_17:40_t9/teacher_pop_logs does not exist! Create one.
WARNING [05-05 17:40:32] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.75_05-05_17:40_t9/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-05 17:40:32] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.75_05-05_17:40_t9/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-05 17:40:32] get_path in utils:
Path is None
WARNING [05-05 17:40:32] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 17:40:32] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-05 17:40:32] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 17:40:32] __init__ in BasicTrainer:
229376 iter per epoch
DEBUG   [05-05 17:40:32] generate_model in utils:
model_code_list=['narm']
INFO    [05-05 17:40:32] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-05 17:40:32] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-05 17:40:34] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.75_05-05_17:40_t9/student_narm_logs does not exist! Create one.
WARNING [05-05 17:40:34] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.75_05-05_17:40_t9/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-05 17:40:34] get_exist_path in utils:
dir ___yelp_soft_2022/pop_narm-T-6.0-al-0.75_05-05_17:40_t9/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-05 17:40:34] get_path in utils:
Path is None
WARNING [05-05 17:40:34] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-05 17:40:34] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(20034, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-05 17:40:34] assert_model_device in utils:
model student_narm has 5.3603515625 MB params.
INFO    [05-05 17:40:34] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-05 17:40:34] __init__ in DistillTrainer:
229376 iter per epoch
INFO    [05-05 17:40:34] _set_current_routine in Routine:
first routine: student
INFO    [05-05 17:40:34] run_routine in Routine:
Start routine student
INFO    [05-05 17:40:34] run_routine in Routine:
Start training
INFO    [05-05 17:40:34] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-05 17:40:53] test_mentor in DistillTrainer:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 17:40:53] train in DistillTrainer:
result:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-05 17:41:12] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 17:41:12] validate in BasicTrainer:
{'Recall@10': 0.00044389204545454544, 'NDCG@10': 0.0002111054676457901, 'MRR@10': 0.0001419221515044972, 'Recall@5': 0.0003107244318181818, 'NDCG@5': 0.0001693654326531528, 'MRR@5': 0.00012539950462682597, 'Recall*@10': 0.00044389204545454544, 'NDCG*@10': 0.0002111054676457901, 'MRR*@10': 0.0001419221515044972, 'Recall*@5': 0.0003107244318181818, 'NDCG*@5': 0.0001693654326531528, 'MRR*@5': 0.00012539950462682597}
INFO    [05-05 17:41:12] train in BasicTrainer:
epoch: 0
DEBUG   [05-05 17:41:13] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 9282877
DEBUG   [05-05 17:41:13] calculate_loss in loss:
pred max in softmax: 5.0027036195388064e-05, argmax 67393260
INFO    [05-05 17:41:25] _train_one_epoch in BasicTrainer:
loss = 5.6661984494754245
INFO    [05-05 17:41:43] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-05 17:41:43] validate in BasicTrainer:
{'Recall@10': 0.008453498255800117, 'NDCG@10': 0.004358068383722143, 'MRR@10': 0.0031534066974100742, 'Recall@5': 0.004407162947410887, 'NDCG@5': 0.0030769403515891595, 'MRR@5': 0.0026409375290809708, 'Recall*@10': 0.008453498255800117, 'NDCG*@10': 0.004358068383722143, 'MRR*@10': 0.0031534066974100742, 'Recall*@5': 0.004407162947410887, 'NDCG*@5': 0.0030769403515891595, 'MRR*@5': 0.0026409375290809708}
INFO    [05-05 17:41:43] train in BasicTrainer:
duration: 31.158939361572266s
INFO    [05-05 17:41:43] train in BasicTrainer:
epoch: 1
INFO    [05-05 17:41:56] _train_one_epoch in BasicTrainer:
loss = 5.439160466194153
INFO    [05-05 17:42:15] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-05 17:42:15] validate in BasicTrainer:
{'Recall@10': 0.017915977842428467, 'NDCG@10': 0.008888810026374731, 'MRR@10': 0.006190608086233789, 'Recall@5': 0.010282357223331928, 'NDCG@5': 0.006451345810836012, 'MRR@5': 0.0052023261192847385, 'Recall*@10': 0.017915977842428467, 'NDCG*@10': 0.008888810026374731, 'MRR*@10': 0.006190608086233789, 'Recall*@5': 0.010282357223331928, 'NDCG*@5': 0.006451345810836012, 'MRR*@5': 0.0052023261192847385}
INFO    [05-05 17:42:15] train in BasicTrainer:
duration: 31.755403757095337s
INFO    [05-05 17:42:15] train in BasicTrainer:
epoch: 2
INFO    [05-05 17:42:29] _train_one_epoch in BasicTrainer:
loss = 5.203890936715262
INFO    [05-05 17:42:48] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-05 17:42:48] validate in BasicTrainer:
{'Recall@10': 0.024495024234056473, 'NDCG@10': 0.012206634506583214, 'MRR@10': 0.008547966791824861, 'Recall@5': 0.01386579354716973, 'NDCG@5': 0.008819949178194458, 'MRR@5': 0.0071791247253052215, 'Recall*@10': 0.024495024234056473, 'NDCG*@10': 0.012206634506583214, 'MRR*@10': 0.008547966791824861, 'Recall*@5': 0.01386579354716973, 'NDCG*@5': 0.008819949178194458, 'MRR*@5': 0.0071791247253052215}
INFO    [05-05 17:42:48] train in BasicTrainer:
duration: 32.6607232093811s
INFO    [05-05 17:42:48] train in BasicTrainer:
epoch: 3
INFO    [05-05 17:43:02] _train_one_epoch in BasicTrainer:
loss = 5.093356456075396
INFO    [05-05 17:43:21] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-05 17:43:21] validate in BasicTrainer:
{'Recall@10': 0.030480530112981796, 'NDCG@10': 0.015121425925330683, 'MRR@10': 0.010533514178612015, 'Recall@5': 0.01714169310236519, 'NDCG@5': 0.010830209336497566, 'MRR@5': 0.008775172374126587, 'Recall*@10': 0.030480530112981796, 'NDCG*@10': 0.015121425925330683, 'MRR*@10': 0.010533514178612015, 'Recall*@5': 0.01714169310236519, 'NDCG*@5': 0.010830209336497566, 'MRR*@5': 0.008775172374126587}
INFO    [05-05 17:43:21] train in BasicTrainer:
duration: 33.19972491264343s
INFO    [05-05 17:43:21] train in BasicTrainer:
epoch: 4
INFO    [05-05 17:43:35] _train_one_epoch in BasicTrainer:
loss = 5.015347966126034
INFO    [05-05 17:43:53] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-05 17:43:53] validate in BasicTrainer:
{'Recall@10': 0.03511216559193351, 'NDCG@10': 0.0174333191561428, 'MRR@10': 0.012164716693488035, 'Recall@5': 0.01947717893530022, 'NDCG@5': 0.01240069842474027, 'MRR@5': 0.010100892067632893, 'Recall*@10': 0.03511216559193351, 'NDCG*@10': 0.0174333191561428, 'MRR*@10': 0.012164716693488035, 'Recall*@5': 0.01947717893530022, 'NDCG*@5': 0.01240069842474027, 'MRR*@5': 0.010100892067632893}
INFO    [05-05 17:43:53] train in BasicTrainer:
duration: 32.115802526474s
INFO    [05-05 17:43:53] train in BasicTrainer:
epoch: 5
INFO    [05-05 17:44:06] _train_one_epoch in BasicTrainer:
loss = 4.946968248912266
INFO    [05-05 17:44:25] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-05 17:44:26] validate in BasicTrainer:
{'Recall@10': 0.039061481979760254, 'NDCG@10': 0.01981210607019338, 'MRR@10': 0.01405086283656684, 'Recall@5': 0.02297755093737082, 'NDCG@5': 0.014662356962534514, 'MRR@5': 0.011955148117108778, 'Recall*@10': 0.039061481979760254, 'NDCG*@10': 0.01981210607019338, 'MRR*@10': 0.01405086283656684, 'Recall*@5': 0.02297755093737082, 'NDCG*@5': 0.014662356962534514, 'MRR*@5': 0.011955148117108778}
INFO    [05-05 17:44:26] train in BasicTrainer:
duration: 32.39651417732239s
INFO    [05-05 17:44:26] train in BasicTrainer:
epoch: 6
INFO    [05-05 17:44:38] _train_one_epoch in BasicTrainer:
loss = 4.8943774444716315
INFO    [05-05 17:44:57] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-05 17:44:57] validate in BasicTrainer:
{'Recall@10': 0.04194996810772202, 'NDCG@10': 0.02124048312279311, 'MRR@10': 0.015021834607151422, 'Recall@5': 0.02503912252458659, 'NDCG@5': 0.015813158063048668, 'MRR@5': 0.012805618430403147, 'Recall*@10': 0.04194996810772202, 'NDCG*@10': 0.02124048312279311, 'MRR*@10': 0.015021834607151422, 'Recall*@5': 0.02503912252458659, 'NDCG*@5': 0.015813158063048668, 'MRR*@5': 0.012805618430403147}
INFO    [05-05 17:44:57] train in BasicTrainer:
duration: 31.16752338409424s
INFO    [05-05 17:44:57] train in BasicTrainer:
epoch: 7
INFO    [05-05 17:45:09] _train_one_epoch in BasicTrainer:
loss = 4.847190388611385
INFO    [05-05 17:45:28] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-05 17:45:29] validate in BasicTrainer:
{'Recall@10': 0.04489481347528371, 'NDCG@10': 0.023008299483494324, 'MRR@10': 0.016452145593410187, 'Recall@5': 0.026694154874844986, 'NDCG@5': 0.0171875845302235, 'MRR@5': 0.014088206924498081, 'Recall*@10': 0.04489481347528371, 'NDCG*@10': 0.023008299483494324, 'MRR*@10': 0.016452145593410187, 'Recall*@5': 0.026694154874844986, 'NDCG*@5': 0.0171875845302235, 'MRR*@5': 0.014088206924498081}
INFO    [05-05 17:45:29] train in BasicTrainer:
duration: 31.84107804298401s
INFO    [05-05 17:45:29] train in BasicTrainer:
epoch: 8
INFO    [05-05 17:45:42] _train_one_epoch in BasicTrainer:
loss = 4.804012392248426
INFO    [05-05 17:46:00] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-05 17:46:00] validate in BasicTrainer:
{'Recall@10': 0.0469430922107263, 'NDCG@10': 0.024451582438566467, 'MRR@10': 0.017698975195261566, 'Recall@5': 0.028569268062710762, 'NDCG@5': 0.018570868637074123, 'MRR@5': 0.015307452783665874, 'Recall*@10': 0.0469430922107263, 'NDCG*@10': 0.024451582438566467, 'MRR*@10': 0.017698975195261566, 'Recall*@5': 0.028569268062710762, 'NDCG*@5': 0.018570868637074123, 'MRR*@5': 0.015307452783665874}
INFO    [05-05 17:46:00] train in BasicTrainer:
duration: 31.73299789428711s
INFO    [05-05 17:46:00] train in BasicTrainer:
epoch: 9
INFO    [05-05 17:46:13] _train_one_epoch in BasicTrainer:
loss = 4.765485337802342
INFO    [05-05 17:46:32] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-05 17:46:33] validate in BasicTrainer:
{'Recall@10': 0.04901092025366696, 'NDCG@10': 0.025460321625525303, 'MRR@10': 0.018391622230410576, 'Recall@5': 0.029673284258354794, 'NDCG@5': 0.019253543154759842, 'MRR@5': 0.01585687773132866, 'Recall*@10': 0.04901092025366696, 'NDCG*@10': 0.025460321625525303, 'MRR*@10': 0.018391622230410576, 'Recall*@5': 0.029673284258354794, 'NDCG*@5': 0.019253543154759842, 'MRR*@5': 0.01585687773132866}
INFO    [05-05 17:46:33] train in BasicTrainer:
duration: 32.29304528236389s
INFO    [05-05 17:46:33] train in BasicTrainer:
epoch: 10
INFO    [05-05 17:46:46] _train_one_epoch in BasicTrainer:
loss = 4.729559413024357
INFO    [05-05 17:47:05] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-05 17:47:05] validate in BasicTrainer:
{'Recall@10': 0.05089174752885645, 'NDCG@10': 0.02656104415655136, 'MRR@10': 0.01925061439925974, 'Recall@5': 0.031031546267596157, 'NDCG@5': 0.020181157372214577, 'MRR@5': 0.01664240336553617, 'Recall*@10': 0.05089174752885645, 'NDCG*@10': 0.02656104415655136, 'MRR*@10': 0.01925061439925974, 'Recall*@5': 0.031031546267596157, 'NDCG*@5': 0.020181157372214577, 'MRR*@5': 0.01664240336553617}
INFO    [05-05 17:47:05] train in BasicTrainer:
duration: 32.15512180328369s
INFO    [05-05 17:47:05] train in BasicTrainer:
epoch: 11
INFO    [05-05 17:47:17] _train_one_epoch in BasicTrainer:
loss = 4.694959214755467
INFO    [05-05 17:47:36] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-05 17:47:37] validate in BasicTrainer:
{'Recall@10': 0.05373704805970192, 'NDCG@10': 0.028345808217471295, 'MRR@10': 0.020725671709938484, 'Recall@5': 0.03265175223350525, 'NDCG@5': 0.021596896546808155, 'MRR@5': 0.017981339246034622, 'Recall*@10': 0.05373704805970192, 'NDCG*@10': 0.028345808217471295, 'MRR*@10': 0.020725671709938484, 'Recall*@5': 0.03265175223350525, 'NDCG*@5': 0.021596896546808155, 'MRR*@5': 0.017981339246034622}
INFO    [05-05 17:47:37] train in BasicTrainer:
duration: 31.901175260543823s
INFO    [05-05 17:47:37] train in BasicTrainer:
epoch: 12
INFO    [05-05 17:47:49] _train_one_epoch in BasicTrainer:
loss = 4.6610327788761685
INFO    [05-05 17:48:08] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-05 17:48:08] validate in BasicTrainer:
{'Recall@10': 0.05582773211327466, 'NDCG@10': 0.02964188192378391, 'MRR@10': 0.02179908227514137, 'Recall@5': 0.03369995138861916, 'NDCG@5': 0.022548135708678852, 'MRR@5': 0.01890756291421977, 'Recall*@10': 0.05582773211327466, 'NDCG*@10': 0.02964188192378391, 'MRR*@10': 0.02179908227514137, 'Recall*@5': 0.03369995138861916, 'NDCG*@5': 0.022548135708678852, 'MRR*@5': 0.01890756291421977}
INFO    [05-05 17:48:08] train in BasicTrainer:
duration: 31.436328172683716s
INFO    [05-05 17:48:08] train in BasicTrainer:
epoch: 13
INFO    [05-05 17:48:22] _train_one_epoch in BasicTrainer:
loss = 4.627223287309919
INFO    [05-05 17:48:41] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-05 17:48:41] validate in BasicTrainer:
{'Recall@10': 0.05761659314686602, 'NDCG@10': 0.030747001821344547, 'MRR@10': 0.0226697830313986, 'Recall@5': 0.03562769395383922, 'NDCG@5': 0.023693647066300564, 'MRR@5': 0.01979255744002082, 'Recall*@10': 0.05761659314686602, 'NDCG*@10': 0.030747001821344547, 'MRR*@10': 0.0226697830313986, 'Recall*@5': 0.03562769395383922, 'NDCG*@5': 0.023693647066300564, 'MRR*@5': 0.01979255744002082}
INFO    [05-05 17:48:41] train in BasicTrainer:
duration: 32.84064078330994s
INFO    [05-05 17:48:41] train in BasicTrainer:
epoch: 14
INFO    [05-05 17:48:54] _train_one_epoch in BasicTrainer:
loss = 4.594330413000924
INFO    [05-05 17:49:13] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-05 17:49:13] validate in BasicTrainer:
{'Recall@10': 0.060240608724680816, 'NDCG@10': 0.03249543532729149, 'MRR@10': 0.0241201597858559, 'Recall@5': 0.03800185498866168, 'NDCG@5': 0.025352737612345, 'MRR@5': 0.02120056985454126, 'Recall*@10': 0.060240608724680816, 'NDCG*@10': 0.03249543532729149, 'MRR*@10': 0.0241201597858559, 'Recall*@5': 0.03800185498866168, 'NDCG*@5': 0.025352737612345, 'MRR*@5': 0.02120056985454126}
INFO    [05-05 17:49:13] train in BasicTrainer:
duration: 32.160117387771606s
INFO    [05-05 17:49:13] train in BasicTrainer:
epoch: 15
INFO    [05-05 17:49:26] _train_one_epoch in BasicTrainer:
loss = 4.563138782978058
INFO    [05-05 17:49:45] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-05 17:49:45] validate in BasicTrainer:
{'Recall@10': 0.06126408685337414, 'NDCG@10': 0.0331248783252456, 'MRR@10': 0.02464443174275485, 'Recall@5': 0.0385452922094952, 'NDCG@5': 0.025831971486861057, 'MRR@5': 0.021665665744380516, 'Recall*@10': 0.06126408685337414, 'NDCG*@10': 0.0331248783252456, 'MRR*@10': 0.02464443174275485, 'Recall*@5': 0.0385452922094952, 'NDCG*@5': 0.025831971486861057, 'MRR*@5': 0.021665665744380516}
INFO    [05-05 17:49:45] train in BasicTrainer:
duration: 32.18304920196533s
INFO    [05-05 17:49:45] train in BasicTrainer:
epoch: 16
INFO    [05-05 17:49:59] _train_one_epoch in BasicTrainer:
loss = 4.533697545528412
INFO    [05-05 17:50:17] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-05 17:50:17] validate in BasicTrainer:
{'Recall@10': 0.06391919878396121, 'NDCG@10': 0.03459002450108528, 'MRR@10': 0.02575441940941594, 'Recall@5': 0.04038106887177988, 'NDCG@5': 0.02701948413794691, 'MRR@5': 0.022654570977796207, 'Recall*@10': 0.06391919878396121, 'NDCG*@10': 0.03459002450108528, 'MRR*@10': 0.02575441940941594, 'Recall*@5': 0.04038106887177988, 'NDCG*@5': 0.02701948413794691, 'MRR*@5': 0.022654570977796207}
INFO    [05-05 17:50:17] train in BasicTrainer:
duration: 31.732970476150513s
INFO    [05-05 17:50:17] train in BasicTrainer:
epoch: 17
DEBUG   [05-05 17:50:29] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 1109005
DEBUG   [05-05 17:50:29] calculate_loss in loss:
pred max in softmax: 0.8784975409507751, argmax 42084504
DEBUG   [05-05 17:50:29] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 5496451
DEBUG   [05-05 17:50:29] calculate_loss in loss:
pred max in softmax: 0.737045168876648, argmax 54813108
INFO    [05-05 17:50:30] _train_one_epoch in BasicTrainer:
loss = 4.504099811826434
INFO    [05-05 17:50:49] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-05 17:50:49] validate in BasicTrainer:
{'Recall@10': 0.06471501697193492, 'NDCG@10': 0.03576673059300943, 'MRR@10': 0.027031143619255585, 'Recall@5': 0.04184338653629476, 'NDCG@5': 0.02844579416242513, 'MRR@5': 0.024053698066960682, 'Recall*@10': 0.06471501697193492, 'NDCG*@10': 0.03576673059300943, 'MRR*@10': 0.027031143619255585, 'Recall*@5': 0.04184338653629476, 'NDCG*@5': 0.02844579416242513, 'MRR*@5': 0.024053698066960682}
INFO    [05-05 17:50:49] train in BasicTrainer:
duration: 32.45136904716492s
INFO    [05-05 17:50:49] train in BasicTrainer:
epoch: 18
INFO    [05-05 17:51:03] _train_one_epoch in BasicTrainer:
loss = 4.477235725947788
INFO    [05-05 17:51:21] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-05 17:51:22] validate in BasicTrainer:
{'Recall@10': 0.0665235465223139, 'NDCG@10': 0.03630072352561084, 'MRR@10': 0.027214381843805313, 'Recall@5': 0.04273688454519619, 'NDCG@5': 0.028686912222342056, 'MRR@5': 0.024117701771584423, 'Recall*@10': 0.0665235465223139, 'NDCG*@10': 0.03630072352561084, 'MRR*@10': 0.027214381843805313, 'Recall*@5': 0.04273688454519619, 'NDCG*@5': 0.028686912222342056, 'MRR*@5': 0.024117701771584423}
INFO    [05-05 17:51:22] train in BasicTrainer:
duration: 32.06202244758606s
INFO    [05-05 17:51:22] train in BasicTrainer:
epoch: 19
INFO    [05-05 17:51:34] _train_one_epoch in BasicTrainer:
loss = 4.451268894331796
INFO    [05-05 17:51:53] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-05 17:51:53] validate in BasicTrainer:
{'Recall@10': 0.06731683828613975, 'NDCG@10': 0.036979828707196495, 'MRR@10': 0.02782158502800898, 'Recall@5': 0.04319154301827604, 'NDCG@5': 0.029218355532396923, 'MRR@5': 0.024641571566462517, 'Recall*@10': 0.06731683828613975, 'NDCG*@10': 0.036979828707196495, 'MRR*@10': 0.02782158502800898, 'Recall*@5': 0.04319154301827604, 'NDCG*@5': 0.029218355532396923, 'MRR*@5': 0.024641571566462517}
INFO    [05-05 17:51:53] train in BasicTrainer:
duration: 31.690574169158936s
INFO    [05-05 17:51:53] train in BasicTrainer:
epoch: 20
INFO    [05-05 17:52:06] _train_one_epoch in BasicTrainer:
loss = 4.426526495388576
INFO    [05-05 17:52:25] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-05 17:52:25] validate in BasicTrainer:
{'Recall@10': 0.0695420124314048, 'NDCG@10': 0.03866699541156942, 'MRR@10': 0.02936638095839457, 'Recall@5': 0.044963923706249756, 'NDCG@5': 0.030771868472749538, 'MRR@5': 0.026139121841300617, 'Recall*@10': 0.0695420124314048, 'NDCG*@10': 0.03866699541156942, 'MRR*@10': 0.02936638095839457, 'Recall*@5': 0.044963923706249756, 'NDCG*@5': 0.030771868472749538, 'MRR*@5': 0.026139121841300617}
INFO    [05-05 17:52:25] train in BasicTrainer:
duration: 31.98475742340088s
INFO    [05-05 17:52:25] train in BasicTrainer:
epoch: 21
INFO    [05-05 17:52:38] _train_one_epoch in BasicTrainer:
loss = 4.402987429073879
INFO    [05-05 17:52:57] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-05 17:52:57] validate in BasicTrainer:
{'Recall@10': 0.07072909311814742, 'NDCG@10': 0.039115966043689034, 'MRR@10': 0.029588330706412144, 'Recall@5': 0.04587390239943157, 'NDCG@5': 0.031143862415443768, 'MRR@5': 0.026336834173310886, 'Recall*@10': 0.07072909311814742, 'NDCG*@10': 0.039115966043689034, 'MRR*@10': 0.029588330706412144, 'Recall*@5': 0.04587390239943157, 'NDCG*@5': 0.031143862415443768, 'MRR*@5': 0.026336834173310886}
INFO    [05-05 17:52:57] train in BasicTrainer:
duration: 31.992692708969116s
INFO    [05-05 17:52:57] train in BasicTrainer:
epoch: 22
INFO    [05-05 17:53:10] _train_one_epoch in BasicTrainer:
loss = 4.379351913928986
INFO    [05-05 17:53:28] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-05 17:53:29] validate in BasicTrainer:
{'Recall@10': 0.07099476659839804, 'NDCG@10': 0.03998668356375261, 'MRR@10': 0.030632125213742256, 'Recall@5': 0.046525786207480865, 'NDCG@5': 0.03211166794327172, 'MRR@5': 0.027403717183253982, 'Recall*@10': 0.07099476659839804, 'NDCG*@10': 0.03998668356375261, 'MRR*@10': 0.030632125213742256, 'Recall*@5': 0.046525786207480865, 'NDCG*@5': 0.03211166794327172, 'MRR*@5': 0.027403717183253982}
INFO    [05-05 17:53:29] train in BasicTrainer:
duration: 31.326067447662354s
INFO    [05-05 17:53:29] train in BasicTrainer:
epoch: 23
INFO    [05-05 17:53:43] _train_one_epoch in BasicTrainer:
loss = 4.358137301036289
INFO    [05-05 17:54:02] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-05 17:54:02] validate in BasicTrainer:
{'Recall@10': 0.07255729084665125, 'NDCG@10': 0.04086323725906285, 'MRR@10': 0.03127400170673023, 'Recall@5': 0.04814093932509422, 'NDCG@5': 0.033006476746364075, 'MRR@5': 0.02805402282286774, 'Recall*@10': 0.07255729084665125, 'NDCG*@10': 0.04086323725906285, 'MRR*@10': 0.03127400170673023, 'Recall*@5': 0.04814093932509422, 'NDCG*@5': 0.033006476746364075, 'MRR*@5': 0.02805402282286774}
INFO    [05-05 17:54:02] train in BasicTrainer:
duration: 33.978331089019775s
INFO    [05-05 17:54:02] train in BasicTrainer:
epoch: 24
INFO    [05-05 17:54:15] _train_one_epoch in BasicTrainer:
loss = 4.336955087525504
INFO    [05-05 17:54:33] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-05 17:54:34] validate in BasicTrainer:
{'Recall@10': 0.07350023023106834, 'NDCG@10': 0.04180690578439019, 'MRR@10': 0.032230058176950974, 'Recall@5': 0.048837212337688965, 'NDCG@5': 0.03386245176873424, 'MRR@5': 0.028969266028566795, 'Recall*@10': 0.07350023023106834, 'NDCG*@10': 0.04180690578439019, 'MRR*@10': 0.032230058176950974, 'Recall*@5': 0.048837212337688965, 'NDCG*@5': 0.03386245176873424, 'MRR*@5': 0.028969266028566795}
INFO    [05-05 17:54:34] train in BasicTrainer:
duration: 31.02195715904236s
INFO    [05-05 17:54:34] train in BasicTrainer:
epoch: 25
INFO    [05-05 17:54:47] _train_one_epoch in BasicTrainer:
loss = 4.319007362638201
INFO    [05-05 17:55:07] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-05 17:55:07] validate in BasicTrainer:
{'Recall@10': 0.07422375069423155, 'NDCG@10': 0.04232054948806763, 'MRR@10': 0.03268981487913565, 'Recall@5': 0.04966851797970859, 'NDCG@5': 0.03445932438427752, 'MRR@5': 0.029491801322861153, 'Recall*@10': 0.07422375069423155, 'NDCG*@10': 0.04232054948806763, 'MRR*@10': 0.03268981487913565, 'Recall*@5': 0.04966851797970859, 'NDCG*@5': 0.03445932438427752, 'MRR*@5': 0.029491801322861153}
INFO    [05-05 17:55:07] train in BasicTrainer:
duration: 33.5878381729126s
INFO    [05-05 17:55:07] train in BasicTrainer:
epoch: 26
INFO    [05-05 17:55:20] _train_one_epoch in BasicTrainer:
loss = 4.298158032553537
INFO    [05-05 17:55:38] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-05 17:55:38] validate in BasicTrainer:
{'Recall@10': 0.07491749728267844, 'NDCG@10': 0.04284524545073509, 'MRR@10': 0.03314227814024145, 'Recall@5': 0.05031468786976554, 'NDCG@5': 0.03493814305825667, 'MRR@5': 0.029907473278316585, 'Recall*@10': 0.07491749728267844, 'NDCG*@10': 0.04284524545073509, 'MRR*@10': 0.03314227814024145, 'Recall*@5': 0.05031468786976554, 'NDCG*@5': 0.03493814305825667, 'MRR*@5': 0.029907473278316585}
INFO    [05-05 17:55:38] train in BasicTrainer:
duration: 31.186625719070435s
INFO    [05-05 17:55:38] train in BasicTrainer:
epoch: 27
INFO    [05-05 17:55:53] _train_one_epoch in BasicTrainer:
loss = 4.280109328883035
INFO    [05-05 17:56:12] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-05 17:56:12] validate in BasicTrainer:
{'Recall@10': 0.07651099833575162, 'NDCG@10': 0.04353610121391036, 'MRR@10': 0.033562630753625526, 'Recall@5': 0.051510008898648346, 'NDCG@5': 0.03552141819487919, 'MRR@5': 0.030295594680038365, 'Recall*@10': 0.07651099833575162, 'NDCG*@10': 0.04353610121391036, 'MRR*@10': 0.033562630753625526, 'Recall*@5': 0.051510008898648346, 'NDCG*@5': 0.03552141819487919, 'MRR*@5': 0.030295594680038365}
INFO    [05-05 17:56:12] train in BasicTrainer:
duration: 33.82227873802185s
INFO    [05-05 17:56:12] train in BasicTrainer:
epoch: 28
INFO    [05-05 17:56:25] _train_one_epoch in BasicTrainer:
loss = 4.262396574020386
INFO    [05-05 17:56:43] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-05 17:56:43] validate in BasicTrainer:
{'Recall@10': 0.0771248686042699, 'NDCG@10': 0.044288999316367234, 'MRR@10': 0.03435992889783599, 'Recall@5': 0.051482100039720535, 'NDCG@5': 0.036047286946665154, 'MRR@5': 0.03098809482021765, 'Recall*@10': 0.0771248686042699, 'NDCG*@10': 0.044288999316367234, 'MRR*@10': 0.03435992889783599, 'Recall*@5': 0.051482100039720535, 'NDCG*@5': 0.036047286946665154, 'MRR*@5': 0.03098809482021765}
INFO    [05-05 17:56:43] train in BasicTrainer:
duration: 31.154249906539917s
INFO    [05-05 17:56:43] train in BasicTrainer:
epoch: 29
INFO    [05-05 17:56:58] _train_one_epoch in BasicTrainer:
loss = 4.246377936431339
INFO    [05-05 17:57:17] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-05 17:57:17] validate in BasicTrainer:
{'Recall@10': 0.07813691821965305, 'NDCG@10': 0.04489429193464192, 'MRR@10': 0.03484251417896964, 'Recall@5': 0.05270027707923542, 'NDCG@5': 0.03673059662634676, 'MRR@5': 0.031509665941650215, 'Recall*@10': 0.07813691821965305, 'NDCG*@10': 0.04489429193464192, 'MRR*@10': 0.03484251417896964, 'Recall*@5': 0.05270027707923542, 'NDCG*@5': 0.03673059662634676, 'MRR*@5': 0.031509665941650215}
INFO    [05-05 17:57:17] train in BasicTrainer:
duration: 34.0841326713562s
INFO    [05-05 17:57:17] train in BasicTrainer:
epoch: 30
INFO    [05-05 17:57:31] _train_one_epoch in BasicTrainer:
loss = 4.22783237695694
INFO    [05-05 17:57:49] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [05-05 17:57:50] validate in BasicTrainer:
{'Recall@10': 0.07906590402126312, 'NDCG@10': 0.04559291662140326, 'MRR@10': 0.035486768931150436, 'Recall@5': 0.05305978181687268, 'NDCG@5': 0.03722835569219156, 'MRR@5': 0.032060423865914345, 'Recall*@10': 0.07906590402126312, 'NDCG*@10': 0.04559291662140326, 'MRR*@10': 0.035486768931150436, 'Recall*@5': 0.05305978181687268, 'NDCG*@5': 0.03722835569219156, 'MRR*@5': 0.032060423865914345}
INFO    [05-05 17:57:50] train in BasicTrainer:
duration: 32.28718638420105s
INFO    [05-05 17:57:50] train in BasicTrainer:
epoch: 31
INFO    [05-05 17:58:03] _train_one_epoch in BasicTrainer:
loss = 4.211926920073373
INFO    [05-05 17:58:23] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-05 17:58:23] validate in BasicTrainer:
{'Recall@10': 0.07917116311463443, 'NDCG@10': 0.04609396105462855, 'MRR@10': 0.03606825355779041, 'Recall@5': 0.054274109954183754, 'NDCG@5': 0.038100084120577034, 'MRR@5': 0.03280335393818942, 'Recall*@10': 0.07917116311463443, 'NDCG*@10': 0.04609396105462855, 'MRR*@10': 0.03606825355779041, 'Recall*@5': 0.054274109954183754, 'NDCG*@5': 0.038100084120577034, 'MRR*@5': 0.03280335393818942}
INFO    [05-05 17:58:23] train in BasicTrainer:
duration: 33.05246639251709s
INFO    [05-05 17:58:23] train in BasicTrainer:
epoch: 32
INFO    [05-05 17:58:36] _train_one_epoch in BasicTrainer:
loss = 4.198278793266842
INFO    [05-05 17:58:55] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-05 17:58:55] validate in BasicTrainer:
{'Recall@10': 0.08025935969569466, 'NDCG@10': 0.04672915115952492, 'MRR@10': 0.0365601276809519, 'Recall@5': 0.05532615767283873, 'NDCG@5': 0.03872442110018297, 'MRR@5': 0.03329023549502546, 'Recall*@10': 0.08025935969569466, 'NDCG*@10': 0.04672915115952492, 'MRR*@10': 0.0365601276809519, 'Recall*@5': 0.05532615767283873, 'NDCG*@5': 0.03872442110018297, 'MRR*@5': 0.03329023549502546}
INFO    [05-05 17:58:55] train in BasicTrainer:
duration: 32.4890718460083s
INFO    [05-05 17:58:55] train in BasicTrainer:
epoch: 33
INFO    [05-05 17:59:08] _train_one_epoch in BasicTrainer:
loss = 4.183455663067954
INFO    [05-05 17:59:26] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-05 17:59:27] validate in BasicTrainer:
{'Recall@10': 0.08139633725989949, 'NDCG@10': 0.04723228988322345, 'MRR@10': 0.03687807138670574, 'Recall@5': 0.055384501137516716, 'NDCG@5': 0.03887439383701845, 'MRR@5': 0.03346018967303363, 'Recall*@10': 0.08139633725989949, 'NDCG*@10': 0.04723228988322345, 'MRR*@10': 0.03687807138670574, 'Recall*@5': 0.055384501137516716, 'NDCG*@5': 0.03887439383701845, 'MRR*@5': 0.03346018967303363}
INFO    [05-05 17:59:27] train in BasicTrainer:
duration: 31.337607622146606s
INFO    [05-05 17:59:27] train in BasicTrainer:
epoch: 34
INFO    [05-05 17:59:39] _train_one_epoch in BasicTrainer:
loss = 4.169517389365605
INFO    [05-05 17:59:58] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-05 17:59:58] validate in BasicTrainer:
{'Recall@10': 0.08109956708821384, 'NDCG@10': 0.04753543809056282, 'MRR@10': 0.03735592046921903, 'Recall@5': 0.0556178753348914, 'NDCG@5': 0.03933939574794336, 'MRR@5': 0.03399872847578742, 'Recall*@10': 0.08109956708821384, 'NDCG*@10': 0.04753543809056282, 'MRR*@10': 0.03735592046921903, 'Recall*@5': 0.0556178753348914, 'NDCG*@5': 0.03933939574794336, 'MRR*@5': 0.03399872847578742}
INFO    [05-05 17:59:58] train in BasicTrainer:
duration: 31.571872234344482s
INFO    [05-05 17:59:58] train in BasicTrainer:
epoch: 35
DEBUG   [05-05 18:00:08] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 5997301
DEBUG   [05-05 18:00:08] calculate_loss in loss:
pred max in softmax: 0.6231526732444763, argmax 15935117
DEBUG   [05-05 18:00:08] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 27634021
DEBUG   [05-05 18:00:08] calculate_loss in loss:
pred max in softmax: 0.8011128306388855, argmax 12537041
INFO    [05-05 18:00:11] _train_one_epoch in BasicTrainer:
loss = 4.154539465904236
INFO    [05-05 18:00:30] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-05 18:00:30] validate in BasicTrainer:
{'Recall@10': 0.08242300288243727, 'NDCG@10': 0.04822255196896466, 'MRR@10': 0.03786525062539361, 'Recall@5': 0.05605352703820576, 'NDCG@5': 0.03974149240688844, 'MRR@5': 0.034391902048479424, 'Recall*@10': 0.08242300288243727, 'NDCG*@10': 0.04822255196896466, 'MRR*@10': 0.03786525062539361, 'Recall*@5': 0.05605352703820576, 'NDCG*@5': 0.03974149240688844, 'MRR*@5': 0.034391902048479424}
INFO    [05-05 18:00:30] train in BasicTrainer:
duration: 31.722131967544556s
INFO    [05-05 18:00:30] train in BasicTrainer:
epoch: 36
INFO    [05-05 18:00:43] _train_one_epoch in BasicTrainer:
loss = 4.141541872705732
INFO    [05-05 18:01:01] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-05 18:01:02] validate in BasicTrainer:
{'Recall@10': 0.08200064436955885, 'NDCG@10': 0.04857541552998803, 'MRR@10': 0.03840410912578756, 'Recall@5': 0.057747234336354515, 'NDCG@5': 0.040780000049959526, 'MRR@5': 0.035214868120171806, 'Recall*@10': 0.08200064436955885, 'NDCG*@10': 0.04857541552998803, 'MRR*@10': 0.03840410912578756, 'Recall*@5': 0.057747234336354515, 'NDCG*@5': 0.040780000049959526, 'MRR*@5': 0.035214868120171806}
INFO    [05-05 18:01:02] train in BasicTrainer:
duration: 31.80683422088623s
INFO    [05-05 18:01:02] train in BasicTrainer:
epoch: 37
INFO    [05-05 18:01:14] _train_one_epoch in BasicTrainer:
loss = 4.131031436579568
INFO    [05-05 18:01:33] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [05-05 18:01:33] validate in BasicTrainer:
{'Recall@10': 0.0827856957912445, 'NDCG@10': 0.04888598756356673, 'MRR@10': 0.038568027994849464, 'Recall@5': 0.05737124891443686, 'NDCG@5': 0.04065877944231033, 'MRR@5': 0.03516797958449884, 'Recall*@10': 0.0827856957912445, 'NDCG*@10': 0.04888598756356673, 'MRR*@10': 0.038568027994849464, 'Recall*@5': 0.05737124891443686, 'NDCG*@5': 0.04065877944231033, 'MRR*@5': 0.03516797958449884}
INFO    [05-05 18:01:33] train in BasicTrainer:
duration: 31.394498109817505s
INFO    [05-05 18:01:33] train in BasicTrainer:
epoch: 38
INFO    [05-05 18:01:46] _train_one_epoch in BasicTrainer:
loss = 4.116217851638794
INFO    [05-05 18:02:05] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-05 18:02:06] validate in BasicTrainer:
{'Recall@10': 0.08374259011311964, 'NDCG@10': 0.049405309625647285, 'MRR@10': 0.03896241939880631, 'Recall@5': 0.05831990255550905, 'NDCG@5': 0.041211153295907105, 'MRR@5': 0.03559677776965228, 'Recall*@10': 0.08374259011311964, 'NDCG*@10': 0.049405309625647285, 'MRR*@10': 0.03896241939880631, 'Recall*@5': 0.05831990255550905, 'NDCG*@5': 0.041211153295907105, 'MRR*@5': 0.03559677776965228}
INFO    [05-05 18:02:06] train in BasicTrainer:
duration: 32.52820181846619s
INFO    [05-05 18:02:06] train in BasicTrainer:
epoch: 39
INFO    [05-05 18:02:20] _train_one_epoch in BasicTrainer:
loss = 4.10475481407983
INFO    [05-05 18:02:38] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [05-05 18:02:38] validate in BasicTrainer:
{'Recall@10': 0.08491890403357419, 'NDCG@10': 0.05012143064628948, 'MRR@10': 0.03956056216900999, 'Recall@5': 0.058801808817820114, 'NDCG@5': 0.04174778610467911, 'MRR@5': 0.036146991632201454, 'Recall*@10': 0.08491890403357419, 'NDCG*@10': 0.05012143064628948, 'MRR*@10': 0.03956056216900999, 'Recall*@5': 0.058801808817820114, 'NDCG*@5': 0.04174778610467911, 'MRR*@5': 0.036146991632201454}
INFO    [05-05 18:02:38] train in BasicTrainer:
duration: 32.93190884590149s
INFO    [05-05 18:02:38] train in BasicTrainer:
epoch: 40
INFO    [05-05 18:02:51] _train_one_epoch in BasicTrainer:
loss = 4.091344854661396
INFO    [05-05 18:03:10] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [05-05 18:03:11] validate in BasicTrainer:
{'Recall@10': 0.08596205034039238, 'NDCG@10': 0.05067491294308142, 'MRR@10': 0.039959222078323364, 'Recall@5': 0.059479074721986595, 'NDCG@5': 0.0421556562862613, 'MRR@5': 0.03646899251775308, 'Recall*@10': 0.08596205034039238, 'NDCG*@10': 0.05067491294308142, 'MRR*@10': 0.039959222078323364, 'Recall*@5': 0.059479074721986595, 'NDCG*@5': 0.0421556562862613, 'MRR*@5': 0.03646899251775308}
INFO    [05-05 18:03:11] train in BasicTrainer:
duration: 32.08891844749451s
INFO    [05-05 18:03:11] train in BasicTrainer:
epoch: 41
INFO    [05-05 18:03:24] _train_one_epoch in BasicTrainer:
loss = 4.0827557529721945
INFO    [05-05 18:03:42] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-05 18:03:42] validate in BasicTrainer:
{'Recall@10': 0.08512689579616893, 'NDCG@10': 0.05070908536965197, 'MRR@10': 0.04022887416861274, 'Recall@5': 0.0598449551246383, 'NDCG@5': 0.042588913643902, 'MRR@5': 0.03691017797047442, 'Recall*@10': 0.08512689579616893, 'NDCG*@10': 0.05070908536965197, 'MRR*@10': 0.04022887416861274, 'Recall*@5': 0.0598449551246383, 'NDCG*@5': 0.042588913643902, 'MRR*@5': 0.03691017797047442}
INFO    [05-05 18:03:42] train in BasicTrainer:
duration: 31.723716020584106s
INFO    [05-05 18:03:42] train in BasicTrainer:
epoch: 42
INFO    [05-05 18:03:56] _train_one_epoch in BasicTrainer:
loss = 4.072778220687594
INFO    [05-05 18:04:15] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-05 18:04:15] validate in BasicTrainer:
{'Recall@10': 0.0863165022297339, 'NDCG@10': 0.05105863917957653, 'MRR@10': 0.04033399068496444, 'Recall@5': 0.06018611416220665, 'NDCG@5': 0.04263239421627738, 'MRR@5': 0.03687053986571052, 'Recall*@10': 0.0863165022297339, 'NDCG*@10': 0.05105863917957653, 'MRR*@10': 0.04033399068496444, 'Recall*@5': 0.06018611416220665, 'NDCG*@5': 0.04263239421627738, 'MRR*@5': 0.03687053986571052}
INFO    [05-05 18:04:15] train in BasicTrainer:
duration: 32.735159397125244s
INFO    [05-05 18:04:15] train in BasicTrainer:
epoch: 43
INFO    [05-05 18:04:28] _train_one_epoch in BasicTrainer:
loss = 4.061013758182526
INFO    [05-05 18:04:46] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [05-05 18:04:46] validate in BasicTrainer:
{'Recall@10': 0.08746238120577553, 'NDCG@10': 0.051428590308536186, 'MRR@10': 0.04047103090719743, 'Recall@5': 0.06113224205645648, 'NDCG@5': 0.04296790503642776, 'MRR@5': 0.037010297517884864, 'Recall*@10': 0.08746238120577553, 'NDCG*@10': 0.051428590308536186, 'MRR*@10': 0.04047103090719743, 'Recall*@5': 0.06113224205645648, 'NDCG*@5': 0.04296790503642776, 'MRR*@5': 0.037010297517884864}
INFO    [05-05 18:04:46] train in BasicTrainer:
duration: 31.36588144302368s
INFO    [05-05 18:04:46] train in BasicTrainer:
epoch: 44
INFO    [05-05 18:04:59] _train_one_epoch in BasicTrainer:
loss = 4.050360832895551
INFO    [05-05 18:05:18] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-05 18:05:18] validate in BasicTrainer:
{'Recall@10': 0.08851563320918517, 'NDCG@10': 0.05251476879824291, 'MRR@10': 0.04158142107454213, 'Recall@5': 0.06193377382375977, 'NDCG@5': 0.04398029839450663, 'MRR@5': 0.03809494626792995, 'Recall*@10': 0.08851563320918517, 'NDCG*@10': 0.05251476879824291, 'MRR*@10': 0.04158142107454213, 'Recall*@5': 0.06193377382375977, 'NDCG*@5': 0.04398029839450663, 'MRR*@5': 0.03809494626792995}
INFO    [05-05 18:05:18] train in BasicTrainer:
duration: 32.0359206199646s
INFO    [05-05 18:05:18] train in BasicTrainer:
epoch: 45
INFO    [05-05 18:05:31] _train_one_epoch in BasicTrainer:
loss = 4.039178192615509
INFO    [05-05 18:05:50] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-05 18:05:50] validate in BasicTrainer:
{'Recall@10': 0.08891766247424213, 'NDCG@10': 0.05274824831973423, 'MRR@10': 0.04176778109236197, 'Recall@5': 0.06169787354089997, 'NDCG@5': 0.04400714486837387, 'MRR@5': 0.038195319812406196, 'Recall*@10': 0.08891766247424213, 'NDCG*@10': 0.05274824831973423, 'MRR*@10': 0.04176778109236197, 'Recall*@5': 0.06169787354089997, 'NDCG*@5': 0.04400714486837387, 'MRR*@5': 0.038195319812406196}
INFO    [05-05 18:05:50] train in BasicTrainer:
duration: 31.445046424865723s
INFO    [05-05 18:05:50] train in BasicTrainer:
epoch: 46
INFO    [05-05 18:06:04] _train_one_epoch in BasicTrainer:
loss = 4.030764711754663
INFO    [05-05 18:06:23] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-05 18:06:23] validate in BasicTrainer:
{'Recall@10': 0.08964184400710193, 'NDCG@10': 0.05316332050345161, 'MRR@10': 0.04210436615076932, 'Recall@5': 0.0621994479813359, 'NDCG@5': 0.04435660622336648, 'MRR@5': 0.03850947930054231, 'Recall*@10': 0.08964184400710193, 'NDCG*@10': 0.05316332050345161, 'MRR*@10': 0.04210436615076932, 'Recall*@5': 0.0621994479813359, 'NDCG*@5': 0.04435660622336648, 'MRR*@5': 0.03850947930054231}
INFO    [05-05 18:06:23] train in BasicTrainer:
duration: 33.212302446365356s
INFO    [05-05 18:06:23] train in BasicTrainer:
epoch: 47
INFO    [05-05 18:06:36] _train_one_epoch in BasicTrainer:
loss = 4.020087552922113
INFO    [05-05 18:06:54] validate in BasicTrainer:
{'Recall@10': 0.08875977383418517, 'NDCG@10': 0.052838821641423485, 'MRR@10': 0.04191080514680256, 'Recall@5': 0.0628348511051048, 'NDCG@5': 0.04451003873890096, 'MRR@5': 0.038504664193500175, 'Recall*@10': 0.08875977383418517, 'NDCG*@10': 0.052838821641423485, 'MRR*@10': 0.04191080514680256, 'Recall*@5': 0.0628348511051048, 'NDCG*@5': 0.04451003873890096, 'MRR*@5': 0.038504664193500175}
INFO    [05-05 18:06:54] train in BasicTrainer:
duration: 31.098148345947266s
INFO    [05-05 18:06:54] train in BasicTrainer:
epoch: 48
INFO    [05-05 18:07:07] _train_one_epoch in BasicTrainer:
loss = 4.011888589177813
INFO    [05-05 18:07:26] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-05 18:07:26] validate in BasicTrainer:
{'Recall@10': 0.0904738110574809, 'NDCG@10': 0.05359242179177024, 'MRR@10': 0.04241681573065845, 'Recall@5': 0.06253302808512341, 'NDCG@5': 0.04464417221871289, 'MRR@5': 0.03877526115287434, 'Recall*@10': 0.0904738110574809, 'NDCG*@10': 0.05359242179177024, 'MRR*@10': 0.04241681573065845, 'Recall*@5': 0.06253302808512341, 'NDCG*@5': 0.04464417221871289, 'MRR*@5': 0.03877526115287434}
INFO    [05-05 18:07:26] train in BasicTrainer:
duration: 32.00578022003174s
INFO    [05-05 18:07:26] train in BasicTrainer:
epoch: 49
INFO    [05-05 18:07:40] _train_one_epoch in BasicTrainer:
loss = 4.004882599626269
INFO    [05-05 18:07:58] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-05 18:07:58] validate in BasicTrainer:
{'Recall@10': 0.09063741361553018, 'NDCG@10': 0.05421330813657154, 'MRR@10': 0.043157112869349396, 'Recall@5': 0.06334598802707413, 'NDCG@5': 0.045470676300200547, 'MRR@5': 0.03959694132208824, 'Recall*@10': 0.09063741361553018, 'NDCG*@10': 0.05421330813657154, 'MRR*@10': 0.043157112869349396, 'Recall*@5': 0.06334598802707413, 'NDCG*@5': 0.045470676300200547, 'MRR*@5': 0.03959694132208824}
INFO    [05-05 18:07:58] train in BasicTrainer:
duration: 32.14228105545044s
INFO    [05-05 18:07:58] train in BasicTrainer:
epoch: 50
INFO    [05-05 18:08:11] _train_one_epoch in BasicTrainer:
loss = 3.994729667901993
INFO    [05-05 18:08:30] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-05 18:08:30] validate in BasicTrainer:
{'Recall@10': 0.09127853065729141, 'NDCG@10': 0.05426310815594413, 'MRR@10': 0.043007015165957535, 'Recall@5': 0.06473534655841914, 'NDCG@5': 0.04575019499117678, 'MRR@5': 0.039534813639792526, 'Recall*@10': 0.09127853065729141, 'NDCG*@10': 0.05426310815594413, 'MRR*@10': 0.043007015165957535, 'Recall*@5': 0.06473534655841914, 'NDCG*@5': 0.04575019499117678, 'MRR*@5': 0.039534813639792526}
INFO    [05-05 18:08:30] train in BasicTrainer:
duration: 31.93086814880371s
INFO    [05-05 18:08:30] train in BasicTrainer:
epoch: 51
INFO    [05-05 18:08:43] _train_one_epoch in BasicTrainer:
loss = 3.985311665705272
INFO    [05-05 18:09:02] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [05-05 18:09:02] validate in BasicTrainer:
{'Recall@10': 0.09144850820302963, 'NDCG@10': 0.055233169347047806, 'MRR@10': 0.044208541851152076, 'Recall@5': 0.06502068855545738, 'NDCG@5': 0.04671374979344281, 'MRR@5': 0.04070800305767493, 'Recall*@10': 0.09144850820302963, 'NDCG*@10': 0.055233169347047806, 'MRR*@10': 0.044208541851152076, 'Recall*@5': 0.06502068855545738, 'NDCG*@5': 0.04671374979344281, 'MRR*@5': 0.04070800305767493}
INFO    [05-05 18:09:02] train in BasicTrainer:
duration: 31.803038358688354s
INFO    [05-05 18:09:02] train in BasicTrainer:
epoch: 52
INFO    [05-05 18:09:17] _train_one_epoch in BasicTrainer:
loss = 3.9793660172394345
INFO    [05-05 18:09:36] validate in BasicTrainer:
{'Recall@10': 0.09216697581789711, 'NDCG@10': 0.055139131505380974, 'MRR@10': 0.043867409229278564, 'Recall@5': 0.06507013060829857, 'NDCG@5': 0.04643033478747715, 'MRR@5': 0.04030472920699553, 'Recall*@10': 0.09216697581789711, 'NDCG*@10': 0.055139131505380974, 'MRR*@10': 0.043867409229278564, 'Recall*@5': 0.06507013060829857, 'NDCG*@5': 0.04643033478747715, 'MRR*@5': 0.04030472920699553}
INFO    [05-05 18:09:36] train in BasicTrainer:
duration: 34.00994277000427s
INFO    [05-05 18:09:36] train in BasicTrainer:
epoch: 53
DEBUG   [05-05 18:09:45] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 6798661
DEBUG   [05-05 18:09:45] calculate_loss in loss:
pred max in softmax: 0.6371312737464905, argmax 3882632
DEBUG   [05-05 18:09:45] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 2511385
DEBUG   [05-05 18:09:45] calculate_loss in loss:
pred max in softmax: 0.456012099981308, argmax 37504710
INFO    [05-05 18:09:50] _train_one_epoch in BasicTrainer:
loss = 3.971955861364092
INFO    [05-05 18:10:08] log in loggers:
Update Best NDCG@10 Model at 53
INFO    [05-05 18:10:08] validate in BasicTrainer:
{'Recall@10': 0.09244660423560576, 'NDCG@10': 0.05550846931609241, 'MRR@10': 0.044245136055079376, 'Recall@5': 0.06565543060952966, 'NDCG@5': 0.04689994894645431, 'MRR@5': 0.040725098753517326, 'Recall*@10': 0.09244660423560576, 'NDCG*@10': 0.05550846931609241, 'MRR*@10': 0.044245136055079376, 'Recall*@5': 0.06565543060952966, 'NDCG*@5': 0.04689994894645431, 'MRR*@5': 0.040725098753517326}
INFO    [05-05 18:10:08] train in BasicTrainer:
duration: 32.16491508483887s
INFO    [05-05 18:10:08] train in BasicTrainer:
epoch: 54
INFO    [05-05 18:10:21] _train_one_epoch in BasicTrainer:
loss = 3.9651325813361575
INFO    [05-05 18:10:41] log in loggers:
Update Best NDCG@10 Model at 54
INFO    [05-05 18:10:41] validate in BasicTrainer:
{'Recall@10': 0.0939716561274095, 'NDCG@10': 0.05646823990074071, 'MRR@10': 0.04506493563001806, 'Recall@5': 0.06625787236473778, 'NDCG@5': 0.047545468265360054, 'MRR@5': 0.04140472344376824, 'Recall*@10': 0.0939716561274095, 'NDCG*@10': 0.05646823990074071, 'MRR*@10': 0.04506493563001806, 'Recall*@5': 0.06625787236473778, 'NDCG*@5': 0.047545468265360054, 'MRR*@5': 0.04140472344376824}
INFO    [05-05 18:10:41] train in BasicTrainer:
duration: 32.541746854782104s
INFO    [05-05 18:10:41] train in BasicTrainer:
epoch: 55
INFO    [05-05 18:10:54] _train_one_epoch in BasicTrainer:
loss = 3.9576517598969594
INFO    [05-05 18:11:13] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [05-05 18:11:13] validate in BasicTrainer:
{'Recall@10': 0.09486701949076219, 'NDCG@10': 0.05669624222950502, 'MRR@10': 0.04509763318029317, 'Recall@5': 0.0666288056156852, 'NDCG@5': 0.04764911159873009, 'MRR@5': 0.041412658650766716, 'Recall*@10': 0.09486701949076219, 'NDCG*@10': 0.05669624222950502, 'MRR*@10': 0.04509763318029317, 'Recall*@5': 0.0666288056156852, 'NDCG*@5': 0.04764911159873009, 'MRR*@5': 0.041412658650766716}
INFO    [05-05 18:11:13] train in BasicTrainer:
duration: 32.1190664768219s
INFO    [05-05 18:11:13] train in BasicTrainer:
epoch: 56
INFO    [05-05 18:11:26] _train_one_epoch in BasicTrainer:
loss = 3.949268728494644
INFO    [05-05 18:11:46] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-05 18:11:46] validate in BasicTrainer:
{'Recall@10': 0.09462606635960666, 'NDCG@10': 0.05706412988630208, 'MRR@10': 0.045632976699959145, 'Recall@5': 0.06743605163964358, 'NDCG@5': 0.04834443229165944, 'MRR@5': 0.0420767759734934, 'Recall*@10': 0.09462606635960666, 'NDCG*@10': 0.05706412988630208, 'MRR*@10': 0.045632976699959145, 'Recall*@5': 0.06743605163964358, 'NDCG*@5': 0.04834443229165944, 'MRR*@5': 0.0420767759734934}
INFO    [05-05 18:11:46] train in BasicTrainer:
duration: 32.86384129524231s
INFO    [05-05 18:11:46] train in BasicTrainer:
epoch: 57
INFO    [05-05 18:11:59] _train_one_epoch in BasicTrainer:
loss = 3.943494541304452
INFO    [05-05 18:12:17] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-05 18:12:17] validate in BasicTrainer:
{'Recall@10': 0.0953305797143416, 'NDCG@10': 0.05734783275560899, 'MRR@10': 0.04577566615559838, 'Recall@5': 0.06741451810706746, 'NDCG@5': 0.04835514453324405, 'MRR@5': 0.04208477078513666, 'Recall*@10': 0.0953305797143416, 'NDCG*@10': 0.05734783275560899, 'MRR*@10': 0.04577566615559838, 'Recall*@5': 0.06741451810706746, 'NDCG*@5': 0.04835514453324405, 'MRR*@5': 0.04208477078513666}
INFO    [05-05 18:12:17] train in BasicTrainer:
duration: 31.569994926452637s
INFO    [05-05 18:12:17] train in BasicTrainer:
epoch: 58
INFO    [05-05 18:12:30] _train_one_epoch in BasicTrainer:
loss = 3.9385536227907454
INFO    [05-05 18:12:50] log in loggers:
Update Best NDCG@10 Model at 58
INFO    [05-05 18:12:50] validate in BasicTrainer:
{'Recall@10': 0.09469517659057271, 'NDCG@10': 0.057362949644977394, 'MRR@10': 0.04599600928750905, 'Recall@5': 0.06748615476218137, 'NDCG@5': 0.04861096970059655, 'MRR@5': 0.0424115884710442, 'Recall*@10': 0.09469517659057271, 'NDCG*@10': 0.057362949644977394, 'MRR*@10': 0.04599600928750905, 'Recall*@5': 0.06748615476218137, 'NDCG*@5': 0.04861096970059655, 'MRR*@5': 0.0424115884710442}
INFO    [05-05 18:12:50] train in BasicTrainer:
duration: 32.75231695175171s
INFO    [05-05 18:12:50] train in BasicTrainer:
epoch: 59
INFO    [05-05 18:13:03] _train_one_epoch in BasicTrainer:
loss = 3.9306893135820116
INFO    [05-05 18:13:22] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [05-05 18:13:23] validate in BasicTrainer:
{'Recall@10': 0.09496788680553436, 'NDCG@10': 0.057528907602483574, 'MRR@10': 0.04610659046606584, 'Recall@5': 0.06835108250379562, 'NDCG@5': 0.04895572906190699, 'MRR@5': 0.042588622055270454, 'Recall*@10': 0.09496788680553436, 'NDCG*@10': 0.057528907602483574, 'MRR*@10': 0.04610659046606584, 'Recall*@5': 0.06835108250379562, 'NDCG*@5': 0.04895572906190699, 'MRR*@5': 0.042588622055270454}
INFO    [05-05 18:13:23] train in BasicTrainer:
duration: 32.75083637237549s
INFO    [05-05 18:13:23] close_training in BasicTrainer:
finished training
DEBUG   [05-05 18:13:23] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3361 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-05 18:13:23] run_routine in Routine:
Finished training, Start final validation
INFO    [05-05 18:13:23] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-05 18:13:23] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 18:13:23] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 18:13:42] validate in BasicTrainer:
{'Recall@10': 0.09496788680553436, 'NDCG@10': 0.057528907602483574, 'MRR@10': 0.04610659046606584, 'Recall@5': 0.06835108250379562, 'NDCG@5': 0.04895572906190699, 'MRR@5': 0.042588622055270454, 'Recall*@10': 0.09496788680553436, 'NDCG*@10': 0.057528907602483574, 'MRR*@10': 0.04610659046606584, 'Recall*@5': 0.06835108250379562, 'NDCG*@5': 0.04895572906190699, 'MRR*@5': 0.042588622055270454}
INFO    [05-05 18:13:42] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.09496788680553436, 'NDCG@10': 0.057528907602483574, 'MRR@10': 0.04610659046606584, 'Recall@5': 0.06835108250379562, 'NDCG@5': 0.04895572906190699, 'MRR@5': 0.042588622055270454, 'Recall*@10': 0.09496788680553436, 'NDCG*@10': 0.057528907602483574, 'MRR*@10': 0.04610659046606584, 'Recall*@5': 0.06835108250379562, 'NDCG*@5': 0.04895572906190699, 'MRR*@5': 0.042588622055270454}
INFO    [05-05 18:13:42] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-05 18:13:42] test in BasicTrainer:
Test model on test set!
INFO    [05-05 18:13:42] test_with_given_state_path in BasicTrainer:
Loading model params from ___yelp_soft_2022/pop_narm-T-6.0-al-0.75_05-05_17:40_t9/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-05 18:13:42] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-05 18:13:42] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-05 18:13:42] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-05 18:14:01] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.079312571070411, 'NDCG@10': 0.0469796589829705, 'MRR@10': 0.037172259254889053, 'Recall@5': 0.05497675795446743, 'NDCG@5': 0.03917454318566756, 'MRR@5': 0.033988392827185715, 'Recall*@10': 0.079312571070411, 'NDCG*@10': 0.0469796589829705, 'MRR*@10': 0.037172259254889053, 'Recall*@5': 0.05497675795446743, 'NDCG*@5': 0.03917454318566756, 'MRR*@5': 0.033988392827185715}
INFO    [05-05 18:14:01] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.079312571070411, 'NDCG@10': 0.0469796589829705, 'MRR@10': 0.037172259254889053, 'Recall@5': 0.05497675795446743, 'NDCG@5': 0.03917454318566756, 'MRR@5': 0.033988392827185715, 'Recall*@10': 0.079312571070411, 'NDCG*@10': 0.0469796589829705, 'MRR*@10': 0.037172259254889053, 'Recall*@5': 0.05497675795446743, 'NDCG*@5': 0.03917454318566756, 'MRR*@5': 0.033988392827185715}
