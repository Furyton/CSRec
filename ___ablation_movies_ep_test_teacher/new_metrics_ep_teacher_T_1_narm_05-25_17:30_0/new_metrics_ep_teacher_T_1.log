INFO    [05-25 17:30:31] setup_train in utils:
{
    "experiment_dir": "___ablation_movies_ep_test_teacher",
    "experiment_description": "new_metrics_ep_teacher_T_1",
    "dataset_name": "movies.csv",
    "sched": "ensemble",
    "model_code": "narm",
    "mentor_code": "narm",
    "mentor2_code": "narm",
    "softmaxed_mentor": true,
    "T": 1,
    "weight_list": [
        1,
        1
    ],
    "training_routine": "finished",
    "enable_auto_path_finder": false,
    "num_epochs": 0,
    "mode": "test",
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": "___movies_base_partial_2022/base_narm-rate-0.8-seed-2000_05-04_21:42_t2/narm_logs/checkpoint/best_acc_model.pth",
    "mentor2_state_path": "___movies_base_partial_2022/base_narm-rate-0.8-seed-2001_05-04_21:42_t1/narm_logs/checkpoint/best_acc_model.pth",
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "do_remap": false,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.movies/narm/config_ensemble.json",
    "task_id": -1,
    "describe": null,
    "split": "leave_one_out",
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "alpha": 0.1,
    "dvae_alpha": 0.5,
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
INFO    [05-25 17:30:31] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/movies-5-5.pkl
INFO    [05-25 17:30:33] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-25 17:30:33] _check_dataset_cache in utils:
correct.
INFO    [05-25 17:30:33] __init__ in NextItemDataloader:
there are 21035 items in this dataset, 82156 users, padding_first? False
DEBUG   [05-25 17:30:47] generate_model in utils:
model_code_list=['narm']
INFO    [05-25 17:30:47] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-25 17:30:47] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-25 17:30:55] get_exist_path in utils:
dir ___ablation_movies_ep_test_teacher/new_metrics_ep_teacher_T_1_narm_05-25_17:30_0/teacher1_narm_logs does not exist! Create one.
WARNING [05-25 17:30:55] get_exist_path in utils:
dir ___ablation_movies_ep_test_teacher/new_metrics_ep_teacher_T_1_narm_05-25_17:30_0/teacher1_narm_logs/tb_vis does not exist! Create one.
WARNING [05-25 17:30:55] get_exist_path in utils:
dir ___ablation_movies_ep_test_teacher/new_metrics_ep_teacher_T_1_narm_05-25_17:30_0/teacher1_narm_logs/checkpoint does not exist! Create one.
INFO    [05-25 17:30:56] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-25 17:30:56] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-25 17:30:56] load_state_from_given_path in utils:
Loading optimizer's parameters
DEBUG   [05-25 17:30:56] _generate_teacher_trainer in EnsembleSched:
teacher1_narm: 
NARM(
  (item_embedding): Embedding(21036, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-25 17:30:56] assert_model_device in utils:
model teacher1_narm has 5.60498046875 MB params.
INFO    [05-25 17:30:56] __init__ in BasicTrainer:
450560 iter per epoch
DEBUG   [05-25 17:30:56] generate_model in utils:
model_code_list=['narm']
INFO    [05-25 17:30:56] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-25 17:30:56] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-25 17:31:00] get_exist_path in utils:
dir ___ablation_movies_ep_test_teacher/new_metrics_ep_teacher_T_1_narm_05-25_17:30_0/teacher2_narm_logs does not exist! Create one.
WARNING [05-25 17:31:00] get_exist_path in utils:
dir ___ablation_movies_ep_test_teacher/new_metrics_ep_teacher_T_1_narm_05-25_17:30_0/teacher2_narm_logs/tb_vis does not exist! Create one.
WARNING [05-25 17:31:00] get_exist_path in utils:
dir ___ablation_movies_ep_test_teacher/new_metrics_ep_teacher_T_1_narm_05-25_17:30_0/teacher2_narm_logs/checkpoint does not exist! Create one.
INFO    [05-25 17:31:00] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-25 17:31:00] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-25 17:31:00] load_state_from_given_path in utils:
Loading optimizer's parameters
DEBUG   [05-25 17:31:00] _generate_teacher_trainer in EnsembleSched:
teacher2_narm: 
NARM(
  (item_embedding): Embedding(21036, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-25 17:31:00] assert_model_device in utils:
model teacher2_narm has 5.60498046875 MB params.
INFO    [05-25 17:31:00] __init__ in BasicTrainer:
450560 iter per epoch
INFO    [05-25 17:31:00] assert_model_device in utils:
model ensemble_model has 0.0 MB params.
INFO    [05-25 17:31:00] assert_model_device in utils:
model ensemble_model has no param
INFO    [05-25 17:31:00] _set_current_routine in Routine:
first routine: finished
INFO    [05-25 17:31:00] _evaluate in EnsembleSched:
Start testing ensemble model on test set
INFO    [05-25 17:31:00] test in tester:
Finished loading. Start testing.
DEBUG   [05-25 17:31:01] forward in Ensembler:
raw predict
DEBUG   [05-25 17:31:01] forward in Ensembler:
[tensor([[1.9834e-10, 4.3235e-05, 2.8795e-07,  ..., 5.9593e-08, 1.7312e-06,
         8.1385e-06],
        [7.7594e-13, 1.6266e-09, 6.1370e-10,  ..., 2.6127e-11, 3.8464e-06,
         2.3070e-06],
        [3.3278e-10, 1.0320e-07, 7.2124e-08,  ..., 1.7502e-11, 4.0963e-08,
         4.3032e-09],
        ...,
        [4.7322e-15, 1.0574e-16, 2.8446e-14,  ..., 1.2892e-16, 1.1880e-09,
         5.4675e-15],
        [7.0365e-11, 2.0728e-03, 7.3512e-08,  ..., 2.2154e-08, 1.5002e-06,
         3.2669e-07],
        [8.3810e-10, 4.6925e-06, 2.9954e-07,  ..., 1.8572e-08, 2.9534e-09,
         4.7113e-06]], device='cuda:0'), tensor([[9.7645e-10, 2.2249e-05, 1.4771e-06,  ..., 6.2130e-08, 1.5444e-06,
         1.5208e-05],
        [1.9102e-11, 5.1085e-09, 1.1978e-09,  ..., 7.4499e-10, 4.1465e-08,
         1.9787e-06],
        [8.5534e-10, 1.6868e-07, 6.1043e-07,  ..., 2.9213e-08, 1.2900e-08,
         1.5504e-07],
        ...,
        [5.9245e-15, 7.9181e-15, 2.1788e-12,  ..., 2.7367e-17, 1.3637e-08,
         9.9220e-12],
        [8.7452e-11, 6.8935e-04, 1.8215e-08,  ..., 1.7465e-06, 2.9726e-07,
         1.9819e-07],
        [2.9607e-10, 2.3988e-08, 3.1244e-06,  ..., 2.8340e-12, 5.4307e-12,
         6.7892e-09]], device='cuda:0')]
DEBUG   [05-25 17:31:01] forward in Ensembler:
raw confidence
DEBUG   [05-25 17:31:01] forward in Ensembler:
[tensor([0.0164, 0.0210, 0.0263,  ..., 0.2748, 0.0404, 0.0807], device='cuda:0'), tensor([0.0066, 0.0231, 0.0271,  ..., 0.1318, 0.0260, 0.0856], device='cuda:0')]
DEBUG   [05-25 17:31:01] forward in Ensembler:
weighted predict
DEBUG   [05-25 17:31:01] forward in Ensembler:
[tensor([[1.9834e-10, 4.3235e-05, 2.8795e-07,  ..., 5.9593e-08, 1.7312e-06,
         8.1385e-06],
        [7.7594e-13, 1.6266e-09, 6.1370e-10,  ..., 2.6127e-11, 3.8464e-06,
         2.3070e-06],
        [3.3278e-10, 1.0320e-07, 7.2124e-08,  ..., 1.7502e-11, 4.0963e-08,
         4.3032e-09],
        ...,
        [4.7322e-15, 1.0574e-16, 2.8446e-14,  ..., 1.2892e-16, 1.1880e-09,
         5.4675e-15],
        [7.0365e-11, 2.0728e-03, 7.3512e-08,  ..., 2.2154e-08, 1.5002e-06,
         3.2669e-07],
        [8.3810e-10, 4.6925e-06, 2.9954e-07,  ..., 1.8572e-08, 2.9534e-09,
         4.7113e-06]], device='cuda:0'), tensor([[9.7645e-10, 2.2249e-05, 1.4771e-06,  ..., 6.2130e-08, 1.5444e-06,
         1.5208e-05],
        [1.9102e-11, 5.1085e-09, 1.1978e-09,  ..., 7.4499e-10, 4.1465e-08,
         1.9787e-06],
        [8.5534e-10, 1.6868e-07, 6.1043e-07,  ..., 2.9213e-08, 1.2900e-08,
         1.5504e-07],
        ...,
        [5.9245e-15, 7.9181e-15, 2.1788e-12,  ..., 2.7367e-17, 1.3637e-08,
         9.9220e-12],
        [8.7452e-11, 6.8935e-04, 1.8215e-08,  ..., 1.7465e-06, 2.9726e-07,
         1.9819e-07],
        [2.9607e-10, 2.3988e-08, 3.1244e-06,  ..., 2.8340e-12, 5.4307e-12,
         6.7892e-09]], device='cuda:0')]
DEBUG   [05-25 17:31:01] forward in Ensembler:
final predict
DEBUG   [05-25 17:31:01] forward in Ensembler:
tensor([[5.8739e-10, 3.2742e-05, 8.8253e-07,  ..., 6.0861e-08, 1.6378e-06,
         1.1673e-05],
        [9.9390e-12, 3.3676e-09, 9.0574e-10,  ..., 3.8556e-10, 1.9439e-06,
         2.1428e-06],
        [5.9406e-10, 1.3594e-07, 3.4128e-07,  ..., 1.4615e-08, 2.6932e-08,
         7.9671e-08],
        ...,
        [5.3283e-15, 4.0119e-15, 1.1036e-12,  ..., 7.8142e-17, 7.4125e-09,
         4.9638e-12],
        [7.8908e-11, 1.3811e-03, 4.5863e-08,  ..., 8.8434e-07, 8.9872e-07,
         2.6244e-07],
        [5.6708e-10, 2.3583e-06, 1.7120e-06,  ..., 9.2876e-09, 1.4794e-09,
         2.3591e-06]], device='cuda:0')
DEBUG   [05-25 17:31:01] forward in Ensembler:
final confidence
DEBUG   [05-25 17:31:01] forward in Ensembler:
tensor([0.0109, 0.0185, 0.0154,  ..., 0.1995, 0.0332, 0.0433], device='cuda:0')
DEBUG   [05-25 17:31:03] forward in Ensembler:
raw predict
DEBUG   [05-25 17:31:03] forward in Ensembler:
[tensor([[1.3724e-09, 1.2227e-05, 3.5626e-06,  ..., 2.6596e-08, 8.0278e-05,
         2.0910e-05],
        [3.7275e-12, 8.3406e-05, 1.7159e-07,  ..., 4.0950e-07, 1.1036e-06,
         2.1062e-07],
        [1.0530e-10, 9.2151e-08, 6.6752e-08,  ..., 1.2912e-08, 8.5594e-07,
         1.2324e-06],
        ...,
        [2.6891e-09, 1.2736e-05, 2.5279e-06,  ..., 1.5022e-06, 7.1331e-08,
         7.6244e-07],
        [6.9527e-12, 7.8561e-08, 2.5212e-10,  ..., 3.3974e-11, 1.1730e-07,
         2.1599e-06],
        [5.0331e-10, 5.5459e-05, 2.5938e-08,  ..., 5.2322e-09, 1.4026e-05,
         2.2061e-06]], device='cuda:0'), tensor([[1.9311e-09, 4.1062e-05, 3.6231e-06,  ..., 5.6809e-08, 4.3459e-05,
         1.5321e-06],
        [1.2678e-10, 8.5043e-05, 1.9795e-08,  ..., 3.4692e-08, 4.9006e-07,
         7.4521e-07],
        [2.1738e-09, 2.9877e-06, 3.4587e-07,  ..., 3.2349e-08, 3.9471e-06,
         2.6269e-06],
        ...,
        [1.7738e-08, 2.7665e-04, 1.8817e-05,  ..., 9.5504e-07, 6.2212e-07,
         6.9952e-07],
        [4.1796e-11, 2.4074e-08, 1.8082e-09,  ..., 1.3008e-09, 1.2513e-07,
         2.3608e-06],
        [5.1362e-09, 7.8090e-04, 3.1405e-07,  ..., 4.5683e-07, 2.1632e-05,
         3.8854e-07]], device='cuda:0')]
DEBUG   [05-25 17:31:03] forward in Ensembler:
raw confidence
DEBUG   [05-25 17:31:03] forward in Ensembler:
[tensor([0.0052, 0.1381, 0.0295,  ..., 0.0266, 0.0165, 0.0072], device='cuda:0'), tensor([0.0135, 0.3263, 0.0110,  ..., 0.0189, 0.0219, 0.0127], device='cuda:0')]
DEBUG   [05-25 17:31:03] forward in Ensembler:
weighted predict
DEBUG   [05-25 17:31:03] forward in Ensembler:
[tensor([[1.3724e-09, 1.2227e-05, 3.5626e-06,  ..., 2.6596e-08, 8.0278e-05,
         2.0910e-05],
        [3.7275e-12, 8.3406e-05, 1.7159e-07,  ..., 4.0950e-07, 1.1036e-06,
         2.1062e-07],
        [1.0530e-10, 9.2151e-08, 6.6752e-08,  ..., 1.2912e-08, 8.5594e-07,
         1.2324e-06],
        ...,
        [2.6891e-09, 1.2736e-05, 2.5279e-06,  ..., 1.5022e-06, 7.1331e-08,
         7.6244e-07],
        [6.9527e-12, 7.8561e-08, 2.5212e-10,  ..., 3.3974e-11, 1.1730e-07,
         2.1599e-06],
        [5.0331e-10, 5.5459e-05, 2.5938e-08,  ..., 5.2322e-09, 1.4026e-05,
         2.2061e-06]], device='cuda:0'), tensor([[1.9311e-09, 4.1062e-05, 3.6231e-06,  ..., 5.6809e-08, 4.3459e-05,
         1.5321e-06],
        [1.2678e-10, 8.5043e-05, 1.9795e-08,  ..., 3.4692e-08, 4.9006e-07,
         7.4521e-07],
        [2.1738e-09, 2.9877e-06, 3.4587e-07,  ..., 3.2349e-08, 3.9471e-06,
         2.6269e-06],
        ...,
        [1.7738e-08, 2.7665e-04, 1.8817e-05,  ..., 9.5504e-07, 6.2212e-07,
         6.9952e-07],
        [4.1796e-11, 2.4074e-08, 1.8082e-09,  ..., 1.3008e-09, 1.2513e-07,
         2.3608e-06],
        [5.1362e-09, 7.8090e-04, 3.1405e-07,  ..., 4.5683e-07, 2.1632e-05,
         3.8854e-07]], device='cuda:0')]
DEBUG   [05-25 17:31:03] forward in Ensembler:
final predict
DEBUG   [05-25 17:31:03] forward in Ensembler:
tensor([[1.6518e-09, 2.6645e-05, 3.5929e-06,  ..., 4.1703e-08, 6.1869e-05,
         1.1221e-05],
        [6.5254e-11, 8.4224e-05, 9.5693e-08,  ..., 2.2209e-07, 7.9681e-07,
         4.7791e-07],
        [1.1396e-09, 1.5399e-06, 2.0631e-07,  ..., 2.2631e-08, 2.4015e-06,
         1.9296e-06],
        ...,
        [1.0213e-08, 1.4470e-04, 1.0672e-05,  ..., 1.2286e-06, 3.4673e-07,
         7.3098e-07],
        [2.4374e-11, 5.1318e-08, 1.0302e-09,  ..., 6.6738e-10, 1.2122e-07,
         2.2603e-06],
        [2.8197e-09, 4.1818e-04, 1.6999e-07,  ..., 2.3103e-07, 1.7829e-05,
         1.2973e-06]], device='cuda:0')
DEBUG   [05-25 17:31:03] forward in Ensembler:
final confidence
DEBUG   [05-25 17:31:03] forward in Ensembler:
tensor([0.0068, 0.2322, 0.0179,  ..., 0.0140, 0.0186, 0.0067], device='cuda:0')
DEBUG   [05-25 17:31:04] forward in Ensembler:
raw predict
DEBUG   [05-25 17:31:04] forward in Ensembler:
[tensor([[2.2735e-10, 1.9464e-06, 3.4386e-09,  ..., 4.7231e-08, 2.7952e-06,
         3.8773e-06],
        [1.6400e-13, 3.8756e-08, 1.9869e-13,  ..., 4.0302e-15, 1.0947e-07,
         3.8808e-07],
        [1.6497e-09, 2.1560e-06, 4.3205e-07,  ..., 1.2425e-07, 7.7293e-05,
         1.0300e-05],
        ...,
        [5.9587e-11, 3.5941e-06, 6.3082e-08,  ..., 6.2750e-06, 1.1202e-08,
         6.0307e-06],
        [8.5169e-10, 1.0692e-04, 7.7916e-07,  ..., 1.8635e-06, 2.9940e-06,
         3.3730e-06],
        [4.7894e-10, 1.7287e-07, 1.1330e-08,  ..., 1.9476e-08, 1.4222e-06,
         3.7538e-05]], device='cuda:0'), tensor([[2.2137e-10, 7.9799e-08, 2.3425e-10,  ..., 9.9501e-09, 2.0313e-08,
         7.9231e-07],
        [2.1000e-14, 4.2502e-09, 1.3534e-14,  ..., 1.4274e-12, 3.3636e-09,
         1.0563e-08],
        [6.6976e-10, 1.5378e-05, 1.6438e-06,  ..., 1.7202e-06, 3.0179e-05,
         4.6074e-06],
        ...,
        [7.5907e-11, 3.8548e-06, 2.8248e-07,  ..., 1.6966e-05, 1.6322e-08,
         2.3985e-06],
        [1.9409e-09, 2.6716e-05, 2.0958e-07,  ..., 2.7816e-05, 8.2063e-07,
         1.1182e-05],
        [1.0690e-09, 7.8138e-08, 8.4434e-09,  ..., 1.1030e-07, 1.3166e-06,
         1.2791e-04]], device='cuda:0')]
DEBUG   [05-25 17:31:04] forward in Ensembler:
raw confidence
DEBUG   [05-25 17:31:04] forward in Ensembler:
[tensor([0.0081, 0.0856, 0.0137,  ..., 0.0436, 0.0088, 0.0066], device='cuda:0'), tensor([0.0328, 0.0576, 0.0038,  ..., 0.0305, 0.0058, 0.0066], device='cuda:0')]
DEBUG   [05-25 17:31:04] forward in Ensembler:
weighted predict
DEBUG   [05-25 17:31:04] forward in Ensembler:
[tensor([[2.2735e-10, 1.9464e-06, 3.4386e-09,  ..., 4.7231e-08, 2.7952e-06,
         3.8773e-06],
        [1.6400e-13, 3.8756e-08, 1.9869e-13,  ..., 4.0302e-15, 1.0947e-07,
         3.8808e-07],
        [1.6497e-09, 2.1560e-06, 4.3205e-07,  ..., 1.2425e-07, 7.7293e-05,
         1.0300e-05],
        ...,
        [5.9587e-11, 3.5941e-06, 6.3082e-08,  ..., 6.2750e-06, 1.1202e-08,
         6.0307e-06],
        [8.5169e-10, 1.0692e-04, 7.7916e-07,  ..., 1.8635e-06, 2.9940e-06,
         3.3730e-06],
        [4.7894e-10, 1.7287e-07, 1.1330e-08,  ..., 1.9476e-08, 1.4222e-06,
         3.7538e-05]], device='cuda:0'), tensor([[2.2137e-10, 7.9799e-08, 2.3425e-10,  ..., 9.9501e-09, 2.0313e-08,
         7.9231e-07],
        [2.1000e-14, 4.2502e-09, 1.3534e-14,  ..., 1.4274e-12, 3.3636e-09,
         1.0563e-08],
        [6.6976e-10, 1.5378e-05, 1.6438e-06,  ..., 1.7202e-06, 3.0179e-05,
         4.6074e-06],
        ...,
        [7.5907e-11, 3.8548e-06, 2.8248e-07,  ..., 1.6966e-05, 1.6322e-08,
         2.3985e-06],
        [1.9409e-09, 2.6716e-05, 2.0958e-07,  ..., 2.7816e-05, 8.2063e-07,
         1.1182e-05],
        [1.0690e-09, 7.8138e-08, 8.4434e-09,  ..., 1.1030e-07, 1.3166e-06,
         1.2791e-04]], device='cuda:0')]
DEBUG   [05-25 17:31:04] forward in Ensembler:
final predict
DEBUG   [05-25 17:31:04] forward in Ensembler:
tensor([[2.2436e-10, 1.0131e-06, 1.8364e-09,  ..., 2.8590e-08, 1.4077e-06,
         2.3348e-06],
        [9.2498e-14, 2.1503e-08, 1.0611e-13,  ..., 7.1574e-13, 5.6419e-08,
         1.9932e-07],
        [1.1597e-09, 8.7671e-06, 1.0379e-06,  ..., 9.2220e-07, 5.3736e-05,
         7.4538e-06],
        ...,
        [6.7747e-11, 3.7244e-06, 1.7278e-07,  ..., 1.1621e-05, 1.3762e-08,
         4.2146e-06],
        [1.3963e-09, 6.6820e-05, 4.9437e-07,  ..., 1.4840e-05, 1.9073e-06,
         7.2773e-06],
        [7.7398e-10, 1.2550e-07, 9.8865e-09,  ..., 6.4889e-08, 1.3694e-06,
         8.2724e-05]], device='cuda:0')
DEBUG   [05-25 17:31:04] forward in Ensembler:
final confidence
DEBUG   [05-25 17:31:04] forward in Ensembler:
tensor([0.0204, 0.0454, 0.0072,  ..., 0.0340, 0.0068, 0.0064], device='cuda:0')
DEBUG   [05-25 17:31:06] forward in Ensembler:
raw predict
DEBUG   [05-25 17:31:06] forward in Ensembler:
[tensor([[7.6041e-10, 5.0016e-07, 5.4478e-07,  ..., 1.9239e-06, 5.5045e-09,
         1.4721e-06],
        [9.8545e-10, 3.5431e-04, 2.1864e-05,  ..., 2.3714e-06, 2.9810e-05,
         2.5098e-07],
        [5.5878e-13, 2.9774e-10, 1.0776e-11,  ..., 9.2671e-13, 4.2835e-09,
         1.1075e-06],
        ...,
        [4.8111e-10, 9.9179e-08, 1.1881e-09,  ..., 4.0499e-09, 2.5749e-08,
         6.8059e-07],
        [6.0785e-12, 1.0247e-11, 1.4472e-09,  ..., 2.1410e-09, 1.2515e-09,
         7.9032e-06],
        [5.3319e-09, 2.7949e-06, 2.8802e-06,  ..., 4.9914e-07, 2.6622e-08,
         1.4863e-06]], device='cuda:0'), tensor([[2.3040e-09, 9.6485e-06, 1.7116e-07,  ..., 1.6381e-07, 9.5222e-07,
         8.6463e-07],
        [1.7951e-09, 6.7966e-04, 1.9538e-06,  ..., 3.4113e-05, 4.5364e-05,
         2.9736e-06],
        [1.3665e-11, 7.4296e-12, 2.7418e-11,  ..., 6.5502e-12, 9.9790e-09,
         9.2142e-06],
        ...,
        [3.2915e-10, 2.8161e-07, 2.5155e-10,  ..., 9.7122e-09, 1.1003e-08,
         1.6665e-06],
        [2.2074e-10, 1.1225e-09, 9.9687e-09,  ..., 8.3477e-08, 3.5473e-08,
         3.7394e-05],
        [5.3307e-11, 8.2456e-07, 7.4813e-09,  ..., 6.5399e-05, 2.2772e-12,
         5.5887e-09]], device='cuda:0')]
DEBUG   [05-25 17:31:06] forward in Ensembler:
raw confidence
DEBUG   [05-25 17:31:06] forward in Ensembler:
[tensor([0.2410, 0.0167, 0.0599,  ..., 0.0216, 0.0190, 0.0664], device='cuda:0'), tensor([0.4549, 0.0159, 0.0571,  ..., 0.0180, 0.0128, 0.1240], device='cuda:0')]
DEBUG   [05-25 17:31:06] forward in Ensembler:
weighted predict
DEBUG   [05-25 17:31:06] forward in Ensembler:
[tensor([[7.6041e-10, 5.0016e-07, 5.4478e-07,  ..., 1.9239e-06, 5.5045e-09,
         1.4721e-06],
        [9.8545e-10, 3.5431e-04, 2.1864e-05,  ..., 2.3714e-06, 2.9810e-05,
         2.5098e-07],
        [5.5878e-13, 2.9774e-10, 1.0776e-11,  ..., 9.2671e-13, 4.2835e-09,
         1.1075e-06],
        ...,
        [4.8111e-10, 9.9179e-08, 1.1881e-09,  ..., 4.0499e-09, 2.5749e-08,
         6.8059e-07],
        [6.0785e-12, 1.0247e-11, 1.4472e-09,  ..., 2.1410e-09, 1.2515e-09,
         7.9032e-06],
        [5.3319e-09, 2.7949e-06, 2.8802e-06,  ..., 4.9914e-07, 2.6622e-08,
         1.4863e-06]], device='cuda:0'), tensor([[2.3040e-09, 9.6485e-06, 1.7116e-07,  ..., 1.6381e-07, 9.5222e-07,
         8.6463e-07],
        [1.7951e-09, 6.7966e-04, 1.9538e-06,  ..., 3.4113e-05, 4.5364e-05,
         2.9736e-06],
        [1.3665e-11, 7.4296e-12, 2.7418e-11,  ..., 6.5502e-12, 9.9790e-09,
         9.2142e-06],
        ...,
        [3.2915e-10, 2.8161e-07, 2.5155e-10,  ..., 9.7122e-09, 1.1003e-08,
         1.6665e-06],
        [2.2074e-10, 1.1225e-09, 9.9687e-09,  ..., 8.3477e-08, 3.5473e-08,
         3.7394e-05],
        [5.3307e-11, 8.2456e-07, 7.4813e-09,  ..., 6.5399e-05, 2.2772e-12,
         5.5887e-09]], device='cuda:0')]
DEBUG   [05-25 17:31:06] forward in Ensembler:
final predict
DEBUG   [05-25 17:31:06] forward in Ensembler:
tensor([[1.5322e-09, 5.0743e-06, 3.5797e-07,  ..., 1.0438e-06, 4.7886e-07,
         1.1684e-06],
        [1.3903e-09, 5.1698e-04, 1.1909e-05,  ..., 1.8242e-05, 3.7587e-05,
         1.6123e-06],
        [7.1120e-12, 1.5259e-10, 1.9097e-11,  ..., 3.7385e-12, 7.1312e-09,
         5.1608e-06],
        ...,
        [4.0513e-10, 1.9039e-07, 7.1982e-10,  ..., 6.8810e-09, 1.8376e-08,
         1.1736e-06],
        [1.1341e-10, 5.6636e-10, 5.7079e-09,  ..., 4.2809e-08, 1.8362e-08,
         2.2648e-05],
        [2.6926e-09, 1.8097e-06, 1.4439e-06,  ..., 3.2949e-05, 1.3312e-08,
         7.4596e-07]], device='cuda:0')
DEBUG   [05-25 17:31:06] forward in Ensembler:
final confidence
DEBUG   [05-25 17:31:06] forward in Ensembler:
tensor([0.3480, 0.0134, 0.0534,  ..., 0.0126, 0.0138, 0.0679], device='cuda:0')
DEBUG   [05-25 17:31:08] forward in Ensembler:
raw predict
DEBUG   [05-25 17:31:08] forward in Ensembler:
[tensor([[1.4727e-10, 2.8282e-09, 5.3263e-10,  ..., 2.3691e-12, 8.5542e-09,
         4.5156e-07],
        [1.0089e-09, 3.4432e-07, 8.9808e-09,  ..., 2.3481e-08, 1.3304e-05,
         1.8197e-04],
        [1.5927e-09, 6.6635e-08, 2.4162e-08,  ..., 1.7800e-09, 6.6221e-08,
         2.8391e-07],
        ...,
        [2.4977e-11, 2.7399e-05, 4.3424e-07,  ..., 2.1875e-06, 5.4976e-06,
         2.6113e-06],
        [2.2075e-11, 5.7387e-06, 1.5461e-07,  ..., 1.6265e-06, 9.5162e-07,
         2.5377e-06],
        [4.7237e-11, 1.0377e-09, 2.1005e-09,  ..., 1.1690e-08, 1.1706e-07,
         1.7476e-05]], device='cuda:0'), tensor([[5.6270e-11, 3.1252e-08, 5.0935e-09,  ..., 1.4251e-10, 5.4221e-09,
         8.6827e-06],
        [2.8627e-09, 5.8014e-08, 5.4479e-08,  ..., 6.6166e-07, 6.2816e-06,
         4.6674e-05],
        [1.3594e-10, 4.8369e-09, 5.1912e-11,  ..., 4.1958e-12, 2.9417e-07,
         2.9657e-08],
        ...,
        [4.8134e-11, 5.8827e-07, 3.6210e-07,  ..., 5.7860e-06, 2.7531e-06,
         3.1693e-05],
        [2.1372e-11, 1.6325e-07, 1.8026e-07,  ..., 6.0500e-06, 2.6163e-07,
         2.3128e-05],
        [7.2215e-11, 2.0043e-09, 8.2075e-09,  ..., 2.6176e-08, 1.7576e-07,
         2.7032e-05]], device='cuda:0')]
DEBUG   [05-25 17:31:08] forward in Ensembler:
raw confidence
DEBUG   [05-25 17:31:08] forward in Ensembler:
[tensor([0.0221, 0.0057, 0.1847,  ..., 0.0221, 0.0356, 0.0190], device='cuda:0'), tensor([0.0172, 0.0047, 0.1134,  ..., 0.0247, 0.0365, 0.0284], device='cuda:0')]
DEBUG   [05-25 17:31:08] forward in Ensembler:
weighted predict
DEBUG   [05-25 17:31:08] forward in Ensembler:
[tensor([[1.4727e-10, 2.8282e-09, 5.3263e-10,  ..., 2.3691e-12, 8.5542e-09,
         4.5156e-07],
        [1.0089e-09, 3.4432e-07, 8.9808e-09,  ..., 2.3481e-08, 1.3304e-05,
         1.8197e-04],
        [1.5927e-09, 6.6635e-08, 2.4162e-08,  ..., 1.7800e-09, 6.6221e-08,
         2.8391e-07],
        ...,
        [2.4977e-11, 2.7399e-05, 4.3424e-07,  ..., 2.1875e-06, 5.4976e-06,
         2.6113e-06],
        [2.2075e-11, 5.7387e-06, 1.5461e-07,  ..., 1.6265e-06, 9.5162e-07,
         2.5377e-06],
        [4.7237e-11, 1.0377e-09, 2.1005e-09,  ..., 1.1690e-08, 1.1706e-07,
         1.7476e-05]], device='cuda:0'), tensor([[5.6270e-11, 3.1252e-08, 5.0935e-09,  ..., 1.4251e-10, 5.4221e-09,
         8.6827e-06],
        [2.8627e-09, 5.8014e-08, 5.4479e-08,  ..., 6.6166e-07, 6.2816e-06,
         4.6674e-05],
        [1.3594e-10, 4.8369e-09, 5.1912e-11,  ..., 4.1958e-12, 2.9417e-07,
         2.9657e-08],
        ...,
        [4.8134e-11, 5.8827e-07, 3.6210e-07,  ..., 5.7860e-06, 2.7531e-06,
         3.1693e-05],
        [2.1372e-11, 1.6325e-07, 1.8026e-07,  ..., 6.0500e-06, 2.6163e-07,
         2.3128e-05],
        [7.2215e-11, 2.0043e-09, 8.2075e-09,  ..., 2.6176e-08, 1.7576e-07,
         2.7032e-05]], device='cuda:0')]
DEBUG   [05-25 17:31:08] forward in Ensembler:
final predict
DEBUG   [05-25 17:31:08] forward in Ensembler:
tensor([[1.0177e-10, 1.7040e-08, 2.8131e-09,  ..., 7.2438e-11, 6.9881e-09,
         4.5671e-06],
        [1.9358e-09, 2.0117e-07, 3.1730e-08,  ..., 3.4257e-07, 9.7926e-06,
         1.1432e-04],
        [8.6432e-10, 3.5736e-08, 1.2107e-08,  ..., 8.9209e-10, 1.8020e-07,
         1.5678e-07],
        ...,
        [3.6556e-11, 1.3994e-05, 3.9817e-07,  ..., 3.9867e-06, 4.1253e-06,
         1.7152e-05],
        [2.1723e-11, 2.9510e-06, 1.6744e-07,  ..., 3.8383e-06, 6.0662e-07,
         1.2833e-05],
        [5.9726e-11, 1.5210e-09, 5.1540e-09,  ..., 1.8933e-08, 1.4641e-07,
         2.2254e-05]], device='cuda:0')
DEBUG   [05-25 17:31:08] forward in Ensembler:
final confidence
DEBUG   [05-25 17:31:08] forward in Ensembler:
tensor([0.0182, 0.0033, 0.0938,  ..., 0.0234, 0.0360, 0.0206], device='cuda:0')
WARNING [05-25 17:31:36] get_exist_path in utils:
dir ___ablation_movies_ep_test_teacher/new_metrics_ep_teacher_T_1_narm_05-25_17:30_0/ensemble_model_logs does not exist! Create one.
INFO    [05-25 17:31:36] _evaluate in EnsembleSched:
!!Final Result!!: {'Recall@10': 0.09116297640970775, 'NDCG@10': 0.05281434332331022, 'MRR@10': 0.041186277178071794, 'Recall@5': 0.062181769914570306, 'NDCG@5': 0.04349432087370327, 'MRR@5': 0.03737007516125838, 'Recall*@10': 0.0933147349527904, 'NDCG*@10': 0.05485256814530918, 'MRR*@10': 0.0431570831154074, 'Recall*@5': 0.06489862945108187, 'NDCG*@5': 0.045688824994223456, 'MRR*@5': 0.0393899671201195, 'Recall**@10': 0.08482522127174195, 'NDCG**@10': 0.04676349514297077, 'MRR**@10': 0.03532000817358494, 'Recall**@5': 0.054119945814212166, 'NDCG**@5': 0.03696393860237939, 'MRR**@5': 0.03135132337255137}
