INFO    [05-04 17:44:33] setup_train in utils:
{
    "experiment_dir": "___lfms_soft_2022",
    "experiment_description": "soft",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "lastfm_small.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "dvae_alpha": 0.5,
    "alpha": 0.5,
    "T": 3.0,
    "num_epochs": 80,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 20,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 256,
    "val_batch_size": 256,
    "test_batch_size": 256,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.lastfm_small/narm/config_distill.json",
    "task_id": 5,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-04 17:44:33] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-04 17:44:33] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/lastfm_small-5-5.pkl
INFO    [05-04 17:44:33] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-04 17:44:33] _check_dataset_cache in utils:
correct.
INFO    [05-04 17:44:33] __init__ in NextItemDataloader:
there are 3646 items in this dataset, 3173 users, padding_first? False
DEBUG   [05-04 17:44:34] generate_model in utils:
model_code_list=['pop']
INFO    [05-04 17:44:34] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-04 17:44:34] load_model_config in utils:
{}
WARNING [05-04 17:44:41] get_exist_path in utils:
dir ___lfms_soft_2022/soft_narm-T-3.0-al-0.5_05-04_17:44_t5/teacher_pop_logs does not exist! Create one.
WARNING [05-04 17:44:41] get_exist_path in utils:
dir ___lfms_soft_2022/soft_narm-T-3.0-al-0.5_05-04_17:44_t5/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-04 17:44:41] get_exist_path in utils:
dir ___lfms_soft_2022/soft_narm-T-3.0-al-0.5_05-04_17:44_t5/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-04 17:44:41] get_path in utils:
Path is None
WARNING [05-04 17:44:41] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-04 17:44:41] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-04 17:44:41] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-04 17:44:41] __init__ in BasicTrainer:
48128 iter per epoch
DEBUG   [05-04 17:44:41] generate_model in utils:
model_code_list=['narm']
INFO    [05-04 17:44:41] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-04 17:44:41] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-04 17:44:42] get_exist_path in utils:
dir ___lfms_soft_2022/soft_narm-T-3.0-al-0.5_05-04_17:44_t5/student_narm_logs does not exist! Create one.
WARNING [05-04 17:44:42] get_exist_path in utils:
dir ___lfms_soft_2022/soft_narm-T-3.0-al-0.5_05-04_17:44_t5/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-04 17:44:42] get_exist_path in utils:
dir ___lfms_soft_2022/soft_narm-T-3.0-al-0.5_05-04_17:44_t5/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-04 17:44:42] get_path in utils:
Path is None
WARNING [05-04 17:44:42] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-04 17:44:42] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(3647, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-04 17:44:42] assert_model_device in utils:
model student_narm has 1.359619140625 MB params.
INFO    [05-04 17:44:42] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-04 17:44:42] __init__ in DistillTrainer:
48128 iter per epoch
INFO    [05-04 17:44:42] _set_current_routine in Routine:
first routine: student
INFO    [05-04 17:44:42] run_routine in Routine:
Start routine student
INFO    [05-04 17:44:42] run_routine in Routine:
Start training
INFO    [05-04 17:44:42] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-04 17:44:45] test_mentor in DistillTrainer:
{'Recall@10': 0.03267505249151817, 'NDCG@10': 0.014886060944543434, 'MRR@10': 0.009547148437167589, 'Recall@5': 0.018231150049429674, 'NDCG@5': 0.010265986972416822, 'MRR@5': 0.007671780114133771, 'Recall*@10': 0.03267505249151817, 'NDCG*@10': 0.014886060944543434, 'MRR*@10': 0.009547148437167589, 'Recall*@5': 0.018231150049429674, 'NDCG*@5': 0.010265986972416822, 'MRR*@5': 0.007671780114133771}
INFO    [05-04 17:44:45] train in DistillTrainer:
result:
{'Recall@10': 0.03267505249151817, 'NDCG@10': 0.014886060944543434, 'MRR@10': 0.009547148437167589, 'Recall@5': 0.018231150049429674, 'NDCG@5': 0.010265986972416822, 'MRR@5': 0.007671780114133771, 'Recall*@10': 0.03267505249151817, 'NDCG*@10': 0.014886060944543434, 'MRR*@10': 0.009547148437167589, 'Recall*@5': 0.018231150049429674, 'NDCG*@5': 0.010265986972416822, 'MRR*@5': 0.007671780114133771}
INFO    [05-04 17:44:47] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-04 17:44:47] validate in BasicTrainer:
{'Recall@10': 0.002403846153846154, 'NDCG@10': 0.0008986420356310331, 'MRR@10': 0.0004532251757784532, 'Recall@5': 0.0009014423076923077, 'NDCG@5': 0.00039589224168314383, 'MRR@5': 0.00023537660196710093, 'Recall*@10': 0.002403846153846154, 'NDCG*@10': 0.0008986420356310331, 'MRR*@10': 0.0004532251757784532, 'Recall*@5': 0.0009014423076923077, 'NDCG*@5': 0.00039589224168314383, 'MRR*@5': 0.00023537660196710093}
INFO    [05-04 17:44:47] train in BasicTrainer:
epoch: 0
DEBUG   [05-04 17:44:47] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 909329
DEBUG   [05-04 17:44:47] calculate_loss in loss:
pred max in softmax: 0.00028099227347411215, argmax 345188
INFO    [05-04 17:44:53] _train_one_epoch in BasicTrainer:
loss = 5.618320898806795
INFO    [05-04 17:44:55] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-04 17:44:55] validate in BasicTrainer:
{'Recall@10': 0.033276014029979706, 'NDCG@10': 0.016086099884257868, 'MRR@10': 0.01094008070560029, 'Recall@5': 0.01943307312635275, 'NDCG@5': 0.011591110915805284, 'MRR@5': 0.009074370752876768, 'Recall*@10': 0.033276014029979706, 'NDCG*@10': 0.016086099884257868, 'MRR*@10': 0.01094008070560029, 'Recall*@5': 0.01943307312635275, 'NDCG*@5': 0.011591110915805284, 'MRR*@5': 0.009074370752876768}
INFO    [05-04 17:44:55] train in BasicTrainer:
duration: 8.058794498443604s
INFO    [05-04 17:44:55] train in BasicTrainer:
epoch: 1
INFO    [05-04 17:45:00] _train_one_epoch in BasicTrainer:
loss = 5.309684573335851
INFO    [05-04 17:45:03] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-04 17:45:03] validate in BasicTrainer:
{'Recall@10': 0.059459491417958185, 'NDCG@10': 0.02810683588568981, 'MRR@10': 0.01866247533605649, 'Recall@5': 0.03371632213775928, 'NDCG@5': 0.019742601192914523, 'MRR@5': 0.015183700033678459, 'Recall*@10': 0.059459491417958185, 'NDCG*@10': 0.02810683588568981, 'MRR*@10': 0.01866247533605649, 'Recall*@5': 0.03371632213775928, 'NDCG*@5': 0.019742601192914523, 'MRR*@5': 0.015183700033678459}
INFO    [05-04 17:45:03] train in BasicTrainer:
duration: 7.785893440246582s
INFO    [05-04 17:45:03] train in BasicTrainer:
epoch: 2
INFO    [05-04 17:45:08] _train_one_epoch in BasicTrainer:
loss = 5.081432674793487
INFO    [05-04 17:45:11] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-04 17:45:11] validate in BasicTrainer:
{'Recall@10': 0.08363778086809012, 'NDCG@10': 0.04274387972859236, 'MRR@10': 0.03042555758013175, 'Recall@5': 0.05116503227215547, 'NDCG@5': 0.032320468758161254, 'MRR@5': 0.02617004055243272, 'Recall*@10': 0.08363778086809012, 'NDCG*@10': 0.04274387972859236, 'MRR*@10': 0.03042555758013175, 'Recall*@5': 0.05116503227215547, 'NDCG*@5': 0.032320468758161254, 'MRR*@5': 0.02617004055243272}
INFO    [05-04 17:45:11] train in BasicTrainer:
duration: 7.8591625690460205s
INFO    [05-04 17:45:11] train in BasicTrainer:
epoch: 3
INFO    [05-04 17:45:16] _train_one_epoch in BasicTrainer:
loss = 4.909982607719746
INFO    [05-04 17:45:18] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-04 17:45:18] validate in BasicTrainer:
{'Recall@10': 0.09896230009885934, 'NDCG@10': 0.050087484602744765, 'MRR@10': 0.03538358068236938, 'Recall@5': 0.05953684305915466, 'NDCG@5': 0.037416560432085626, 'MRR@5': 0.030199507537942667, 'Recall*@10': 0.09896230009885934, 'NDCG*@10': 0.050087484602744765, 'MRR*@10': 0.03538358068236938, 'Recall*@5': 0.05953684305915466, 'NDCG*@5': 0.037416560432085626, 'MRR*@5': 0.030199507537942667}
INFO    [05-04 17:45:18] train in BasicTrainer:
duration: 7.654741287231445s
INFO    [05-04 17:45:18] train in BasicTrainer:
epoch: 4
INFO    [05-04 17:45:24] _train_one_epoch in BasicTrainer:
loss = 4.7886295800513405
INFO    [05-04 17:45:26] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-04 17:45:26] validate in BasicTrainer:
{'Recall@10': 0.12442581355571747, 'NDCG@10': 0.06463525300988784, 'MRR@10': 0.04671977589336725, 'Recall@5': 0.07610493611830932, 'NDCG@5': 0.0490233890998822, 'MRR@5': 0.04028371162712574, 'Recall*@10': 0.12442581355571747, 'NDCG*@10': 0.06463525300988784, 'MRR*@10': 0.04671977589336725, 'Recall*@5': 0.07610493611830932, 'NDCG*@5': 0.0490233890998822, 'MRR*@5': 0.04028371162712574}
INFO    [05-04 17:45:26] train in BasicTrainer:
duration: 7.937775135040283s
INFO    [05-04 17:45:26] train in BasicTrainer:
epoch: 5
DEBUG   [05-04 17:45:28] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 607796
DEBUG   [05-04 17:45:28] calculate_loss in loss:
pred max in softmax: 0.10977064818143845, argmax 218638
DEBUG   [05-04 17:45:28] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 778037
DEBUG   [05-04 17:45:28] calculate_loss in loss:
pred max in softmax: 0.08474411815404892, argmax 843844
INFO    [05-04 17:45:32] _train_one_epoch in BasicTrainer:
loss = 4.700846674594473
INFO    [05-04 17:45:34] validate in BasicTrainer:
{'Recall@10': 0.12290258476367363, 'NDCG@10': 0.06339648251350109, 'MRR@10': 0.045451007496852144, 'Recall@5': 0.07732768471424396, 'NDCG@5': 0.048840638250112534, 'MRR@5': 0.0395468407525466, 'Recall*@10': 0.12290258476367363, 'NDCG*@10': 0.06339648251350109, 'MRR*@10': 0.045451007496852144, 'Recall*@5': 0.07732768471424396, 'NDCG*@5': 0.048840638250112534, 'MRR*@5': 0.0395468407525466}
INFO    [05-04 17:45:34] train in BasicTrainer:
duration: 7.657770156860352s
INFO    [05-04 17:45:34] train in BasicTrainer:
epoch: 6
INFO    [05-04 17:45:39] _train_one_epoch in BasicTrainer:
loss = 4.629355572639628
INFO    [05-04 17:45:42] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-04 17:45:42] validate in BasicTrainer:
{'Recall@10': 0.1340203732252121, 'NDCG@10': 0.07277044424643883, 'MRR@10': 0.054185803406513654, 'Recall@5': 0.08844547317578243, 'NDCG@5': 0.05802912422670768, 'MRR@5': 0.04810166659836586, 'Recall*@10': 0.1340203732252121, 'NDCG*@10': 0.07277044424643883, 'MRR*@10': 0.054185803406513654, 'Recall*@5': 0.08844547317578243, 'NDCG*@5': 0.05802912422670768, 'MRR*@5': 0.04810166659836586}
INFO    [05-04 17:45:42] train in BasicTrainer:
duration: 7.8006932735443115s
INFO    [05-04 17:45:42] train in BasicTrainer:
epoch: 7
INFO    [05-04 17:45:47] _train_one_epoch in BasicTrainer:
loss = 4.572513387558308
INFO    [05-04 17:45:49] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-04 17:45:49] validate in BasicTrainer:
{'Recall@10': 0.14335610201725593, 'NDCG@10': 0.07591770245478703, 'MRR@10': 0.05543243655791649, 'Recall@5': 0.09701958757180434, 'NDCG@5': 0.06111879961994978, 'MRR@5': 0.04943374773630729, 'Recall*@10': 0.14335610201725593, 'NDCG*@10': 0.07591770245478703, 'MRR*@10': 0.05543243655791649, 'Recall*@5': 0.09701958757180434, 'NDCG*@5': 0.06111879961994978, 'MRR*@5': 0.04943374773630729}
INFO    [05-04 17:45:49] train in BasicTrainer:
duration: 7.6531336307525635s
INFO    [05-04 17:45:49] train in BasicTrainer:
epoch: 8
INFO    [05-04 17:45:55] _train_one_epoch in BasicTrainer:
loss = 4.512415365969881
INFO    [05-04 17:45:57] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-04 17:45:57] validate in BasicTrainer:
{'Recall@10': 0.14980602608277246, 'NDCG@10': 0.08149703133564729, 'MRR@10': 0.06083270047719662, 'Recall@5': 0.09579683897586969, 'NDCG@5': 0.06410579641277973, 'MRR@5': 0.05369819442813213, 'Recall*@10': 0.14980602608277246, 'NDCG*@10': 0.08149703133564729, 'MRR*@10': 0.06083270047719662, 'Recall*@5': 0.09579683897586969, 'NDCG*@5': 0.06410579641277973, 'MRR*@5': 0.05369819442813213}
INFO    [05-04 17:45:57] train in BasicTrainer:
duration: 7.9493913650512695s
INFO    [05-04 17:45:57] train in BasicTrainer:
epoch: 9
INFO    [05-04 17:46:03] _train_one_epoch in BasicTrainer:
loss = 4.459519893565076
INFO    [05-04 17:46:05] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-04 17:46:05] validate in BasicTrainer:
{'Recall@10': 0.15840096657092756, 'NDCG@10': 0.08635399433282706, 'MRR@10': 0.06458001182629512, 'Recall@5': 0.10018504812167241, 'NDCG@5': 0.06751982695781268, 'MRR@5': 0.056800932265245, 'Recall*@10': 0.15840096657092756, 'NDCG*@10': 0.08635399433282706, 'MRR*@10': 0.06458001182629512, 'Recall*@5': 0.10018504812167241, 'NDCG*@5': 0.06751982695781268, 'MRR*@5': 0.056800932265245}
INFO    [05-04 17:46:05] train in BasicTrainer:
duration: 7.775136470794678s
INFO    [05-04 17:46:05] train in BasicTrainer:
epoch: 10
DEBUG   [05-04 17:46:09] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 553091
DEBUG   [05-04 17:46:09] calculate_loss in loss:
pred max in softmax: 0.40299978852272034, argmax 270698
DEBUG   [05-04 17:46:09] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 278398
DEBUG   [05-04 17:46:09] calculate_loss in loss:
pred max in softmax: 0.21447324752807617, argmax 330950
INFO    [05-04 17:46:11] _train_one_epoch in BasicTrainer:
loss = 4.409532153860051
INFO    [05-04 17:46:13] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-04 17:46:13] validate in BasicTrainer:
{'Recall@10': 0.16094463949020094, 'NDCG@10': 0.08837117369358356, 'MRR@10': 0.06640119879291607, 'Recall@5': 0.10725675867154048, 'NDCG@5': 0.07119467711219421, 'MRR@5': 0.05942017298478346, 'Recall*@10': 0.16094463949020094, 'NDCG*@10': 0.08837117369358356, 'MRR*@10': 0.06640119879291607, 'Recall*@5': 0.10725675867154048, 'NDCG*@5': 0.07119467711219421, 'MRR*@5': 0.05942017298478346}
INFO    [05-04 17:46:13] train in BasicTrainer:
duration: 7.746753215789795s
INFO    [05-04 17:46:13] train in BasicTrainer:
epoch: 11
INFO    [05-04 17:46:18] _train_one_epoch in BasicTrainer:
loss = 4.365095584950549
INFO    [05-04 17:46:20] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-04 17:46:20] validate in BasicTrainer:
{'Recall@10': 0.1663949443743779, 'NDCG@10': 0.09121693040315922, 'MRR@10': 0.06842478937827624, 'Recall@5': 0.10968143091751979, 'NDCG@5': 0.0728579111970388, 'MRR@5': 0.06083580335745445, 'Recall*@10': 0.1663949443743779, 'NDCG*@10': 0.09121693040315922, 'MRR*@10': 0.06842478937827624, 'Recall*@5': 0.10968143091751979, 'NDCG*@5': 0.0728579111970388, 'MRR*@5': 0.06083580335745445}
INFO    [05-04 17:46:20] train in BasicTrainer:
duration: 7.722541570663452s
INFO    [05-04 17:46:20] train in BasicTrainer:
epoch: 12
INFO    [05-04 17:46:26] _train_one_epoch in BasicTrainer:
loss = 4.333779441549423
INFO    [05-04 17:46:28] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-04 17:46:28] validate in BasicTrainer:
{'Recall@10': 0.17120263668207023, 'NDCG@10': 0.0982521537404794, 'MRR@10': 0.07596832914994313, 'Recall@5': 0.12368502410558554, 'NDCG@5': 0.08301796735479282, 'MRR@5': 0.06976499121922713, 'Recall*@10': 0.17120263668207023, 'NDCG*@10': 0.0982521537404794, 'MRR*@10': 0.07596832914994313, 'Recall*@5': 0.12368502410558554, 'NDCG*@5': 0.08301796735479282, 'MRR*@5': 0.06976499121922713}
INFO    [05-04 17:46:28] train in BasicTrainer:
duration: 7.9898130893707275s
INFO    [05-04 17:46:28] train in BasicTrainer:
epoch: 13
INFO    [05-04 17:46:34] _train_one_epoch in BasicTrainer:
loss = 4.292618624707486
INFO    [05-04 17:46:36] validate in BasicTrainer:
{'Recall@10': 0.17633163470488328, 'NDCG@10': 0.09702495256295571, 'MRR@10': 0.07289540165892014, 'Recall@5': 0.11536973944077125, 'NDCG@5': 0.07718840040839635, 'MRR@5': 0.06463475324786626, 'Recall*@10': 0.17633163470488328, 'NDCG*@10': 0.09702495256295571, 'MRR*@10': 0.07289540165892014, 'Recall*@5': 0.11536973944077125, 'NDCG*@5': 0.07718840040839635, 'MRR*@5': 0.06463475324786626}
INFO    [05-04 17:46:36] train in BasicTrainer:
duration: 7.5698840618133545s
INFO    [05-04 17:46:36] train in BasicTrainer:
epoch: 14
INFO    [05-04 17:46:42] _train_one_epoch in BasicTrainer:
loss = 4.259164269934309
INFO    [05-04 17:46:44] validate in BasicTrainer:
{'Recall@10': 0.17751273283591637, 'NDCG@10': 0.09807858959986614, 'MRR@10': 0.0739020358484525, 'Recall@5': 0.12035891069815709, 'NDCG@5': 0.07980632180204758, 'MRR@5': 0.06648499203416017, 'Recall*@10': 0.17751273283591637, 'NDCG*@10': 0.09807858959986614, 'MRR*@10': 0.0739020358484525, 'Recall*@5': 0.12035891069815709, 'NDCG*@5': 0.07980632180204758, 'MRR*@5': 0.06648499203416017}
INFO    [05-04 17:46:44] train in BasicTrainer:
duration: 7.935601711273193s
INFO    [05-04 17:46:44] train in BasicTrainer:
epoch: 15
DEBUG   [05-04 17:46:49] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 330624
DEBUG   [05-04 17:46:49] calculate_loss in loss:
pred max in softmax: 0.22576865553855896, argmax 105545
DEBUG   [05-04 17:46:49] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 450975
DEBUG   [05-04 17:46:49] calculate_loss in loss:
pred max in softmax: 0.40447139739990234, argmax 401798
INFO    [05-04 17:46:50] _train_one_epoch in BasicTrainer:
loss = 4.226256228507833
INFO    [05-04 17:46:52] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-04 17:46:52] validate in BasicTrainer:
{'Recall@10': 0.1781345193202679, 'NDCG@10': 0.09945119745456256, 'MRR@10': 0.0754489592061593, 'Recall@5': 0.12037973564404708, 'NDCG@5': 0.0808289535343647, 'MRR@5': 0.06779679369467956, 'Recall*@10': 0.1781345193202679, 'NDCG*@10': 0.09945119745456256, 'MRR*@10': 0.0754489592061593, 'Recall*@5': 0.12037973564404708, 'NDCG*@5': 0.0808289535343647, 'MRR*@5': 0.06779679369467956}
INFO    [05-04 17:46:52] train in BasicTrainer:
duration: 7.956540107727051s
INFO    [05-04 17:46:52] train in BasicTrainer:
epoch: 16
INFO    [05-04 17:46:58] _train_one_epoch in BasicTrainer:
loss = 4.19667478952002
INFO    [05-04 17:47:00] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-04 17:47:00] validate in BasicTrainer:
{'Recall@10': 0.1797975771702253, 'NDCG@10': 0.10275585720172295, 'MRR@10': 0.07917354055322133, 'Recall@5': 0.12895385118631217, 'NDCG@5': 0.08640776058802238, 'MRR@5': 0.07248211164887135, 'Recall*@10': 0.1797975771702253, 'NDCG*@10': 0.10275585720172295, 'MRR*@10': 0.07917354055322133, 'Recall*@5': 0.12895385118631217, 'NDCG*@5': 0.08640776058802238, 'MRR*@5': 0.07248211164887135}
INFO    [05-04 17:47:00] train in BasicTrainer:
duration: 7.826356410980225s
INFO    [05-04 17:47:00] train in BasicTrainer:
epoch: 17
INFO    [05-04 17:47:05] _train_one_epoch in BasicTrainer:
loss = 4.163529521607338
INFO    [05-04 17:47:07] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-04 17:47:08] validate in BasicTrainer:
{'Recall@10': 0.1832843445814573, 'NDCG@10': 0.10521980088490707, 'MRR@10': 0.08140493442232792, 'Recall@5': 0.1271301404787944, 'NDCG@5': 0.08706154731603769, 'MRR@5': 0.07391281569233307, 'Recall*@10': 0.1832843445814573, 'NDCG*@10': 0.10521980088490707, 'MRR*@10': 0.08140493442232792, 'Recall*@5': 0.1271301404787944, 'NDCG*@5': 0.08706154731603769, 'MRR*@5': 0.07391281569233307}
INFO    [05-04 17:47:08] train in BasicTrainer:
duration: 7.837840795516968s
INFO    [05-04 17:47:08] train in BasicTrainer:
epoch: 18
INFO    [05-04 17:47:13] _train_one_epoch in BasicTrainer:
loss = 4.13599154416551
INFO    [05-04 17:47:16] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-04 17:47:16] validate in BasicTrainer:
{'Recall@10': 0.18927313272769636, 'NDCG@10': 0.10789548491056149, 'MRR@10': 0.08323310086360344, 'Recall@5': 0.12983446740187132, 'NDCG@5': 0.08890960078973037, 'MRR@5': 0.07553387404634403, 'Recall*@10': 0.18927313272769636, 'NDCG*@10': 0.10789548491056149, 'MRR*@10': 0.08323310086360344, 'Recall*@5': 0.12983446740187132, 'NDCG*@5': 0.08890960078973037, 'MRR*@5': 0.07553387404634403}
INFO    [05-04 17:47:16] train in BasicTrainer:
duration: 8.043942928314209s
INFO    [05-04 17:47:16] train in BasicTrainer:
epoch: 19
INFO    [05-04 17:47:21] _train_one_epoch in BasicTrainer:
loss = 4.1095836289385534
INFO    [05-04 17:47:24] validate in BasicTrainer:
{'Recall@10': 0.18853234557005075, 'NDCG@10': 0.1068319919017645, 'MRR@10': 0.08203670840996963, 'Recall@5': 0.1301141232252121, 'NDCG@5': 0.08811862537494072, 'MRR@5': 0.07441629584019001, 'Recall*@10': 0.18853234557005075, 'NDCG*@10': 0.1068319919017645, 'MRR*@10': 0.08203670840996963, 'Recall*@5': 0.1301141232252121, 'NDCG*@5': 0.08811862537494072, 'MRR*@5': 0.07441629584019001}
INFO    [05-04 17:47:24] train in BasicTrainer:
duration: 7.90999174118042s
INFO    [05-04 17:47:24] train in BasicTrainer:
epoch: 20
INFO    [05-04 17:47:29] _train_one_epoch in BasicTrainer:
loss = 4.087196002615259
INFO    [05-04 17:47:31] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-04 17:47:32] validate in BasicTrainer:
{'Recall@10': 0.1934798634969271, 'NDCG@10': 0.1120930165052414, 'MRR@10': 0.08749781434352581, 'Recall@5': 0.13029560102866247, 'NDCG@5': 0.09181382850958751, 'MRR@5': 0.07921605385266818, 'Recall*@10': 0.1934798634969271, 'NDCG*@10': 0.1120930165052414, 'MRR*@10': 0.08749781434352581, 'Recall*@5': 0.13029560102866247, 'NDCG*@5': 0.09181382850958751, 'MRR*@5': 0.07921605385266818}
INFO    [05-04 17:47:32] train in BasicTrainer:
duration: 8.017461776733398s
INFO    [05-04 17:47:32] train in BasicTrainer:
epoch: 21
DEBUG   [05-04 17:47:33] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 117930
DEBUG   [05-04 17:47:33] calculate_loss in loss:
pred max in softmax: 0.391704797744751, argmax 530109
DEBUG   [05-04 17:47:33] calculate_loss in loss:
soft_target max: 0.501916766166687, argmax 29774
DEBUG   [05-04 17:47:33] calculate_loss in loss:
pred max in softmax: 0.400318443775177, argmax 306370
INFO    [05-04 17:47:37] _train_one_epoch in BasicTrainer:
loss = 4.0632727234921555
INFO    [05-04 17:47:39] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-04 17:47:39] validate in BasicTrainer:
{'Recall@10': 0.19317938272769636, 'NDCG@10': 0.11379100382328033, 'MRR@10': 0.08952806832698676, 'Recall@5': 0.13965215591283944, 'NDCG@5': 0.0966285255092841, 'MRR@5': 0.08252976978054413, 'Recall*@10': 0.19317938272769636, 'NDCG*@10': 0.11379100382328033, 'MRR*@10': 0.08952806832698676, 'Recall*@5': 0.13965215591283944, 'NDCG*@5': 0.0966285255092841, 'MRR*@5': 0.08252976978054413}
INFO    [05-04 17:47:39] train in BasicTrainer:
duration: 7.675015687942505s
INFO    [05-04 17:47:39] train in BasicTrainer:
epoch: 22
INFO    [05-04 17:47:45] _train_one_epoch in BasicTrainer:
loss = 4.041531632555292
INFO    [05-04 17:47:47] validate in BasicTrainer:
{'Recall@10': 0.1925784211892348, 'NDCG@10': 0.11267995719726269, 'MRR@10': 0.08828957493488605, 'Recall@5': 0.1355644281093891, 'NDCG@5': 0.09421720470373447, 'MRR@5': 0.08065295706574734, 'Recall*@10': 0.1925784211892348, 'NDCG*@10': 0.11267995719726269, 'MRR*@10': 0.08828957493488605, 'Recall*@5': 0.1355644281093891, 'NDCG*@5': 0.09421720470373447, 'MRR*@5': 0.08065295706574734}
INFO    [05-04 17:47:47] train in BasicTrainer:
duration: 7.872594356536865s
INFO    [05-04 17:47:47] train in BasicTrainer:
epoch: 23
INFO    [05-04 17:47:53] _train_one_epoch in BasicTrainer:
loss = 4.020934040242053
INFO    [05-04 17:47:55] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-04 17:47:55] validate in BasicTrainer:
{'Recall@10': 0.1939409994162046, 'NDCG@10': 0.11464934910719211, 'MRR@10': 0.09032841542592415, 'Recall@5': 0.142175005032466, 'NDCG@5': 0.09784129720467788, 'MRR@5': 0.08335078794222611, 'Recall*@10': 0.1939409994162046, 'NDCG*@10': 0.11464934910719211, 'MRR*@10': 0.09032841542592415, 'Recall*@5': 0.142175005032466, 'NDCG*@5': 0.09784129720467788, 'MRR*@5': 0.08335078794222611}
INFO    [05-04 17:47:55] train in BasicTrainer:
duration: 7.753506660461426s
INFO    [05-04 17:47:55] train in BasicTrainer:
epoch: 24
INFO    [05-04 17:48:00] _train_one_epoch in BasicTrainer:
loss = 3.9991130410356726
INFO    [05-04 17:48:03] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-04 17:48:03] validate in BasicTrainer:
{'Recall@10': 0.19710645996607268, 'NDCG@10': 0.11596963382684268, 'MRR@10': 0.09116877271578862, 'Recall@5': 0.14159486843989447, 'NDCG@5': 0.09805921637094937, 'MRR@5': 0.08379992097616196, 'Recall*@10': 0.19710645996607268, 'NDCG*@10': 0.11596963382684268, 'MRR*@10': 0.09116877271578862, 'Recall*@5': 0.14159486843989447, 'NDCG*@5': 0.09805921637094937, 'MRR*@5': 0.08379992097616196}
INFO    [05-04 17:48:03] train in BasicTrainer:
duration: 7.899892807006836s
INFO    [05-04 17:48:03] train in BasicTrainer:
epoch: 25
INFO    [05-04 17:48:08] _train_one_epoch in BasicTrainer:
loss = 3.9780314019385803
INFO    [05-04 17:48:10] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-04 17:48:10] validate in BasicTrainer:
{'Recall@10': 0.1986088638122265, 'NDCG@10': 0.1172857118340639, 'MRR@10': 0.0923680175955479, 'Recall@5': 0.14187452426323524, 'NDCG@5': 0.09886106906028894, 'MRR@5': 0.08471683642038932, 'Recall*@10': 0.1986088638122265, 'NDCG*@10': 0.1172857118340639, 'MRR*@10': 0.0923680175955479, 'Recall*@5': 0.14187452426323524, 'NDCG*@5': 0.09886106906028894, 'MRR*@5': 0.08471683642038932}
INFO    [05-04 17:48:10] train in BasicTrainer:
duration: 7.6576478481292725s
INFO    [05-04 17:48:10] train in BasicTrainer:
epoch: 26
DEBUG   [05-04 17:48:14] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 37696
DEBUG   [05-04 17:48:14] calculate_loss in loss:
pred max in softmax: 0.46359387040138245, argmax 866390
DEBUG   [05-04 17:48:14] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 628510
DEBUG   [05-04 17:48:14] calculate_loss in loss:
pred max in softmax: 0.515855610370636, argmax 363971
INFO    [05-04 17:48:16] _train_one_epoch in BasicTrainer:
loss = 3.9613785008166698
INFO    [05-04 17:48:18] validate in BasicTrainer:
{'Recall@10': 0.19678515195846558, 'NDCG@10': 0.11578811819736774, 'MRR@10': 0.0908211819254435, 'Recall@5': 0.14381723564404708, 'NDCG@5': 0.09855721317804776, 'MRR@5': 0.08365082282286423, 'Recall*@10': 0.19678515195846558, 'NDCG*@10': 0.11578811819736774, 'MRR*@10': 0.0908211819254435, 'Recall*@5': 0.14381723564404708, 'NDCG*@5': 0.09855721317804776, 'MRR*@5': 0.08365082282286423}
INFO    [05-04 17:48:18] train in BasicTrainer:
duration: 7.838754177093506s
INFO    [05-04 17:48:18] train in BasicTrainer:
epoch: 27
INFO    [05-04 17:48:24] _train_one_epoch in BasicTrainer:
loss = 3.9410521540235965
INFO    [05-04 17:48:26] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-04 17:48:26] validate in BasicTrainer:
{'Recall@10': 0.20025109557005075, 'NDCG@10': 0.1201752842618869, 'MRR@10': 0.09566100744100717, 'Recall@5': 0.14503998481310332, 'NDCG@5': 0.10232860594987869, 'MRR@5': 0.08830212629758395, 'Recall*@10': 0.20025109557005075, 'NDCG*@10': 0.1201752842618869, 'MRR*@10': 0.09566100744100717, 'Recall*@5': 0.14503998481310332, 'NDCG*@5': 0.10232860594987869, 'MRR*@5': 0.08830212629758395}
INFO    [05-04 17:48:26] train in BasicTrainer:
duration: 7.963610887527466s
INFO    [05-04 17:48:26] train in BasicTrainer:
epoch: 28
INFO    [05-04 17:48:32] _train_one_epoch in BasicTrainer:
loss = 3.9274970039408257
INFO    [05-04 17:48:34] validate in BasicTrainer:
{'Recall@10': 0.20369620965077326, 'NDCG@10': 0.12011070262927276, 'MRR@10': 0.0946288057244741, 'Recall@5': 0.1423356578900264, 'NDCG@5': 0.10021088558893937, 'MRR@5': 0.08638212314018837, 'Recall*@10': 0.20369620965077326, 'NDCG*@10': 0.12011070262927276, 'MRR*@10': 0.0946288057244741, 'Recall*@5': 0.1423356578900264, 'NDCG*@5': 0.10021088558893937, 'MRR*@5': 0.08638212314018837}
INFO    [05-04 17:48:34] train in BasicTrainer:
duration: 7.857496023178101s
INFO    [05-04 17:48:34] train in BasicTrainer:
epoch: 29
INFO    [05-04 17:48:40] _train_one_epoch in BasicTrainer:
loss = 3.9106590709787734
INFO    [05-04 17:48:42] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-04 17:48:42] validate in BasicTrainer:
{'Recall@10': 0.20191415227376497, 'NDCG@10': 0.12244562976635419, 'MRR@10': 0.09811625916224259, 'Recall@5': 0.1456201202594317, 'NDCG@5': 0.10421613317269546, 'MRR@5': 0.09058037514869983, 'Recall*@10': 0.20191415227376497, 'NDCG*@10': 0.12244562976635419, 'MRR*@10': 0.09811625916224259, 'Recall*@5': 0.1456201202594317, 'NDCG*@5': 0.10421613317269546, 'MRR*@5': 0.09058037514869983}
INFO    [05-04 17:48:42] train in BasicTrainer:
duration: 7.842733383178711s
INFO    [05-04 17:48:42] train in BasicTrainer:
epoch: 30
INFO    [05-04 17:48:48] _train_one_epoch in BasicTrainer:
loss = 3.889722264827566
INFO    [05-04 17:48:50] validate in BasicTrainer:
{'Recall@10': 0.19990896261655366, 'NDCG@10': 0.12238350052099961, 'MRR@10': 0.09865226711218174, 'Recall@5': 0.14758365887861985, 'NDCG@5': 0.10554216171686466, 'MRR@5': 0.0917460505778973, 'Recall*@10': 0.19990896261655366, 'NDCG*@10': 0.12238350052099961, 'MRR*@10': 0.09865226711218174, 'Recall*@5': 0.14758365887861985, 'NDCG*@5': 0.10554216171686466, 'MRR*@5': 0.0917460505778973}
INFO    [05-04 17:48:50] train in BasicTrainer:
duration: 7.75911283493042s
INFO    [05-04 17:48:50] train in BasicTrainer:
epoch: 31
DEBUG   [05-04 17:48:55] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 562864
DEBUG   [05-04 17:48:55] calculate_loss in loss:
pred max in softmax: 0.3071306347846985, argmax 756552
DEBUG   [05-04 17:48:55] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 12167
DEBUG   [05-04 17:48:55] calculate_loss in loss:
pred max in softmax: 0.24262668192386627, argmax 424181
INFO    [05-04 17:48:55] _train_one_epoch in BasicTrainer:
loss = 3.8766135383159557
INFO    [05-04 17:48:57] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-04 17:48:58] validate in BasicTrainer:
{'Recall@10': 0.20656119172389692, 'NDCG@10': 0.12389055926066178, 'MRR@10': 0.0984689610508772, 'Recall@5': 0.15044863865925714, 'NDCG@5': 0.1056924915084472, 'MRR@5': 0.09092439195284477, 'Recall*@10': 0.20656119172389692, 'NDCG*@10': 0.12389055926066178, 'MRR*@10': 0.0984689610508772, 'Recall*@5': 0.15044863865925714, 'NDCG*@5': 0.1056924915084472, 'MRR*@5': 0.09092439195284477}
INFO    [05-04 17:48:58] train in BasicTrainer:
duration: 7.833570241928101s
INFO    [05-04 17:48:58] train in BasicTrainer:
epoch: 32
INFO    [05-04 17:49:03] _train_one_epoch in BasicTrainer:
loss = 3.8573054087922927
INFO    [05-04 17:49:05] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-04 17:49:05] validate in BasicTrainer:
{'Recall@10': 0.2095659994162046, 'NDCG@10': 0.1250554988017449, 'MRR@10': 0.09941033101998843, 'Recall@5': 0.14774431173618024, 'NDCG@5': 0.10534090720690213, 'MRR@5': 0.09143168880389287, 'Recall*@10': 0.2095659994162046, 'NDCG*@10': 0.1250554988017449, 'MRR*@10': 0.09941033101998843, 'Recall*@5': 0.14774431173618024, 'NDCG*@5': 0.10534090720690213, 'MRR*@5': 0.09143168880389287}
INFO    [05-04 17:49:05] train in BasicTrainer:
duration: 7.795690298080444s
INFO    [05-04 17:49:05] train in BasicTrainer:
epoch: 33
INFO    [05-04 17:49:11] _train_one_epoch in BasicTrainer:
loss = 3.8427049809313836
INFO    [05-04 17:49:13] validate in BasicTrainer:
{'Recall@10': 0.20584122721965498, 'NDCG@10': 0.12213720266635601, 'MRR@10': 0.09659011318133427, 'Recall@5': 0.1509097722860483, 'NDCG@5': 0.10451969618980701, 'MRR@5': 0.08940379092326531, 'Recall*@10': 0.20584122721965498, 'NDCG*@10': 0.12213720266635601, 'MRR*@10': 0.09659011318133427, 'Recall*@5': 0.1509097722860483, 'NDCG*@5': 0.10451969618980701, 'MRR*@5': 0.08940379092326531}
INFO    [05-04 17:49:13] train in BasicTrainer:
duration: 7.83999490737915s
INFO    [05-04 17:49:13] train in BasicTrainer:
epoch: 34
INFO    [05-04 17:49:19] _train_one_epoch in BasicTrainer:
loss = 3.8226246199709304
INFO    [05-04 17:49:21] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-04 17:49:21] validate in BasicTrainer:
{'Recall@10': 0.2095659994162046, 'NDCG@10': 0.1254510862322954, 'MRR@10': 0.09969559025305968, 'Recall@5': 0.15253117795173937, 'NDCG@5': 0.10711560054467274, 'MRR@5': 0.09218467600070514, 'Recall*@10': 0.2095659994162046, 'NDCG*@10': 0.1254510862322954, 'MRR*@10': 0.09969559025305968, 'Recall*@5': 0.15253117795173937, 'NDCG*@5': 0.10711560054467274, 'MRR*@5': 0.09218467600070514}
INFO    [05-04 17:49:21] train in BasicTrainer:
duration: 7.8063249588012695s
INFO    [05-04 17:49:21] train in BasicTrainer:
epoch: 35
INFO    [05-04 17:49:27] _train_one_epoch in BasicTrainer:
loss = 3.813852660199429
INFO    [05-04 17:49:29] validate in BasicTrainer:
{'Recall@10': 0.20610005580461943, 'NDCG@10': 0.12389209121465683, 'MRR@10': 0.09857280896260188, 'Recall@5': 0.1546761943743779, 'NDCG@5': 0.10735832212062982, 'MRR@5': 0.09180813225416037, 'Recall*@10': 0.20610005580461943, 'NDCG*@10': 0.12389209121465683, 'MRR*@10': 0.09857280896260188, 'Recall*@5': 0.1546761943743779, 'NDCG*@5': 0.10735832212062982, 'MRR*@5': 0.09180813225416037}
INFO    [05-04 17:49:29] train in BasicTrainer:
duration: 7.7360169887542725s
INFO    [05-04 17:49:29] train in BasicTrainer:
epoch: 36
INFO    [05-04 17:49:34] _train_one_epoch in BasicTrainer:
loss = 3.7948470356616566
INFO    [05-04 17:49:37] validate in BasicTrainer:
{'Recall@10': 0.20459765195846558, 'NDCG@10': 0.12539285249434984, 'MRR@10': 0.10103655835756889, 'Recall@5': 0.1534326202594317, 'NDCG@5': 0.10892708198382305, 'MRR@5': 0.09428635468849769, 'Recall*@10': 0.20459765195846558, 'NDCG*@10': 0.12539285249434984, 'MRR*@10': 0.10103655835756889, 'Recall*@5': 0.1534326202594317, 'NDCG*@5': 0.10892708198382305, 'MRR*@5': 0.09428635468849769}
INFO    [05-04 17:49:37] train in BasicTrainer:
duration: 7.850765943527222s
INFO    [05-04 17:49:37] train in BasicTrainer:
epoch: 37
DEBUG   [05-04 17:49:38] calculate_loss in loss:
soft_target max: 0.501916766166687, argmax 325181
DEBUG   [05-04 17:49:38] calculate_loss in loss:
pred max in softmax: 0.4695124924182892, argmax 76536
DEBUG   [05-04 17:49:38] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 635804
DEBUG   [05-04 17:49:38] calculate_loss in loss:
pred max in softmax: 0.5146090388298035, argmax 209895
INFO    [05-04 17:49:42] _train_one_epoch in BasicTrainer:
loss = 3.7818046009286923
INFO    [05-04 17:49:44] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [05-04 17:49:44] validate in BasicTrainer:
{'Recall@10': 0.20686167249312767, 'NDCG@10': 0.12545573654083106, 'MRR@10': 0.10048317909240723, 'Recall@5': 0.15253117795173937, 'NDCG@5': 0.10794214216562417, 'MRR@5': 0.09328817346921334, 'Recall*@10': 0.20686167249312767, 'NDCG*@10': 0.12545573654083106, 'MRR*@10': 0.10048317909240723, 'Recall*@5': 0.15253117795173937, 'NDCG*@5': 0.10794214216562417, 'MRR*@5': 0.09328817346921334}
INFO    [05-04 17:49:44] train in BasicTrainer:
duration: 7.919100046157837s
INFO    [05-04 17:49:44] train in BasicTrainer:
epoch: 38
INFO    [05-04 17:49:50] _train_one_epoch in BasicTrainer:
loss = 3.770299014892984
INFO    [05-04 17:49:52] validate in BasicTrainer:
{'Recall@10': 0.20744180793945605, 'NDCG@10': 0.12493802664371637, 'MRR@10': 0.09967287285969807, 'Recall@5': 0.15165056173618024, 'NDCG@5': 0.10700038992441617, 'MRR@5': 0.0923273775439996, 'Recall*@10': 0.20744180793945605, 'NDCG*@10': 0.12493802664371637, 'MRR*@10': 0.09967287285969807, 'Recall*@5': 0.15165056173618024, 'NDCG*@5': 0.10700038992441617, 'MRR*@5': 0.0923273775439996}
INFO    [05-04 17:49:52] train in BasicTrainer:
duration: 7.782215356826782s
INFO    [05-04 17:49:52] train in BasicTrainer:
epoch: 39
INFO    [05-04 17:49:58] _train_one_epoch in BasicTrainer:
loss = 3.755808191096529
INFO    [05-04 17:50:00] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [05-04 17:50:00] validate in BasicTrainer:
{'Recall@10': 0.2125916320544023, 'NDCG@10': 0.12751584672010863, 'MRR@10': 0.10134496826391953, 'Recall@5': 0.1587222722860483, 'NDCG@5': 0.11019054914896305, 'MRR@5': 0.09424812690569805, 'Recall*@10': 0.2125916320544023, 'NDCG*@10': 0.12751584672010863, 'MRR*@10': 0.10134496826391953, 'Recall*@5': 0.1587222722860483, 'NDCG*@5': 0.11019054914896305, 'MRR*@5': 0.09424812690569805}
INFO    [05-04 17:50:00] train in BasicTrainer:
duration: 7.896668195724487s
INFO    [05-04 17:50:00] train in BasicTrainer:
epoch: 40
INFO    [05-04 17:50:06] _train_one_epoch in BasicTrainer:
loss = 3.7411742857161987
INFO    [05-04 17:50:08] validate in BasicTrainer:
{'Recall@10': 0.2115295368891496, 'NDCG@10': 0.12742629303381994, 'MRR@10': 0.10160275032887092, 'Recall@5': 0.15740134624334481, 'NDCG@5': 0.11001728360469525, 'MRR@5': 0.09447234582442504, 'Recall*@10': 0.2115295368891496, 'NDCG*@10': 0.12742629303381994, 'MRR*@10': 0.10160275032887092, 'Recall*@5': 0.15740134624334481, 'NDCG*@5': 0.11001728360469525, 'MRR*@5': 0.09447234582442504}
INFO    [05-04 17:50:08] train in BasicTrainer:
duration: 7.668813228607178s
INFO    [05-04 17:50:08] train in BasicTrainer:
epoch: 41
INFO    [05-04 17:50:13] _train_one_epoch in BasicTrainer:
loss = 3.737729167684596
INFO    [05-04 17:50:16] validate in BasicTrainer:
{'Recall@10': 0.2122911512851715, 'NDCG@10': 0.12584831279057723, 'MRR@10': 0.09939999763782208, 'Recall@5': 0.15239135118631217, 'NDCG@5': 0.10657505862987958, 'MRR@5': 0.09150363504886627, 'Recall*@10': 0.2122911512851715, 'NDCG*@10': 0.12584831279057723, 'MRR*@10': 0.09939999763782208, 'Recall*@5': 0.15239135118631217, 'NDCG*@5': 0.10657505862987958, 'MRR*@5': 0.09150363504886627}
INFO    [05-04 17:50:16] train in BasicTrainer:
duration: 7.764845132827759s
INFO    [05-04 17:50:16] train in BasicTrainer:
epoch: 42
DEBUG   [05-04 17:50:19] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 498386
DEBUG   [05-04 17:50:19] calculate_loss in loss:
pred max in softmax: 0.7144238352775574, argmax 319885
DEBUG   [05-04 17:50:19] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 848498
DEBUG   [05-04 17:50:19] calculate_loss in loss:
pred max in softmax: 0.6281611919403076, argmax 87346
INFO    [05-04 17:50:21] _train_one_epoch in BasicTrainer:
loss = 3.7227384181732828
INFO    [05-04 17:50:23] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-04 17:50:23] validate in BasicTrainer:
{'Recall@10': 0.21245180414273188, 'NDCG@10': 0.12881381121965554, 'MRR@10': 0.10303508719572654, 'Recall@5': 0.16158725206668562, 'NDCG@5': 0.11238749841084847, 'MRR@5': 0.09626858394879562, 'Recall*@10': 0.21245180414273188, 'NDCG*@10': 0.12881381121965554, 'MRR*@10': 0.10303508719572654, 'Recall*@5': 0.16158725206668562, 'NDCG*@5': 0.11238749841084847, 'MRR*@5': 0.09626858394879562}
INFO    [05-04 17:50:23] train in BasicTrainer:
duration: 7.7105607986450195s
INFO    [05-04 17:50:23] train in BasicTrainer:
epoch: 43
INFO    [05-04 17:50:29] _train_one_epoch in BasicTrainer:
loss = 3.7080836105853954
INFO    [05-04 17:50:31] validate in BasicTrainer:
{'Recall@10': 0.21108922820824844, 'NDCG@10': 0.12822708430198523, 'MRR@10': 0.10278865007253793, 'Recall@5': 0.157800005032466, 'NDCG@5': 0.11100798157545236, 'MRR@5': 0.09568894654512405, 'Recall*@10': 0.21108922820824844, 'NDCG*@10': 0.12822708430198523, 'MRR*@10': 0.10278865007253793, 'Recall*@5': 0.157800005032466, 'NDCG*@5': 0.11100798157545236, 'MRR*@5': 0.09568894654512405}
INFO    [05-04 17:50:31] train in BasicTrainer:
duration: 7.665765762329102s
INFO    [05-04 17:50:31] train in BasicTrainer:
epoch: 44
INFO    [05-04 17:50:37] _train_one_epoch in BasicTrainer:
loss = 3.701226995346394
INFO    [05-04 17:50:39] validate in BasicTrainer:
{'Recall@10': 0.21317176864697382, 'NDCG@10': 0.12819232046604156, 'MRR@10': 0.10221641396100704, 'Recall@5': 0.1513292548748163, 'NDCG@5': 0.10818678771074001, 'MRR@5': 0.09395552770449565, 'Recall*@10': 0.21317176864697382, 'NDCG*@10': 0.12819232046604156, 'MRR*@10': 0.10221641396100704, 'Recall*@5': 0.1513292548748163, 'NDCG*@5': 0.10818678771074001, 'MRR*@5': 0.09395552770449565}
INFO    [05-04 17:50:39] train in BasicTrainer:
duration: 7.7841575145721436s
INFO    [05-04 17:50:39] train in BasicTrainer:
epoch: 45
INFO    [05-04 17:50:44] _train_one_epoch in BasicTrainer:
loss = 3.6893873810768127
INFO    [05-04 17:50:47] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-04 17:50:47] validate in BasicTrainer:
{'Recall@10': 0.21178836547411406, 'NDCG@10': 0.1301785885141446, 'MRR@10': 0.10518683894322468, 'Recall@5': 0.1540544078900264, 'NDCG@5': 0.11157446010754658, 'MRR@5': 0.09754552978735703, 'Recall*@10': 0.21178836547411406, 'NDCG*@10': 0.1301785885141446, 'MRR*@10': 0.10518683894322468, 'Recall*@5': 0.1540544078900264, 'NDCG*@5': 0.11157446010754658, 'MRR*@5': 0.09754552978735703}
INFO    [05-04 17:50:47] train in BasicTrainer:
duration: 7.918152570724487s
INFO    [05-04 17:50:47] train in BasicTrainer:
epoch: 46
INFO    [05-04 17:50:52] _train_one_epoch in BasicTrainer:
loss = 3.6778583843657313
INFO    [05-04 17:50:54] validate in BasicTrainer:
{'Recall@10': 0.2106280945814573, 'NDCG@10': 0.12842358304904058, 'MRR@10': 0.10321820068817872, 'Recall@5': 0.15675873481310332, 'NDCG@5': 0.11112970801500174, 'MRR@5': 0.09615171700716019, 'Recall*@10': 0.2106280945814573, 'NDCG*@10': 0.12842358304904058, 'MRR*@10': 0.10321820068817872, 'Recall*@5': 0.15675873481310332, 'NDCG*@5': 0.11112970801500174, 'MRR*@5': 0.09615171700716019}
INFO    [05-04 17:50:54] train in BasicTrainer:
duration: 7.733232021331787s
INFO    [05-04 17:50:54] train in BasicTrainer:
epoch: 47
DEBUG   [05-04 17:50:59] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 533688
DEBUG   [05-04 17:50:59] calculate_loss in loss:
pred max in softmax: 0.7978513240814209, argmax 737768
DEBUG   [05-04 17:50:59] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 292986
DEBUG   [05-04 17:50:59] calculate_loss in loss:
pred max in softmax: 0.3940633535385132, argmax 409690
INFO    [05-04 17:51:00] _train_one_epoch in BasicTrainer:
loss = 3.666427343449694
INFO    [05-04 17:51:02] validate in BasicTrainer:
{'Recall@10': 0.2110475771702253, 'NDCG@10': 0.1289592207624362, 'MRR@10': 0.1038117787012687, 'Recall@5': 0.15541698382450983, 'NDCG@5': 0.1110452780356774, 'MRR@5': 0.09646211335292229, 'Recall*@10': 0.2110475771702253, 'NDCG*@10': 0.1289592207624362, 'MRR*@10': 0.1038117787012687, 'Recall*@5': 0.15541698382450983, 'NDCG*@5': 0.1110452780356774, 'MRR*@5': 0.09646211335292229}
INFO    [05-04 17:51:02] train in BasicTrainer:
duration: 7.815650701522827s
INFO    [05-04 17:51:02] train in BasicTrainer:
epoch: 48
INFO    [05-04 17:51:08] _train_one_epoch in BasicTrainer:
loss = 3.6531617857040244
INFO    [05-04 17:51:10] validate in BasicTrainer:
{'Recall@10': 0.20774228870868683, 'NDCG@10': 0.12735845721684969, 'MRR@10': 0.10255622863769531, 'Recall@5': 0.15569663964785063, 'NDCG@5': 0.11051523972016114, 'MRR@5': 0.0955993985900512, 'Recall*@10': 0.20774228870868683, 'NDCG*@10': 0.12735845721684969, 'MRR*@10': 0.10255622863769531, 'Recall*@5': 0.15569663964785063, 'NDCG*@5': 0.11051523972016114, 'MRR*@5': 0.0955993985900512}
INFO    [05-04 17:51:10] train in BasicTrainer:
duration: 7.88495659828186s
INFO    [05-04 17:51:10] train in BasicTrainer:
epoch: 49
INFO    [05-04 17:51:16] _train_one_epoch in BasicTrainer:
loss = 3.6451848047844906
INFO    [05-04 17:51:18] validate in BasicTrainer:
{'Recall@10': 0.21134805793945605, 'NDCG@10': 0.12963416484686044, 'MRR@10': 0.10447600655830823, 'Recall@5': 0.16052515690143293, 'NDCG@5': 0.11340468606123558, 'MRR@5': 0.09790214208456186, 'Recall*@10': 0.21134805793945605, 'NDCG*@10': 0.12963416484686044, 'MRR*@10': 0.10447600655830823, 'Recall*@5': 0.16052515690143293, 'NDCG*@5': 0.11340468606123558, 'MRR*@5': 0.09790214208456186}
INFO    [05-04 17:51:18] train in BasicTrainer:
duration: 7.76943039894104s
INFO    [05-04 17:51:18] train in BasicTrainer:
epoch: 50
INFO    [05-04 17:51:23] _train_one_epoch in BasicTrainer:
loss = 3.6474129874655543
INFO    [05-04 17:51:26] validate in BasicTrainer:
{'Recall@10': 0.21014613486253297, 'NDCG@10': 0.12735940229434234, 'MRR@10': 0.10178527006736168, 'Recall@5': 0.15842179151681754, 'NDCG@5': 0.110600135074212, 'MRR@5': 0.09484973148657726, 'Recall*@10': 0.21014613486253297, 'NDCG*@10': 0.12735940229434234, 'MRR*@10': 0.10178527006736168, 'Recall*@5': 0.15842179151681754, 'NDCG*@5': 0.110600135074212, 'MRR*@5': 0.09484973148657726}
INFO    [05-04 17:51:26] train in BasicTrainer:
duration: 7.674643039703369s
INFO    [05-04 17:51:26] train in BasicTrainer:
epoch: 51
INFO    [05-04 17:51:31] _train_one_epoch in BasicTrainer:
loss = 3.6296073160272964
INFO    [05-04 17:51:33] validate in BasicTrainer:
{'Recall@10': 0.2112082288815425, 'NDCG@10': 0.12949596173488176, 'MRR@10': 0.10435713426424907, 'Recall@5': 0.1580796597095636, 'NDCG@5': 0.11245937301562382, 'MRR@5': 0.0974089251114772, 'Recall*@10': 0.2112082288815425, 'NDCG*@10': 0.12949596173488176, 'MRR*@10': 0.10435713426424907, 'Recall*@5': 0.1580796597095636, 'NDCG*@5': 0.11245937301562382, 'MRR*@5': 0.0974089251114772}
INFO    [05-04 17:51:33] train in BasicTrainer:
duration: 7.646820783615112s
INFO    [05-04 17:51:33] train in BasicTrainer:
epoch: 52
INFO    [05-04 17:51:39] _train_one_epoch in BasicTrainer:
loss = 3.6194359977194606
INFO    [05-04 17:51:41] log in loggers:
Update Best NDCG@10 Model at 52
INFO    [05-04 17:51:41] validate in BasicTrainer:
{'Recall@10': 0.21317176864697382, 'NDCG@10': 0.1312464830967096, 'MRR@10': 0.10607215189016782, 'Recall@5': 0.1587014473401583, 'NDCG@5': 0.11387997292555295, 'MRR@5': 0.09904783505659837, 'Recall*@10': 0.21317176864697382, 'NDCG*@10': 0.1312464830967096, 'MRR*@10': 0.10607215189016782, 'Recall*@5': 0.1587014473401583, 'NDCG*@5': 0.11387997292555295, 'MRR*@5': 0.09904783505659837}
INFO    [05-04 17:51:41] train in BasicTrainer:
duration: 7.790078401565552s
INFO    [05-04 17:51:41] train in BasicTrainer:
epoch: 53
DEBUG   [05-04 17:51:42] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 243096
DEBUG   [05-04 17:51:42] calculate_loss in loss:
pred max in softmax: 0.5817750096321106, argmax 823377
DEBUG   [05-04 17:51:42] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 130039
DEBUG   [05-04 17:51:42] calculate_loss in loss:
pred max in softmax: 0.6403245329856873, argmax 924737
INFO    [05-04 17:51:47] _train_one_epoch in BasicTrainer:
loss = 3.6113325712528637
INFO    [05-04 17:51:49] validate in BasicTrainer:
{'Recall@10': 0.21224950024714836, 'NDCG@10': 0.1306341141462326, 'MRR@10': 0.10564228548453404, 'Recall@5': 0.15463454333635476, 'NDCG@5': 0.112033367730104, 'MRR@5': 0.09798529285650986, 'Recall*@10': 0.21224950024714836, 'NDCG*@10': 0.1306341141462326, 'MRR*@10': 0.10564228548453404, 'Recall*@5': 0.15463454333635476, 'NDCG*@5': 0.112033367730104, 'MRR*@5': 0.09798529285650986}
INFO    [05-04 17:51:49] train in BasicTrainer:
duration: 7.7691099643707275s
INFO    [05-04 17:51:49] train in BasicTrainer:
epoch: 54
INFO    [05-04 17:51:54] _train_one_epoch in BasicTrainer:
loss = 3.6041708170099462
INFO    [05-04 17:51:57] validate in BasicTrainer:
{'Recall@10': 0.2149538271702253, 'NDCG@10': 0.13016829868921867, 'MRR@10': 0.10425335856584403, 'Recall@5': 0.15477437124802515, 'NDCG@5': 0.11095280028306521, 'MRR@5': 0.09646717115090443, 'Recall*@10': 0.2149538271702253, 'NDCG*@10': 0.13016829868921867, 'MRR*@10': 0.10425335856584403, 'Recall*@5': 0.15477437124802515, 'NDCG*@5': 0.11095280028306521, 'MRR*@5': 0.09646717115090443}
INFO    [05-04 17:51:57] train in BasicTrainer:
duration: 7.832156658172607s
INFO    [05-04 17:51:57] train in BasicTrainer:
epoch: 55
INFO    [05-04 17:52:02] _train_one_epoch in BasicTrainer:
loss = 3.5993794405713992
INFO    [05-04 17:52:05] validate in BasicTrainer:
{'Recall@10': 0.2095659994162046, 'NDCG@10': 0.12982668383763388, 'MRR@10': 0.10522534526311435, 'Recall@5': 0.15854079333635476, 'NDCG@5': 0.11320858047558711, 'MRR@5': 0.09829732661063854, 'Recall*@10': 0.2095659994162046, 'NDCG*@10': 0.12982668383763388, 'MRR*@10': 0.10522534526311435, 'Recall*@5': 0.15854079333635476, 'NDCG*@5': 0.11320858047558711, 'MRR*@5': 0.09829732661063854}
INFO    [05-04 17:52:05] train in BasicTrainer:
duration: 8.534426927566528s
INFO    [05-04 17:52:05] train in BasicTrainer:
epoch: 56
INFO    [05-04 17:52:11] _train_one_epoch in BasicTrainer:
loss = 3.587535780795077
INFO    [05-04 17:52:13] validate in BasicTrainer:
{'Recall@10': 0.2134722494162046, 'NDCG@10': 0.13010690074700576, 'MRR@10': 0.10456249347099891, 'Recall@5': 0.15555681173618024, 'NDCG@5': 0.11152482262024513, 'MRR@5': 0.096982302574011, 'Recall*@10': 0.2134722494162046, 'NDCG*@10': 0.13010690074700576, 'MRR*@10': 0.10456249347099891, 'Recall*@5': 0.15555681173618024, 'NDCG*@5': 0.11152482262024513, 'MRR*@5': 0.096982302574011}
INFO    [05-04 17:52:13] train in BasicTrainer:
duration: 7.65765118598938s
INFO    [05-04 17:52:13] train in BasicTrainer:
epoch: 57
INFO    [05-04 17:52:18] _train_one_epoch in BasicTrainer:
loss = 3.5827441063333065
INFO    [05-04 17:52:21] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-04 17:52:21] validate in BasicTrainer:
{'Recall@10': 0.21060726734308097, 'NDCG@10': 0.1324029089166568, 'MRR@10': 0.10831398574205545, 'Recall@5': 0.1590019281093891, 'NDCG@5': 0.11573348366297208, 'MRR@5': 0.10144488685406171, 'Recall*@10': 0.21060726734308097, 'NDCG*@10': 0.1324029089166568, 'MRR*@10': 0.10831398574205545, 'Recall*@5': 0.1590019281093891, 'NDCG*@5': 0.11573348366297208, 'MRR*@5': 0.10144488685406171}
INFO    [05-04 17:52:21] train in BasicTrainer:
duration: 7.863571405410767s
INFO    [05-04 17:52:21] train in BasicTrainer:
epoch: 58
DEBUG   [05-04 17:52:24] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 286860
DEBUG   [05-04 17:52:24] calculate_loss in loss:
pred max in softmax: 0.5512726306915283, argmax 356042
DEBUG   [05-04 17:52:24] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 359800
DEBUG   [05-04 17:52:24] calculate_loss in loss:
pred max in softmax: 0.5366869568824768, argmax 171328
INFO    [05-04 17:52:26] _train_one_epoch in BasicTrainer:
loss = 3.576315995226515
INFO    [05-04 17:52:29] log in loggers:
Update Best NDCG@10 Model at 58
INFO    [05-04 17:52:29] validate in BasicTrainer:
{'Recall@10': 0.21603674842761114, 'NDCG@10': 0.13318009273363993, 'MRR@10': 0.10780774286160102, 'Recall@5': 0.15826113865925714, 'NDCG@5': 0.114588707112349, 'MRR@5': 0.10019000848898521, 'Recall*@10': 0.21603674842761114, 'NDCG*@10': 0.13318009273363993, 'MRR*@10': 0.10780774286160102, 'Recall*@5': 0.15826113865925714, 'NDCG*@5': 0.114588707112349, 'MRR*@5': 0.10019000848898521}
INFO    [05-04 17:52:29] train in BasicTrainer:
duration: 7.949597597122192s
INFO    [05-04 17:52:29] train in BasicTrainer:
epoch: 59
INFO    [05-04 17:52:34] _train_one_epoch in BasicTrainer:
loss = 3.5708995372691055
INFO    [05-04 17:52:36] validate in BasicTrainer:
{'Recall@10': 0.21224950024714836, 'NDCG@10': 0.13277535541699484, 'MRR@10': 0.1083366320683406, 'Recall@5': 0.15749952426323524, 'NDCG@5': 0.11499360031806506, 'MRR@5': 0.10095191918886624, 'Recall*@10': 0.21224950024714836, 'NDCG*@10': 0.13277535541699484, 'MRR*@10': 0.1083366320683406, 'Recall*@5': 0.15749952426323524, 'NDCG*@5': 0.11499360031806506, 'MRR*@5': 0.10095191918886624}
INFO    [05-04 17:52:36] train in BasicTrainer:
duration: 7.67035436630249s
INFO    [05-04 17:52:36] train in BasicTrainer:
epoch: 60
INFO    [05-04 17:52:42] _train_one_epoch in BasicTrainer:
loss = 3.556992715977608
INFO    [05-04 17:52:44] validate in BasicTrainer:
{'Recall@10': 0.2151144788815425, 'NDCG@10': 0.13233672770170066, 'MRR@10': 0.10699294106318401, 'Recall@5': 0.15449471657092756, 'NDCG@5': 0.11280017231519406, 'MRR@5': 0.09897117717907979, 'Recall*@10': 0.2151144788815425, 'NDCG*@10': 0.13233672770170066, 'MRR*@10': 0.10699294106318401, 'Recall*@5': 0.15449471657092756, 'NDCG*@5': 0.11280017231519406, 'MRR*@5': 0.09897117717907979}
INFO    [05-04 17:52:44] train in BasicTrainer:
duration: 7.815658092498779s
INFO    [05-04 17:52:44] train in BasicTrainer:
epoch: 61
INFO    [05-04 17:52:50] _train_one_epoch in BasicTrainer:
loss = 3.551198866773159
INFO    [05-04 17:52:52] log in loggers:
Update Best NDCG@10 Model at 61
INFO    [05-04 17:52:52] validate in BasicTrainer:
{'Recall@10': 0.21571544042000404, 'NDCG@10': 0.1347091977412884, 'MRR@10': 0.10976860213738221, 'Recall@5': 0.16050433195554292, 'NDCG@5': 0.11689023960095185, 'MRR@5': 0.10243498648588474, 'Recall*@10': 0.21571544042000404, 'NDCG*@10': 0.1347091977412884, 'MRR*@10': 0.10976860213738221, 'Recall*@5': 0.16050433195554292, 'NDCG*@5': 0.11689023960095185, 'MRR*@5': 0.10243498648588474}
INFO    [05-04 17:52:52] train in BasicTrainer:
duration: 7.795706272125244s
INFO    [05-04 17:52:52] train in BasicTrainer:
epoch: 62
INFO    [05-04 17:52:57] _train_one_epoch in BasicTrainer:
loss = 3.5461539930485664
INFO    [05-04 17:53:00] log in loggers:
Update Best NDCG@10 Model at 62
INFO    [05-04 17:53:00] validate in BasicTrainer:
{'Recall@10': 0.21874107535068804, 'NDCG@10': 0.13697019792520082, 'MRR@10': 0.11181921683824979, 'Recall@5': 0.16533284920912522, 'NDCG@5': 0.11980807551970848, 'MRR@5': 0.10480263428046153, 'Recall*@10': 0.21874107535068804, 'NDCG*@10': 0.13697019792520082, 'MRR*@10': 0.11181921683824979, 'Recall*@5': 0.16533284920912522, 'NDCG*@5': 0.11980807551970848, 'MRR*@5': 0.10480263428046153}
INFO    [05-04 17:53:00] train in BasicTrainer:
duration: 7.85388445854187s
INFO    [05-04 17:53:00] train in BasicTrainer:
epoch: 63
DEBUG   [05-04 17:53:04] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 730626
DEBUG   [05-04 17:53:04] calculate_loss in loss:
pred max in softmax: 0.6509829759597778, argmax 720235
DEBUG   [05-04 17:53:04] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 650392
DEBUG   [05-04 17:53:04] calculate_loss in loss:
pred max in softmax: 0.5431703925132751, argmax 366882
INFO    [05-04 17:53:05] _train_one_epoch in BasicTrainer:
loss = 3.5421297994065792
INFO    [05-04 17:53:08] validate in BasicTrainer:
{'Recall@10': 0.21994299842761114, 'NDCG@10': 0.1357580962089392, 'MRR@10': 0.1098882808135106, 'Recall@5': 0.16413092613220215, 'NDCG@5': 0.11773844693715756, 'MRR@5': 0.10246498366961113, 'Recall*@10': 0.21994299842761114, 'NDCG*@10': 0.1357580962089392, 'MRR*@10': 0.1098882808135106, 'Recall*@5': 0.16413092613220215, 'NDCG*@5': 0.11773844693715756, 'MRR*@5': 0.10246498366961113}
INFO    [05-04 17:53:08] train in BasicTrainer:
duration: 7.859603404998779s
INFO    [05-04 17:53:08] train in BasicTrainer:
epoch: 64
INFO    [05-04 17:53:13] _train_one_epoch in BasicTrainer:
loss = 3.5351721200537174
INFO    [05-04 17:53:15] validate in BasicTrainer:
{'Recall@10': 0.2163372291968419, 'NDCG@10': 0.13566259810557732, 'MRR@10': 0.11080811344660245, 'Recall@5': 0.16383044536297137, 'NDCG@5': 0.11864628528173153, 'MRR@5': 0.10376374538128193, 'Recall*@10': 0.2163372291968419, 'NDCG*@10': 0.13566259810557732, 'MRR*@10': 0.11080811344660245, 'Recall*@5': 0.16383044536297137, 'NDCG*@5': 0.11864628528173153, 'MRR*@5': 0.10376374538128193}
INFO    [05-04 17:53:15] train in BasicTrainer:
duration: 7.642343044281006s
INFO    [05-04 17:53:15] train in BasicTrainer:
epoch: 65
INFO    [05-04 17:53:21] _train_one_epoch in BasicTrainer:
loss = 3.528630160270853
INFO    [05-04 17:53:23] validate in BasicTrainer:
{'Recall@10': 0.21587609557005075, 'NDCG@10': 0.13602539037282652, 'MRR@10': 0.11145053746608588, 'Recall@5': 0.16322948382450983, 'NDCG@5': 0.11913555058149192, 'MRR@5': 0.1045575411273883, 'Recall*@10': 0.21587609557005075, 'NDCG*@10': 0.13602539037282652, 'MRR*@10': 0.11145053746608588, 'Recall*@5': 0.16322948382450983, 'NDCG*@5': 0.11913555058149192, 'MRR*@5': 0.1045575411273883}
INFO    [05-04 17:53:23] train in BasicTrainer:
duration: 7.705857276916504s
INFO    [05-04 17:53:23] train in BasicTrainer:
epoch: 66
INFO    [05-04 17:53:29] _train_one_epoch in BasicTrainer:
loss = 3.520735610038676
INFO    [05-04 17:53:31] log in loggers:
Update Best NDCG@10 Model at 66
INFO    [05-04 17:53:31] validate in BasicTrainer:
{'Recall@10': 0.21888090326235846, 'NDCG@10': 0.13746286183595657, 'MRR@10': 0.11255400914412278, 'Recall@5': 0.1645920597589933, 'NDCG@5': 0.12002204989011471, 'MRR@5': 0.10542571200774266, 'Recall*@10': 0.21888090326235846, 'NDCG*@10': 0.13746286183595657, 'MRR*@10': 0.11255400914412278, 'Recall*@5': 0.1645920597589933, 'NDCG*@5': 0.12002204989011471, 'MRR*@5': 0.10542571200774266}
INFO    [05-04 17:53:31] train in BasicTrainer:
duration: 7.731436729431152s
INFO    [05-04 17:53:31] train in BasicTrainer:
epoch: 67
INFO    [05-04 17:53:36] _train_one_epoch in BasicTrainer:
loss = 3.5141052134493562
INFO    [05-04 17:53:38] validate in BasicTrainer:
{'Recall@10': 0.21345142332407144, 'NDCG@10': 0.13353789826998344, 'MRR@10': 0.10894675380908526, 'Recall@5': 0.16006402327464178, 'NDCG@5': 0.11633884448271531, 'MRR@5': 0.10189005560599841, 'Recall*@10': 0.21345142332407144, 'NDCG*@10': 0.13353789826998344, 'MRR*@10': 0.10894675380908526, 'Recall*@5': 0.16006402327464178, 'NDCG*@5': 0.11633884448271531, 'MRR*@5': 0.10189005560599841}
INFO    [05-04 17:53:38] train in BasicTrainer:
duration: 7.716869115829468s
INFO    [05-04 17:53:38] train in BasicTrainer:
epoch: 68
INFO    [05-04 17:53:44] _train_one_epoch in BasicTrainer:
loss = 3.507052189492165
INFO    [05-04 17:53:46] validate in BasicTrainer:
{'Recall@10': 0.2154357868891496, 'NDCG@10': 0.13661484362987372, 'MRR@10': 0.11244101077318192, 'Recall@5': 0.1630480048748163, 'NDCG@5': 0.11974092630239633, 'MRR@5': 0.10551169056158799, 'Recall*@10': 0.2154357868891496, 'NDCG*@10': 0.13661484362987372, 'MRR*@10': 0.11244101077318192, 'Recall*@5': 0.1630480048748163, 'NDCG*@5': 0.11974092630239633, 'MRR*@5': 0.10551169056158799}
INFO    [05-04 17:53:46] train in BasicTrainer:
duration: 7.817824602127075s
INFO    [05-04 17:53:46] train in BasicTrainer:
epoch: 69
DEBUG   [05-04 17:53:48] calculate_loss in loss:
soft_target max: 0.5022941827774048, argmax 782852
DEBUG   [05-04 17:53:48] calculate_loss in loss:
pred max in softmax: 0.6920068264007568, argmax 452088
DEBUG   [05-04 17:53:48] calculate_loss in loss:
soft_target max: 0.501916766166687, argmax 303299
DEBUG   [05-04 17:53:48] calculate_loss in loss:
pred max in softmax: 0.7532778382301331, argmax 627267
INFO    [05-04 17:53:52] _train_one_epoch in BasicTrainer:
loss = 3.505653088397168
INFO    [05-04 17:53:54] validate in BasicTrainer:
{'Recall@10': 0.21615575024714836, 'NDCG@10': 0.13559390948368952, 'MRR@10': 0.11081799291647397, 'Recall@5': 0.16441058195554292, 'NDCG@5': 0.11886001492922123, 'MRR@5': 0.10391225207310456, 'Recall*@10': 0.21615575024714836, 'NDCG*@10': 0.13559390948368952, 'MRR*@10': 0.11081799291647397, 'Recall*@5': 0.16441058195554292, 'NDCG*@5': 0.11886001492922123, 'MRR*@5': 0.10391225207310456}
INFO    [05-04 17:53:54] train in BasicTrainer:
duration: 7.7873499393463135s
INFO    [05-04 17:53:54] train in BasicTrainer:
epoch: 70
INFO    [05-04 17:54:00] _train_one_epoch in BasicTrainer:
loss = 3.4980604699317444
INFO    [05-04 17:54:02] log in loggers:
Update Best NDCG@10 Model at 70
INFO    [05-04 17:54:02] validate in BasicTrainer:
{'Recall@10': 0.22022265195846558, 'NDCG@10': 0.1379302252943699, 'MRR@10': 0.11260209003320107, 'Recall@5': 0.16863813767066368, 'NDCG@5': 0.12132547967709027, 'MRR@5': 0.1057892653804559, 'Recall*@10': 0.22022265195846558, 'NDCG*@10': 0.1379302252943699, 'MRR*@10': 0.11260209003320107, 'Recall*@5': 0.16863813767066368, 'NDCG*@5': 0.12132547967709027, 'MRR*@5': 0.1057892653804559}
INFO    [05-04 17:54:02] train in BasicTrainer:
duration: 7.856785297393799s
INFO    [05-04 17:54:02] train in BasicTrainer:
epoch: 71
INFO    [05-04 17:54:08] _train_one_epoch in BasicTrainer:
loss = 3.4964209122860685
INFO    [05-04 17:54:10] log in loggers:
Update Best NDCG@10 Model at 71
INFO    [05-04 17:54:10] validate in BasicTrainer:
{'Recall@10': 0.2197615194779176, 'NDCG@10': 0.13793578113500887, 'MRR@10': 0.11287713050842285, 'Recall@5': 0.15960288964785063, 'NDCG@5': 0.11835761024401738, 'MRR@5': 0.10472320249447456, 'Recall*@10': 0.2197615194779176, 'NDCG*@10': 0.13793578113500887, 'MRR*@10': 0.11287713050842285, 'Recall*@5': 0.15960288964785063, 'NDCG*@5': 0.11835761024401738, 'MRR*@5': 0.10472320249447456}
INFO    [05-04 17:54:10] train in BasicTrainer:
duration: 7.874645709991455s
INFO    [05-04 17:54:10] train in BasicTrainer:
epoch: 72
INFO    [05-04 17:54:15] _train_one_epoch in BasicTrainer:
loss = 3.48911754882082
INFO    [05-04 17:54:17] validate in BasicTrainer:
{'Recall@10': 0.2141922116279602, 'NDCG@10': 0.13784684584690973, 'MRR@10': 0.11431715465508975, 'Recall@5': 0.16457123481310332, 'NDCG@5': 0.12177798266594227, 'MRR@5': 0.10767306960546054, 'Recall*@10': 0.2141922116279602, 'NDCG*@10': 0.13784684584690973, 'MRR*@10': 0.11431715465508975, 'Recall*@5': 0.16457123481310332, 'NDCG*@5': 0.12177798266594227, 'MRR*@5': 0.10767306960546054}
INFO    [05-04 17:54:17] train in BasicTrainer:
duration: 7.780940532684326s
INFO    [05-04 17:54:17] train in BasicTrainer:
epoch: 73
INFO    [05-04 17:54:23] _train_one_epoch in BasicTrainer:
loss = 3.4867844327967217
INFO    [05-04 17:54:25] log in loggers:
Update Best NDCG@10 Model at 73
INFO    [05-04 17:54:25] validate in BasicTrainer:
{'Recall@10': 0.21858042249312767, 'NDCG@10': 0.13855477365163657, 'MRR@10': 0.11381830733556014, 'Recall@5': 0.16833765690143293, 'NDCG@5': 0.12232883962301108, 'MRR@5': 0.10713577614380763, 'Recall*@10': 0.21858042249312767, 'NDCG*@10': 0.13855477365163657, 'MRR*@10': 0.11381830733556014, 'Recall*@5': 0.16833765690143293, 'NDCG*@5': 0.12232883962301108, 'MRR*@5': 0.10713577614380763}
INFO    [05-04 17:54:25] train in BasicTrainer:
duration: 7.82667088508606s
INFO    [05-04 17:54:25] train in BasicTrainer:
epoch: 74
DEBUG   [05-04 17:54:28] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 256516
DEBUG   [05-04 17:54:28] calculate_loss in loss:
pred max in softmax: 0.6911763548851013, argmax 129307
DEBUG   [05-04 17:54:28] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 216399
DEBUG   [05-04 17:54:28] calculate_loss in loss:
pred max in softmax: 0.6885683536529541, argmax 77201
INFO    [05-04 17:54:31] _train_one_epoch in BasicTrainer:
loss = 3.4763382977627693
INFO    [05-04 17:54:33] validate in BasicTrainer:
{'Recall@10': 0.21751832503538865, 'NDCG@10': 0.1379841652054053, 'MRR@10': 0.11347912710446578, 'Recall@5': 0.1651513702594317, 'NDCG@5': 0.12109535359419309, 'MRR@5': 0.10653377152406253, 'Recall*@10': 0.21751832503538865, 'NDCG*@10': 0.1379841652054053, 'MRR*@10': 0.11347912710446578, 'Recall*@5': 0.1651513702594317, 'NDCG*@5': 0.12109535359419309, 'MRR*@5': 0.10653377152406253}
INFO    [05-04 17:54:33] train in BasicTrainer:
duration: 7.787903785705566s
INFO    [05-04 17:54:33] train in BasicTrainer:
epoch: 75
INFO    [05-04 17:54:39] _train_one_epoch in BasicTrainer:
loss = 3.4774731372265104
INFO    [05-04 17:54:41] log in loggers:
Update Best NDCG@10 Model at 75
INFO    [05-04 17:54:41] validate in BasicTrainer:
{'Recall@10': 0.22084444073530343, 'NDCG@10': 0.1399841268475239, 'MRR@10': 0.11509048709502587, 'Recall@5': 0.16801635118631217, 'NDCG@5': 0.12288853984612685, 'MRR@5': 0.10803057310672906, 'Recall*@10': 0.22084444073530343, 'NDCG*@10': 0.1399841268475239, 'MRR*@10': 0.11509048709502587, 'Recall*@5': 0.16801635118631217, 'NDCG*@5': 0.12288853984612685, 'MRR*@5': 0.10803057310672906}
INFO    [05-04 17:54:41] train in BasicTrainer:
duration: 7.845626354217529s
INFO    [05-04 17:54:41] train in BasicTrainer:
epoch: 76
INFO    [05-04 17:54:47] _train_one_epoch in BasicTrainer:
loss = 3.4681263553335313
INFO    [05-04 17:54:49] validate in BasicTrainer:
{'Recall@10': 0.21617657633928153, 'NDCG@10': 0.13819567286051238, 'MRR@10': 0.11412710237961549, 'Recall@5': 0.16607363865925714, 'NDCG@5': 0.1221157363974131, 'MRR@5': 0.10756472899363591, 'Recall*@10': 0.21617657633928153, 'NDCG*@10': 0.13819567286051238, 'MRR*@10': 0.11412710237961549, 'Recall*@5': 0.16607363865925714, 'NDCG*@5': 0.1221157363974131, 'MRR*@5': 0.10756472899363591}
INFO    [05-04 17:54:49] train in BasicTrainer:
duration: 7.712324619293213s
INFO    [05-04 17:54:49] train in BasicTrainer:
epoch: 77
INFO    [05-04 17:54:54] _train_one_epoch in BasicTrainer:
loss = 3.462451474463686
INFO    [05-04 17:54:56] validate in BasicTrainer:
{'Recall@10': 0.21254998101637915, 'NDCG@10': 0.13445715262339666, 'MRR@10': 0.11033264146401332, 'Recall@5': 0.16216738865925714, 'NDCG@5': 0.11801783052774575, 'MRR@5': 0.10346336261584209, 'Recall*@10': 0.21254998101637915, 'NDCG*@10': 0.13445715262339666, 'MRR*@10': 0.11033264146401332, 'Recall*@5': 0.16216738865925714, 'NDCG*@5': 0.11801783052774575, 'MRR*@5': 0.10346336261584209}
INFO    [05-04 17:54:56] train in BasicTrainer:
duration: 7.682377576828003s
INFO    [05-04 17:54:56] train in BasicTrainer:
epoch: 78
INFO    [05-04 17:55:02] _train_one_epoch in BasicTrainer:
loss = 3.4639540314674377
INFO    [05-04 17:55:04] validate in BasicTrainer:
{'Recall@10': 0.21541495965077326, 'NDCG@10': 0.1365211898317704, 'MRR@10': 0.11215212081487362, 'Recall@5': 0.1657731578900264, 'NDCG@5': 0.12055723598370185, 'MRR@5': 0.10561606803765664, 'Recall*@10': 0.21541495965077326, 'NDCG*@10': 0.1365211898317704, 'MRR*@10': 0.11215212081487362, 'Recall*@5': 0.1657731578900264, 'NDCG*@5': 0.12055723598370185, 'MRR*@5': 0.10561606803765664}
INFO    [05-04 17:55:04] train in BasicTrainer:
duration: 7.809710264205933s
INFO    [05-04 17:55:04] train in BasicTrainer:
epoch: 79
DEBUG   [05-04 17:55:09] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 799919
DEBUG   [05-04 17:55:09] calculate_loss in loss:
pred max in softmax: 0.6578472852706909, argmax 606004
DEBUG   [05-04 17:55:09] calculate_loss in loss:
soft_target max: 0.5027459263801575, argmax 774390
DEBUG   [05-04 17:55:09] calculate_loss in loss:
pred max in softmax: 0.8515822291374207, argmax 164503
INFO    [05-04 17:55:10] _train_one_epoch in BasicTrainer:
loss = 3.453132134802798
INFO    [05-04 17:55:12] validate in BasicTrainer:
{'Recall@10': 0.2212847494162046, 'NDCG@10': 0.13888430251525, 'MRR@10': 0.11366164340422703, 'Recall@5': 0.16697508096694946, 'NDCG@5': 0.1214461550116539, 'MRR@5': 0.10653798511395088, 'Recall*@10': 0.2212847494162046, 'NDCG*@10': 0.13888430251525, 'MRR*@10': 0.11366164340422703, 'Recall*@5': 0.16697508096694946, 'NDCG*@5': 0.1214461550116539, 'MRR*@5': 0.10653798511395088}
INFO    [05-04 17:55:12] train in BasicTrainer:
duration: 7.946775197982788s
INFO    [05-04 17:55:12] close_training in BasicTrainer:
finished training
DEBUG   [05-04 17:55:12] debug_summary in loss:
loss nan summary: nan 0 times, not nan 15041 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-04 17:55:12] run_routine in Routine:
Finished training, Start final validation
INFO    [05-04 17:55:12] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-04 17:55:12] load_state_from_given_path in utils:
checkpoint epoch: 75
INFO    [05-04 17:55:12] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-04 17:55:14] validate in BasicTrainer:
{'Recall@10': 0.22084444073530343, 'NDCG@10': 0.1399841268475239, 'MRR@10': 0.11509048709502587, 'Recall@5': 0.16801635118631217, 'NDCG@5': 0.12288853984612685, 'MRR@5': 0.10803057310672906, 'Recall*@10': 0.22084444073530343, 'NDCG*@10': 0.1399841268475239, 'MRR*@10': 0.11509048709502587, 'Recall*@5': 0.16801635118631217, 'NDCG*@5': 0.12288853984612685, 'MRR*@5': 0.10803057310672906}
INFO    [05-04 17:55:14] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.22084444073530343, 'NDCG@10': 0.1399841268475239, 'MRR@10': 0.11509048709502587, 'Recall@5': 0.16801635118631217, 'NDCG@5': 0.12288853984612685, 'MRR@5': 0.10803057310672906, 'Recall*@10': 0.22084444073530343, 'NDCG*@10': 0.1399841268475239, 'MRR*@10': 0.11509048709502587, 'Recall*@5': 0.16801635118631217, 'NDCG*@5': 0.12288853984612685, 'MRR*@5': 0.10803057310672906}
INFO    [05-04 17:55:14] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-04 17:55:14] test in BasicTrainer:
Test model on test set!
INFO    [05-04 17:55:14] test_with_given_state_path in BasicTrainer:
Loading model params from ___lfms_soft_2022/soft_narm-T-3.0-al-0.5_05-04_17:44_t5/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-04 17:55:14] load_state_from_given_path in utils:
checkpoint epoch: 75
INFO    [05-04 17:55:14] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-04 17:55:14] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-04 17:55:17] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.20319342613220215, 'NDCG@10': 0.1268886958177273, 'MRR@10': 0.10356787764109097, 'Recall@5': 0.15054681553290442, 'NDCG@5': 0.10992920169463524, 'MRR@5': 0.0966055106658202, 'Recall*@10': 0.20319342613220215, 'NDCG*@10': 0.1268886958177273, 'MRR*@10': 0.10356787764109097, 'Recall*@5': 0.15054681553290442, 'NDCG*@5': 0.10992920169463524, 'MRR*@5': 0.0966055106658202}
INFO    [05-04 17:55:17] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.20319342613220215, 'NDCG@10': 0.1268886958177273, 'MRR@10': 0.10356787764109097, 'Recall@5': 0.15054681553290442, 'NDCG@5': 0.10992920169463524, 'MRR@5': 0.0966055106658202, 'Recall*@10': 0.20319342613220215, 'NDCG*@10': 0.1268886958177273, 'MRR*@10': 0.10356787764109097, 'Recall*@5': 0.15054681553290442, 'NDCG*@5': 0.10992920169463524, 'MRR*@5': 0.0966055106658202}
