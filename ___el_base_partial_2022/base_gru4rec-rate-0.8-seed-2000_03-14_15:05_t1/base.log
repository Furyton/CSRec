INFO    [03-14 15:05:58] setup_train in utils:
{
    "experiment_dir": "___el_base_partial_2022",
    "experiment_description": "base",
    "describe": "{config[model_code]}-rate-{config[sample_rate]}-seed-{config[sample_seed]}",
    "dataset_name": "electronics.csv",
    "sched": "basic",
    "model_code": "gru4rec",
    "num_epochs": 30,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "do_sampling": true,
    "path_for_sample": "Data/Cache/electronics-5-5.pkl",
    "sample_rate": 0.8,
    "sample_seed": 2000,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "do_remap": false,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 512,
    "val_batch_size": 512,
    "test_batch_size": 512,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "config_file": "config2.electronics/gru4rec/config_partial.json",
    "task_id": 1,
    "split": "leave_one_out",
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "mentor_code": "bert",
    "training_routine": null,
    "T": 1,
    "alpha": 0.1,
    "dvae_alpha": 0.5,
    "softmaxed_mentor": false,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [03-14 15:05:58] __init__ in BasicSched:
BasicScheduler attribs: tag=gru4rec
WARNING [03-14 15:05:58] _load_sampled_dataset_from_path in utils:
file from /data/wushiguang-slurm/code/gitee-repos/soft-rec/Data/Cache/sampled_electronics-5-5-rate-0.8-seed-2000.pkl not found. Regenerating.
DEBUG   [03-14 15:05:58] _resampling in utils:
loading full dataset from Data/Cache/electronics-5-5.pkl
INFO    [03-14 15:05:58] _load_full_dataset_from_path in utils:
loading cache from Data/Cache/electronics-5-5.pkl
INFO    [03-14 15:06:01] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [03-14 15:06:01] _check_dataset_cache in utils:
correct.
INFO    [03-14 15:06:07] __init__ in NextItemDataloader:
there are 29351 items in this dataset, 81749 users, padding_first? False
DEBUG   [03-14 15:06:27] generate_model in utils:
model_code_list=['gru4rec']
INFO    [03-14 15:06:27] load_model_config in utils:
loading model gru4rec's config file at asset/config/model/gru4rec.json
INFO    [03-14 15:06:27] load_model_config in utils:
{
    "embed_size": 64,
    "hidden_units": 64,
    "num_layers": 2,
    "hidden_dropout": 0.5,
    "loss_type": "CE"
}
WARNING [03-14 15:06:40] get_exist_path in utils:
dir ___el_base_partial_2022/base_gru4rec-rate-0.8-seed-2000_03-14_15:05_t1/gru4rec_logs does not exist! Create one.
WARNING [03-14 15:06:40] get_exist_path in utils:
dir ___el_base_partial_2022/base_gru4rec-rate-0.8-seed-2000_03-14_15:05_t1/gru4rec_logs/tb_vis does not exist! Create one.
WARNING [03-14 15:06:40] get_exist_path in utils:
dir ___el_base_partial_2022/base_gru4rec-rate-0.8-seed-2000_03-14_15:05_t1/gru4rec_logs/checkpoint does not exist! Create one.
INFO    [03-14 15:06:40] __init__ in BasicSched:
GRU4RecModel(
  (item_embedding): Embedding(29352, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.5, inplace=False)
  (gru_layers): GRU(64, 64, num_layers=2, bias=False, batch_first=True)
  (dense): Linear(in_features=64, out_features=64, bias=True)
  (loss_fct): CrossEntropyLoss()
)
WARNING [03-14 15:06:40] get_path in utils:
Path is None
WARNING [03-14 15:06:40] load_state_from_given_path in utils:
Not given any path.
INFO    [03-14 15:06:40] assert_model_device in utils:
model gru4rec has 7.369384765625 MB params.
INFO    [03-14 15:06:40] __init__ in BasicTrainer:
365568 iter per epoch
INFO    [03-14 15:06:40] _fit in BasicSched:
Start training.
INFO    [03-14 15:07:17] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [03-14 15:07:18] validate in BasicTrainer:
{'Recall@10': 0.000634765625, 'NDCG@10': 0.00027908084593946113, 'MRR@10': 0.00017278762315982022, 'Recall@5': 0.00035400390625, 'NDCG@5': 0.00019028582464670764, 'MRR@5': 0.0001373291024719947, 'Recall*@10': 0.0005411793768871576, 'NDCG*@10': 0.0002356057542783674, 'MRR*@10': 0.00014346725038194563, 'Recall*@5': 0.00032924896513577553, 'NDCG*@5': 0.00016924647243286018, 'MRR*@5': 0.00011733680075849406}
INFO    [03-14 15:07:18] train in BasicTrainer:
epoch: 0
INFO    [03-14 15:07:50] _train_one_epoch in BasicTrainer:
loss = 9.614370543749727
INFO    [03-14 15:08:27] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [03-14 15:08:28] validate in BasicTrainer:
{'Recall@10': 0.03375265619251877, 'NDCG@10': 0.018023496866226195, 'MRR@10': 0.01321466317458544, 'Recall@5': 0.02291882645804435, 'NDCG@5': 0.014571996973245405, 'MRR@5': 0.011820732621708884, 'Recall*@10': 0.03664290776941925, 'NDCG*@10': 0.019830672279931606, 'MRR*@10': 0.014697919163154438, 'Recall*@5': 0.024612370361865032, 'NDCG*@5': 0.015998553771351, 'MRR*@5': 0.01315071324206656}
INFO    [03-14 15:08:28] train in BasicTrainer:
duration: 70.11299753189087s
INFO    [03-14 15:08:28] train in BasicTrainer:
epoch: 1
INFO    [03-14 15:09:00] _train_one_epoch in BasicTrainer:
loss = 9.264870651629792
INFO    [03-14 15:09:37] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [03-14 15:09:37] validate in BasicTrainer:
{'Recall@10': 0.0421755435410887, 'NDCG@10': 0.02243071963894181, 'MRR@10': 0.01644824152754154, 'Recall@5': 0.02734392898855731, 'NDCG@5': 0.017697635682998224, 'MRR@5': 0.014531429295311682, 'Recall*@10': 0.045853095268830656, 'NDCG*@10': 0.02440726598724723, 'MRR*@10': 0.017909512185724452, 'Recall*@5': 0.029661486262921245, 'NDCG*@5': 0.019237020605942234, 'MRR*@5': 0.01581380987772718}
INFO    [03-14 15:09:37] train in BasicTrainer:
duration: 69.62497043609619s
INFO    [03-14 15:09:37] train in BasicTrainer:
epoch: 2
INFO    [03-14 15:10:09] _train_one_epoch in BasicTrainer:
loss = 9.040813976309213
INFO    [03-14 15:10:47] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [03-14 15:10:48] validate in BasicTrainer:
{'Recall@10': 0.0464480044785887, 'NDCG@10': 0.024756272160448133, 'MRR@10': 0.018147297308314592, 'Recall@5': 0.030951124615967274, 'NDCG@5': 0.019777066342066975, 'MRR@5': 0.016111332320724613, 'Recall*@10': 0.05034805522300303, 'NDCG*@10': 0.026909235352650284, 'MRR*@10': 0.019763571297517046, 'Recall*@5': 0.03388627399690449, 'NDCG*@5': 0.021624041651375592, 'MRR*@5': 0.017604762976407073}
INFO    [03-14 15:10:48] train in BasicTrainer:
duration: 70.36717057228088s
INFO    [03-14 15:10:48] train in BasicTrainer:
epoch: 3
INFO    [03-14 15:11:20] _train_one_epoch in BasicTrainer:
loss = 8.859284371555018
INFO    [03-14 15:11:59] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [03-14 15:11:59] validate in BasicTrainer:
{'Recall@10': 0.048919946211390196, 'NDCG@10': 0.026575278799282388, 'MRR@10': 0.019769911334151402, 'Recall@5': 0.03281876461114734, 'NDCG@5': 0.021392649249173702, 'MRR@5': 0.017645041533978657, 'Recall*@10': 0.05268271121894941, 'NDCG*@10': 0.028737329080468044, 'MRR*@10': 0.02144790808961261, 'Recall*@5': 0.035451932717114686, 'NDCG*@5': 0.02320007496746257, 'MRR*@5': 0.01918282239930704}
INFO    [03-14 15:11:59] train in BasicTrainer:
duration: 71.63974809646606s
INFO    [03-14 15:11:59] train in BasicTrainer:
epoch: 4
INFO    [03-14 15:12:29] _train_one_epoch in BasicTrainer:
loss = 8.733876711848069
INFO    [03-14 15:13:07] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [03-14 15:13:07] validate in BasicTrainer:
{'Recall@10': 0.049414348881691696, 'NDCG@10': 0.027256941061932594, 'MRR@10': 0.020500811067176983, 'Recall@5': 0.03353901524096727, 'NDCG@5': 0.022128095594234766, 'MRR@5': 0.018386919412296265, 'Recall*@10': 0.05324495078530163, 'NDCG*@10': 0.029477831488475204, 'MRR*@10': 0.02222833494306542, 'Recall*@5': 0.03624924984760582, 'NDCG*@5': 0.023988699418259783, 'MRR*@5': 0.019966899152495898}
INFO    [03-14 15:13:07] train in BasicTrainer:
duration: 67.80185651779175s
INFO    [03-14 15:13:07] train in BasicTrainer:
epoch: 5
INFO    [03-14 15:13:38] _train_one_epoch in BasicTrainer:
loss = 8.637332427401503
INFO    [03-14 15:14:15] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [03-14 15:14:16] validate in BasicTrainer:
{'Recall@10': 0.05098297030199319, 'NDCG@10': 0.02818433181382716, 'MRR@10': 0.02125966350431554, 'Recall@5': 0.034131074161268773, 'NDCG@5': 0.022747347533004357, 'MRR@5': 0.019023252237820996, 'Recall*@10': 0.055148607748560605, 'NDCG*@10': 0.030503833340480922, 'MRR*@10': 0.023026797565398736, 'Recall*@5': 0.036808135209139434, 'NDCG*@5': 0.024592369757010603, 'MRR*@5': 0.020598607987631114}
INFO    [03-14 15:14:16] train in BasicTrainer:
duration: 68.65053749084473s
INFO    [03-14 15:14:16] train in BasicTrainer:
epoch: 6
INFO    [03-14 15:14:46] _train_one_epoch in BasicTrainer:
loss = 8.55015496379521
INFO    [03-14 15:15:24] validate in BasicTrainer:
{'Recall@10': 0.051825255458243194, 'NDCG@10': 0.02817154720542021, 'MRR@10': 0.021007675590226427, 'Recall@5': 0.03380148431751877, 'NDCG@5': 0.02237589792930521, 'MRR@5': 0.01863464275957085, 'Recall*@10': 0.05583438177127391, 'NDCG*@10': 0.030450318823568523, 'MRR*@10': 0.022752689704066142, 'Recall*@5': 0.036760540376417336, 'NDCG*@5': 0.024317188168060964, 'MRR*@5': 0.020241609620279634}
INFO    [03-14 15:15:24] train in BasicTrainer:
duration: 67.98953533172607s
INFO    [03-14 15:15:24] train in BasicTrainer:
epoch: 7
INFO    [03-14 15:15:55] _train_one_epoch in BasicTrainer:
loss = 8.470944622317615
INFO    [03-14 15:16:32] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [03-14 15:16:33] validate in BasicTrainer:
{'Recall@10': 0.052002239506691694, 'NDCG@10': 0.028652559575857595, 'MRR@10': 0.02155175672378391, 'Recall@5': 0.035205257113557306, 'NDCG@5': 0.02325317052891478, 'MRR@5': 0.019342526426771655, 'Recall*@10': 0.05608005325775593, 'NDCG*@10': 0.031031005608383566, 'MRR*@10': 0.023415842658141627, 'Recall*@5': 0.03795828992733732, 'NDCG*@5': 0.025203800847521052, 'MRR*@5': 0.021030493598664178}
INFO    [03-14 15:16:33] train in BasicTrainer:
duration: 68.96447348594666s
INFO    [03-14 15:16:33] train in BasicTrainer:
epoch: 8
INFO    [03-14 15:17:05] _train_one_epoch in BasicTrainer:
loss = 8.396926058440648
INFO    [03-14 15:17:42] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [03-14 15:17:42] validate in BasicTrainer:
{'Recall@10': 0.05204498202074319, 'NDCG@10': 0.028757912915898486, 'MRR@10': 0.02169049786753021, 'Recall@5': 0.03475359695730731, 'NDCG@5': 0.023210034711519258, 'MRR@5': 0.019426433905027806, 'Recall*@10': 0.056261159596033394, 'NDCG*@10': 0.03099842704832554, 'MRR*@10': 0.023330485116457567, 'Recall*@5': 0.03750083890045062, 'NDCG*@5': 0.0249810749781318, 'MRR*@5': 0.020875771669670938}
INFO    [03-14 15:17:42] train in BasicTrainer:
duration: 69.79623436927795s
INFO    [03-14 15:17:42] train in BasicTrainer:
epoch: 9
INFO    [03-14 15:18:14] _train_one_epoch in BasicTrainer:
loss = 8.325659803983545
INFO    [03-14 15:18:51] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [03-14 15:18:51] validate in BasicTrainer:
{'Recall@10': 0.05259429842699319, 'NDCG@10': 0.02902432106784545, 'MRR@10': 0.02186892495374195, 'Recall@5': 0.03493670242605731, 'NDCG@5': 0.023330825782613827, 'MRR@5': 0.019528683079988694, 'Recall*@10': 0.05671712979674339, 'NDCG*@10': 0.03134290450252593, 'MRR*@10': 0.023634435841813684, 'Recall*@5': 0.03785911214654334, 'NDCG*@5': 0.025257572706323117, 'MRR*@5': 0.02113029242900666}
INFO    [03-14 15:18:51] train in BasicTrainer:
duration: 68.82676243782043s
INFO    [03-14 15:18:51] train in BasicTrainer:
epoch: 10
INFO    [03-14 15:19:22] _train_one_epoch in BasicTrainer:
loss = 8.255882973096618
INFO    [03-14 15:19:59] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [03-14 15:20:00] validate in BasicTrainer:
{'Recall@10': 0.052728539961390195, 'NDCG@10': 0.029085594665957615, 'MRR@10': 0.021910807711537927, 'Recall@5': 0.03501603023614734, 'NDCG@5': 0.023385977363795975, 'MRR@5': 0.019574955815915018, 'Recall*@10': 0.056855586473830044, 'NDCG*@10': 0.031376997963525353, 'MRR*@10': 0.02363272417569533, 'Recall*@5': 0.03808241484221071, 'NDCG*@5': 0.025331731588812544, 'MRR*@5': 0.021152828331105412}
INFO    [03-14 15:20:00] train in BasicTrainer:
duration: 68.33603620529175s
INFO    [03-14 15:20:00] train in BasicTrainer:
epoch: 11
INFO    [03-14 15:20:31] _train_one_epoch in BasicTrainer:
loss = 8.188254847913896
INFO    [03-14 15:21:09] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [03-14 15:21:09] validate in BasicTrainer:
{'Recall@10': 0.05299090164480731, 'NDCG@10': 0.029521519650006666, 'MRR@10': 0.022403504740213975, 'Recall@5': 0.03528458492364735, 'NDCG@5': 0.023834821773925798, 'MRR@5': 0.02007963302312419, 'Recall*@10': 0.05722486256854609, 'NDCG*@10': 0.031824120780220254, 'MRR*@10': 0.024120708176633344, 'Recall*@5': 0.037959600798785686, 'NDCG*@5': 0.02563449164154008, 'MRR*@5': 0.02159001008258201}
INFO    [03-14 15:21:09] train in BasicTrainer:
duration: 69.20439648628235s
INFO    [03-14 15:21:09] train in BasicTrainer:
epoch: 12
INFO    [03-14 15:21:40] _train_one_epoch in BasicTrainer:
loss = 8.122942783585449
INFO    [03-14 15:22:17] validate in BasicTrainer:
{'Recall@10': 0.051251453394070265, 'NDCG@10': 0.02822671937174164, 'MRR@10': 0.021223840001039208, 'Recall@5': 0.03458266272209585, 'NDCG@5': 0.0228717454476282, 'MRR@5': 0.019034779790672474, 'Recall*@10': 0.0552063093171455, 'NDCG*@10': 0.03050591087085195, 'MRR*@10': 0.022990574792493133, 'Recall*@5': 0.03732647793367505, 'NDCG*@5': 0.024759885101229884, 'MRR*@5': 0.020640455227112397}
INFO    [03-14 15:22:17] train in BasicTrainer:
duration: 68.00364112854004s
INFO    [03-14 15:22:17] train in BasicTrainer:
epoch: 13
INFO    [03-14 15:22:50] _train_one_epoch in BasicTrainer:
loss = 8.059239058935342
INFO    [03-14 15:23:27] validate in BasicTrainer:
{'Recall@10': 0.05211815261282027, 'NDCG@10': 0.028800554061308502, 'MRR@10': 0.021722725417930633, 'Recall@5': 0.03493058101739734, 'NDCG@5': 0.02327608837513253, 'MRR@5': 0.019462258520070462, 'Recall*@10': 0.05647351529914886, 'NDCG*@10': 0.03106604611966759, 'MRR*@10': 0.02334956409758888, 'Recall*@5': 0.03783170774113387, 'NDCG*@5': 0.02506676806951873, 'MRR*@5': 0.020890415500616655}
INFO    [03-14 15:23:27] train in BasicTrainer:
duration: 70.33770990371704s
INFO    [03-14 15:23:27] train in BasicTrainer:
epoch: 14
INFO    [03-14 15:23:59] _train_one_epoch in BasicTrainer:
loss = 7.998447042219445
INFO    [03-14 15:24:38] validate in BasicTrainer:
{'Recall@10': 0.0506594302598387, 'NDCG@10': 0.02819440478924662, 'MRR@10': 0.021387080347631128, 'Recall@5': 0.03364880692679435, 'NDCG@5': 0.022738653258420526, 'MRR@5': 0.01916185575246345, 'Recall*@10': 0.05449947906890884, 'NDCG*@10': 0.030223239242332056, 'MRR*@10': 0.02286820998415351, 'Recall*@5': 0.03609917888534255, 'NDCG*@5': 0.024327024148078635, 'MRR*@5': 0.020466320571722464}
INFO    [03-14 15:24:38] train in BasicTrainer:
duration: 71.13346314430237s
INFO    [03-14 15:24:38] train in BasicTrainer:
epoch: 15
INFO    [03-14 15:25:08] _train_one_epoch in BasicTrainer:
loss = 7.937872608168786
INFO    [03-14 15:25:45] validate in BasicTrainer:
{'Recall@10': 0.05058615228626877, 'NDCG@10': 0.027996584546053783, 'MRR@10': 0.02115289823850617, 'Recall@5': 0.03339245927054435, 'NDCG@5': 0.022475795063655823, 'MRR@5': 0.018896636200952343, 'Recall*@10': 0.054174118104856464, 'NDCG*@10': 0.029897783615160732, 'MRR*@10': 0.02255068107624538, 'Recall*@5': 0.03554110825643875, 'NDCG*@5': 0.023922222410328688, 'MRR*@5': 0.020112883893307298}
INFO    [03-14 15:25:45] train in BasicTrainer:
duration: 66.78019142150879s
INFO    [03-14 15:25:45] train in BasicTrainer:
epoch: 16
INFO    [03-14 15:26:16] _train_one_epoch in BasicTrainer:
loss = 7.880865308083072
INFO    [03-14 15:26:54] validate in BasicTrainer:
{'Recall@10': 0.04990255853626877, 'NDCG@10': 0.027815339143853635, 'MRR@10': 0.02112082042149268, 'Recall@5': 0.03300183427054435, 'NDCG@5': 0.02237748396000825, 'MRR@5': 0.018892663906444795, 'Recall*@10': 0.053523839230183515, 'NDCG*@10': 0.029739840782713144, 'MRR*@10': 0.02253045712132007, 'Recall*@5': 0.03542160359793343, 'NDCG*@5': 0.02391079117078334, 'MRR*@5': 0.02013928689120803}
INFO    [03-14 15:26:54] train in BasicTrainer:
duration: 68.70993328094482s
INFO    [03-14 15:26:54] train in BasicTrainer:
epoch: 17
INFO    [03-14 15:27:25] _train_one_epoch in BasicTrainer:
loss = 7.8271619064801214
INFO    [03-14 15:28:02] validate in BasicTrainer:
{'Recall@10': 0.05025054842699319, 'NDCG@10': 0.027549581608036534, 'MRR@10': 0.020676273037679493, 'Recall@5': 0.032898056611884385, 'NDCG@5': 0.02196869265171699, 'MRR@5': 0.018390758131863548, 'Recall*@10': 0.0538558101397939, 'NDCG*@10': 0.02957284822477959, 'MRR*@10': 0.02222434108844027, 'Recall*@5': 0.03505965276272036, 'NDCG*@5': 0.023525220673764124, 'MRR*@5': 0.01974621967819985}
INFO    [03-14 15:28:02] train in BasicTrainer:
duration: 68.41291332244873s
INFO    [03-14 15:28:02] train in BasicTrainer:
epoch: 18
INFO    [03-14 15:28:32] _train_one_epoch in BasicTrainer:
loss = 7.7741404654932955
INFO    [03-14 15:29:10] validate in BasicTrainer:
{'Recall@10': 0.04882833978626877, 'NDCG@10': 0.02714539324515499, 'MRR@10': 0.02057065690169111, 'Recall@5': 0.032214498659595844, 'NDCG@5': 0.021806706656934693, 'MRR@5': 0.018387411476578564, 'Recall*@10': 0.05196114244172349, 'NDCG*@10': 0.02874240423552692, 'MRR*@10': 0.021701509604463355, 'Recall*@5': 0.034206429601181296, 'NDCG*@5': 0.023038793209707364, 'MRR*@5': 0.019370162882842122}
INFO    [03-14 15:29:10] train in BasicTrainer:
duration: 67.56166172027588s
INFO    [03-14 15:29:10] train in BasicTrainer:
epoch: 19
INFO    [03-14 15:29:40] _train_one_epoch in BasicTrainer:
loss = 7.72608862404062
INFO    [03-14 15:30:18] validate in BasicTrainer:
{'Recall@10': 0.049347084923647346, 'NDCG@10': 0.027248671726556494, 'MRR@10': 0.020559612062061205, 'Recall@5': 0.03275765785365366, 'NDCG@5': 0.021936529694357887, 'MRR@5': 0.018397975453990512, 'Recall*@10': 0.052793795766774565, 'NDCG*@10': 0.02901059144642204, 'MRR*@10': 0.021812223602319138, 'Recall*@5': 0.03502669109147973, 'NDCG*@5': 0.023327337414957582, 'MRR*@5': 0.019502895770710894}
INFO    [03-14 15:30:18] train in BasicTrainer:
duration: 67.79777407646179s
INFO    [03-14 15:30:18] train in BasicTrainer:
epoch: 20
INFO    [03-14 15:30:49] _train_one_epoch in BasicTrainer:
loss = 7.6763290116766925
INFO    [03-14 15:31:27] validate in BasicTrainer:
{'Recall@10': 0.0489992740098387, 'NDCG@10': 0.026798347319709138, 'MRR@10': 0.020088731369469315, 'Recall@5': 0.031665182253345844, 'NDCG@5': 0.021248560445383192, 'MRR@5': 0.017830670019611715, 'Recall*@10': 0.05217665192903951, 'NDCG*@10': 0.028387730946997182, 'MRR*@10': 0.0212002155079972, 'Recall*@5': 0.03361275176866911, 'NDCG*@5': 0.022440426924731582, 'MRR*@5': 0.018778298984398135}
INFO    [03-14 15:31:27] train in BasicTrainer:
duration: 69.35362648963928s
INFO    [03-14 15:31:27] train in BasicTrainer:
epoch: 21
INFO    [03-14 15:31:58] _train_one_epoch in BasicTrainer:
loss = 7.63080480586247
INFO    [03-14 15:32:36] validate in BasicTrainer:
{'Recall@10': 0.04843173655681312, 'NDCG@10': 0.02691883755614981, 'MRR@10': 0.020388403796823697, 'Recall@5': 0.032269483990967275, 'NDCG@5': 0.021721792657626793, 'MRR@5': 0.018260983965592458, 'Recall*@10': 0.0513496920466423, 'NDCG*@10': 0.028271370648872106, 'MRR*@10': 0.021264370932476594, 'Recall*@5': 0.034097779606236146, 'NDCG*@5': 0.022721645567798987, 'MRR*@5': 0.018991459003882483}
INFO    [03-14 15:32:36] train in BasicTrainer:
duration: 68.73344874382019s
INFO    [03-14 15:32:36] train in BasicTrainer:
epoch: 22
INFO    [03-14 15:33:07] _train_one_epoch in BasicTrainer:
loss = 7.586060919347598
INFO    [03-14 15:33:44] validate in BasicTrainer:
{'Recall@10': 0.048126596584916116, 'NDCG@10': 0.026387671969132498, 'MRR@10': 0.019811189797474073, 'Recall@5': 0.03136616367846727, 'NDCG@5': 0.02099385635810904, 'MRR@5': 0.01760036703781225, 'Recall*@10': 0.05116630143020302, 'NDCG*@10': 0.02791423485032283, 'MRR*@10': 0.02088195360265672, 'Recall*@5': 0.03320781972724944, 'NDCG*@5': 0.022135409904876724, 'MRR*@5': 0.01851355917751789}
INFO    [03-14 15:33:44] train in BasicTrainer:
duration: 68.79068303108215s
INFO    [03-14 15:33:44] train in BasicTrainer:
epoch: 23
INFO    [03-14 15:34:15] _train_one_epoch in BasicTrainer:
loss = 7.544905112904995
INFO    [03-14 15:34:52] validate in BasicTrainer:
{'Recall@10': 0.0469485285691917, 'NDCG@10': 0.025981629226589576, 'MRR@10': 0.01964375562383793, 'Recall@5': 0.03067029130179435, 'NDCG@5': 0.020757352258078753, 'MRR@5': 0.017510749161010607, 'Recall*@10': 0.04963047005003318, 'NDCG*@10': 0.027429350290913136, 'MRR*@10': 0.020718493559979834, 'Recall*@5': 0.03237857787753455, 'NDCG*@5': 0.021896351789473557, 'MRR*@5': 0.01846172341320198}
INFO    [03-14 15:34:52] train in BasicTrainer:
duration: 67.91978931427002s
INFO    [03-14 15:34:52] train in BasicTrainer:
epoch: 24
INFO    [03-14 15:35:23] _train_one_epoch in BasicTrainer:
loss = 7.501327646880591
INFO    [03-14 15:36:02] validate in BasicTrainer:
{'Recall@10': 0.0482973876176402, 'NDCG@10': 0.026715159730520098, 'MRR@10': 0.020178424584446474, 'Recall@5': 0.03186658036429435, 'NDCG@5': 0.02144179183524102, 'MRR@5': 0.0180250660283491, 'Recall*@10': 0.05088424299610779, 'NDCG*@10': 0.02805130966589786, 'MRR*@10': 0.02113039144896902, 'Recall*@5': 0.03366449204040691, 'NDCG*@5': 0.022525096309254877, 'MRR*@5': 0.0188740229641553}
INFO    [03-14 15:36:02] train in BasicTrainer:
duration: 69.34901261329651s
INFO    [03-14 15:36:02] train in BasicTrainer:
epoch: 25
INFO    [03-14 15:36:33] _train_one_epoch in BasicTrainer:
loss = 7.463594850705785
INFO    [03-14 15:37:12] validate in BasicTrainer:
{'Recall@10': 0.04731477531604469, 'NDCG@10': 0.02592986110248603, 'MRR@10': 0.0194606902601663, 'Recall@5': 0.030755776329897344, 'NDCG@5': 0.02062333464855328, 'MRR@5': 0.01729875200544484, 'Recall*@10': 0.04998819672036916, 'NDCG*@10': 0.027157131308922545, 'MRR*@10': 0.020253960386617108, 'Recall*@5': 0.03221383506897837, 'NDCG*@5': 0.021464054464013317, 'MRR*@5': 0.017936300930159632}
INFO    [03-14 15:37:12] train in BasicTrainer:
duration: 70.32163047790527s
INFO    [03-14 15:37:12] train in BasicTrainer:
epoch: 26
INFO    [03-14 15:37:43] _train_one_epoch in BasicTrainer:
loss = 7.42713872992358
INFO    [03-14 15:38:21] validate in BasicTrainer:
{'Recall@10': 0.045776653569191694, 'NDCG@10': 0.025529601518064736, 'MRR@10': 0.019392552151111887, 'Recall@5': 0.030639791628345847, 'NDCG@5': 0.02067979163257405, 'MRR@5': 0.01741734885144979, 'Recall*@10': 0.04811917066108436, 'NDCG*@10': 0.02668001032434404, 'MRR*@10': 0.020186344330431892, 'Recall*@5': 0.03198608054080978, 'NDCG*@5': 0.021511132034356707, 'MRR*@5': 0.018081470142351463}
INFO    [03-14 15:38:21] train in BasicTrainer:
duration: 68.66225981712341s
INFO    [03-14 15:38:21] train in BasicTrainer:
epoch: 27
INFO    [03-14 15:38:50] _train_one_epoch in BasicTrainer:
loss = 7.390192337062846
INFO    [03-14 15:39:27] validate in BasicTrainer:
{'Recall@10': 0.04787626294419169, 'NDCG@10': 0.02633470300352201, 'MRR@10': 0.019809738057665525, 'Recall@5': 0.031579733034595846, 'NDCG@5': 0.021096887608291582, 'MRR@5': 0.01766678980202414, 'Recall*@10': 0.050714748993050306, 'NDCG*@10': 0.027776430489029735, 'MRR*@10': 0.02083452281076461, 'Recall*@5': 0.03322084076353349, 'NDCG*@5': 0.02215781187696848, 'MRR*@5': 0.01853804569982458}
INFO    [03-14 15:39:27] train in BasicTrainer:
duration: 66.67741894721985s
INFO    [03-14 15:39:27] train in BasicTrainer:
epoch: 28
INFO    [03-14 15:39:58] _train_one_epoch in BasicTrainer:
loss = 7.35366041252927
INFO    [03-14 15:40:36] validate in BasicTrainer:
{'Recall@10': 0.04735741042532027, 'NDCG@10': 0.026351512328255923, 'MRR@10': 0.020002314273733647, 'Recall@5': 0.03122576492605731, 'NDCG@5': 0.02118810987449251, 'MRR@5': 0.017902417620643974, 'Recall*@10': 0.050106142181903124, 'NDCG*@10': 0.02768002755474299, 'MRR*@10': 0.02090805456973612, 'Recall*@5': 0.03271755521127488, 'NDCG*@5': 0.022109228183398954, 'MRR*@5': 0.01863955408334732}
INFO    [03-14 15:40:36] train in BasicTrainer:
duration: 68.3057849407196s
INFO    [03-14 15:40:36] train in BasicTrainer:
epoch: 29
INFO    [03-14 15:41:07] _train_one_epoch in BasicTrainer:
loss = 7.321945622521622
INFO    [03-14 15:41:45] validate in BasicTrainer:
{'Recall@10': 0.04743075999431312, 'NDCG@10': 0.026312459592008963, 'MRR@10': 0.019925126747693866, 'Recall@5': 0.030951124615967274, 'NDCG@5': 0.021020620941999368, 'MRR@5': 0.017762529710307718, 'Recall*@10': 0.05001972526079044, 'NDCG*@10': 0.027569054113700985, 'MRR*@10': 0.02078083578380756, 'Recall*@5': 0.032466409652261066, 'NDCG*@5': 0.021932403440587223, 'MRR*@5': 0.018477204220835118}
INFO    [03-14 15:41:45] train in BasicTrainer:
duration: 68.80906867980957s
INFO    [03-14 15:41:45] close_training in BasicTrainer:
finished training
INFO    [03-14 15:41:45] final_validate in BasicTrainer:
validate model on val set!
INFO    [03-14 15:41:45] load_state_from_given_path in utils:
checkpoint epoch: 11
INFO    [03-14 15:41:45] load_state_from_given_path in utils:
Loading model's parameters
INFO    [03-14 15:42:22] validate in BasicTrainer:
{'Recall@10': 0.05299090164480731, 'NDCG@10': 0.029521519650006666, 'MRR@10': 0.022403504740213975, 'Recall@5': 0.03528458492364735, 'NDCG@5': 0.023834821773925798, 'MRR@5': 0.02007963302312419, 'Recall*@10': 0.05722486256854609, 'NDCG*@10': 0.031824120780220254, 'MRR*@10': 0.024120708176633344, 'Recall*@5': 0.037959600798785686, 'NDCG*@5': 0.02563449164154008, 'MRR*@5': 0.02159001008258201}
INFO    [03-14 15:42:22] test in BasicTrainer:
Test model on test set!
INFO    [03-14 15:42:22] test_with_given_state_path in BasicTrainer:
Loading model params from ___el_base_partial_2022/base_gru4rec-rate-0.8-seed-2000_03-14_15:05_t1/gru4rec_logs/checkpoint/best_acc_model.pth.
INFO    [03-14 15:42:22] load_state_from_given_path in utils:
checkpoint epoch: 11
INFO    [03-14 15:42:22] load_state_from_given_path in utils:
Loading model's parameters
INFO    [03-14 15:42:22] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [03-14 15:42:59] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.04971347483806312, 'NDCG@10': 0.02763357402291149, 'MRR@10': 0.02091301091713831, 'Recall@5': 0.033722192305140196, 'NDCG@5': 0.022490642411867157, 'MRR@5': 0.018806770798983054, 'Recall*@10': 0.0535172768170014, 'NDCG*@10': 0.029660260956734418, 'MRR*@10': 0.022386370203457774, 'Recall*@5': 0.036596870003268125, 'NDCG*@5': 0.02421572241000831, 'MRR*@5': 0.02015512889774982}
INFO    [03-14 15:42:59] _evaluate in BasicSched:
!!Final Result!!: {'Recall@10': 0.04971347483806312, 'NDCG@10': 0.02763357402291149, 'MRR@10': 0.02091301091713831, 'Recall@5': 0.033722192305140196, 'NDCG@5': 0.022490642411867157, 'MRR@5': 0.018806770798983054, 'Recall*@10': 0.0535172768170014, 'NDCG*@10': 0.029660260956734418, 'MRR*@10': 0.022386370203457774, 'Recall*@5': 0.036596870003268125, 'NDCG*@5': 0.02421572241000831, 'MRR*@5': 0.02015512889774982}
