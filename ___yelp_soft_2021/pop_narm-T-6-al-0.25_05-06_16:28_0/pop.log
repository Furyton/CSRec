INFO    [05-06 16:28:07] setup_train in utils:
{
    "experiment_dir": "___yelp_soft_2021",
    "experiment_description": "pop",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "yelp.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "alpha": 0.25,
    "T": 6,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2021,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.yelp/narm/config_distill.json",
    "task_id": -1,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "dvae_alpha": 0.5,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-06 16:28:07] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-06 16:28:07] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/yelp-5-5.pkl
INFO    [05-06 16:28:08] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-06 16:28:08] _check_dataset_cache in utils:
correct.
INFO    [05-06 16:28:08] __init__ in NextItemDataloader:
there are 20033 items in this dataset, 43947 users, padding_first? False
DEBUG   [05-06 16:28:15] generate_model in utils:
model_code_list=['pop']
INFO    [05-06 16:28:15] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-06 16:28:15] load_model_config in utils:
{}
WARNING [05-06 16:28:21] get_exist_path in utils:
dir ___yelp_soft_2021/pop_narm-T-6-al-0.25_05-06_16:28_0/teacher_pop_logs does not exist! Create one.
WARNING [05-06 16:28:21] get_exist_path in utils:
dir ___yelp_soft_2021/pop_narm-T-6-al-0.25_05-06_16:28_0/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-06 16:28:21] get_exist_path in utils:
dir ___yelp_soft_2021/pop_narm-T-6-al-0.25_05-06_16:28_0/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-06 16:28:21] get_path in utils:
Path is None
WARNING [05-06 16:28:21] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-06 16:28:21] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-06 16:28:21] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-06 16:28:21] __init__ in BasicTrainer:
229376 iter per epoch
DEBUG   [05-06 16:28:21] generate_model in utils:
model_code_list=['narm']
INFO    [05-06 16:28:21] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-06 16:28:21] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-06 16:28:24] get_exist_path in utils:
dir ___yelp_soft_2021/pop_narm-T-6-al-0.25_05-06_16:28_0/student_narm_logs does not exist! Create one.
WARNING [05-06 16:28:24] get_exist_path in utils:
dir ___yelp_soft_2021/pop_narm-T-6-al-0.25_05-06_16:28_0/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-06 16:28:24] get_exist_path in utils:
dir ___yelp_soft_2021/pop_narm-T-6-al-0.25_05-06_16:28_0/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-06 16:28:24] get_path in utils:
Path is None
WARNING [05-06 16:28:24] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-06 16:28:24] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(20034, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-06 16:28:24] assert_model_device in utils:
model student_narm has 5.3603515625 MB params.
INFO    [05-06 16:28:24] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-06 16:28:24] __init__ in DistillTrainer:
229376 iter per epoch
INFO    [05-06 16:28:24] _set_current_routine in Routine:
first routine: student
INFO    [05-06 16:28:24] run_routine in Routine:
Start routine student
INFO    [05-06 16:28:24] run_routine in Routine:
Start training
INFO    [05-06 16:28:24] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-06 16:28:43] test_mentor in DistillTrainer:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-06 16:28:43] train in DistillTrainer:
result:
{'Recall@10': 0.009426873092624273, 'NDCG@10': 0.0047718047968704595, 'MRR@10': 0.003375995396213098, 'Recall@5': 0.0055720489048822356, 'NDCG@5': 0.0035393881315196104, 'MRR@5': 0.0028754124756563792, 'Recall*@10': 0.009426873092624273, 'NDCG*@10': 0.0047718047968704595, 'MRR*@10': 0.003375995396213098, 'Recall*@5': 0.0055720489048822356, 'NDCG*@5': 0.0035393881315196104, 'MRR*@5': 0.0028754124756563792}
INFO    [05-06 16:29:02] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-06 16:29:02] validate in BasicTrainer:
{'Recall@10': 0.0005409107675818218, 'NDCG@10': 0.00022934514709049836, 'MRR@10': 0.00013887437456684313, 'Recall@5': 0.00019975142045454547, 'NDCG@5': 0.00012034841082905504, 'MRR@5': 9.469697165927342e-05, 'Recall*@10': 0.0005409107675818218, 'NDCG*@10': 0.00022934514709049836, 'MRR*@10': 0.00013887437456684313, 'Recall*@5': 0.00019975142045454547, 'NDCG*@5': 0.00012034841082905504, 'MRR*@5': 9.469697165927342e-05}
INFO    [05-06 16:29:02] train in BasicTrainer:
epoch: 0
DEBUG   [05-06 16:29:03] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 10545019
DEBUG   [05-06 16:29:03] calculate_loss in loss:
pred max in softmax: 5.0020065827993676e-05, argmax 25621749
INFO    [05-06 16:29:11] _train_one_epoch in BasicTrainer:
loss = 8.44429680279323
INFO    [05-06 16:29:29] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-06 16:29:29] validate in BasicTrainer:
{'Recall@10': 0.009400287135080858, 'NDCG@10': 0.0042979279109700156, 'MRR@10': 0.0027998987669971857, 'Recall@5': 0.004482648356563665, 'NDCG@5': 0.0027489953526211057, 'MRR@5': 0.0021849605466493153, 'Recall*@10': 0.009400287135080858, 'NDCG*@10': 0.0042979279109700156, 'MRR*@10': 0.0027998987669971857, 'Recall*@5': 0.004482648356563665, 'NDCG*@5': 0.0027489953526211057, 'MRR*@5': 0.0021849605466493153}
INFO    [05-06 16:29:29] train in BasicTrainer:
duration: 27.12827754020691s
INFO    [05-06 16:29:29] train in BasicTrainer:
epoch: 1
INFO    [05-06 16:29:38] _train_one_epoch in BasicTrainer:
loss = 7.943803940500532
INFO    [05-06 16:29:57] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-06 16:29:57] validate in BasicTrainer:
{'Recall@10': 0.020491755482825367, 'NDCG@10': 0.010132563427429308, 'MRR@10': 0.007027063815092499, 'Recall@5': 0.011906954629177397, 'NDCG@5': 0.007400617977096276, 'MRR@5': 0.005925254853950305, 'Recall*@10': 0.020491755482825367, 'NDCG*@10': 0.010132563427429308, 'MRR*@10': 0.007027063815092499, 'Recall*@5': 0.011906954629177397, 'NDCG*@5': 0.007400617977096276, 'MRR*@5': 0.005925254853950305}
INFO    [05-06 16:29:57] train in BasicTrainer:
duration: 27.734768390655518s
INFO    [05-06 16:29:57] train in BasicTrainer:
epoch: 2
INFO    [05-06 16:30:06] _train_one_epoch in BasicTrainer:
loss = 7.521485933235714
INFO    [05-06 16:30:24] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-06 16:30:25] validate in BasicTrainer:
{'Recall@10': 0.02722111124206673, 'NDCG@10': 0.01363045967776667, 'MRR@10': 0.009563239460641687, 'Recall@5': 0.01599010012366555, 'NDCG@5': 0.010033199902285229, 'MRR@5': 0.008098355494439602, 'Recall*@10': 0.02722111124206673, 'NDCG*@10': 0.01363045967776667, 'MRR*@10': 0.009563239460641687, 'Recall*@5': 0.01599010012366555, 'NDCG*@5': 0.010033199902285229, 'MRR*@5': 0.008098355494439602}
INFO    [05-06 16:30:25] train in BasicTrainer:
duration: 27.36288356781006s
INFO    [05-06 16:30:25] train in BasicTrainer:
epoch: 3
INFO    [05-06 16:30:33] _train_one_epoch in BasicTrainer:
loss = 7.312604819025312
INFO    [05-06 16:30:52] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-06 16:30:52] validate in BasicTrainer:
{'Recall@10': 0.0335896396162835, 'NDCG@10': 0.016622881405055523, 'MRR@10': 0.011536015197634697, 'Recall@5': 0.019599579951979897, 'NDCG@5': 0.012144186025993391, 'MRR@5': 0.009713957975195213, 'Recall*@10': 0.0335896396162835, 'NDCG*@10': 0.016622881405055523, 'MRR*@10': 0.011536015197634697, 'Recall*@5': 0.019599579951979897, 'NDCG*@5': 0.012144186025993391, 'MRR*@5': 0.009713957975195213}
INFO    [05-06 16:30:52] train in BasicTrainer:
duration: 27.78088879585266s
INFO    [05-06 16:30:52] train in BasicTrainer:
epoch: 4
INFO    [05-06 16:31:01] _train_one_epoch in BasicTrainer:
loss = 7.190564087459019
INFO    [05-06 16:31:20] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-06 16:31:20] validate in BasicTrainer:
{'Recall@10': 0.03688454594124447, 'NDCG@10': 0.018033454702659088, 'MRR@10': 0.012389920990575443, 'Recall@5': 0.021476558324965565, 'NDCG@5': 0.013116844675757668, 'MRR@5': 0.010398945686492052, 'Recall*@10': 0.03688454594124447, 'NDCG*@10': 0.018033454702659088, 'MRR*@10': 0.012389920990575443, 'Recall*@5': 0.021476558324965565, 'NDCG*@5': 0.013116844675757668, 'MRR*@5': 0.010398945686492052}
INFO    [05-06 16:31:20] train in BasicTrainer:
duration: 27.868306398391724s
INFO    [05-06 16:31:20] train in BasicTrainer:
epoch: 5
INFO    [05-06 16:31:29] _train_one_epoch in BasicTrainer:
loss = 7.0931011608668735
INFO    [05-06 16:31:48] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-06 16:31:48] validate in BasicTrainer:
{'Recall@10': 0.040051998739892784, 'NDCG@10': 0.020308379591865974, 'MRR@10': 0.01439313040199605, 'Recall@5': 0.0238285247575153, 'NDCG@5': 0.015116840092973276, 'MRR@5': 0.012282535518434915, 'Recall*@10': 0.040051998739892784, 'NDCG*@10': 0.020308379591865974, 'MRR*@10': 0.01439313040199605, 'Recall*@5': 0.0238285247575153, 'NDCG*@5': 0.015116840092973276, 'MRR*@5': 0.012282535518434915}
INFO    [05-06 16:31:48] train in BasicTrainer:
duration: 28.025994777679443s
INFO    [05-06 16:31:48] train in BasicTrainer:
epoch: 6
INFO    [05-06 16:31:57] _train_one_epoch in BasicTrainer:
loss = 6.992812395095825
INFO    [05-06 16:32:15] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-06 16:32:15] validate in BasicTrainer:
{'Recall@10': 0.04508566348390146, 'NDCG@10': 0.02325869571756233, 'MRR@10': 0.016696840355342083, 'Recall@5': 0.027201443063941868, 'NDCG@5': 0.017523252828554672, 'MRR@5': 0.01435720387168906, 'Recall*@10': 0.04508566348390146, 'NDCG*@10': 0.02325869571756233, 'MRR*@10': 0.016696840355342083, 'Recall*@5': 0.027201443063941868, 'NDCG*@5': 0.017523252828554672, 'MRR*@5': 0.01435720387168906}
INFO    [05-06 16:32:15] train in BasicTrainer:
duration: 27.16703748703003s
INFO    [05-06 16:32:15] train in BasicTrainer:
epoch: 7
INFO    [05-06 16:32:24] _train_one_epoch in BasicTrainer:
loss = 6.891052297183445
INFO    [05-06 16:32:43] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-06 16:32:43] validate in BasicTrainer:
{'Recall@10': 0.04916628246957606, 'NDCG@10': 0.025993112644011326, 'MRR@10': 0.01902742362157865, 'Recall@5': 0.030524258078499275, 'NDCG@5': 0.02003146284683184, 'MRR@5': 0.016606251201169056, 'Recall*@10': 0.04916628246957606, 'NDCG*@10': 0.025993112644011326, 'MRR*@10': 0.01902742362157865, 'Recall*@5': 0.030524258078499275, 'NDCG*@5': 0.02003146284683184, 'MRR*@5': 0.016606251201169056}
INFO    [05-06 16:32:43] train in BasicTrainer:
duration: 28.000773191452026s
INFO    [05-06 16:32:43] train in BasicTrainer:
epoch: 8
INFO    [05-06 16:32:52] _train_one_epoch in BasicTrainer:
loss = 6.793692656925747
INFO    [05-06 16:33:11] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-06 16:33:11] validate in BasicTrainer:
{'Recall@10': 0.051998290148648346, 'NDCG@10': 0.027844649654897777, 'MRR@10': 0.020584108985283157, 'Recall@5': 0.03241585195064545, 'NDCG@5': 0.02156430465931242, 'MRR@5': 0.018022350120273502, 'Recall*@10': 0.051998290148648346, 'NDCG*@10': 0.027844649654897777, 'MRR*@10': 0.020584108985283157, 'Recall*@5': 0.03241585195064545, 'NDCG*@5': 0.02156430465931242, 'MRR*@5': 0.018022350120273502}
INFO    [05-06 16:33:11] train in BasicTrainer:
duration: 27.529844760894775s
INFO    [05-06 16:33:11] train in BasicTrainer:
epoch: 9
INFO    [05-06 16:33:20] _train_one_epoch in BasicTrainer:
loss = 6.702156330857958
INFO    [05-06 16:33:39] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-06 16:33:39] validate in BasicTrainer:
{'Recall@10': 0.055267814208160744, 'NDCG@10': 0.03006054698066278, 'MRR@10': 0.02245037342337045, 'Recall@5': 0.03543046895753254, 'NDCG@5': 0.02369976941157471, 'MRR@5': 0.01985685146329078, 'Recall*@10': 0.055267814208160744, 'NDCG*@10': 0.03006054698066278, 'MRR*@10': 0.02245037342337045, 'Recall*@5': 0.03543046895753254, 'NDCG*@5': 0.02369976941157471, 'MRR*@5': 0.01985685146329078}
INFO    [05-06 16:33:39] train in BasicTrainer:
duration: 28.029114246368408s
INFO    [05-06 16:33:39] train in BasicTrainer:
epoch: 10
INFO    [05-06 16:33:47] _train_one_epoch in BasicTrainer:
loss = 6.61468060527529
INFO    [05-06 16:34:06] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [05-06 16:34:06] validate in BasicTrainer:
{'Recall@10': 0.060616051947528664, 'NDCG@10': 0.03342866609719666, 'MRR@10': 0.025251831859350204, 'Recall@5': 0.03889282691207799, 'NDCG@5': 0.026463754983110863, 'MRR@5': 0.022412975572726944, 'Recall*@10': 0.060616051947528664, 'NDCG*@10': 0.03342866609719666, 'MRR*@10': 0.025251831859350204, 'Recall*@5': 0.03889282691207799, 'NDCG*@5': 0.026463754983110863, 'MRR*@5': 0.022412975572726944}
INFO    [05-06 16:34:06] train in BasicTrainer:
duration: 27.40787172317505s
INFO    [05-06 16:34:06] train in BasicTrainer:
epoch: 11
INFO    [05-06 16:34:15] _train_one_epoch in BasicTrainer:
loss = 6.536791792937687
INFO    [05-06 16:34:34] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-06 16:34:34] validate in BasicTrainer:
{'Recall@10': 0.06073845313353972, 'NDCG@10': 0.03396460888060657, 'MRR@10': 0.025869296355680985, 'Recall@5': 0.040273944762620056, 'NDCG@5': 0.02741798877038739, 'MRR@5': 0.02320849048820409, 'Recall*@10': 0.06073845313353972, 'NDCG*@10': 0.03396460888060657, 'MRR*@10': 0.025869296355680985, 'Recall*@5': 0.040273944762620056, 'NDCG*@5': 0.02741798877038739, 'MRR*@5': 0.02320849048820409}
INFO    [05-06 16:34:34] train in BasicTrainer:
duration: 27.86374568939209s
INFO    [05-06 16:34:34] train in BasicTrainer:
epoch: 12
INFO    [05-06 16:34:43] _train_one_epoch in BasicTrainer:
loss = 6.462392883641379
INFO    [05-06 16:35:01] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-06 16:35:01] validate in BasicTrainer:
{'Recall@10': 0.06331741843711246, 'NDCG@10': 0.03548997843807394, 'MRR@10': 0.02712176503105597, 'Recall@5': 0.04094549708745696, 'NDCG@5': 0.02832535400309346, 'MRR@5': 0.02420568246055733, 'Recall*@10': 0.06331741843711246, 'NDCG*@10': 0.03548997843807394, 'MRR*@10': 0.02712176503105597, 'Recall*@5': 0.04094549708745696, 'NDCG*@5': 0.02832535400309346, 'MRR*@5': 0.02420568246055733}
INFO    [05-06 16:35:01] train in BasicTrainer:
duration: 27.23130702972412s
INFO    [05-06 16:35:01] train in BasicTrainer:
epoch: 13
INFO    [05-06 16:35:10] _train_one_epoch in BasicTrainer:
loss = 6.396602060113635
INFO    [05-06 16:35:29] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-06 16:35:30] validate in BasicTrainer:
{'Recall@10': 0.06652102009816603, 'NDCG@10': 0.037318033928220924, 'MRR@10': 0.028510586612603882, 'Recall@5': 0.04349150102246891, 'NDCG@5': 0.029934395612640816, 'MRR@5': 0.025500052185221153, 'Recall*@10': 0.06652102009816603, 'NDCG*@10': 0.037318033928220924, 'MRR*@10': 0.028510586612603882, 'Recall*@5': 0.04349150102246891, 'NDCG*@5': 0.029934395612640816, 'MRR*@5': 0.025500052185221153}
INFO    [05-06 16:35:30] train in BasicTrainer:
duration: 28.146620512008667s
INFO    [05-06 16:35:30] train in BasicTrainer:
epoch: 14
INFO    [05-06 16:35:38] _train_one_epoch in BasicTrainer:
loss = 6.3318162475313455
INFO    [05-06 16:35:56] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-06 16:35:57] validate in BasicTrainer:
{'Recall@10': 0.06703336062756451, 'NDCG@10': 0.03836319798772985, 'MRR@10': 0.02971847236833789, 'Recall@5': 0.044295559213920074, 'NDCG@5': 0.031072610481218857, 'MRR@5': 0.026745922524820675, 'Recall*@10': 0.06703336062756451, 'NDCG*@10': 0.03836319798772985, 'MRR*@10': 0.02971847236833789, 'Recall*@5': 0.044295559213920074, 'NDCG*@5': 0.031072610481218857, 'MRR*@5': 0.026745922524820675}
INFO    [05-06 16:35:57] train in BasicTrainer:
duration: 27.05599021911621s
INFO    [05-06 16:35:57] train in BasicTrainer:
epoch: 15
INFO    [05-06 16:36:05] _train_one_epoch in BasicTrainer:
loss = 6.270917534828186
INFO    [05-06 16:36:24] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-06 16:36:24] validate in BasicTrainer:
{'Recall@10': 0.07018884339115837, 'NDCG@10': 0.03999223052100702, 'MRR@10': 0.030896698717366566, 'Recall@5': 0.04654930328780955, 'NDCG@5': 0.03242714364420284, 'MRR@5': 0.02782054567201571, 'Recall*@10': 0.07018884339115837, 'NDCG*@10': 0.03999223052100702, 'MRR*@10': 0.030896698717366566, 'Recall*@5': 0.04654930328780955, 'NDCG*@5': 0.03242714364420284, 'MRR*@5': 0.02782054567201571}
INFO    [05-06 16:36:24] train in BasicTrainer:
duration: 27.72626566886902s
INFO    [05-06 16:36:24] train in BasicTrainer:
epoch: 16
INFO    [05-06 16:36:33] _train_one_epoch in BasicTrainer:
loss = 6.217452968869891
INFO    [05-06 16:36:51] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-06 16:36:51] validate in BasicTrainer:
{'Recall@10': 0.07168851318684491, 'NDCG@10': 0.04119651900096373, 'MRR@10': 0.03195892714641311, 'Recall@5': 0.0485194515098225, 'NDCG@5': 0.0337454155087471, 'MRR@5': 0.028907960111444645, 'Recall*@10': 0.07168851318684491, 'NDCG*@10': 0.04119651900096373, 'MRR*@10': 0.03195892714641311, 'Recall*@5': 0.0485194515098225, 'NDCG*@5': 0.0337454155087471, 'MRR*@5': 0.028907960111444645}
INFO    [05-06 16:36:51] train in BasicTrainer:
duration: 26.947521924972534s
INFO    [05-06 16:36:51] train in BasicTrainer:
epoch: 17
DEBUG   [05-06 16:36:59] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 1910365
DEBUG   [05-06 16:36:59] calculate_loss in loss:
pred max in softmax: 0.9527303576469421, argmax 1124413
DEBUG   [05-06 16:36:59] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 36509083
DEBUG   [05-06 16:36:59] calculate_loss in loss:
pred max in softmax: 0.8640215992927551, argmax 62550357
INFO    [05-06 16:37:00] _train_one_epoch in BasicTrainer:
loss = 6.165034183434078
INFO    [05-06 16:37:19] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-06 16:37:19] validate in BasicTrainer:
{'Recall@10': 0.07385335998101668, 'NDCG@10': 0.0423710901628841, 'MRR@10': 0.03284266658804633, 'Recall@5': 0.049684337255629624, 'NDCG@5': 0.03458532826466994, 'MRR@5': 0.02964684468778697, 'Recall*@10': 0.07385335998101668, 'NDCG*@10': 0.0423710901628841, 'MRR*@10': 0.03284266658804633, 'Recall*@5': 0.049684337255629624, 'NDCG*@5': 0.03458532826466994, 'MRR*@5': 0.02964684468778697}
INFO    [05-06 16:37:19] train in BasicTrainer:
duration: 27.620962381362915s
INFO    [05-06 16:37:19] train in BasicTrainer:
epoch: 18
INFO    [05-06 16:37:27] _train_one_epoch in BasicTrainer:
loss = 6.116807920592172
INFO    [05-06 16:37:46] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-06 16:37:46] validate in BasicTrainer:
{'Recall@10': 0.0749028819528493, 'NDCG@10': 0.043101721866564316, 'MRR@10': 0.03349072790958665, 'Recall@5': 0.050597503781318665, 'NDCG@5': 0.035293455150994385, 'MRR@5': 0.03029807199808684, 'Recall*@10': 0.0749028819528493, 'NDCG*@10': 0.043101721866564316, 'MRR*@10': 0.03349072790958665, 'Recall*@5': 0.050597503781318665, 'NDCG*@5': 0.035293455150994385, 'MRR*@5': 0.03029807199808684}
INFO    [05-06 16:37:46] train in BasicTrainer:
duration: 27.118560314178467s
INFO    [05-06 16:37:46] train in BasicTrainer:
epoch: 19
INFO    [05-06 16:37:54] _train_one_epoch in BasicTrainer:
loss = 6.072326055594853
INFO    [05-06 16:38:13] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-06 16:38:15] validate in BasicTrainer:
{'Recall@10': 0.07721683450720528, 'NDCG@10': 0.04482208293947307, 'MRR@10': 0.03503492237492041, 'Recall@5': 0.051799199797890404, 'NDCG@5': 0.03667075830427083, 'MRR@5': 0.03171058794991537, 'Recall*@10': 0.07721683450720528, 'NDCG*@10': 0.04482208293947307, 'MRR*@10': 0.03503492237492041, 'Recall*@5': 0.051799199797890404, 'NDCG*@5': 0.03667075830427083, 'MRR*@5': 0.03171058794991537}
INFO    [05-06 16:38:15] train in BasicTrainer:
duration: 28.739887714385986s
INFO    [05-06 16:38:15] train in BasicTrainer:
epoch: 20
INFO    [05-06 16:38:23] _train_one_epoch in BasicTrainer:
loss = 6.031009810311454
INFO    [05-06 16:38:42] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-06 16:38:42] validate in BasicTrainer:
{'Recall@10': 0.07875517958944495, 'NDCG@10': 0.04610129005529664, 'MRR@10': 0.03621277517893098, 'Recall@5': 0.053448518230156464, 'NDCG@5': 0.037958413023840294, 'MRR@5': 0.03287531046027487, 'Recall*@10': 0.07875517958944495, 'NDCG*@10': 0.04610129005529664, 'MRR*@10': 0.03621277517893098, 'Recall*@5': 0.053448518230156464, 'NDCG*@5': 0.037958413023840294, 'MRR*@5': 0.03287531046027487}
INFO    [05-06 16:38:42] train in BasicTrainer:
duration: 27.048102140426636s
INFO    [05-06 16:38:42] train in BasicTrainer:
epoch: 21
INFO    [05-06 16:38:51] _train_one_epoch in BasicTrainer:
loss = 5.988482713699341
INFO    [05-06 16:39:10] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-06 16:39:10] validate in BasicTrainer:
{'Recall@10': 0.07932147248224779, 'NDCG@10': 0.04676701094616543, 'MRR@10': 0.0369012633507902, 'Recall@5': 0.05476624010638757, 'NDCG@5': 0.03886792368509553, 'MRR@5': 0.03366584906523878, 'Recall*@10': 0.07932147248224779, 'NDCG*@10': 0.04676701094616543, 'MRR*@10': 0.0369012633507902, 'Recall*@5': 0.05476624010638757, 'NDCG*@5': 0.03886792368509553, 'MRR*@5': 0.03366584906523878}
INFO    [05-06 16:39:10] train in BasicTrainer:
duration: 27.940882921218872s
INFO    [05-06 16:39:10] train in BasicTrainer:
epoch: 22
INFO    [05-06 16:39:18] _train_one_epoch in BasicTrainer:
loss = 5.9529268230710715
INFO    [05-06 16:39:37] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-06 16:39:37] validate in BasicTrainer:
{'Recall@10': 0.08131008527495644, 'NDCG@10': 0.04786575280807235, 'MRR@10': 0.037734864110296425, 'Recall@5': 0.05573642728003589, 'NDCG@5': 0.039662750607187096, 'MRR@5': 0.034388388422402466, 'Recall*@10': 0.08131008527495644, 'NDCG*@10': 0.04786575280807235, 'MRR*@10': 0.037734864110296425, 'Recall*@5': 0.05573642728003589, 'NDCG*@5': 0.039662750607187096, 'MRR*@5': 0.034388388422402466}
INFO    [05-06 16:39:37] train in BasicTrainer:
duration: 27.07226824760437s
INFO    [05-06 16:39:37] train in BasicTrainer:
epoch: 23
INFO    [05-06 16:39:45] _train_one_epoch in BasicTrainer:
loss = 5.9159945164408
INFO    [05-06 16:40:05] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-06 16:40:05] validate in BasicTrainer:
{'Recall@10': 0.08095563270828941, 'NDCG@10': 0.04804880612275817, 'MRR@10': 0.03807367892427878, 'Recall@5': 0.05578971789641814, 'NDCG@5': 0.039939106865362686, 'MRR@5': 0.03474357622590932, 'Recall*@10': 0.08095563270828941, 'NDCG*@10': 0.04804880612275817, 'MRR*@10': 0.03807367892427878, 'Recall*@5': 0.05578971789641814, 'NDCG*@5': 0.039939106865362686, 'MRR*@5': 0.03474357622590932}
INFO    [05-06 16:40:05] train in BasicTrainer:
duration: 27.863653659820557s
INFO    [05-06 16:40:05] train in BasicTrainer:
epoch: 24
INFO    [05-06 16:40:13] _train_one_epoch in BasicTrainer:
loss = 5.881964376994541
INFO    [05-06 16:40:32] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-06 16:40:32] validate in BasicTrainer:
{'Recall@10': 0.08214337514205412, 'NDCG@10': 0.04901949993588708, 'MRR@10': 0.03894479369575327, 'Recall@5': 0.05764648555354639, 'NDCG@5': 0.041111308403990486, 'MRR@5': 0.035688694566488266, 'Recall*@10': 0.08214337514205412, 'NDCG*@10': 0.04901949993588708, 'MRR*@10': 0.03894479369575327, 'Recall*@5': 0.05764648555354639, 'NDCG*@5': 0.041111308403990486, 'MRR*@5': 0.035688694566488266}
INFO    [05-06 16:40:32] train in BasicTrainer:
duration: 27.21357250213623s
INFO    [05-06 16:40:32] train in BasicTrainer:
epoch: 25
INFO    [05-06 16:40:41] _train_one_epoch in BasicTrainer:
loss = 5.846241482666561
INFO    [05-06 16:41:00] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-06 16:41:00] validate in BasicTrainer:
{'Recall@10': 0.08214205232533542, 'NDCG@10': 0.049230347980152474, 'MRR@10': 0.03927194157784635, 'Recall@5': 0.056439075618982315, 'NDCG@5': 0.0409877168183977, 'MRR@5': 0.035910509526729584, 'Recall*@10': 0.08214205232533542, 'NDCG*@10': 0.049230347980152474, 'MRR*@10': 0.03927194157784635, 'Recall*@5': 0.056439075618982315, 'NDCG*@5': 0.0409877168183977, 'MRR*@5': 0.035910509526729584}
INFO    [05-06 16:41:00] train in BasicTrainer:
duration: 28.35836911201477s
INFO    [05-06 16:41:00] train in BasicTrainer:
epoch: 26
INFO    [05-06 16:41:09] _train_one_epoch in BasicTrainer:
loss = 5.815528001104083
INFO    [05-06 16:41:28] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [05-06 16:41:28] validate in BasicTrainer:
{'Recall@10': 0.0835675597190857, 'NDCG@10': 0.04992150583050468, 'MRR@10': 0.03969808972694657, 'Recall@5': 0.05879104205153205, 'NDCG@5': 0.04195983809503642, 'MRR@5': 0.036441579799760475, 'Recall*@10': 0.0835675597190857, 'NDCG*@10': 0.04992150583050468, 'MRR*@10': 0.03969808972694657, 'Recall*@5': 0.05879104205153205, 'NDCG*@5': 0.04195983809503642, 'MRR*@5': 0.036441579799760475}
INFO    [05-06 16:41:28] train in BasicTrainer:
duration: 27.539807558059692s
INFO    [05-06 16:41:28] train in BasicTrainer:
epoch: 27
INFO    [05-06 16:41:37] _train_one_epoch in BasicTrainer:
loss = 5.784545455660139
INFO    [05-06 16:41:56] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-06 16:41:56] validate in BasicTrainer:
{'Recall@10': 0.08362151140516455, 'NDCG@10': 0.05034909973090345, 'MRR@10': 0.04022460938854651, 'Recall@5': 0.05919307131658901, 'NDCG@5': 0.04248647527261214, 'MRR@5': 0.0370010259476575, 'Recall*@10': 0.08362151140516455, 'NDCG*@10': 0.05034909973090345, 'MRR*@10': 0.04022460938854651, 'Recall*@5': 0.05919307131658901, 'NDCG*@5': 0.04248647527261214, 'MRR*@5': 0.0370010259476575}
INFO    [05-06 16:41:56] train in BasicTrainer:
duration: 28.388524532318115s
INFO    [05-06 16:41:56] train in BasicTrainer:
epoch: 28
INFO    [05-06 16:42:05] _train_one_epoch in BasicTrainer:
loss = 5.75520350251879
INFO    [05-06 16:42:23] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-06 16:42:23] validate in BasicTrainer:
{'Recall@10': 0.08484913205558603, 'NDCG@10': 0.050937943160533905, 'MRR@10': 0.040612746368755, 'Recall@5': 0.05985638296062296, 'NDCG@5': 0.04288217357613824, 'MRR@5': 0.037303986197168175, 'Recall*@10': 0.08484913205558603, 'NDCG*@10': 0.050937943160533905, 'MRR*@10': 0.040612746368755, 'Recall*@5': 0.05985638296062296, 'NDCG*@5': 0.04288217357613824, 'MRR*@5': 0.037303986197168175}
INFO    [05-06 16:42:23] train in BasicTrainer:
duration: 27.27552890777588s
INFO    [05-06 16:42:23] train in BasicTrainer:
epoch: 29
INFO    [05-06 16:42:32] _train_one_epoch in BasicTrainer:
loss = 5.727223770959037
INFO    [05-06 16:42:52] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-06 16:42:52] validate in BasicTrainer:
{'Recall@10': 0.08471025052395734, 'NDCG@10': 0.05110137198459019, 'MRR@10': 0.04089294577186758, 'Recall@5': 0.0593573349443349, 'NDCG@5': 0.042928473177281296, 'MRR@5': 0.03753499415787784, 'Recall*@10': 0.08471025052395734, 'NDCG*@10': 0.05110137198459019, 'MRR*@10': 0.04089294577186758, 'Recall*@5': 0.0593573349443349, 'NDCG*@5': 0.042928473177281296, 'MRR*@5': 0.03753499415787784}
INFO    [05-06 16:42:52] train in BasicTrainer:
duration: 28.4381320476532s
INFO    [05-06 16:42:52] train in BasicTrainer:
epoch: 30
INFO    [05-06 16:43:00] _train_one_epoch in BasicTrainer:
loss = 5.700662774699075
INFO    [05-06 16:43:19] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [05-06 16:43:19] validate in BasicTrainer:
{'Recall@10': 0.08530445261435075, 'NDCG@10': 0.05161987956274639, 'MRR@10': 0.04139980978586457, 'Recall@5': 0.0596794875508005, 'NDCG@5': 0.04340163618326187, 'MRR@5': 0.03804840418425473, 'Recall*@10': 0.08530445261435075, 'NDCG*@10': 0.05161987956274639, 'MRR*@10': 0.04139980978586457, 'Recall*@5': 0.0596794875508005, 'NDCG*@5': 0.04340163618326187, 'MRR*@5': 0.03804840418425473}
INFO    [05-06 16:43:19] train in BasicTrainer:
duration: 27.458995580673218s
INFO    [05-06 16:43:19] train in BasicTrainer:
epoch: 31
INFO    [05-06 16:43:28] _train_one_epoch in BasicTrainer:
loss = 5.671855986118317
INFO    [05-06 16:43:47] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-06 16:43:47] validate in BasicTrainer:
{'Recall@10': 0.08686817979270761, 'NDCG@10': 0.05256323787299069, 'MRR@10': 0.04215203293345191, 'Recall@5': 0.06121278012340719, 'NDCG@5': 0.04432051493362947, 'MRR@5': 0.03878179903734814, 'Recall*@10': 0.08686817979270761, 'NDCG*@10': 0.05256323787299069, 'MRR*@10': 0.04215203293345191, 'Recall*@5': 0.06121278012340719, 'NDCG*@5': 0.04432051493362947, 'MRR*@5': 0.03878179903734814}
INFO    [05-06 16:43:47] train in BasicTrainer:
duration: 27.329394102096558s
INFO    [05-06 16:43:47] train in BasicTrainer:
epoch: 32
INFO    [05-06 16:43:55] _train_one_epoch in BasicTrainer:
loss = 5.647448267255511
INFO    [05-06 16:44:14] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-06 16:44:15] validate in BasicTrainer:
{'Recall@10': 0.08706925402988087, 'NDCG@10': 0.052604573355479675, 'MRR@10': 0.04214641180905429, 'Recall@5': 0.06081580336798321, 'NDCG@5': 0.04414183307777752, 'MRR@5': 0.03866900943896987, 'Recall*@10': 0.08706925402988087, 'NDCG*@10': 0.052604573355479675, 'MRR*@10': 0.04214641180905429, 'Recall*@5': 0.06081580336798321, 'NDCG*@5': 0.04414183307777752, 'MRR*@5': 0.03866900943896987}
INFO    [05-06 16:44:15] train in BasicTrainer:
duration: 27.90501642227173s
INFO    [05-06 16:44:15] train in BasicTrainer:
epoch: 33
INFO    [05-06 16:44:23] _train_one_epoch in BasicTrainer:
loss = 5.6276953390666415
INFO    [05-06 16:44:42] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-06 16:44:42] validate in BasicTrainer:
{'Recall@10': 0.08752577751874924, 'NDCG@10': 0.05330412902615287, 'MRR@10': 0.042896857993169266, 'Recall@5': 0.06199783154509284, 'NDCG@5': 0.0450815429741686, 'MRR@5': 0.03952260484749621, 'Recall*@10': 0.08752577751874924, 'NDCG*@10': 0.05330412902615287, 'MRR*@10': 0.042896857993169266, 'Recall*@5': 0.06199783154509284, 'NDCG*@5': 0.0450815429741686, 'MRR*@5': 0.03952260484749621}
INFO    [05-06 16:44:42] train in BasicTrainer:
duration: 27.207879781723022s
INFO    [05-06 16:44:42] train in BasicTrainer:
epoch: 34
INFO    [05-06 16:44:50] _train_one_epoch in BasicTrainer:
loss = 5.60272182737078
INFO    [05-06 16:45:09] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-06 16:45:10] validate in BasicTrainer:
{'Recall@10': 0.08820238235321912, 'NDCG@10': 0.05383669280193069, 'MRR@10': 0.04338847710327669, 'Recall@5': 0.0631766715510325, 'NDCG@5': 0.045792037790471855, 'MRR@5': 0.040096344595605675, 'Recall*@10': 0.08820238235321912, 'NDCG*@10': 0.05383669280193069, 'MRR*@10': 0.04338847710327669, 'Recall*@5': 0.0631766715510325, 'NDCG*@5': 0.045792037790471855, 'MRR*@5': 0.040096344595605675}
INFO    [05-06 16:45:10] train in BasicTrainer:
duration: 27.772053003311157s
INFO    [05-06 16:45:10] train in BasicTrainer:
epoch: 35
DEBUG   [05-06 16:45:15] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 5716825
DEBUG   [05-06 16:45:15] calculate_loss in loss:
pred max in softmax: 0.9654468297958374, argmax 15148729
DEBUG   [05-06 16:45:16] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 6538219
DEBUG   [05-06 16:45:16] calculate_loss in loss:
pred max in softmax: 0.8726661205291748, argmax 53722458
INFO    [05-06 16:45:18] _train_one_epoch in BasicTrainer:
loss = 5.579532555171421
INFO    [05-06 16:45:36] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-06 16:45:37] validate in BasicTrainer:
{'Recall@10': 0.08896842666647652, 'NDCG@10': 0.054654023186727005, 'MRR@10': 0.044215759431773964, 'Recall@5': 0.06409994343465025, 'NDCG@5': 0.046679242768070915, 'MRR@5': 0.04096390814943747, 'Recall*@10': 0.08896842666647652, 'NDCG*@10': 0.054654023186727005, 'MRR*@10': 0.044215759431773964, 'Recall*@5': 0.06409994343465025, 'NDCG*@5': 0.046679242768070915, 'MRR*@5': 0.04096390814943747}
INFO    [05-06 16:45:37] train in BasicTrainer:
duration: 27.076632738113403s
INFO    [05-06 16:45:37] train in BasicTrainer:
epoch: 36
INFO    [05-06 16:45:45] _train_one_epoch in BasicTrainer:
loss = 5.558493639741625
INFO    [05-06 16:46:04] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-06 16:46:04] validate in BasicTrainer:
{'Recall@10': 0.08968184143304825, 'NDCG@10': 0.05515062030066143, 'MRR@10': 0.04466127028519457, 'Recall@5': 0.06413861872120337, 'NDCG@5': 0.046940811994400894, 'MRR@5': 0.04130330715667118, 'Recall*@10': 0.08968184143304825, 'NDCG*@10': 0.05515062030066143, 'MRR*@10': 0.04466127028519457, 'Recall*@5': 0.06413861872120337, 'NDCG*@5': 0.046940811994400894, 'MRR*@5': 0.04130330715667118}
INFO    [05-06 16:46:04] train in BasicTrainer:
duration: 27.804899215698242s
INFO    [05-06 16:46:04] train in BasicTrainer:
epoch: 37
INFO    [05-06 16:46:13] _train_one_epoch in BasicTrainer:
loss = 5.537881433963776
INFO    [05-06 16:46:31] validate in BasicTrainer:
{'Recall@10': 0.08848080716349861, 'NDCG@10': 0.054869547824967994, 'MRR@10': 0.04462413794615052, 'Recall@5': 0.06441066786646843, 'NDCG@5': 0.0471257631751624, 'MRR@5': 0.04145156558264385, 'Recall*@10': 0.08848080716349861, 'NDCG*@10': 0.054869547824967994, 'MRR*@10': 0.04462413794615052, 'Recall*@5': 0.06441066786646843, 'NDCG*@5': 0.0471257631751624, 'MRR*@5': 0.04145156558264385}
INFO    [05-06 16:46:31] train in BasicTrainer:
duration: 26.65866231918335s
INFO    [05-06 16:46:31] train in BasicTrainer:
epoch: 38
INFO    [05-06 16:46:40] _train_one_epoch in BasicTrainer:
loss = 5.514644750526974
INFO    [05-06 16:46:59] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-06 16:46:59] validate in BasicTrainer:
{'Recall@10': 0.08926772326231003, 'NDCG@10': 0.055378596552393654, 'MRR@10': 0.045044302601705895, 'Recall@5': 0.0651373758234761, 'NDCG@5': 0.04765011268583211, 'MRR@5': 0.0418986285274679, 'Recall*@10': 0.08926772326231003, 'NDCG*@10': 0.055378596552393654, 'MRR*@10': 0.045044302601705895, 'Recall*@5': 0.0651373758234761, 'NDCG*@5': 0.04765011268583211, 'MRR*@5': 0.0418986285274679}
INFO    [05-06 16:46:59] train in BasicTrainer:
duration: 27.804357051849365s
INFO    [05-06 16:46:59] train in BasicTrainer:
epoch: 39
INFO    [05-06 16:47:07] _train_one_epoch in BasicTrainer:
loss = 5.495289896215711
INFO    [05-06 16:47:26] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [05-06 16:47:26] validate in BasicTrainer:
{'Recall@10': 0.09107372638854114, 'NDCG@10': 0.05601246146993204, 'MRR@10': 0.045329950749874115, 'Recall@5': 0.06598329679532484, 'NDCG@5': 0.04793037406422875, 'MRR@5': 0.042013169689611954, 'Recall*@10': 0.09107372638854114, 'NDCG*@10': 0.05601246146993204, 'MRR*@10': 0.045329950749874115, 'Recall*@5': 0.06598329679532484, 'NDCG*@5': 0.04793037406422875, 'MRR*@5': 0.042013169689611954}
INFO    [05-06 16:47:26] train in BasicTrainer:
duration: 26.95820450782776s
INFO    [05-06 16:47:26] train in BasicTrainer:
epoch: 40
INFO    [05-06 16:47:35] _train_one_epoch in BasicTrainer:
loss = 5.474521321909768
INFO    [05-06 16:47:54] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [05-06 16:47:54] validate in BasicTrainer:
{'Recall@10': 0.09086134352467277, 'NDCG@10': 0.05609192868525332, 'MRR@10': 0.045497271486304024, 'Recall@5': 0.06573663008483974, 'NDCG@5': 0.048009363087740814, 'MRR@5': 0.04218603467399424, 'Recall*@10': 0.09086134352467277, 'NDCG*@10': 0.05609192868525332, 'MRR*@10': 0.045497271486304024, 'Recall*@5': 0.06573663008483974, 'NDCG*@5': 0.048009363087740814, 'MRR*@5': 0.04218603467399424}
INFO    [05-06 16:47:54] train in BasicTrainer:
duration: 27.833844661712646s
INFO    [05-06 16:47:54] train in BasicTrainer:
epoch: 41
INFO    [05-06 16:48:02] _train_one_epoch in BasicTrainer:
loss = 5.456926609788622
INFO    [05-06 16:48:21] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-06 16:48:21] validate in BasicTrainer:
{'Recall@10': 0.0911359190940857, 'NDCG@10': 0.05660893869670955, 'MRR@10': 0.04609225283969532, 'Recall@5': 0.0660981187088923, 'NDCG@5': 0.04854713109406558, 'MRR@5': 0.04278574375943704, 'Recall*@10': 0.0911359190940857, 'NDCG*@10': 0.05660893869670955, 'MRR*@10': 0.04609225283969532, 'Recall*@5': 0.0660981187088923, 'NDCG*@5': 0.04854713109406558, 'MRR*@5': 0.04278574375943704}
INFO    [05-06 16:48:21] train in BasicTrainer:
duration: 27.397929430007935s
INFO    [05-06 16:48:21] train in BasicTrainer:
epoch: 42
INFO    [05-06 16:48:30] _train_one_epoch in BasicTrainer:
loss = 5.435337671211788
INFO    [05-06 16:48:49] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-06 16:48:49] validate in BasicTrainer:
{'Recall@10': 0.09210357950492339, 'NDCG@10': 0.05680278519337827, 'MRR@10': 0.04603089730847965, 'Recall@5': 0.06695733320983974, 'NDCG@5': 0.04870591515844518, 'MRR@5': 0.04270959340713241, 'Recall*@10': 0.09210357950492339, 'NDCG*@10': 0.05680278519337827, 'MRR*@10': 0.04603089730847965, 'Recall*@5': 0.06695733320983974, 'NDCG*@5': 0.04870591515844518, 'MRR*@5': 0.04270959340713241}
INFO    [05-06 16:48:49] train in BasicTrainer:
duration: 27.572632312774658s
INFO    [05-06 16:48:49] train in BasicTrainer:
epoch: 43
INFO    [05-06 16:48:57] _train_one_epoch in BasicTrainer:
loss = 5.419414630958012
INFO    [05-06 16:49:16] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [05-06 16:49:16] validate in BasicTrainer:
{'Recall@10': 0.09402055564251813, 'NDCG@10': 0.057578764517198906, 'MRR@10': 0.04648511890660633, 'Recall@5': 0.06737584282051433, 'NDCG@5': 0.04902744496410543, 'MRR@5': 0.042993493039499626, 'Recall*@10': 0.09402055564251813, 'NDCG*@10': 0.057578764517198906, 'MRR*@10': 0.04648511890660633, 'Recall*@5': 0.06737584282051433, 'NDCG*@5': 0.04902744496410543, 'MRR*@5': 0.042993493039499626}
INFO    [05-06 16:49:16] train in BasicTrainer:
duration: 27.271134614944458s
INFO    [05-06 16:49:16] train in BasicTrainer:
epoch: 44
INFO    [05-06 16:49:24] _train_one_epoch in BasicTrainer:
loss = 5.402461179665157
INFO    [05-06 16:49:43] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-06 16:49:44] validate in BasicTrainer:
{'Recall@10': 0.09238320792263205, 'NDCG@10': 0.057757020335305824, 'MRR@10': 0.04717976227402687, 'Recall@5': 0.06851600787856361, 'NDCG@5': 0.050098964097824966, 'MRR@5': 0.04405453496358611, 'Recall*@10': 0.09238320792263205, 'NDCG*@10': 0.057757020335305824, 'MRR*@10': 0.04717976227402687, 'Recall*@5': 0.06851600787856361, 'NDCG*@5': 0.050098964097824966, 'MRR*@5': 0.04405453496358611}
INFO    [05-06 16:49:44] train in BasicTrainer:
duration: 27.770475387573242s
INFO    [05-06 16:49:44] train in BasicTrainer:
epoch: 45
INFO    [05-06 16:49:52] _train_one_epoch in BasicTrainer:
loss = 5.383484184741974
INFO    [05-06 16:50:11] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [05-06 16:50:11] validate in BasicTrainer:
{'Recall@10': 0.09382651814005592, 'NDCG@10': 0.05856975167989731, 'MRR@10': 0.047824992713603104, 'Recall@5': 0.06803915446454828, 'NDCG@5': 0.050267535177144135, 'MRR@5': 0.044420458037744866, 'Recall*@10': 0.09382651814005592, 'NDCG*@10': 0.05856975167989731, 'MRR*@10': 0.047824992713603104, 'Recall*@5': 0.06803915446454828, 'NDCG*@5': 0.050267535177144135, 'MRR*@5': 0.044420458037744866}
INFO    [05-06 16:50:11] train in BasicTrainer:
duration: 27.1329665184021s
INFO    [05-06 16:50:11] train in BasicTrainer:
epoch: 46
INFO    [05-06 16:50:20] _train_one_epoch in BasicTrainer:
loss = 5.367284604481289
INFO    [05-06 16:50:39] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-06 16:50:39] validate in BasicTrainer:
{'Recall@10': 0.09474407610568134, 'NDCG@10': 0.0590289096263322, 'MRR@10': 0.048150111328471794, 'Recall@5': 0.06868213686076077, 'NDCG@5': 0.05062492632053115, 'MRR@5': 0.0446954146027565, 'Recall*@10': 0.09474407610568134, 'NDCG*@10': 0.0590289096263322, 'MRR*@10': 0.048150111328471794, 'Recall*@5': 0.06868213686076077, 'NDCG*@5': 0.05062492632053115, 'MRR*@5': 0.0446954146027565}
INFO    [05-06 16:50:39] train in BasicTrainer:
duration: 28.29231905937195s
INFO    [05-06 16:50:39] train in BasicTrainer:
epoch: 47
INFO    [05-06 16:50:48] _train_one_epoch in BasicTrainer:
loss = 5.354181638785771
INFO    [05-06 16:51:06] log in loggers:
Update Best NDCG@10 Model at 47
INFO    [05-06 16:51:06] validate in BasicTrainer:
{'Recall@10': 0.09443082524971529, 'NDCG@10': 0.059117964722893455, 'MRR@10': 0.04834902286529541, 'Recall@5': 0.0691038343039426, 'NDCG@5': 0.05096547508781606, 'MRR@5': 0.045006032694469796, 'Recall*@10': 0.09443082524971529, 'NDCG*@10': 0.059117964722893455, 'MRR*@10': 0.04834902286529541, 'Recall*@5': 0.0691038343039426, 'NDCG*@5': 0.05096547508781606, 'MRR*@5': 0.045006032694469796}
INFO    [05-06 16:51:06] train in BasicTrainer:
duration: 27.02049493789673s
INFO    [05-06 16:51:06] train in BasicTrainer:
epoch: 48
INFO    [05-06 16:51:14] _train_one_epoch in BasicTrainer:
loss = 5.337487918989999
INFO    [05-06 16:51:34] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-06 16:51:34] validate in BasicTrainer:
{'Recall@10': 0.09522411701354114, 'NDCG@10': 0.059788049960678276, 'MRR@10': 0.048980731178413735, 'Recall@5': 0.07012225958434018, 'NDCG@5': 0.0516986298290166, 'MRR@5': 0.045658072287386116, 'Recall*@10': 0.09522411701354114, 'NDCG*@10': 0.059788049960678276, 'MRR*@10': 0.048980731178413735, 'Recall*@5': 0.07012225958434018, 'NDCG*@5': 0.0516986298290166, 'MRR*@5': 0.045658072287386116}
INFO    [05-06 16:51:34] train in BasicTrainer:
duration: 27.547738313674927s
INFO    [05-06 16:51:34] train in BasicTrainer:
epoch: 49
INFO    [05-06 16:51:43] _train_one_epoch in BasicTrainer:
loss = 5.319433110100882
INFO    [05-06 16:52:01] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-06 16:52:01] validate in BasicTrainer:
{'Recall@10': 0.09476945820179852, 'NDCG@10': 0.05987946993925355, 'MRR@10': 0.04923387887802991, 'Recall@5': 0.06987811895934018, 'NDCG@5': 0.051857636056163094, 'MRR@5': 0.045938836579973046, 'Recall*@10': 0.09476945820179852, 'NDCG*@10': 0.05987946993925355, 'MRR*@10': 0.04923387887802991, 'Recall*@5': 0.06987811895934018, 'NDCG*@5': 0.051857636056163094, 'MRR*@5': 0.045938836579973046}
INFO    [05-06 16:52:01] train in BasicTrainer:
duration: 27.529178380966187s
INFO    [05-06 16:52:01] train in BasicTrainer:
epoch: 50
INFO    [05-06 16:52:10] _train_one_epoch in BasicTrainer:
loss = 5.306983802999769
INFO    [05-06 16:52:29] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-06 16:52:29] validate in BasicTrainer:
{'Recall@10': 0.0957238260995258, 'NDCG@10': 0.06032369522885843, 'MRR@10': 0.049528213387185875, 'Recall@5': 0.07038859481161291, 'NDCG@5': 0.0521636771207506, 'MRR@5': 0.04617955569516529, 'Recall*@10': 0.0957238260995258, 'NDCG*@10': 0.06032369522885843, 'MRR*@10': 0.049528213387185875, 'Recall*@5': 0.07038859481161291, 'NDCG*@5': 0.0521636771207506, 'MRR*@5': 0.04617955569516529}
INFO    [05-06 16:52:29] train in BasicTrainer:
duration: 27.94810128211975s
INFO    [05-06 16:52:29] train in BasicTrainer:
epoch: 51
INFO    [05-06 16:52:38] _train_one_epoch in BasicTrainer:
loss = 5.2893968394824435
INFO    [05-06 16:52:56] validate in BasicTrainer:
{'Recall@10': 0.09579798917878758, 'NDCG@10': 0.06015061180699955, 'MRR@10': 0.04929503561420874, 'Recall@5': 0.06980010731653734, 'NDCG@5': 0.05179311199621721, 'MRR@5': 0.04587440632961013, 'Recall*@10': 0.09579798917878758, 'NDCG*@10': 0.06015061180699955, 'MRR*@10': 0.04929503561420874, 'Recall*@5': 0.06980010731653734, 'NDCG*@5': 0.05179311199621721, 'MRR*@5': 0.04587440632961013}
INFO    [05-06 16:52:56] train in BasicTrainer:
duration: 26.836374044418335s
INFO    [05-06 16:52:56] train in BasicTrainer:
epoch: 52
INFO    [05-06 16:53:05] _train_one_epoch in BasicTrainer:
loss = 5.27498779126576
INFO    [05-06 16:53:24] log in loggers:
Update Best NDCG@10 Model at 52
INFO    [05-06 16:53:25] validate in BasicTrainer:
{'Recall@10': 0.09535475820302963, 'NDCG@10': 0.060431767255067825, 'MRR@10': 0.049768825484947724, 'Recall@5': 0.0705357166853818, 'NDCG@5': 0.052453887394883415, 'MRR@5': 0.04650497334924611, 'Recall*@10': 0.09535475820302963, 'NDCG*@10': 0.060431767255067825, 'MRR*@10': 0.049768825484947724, 'Recall*@5': 0.0705357166853818, 'NDCG*@5': 0.052453887394883415, 'MRR*@5': 0.04650497334924611}
INFO    [05-06 16:53:25] train in BasicTrainer:
duration: 28.463695526123047s
INFO    [05-06 16:53:25] train in BasicTrainer:
epoch: 53
DEBUG   [05-06 16:53:30] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 2591521
DEBUG   [05-06 16:53:30] calculate_loss in loss:
pred max in softmax: 0.9305376410484314, argmax 28704290
DEBUG   [05-06 16:53:30] calculate_loss in loss:
soft_target max: 0.5001249313354492, argmax 50572951
DEBUG   [05-06 16:53:30] calculate_loss in loss:
pred max in softmax: 0.9861019849777222, argmax 10748549
INFO    [05-06 16:53:33] _train_one_epoch in BasicTrainer:
loss = 5.2650607994624545
INFO    [05-06 16:53:52] log in loggers:
Update Best NDCG@10 Model at 53
INFO    [05-06 16:53:52] validate in BasicTrainer:
{'Recall@10': 0.0966997275298292, 'NDCG@10': 0.06106998094103553, 'MRR@10': 0.05021527003158222, 'Recall@5': 0.07112167809497226, 'NDCG@5': 0.052849311381578445, 'MRR@5': 0.04685166274959391, 'Recall*@10': 0.0966997275298292, 'NDCG*@10': 0.06106998094103553, 'MRR*@10': 0.05021527003158222, 'Recall*@5': 0.07112167809497226, 'NDCG*@5': 0.052849311381578445, 'MRR*@5': 0.04685166274959391}
INFO    [05-06 16:53:52] train in BasicTrainer:
duration: 27.18170952796936s
INFO    [05-06 16:53:52] train in BasicTrainer:
epoch: 54
INFO    [05-06 16:54:01] _train_one_epoch in BasicTrainer:
loss = 5.2523967283112665
INFO    [05-06 16:54:20] log in loggers:
Update Best NDCG@10 Model at 54
INFO    [05-06 16:54:20] validate in BasicTrainer:
{'Recall@10': 0.09673906388607892, 'NDCG@10': 0.0616335350681435, 'MRR@10': 0.05090524899688634, 'Recall@5': 0.07153633914210579, 'NDCG@5': 0.053492224351926285, 'MRR@5': 0.047550117766315285, 'Recall*@10': 0.09673906388607892, 'NDCG*@10': 0.0616335350681435, 'MRR*@10': 0.05090524899688634, 'Recall*@5': 0.07153633914210579, 'NDCG*@5': 0.053492224351926285, 'MRR*@5': 0.047550117766315285}
INFO    [05-06 16:54:20] train in BasicTrainer:
duration: 28.304492712020874s
INFO    [05-06 16:54:20] train in BasicTrainer:
epoch: 55
INFO    [05-06 16:54:29] _train_one_epoch in BasicTrainer:
loss = 5.237660910402026
INFO    [05-06 16:54:47] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [05-06 16:54:47] validate in BasicTrainer:
{'Recall@10': 0.09692167355255647, 'NDCG@10': 0.06197346408258785, 'MRR@10': 0.05127888240597465, 'Recall@5': 0.07223327322439714, 'NDCG@5': 0.05400016023354097, 'MRR@5': 0.047994130714373154, 'Recall*@10': 0.09692167355255647, 'NDCG*@10': 0.06197346408258785, 'MRR*@10': 0.05127888240597465, 'Recall*@5': 0.07223327322439714, 'NDCG*@5': 0.05400016023354097, 'MRR*@5': 0.047994130714373154}
INFO    [05-06 16:54:47] train in BasicTrainer:
duration: 27.346256971359253s
INFO    [05-06 16:54:47] train in BasicTrainer:
epoch: 56
INFO    [05-06 16:54:56] _train_one_epoch in BasicTrainer:
loss = 5.227543090070997
INFO    [05-06 16:55:16] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-06 16:55:16] validate in BasicTrainer:
{'Recall@10': 0.09763190082528374, 'NDCG@10': 0.06259479136629538, 'MRR@10': 0.05189272659746083, 'Recall@5': 0.07266573743386702, 'NDCG@5': 0.05455354228615761, 'MRR@5': 0.04859281873161143, 'Recall*@10': 0.09763190082528374, 'NDCG*@10': 0.06259479136629538, 'MRR*@10': 0.05189272659746083, 'Recall*@5': 0.07266573743386702, 'NDCG*@5': 0.05455354228615761, 'MRR*@5': 0.04859281873161143}
INFO    [05-06 16:55:16] train in BasicTrainer:
duration: 28.37372660636902s
INFO    [05-06 16:55:16] train in BasicTrainer:
epoch: 57
INFO    [05-06 16:55:24] _train_one_epoch in BasicTrainer:
loss = 5.214157896382468
INFO    [05-06 16:55:43] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-06 16:55:43] validate in BasicTrainer:
{'Recall@10': 0.09835289486429909, 'NDCG@10': 0.06260722096670758, 'MRR@10': 0.051692520691589874, 'Recall@5': 0.07297008620067076, 'NDCG@5': 0.05445170131596652, 'MRR@5': 0.048357686535878616, 'Recall*@10': 0.09835289486429909, 'NDCG*@10': 0.06260722096670758, 'MRR*@10': 0.051692520691589874, 'Recall*@5': 0.07297008620067076, 'NDCG*@5': 0.05445170131596652, 'MRR*@5': 0.048357686535878616}
INFO    [05-06 16:55:43] train in BasicTrainer:
duration: 27.63505220413208s
INFO    [05-06 16:55:43] train in BasicTrainer:
epoch: 58
INFO    [05-06 16:55:52] _train_one_epoch in BasicTrainer:
loss = 5.202722455774035
INFO    [05-06 16:56:10] log in loggers:
Update Best NDCG@10 Model at 58
INFO    [05-06 16:56:10] validate in BasicTrainer:
{'Recall@10': 0.09896357696164738, 'NDCG@10': 0.06324637444181876, 'MRR@10': 0.052350992167537864, 'Recall@5': 0.07328147237951105, 'NDCG@5': 0.05500010265545412, 'MRR@5': 0.048981354317881844, 'Recall*@10': 0.09896357696164738, 'NDCG*@10': 0.06324637444181876, 'MRR*@10': 0.052350992167537864, 'Recall*@5': 0.07328147237951105, 'NDCG*@5': 0.05500010265545412, 'MRR*@5': 0.048981354317881844}
INFO    [05-06 16:56:10] train in BasicTrainer:
duration: 26.974769353866577s
INFO    [05-06 16:56:10] train in BasicTrainer:
epoch: 59
INFO    [05-06 16:56:19] _train_one_epoch in BasicTrainer:
loss = 5.190995131220136
INFO    [05-06 16:56:38] validate in BasicTrainer:
{'Recall@10': 0.0982444475997578, 'NDCG@10': 0.06265454028140414, 'MRR@10': 0.05179719254374504, 'Recall@5': 0.07230490987951105, 'NDCG@5': 0.054270039227875794, 'MRR@5': 0.04833885316144337, 'Recall*@10': 0.0982444475997578, 'NDCG*@10': 0.06265454028140414, 'MRR*@10': 0.05179719254374504, 'Recall*@5': 0.07230490987951105, 'NDCG*@5': 0.054270039227875794, 'MRR*@5': 0.04833885316144337}
INFO    [05-06 16:56:38] train in BasicTrainer:
duration: 27.409343004226685s
INFO    [05-06 16:56:38] close_training in BasicTrainer:
finished training
DEBUG   [05-06 16:56:38] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3361 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-06 16:56:38] run_routine in Routine:
Finished training, Start final validation
INFO    [05-06 16:56:38] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-06 16:56:38] load_state_from_given_path in utils:
checkpoint epoch: 58
INFO    [05-06 16:56:38] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-06 16:56:56] validate in BasicTrainer:
{'Recall@10': 0.09896357696164738, 'NDCG@10': 0.06324637444181876, 'MRR@10': 0.052350992167537864, 'Recall@5': 0.07328147237951105, 'NDCG@5': 0.05500010265545412, 'MRR@5': 0.048981354317881844, 'Recall*@10': 0.09896357696164738, 'NDCG*@10': 0.06324637444181876, 'MRR*@10': 0.052350992167537864, 'Recall*@5': 0.07328147237951105, 'NDCG*@5': 0.05500010265545412, 'MRR*@5': 0.048981354317881844}
INFO    [05-06 16:56:56] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.09896357696164738, 'NDCG@10': 0.06324637444181876, 'MRR@10': 0.052350992167537864, 'Recall@5': 0.07328147237951105, 'NDCG@5': 0.05500010265545412, 'MRR@5': 0.048981354317881844, 'Recall*@10': 0.09896357696164738, 'NDCG*@10': 0.06324637444181876, 'MRR*@10': 0.052350992167537864, 'Recall*@5': 0.07328147237951105, 'NDCG*@5': 0.05500010265545412, 'MRR*@5': 0.048981354317881844}
INFO    [05-06 16:56:56] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-06 16:56:56] test in BasicTrainer:
Test model on test set!
INFO    [05-06 16:56:56] test_with_given_state_path in BasicTrainer:
Loading model params from ___yelp_soft_2021/pop_narm-T-6-al-0.25_05-06_16:28_0/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-06 16:56:56] load_state_from_given_path in utils:
checkpoint epoch: 58
INFO    [05-06 16:56:56] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-06 16:56:56] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-06 16:57:15] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.0799942287531766, 'NDCG@10': 0.049349906092340294, 'MRR@10': 0.04001105001026934, 'Recall@5': 0.058087732304226265, 'NDCG@5': 0.04230678454041481, 'MRR@5': 0.037128451534292915, 'Recall*@10': 0.0799942287531766, 'NDCG*@10': 0.049349906092340294, 'MRR*@10': 0.04001105001026934, 'Recall*@5': 0.058087732304226265, 'NDCG*@5': 0.04230678454041481, 'MRR*@5': 0.037128451534292915}
INFO    [05-06 16:57:15] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.0799942287531766, 'NDCG@10': 0.049349906092340294, 'MRR@10': 0.04001105001026934, 'Recall@5': 0.058087732304226265, 'NDCG@5': 0.04230678454041481, 'MRR@5': 0.037128451534292915, 'Recall*@10': 0.0799942287531766, 'NDCG*@10': 0.049349906092340294, 'MRR*@10': 0.04001105001026934, 'Recall*@5': 0.058087732304226265, 'NDCG*@5': 0.04230678454041481, 'MRR*@5': 0.037128451534292915}
