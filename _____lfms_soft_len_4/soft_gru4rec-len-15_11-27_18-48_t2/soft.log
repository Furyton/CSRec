INFO    [11-27 18:48:34] setup_train in utils:
{
    "experiment_dir": "_____lfms_soft_len_4",
    "experiment_description": "soft",
    "describe": "{config[model_code]}-len-{config[max_len]}",
    "dataset_name": "lastfm_small.csv",
    "sched": "distill",
    "model_code": "gru4rec",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "dvae_alpha": 0.5,
    "alpha": 0.5,
    "T": 3,
    "num_epochs": 80,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 15,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2021,
    "load_processed_dataset": false,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 1024,
    "val_batch_size": 1024,
    "test_batch_size": 1024,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.lastfm_small/gru4rec/config_distill.json",
    "task_id": 2,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [11-27 18:48:34] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_gru4rec
INFO    [11-27 18:48:34] _gen_dataset in utils:
processing dataset lastfm_small.csv
INFO    [11-27 18:48:34] _drop_cold in utils:
filtering out cold users (who interacts with less or eq than 5 items) and cold items (which is interacted by less or eq than 5 users)
DEBUG   [11-27 18:48:34] _drop_cold in utils:
before filtering, there are 1090 users, 3646 items 
DEBUG   [11-27 18:48:34] _drop_cold in utils:
after 0 filterings, there are 1090 users, 3646 items
INFO    [11-27 18:48:34] _drop_cold in utils:
user desc 
            seq_len
count  1090.000000
mean     48.211927
std      77.730410
min       5.000000
25%       9.000000
50%      19.000000
75%      49.750000
max     899.000000
INFO    [11-27 18:48:34] _drop_cold in utils:
item desc 
           item_pop
count  3646.000000
mean     14.413330
std      16.072829
min       5.000000
25%       6.000000
50%       9.000000
75%      15.000000
max     177.000000
INFO    [11-27 18:48:34] _df_data_partition in utils:
dataset summary:
         session_id       item_id   rating
count  52551.000000  52551.000000  52551.0
mean     527.873799   1828.243915      1.0
std      316.650738   1049.669215      0.0
min        1.000000      1.000000      1.0
25%      248.000000    928.000000      1.0
50%      515.000000   1834.000000      1.0
75%      813.000000   2718.500000      1.0
max     1090.000000   3646.000000      1.0
INFO    [11-27 18:48:35] __init__ in NextItemDataloader:
there are 3646 items in this dataset, 4030 users, padding_first? False
DEBUG   [11-27 18:48:36] generate_model in utils:
model_code_list=['pop']
INFO    [11-27 18:48:36] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [11-27 18:48:36] load_model_config in utils:
{}
WARNING [11-27 18:48:41] get_exist_path in utils:
dir _____lfms_soft_len_4/soft_gru4rec-len-15_11-27_18-48_t2/teacher_pop_logs does not exist! Create one.
WARNING [11-27 18:48:41] get_exist_path in utils:
dir _____lfms_soft_len_4/soft_gru4rec-len-15_11-27_18-48_t2/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [11-27 18:48:41] get_exist_path in utils:
dir _____lfms_soft_len_4/soft_gru4rec-len-15_11-27_18-48_t2/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [11-27 18:48:41] get_path in utils:
Path is None
WARNING [11-27 18:48:41] load_state_from_given_path in utils:
Not given any path.
DEBUG   [11-27 18:48:41] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [11-27 18:48:41] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [11-27 18:48:41] __init__ in BasicTrainer:
45056 iter per epoch
DEBUG   [11-27 18:48:41] generate_model in utils:
model_code_list=['gru4rec']
INFO    [11-27 18:48:41] load_model_config in utils:
loading model gru4rec's config file at asset/config/model/gru4rec.json
INFO    [11-27 18:48:41] load_model_config in utils:
{
    "embed_size": 64,
    "hidden_units": 64,
    "num_layers": 2,
    "hidden_dropout": 0.5,
    "loss_type": "CE"
}
WARNING [11-27 18:48:42] get_exist_path in utils:
dir _____lfms_soft_len_4/soft_gru4rec-len-15_11-27_18-48_t2/student_gru4rec_logs does not exist! Create one.
WARNING [11-27 18:48:43] get_exist_path in utils:
dir _____lfms_soft_len_4/soft_gru4rec-len-15_11-27_18-48_t2/student_gru4rec_logs/tb_vis does not exist! Create one.
WARNING [11-27 18:48:43] get_exist_path in utils:
dir _____lfms_soft_len_4/soft_gru4rec-len-15_11-27_18-48_t2/student_gru4rec_logs/checkpoint does not exist! Create one.
WARNING [11-27 18:48:43] get_path in utils:
Path is None
WARNING [11-27 18:48:43] load_state_from_given_path in utils:
Not given any path.
DEBUG   [11-27 18:48:43] __init__ in DistillSched:
student model: 
GRU4RecModel(
  (item_embedding): Embedding(3647, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.5, inplace=False)
  (gru_layers): GRU(64, 64, num_layers=2, bias=False, batch_first=True)
  (dense): Linear(in_features=64, out_features=64, bias=True)
  (loss_fct): CrossEntropyLoss()
)
INFO    [11-27 18:48:43] assert_model_device in utils:
model student_gru4rec has 1.09375 MB params.
INFO    [11-27 18:48:43] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [11-27 18:48:43] __init__ in DistillTrainer:
45056 iter per epoch
INFO    [11-27 18:48:43] _set_current_routine in Routine:
first routine: student
INFO    [11-27 18:48:43] run_routine in Routine:
Start routine student
INFO    [11-27 18:48:43] run_routine in Routine:
Start training
INFO    [11-27 18:48:43] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [11-27 18:48:45] test_mentor in DistillTrainer:
{'Recall@10': 0.025878396816551685, 'NDCG@10': 0.012082622619345784, 'MRR@10': 0.007897175382822752, 'Recall@5': 0.01563315512612462, 'NDCG@5': 0.00883128261193633, 'MRR@5': 0.0065908285323530436, 'Recall*@10': 0.025878396816551685, 'NDCG*@10': 0.012082622619345784, 'MRR*@10': 0.007897175382822752, 'Recall*@5': 0.01563315512612462, 'NDCG*@5': 0.00883128261193633, 'MRR*@5': 0.0065908285323530436}
INFO    [11-27 18:48:45] train in DistillTrainer:
result:
{'Recall@10': 0.025878396816551685, 'NDCG@10': 0.012082622619345784, 'MRR@10': 0.007897175382822752, 'Recall@5': 0.01563315512612462, 'NDCG@5': 0.00883128261193633, 'MRR@5': 0.0065908285323530436, 'Recall*@10': 0.025878396816551685, 'NDCG*@10': 0.012082622619345784, 'MRR*@10': 0.007897175382822752, 'Recall*@5': 0.01563315512612462, 'NDCG*@5': 0.00883128261193633, 'MRR*@5': 0.0065908285323530436}
INFO    [11-27 18:48:47] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [11-27 18:48:47] validate in BasicTrainer:
{'Recall@10': 0.001481663464801386, 'NDCG@10': 0.0007176628496381454, 'MRR@10': 0.0004903837252641097, 'Recall@5': 0.000732421875, 'NDCG@5': 0.000471356586785987, 'MRR@5': 0.00038655599928461015, 'Recall*@10': 0.001481663464801386, 'NDCG*@10': 0.0007176628496381454, 'MRR*@10': 0.0004903837252641097, 'Recall*@5': 0.000732421875, 'NDCG*@5': 0.000471356586785987, 'MRR*@5': 0.00038655599928461015}
INFO    [11-27 18:48:47] train in BasicTrainer:
epoch: 0
DEBUG   [11-27 18:48:47] calculate_loss in loss:
soft_target max: 0.5027613043785095, argmax 1346969
DEBUG   [11-27 18:48:47] calculate_loss in loss:
pred max in softmax: 0.0002881895052269101, argmax 1938121
INFO    [11-27 18:48:49] _train_one_epoch in BasicTrainer:
loss = 5.757906079292297
INFO    [11-27 18:48:51] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [11-27 18:48:51] validate in BasicTrainer:
{'Recall@10': 0.022132189013063908, 'NDCG@10': 0.01057879300788045, 'MRR@10': 0.007150595309212804, 'Recall@5': 0.012686647940427065, 'NDCG@5': 0.007586995721794665, 'MRR@5': 0.005951594794169068, 'Recall*@10': 0.022132189013063908, 'NDCG*@10': 0.01057879300788045, 'MRR*@10': 0.007150595309212804, 'Recall*@5': 0.012686647940427065, 'NDCG*@5': 0.007586995721794665, 'MRR*@5': 0.005951594794169068}
INFO    [11-27 18:48:51] train in BasicTrainer:
duration: 4.54398512840271s
INFO    [11-27 18:48:51] train in BasicTrainer:
epoch: 1
INFO    [11-27 18:48:54] _train_one_epoch in BasicTrainer:
loss = 5.50447783686898
INFO    [11-27 18:48:56] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [11-27 18:48:56] validate in BasicTrainer:
{'Recall@10': 0.024102133698761463, 'NDCG@10': 0.011585218599066138, 'MRR@10': 0.007874537026509643, 'Recall@5': 0.012846689904108644, 'NDCG@5': 0.008012315141968429, 'MRR@5': 0.006439476739615202, 'Recall*@10': 0.024102133698761463, 'NDCG*@10': 0.011585218599066138, 'MRR*@10': 0.007874537026509643, 'Recall*@5': 0.012846689904108644, 'NDCG*@5': 0.008012315141968429, 'MRR*@5': 0.006439476739615202}
INFO    [11-27 18:48:56] train in BasicTrainer:
duration: 4.5567262172698975s
INFO    [11-27 18:48:56] train in BasicTrainer:
epoch: 2
INFO    [11-27 18:48:58] _train_one_epoch in BasicTrainer:
loss = 5.428120277144692
INFO    [11-27 18:49:01] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [11-27 18:49:01] validate in BasicTrainer:
{'Recall@10': 0.023790713865309954, 'NDCG@10': 0.011714589316397905, 'MRR@10': 0.008167510037310421, 'Recall@5': 0.011870127404108644, 'NDCG@5': 0.007938543683849275, 'MRR@5': 0.006655406090430915, 'Recall*@10': 0.023790713865309954, 'NDCG*@10': 0.011714589316397905, 'MRR*@10': 0.008167510037310421, 'Recall*@5': 0.011870127404108644, 'NDCG*@5': 0.007938543683849275, 'MRR*@5': 0.006655406090430915}
INFO    [11-27 18:49:01] train in BasicTrainer:
duration: 4.65212082862854s
INFO    [11-27 18:49:01] train in BasicTrainer:
epoch: 3
INFO    [11-27 18:49:03] _train_one_epoch in BasicTrainer:
loss = 5.403550093824213
INFO    [11-27 18:49:05] validate in BasicTrainer:
{'Recall@10': 0.025289196986705065, 'NDCG@10': 0.011542744236066937, 'MRR@10': 0.007564662140794098, 'Recall@5': 0.009866543347015977, 'NDCG@5': 0.006637405836954713, 'MRR@5': 0.005586972110904753, 'Recall*@10': 0.025289196986705065, 'NDCG*@10': 0.011542744236066937, 'MRR*@10': 0.007564662140794098, 'Recall*@5': 0.009866543347015977, 'NDCG*@5': 0.006637405836954713, 'MRR*@5': 0.005586972110904753}
INFO    [11-27 18:49:05] train in BasicTrainer:
duration: 4.390251159667969s
INFO    [11-27 18:49:05] train in BasicTrainer:
epoch: 4
INFO    [11-27 18:49:07] _train_one_epoch in BasicTrainer:
loss = 5.379872679710388
INFO    [11-27 18:49:10] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [11-27 18:49:10] validate in BasicTrainer:
{'Recall@10': 0.03001196775585413, 'NDCG@10': 0.013747938675805926, 'MRR@10': 0.008986348519101739, 'Recall@5': 0.01437881262972951, 'NDCG@5': 0.008801510091871023, 'MRR@5': 0.007008976652286947, 'Recall*@10': 0.03001196775585413, 'NDCG*@10': 0.013747938675805926, 'MRR*@10': 0.008986348519101739, 'Recall*@5': 0.01437881262972951, 'NDCG*@5': 0.008801510091871023, 'MRR*@5': 0.007008976652286947}
INFO    [11-27 18:49:10] train in BasicTrainer:
duration: 4.689371824264526s
INFO    [11-27 18:49:10] train in BasicTrainer:
epoch: 5
INFO    [11-27 18:49:12] _train_one_epoch in BasicTrainer:
loss = 5.34547652981498
INFO    [11-27 18:49:14] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [11-27 18:49:14] validate in BasicTrainer:
{'Recall@10': 0.03630049992352724, 'NDCG@10': 0.018423430621623993, 'MRR@10': 0.013119276147335768, 'Recall@5': 0.019101582933217287, 'NDCG@5': 0.012886284850537777, 'MRR@5': 0.010849791578948498, 'Recall*@10': 0.03630049992352724, 'NDCG*@10': 0.018423430621623993, 'MRR*@10': 0.013119276147335768, 'Recall*@5': 0.019101582933217287, 'NDCG*@5': 0.012886284850537777, 'MRR*@5': 0.010849791578948498}
INFO    [11-27 18:49:14] train in BasicTrainer:
duration: 4.744018077850342s
INFO    [11-27 18:49:14] train in BasicTrainer:
epoch: 6
INFO    [11-27 18:49:17] _train_one_epoch in BasicTrainer:
loss = 5.2863241542469375
INFO    [11-27 18:49:19] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [11-27 18:49:19] validate in BasicTrainer:
{'Recall@10': 0.04398659709841013, 'NDCG@10': 0.02064571436494589, 'MRR@10': 0.013654508162289858, 'Recall@5': 0.024278995115309954, 'NDCG@5': 0.014303561765700579, 'MRR@5': 0.011054771021008492, 'Recall*@10': 0.04398659709841013, 'NDCG*@10': 0.02064571436494589, 'MRR*@10': 0.013654508162289858, 'Recall*@5': 0.024278995115309954, 'NDCG*@5': 0.014303561765700579, 'MRR*@5': 0.011054771021008492}
INFO    [11-27 18:49:19] train in BasicTrainer:
duration: 4.385825157165527s
INFO    [11-27 18:49:19] train in BasicTrainer:
epoch: 7
INFO    [11-27 18:49:21] _train_one_epoch in BasicTrainer:
loss = 5.219073468988592
INFO    [11-27 18:49:23] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [11-27 18:49:23] validate in BasicTrainer:
{'Recall@10': 0.053726738318800926, 'NDCG@10': 0.026169717777520418, 'MRR@10': 0.01791259809397161, 'Recall@5': 0.03133358899503946, 'NDCG@5': 0.01898389821872115, 'MRR@5': 0.014978155493736267, 'Recall*@10': 0.053726738318800926, 'NDCG*@10': 0.026169717777520418, 'MRR*@10': 0.01791259809397161, 'Recall*@5': 0.03133358899503946, 'NDCG*@5': 0.01898389821872115, 'MRR*@5': 0.014978155493736267}
INFO    [11-27 18:49:23] train in BasicTrainer:
duration: 4.675990581512451s
INFO    [11-27 18:49:23] train in BasicTrainer:
epoch: 8
INFO    [11-27 18:49:26] _train_one_epoch in BasicTrainer:
loss = 5.162424770268527
INFO    [11-27 18:49:28] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [11-27 18:49:28] validate in BasicTrainer:
{'Recall@10': 0.06111823581159115, 'NDCG@10': 0.03051820443943143, 'MRR@10': 0.021388461347669363, 'Recall@5': 0.03455787617713213, 'NDCG@5': 0.021959696896374226, 'MRR@5': 0.017875392455607653, 'Recall*@10': 0.06111823581159115, 'NDCG*@10': 0.03051820443943143, 'MRR*@10': 0.021388461347669363, 'Recall*@5': 0.03455787617713213, 'NDCG*@5': 0.021959696896374226, 'MRR*@5': 0.017875392455607653}
INFO    [11-27 18:49:28] train in BasicTrainer:
duration: 4.728646278381348s
INFO    [11-27 18:49:28] train in BasicTrainer:
epoch: 9
INFO    [11-27 18:49:31] _train_one_epoch in BasicTrainer:
loss = 5.121596964922818
INFO    [11-27 18:49:33] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [11-27 18:49:33] validate in BasicTrainer:
{'Recall@10': 0.06582418642938137, 'NDCG@10': 0.03177497908473015, 'MRR@10': 0.021567688789218664, 'Recall@5': 0.03800948429852724, 'NDCG@5': 0.022872048430144787, 'MRR@5': 0.01794780185446143, 'Recall*@10': 0.06582418642938137, 'NDCG*@10': 0.03177497908473015, 'MRR*@10': 0.021567688789218664, 'Recall*@5': 0.03800948429852724, 'NDCG*@5': 0.022872048430144787, 'MRR*@5': 0.01794780185446143}
INFO    [11-27 18:49:33] train in BasicTrainer:
duration: 4.73438835144043s
INFO    [11-27 18:49:33] train in BasicTrainer:
epoch: 10
INFO    [11-27 18:49:35] _train_one_epoch in BasicTrainer:
loss = 5.086007941852916
INFO    [11-27 18:49:38] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [11-27 18:49:38] validate in BasicTrainer:
{'Recall@10': 0.06957039423286915, 'NDCG@10': 0.03457832150161266, 'MRR@10': 0.024027184583246708, 'Recall@5': 0.04369199741631746, 'NDCG@5': 0.02625772077590227, 'MRR@5': 0.02062099799513817, 'Recall*@10': 0.06957039423286915, 'NDCG*@10': 0.03457832150161266, 'MRR*@10': 0.024027184583246708, 'Recall*@5': 0.04369199741631746, 'NDCG*@5': 0.02625772077590227, 'MRR*@5': 0.02062099799513817}
INFO    [11-27 18:49:38] train in BasicTrainer:
duration: 4.653238773345947s
INFO    [11-27 18:49:38] train in BasicTrainer:
epoch: 11
INFO    [11-27 18:49:40] _train_one_epoch in BasicTrainer:
loss = 5.052563147111372
INFO    [11-27 18:49:42] validate in BasicTrainer:
{'Recall@10': 0.07211271859705448, 'NDCG@10': 0.03422976331785321, 'MRR@10': 0.02282843692228198, 'Recall@5': 0.04173887241631746, 'NDCG@5': 0.024484032299369574, 'MRR@5': 0.0188501279335469, 'Recall*@10': 0.07211271859705448, 'NDCG*@10': 0.03422976331785321, 'MRR*@10': 0.02282843692228198, 'Recall*@5': 0.04173887241631746, 'NDCG*@5': 0.024484032299369574, 'MRR*@5': 0.0188501279335469}
INFO    [11-27 18:49:42] train in BasicTrainer:
duration: 4.635193109512329s
INFO    [11-27 18:49:42] train in BasicTrainer:
epoch: 12
INFO    [11-27 18:49:45] _train_one_epoch in BasicTrainer:
loss = 5.0168434164740825
INFO    [11-27 18:49:47] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [11-27 18:49:47] validate in BasicTrainer:
{'Recall@10': 0.07356074266135693, 'NDCG@10': 0.03723734896630049, 'MRR@10': 0.026288586668670177, 'Recall@5': 0.04433165676891804, 'NDCG@5': 0.027770401444286108, 'MRR@5': 0.022374078631401062, 'Recall*@10': 0.07356074266135693, 'NDCG*@10': 0.03723734896630049, 'MRR*@10': 0.026288586668670177, 'Recall*@5': 0.04433165676891804, 'NDCG*@5': 0.027770401444286108, 'MRR*@5': 0.022374078631401062}
INFO    [11-27 18:49:47] train in BasicTrainer:
duration: 4.613064527511597s
INFO    [11-27 18:49:47] train in BasicTrainer:
epoch: 13
INFO    [11-27 18:49:49] _train_one_epoch in BasicTrainer:
loss = 4.978260397911072
INFO    [11-27 18:49:51] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [11-27 18:49:52] validate in BasicTrainer:
{'Recall@10': 0.07611988671123981, 'NDCG@10': 0.03856926877051592, 'MRR@10': 0.027353445999324322, 'Recall@5': 0.04452533833682537, 'NDCG@5': 0.02843133918941021, 'MRR@5': 0.02321659354493022, 'Recall*@10': 0.07611988671123981, 'NDCG*@10': 0.03856926877051592, 'MRR*@10': 0.027353445999324322, 'Recall*@5': 0.04452533833682537, 'NDCG*@5': 0.02843133918941021, 'MRR*@5': 0.02321659354493022}
INFO    [11-27 18:49:52] train in BasicTrainer:
duration: 4.637426853179932s
INFO    [11-27 18:49:52] train in BasicTrainer:
epoch: 14
INFO    [11-27 18:49:54] _train_one_epoch in BasicTrainer:
loss = 4.93935641375455
INFO    [11-27 18:49:56] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [11-27 18:49:56] validate in BasicTrainer:
{'Recall@10': 0.07944509200751781, 'NDCG@10': 0.04162560310214758, 'MRR@10': 0.030256809666752815, 'Recall@5': 0.049264928326010704, 'NDCG@5': 0.03200562857091427, 'MRR@5': 0.026367757003754377, 'Recall*@10': 0.07944509200751781, 'NDCG*@10': 0.04162560310214758, 'MRR*@10': 0.030256809666752815, 'Recall*@5': 0.049264928326010704, 'NDCG*@5': 0.03200562857091427, 'MRR*@5': 0.026367757003754377}
INFO    [11-27 18:49:56] train in BasicTrainer:
duration: 4.650106906890869s
INFO    [11-27 18:49:56] train in BasicTrainer:
epoch: 15
INFO    [11-27 18:49:59] _train_one_epoch in BasicTrainer:
loss = 4.903261737389998
INFO    [11-27 18:50:01] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [11-27 18:50:01] validate in BasicTrainer:
{'Recall@10': 0.08476572670042515, 'NDCG@10': 0.04307827353477478, 'MRR@10': 0.030519211664795876, 'Recall@5': 0.051984114572405815, 'NDCG@5': 0.0325053627602756, 'MRR@5': 0.026170941069722176, 'Recall*@10': 0.08476572670042515, 'NDCG*@10': 0.04307827353477478, 'MRR*@10': 0.030519211664795876, 'Recall*@5': 0.051984114572405815, 'NDCG*@5': 0.0325053627602756, 'MRR*@5': 0.026170941069722176}
INFO    [11-27 18:50:01] train in BasicTrainer:
duration: 4.661830186843872s
INFO    [11-27 18:50:01] train in BasicTrainer:
epoch: 16
INFO    [11-27 18:50:03] _train_one_epoch in BasicTrainer:
loss = 4.869255499406294
INFO    [11-27 18:50:06] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [11-27 18:50:06] validate in BasicTrainer:
{'Recall@10': 0.09227496385574341, 'NDCG@10': 0.04793503228574991, 'MRR@10': 0.03465674165636301, 'Recall@5': 0.05501472018659115, 'NDCG@5': 0.036085061728954315, 'MRR@5': 0.029880578629672527, 'Recall*@10': 0.09227496385574341, 'NDCG*@10': 0.04793503228574991, 'MRR*@10': 0.03465674165636301, 'Recall*@5': 0.05501472018659115, 'NDCG*@5': 0.036085061728954315, 'MRR*@5': 0.029880578629672527}
INFO    [11-27 18:50:06] train in BasicTrainer:
duration: 4.914568662643433s
INFO    [11-27 18:50:06] train in BasicTrainer:
epoch: 17
INFO    [11-27 18:50:08] _train_one_epoch in BasicTrainer:
loss = 4.832583286545494
INFO    [11-27 18:50:10] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [11-27 18:50:10] validate in BasicTrainer:
{'Recall@10': 0.09813433885574341, 'NDCG@10': 0.050441241823136806, 'MRR@10': 0.03615245223045349, 'Recall@5': 0.05740566737949848, 'NDCG@5': 0.03740899916738272, 'MRR@5': 0.030854304786771536, 'Recall*@10': 0.09813433885574341, 'NDCG*@10': 0.050441241823136806, 'MRR*@10': 0.03615245223045349, 'Recall*@5': 0.05740566737949848, 'NDCG*@5': 0.03740899916738272, 'MRR*@5': 0.030854304786771536}
INFO    [11-27 18:50:10] train in BasicTrainer:
duration: 4.631230354309082s
INFO    [11-27 18:50:10] train in BasicTrainer:
epoch: 18
INFO    [11-27 18:50:13] _train_one_epoch in BasicTrainer:
loss = 4.794983181086454
INFO    [11-27 18:50:15] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [11-27 18:50:15] validate in BasicTrainer:
{'Recall@10': 0.10106402635574341, 'NDCG@10': 0.05145572870969772, 'MRR@10': 0.03656594920903444, 'Recall@5': 0.06106777675449848, 'NDCG@5': 0.03870801255106926, 'MRR@5': 0.0314124901778996, 'Recall*@10': 0.10106402635574341, 'NDCG*@10': 0.05145572870969772, 'MRR*@10': 0.03656594920903444, 'Recall*@5': 0.06106777675449848, 'NDCG*@5': 0.03870801255106926, 'MRR*@5': 0.0314124901778996}
INFO    [11-27 18:50:15] train in BasicTrainer:
duration: 5.047006607055664s
INFO    [11-27 18:50:15] train in BasicTrainer:
epoch: 19
INFO    [11-27 18:50:18] _train_one_epoch in BasicTrainer:
loss = 4.76338605447249
INFO    [11-27 18:50:20] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [11-27 18:50:20] validate in BasicTrainer:
{'Recall@10': 0.10793360322713852, 'NDCG@10': 0.05544824060052633, 'MRR@10': 0.03956020437180996, 'Recall@5': 0.07042921893298626, 'NDCG@5': 0.043483964167535305, 'MRR@5': 0.03471807949244976, 'Recall*@10': 0.10793360322713852, 'NDCG*@10': 0.05544824060052633, 'MRR*@10': 0.03956020437180996, 'Recall*@5': 0.07042921893298626, 'NDCG*@5': 0.043483964167535305, 'MRR*@5': 0.03471807949244976}
INFO    [11-27 18:50:20] train in BasicTrainer:
duration: 4.612973928451538s
INFO    [11-27 18:50:20] train in BasicTrainer:
epoch: 20
INFO    [11-27 18:50:22] _train_one_epoch in BasicTrainer:
loss = 4.729038314385847
INFO    [11-27 18:50:24] validate in BasicTrainer:
{'Recall@10': 0.10688109695911407, 'NDCG@10': 0.054650476202368736, 'MRR@10': 0.03885817248374224, 'Recall@5': 0.06834969110786915, 'NDCG@5': 0.042361301369965076, 'MRR@5': 0.033886421006172895, 'Recall*@10': 0.10688109695911407, 'NDCG*@10': 0.054650476202368736, 'MRR*@10': 0.03885817248374224, 'Recall*@5': 0.06834969110786915, 'NDCG*@5': 0.042361301369965076, 'MRR*@5': 0.033886421006172895}
INFO    [11-27 18:50:24] train in BasicTrainer:
duration: 4.477541446685791s
INFO    [11-27 18:50:24] train in BasicTrainer:
epoch: 21
INFO    [11-27 18:50:27] _train_one_epoch in BasicTrainer:
loss = 4.701539679007097
INFO    [11-27 18:50:30] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [11-27 18:50:31] validate in BasicTrainer:
{'Recall@10': 0.11150294914841652, 'NDCG@10': 0.056524752639234066, 'MRR@10': 0.03988596796989441, 'Recall@5': 0.06981453485786915, 'NDCG@5': 0.043112482875585556, 'MRR@5': 0.034392254427075386, 'Recall*@10': 0.11150294914841652, 'NDCG*@10': 0.056524752639234066, 'MRR*@10': 0.03988596796989441, 'Recall*@5': 0.06981453485786915, 'NDCG*@5': 0.043112482875585556, 'MRR*@5': 0.034392254427075386}
INFO    [11-27 18:50:31] train in BasicTrainer:
duration: 6.498110294342041s
INFO    [11-27 18:50:31] train in BasicTrainer:
epoch: 22
DEBUG   [11-27 18:50:33] calculate_loss in loss:
soft_target max: 0.5027613043785095, argmax 2007076
DEBUG   [11-27 18:50:33] calculate_loss in loss:
pred max in softmax: 0.0672193393111229, argmax 3248224
DEBUG   [11-27 18:50:33] calculate_loss in loss:
soft_target max: 0.5027613043785095, argmax 19461
DEBUG   [11-27 18:50:33] calculate_loss in loss:
pred max in softmax: 0.09720604866743088, argmax 1741193
INFO    [11-27 18:50:33] _train_one_epoch in BasicTrainer:
loss = 4.673343409191478
INFO    [11-27 18:50:37] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [11-27 18:50:37] validate in BasicTrainer:
{'Recall@10': 0.11420531570911407, 'NDCG@10': 0.059214873239398, 'MRR@10': 0.0426384536549449, 'Recall@5': 0.07054695673286915, 'NDCG@5': 0.04519255645573139, 'MRR@5': 0.03690804075449705, 'Recall*@10': 0.11420531570911407, 'NDCG*@10': 0.059214873239398, 'MRR*@10': 0.0426384536549449, 'Recall*@5': 0.07054695673286915, 'NDCG*@5': 0.04519255645573139, 'MRR*@5': 0.03690804075449705}
INFO    [11-27 18:50:37] train in BasicTrainer:
duration: 5.892043352127075s
INFO    [11-27 18:50:37] train in BasicTrainer:
epoch: 23
INFO    [11-27 18:50:39] _train_one_epoch in BasicTrainer:
loss = 4.647322773933411
INFO    [11-27 18:50:42] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [11-27 18:50:43] validate in BasicTrainer:
{'Recall@10': 0.11655395850539207, 'NDCG@10': 0.059992363676428795, 'MRR@10': 0.04290375392884016, 'Recall@5': 0.0746214035898447, 'NDCG@5': 0.04642579797655344, 'MRR@5': 0.037300814874470234, 'Recall*@10': 0.11655395850539207, 'NDCG*@10': 0.059992363676428795, 'MRR*@10': 0.04290375392884016, 'Recall*@5': 0.0746214035898447, 'NDCG*@5': 0.04642579797655344, 'MRR*@5': 0.037300814874470234}
INFO    [11-27 18:50:43] train in BasicTrainer:
duration: 6.176981449127197s
INFO    [11-27 18:50:43] train in BasicTrainer:
epoch: 24
INFO    [11-27 18:50:46] _train_one_epoch in BasicTrainer:
loss = 4.6252228888598355
INFO    [11-27 18:50:49] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [11-27 18:50:50] validate in BasicTrainer:
{'Recall@10': 0.11791788414120674, 'NDCG@10': 0.0610803859308362, 'MRR@10': 0.04384631011635065, 'Recall@5': 0.07596850953996181, 'NDCG@5': 0.04750042501837015, 'MRR@5': 0.038232880644500256, 'Recall*@10': 0.11791788414120674, 'NDCG*@10': 0.0610803859308362, 'MRR*@10': 0.04384631011635065, 'Recall*@5': 0.07596850953996181, 'NDCG*@5': 0.04750042501837015, 'MRR*@5': 0.038232880644500256}
INFO    [11-27 18:50:50] train in BasicTrainer:
duration: 6.582474946975708s
INFO    [11-27 18:50:50] train in BasicTrainer:
epoch: 25
INFO    [11-27 18:50:52] _train_one_epoch in BasicTrainer:
loss = 4.5998099933971055
INFO    [11-27 18:50:55] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [11-27 18:50:55] validate in BasicTrainer:
{'Recall@10': 0.12291843444108963, 'NDCG@10': 0.06356739811599255, 'MRR@10': 0.04576226510107517, 'Recall@5': 0.0749583076685667, 'NDCG@5': 0.04821017663925886, 'MRR@5': 0.039514465257525444, 'Recall*@10': 0.12291843444108963, 'NDCG*@10': 0.06356739811599255, 'MRR*@10': 0.04576226510107517, 'Recall*@5': 0.0749583076685667, 'NDCG*@5': 0.04821017663925886, 'MRR*@5': 0.039514465257525444}
INFO    [11-27 18:50:55] train in BasicTrainer:
duration: 5.825546026229858s
INFO    [11-27 18:50:55] train in BasicTrainer:
epoch: 26
INFO    [11-27 18:50:57] _train_one_epoch in BasicTrainer:
loss = 4.578245227987116
INFO    [11-27 18:51:00] log in loggers:
Update Best NDCG@10 Model at 26
INFO    [11-27 18:51:00] validate in BasicTrainer:
{'Recall@10': 0.12495565786957741, 'NDCG@10': 0.06405688356608152, 'MRR@10': 0.04569782968610525, 'Recall@5': 0.0771555732935667, 'NDCG@5': 0.04869697615504265, 'MRR@5': 0.03941392991691828, 'Recall*@10': 0.12495565786957741, 'NDCG*@10': 0.06405688356608152, 'MRR*@10': 0.04569782968610525, 'Recall*@5': 0.0771555732935667, 'NDCG*@5': 0.04869697615504265, 'MRR*@5': 0.03941392991691828}
INFO    [11-27 18:51:00] train in BasicTrainer:
duration: 4.2749316692352295s
INFO    [11-27 18:51:00] train in BasicTrainer:
epoch: 27
INFO    [11-27 18:51:02] _train_one_epoch in BasicTrainer:
loss = 4.5568094795400444
INFO    [11-27 18:51:04] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [11-27 18:51:04] validate in BasicTrainer:
{'Recall@10': 0.12596585974097252, 'NDCG@10': 0.06560014840215445, 'MRR@10': 0.047363970428705215, 'Recall@5': 0.07969789765775204, 'NDCG@5': 0.050794314593076706, 'MRR@5': 0.041345223784446716, 'Recall*@10': 0.12596585974097252, 'NDCG*@10': 0.06560014840215445, 'MRR*@10': 0.047363970428705215, 'Recall*@5': 0.07969789765775204, 'NDCG*@5': 0.050794314593076706, 'MRR*@5': 0.041345223784446716}
INFO    [11-27 18:51:04] train in BasicTrainer:
duration: 4.365615606307983s
INFO    [11-27 18:51:04] train in BasicTrainer:
epoch: 28
INFO    [11-27 18:51:06] _train_one_epoch in BasicTrainer:
loss = 4.5360704552043565
INFO    [11-27 18:51:08] validate in BasicTrainer:
{'Recall@10': 0.12554485723376274, 'NDCG@10': 0.06529078260064125, 'MRR@10': 0.04704025387763977, 'Recall@5': 0.07872133515775204, 'NDCG@5': 0.050052943639457226, 'MRR@5': 0.04069602582603693, 'Recall*@10': 0.12554485723376274, 'NDCG*@10': 0.06529078260064125, 'MRR*@10': 0.04704025387763977, 'Recall*@5': 0.07872133515775204, 'NDCG*@5': 0.050052943639457226, 'MRR*@5': 0.04069602582603693}
INFO    [11-27 18:51:08] train in BasicTrainer:
duration: 4.375783443450928s
INFO    [11-27 18:51:08] train in BasicTrainer:
epoch: 29
INFO    [11-27 18:51:11] _train_one_epoch in BasicTrainer:
loss = 4.511850118637085
INFO    [11-27 18:51:13] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [11-27 18:51:13] validate in BasicTrainer:
{'Recall@10': 0.13137059286236763, 'NDCG@10': 0.06942775286734104, 'MRR@10': 0.0506269047036767, 'Recall@5': 0.08767859451472759, 'NDCG@5': 0.0555320680141449, 'MRR@5': 0.04502580966800451, 'Recall*@10': 0.13137059286236763, 'NDCG*@10': 0.06942775286734104, 'MRR*@10': 0.0506269047036767, 'Recall*@5': 0.08767859451472759, 'NDCG*@5': 0.0555320680141449, 'MRR*@5': 0.04502580966800451}
INFO    [11-27 18:51:13] train in BasicTrainer:
duration: 4.443695545196533s
INFO    [11-27 18:51:13] train in BasicTrainer:
epoch: 30
INFO    [11-27 18:51:15] _train_one_epoch in BasicTrainer:
loss = 4.491646950895136
INFO    [11-27 18:51:17] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [11-27 18:51:17] validate in BasicTrainer:
{'Recall@10': 0.13119373098015785, 'NDCG@10': 0.06968672014772892, 'MRR@10': 0.05103134177625179, 'Recall@5': 0.08564137108623981, 'NDCG@5': 0.05504255462437868, 'MRR@5': 0.04503632802516222, 'Recall*@10': 0.13119373098015785, 'NDCG*@10': 0.06968672014772892, 'MRR*@10': 0.05103134177625179, 'Recall*@5': 0.08564137108623981, 'NDCG*@5': 0.05504255462437868, 'MRR*@5': 0.04503632802516222}
INFO    [11-27 18:51:17] train in BasicTrainer:
duration: 4.434975862503052s
INFO    [11-27 18:51:17] train in BasicTrainer:
epoch: 31
INFO    [11-27 18:51:20] _train_one_epoch in BasicTrainer:
loss = 4.472233349626714
INFO    [11-27 18:51:22] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [11-27 18:51:22] validate in BasicTrainer:
{'Recall@10': 0.13663210347294807, 'NDCG@10': 0.07249892875552177, 'MRR@10': 0.05307149514555931, 'Recall@5': 0.08668521232903004, 'NDCG@5': 0.05635447893291712, 'MRR@5': 0.04641357157379389, 'Recall*@10': 0.13663210347294807, 'NDCG*@10': 0.07249892875552177, 'MRR*@10': 0.05307149514555931, 'Recall*@5': 0.08668521232903004, 'NDCG*@5': 0.05635447893291712, 'MRR*@5': 0.04641357157379389}
INFO    [11-27 18:51:22] train in BasicTrainer:
duration: 4.492342948913574s
INFO    [11-27 18:51:22] train in BasicTrainer:
epoch: 32
INFO    [11-27 18:51:24] _train_one_epoch in BasicTrainer:
loss = 4.451278740709478
INFO    [11-27 18:51:26] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [11-27 18:51:26] validate in BasicTrainer:
{'Recall@10': 0.1391407884657383, 'NDCG@10': 0.0725637748837471, 'MRR@10': 0.052458626218140125, 'Recall@5': 0.09029686264693737, 'NDCG@5': 0.05695044435560703, 'MRR@5': 0.04612201452255249, 'Recall*@10': 0.1391407884657383, 'NDCG*@10': 0.0725637748837471, 'MRR*@10': 0.052458626218140125, 'Recall*@5': 0.09029686264693737, 'NDCG*@5': 0.05695044435560703, 'MRR*@5': 0.04612201452255249}
INFO    [11-27 18:51:26] train in BasicTrainer:
duration: 4.542681694030762s
INFO    [11-27 18:51:26] train in BasicTrainer:
epoch: 33
INFO    [11-27 18:51:29] _train_one_epoch in BasicTrainer:
loss = 4.433015411550349
INFO    [11-27 18:51:31] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [11-27 18:51:31] validate in BasicTrainer:
{'Recall@10': 0.13814740628004074, 'NDCG@10': 0.07417724654078484, 'MRR@10': 0.05479684006422758, 'Recall@5': 0.09041460044682026, 'NDCG@5': 0.05877809785306454, 'MRR@5': 0.048463611863553524, 'Recall*@10': 0.13814740628004074, 'NDCG*@10': 0.07417724654078484, 'MRR*@10': 0.05479684006422758, 'Recall*@5': 0.09041460044682026, 'NDCG*@5': 0.05877809785306454, 'MRR*@5': 0.048463611863553524}
INFO    [11-27 18:51:31] train in BasicTrainer:
duration: 4.40059757232666s
INFO    [11-27 18:51:31] train in BasicTrainer:
epoch: 34
INFO    [11-27 18:51:33] _train_one_epoch in BasicTrainer:
loss = 4.41615279154344
INFO    [11-27 18:51:35] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [11-27 18:51:35] validate in BasicTrainer:
{'Recall@10': 0.14212093502283096, 'NDCG@10': 0.07556606829166412, 'MRR@10': 0.05535580683499575, 'Recall@5': 0.09313378669321537, 'NDCG@5': 0.05976534727960825, 'MRR@5': 0.048858342692255974, 'Recall*@10': 0.14212093502283096, 'NDCG*@10': 0.07556606829166412, 'MRR*@10': 0.05535580683499575, 'Recall*@5': 0.09313378669321537, 'NDCG*@5': 0.05976534727960825, 'MRR*@5': 0.048858342692255974}
INFO    [11-27 18:51:35] train in BasicTrainer:
duration: 4.3931310176849365s
INFO    [11-27 18:51:35] train in BasicTrainer:
epoch: 35
INFO    [11-27 18:51:37] _train_one_epoch in BasicTrainer:
loss = 4.397627071900801
INFO    [11-27 18:51:40] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [11-27 18:51:40] validate in BasicTrainer:
{'Recall@10': 0.1464986465871334, 'NDCG@10': 0.0773025918751955, 'MRR@10': 0.05640364810824394, 'Recall@5': 0.0954151526093483, 'NDCG@5': 0.060950242914259434, 'MRR@5': 0.04975426476448774, 'Recall*@10': 0.1464986465871334, 'NDCG*@10': 0.0773025918751955, 'MRR*@10': 0.05640364810824394, 'Recall*@5': 0.0954151526093483, 'NDCG*@5': 0.060950242914259434, 'MRR*@5': 0.04975426476448774}
INFO    [11-27 18:51:40] train in BasicTrainer:
duration: 4.699707269668579s
INFO    [11-27 18:51:40] train in BasicTrainer:
epoch: 36
INFO    [11-27 18:51:42] _train_one_epoch in BasicTrainer:
loss = 4.381965908137235
INFO    [11-27 18:51:44] validate in BasicTrainer:
{'Recall@10': 0.14388037845492363, 'NDCG@10': 0.07692098245024681, 'MRR@10': 0.0567029258236289, 'Recall@5': 0.09295692667365074, 'NDCG@5': 0.06058879382908344, 'MRR@5': 0.05004188884049654, 'Recall*@10': 0.14388037845492363, 'NDCG*@10': 0.07692098245024681, 'MRR*@10': 0.0567029258236289, 'Recall*@5': 0.09295692667365074, 'NDCG*@5': 0.06058879382908344, 'MRR*@5': 0.05004188884049654}
INFO    [11-27 18:51:44] train in BasicTrainer:
duration: 4.549935340881348s
INFO    [11-27 18:51:44] train in BasicTrainer:
epoch: 37
INFO    [11-27 18:51:47] _train_one_epoch in BasicTrainer:
loss = 4.365988590500572
INFO    [11-27 18:51:49] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [11-27 18:51:49] validate in BasicTrainer:
{'Recall@10': 0.14558936282992363, 'NDCG@10': 0.07794130593538284, 'MRR@10': 0.05754146073013544, 'Recall@5': 0.09212358482182026, 'NDCG@5': 0.060683440417051315, 'MRR@5': 0.050435674376785755, 'Recall*@10': 0.14558936282992363, 'NDCG*@10': 0.07794130593538284, 'MRR*@10': 0.05754146073013544, 'Recall*@5': 0.09212358482182026, 'NDCG*@5': 0.060683440417051315, 'MRR*@5': 0.050435674376785755}
INFO    [11-27 18:51:49] train in BasicTrainer:
duration: 4.31448221206665s
INFO    [11-27 18:51:49] train in BasicTrainer:
epoch: 38
INFO    [11-27 18:51:51] _train_one_epoch in BasicTrainer:
loss = 4.349220666018399
INFO    [11-27 18:51:53] validate in BasicTrainer:
{'Recall@10': 0.1450338028371334, 'NDCG@10': 0.07741511985659599, 'MRR@10': 0.056980401277542114, 'Recall@5': 0.0930833276361227, 'NDCG@5': 0.06064427085220814, 'MRR@5': 0.05007636174559593, 'Recall*@10': 0.1450338028371334, 'NDCG*@10': 0.07741511985659599, 'MRR*@10': 0.056980401277542114, 'Recall*@5': 0.0930833276361227, 'NDCG*@5': 0.06064427085220814, 'MRR*@5': 0.05007636174559593}
INFO    [11-27 18:51:53] train in BasicTrainer:
duration: 4.380239248275757s
INFO    [11-27 18:51:53] train in BasicTrainer:
epoch: 39
INFO    [11-27 18:51:55] _train_one_epoch in BasicTrainer:
loss = 4.3351216966455635
INFO    [11-27 18:51:57] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [11-27 18:51:57] validate in BasicTrainer:
{'Recall@10': 0.1464058831334114, 'NDCG@10': 0.07852726057171822, 'MRR@10': 0.05799871031194925, 'Recall@5': 0.09534787200391293, 'NDCG@5': 0.06211579591035843, 'MRR@5': 0.051286063157022, 'Recall*@10': 0.1464058831334114, 'NDCG*@10': 0.07852726057171822, 'MRR*@10': 0.05799871031194925, 'Recall*@5': 0.09534787200391293, 'NDCG*@5': 0.06211579591035843, 'MRR*@5': 0.051286063157022}
INFO    [11-27 18:51:57] train in BasicTrainer:
duration: 4.314854860305786s
INFO    [11-27 18:51:57] train in BasicTrainer:
epoch: 40
INFO    [11-27 18:52:00] _train_one_epoch in BasicTrainer:
loss = 4.320709932934154
INFO    [11-27 18:52:02] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [11-27 18:52:02] validate in BasicTrainer:
{'Recall@10': 0.14794667065143585, 'NDCG@10': 0.07953464612364769, 'MRR@10': 0.05882590543478727, 'Recall@5': 0.09651811607182026, 'NDCG@5': 0.06288105249404907, 'MRR@5': 0.051939280703663826, 'Recall*@10': 0.14794667065143585, 'NDCG*@10': 0.07953464612364769, 'MRR*@10': 0.05882590543478727, 'Recall*@5': 0.09651811607182026, 'NDCG*@5': 0.06288105249404907, 'MRR*@5': 0.051939280703663826}
INFO    [11-27 18:52:02] train in BasicTrainer:
duration: 4.470572471618652s
INFO    [11-27 18:52:02] train in BasicTrainer:
epoch: 41
INFO    [11-27 18:52:04] _train_one_epoch in BasicTrainer:
loss = 4.304413838820024
INFO    [11-27 18:52:06] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [11-27 18:52:06] validate in BasicTrainer:
{'Recall@10': 0.14827490970492363, 'NDCG@10': 0.07998212240636349, 'MRR@10': 0.05924543738365173, 'Recall@5': 0.0981006994843483, 'NDCG@5': 0.06386081129312515, 'MRR@5': 0.05265666265040636, 'Recall*@10': 0.14827490970492363, 'NDCG*@10': 0.07998212240636349, 'MRR*@10': 0.05924543738365173, 'Recall*@5': 0.0981006994843483, 'NDCG*@5': 0.06386081129312515, 'MRR*@5': 0.05265666265040636}
INFO    [11-27 18:52:06] train in BasicTrainer:
duration: 4.2038469314575195s
INFO    [11-27 18:52:06] train in BasicTrainer:
epoch: 42
INFO    [11-27 18:52:08] _train_one_epoch in BasicTrainer:
loss = 4.288982781496915
INFO    [11-27 18:52:10] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [11-27 18:52:10] validate in BasicTrainer:
{'Recall@10': 0.1527199000120163, 'NDCG@10': 0.08106864616274834, 'MRR@10': 0.05945443920791149, 'Recall@5': 0.09853852167725563, 'NDCG@5': 0.06374790146946907, 'MRR@5': 0.052424714900553226, 'Recall*@10': 0.1527199000120163, 'NDCG*@10': 0.08106864616274834, 'MRR*@10': 0.05945443920791149, 'Recall*@5': 0.09853852167725563, 'NDCG*@5': 0.06374790146946907, 'MRR*@5': 0.052424714900553226}
INFO    [11-27 18:52:10] train in BasicTrainer:
duration: 4.361629486083984s
INFO    [11-27 18:52:10] train in BasicTrainer:
epoch: 43
INFO    [11-27 18:52:13] _train_one_epoch in BasicTrainer:
loss = 4.2746255506168715
INFO    [11-27 18:52:15] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [11-27 18:52:15] validate in BasicTrainer:
{'Recall@10': 0.15428566187620163, 'NDCG@10': 0.08262501657009125, 'MRR@10': 0.06101047806441784, 'Recall@5': 0.10104720667004585, 'NDCG@5': 0.06560780853033066, 'MRR@5': 0.05410419777035713, 'Recall*@10': 0.15428566187620163, 'NDCG*@10': 0.08262501657009125, 'MRR*@10': 0.06101047806441784, 'Recall*@5': 0.10104720667004585, 'NDCG*@5': 0.06560780853033066, 'MRR*@5': 0.05410419777035713}
INFO    [11-27 18:52:15] train in BasicTrainer:
duration: 4.320466995239258s
INFO    [11-27 18:52:15] train in BasicTrainer:
epoch: 44
INFO    [11-27 18:52:17] _train_one_epoch in BasicTrainer:
loss = 4.259733070026744
INFO    [11-27 18:52:19] validate in BasicTrainer:
{'Recall@10': 0.15239981561899185, 'NDCG@10': 0.08181632868945599, 'MRR@10': 0.06042252294719219, 'Recall@5': 0.10135862603783607, 'NDCG@5': 0.06551402807235718, 'MRR@5': 0.053813633508980274, 'Recall*@10': 0.15239981561899185, 'NDCG*@10': 0.08181632868945599, 'MRR*@10': 0.06042252294719219, 'Recall*@5': 0.10135862603783607, 'NDCG*@5': 0.06551402807235718, 'MRR*@5': 0.053813633508980274}
INFO    [11-27 18:52:19] train in BasicTrainer:
duration: 4.325173377990723s
INFO    [11-27 18:52:19] train in BasicTrainer:
epoch: 45
DEBUG   [11-27 18:52:20] calculate_loss in loss:
soft_target max: 0.5027613043785095, argmax 1857549
DEBUG   [11-27 18:52:20] calculate_loss in loss:
pred max in softmax: 0.16199767589569092, argmax 3493644
DEBUG   [11-27 18:52:20] calculate_loss in loss:
soft_target max: 0.5027613043785095, argmax 66872
DEBUG   [11-27 18:52:20] calculate_loss in loss:
pred max in softmax: 0.15825775265693665, argmax 3220119
INFO    [11-27 18:52:21] _train_one_epoch in BasicTrainer:
loss = 4.24561520056291
INFO    [11-27 18:52:24] validate in BasicTrainer:
{'Recall@10': 0.14764340594410896, 'NDCG@10': 0.08186865039169788, 'MRR@10': 0.06178149301558733, 'Recall@5': 0.10140908509492874, 'NDCG@5': 0.0668012285605073, 'MRR@5': 0.05549590103328228, 'Recall*@10': 0.14764340594410896, 'NDCG*@10': 0.08186865039169788, 'MRR*@10': 0.06178149301558733, 'Recall*@5': 0.10140908509492874, 'NDCG*@5': 0.0668012285605073, 'MRR*@5': 0.05549590103328228}
INFO    [11-27 18:52:24] train in BasicTrainer:
duration: 4.401330947875977s
INFO    [11-27 18:52:24] train in BasicTrainer:
epoch: 46
INFO    [11-27 18:52:26] _train_one_epoch in BasicTrainer:
loss = 4.232504822991111
INFO    [11-27 18:52:28] validate in BasicTrainer:
{'Recall@10': 0.15496762469410896, 'NDCG@10': 0.08246446214616299, 'MRR@10': 0.06042237486690283, 'Recall@5': 0.10360635071992874, 'NDCG@5': 0.06607659161090851, 'MRR@5': 0.05379031505435705, 'Recall*@10': 0.15496762469410896, 'NDCG*@10': 0.08246446214616299, 'MRR*@10': 0.06042237486690283, 'Recall*@5': 0.10360635071992874, 'NDCG*@5': 0.06607659161090851, 'MRR*@5': 0.05379031505435705}
INFO    [11-27 18:52:28] train in BasicTrainer:
duration: 4.415005445480347s
INFO    [11-27 18:52:28] train in BasicTrainer:
epoch: 47
INFO    [11-27 18:52:30] _train_one_epoch in BasicTrainer:
loss = 4.217676390301097
INFO    [11-27 18:52:32] validate in BasicTrainer:
{'Recall@10': 0.15309859812259674, 'NDCG@10': 0.08164463751018047, 'MRR@10': 0.06004219129681587, 'Recall@5': 0.09855534136295319, 'NDCG@5': 0.0640529990196228, 'MRR@5': 0.0528086107224226, 'Recall*@10': 0.15309859812259674, 'NDCG*@10': 0.08164463751018047, 'MRR*@10': 0.06004219129681587, 'Recall*@5': 0.09855534136295319, 'NDCG*@5': 0.0640529990196228, 'MRR*@5': 0.0528086107224226}
INFO    [11-27 18:52:32] train in BasicTrainer:
duration: 4.369851589202881s
INFO    [11-27 18:52:32] train in BasicTrainer:
epoch: 48
INFO    [11-27 18:52:35] _train_one_epoch in BasicTrainer:
loss = 4.2056286985223945
INFO    [11-27 18:52:37] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [11-27 18:52:37] validate in BasicTrainer:
{'Recall@10': 0.1599513553082943, 'NDCG@10': 0.08510751090943813, 'MRR@10': 0.06257906556129456, 'Recall@5': 0.09937186166644096, 'NDCG@5': 0.0656310236081481, 'MRR@5': 0.054604532197117805, 'Recall*@10': 0.1599513553082943, 'NDCG*@10': 0.08510751090943813, 'MRR*@10': 0.06257906556129456, 'Recall*@5': 0.09937186166644096, 'NDCG*@5': 0.0656310236081481, 'MRR*@5': 0.054604532197117805}
INFO    [11-27 18:52:37] train in BasicTrainer:
duration: 4.443506240844727s
INFO    [11-27 18:52:37] train in BasicTrainer:
epoch: 49
INFO    [11-27 18:52:39] _train_one_epoch in BasicTrainer:
loss = 4.194154240868309
INFO    [11-27 18:52:41] validate in BasicTrainer:
{'Recall@10': 0.15834328904747963, 'NDCG@10': 0.08433635160326958, 'MRR@10': 0.061925314366817474, 'Recall@5': 0.10357271134853363, 'NDCG@5': 0.06685851886868477, 'MRR@5': 0.05484785791486502, 'Recall*@10': 0.15834328904747963, 'NDCG*@10': 0.08433635160326958, 'MRR*@10': 0.061925314366817474, 'Recall*@5': 0.10357271134853363, 'NDCG*@5': 0.06685851886868477, 'MRR*@5': 0.05484785791486502}
INFO    [11-27 18:52:41] train in BasicTrainer:
duration: 4.4139814376831055s
INFO    [11-27 18:52:41] train in BasicTrainer:
epoch: 50
INFO    [11-27 18:52:43] _train_one_epoch in BasicTrainer:
loss = 4.178827058185231
INFO    [11-27 18:52:46] validate in BasicTrainer:
{'Recall@10': 0.15866337344050407, 'NDCG@10': 0.08510646410286427, 'MRR@10': 0.06282110139727592, 'Recall@5': 0.10179644823074341, 'NDCG@5': 0.0668034590780735, 'MRR@5': 0.055319804698228836, 'Recall*@10': 0.15866337344050407, 'NDCG*@10': 0.08510646410286427, 'MRR*@10': 0.06282110139727592, 'Recall*@5': 0.10179644823074341, 'NDCG*@5': 0.0668034590780735, 'MRR*@5': 0.055319804698228836}
INFO    [11-27 18:52:46] train in BasicTrainer:
duration: 4.381735324859619s
INFO    [11-27 18:52:46] train in BasicTrainer:
epoch: 51
INFO    [11-27 18:52:48] _train_one_epoch in BasicTrainer:
loss = 4.168423327532682
INFO    [11-27 18:52:50] validate in BasicTrainer:
{'Recall@10': 0.16052373498678207, 'NDCG@10': 0.084917476400733, 'MRR@10': 0.0620679035782814, 'Recall@5': 0.10432195290923119, 'NDCG@5': 0.06705114152282476, 'MRR@5': 0.05487179011106491, 'Recall*@10': 0.16052373498678207, 'NDCG*@10': 0.084917476400733, 'MRR*@10': 0.0620679035782814, 'Recall*@5': 0.10432195290923119, 'NDCG*@5': 0.06705114152282476, 'MRR*@5': 0.05487179011106491}
INFO    [11-27 18:52:50] train in BasicTrainer:
duration: 4.392991065979004s
INFO    [11-27 18:52:50] train in BasicTrainer:
epoch: 52
INFO    [11-27 18:52:52] _train_one_epoch in BasicTrainer:
loss = 4.153913422064348
INFO    [11-27 18:52:54] validate in BasicTrainer:
{'Recall@10': 0.1558009646832943, 'NDCG@10': 0.08425665460526943, 'MRR@10': 0.06253806035965681, 'Recall@5': 0.10282346978783607, 'NDCG@5': 0.06723571196198463, 'MRR@5': 0.055580331943929195, 'Recall*@10': 0.1558009646832943, 'NDCG*@10': 0.08425665460526943, 'MRR*@10': 0.06253806035965681, 'Recall*@5': 0.10282346978783607, 'NDCG*@5': 0.06723571196198463, 'MRR*@5': 0.055580331943929195}
INFO    [11-27 18:52:54] train in BasicTrainer:
duration: 4.416582107543945s
INFO    [11-27 18:52:54] train in BasicTrainer:
epoch: 53
INFO    [11-27 18:52:57] _train_one_epoch in BasicTrainer:
loss = 4.1393749280409375
INFO    [11-27 18:52:59] validate in BasicTrainer:
{'Recall@10': 0.15615468844771385, 'NDCG@10': 0.08384321257472038, 'MRR@10': 0.06186164915561676, 'Recall@5': 0.1050880141556263, 'NDCG@5': 0.0673843901604414, 'MRR@5': 0.055099896155297756, 'Recall*@10': 0.15615468844771385, 'NDCG*@10': 0.08384321257472038, 'MRR*@10': 0.06186164915561676, 'Recall*@5': 0.1050880141556263, 'NDCG*@5': 0.0673843901604414, 'MRR*@5': 0.055099896155297756}
INFO    [11-27 18:52:59] train in BasicTrainer:
duration: 4.321302652359009s
INFO    [11-27 18:52:59] train in BasicTrainer:
epoch: 54
INFO    [11-27 18:53:01] _train_one_epoch in BasicTrainer:
loss = 4.134240529753945
INFO    [11-27 18:53:03] log in loggers:
Update Best NDCG@10 Model at 54
INFO    [11-27 18:53:04] validate in BasicTrainer:
{'Recall@10': 0.1572658084332943, 'NDCG@10': 0.08543403819203377, 'MRR@10': 0.06357641145586967, 'Recall@5': 0.1054249182343483, 'NDCG@5': 0.06867495365440845, 'MRR@5': 0.056663657538592815, 'Recall*@10': 0.1572658084332943, 'NDCG*@10': 0.08543403819203377, 'MRR*@10': 0.06357641145586967, 'Recall*@5': 0.1054249182343483, 'NDCG*@5': 0.06867495365440845, 'MRR*@5': 0.056663657538592815}
INFO    [11-27 18:53:04] train in BasicTrainer:
duration: 4.8109002113342285s
INFO    [11-27 18:53:04] train in BasicTrainer:
epoch: 55
INFO    [11-27 18:53:06] _train_one_epoch in BasicTrainer:
loss = 4.118543511087244
INFO    [11-27 18:53:08] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [11-27 18:53:08] validate in BasicTrainer:
{'Recall@10': 0.15972403436899185, 'NDCG@10': 0.08660607412457466, 'MRR@10': 0.064361865632236, 'Recall@5': 0.10674653947353363, 'NDCG@5': 0.06965813599526882, 'MRR@5': 0.05747520551085472, 'Recall*@10': 0.15972403436899185, 'NDCG*@10': 0.08660607412457466, 'MRR*@10': 0.064361865632236, 'Recall*@5': 0.10674653947353363, 'NDCG*@5': 0.06965813599526882, 'MRR*@5': 0.05747520551085472}
INFO    [11-27 18:53:08] train in BasicTrainer:
duration: 4.596589803695679s
INFO    [11-27 18:53:08] train in BasicTrainer:
epoch: 56
INFO    [11-27 18:53:10] _train_one_epoch in BasicTrainer:
loss = 4.1053173542022705
INFO    [11-27 18:53:12] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [11-27 18:53:12] validate in BasicTrainer:
{'Recall@10': 0.16451408341526985, 'NDCG@10': 0.08826643414795399, 'MRR@10': 0.06518268398940563, 'Recall@5': 0.10730209946632385, 'NDCG@5': 0.06993823871016502, 'MRR@5': 0.05771779268980026, 'Recall*@10': 0.16451408341526985, 'NDCG*@10': 0.08826643414795399, 'MRR*@10': 0.06518268398940563, 'Recall*@5': 0.10730209946632385, 'NDCG*@5': 0.06993823871016502, 'MRR*@5': 0.05771779268980026}
INFO    [11-27 18:53:12] train in BasicTrainer:
duration: 4.2587502002716064s
INFO    [11-27 18:53:12] train in BasicTrainer:
epoch: 57
INFO    [11-27 18:53:15] _train_one_epoch in BasicTrainer:
loss = 4.094072580337524
INFO    [11-27 18:53:17] validate in BasicTrainer:
{'Recall@10': 0.16109611466526985, 'NDCG@10': 0.08710403926670551, 'MRR@10': 0.0647089360281825, 'Recall@5': 0.1048438735306263, 'NDCG@5': 0.06896988861262798, 'MRR@5': 0.057254767045378685, 'Recall*@10': 0.16109611466526985, 'NDCG*@10': 0.08710403926670551, 'MRR*@10': 0.0647089360281825, 'Recall*@5': 0.1048438735306263, 'NDCG*@5': 0.06896988861262798, 'MRR*@5': 0.057254767045378685}
INFO    [11-27 18:53:17] train in BasicTrainer:
duration: 4.3845460414886475s
INFO    [11-27 18:53:17] train in BasicTrainer:
epoch: 58
INFO    [11-27 18:53:19] _train_one_epoch in BasicTrainer:
loss = 4.080746954137629
INFO    [11-27 18:53:21] validate in BasicTrainer:
{'Recall@10': 0.16050691530108452, 'NDCG@10': 0.08658280782401562, 'MRR@10': 0.06416035443544388, 'Recall@5': 0.10562675446271896, 'NDCG@5': 0.06891261227428913, 'MRR@5': 0.05691394675523043, 'Recall*@10': 0.16050691530108452, 'NDCG*@10': 0.08658280782401562, 'MRR*@10': 0.06416035443544388, 'Recall*@5': 0.10562675446271896, 'NDCG*@5': 0.06891261227428913, 'MRR*@5': 0.05691394675523043}
INFO    [11-27 18:53:21] train in BasicTrainer:
duration: 4.21857476234436s
INFO    [11-27 18:53:21] train in BasicTrainer:
epoch: 59
INFO    [11-27 18:53:23] _train_one_epoch in BasicTrainer:
loss = 4.073032249103893
INFO    [11-27 18:53:25] validate in BasicTrainer:
{'Recall@10': 0.15920211374759674, 'NDCG@10': 0.08698052167892456, 'MRR@10': 0.06502468697726727, 'Recall@5': 0.10580361634492874, 'NDCG@5': 0.06978653743863106, 'MRR@5': 0.05797207821160555, 'Recall*@10': 0.15920211374759674, 'NDCG*@10': 0.08698052167892456, 'MRR*@10': 0.06502468697726727, 'Recall*@5': 0.10580361634492874, 'NDCG*@5': 0.06978653743863106, 'MRR*@5': 0.05797207821160555}
INFO    [11-27 18:53:25] train in BasicTrainer:
duration: 4.148046493530273s
INFO    [11-27 18:53:25] train in BasicTrainer:
epoch: 60
INFO    [11-27 18:53:27] _train_one_epoch in BasicTrainer:
loss = 4.063440116969022
INFO    [11-27 18:53:30] log in loggers:
Update Best NDCG@10 Model at 60
INFO    [11-27 18:53:30] validate in BasicTrainer:
{'Recall@10': 0.16407626122236252, 'NDCG@10': 0.0889205951243639, 'MRR@10': 0.06606460176408291, 'Recall@5': 0.11010538414120674, 'NDCG@5': 0.0716071929782629, 'MRR@5': 0.05900202039629221, 'Recall*@10': 0.16407626122236252, 'NDCG*@10': 0.0889205951243639, 'MRR*@10': 0.06606460176408291, 'Recall*@5': 0.11010538414120674, 'NDCG*@5': 0.0716071929782629, 'MRR*@5': 0.05900202039629221}
INFO    [11-27 18:53:30] train in BasicTrainer:
duration: 4.56327748298645s
INFO    [11-27 18:53:30] train in BasicTrainer:
epoch: 61
INFO    [11-27 18:53:32] _train_one_epoch in BasicTrainer:
loss = 4.048650681972504
INFO    [11-27 18:53:34] validate in BasicTrainer:
{'Recall@10': 0.16121385246515274, 'NDCG@10': 0.08852915093302727, 'MRR@10': 0.06638025399297476, 'Recall@5': 0.10806816071271896, 'NDCG@5': 0.07125471532344818, 'MRR@5': 0.05919853039085865, 'Recall*@10': 0.16121385246515274, 'NDCG*@10': 0.08852915093302727, 'MRR*@10': 0.06638025399297476, 'Recall*@5': 0.10806816071271896, 'NDCG*@5': 0.07125471532344818, 'MRR*@5': 0.05919853039085865}
INFO    [11-27 18:53:34] train in BasicTrainer:
duration: 4.416852712631226s
INFO    [11-27 18:53:34] train in BasicTrainer:
epoch: 62
INFO    [11-27 18:53:36] _train_one_epoch in BasicTrainer:
loss = 4.036645553328774
INFO    [11-27 18:53:38] log in loggers:
Update Best NDCG@10 Model at 62
INFO    [11-27 18:53:38] validate in BasicTrainer:
{'Recall@10': 0.16475822404026985, 'NDCG@10': 0.08972970023751259, 'MRR@10': 0.06693508848547935, 'Recall@5': 0.11125880852341652, 'NDCG@5': 0.07252658903598785, 'MRR@5': 0.05989257339388132, 'Recall*@10': 0.16475822404026985, 'NDCG*@10': 0.08972970023751259, 'MRR*@10': 0.06693508848547935, 'Recall*@5': 0.11125880852341652, 'NDCG*@5': 0.07252658903598785, 'MRR*@5': 0.05989257339388132}
INFO    [11-27 18:53:38] train in BasicTrainer:
duration: 4.224392414093018s
INFO    [11-27 18:53:38] train in BasicTrainer:
epoch: 63
INFO    [11-27 18:53:41] _train_one_epoch in BasicTrainer:
loss = 4.028631714257327
INFO    [11-27 18:53:43] validate in BasicTrainer:
{'Recall@10': 0.16524650529026985, 'NDCG@10': 0.08935423009097576, 'MRR@10': 0.06632952950894833, 'Recall@5': 0.10780720040202141, 'NDCG@5': 0.0709063708782196, 'MRR@5': 0.05878791678696871, 'Recall*@10': 0.16524650529026985, 'NDCG*@10': 0.08935423009097576, 'MRR*@10': 0.06632952950894833, 'Recall*@5': 0.10780720040202141, 'NDCG*@5': 0.0709063708782196, 'MRR*@5': 0.05878791678696871}
INFO    [11-27 18:53:43] train in BasicTrainer:
duration: 4.373060464859009s
INFO    [11-27 18:53:43] train in BasicTrainer:
epoch: 64
INFO    [11-27 18:53:45] _train_one_epoch in BasicTrainer:
loss = 4.017719642682509
INFO    [11-27 18:53:47] log in loggers:
Update Best NDCG@10 Model at 64
INFO    [11-27 18:53:47] validate in BasicTrainer:
{'Recall@10': 0.16402580216526985, 'NDCG@10': 0.08996179327368736, 'MRR@10': 0.06740805134177208, 'Recall@5': 0.10951618477702141, 'NDCG@5': 0.0723829623311758, 'MRR@5': 0.06017994321882725, 'Recall*@10': 0.16402580216526985, 'NDCG*@10': 0.08996179327368736, 'MRR*@10': 0.06740805134177208, 'Recall*@5': 0.10951618477702141, 'NDCG*@5': 0.0723829623311758, 'MRR*@5': 0.06017994321882725}
INFO    [11-27 18:53:47] train in BasicTrainer:
duration: 4.47158408164978s
INFO    [11-27 18:53:47] train in BasicTrainer:
epoch: 65
INFO    [11-27 18:53:49] _train_one_epoch in BasicTrainer:
loss = 4.007914315570485
INFO    [11-27 18:53:52] validate in BasicTrainer:
{'Recall@10': 0.16357116028666496, 'NDCG@10': 0.0885932557284832, 'MRR@10': 0.0656950669363141, 'Recall@5': 0.1119239516556263, 'NDCG@5': 0.07199150323867798, 'MRR@5': 0.0589010426774621, 'Recall*@10': 0.16357116028666496, 'NDCG*@10': 0.0885932557284832, 'MRR*@10': 0.0656950669363141, 'Recall*@5': 0.1119239516556263, 'NDCG*@5': 0.07199150323867798, 'MRR*@5': 0.0589010426774621}
INFO    [11-27 18:53:52] train in BasicTrainer:
duration: 4.353795766830444s
INFO    [11-27 18:53:52] train in BasicTrainer:
epoch: 66
INFO    [11-27 18:53:54] _train_one_epoch in BasicTrainer:
loss = 3.9988742037252947
INFO    [11-27 18:53:56] log in loggers:
Update Best NDCG@10 Model at 66
INFO    [11-27 18:53:56] validate in BasicTrainer:
{'Recall@10': 0.16677862778306007, 'NDCG@10': 0.09027526341378689, 'MRR@10': 0.06708107143640518, 'Recall@5': 0.10847234353423119, 'NDCG@5': 0.07154200598597527, 'MRR@5': 0.059417485259473324, 'Recall*@10': 0.16677862778306007, 'NDCG*@10': 0.09027526341378689, 'MRR*@10': 0.06708107143640518, 'Recall*@5': 0.10847234353423119, 'NDCG*@5': 0.07154200598597527, 'MRR*@5': 0.059417485259473324}
INFO    [11-27 18:53:56] train in BasicTrainer:
duration: 4.534292936325073s
INFO    [11-27 18:53:56] train in BasicTrainer:
epoch: 67
INFO    [11-27 18:53:58] _train_one_epoch in BasicTrainer:
loss = 3.9883809902451257
INFO    [11-27 18:54:00] validate in BasicTrainer:
{'Recall@10': 0.1640089824795723, 'NDCG@10': 0.08967944793403149, 'MRR@10': 0.0670354263857007, 'Recall@5': 0.11077052727341652, 'NDCG@5': 0.07248524203896523, 'MRR@5': 0.05994879174977541, 'Recall*@10': 0.1640089824795723, 'NDCG*@10': 0.08967944793403149, 'MRR*@10': 0.0670354263857007, 'Recall*@5': 0.11077052727341652, 'NDCG*@5': 0.07248524203896523, 'MRR*@5': 0.05994879174977541}
INFO    [11-27 18:54:00] train in BasicTrainer:
duration: 4.309496164321899s
INFO    [11-27 18:54:00] train in BasicTrainer:
epoch: 68
DEBUG   [11-27 18:54:01] calculate_loss in loss:
soft_target max: 0.5027613043785095, argmax 2036252
DEBUG   [11-27 18:54:01] calculate_loss in loss:
pred max in softmax: 0.2831898033618927, argmax 321789
DEBUG   [11-27 18:54:01] calculate_loss in loss:
soft_target max: 0.5027613043785095, argmax 442513
DEBUG   [11-27 18:54:01] calculate_loss in loss:
pred max in softmax: 0.22762201726436615, argmax 3653800
INFO    [11-27 18:54:03] _train_one_epoch in BasicTrainer:
loss = 3.9781736568971113
INFO    [11-27 18:54:05] validate in BasicTrainer:
{'Recall@10': 0.1628219187259674, 'NDCG@10': 0.090020090341568, 'MRR@10': 0.06772857252508402, 'Recall@5': 0.11127562820911407, 'NDCG@5': 0.07327521778643131, 'MRR@5': 0.060771157033741474, 'Recall*@10': 0.1628219187259674, 'NDCG*@10': 0.090020090341568, 'MRR*@10': 0.06772857252508402, 'Recall*@5': 0.11127562820911407, 'NDCG*@5': 0.07327521778643131, 'MRR*@5': 0.060771157033741474}
INFO    [11-27 18:54:05] train in BasicTrainer:
duration: 4.373683452606201s
INFO    [11-27 18:54:05] train in BasicTrainer:
epoch: 69
INFO    [11-27 18:54:07] _train_one_epoch in BasicTrainer:
loss = 3.9666765278035943
INFO    [11-27 18:54:09] log in loggers:
Update Best NDCG@10 Model at 69
INFO    [11-27 18:54:09] validate in BasicTrainer:
{'Recall@10': 0.1668795458972454, 'NDCG@10': 0.09212878718972206, 'MRR@10': 0.06936165690422058, 'Recall@5': 0.11165432631969452, 'NDCG@5': 0.07443439774215221, 'MRR@5': 0.06215428002178669, 'Recall*@10': 0.1668795458972454, 'NDCG*@10': 0.09212878718972206, 'MRR*@10': 0.06936165690422058, 'Recall*@5': 0.11165432631969452, 'NDCG*@5': 0.07443439774215221, 'MRR*@5': 0.06215428002178669}
INFO    [11-27 18:54:09] train in BasicTrainer:
duration: 4.429220199584961s
INFO    [11-27 18:54:09] train in BasicTrainer:
epoch: 70
INFO    [11-27 18:54:12] _train_one_epoch in BasicTrainer:
loss = 3.9623436711051245
INFO    [11-27 18:54:14] validate in BasicTrainer:
{'Recall@10': 0.1627882793545723, 'NDCG@10': 0.09091323614120483, 'MRR@10': 0.06900550611317158, 'Recall@5': 0.11245402693748474, 'NDCG@5': 0.07477482967078686, 'MRR@5': 0.06242616381496191, 'Recall*@10': 0.1627882793545723, 'NDCG*@10': 0.09091323614120483, 'MRR*@10': 0.06900550611317158, 'Recall*@5': 0.11245402693748474, 'NDCG*@5': 0.07477482967078686, 'MRR*@5': 0.06242616381496191}
INFO    [11-27 18:54:14] train in BasicTrainer:
duration: 4.5597076416015625s
INFO    [11-27 18:54:14] train in BasicTrainer:
epoch: 71
INFO    [11-27 18:54:16] _train_one_epoch in BasicTrainer:
loss = 3.9532100829211148
INFO    [11-27 18:54:18] validate in BasicTrainer:
{'Recall@10': 0.1630660593509674, 'NDCG@10': 0.09077963978052139, 'MRR@10': 0.06878346763551235, 'Recall@5': 0.11108194664120674, 'NDCG@5': 0.07412942871451378, 'MRR@5': 0.062004719860851765, 'Recall*@10': 0.1630660593509674, 'NDCG*@10': 0.09077963978052139, 'MRR*@10': 0.06878346763551235, 'Recall*@5': 0.11108194664120674, 'NDCG*@5': 0.07412942871451378, 'MRR*@5': 0.062004719860851765}
INFO    [11-27 18:54:18] train in BasicTrainer:
duration: 4.421326398849487s
INFO    [11-27 18:54:18] train in BasicTrainer:
epoch: 72
INFO    [11-27 18:54:20] _train_one_epoch in BasicTrainer:
loss = 3.9386224042285574
INFO    [11-27 18:54:23] validate in BasicTrainer:
{'Recall@10': 0.16432040184736252, 'NDCG@10': 0.09128905273973942, 'MRR@10': 0.0691219661384821, 'Recall@5': 0.10991170257329941, 'NDCG@5': 0.07378156296908855, 'MRR@5': 0.06194957997649908, 'Recall*@10': 0.16432040184736252, 'NDCG*@10': 0.09128905273973942, 'MRR*@10': 0.0691219661384821, 'Recall*@5': 0.10991170257329941, 'NDCG*@5': 0.07378156296908855, 'MRR*@5': 0.06194957997649908}
INFO    [11-27 18:54:23] train in BasicTrainer:
duration: 4.399844169616699s
INFO    [11-27 18:54:23] train in BasicTrainer:
epoch: 73
INFO    [11-27 18:54:25] _train_one_epoch in BasicTrainer:
loss = 3.9331708496267144
INFO    [11-27 18:54:27] log in loggers:
Update Best NDCG@10 Model at 73
INFO    [11-27 18:54:27] validate in BasicTrainer:
{'Recall@10': 0.17055847495794296, 'NDCG@10': 0.09275331161916256, 'MRR@10': 0.06920048967003822, 'Recall@5': 0.10930568352341652, 'NDCG@5': 0.07307193614542484, 'MRR@5': 0.06115292105823755, 'Recall*@10': 0.17055847495794296, 'NDCG*@10': 0.09275331161916256, 'MRR*@10': 0.06920048967003822, 'Recall*@5': 0.10930568352341652, 'NDCG*@5': 0.07307193614542484, 'MRR*@5': 0.06115292105823755}
INFO    [11-27 18:54:27] train in BasicTrainer:
duration: 4.4817280769348145s
INFO    [11-27 18:54:27] train in BasicTrainer:
epoch: 74
INFO    [11-27 18:54:29] _train_one_epoch in BasicTrainer:
loss = 3.924181271683086
INFO    [11-27 18:54:32] validate in BasicTrainer:
{'Recall@10': 0.16803297027945518, 'NDCG@10': 0.09252494387328625, 'MRR@10': 0.06952591612935066, 'Recall@5': 0.11460083350539207, 'NDCG@5': 0.075429767370224, 'MRR@5': 0.06257730256766081, 'Recall*@10': 0.16803297027945518, 'NDCG*@10': 0.09252494387328625, 'MRR*@10': 0.06952591612935066, 'Recall*@5': 0.11460083350539207, 'NDCG*@5': 0.075429767370224, 'MRR*@5': 0.06257730256766081}
INFO    [11-27 18:54:32] train in BasicTrainer:
duration: 4.794619798660278s
INFO    [11-27 18:54:32] train in BasicTrainer:
epoch: 75
INFO    [11-27 18:54:34] _train_one_epoch in BasicTrainer:
loss = 3.913976566358046
INFO    [11-27 18:54:36] log in loggers:
Update Best NDCG@10 Model at 75
INFO    [11-27 18:54:36] validate in BasicTrainer:
{'Recall@10': 0.16845397278666496, 'NDCG@10': 0.09378175996243954, 'MRR@10': 0.0711072999984026, 'Recall@5': 0.11111558601260185, 'NDCG@5': 0.07529151439666748, 'MRR@5': 0.06350219342857599, 'Recall*@10': 0.16845397278666496, 'NDCG*@10': 0.09378175996243954, 'MRR*@10': 0.0711072999984026, 'Recall*@5': 0.11111558601260185, 'NDCG*@5': 0.07529151439666748, 'MRR*@5': 0.06350219342857599}
INFO    [11-27 18:54:36] train in BasicTrainer:
duration: 4.4228515625s
INFO    [11-27 18:54:36] train in BasicTrainer:
epoch: 76
INFO    [11-27 18:54:38] _train_one_epoch in BasicTrainer:
loss = 3.8999752564863726
INFO    [11-27 18:54:41] validate in BasicTrainer:
{'Recall@10': 0.16636629030108452, 'NDCG@10': 0.09264183603227139, 'MRR@10': 0.07016303762793541, 'Recall@5': 0.11296779289841652, 'NDCG@5': 0.07552330382168293, 'MRR@5': 0.06318613700568676, 'Recall*@10': 0.16636629030108452, 'NDCG*@10': 0.09264183603227139, 'MRR*@10': 0.07016303762793541, 'Recall*@5': 0.11296779289841652, 'NDCG*@5': 0.07552330382168293, 'MRR*@5': 0.06318613700568676}
INFO    [11-27 18:54:41] train in BasicTrainer:
duration: 4.37148118019104s
INFO    [11-27 18:54:41] train in BasicTrainer:
epoch: 77
INFO    [11-27 18:54:43] _train_one_epoch in BasicTrainer:
loss = 3.896103403785012
INFO    [11-27 18:54:45] log in loggers:
Update Best NDCG@10 Model at 77
INFO    [11-27 18:54:45] validate in BasicTrainer:
{'Recall@10': 0.1684035137295723, 'NDCG@10': 0.09392208606004715, 'MRR@10': 0.07128699868917465, 'Recall@5': 0.11160386726260185, 'NDCG@5': 0.07566608116030693, 'MRR@5': 0.06381595693528652, 'Recall*@10': 0.1684035137295723, 'NDCG*@10': 0.09392208606004715, 'MRR*@10': 0.07128699868917465, 'Recall*@5': 0.11160386726260185, 'NDCG*@5': 0.07566608116030693, 'MRR*@5': 0.06381595693528652}
INFO    [11-27 18:54:45] train in BasicTrainer:
duration: 4.180742979049683s
INFO    [11-27 18:54:45] train in BasicTrainer:
epoch: 78
INFO    [11-27 18:54:47] _train_one_epoch in BasicTrainer:
loss = 3.8901624462821265
INFO    [11-27 18:54:49] validate in BasicTrainer:
{'Recall@10': 0.1706344187259674, 'NDCG@10': 0.09388339892029762, 'MRR@10': 0.07057265378534794, 'Recall@5': 0.11308553069829941, 'NDCG@5': 0.07534855231642723, 'MRR@5': 0.0629677688702941, 'Recall*@10': 0.1706344187259674, 'NDCG*@10': 0.09388339892029762, 'MRR*@10': 0.07057265378534794, 'Recall*@5': 0.11308553069829941, 'NDCG*@5': 0.07534855231642723, 'MRR*@5': 0.0629677688702941}
INFO    [11-27 18:54:49] train in BasicTrainer:
duration: 4.270069599151611s
INFO    [11-27 18:54:49] train in BasicTrainer:
epoch: 79
INFO    [11-27 18:54:51] _train_one_epoch in BasicTrainer:
loss = 3.8772957812656057
INFO    [11-27 18:54:53] log in loggers:
Update Best NDCG@10 Model at 79
INFO    [11-27 18:54:53] validate in BasicTrainer:
{'Recall@10': 0.17141729965806007, 'NDCG@10': 0.0945078544318676, 'MRR@10': 0.07125561870634556, 'Recall@5': 0.11148612946271896, 'NDCG@5': 0.07530905492603779, 'MRR@5': 0.0634398078545928, 'Recall*@10': 0.17141729965806007, 'NDCG*@10': 0.0945078544318676, 'MRR*@10': 0.07125561870634556, 'Recall*@5': 0.11148612946271896, 'NDCG*@5': 0.07530905492603779, 'MRR*@5': 0.0634398078545928}
INFO    [11-27 18:54:53] train in BasicTrainer:
duration: 4.268822431564331s
INFO    [11-27 18:54:53] close_training in BasicTrainer:
finished training
DEBUG   [11-27 18:54:53] debug_summary in loss:
loss nan summary: nan 0 times, not nan 3521 times, ratio nan / (nan + not_nan) = 0.0
INFO    [11-27 18:54:53] run_routine in Routine:
Finished training, Start final validation
INFO    [11-27 18:54:53] final_validate in BasicTrainer:
validate model on val set!
INFO    [11-27 18:54:53] load_state_from_given_path in utils:
checkpoint epoch: 79
INFO    [11-27 18:54:53] load_state_from_given_path in utils:
Loading model's parameters
INFO    [11-27 18:54:56] validate in BasicTrainer:
{'Recall@10': 0.17141729965806007, 'NDCG@10': 0.0945078544318676, 'MRR@10': 0.07125561870634556, 'Recall@5': 0.11148612946271896, 'NDCG@5': 0.07530905492603779, 'MRR@5': 0.0634398078545928, 'Recall*@10': 0.17141729965806007, 'NDCG*@10': 0.0945078544318676, 'MRR*@10': 0.07125561870634556, 'Recall*@5': 0.11148612946271896, 'NDCG*@5': 0.07530905492603779, 'MRR*@5': 0.0634398078545928}
INFO    [11-27 18:54:56] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.17141729965806007, 'NDCG@10': 0.0945078544318676, 'MRR@10': 0.07125561870634556, 'Recall@5': 0.11148612946271896, 'NDCG@5': 0.07530905492603779, 'MRR@5': 0.0634398078545928, 'Recall*@10': 0.17141729965806007, 'NDCG*@10': 0.0945078544318676, 'MRR*@10': 0.07125561870634556, 'Recall*@5': 0.11148612946271896, 'NDCG*@5': 0.07530905492603779, 'MRR*@5': 0.0634398078545928}
INFO    [11-27 18:54:56] _evaluate in DistillSched:
Start testing student model on test set
INFO    [11-27 18:54:56] test in BasicTrainer:
Test model on test set!
INFO    [11-27 18:54:56] test_with_given_state_path in BasicTrainer:
Loading model params from _____lfms_soft_len_4/soft_gru4rec-len-15_11-27_18-48_t2/student_gru4rec_logs/checkpoint/best_acc_model.pth.
INFO    [11-27 18:54:56] load_state_from_given_path in utils:
checkpoint epoch: 79
INFO    [11-27 18:54:56] load_state_from_given_path in utils:
Loading model's parameters
INFO    [11-27 18:54:56] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [11-27 18:54:58] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.15415110439062119, 'NDCG@10': 0.08196774497628212, 'MRR@10': 0.06003638915717602, 'Recall@5': 0.10047482512891293, 'NDCG@5': 0.06463063880801201, 'MRR@5': 0.05289192032068968, 'Recall*@10': 0.15415110439062119, 'NDCG*@10': 0.08196774497628212, 'MRR*@10': 0.06003638915717602, 'Recall*@5': 0.10047482512891293, 'NDCG*@5': 0.06463063880801201, 'MRR*@5': 0.05289192032068968}
INFO    [11-27 18:54:58] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.15415110439062119, 'NDCG@10': 0.08196774497628212, 'MRR@10': 0.06003638915717602, 'Recall@5': 0.10047482512891293, 'NDCG@5': 0.06463063880801201, 'MRR@5': 0.05289192032068968, 'Recall*@10': 0.15415110439062119, 'NDCG*@10': 0.08196774497628212, 'MRR*@10': 0.06003638915717602, 'Recall*@5': 0.10047482512891293, 'NDCG*@5': 0.06463063880801201, 'MRR*@5': 0.05289192032068968}
