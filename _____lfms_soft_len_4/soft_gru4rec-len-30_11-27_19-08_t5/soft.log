INFO    [11-27 19:08:18] setup_train in utils:
{
    "experiment_dir": "_____lfms_soft_len_4",
    "experiment_description": "soft",
    "describe": "{config[model_code]}-len-{config[max_len]}",
    "dataset_name": "lastfm_small.csv",
    "sched": "distill",
    "model_code": "gru4rec",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "dvae_alpha": 0.5,
    "alpha": 0.5,
    "T": 3,
    "num_epochs": 80,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 30,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2021,
    "load_processed_dataset": false,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 1024,
    "val_batch_size": 1024,
    "test_batch_size": 1024,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.lastfm_small/gru4rec/config_distill.json",
    "task_id": 5,
    "split": "leave_one_out",
    "do_remap": true,
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [11-27 19:08:18] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_gru4rec
INFO    [11-27 19:08:18] _gen_dataset in utils:
processing dataset lastfm_small.csv
INFO    [11-27 19:08:18] _drop_cold in utils:
filtering out cold users (who interacts with less or eq than 5 items) and cold items (which is interacted by less or eq than 5 users)
DEBUG   [11-27 19:08:18] _drop_cold in utils:
before filtering, there are 1090 users, 3646 items 
DEBUG   [11-27 19:08:18] _drop_cold in utils:
after 0 filterings, there are 1090 users, 3646 items
INFO    [11-27 19:08:18] _drop_cold in utils:
user desc 
            seq_len
count  1090.000000
mean     48.211927
std      77.730410
min       5.000000
25%       9.000000
50%      19.000000
75%      49.750000
max     899.000000
INFO    [11-27 19:08:18] _drop_cold in utils:
item desc 
           item_pop
count  3646.000000
mean     14.413330
std      16.072829
min       5.000000
25%       6.000000
50%       9.000000
75%      15.000000
max     177.000000
INFO    [11-27 19:08:18] _df_data_partition in utils:
dataset summary:
         session_id       item_id   rating
count  52551.000000  52551.000000  52551.0
mean     527.873799   1828.243915      1.0
std      316.650738   1049.669215      0.0
min        1.000000      1.000000      1.0
25%      248.000000    928.000000      1.0
50%      515.000000   1834.000000      1.0
75%      813.000000   2718.500000      1.0
max     1090.000000   3646.000000      1.0
INFO    [11-27 19:08:18] __init__ in NextItemDataloader:
there are 3646 items in this dataset, 2376 users, padding_first? False
DEBUG   [11-27 19:08:19] generate_model in utils:
model_code_list=['pop']
INFO    [11-27 19:08:19] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [11-27 19:08:19] load_model_config in utils:
{}
WARNING [11-27 19:08:24] get_exist_path in utils:
dir _____lfms_soft_len_4/soft_gru4rec-len-30_11-27_19-08_t5/teacher_pop_logs does not exist! Create one.
WARNING [11-27 19:08:24] get_exist_path in utils:
dir _____lfms_soft_len_4/soft_gru4rec-len-30_11-27_19-08_t5/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [11-27 19:08:24] get_exist_path in utils:
dir _____lfms_soft_len_4/soft_gru4rec-len-30_11-27_19-08_t5/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [11-27 19:08:24] get_path in utils:
Path is None
WARNING [11-27 19:08:24] load_state_from_given_path in utils:
Not given any path.
DEBUG   [11-27 19:08:24] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [11-27 19:08:24] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [11-27 19:08:24] __init__ in BasicTrainer:
51200 iter per epoch
DEBUG   [11-27 19:08:24] generate_model in utils:
model_code_list=['gru4rec']
INFO    [11-27 19:08:24] load_model_config in utils:
loading model gru4rec's config file at asset/config/model/gru4rec.json
INFO    [11-27 19:08:24] load_model_config in utils:
{
    "embed_size": 64,
    "hidden_units": 64,
    "num_layers": 2,
    "hidden_dropout": 0.5,
    "loss_type": "CE"
}
WARNING [11-27 19:08:26] get_exist_path in utils:
dir _____lfms_soft_len_4/soft_gru4rec-len-30_11-27_19-08_t5/student_gru4rec_logs does not exist! Create one.
WARNING [11-27 19:08:26] get_exist_path in utils:
dir _____lfms_soft_len_4/soft_gru4rec-len-30_11-27_19-08_t5/student_gru4rec_logs/tb_vis does not exist! Create one.
WARNING [11-27 19:08:26] get_exist_path in utils:
dir _____lfms_soft_len_4/soft_gru4rec-len-30_11-27_19-08_t5/student_gru4rec_logs/checkpoint does not exist! Create one.
WARNING [11-27 19:08:26] get_path in utils:
Path is None
WARNING [11-27 19:08:26] load_state_from_given_path in utils:
Not given any path.
DEBUG   [11-27 19:08:26] __init__ in DistillSched:
student model: 
GRU4RecModel(
  (item_embedding): Embedding(3647, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.5, inplace=False)
  (gru_layers): GRU(64, 64, num_layers=2, bias=False, batch_first=True)
  (dense): Linear(in_features=64, out_features=64, bias=True)
  (loss_fct): CrossEntropyLoss()
)
INFO    [11-27 19:08:26] assert_model_device in utils:
model student_gru4rec has 1.09375 MB params.
INFO    [11-27 19:08:26] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [11-27 19:08:26] __init__ in DistillTrainer:
51200 iter per epoch
INFO    [11-27 19:08:26] _set_current_routine in Routine:
first routine: student
INFO    [11-27 19:08:26] run_routine in Routine:
Start routine student
INFO    [11-27 19:08:26] run_routine in Routine:
Start training
INFO    [11-27 19:08:26] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [11-27 19:08:27] test_mentor in DistillTrainer:
{'Recall@10': 0.03140085066358248, 'NDCG@10': 0.01530759378025929, 'MRR@10': 0.010382067101697126, 'Recall@5': 0.020539570599794388, 'NDCG@5': 0.011901913831631342, 'MRR@5': 0.009039157691101233, 'Recall*@10': 0.03140085066358248, 'NDCG*@10': 0.01530759378025929, 'MRR*@10': 0.010382067101697126, 'Recall*@5': 0.020539570599794388, 'NDCG*@5': 0.011901913831631342, 'MRR*@5': 0.009039157691101233}
INFO    [11-27 19:08:27] train in DistillTrainer:
result:
{'Recall@10': 0.03140085066358248, 'NDCG@10': 0.01530759378025929, 'MRR@10': 0.010382067101697126, 'Recall@5': 0.020539570599794388, 'NDCG@5': 0.011901913831631342, 'MRR@5': 0.009039157691101233, 'Recall*@10': 0.03140085066358248, 'NDCG*@10': 0.01530759378025929, 'MRR*@10': 0.010382067101697126, 'Recall*@5': 0.020539570599794388, 'NDCG*@5': 0.011901913831631342, 'MRR*@5': 0.009039157691101233}
INFO    [11-27 19:08:29] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [11-27 19:08:29] validate in BasicTrainer:
{'Recall@10': 0.001341780958076318, 'NDCG@10': 0.0006461152224801481, 'MRR@10': 0.0004525533489262064, 'Recall@5': 0.0003255208333333333, 'NDCG@5': 0.0003255208333333333, 'MRR@5': 0.0003255208333333333, 'Recall*@10': 0.001341780958076318, 'NDCG*@10': 0.0006461152224801481, 'MRR*@10': 0.0004525533489262064, 'Recall*@5': 0.0003255208333333333, 'NDCG*@5': 0.0003255208333333333, 'MRR*@5': 0.0003255208333333333}
INFO    [11-27 19:08:29] train in BasicTrainer:
epoch: 0
DEBUG   [11-27 19:08:29] calculate_loss in loss:
soft_target max: 0.5027085542678833, argmax 2083663
DEBUG   [11-27 19:08:29] calculate_loss in loss:
pred max in softmax: 0.00028812873642891645, argmax 8858
INFO    [11-27 19:08:32] _train_one_epoch in BasicTrainer:
loss = 5.730329351425171
INFO    [11-27 19:08:34] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [11-27 19:08:34] validate in BasicTrainer:
{'Recall@10': 0.023429560164610546, 'NDCG@10': 0.011392681238551935, 'MRR@10': 0.007841964407513538, 'Recall@5': 0.012163363707562288, 'NDCG@5': 0.007778995980819066, 'MRR@5': 0.006367108163734277, 'Recall*@10': 0.023429560164610546, 'NDCG*@10': 0.011392681238551935, 'MRR*@10': 0.007841964407513538, 'Recall*@5': 0.012163363707562288, 'NDCG*@5': 0.007778995980819066, 'MRR*@5': 0.006367108163734277}
INFO    [11-27 19:08:34] train in BasicTrainer:
duration: 5.404034376144409s
INFO    [11-27 19:08:34] train in BasicTrainer:
epoch: 1
INFO    [11-27 19:08:37] _train_one_epoch in BasicTrainer:
loss = 5.485564842224121
INFO    [11-27 19:08:39] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [11-27 19:08:39] validate in BasicTrainer:
{'Recall@10': 0.02603372683127721, 'NDCG@10': 0.012652171154816946, 'MRR@10': 0.008791645988821983, 'Recall@5': 0.010861280374228954, 'NDCG@5': 0.007783302882065375, 'MRR@5': 0.006803782346347968, 'Recall*@10': 0.02603372683127721, 'NDCG*@10': 0.012652171154816946, 'MRR*@10': 0.008791645988821983, 'Recall*@5': 0.010861280374228954, 'NDCG*@5': 0.007783302882065375, 'MRR*@5': 0.006803782346347968}
INFO    [11-27 19:08:39] train in BasicTrainer:
duration: 4.673272371292114s
INFO    [11-27 19:08:39] train in BasicTrainer:
epoch: 2
INFO    [11-27 19:08:42] _train_one_epoch in BasicTrainer:
loss = 5.4257599639892575
INFO    [11-27 19:08:43] validate in BasicTrainer:
{'Recall@10': 0.026684768497943878, 'NDCG@10': 0.011738241650164127, 'MRR@10': 0.00730155020331343, 'Recall@5': 0.01346544704089562, 'NDCG@5': 0.0075242236877481146, 'MRR@5': 0.005598826023439567, 'Recall*@10': 0.026684768497943878, 'NDCG*@10': 0.011738241650164127, 'MRR*@10': 0.00730155020331343, 'Recall*@5': 0.01346544704089562, 'NDCG*@5': 0.0075242236877481146, 'MRR*@5': 0.005598826023439567}
INFO    [11-27 19:08:43] train in BasicTrainer:
duration: 4.716853857040405s
INFO    [11-27 19:08:43] train in BasicTrainer:
epoch: 3
INFO    [11-27 19:08:46] _train_one_epoch in BasicTrainer:
loss = 5.38973690032959
INFO    [11-27 19:08:48] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [11-27 19:08:48] validate in BasicTrainer:
{'Recall@10': 0.029614455997943878, 'NDCG@10': 0.016817656345665455, 'MRR@10': 0.013026696008940538, 'Recall@5': 0.01806243633230527, 'NDCG@5': 0.013150312006473541, 'MRR@5': 0.011553871755798658, 'Recall*@10': 0.029614455997943878, 'NDCG*@10': 0.016817656345665455, 'MRR*@10': 0.013026696008940538, 'Recall*@5': 0.01806243633230527, 'NDCG*@5': 0.013150312006473541, 'MRR*@5': 0.011553871755798658}
INFO    [11-27 19:08:48] train in BasicTrainer:
duration: 4.663827180862427s
INFO    [11-27 19:08:48] train in BasicTrainer:
epoch: 4
INFO    [11-27 19:08:51] _train_one_epoch in BasicTrainer:
loss = 5.331279296875
INFO    [11-27 19:08:53] validate in BasicTrainer:
{'Recall@10': 0.0320598321656386, 'NDCG@10': 0.014927369697640339, 'MRR@10': 0.009794235927984118, 'Recall@5': 0.018999301207562286, 'NDCG@5': 0.010816087014973164, 'MRR@5': 0.008162898166726032, 'Recall*@10': 0.0320598321656386, 'NDCG*@10': 0.014927369697640339, 'MRR*@10': 0.009794235927984118, 'Recall*@5': 0.018999301207562286, 'NDCG*@5': 0.010816087014973164, 'MRR*@5': 0.008162898166726032}
INFO    [11-27 19:08:53] train in BasicTrainer:
duration: 4.8386969566345215s
INFO    [11-27 19:08:53] train in BasicTrainer:
epoch: 5
INFO    [11-27 19:08:56] _train_one_epoch in BasicTrainer:
loss = 5.241210241317749
INFO    [11-27 19:08:58] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [11-27 19:08:58] validate in BasicTrainer:
{'Recall@10': 0.05467162032922109, 'NDCG@10': 0.024069133525093395, 'MRR@10': 0.014999144400159517, 'Recall@5': 0.02855849824845791, 'NDCG@5': 0.015812466231485207, 'MRR@5': 0.01169651901970307, 'Recall*@10': 0.05467162032922109, 'NDCG*@10': 0.024069133525093395, 'MRR*@10': 0.014999144400159517, 'Recall*@5': 0.02855849824845791, 'NDCG*@5': 0.015812466231485207, 'MRR*@5': 0.01169651901970307}
INFO    [11-27 19:08:58] train in BasicTrainer:
duration: 4.796388864517212s
INFO    [11-27 19:08:58] train in BasicTrainer:
epoch: 6
INFO    [11-27 19:09:01] _train_one_epoch in BasicTrainer:
loss = 5.168976716995239
INFO    [11-27 19:09:03] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [11-27 19:09:03] validate in BasicTrainer:
{'Recall@10': 0.06097560872634252, 'NDCG@10': 0.029704225560029347, 'MRR@10': 0.020364586884776752, 'Recall@5': 0.03417174766461054, 'NDCG@5': 0.021135367453098297, 'MRR@5': 0.016887253460784752, 'Recall*@10': 0.06097560872634252, 'NDCG*@10': 0.029704225560029347, 'MRR*@10': 0.020364586884776752, 'Recall*@5': 0.03417174766461054, 'NDCG*@5': 0.021135367453098297, 'MRR*@5': 0.016887253460784752}
INFO    [11-27 19:09:03] train in BasicTrainer:
duration: 4.867283821105957s
INFO    [11-27 19:09:03] train in BasicTrainer:
epoch: 7
INFO    [11-27 19:09:06] _train_one_epoch in BasicTrainer:
loss = 5.119937715530395
INFO    [11-27 19:09:07] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [11-27 19:09:07] validate in BasicTrainer:
{'Recall@10': 0.0642705149948597, 'NDCG@10': 0.03187072463333607, 'MRR@10': 0.022103834276398022, 'Recall@5': 0.03791126733024915, 'NDCG@5': 0.023372051616509754, 'MRR@5': 0.018611190219720204, 'Recall*@10': 0.0642705149948597, 'NDCG*@10': 0.03187072463333607, 'MRR*@10': 0.022103834276398022, 'Recall*@5': 0.03791126733024915, 'NDCG*@5': 0.023372051616509754, 'MRR*@5': 0.018611190219720204}
INFO    [11-27 19:09:07] train in BasicTrainer:
duration: 4.683396816253662s
INFO    [11-27 19:09:07] train in BasicTrainer:
epoch: 8
INFO    [11-27 19:09:11] _train_one_epoch in BasicTrainer:
loss = 5.075827512741089
INFO    [11-27 19:09:12] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [11-27 19:09:12] validate in BasicTrainer:
{'Recall@10': 0.06695407629013062, 'NDCG@10': 0.035201999048391976, 'MRR@10': 0.025638847922285397, 'Recall@5': 0.0418969119588534, 'NDCG@5': 0.027116286257902782, 'MRR@5': 0.022314189622799557, 'Recall*@10': 0.06695407629013062, 'NDCG*@10': 0.035201999048391976, 'MRR*@10': 0.025638847922285397, 'Recall*@5': 0.0418969119588534, 'NDCG*@5': 0.027116286257902782, 'MRR*@5': 0.022314189622799557}
INFO    [11-27 19:09:12] train in BasicTrainer:
duration: 4.901584148406982s
INFO    [11-27 19:09:12] train in BasicTrainer:
epoch: 9
INFO    [11-27 19:09:15] _train_one_epoch in BasicTrainer:
loss = 5.033385572433471
INFO    [11-27 19:09:17] validate in BasicTrainer:
{'Recall@10': 0.0698440670967102, 'NDCG@10': 0.034592067201932274, 'MRR@10': 0.023954156165321667, 'Recall@5': 0.04153169443209966, 'NDCG@5': 0.02547752484679222, 'MRR@5': 0.02021378589173158, 'Recall*@10': 0.0698440670967102, 'NDCG*@10': 0.034592067201932274, 'MRR*@10': 0.023954156165321667, 'Recall*@5': 0.04153169443209966, 'NDCG*@5': 0.02547752484679222, 'MRR*@5': 0.02021378589173158}
INFO    [11-27 19:09:17] train in BasicTrainer:
duration: 4.727043390274048s
INFO    [11-27 19:09:17] train in BasicTrainer:
epoch: 10
INFO    [11-27 19:09:20] _train_one_epoch in BasicTrainer:
loss = 4.988507070541382
INFO    [11-27 19:09:22] log in loggers:
Update Best NDCG@10 Model at 10
INFO    [11-27 19:09:22] validate in BasicTrainer:
{'Recall@10': 0.07342479626337688, 'NDCG@10': 0.036283756916721664, 'MRR@10': 0.02526697392265002, 'Recall@5': 0.04133320599794388, 'NDCG@5': 0.026174213116367657, 'MRR@5': 0.021251217772563297, 'Recall*@10': 0.07342479626337688, 'NDCG*@10': 0.036283756916721664, 'MRR*@10': 0.02526697392265002, 'Recall*@5': 0.04133320599794388, 'NDCG*@5': 0.026174213116367657, 'MRR*@5': 0.021251217772563297}
INFO    [11-27 19:09:22] train in BasicTrainer:
duration: 5.027437686920166s
INFO    [11-27 19:09:22] train in BasicTrainer:
epoch: 11
INFO    [11-27 19:09:25] _train_one_epoch in BasicTrainer:
loss = 4.9376462459564205
INFO    [11-27 19:09:27] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [11-27 19:09:27] validate in BasicTrainer:
{'Recall@10': 0.07407583793004353, 'NDCG@10': 0.03668073068062464, 'MRR@10': 0.025554198150833447, 'Recall@5': 0.04043603874742985, 'NDCG@5': 0.025842471048235893, 'MRR@5': 0.02110341005027294, 'Recall*@10': 0.07407583793004353, 'NDCG*@10': 0.03668073068062464, 'MRR*@10': 0.025554198150833447, 'Recall*@5': 0.04043603874742985, 'NDCG*@5': 0.025842471048235893, 'MRR*@5': 0.02110341005027294}
INFO    [11-27 19:09:27] train in BasicTrainer:
duration: 4.976133823394775s
INFO    [11-27 19:09:27] train in BasicTrainer:
epoch: 12
INFO    [11-27 19:09:30] _train_one_epoch in BasicTrainer:
loss = 4.882021026611328
INFO    [11-27 19:09:32] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [11-27 19:09:32] validate in BasicTrainer:
{'Recall@10': 0.08294429630041122, 'NDCG@10': 0.04232905929287275, 'MRR@10': 0.030073387548327446, 'Recall@5': 0.05154344439506531, 'NDCG@5': 0.03202319766084353, 'MRR@5': 0.0257346723228693, 'Recall*@10': 0.08294429630041122, 'NDCG*@10': 0.04232905929287275, 'MRR*@10': 0.030073387548327446, 'Recall*@5': 0.05154344439506531, 'NDCG*@5': 0.03202319766084353, 'MRR*@5': 0.0257346723228693}
INFO    [11-27 19:09:32] train in BasicTrainer:
duration: 4.840749263763428s
INFO    [11-27 19:09:32] train in BasicTrainer:
epoch: 13
INFO    [11-27 19:09:35] _train_one_epoch in BasicTrainer:
loss = 4.827152357101441
INFO    [11-27 19:09:37] validate in BasicTrainer:
{'Recall@10': 0.08591368049383163, 'NDCG@10': 0.042269059146444, 'MRR@10': 0.029105146105090778, 'Recall@5': 0.04987614291409651, 'NDCG@5': 0.03068185659746329, 'MRR@5': 0.024361264581481617, 'Recall*@10': 0.08591368049383163, 'NDCG*@10': 0.042269059146444, 'MRR*@10': 0.029105146105090778, 'Recall*@5': 0.04987614291409651, 'NDCG*@5': 0.03068185659746329, 'MRR*@5': 0.024361264581481617}
INFO    [11-27 19:09:37] train in BasicTrainer:
duration: 4.863389253616333s
INFO    [11-27 19:09:37] train in BasicTrainer:
epoch: 14
INFO    [11-27 19:09:40] _train_one_epoch in BasicTrainer:
loss = 4.7771733951568605
INFO    [11-27 19:09:41] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [11-27 19:09:42] validate in BasicTrainer:
{'Recall@10': 0.0936388447880745, 'NDCG@10': 0.04609702403346697, 'MRR@10': 0.03184741549193859, 'Recall@5': 0.05756160989403725, 'NDCG@5': 0.034723990907271705, 'MRR@5': 0.02732549048960209, 'Recall*@10': 0.0936388447880745, 'NDCG*@10': 0.04609702403346697, 'MRR*@10': 0.03184741549193859, 'Recall*@5': 0.05756160989403725, 'NDCG*@5': 0.034723990907271705, 'MRR*@5': 0.02732549048960209}
INFO    [11-27 19:09:42] train in BasicTrainer:
duration: 4.844820499420166s
INFO    [11-27 19:09:42] train in BasicTrainer:
epoch: 15
INFO    [11-27 19:09:45] _train_one_epoch in BasicTrainer:
loss = 4.735265922546387
INFO    [11-27 19:09:46] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [11-27 19:09:46] validate in BasicTrainer:
{'Recall@10': 0.09677496055761974, 'NDCG@10': 0.04837219292918841, 'MRR@10': 0.03388994621733824, 'Recall@5': 0.05390148609876633, 'NDCG@5': 0.034485429525375366, 'MRR@5': 0.028142334893345833, 'Recall*@10': 0.09677496055761974, 'NDCG*@10': 0.04837219292918841, 'MRR*@10': 0.03388994621733824, 'Recall*@5': 0.05390148609876633, 'NDCG*@5': 0.034485429525375366, 'MRR*@5': 0.028142334893345833}
INFO    [11-27 19:09:46] train in BasicTrainer:
duration: 4.964730262756348s
INFO    [11-27 19:09:46] train in BasicTrainer:
epoch: 16
INFO    [11-27 19:09:50] _train_one_epoch in BasicTrainer:
loss = 4.699483633041382
INFO    [11-27 19:09:51] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [11-27 19:09:51] validate in BasicTrainer:
{'Recall@10': 0.09933943053086598, 'NDCG@10': 0.05143432319164276, 'MRR@10': 0.03689385515948137, 'Recall@5': 0.06744632869958878, 'NDCG@5': 0.0414006399611632, 'MRR@5': 0.03291703760623932, 'Recall*@10': 0.09933943053086598, 'NDCG*@10': 0.05143432319164276, 'MRR*@10': 0.03689385515948137, 'Recall*@5': 0.06744632869958878, 'NDCG*@5': 0.0414006399611632, 'MRR*@5': 0.03291703760623932}
INFO    [11-27 19:09:51] train in BasicTrainer:
duration: 4.881301403045654s
INFO    [11-27 19:09:51] train in BasicTrainer:
epoch: 17
INFO    [11-27 19:09:55] _train_one_epoch in BasicTrainer:
loss = 4.65697639465332
INFO    [11-27 19:09:56] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [11-27 19:09:56] validate in BasicTrainer:
{'Recall@10': 0.11532170822223027, 'NDCG@10': 0.057112070421377815, 'MRR@10': 0.03964631880323092, 'Recall@5': 0.06846258789300919, 'NDCG@5': 0.042222789178291954, 'MRR@5': 0.03365448738137881, 'Recall*@10': 0.11532170822223027, 'NDCG*@10': 0.057112070421377815, 'MRR*@10': 0.03964631880323092, 'Recall*@5': 0.06846258789300919, 'NDCG*@5': 0.042222789178291954, 'MRR*@5': 0.03365448738137881}
INFO    [11-27 19:09:56] train in BasicTrainer:
duration: 4.889177083969116s
INFO    [11-27 19:09:56] train in BasicTrainer:
epoch: 18
INFO    [11-27 19:10:00] _train_one_epoch in BasicTrainer:
loss = 4.623651704788208
INFO    [11-27 19:10:01] validate in BasicTrainer:
{'Recall@10': 0.11125666896502177, 'NDCG@10': 0.056727913518746696, 'MRR@10': 0.04038811847567558, 'Recall@5': 0.06443724532922109, 'NDCG@5': 0.0416875866552194, 'MRR@5': 0.034240953624248505, 'Recall*@10': 0.11125666896502177, 'NDCG*@10': 0.056727913518746696, 'MRR*@10': 0.04038811847567558, 'Recall*@5': 0.06443724532922109, 'NDCG*@5': 0.0416875866552194, 'MRR*@5': 0.034240953624248505}
INFO    [11-27 19:10:01] train in BasicTrainer:
duration: 4.8686652183532715s
INFO    [11-27 19:10:01] train in BasicTrainer:
epoch: 19
DEBUG   [11-27 19:10:04] calculate_loss in loss:
soft_target max: 0.5027085542678833, argmax 81460
DEBUG   [11-27 19:10:04] calculate_loss in loss:
pred max in softmax: 0.08248995989561081, argmax 1407560
INFO    [11-27 19:10:04] _train_one_epoch in BasicTrainer:
loss = 4.590046281814575
INFO    [11-27 19:10:06] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [11-27 19:10:06] validate in BasicTrainer:
{'Recall@10': 0.1136544073621432, 'NDCG@10': 0.057206654300292335, 'MRR@10': 0.040276672691106796, 'Recall@5': 0.06516768286625545, 'NDCG@5': 0.0415660726527373, 'MRR@5': 0.03384053707122803, 'Recall*@10': 0.1136544073621432, 'NDCG*@10': 0.057206654300292335, 'MRR*@10': 0.040276672691106796, 'Recall*@5': 0.06516768286625545, 'NDCG*@5': 0.0415660726527373, 'MRR*@5': 0.03384053707122803}
INFO    [11-27 19:10:06] train in BasicTrainer:
duration: 5.012839078903198s
INFO    [11-27 19:10:06] train in BasicTrainer:
epoch: 20
DEBUG   [11-27 19:10:07] calculate_loss in loss:
soft_target max: 0.5027085542678833, argmax 1452732
DEBUG   [11-27 19:10:07] calculate_loss in loss:
pred max in softmax: 0.06078139692544937, argmax 2428720
INFO    [11-27 19:10:09] _train_one_epoch in BasicTrainer:
loss = 4.5619502353668215
INFO    [11-27 19:10:11] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [11-27 19:10:11] validate in BasicTrainer:
{'Recall@10': 0.1125587522983551, 'NDCG@10': 0.059675085047880806, 'MRR@10': 0.0437144028643767, 'Recall@5': 0.07106675455967586, 'NDCG@5': 0.046305821587642036, 'MRR@5': 0.03822540926436583, 'Recall*@10': 0.1125587522983551, 'NDCG*@10': 0.059675085047880806, 'MRR*@10': 0.0437144028643767, 'Recall*@5': 0.07106675455967586, 'NDCG*@5': 0.046305821587642036, 'MRR*@5': 0.03822540926436583}
INFO    [11-27 19:10:11] train in BasicTrainer:
duration: 4.932943344116211s
INFO    [11-27 19:10:11] train in BasicTrainer:
epoch: 21
INFO    [11-27 19:10:14] _train_one_epoch in BasicTrainer:
loss = 4.537311649322509
INFO    [11-27 19:10:16] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [11-27 19:10:16] validate in BasicTrainer:
{'Recall@10': 0.1191485623518626, 'NDCG@10': 0.06129071116447449, 'MRR@10': 0.04382554938395818, 'Recall@5': 0.07240853582819302, 'NDCG@5': 0.0462461585799853, 'MRR@5': 0.03765561245381832, 'Recall*@10': 0.1191485623518626, 'NDCG*@10': 0.06129071116447449, 'MRR*@10': 0.04382554938395818, 'Recall*@5': 0.07240853582819302, 'NDCG*@5': 0.0462461585799853, 'MRR*@5': 0.03765561245381832}
INFO    [11-27 19:10:16] train in BasicTrainer:
duration: 4.927520990371704s
INFO    [11-27 19:10:16] train in BasicTrainer:
epoch: 22
INFO    [11-27 19:10:19] _train_one_epoch in BasicTrainer:
loss = 4.510117416381836
INFO    [11-27 19:10:21] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [11-27 19:10:21] validate in BasicTrainer:
{'Recall@10': 0.12480151156584422, 'NDCG@10': 0.06417059774200122, 'MRR@10': 0.046073740969101586, 'Recall@5': 0.0716780995329221, 'NDCG@5': 0.04703710973262787, 'MRR@5': 0.039031932751337685, 'Recall*@10': 0.12480151156584422, 'NDCG*@10': 0.06417059774200122, 'MRR*@10': 0.046073740969101586, 'Recall*@5': 0.0716780995329221, 'NDCG*@5': 0.04703710973262787, 'MRR*@5': 0.039031932751337685}
INFO    [11-27 19:10:21] train in BasicTrainer:
duration: 5.0444371700286865s
INFO    [11-27 19:10:21] train in BasicTrainer:
epoch: 23
INFO    [11-27 19:10:24] _train_one_epoch in BasicTrainer:
loss = 4.487457103729248
INFO    [11-27 19:10:26] validate in BasicTrainer:
{'Recall@10': 0.12508733322223028, 'NDCG@10': 0.06335857634743054, 'MRR@10': 0.044803945968548455, 'Recall@5': 0.07769626379013062, 'NDCG@5': 0.04817260801792145, 'MRR@5': 0.0386184174567461, 'Recall*@10': 0.12508733322223028, 'NDCG*@10': 0.06335857634743054, 'MRR*@10': 0.044803945968548455, 'Recall*@5': 0.07769626379013062, 'NDCG*@5': 0.04817260801792145, 'MRR*@5': 0.0386184174567461}
INFO    [11-27 19:10:26] train in BasicTrainer:
duration: 4.879579305648804s
INFO    [11-27 19:10:26] train in BasicTrainer:
epoch: 24
INFO    [11-27 19:10:29] _train_one_epoch in BasicTrainer:
loss = 4.466651401519775
INFO    [11-27 19:10:31] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [11-27 19:10:31] validate in BasicTrainer:
{'Recall@10': 0.12748507161935171, 'NDCG@10': 0.06518649682402611, 'MRR@10': 0.04635092740257581, 'Recall@5': 0.07733104626337688, 'NDCG@5': 0.04901575669646263, 'MRR@5': 0.039706528186798096, 'Recall*@10': 0.12748507161935171, 'NDCG*@10': 0.06518649682402611, 'MRR*@10': 0.04635092740257581, 'Recall*@5': 0.07733104626337688, 'NDCG*@5': 0.04901575669646263, 'MRR*@5': 0.039706528186798096}
INFO    [11-27 19:10:31] train in BasicTrainer:
duration: 5.101199626922607s
INFO    [11-27 19:10:31] train in BasicTrainer:
epoch: 25
INFO    [11-27 19:10:34] _train_one_epoch in BasicTrainer:
loss = 4.447641201019287
INFO    [11-27 19:10:36] validate in BasicTrainer:
{'Recall@10': 0.1254922499259313, 'NDCG@10': 0.06390006219347318, 'MRR@10': 0.04533521210153898, 'Recall@5': 0.07704522212346394, 'NDCG@5': 0.04811930904785792, 'MRR@5': 0.03875563790400823, 'Recall*@10': 0.1254922499259313, 'NDCG*@10': 0.06390006219347318, 'MRR*@10': 0.04533521210153898, 'Recall*@5': 0.07704522212346394, 'NDCG*@5': 0.04811930904785792, 'MRR*@5': 0.03875563790400823}
INFO    [11-27 19:10:36] train in BasicTrainer:
duration: 4.950124979019165s
INFO    [11-27 19:10:36] train in BasicTrainer:
epoch: 26
INFO    [11-27 19:10:39] _train_one_epoch in BasicTrainer:
loss = 4.426456117630005
INFO    [11-27 19:10:41] validate in BasicTrainer:
{'Recall@10': 0.1274056782325109, 'NDCG@10': 0.065060509989659, 'MRR@10': 0.046187633027633034, 'Recall@5': 0.08131669213374455, 'NDCG@5': 0.05015146608153979, 'MRR@5': 0.04002913708488146, 'Recall*@10': 0.1274056782325109, 'NDCG*@10': 0.065060509989659, 'MRR*@10': 0.046187633027633034, 'Recall*@5': 0.08131669213374455, 'NDCG*@5': 0.05015146608153979, 'MRR*@5': 0.04002913708488146}
INFO    [11-27 19:10:41] train in BasicTrainer:
duration: 4.786066770553589s
INFO    [11-27 19:10:41] train in BasicTrainer:
epoch: 27
INFO    [11-27 19:10:44] _train_one_epoch in BasicTrainer:
loss = 4.404521532058716
INFO    [11-27 19:10:46] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [11-27 19:10:46] validate in BasicTrainer:
{'Recall@10': 0.13468622912963232, 'NDCG@10': 0.06762595723072688, 'MRR@10': 0.0475157896677653, 'Recall@5': 0.07452839116255443, 'NDCG@5': 0.04807284101843834, 'MRR@5': 0.03939212548236052, 'Recall*@10': 0.13468622912963232, 'NDCG*@10': 0.06762595723072688, 'MRR*@10': 0.0475157896677653, 'Recall*@5': 0.07452839116255443, 'NDCG*@5': 0.04807284101843834, 'MRR*@5': 0.03939212548236052}
INFO    [11-27 19:10:46] train in BasicTrainer:
duration: 5.101309299468994s
INFO    [11-27 19:10:46] train in BasicTrainer:
epoch: 28
INFO    [11-27 19:10:49] _train_one_epoch in BasicTrainer:
loss = 4.387491140365601
INFO    [11-27 19:10:51] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [11-27 19:10:51] validate in BasicTrainer:
{'Recall@10': 0.13798113415638605, 'NDCG@10': 0.06907402724027634, 'MRR@10': 0.04849266757567724, 'Recall@5': 0.07790269205967586, 'NDCG@5': 0.049768744657437004, 'MRR@5': 0.04059866691629092, 'Recall*@10': 0.13798113415638605, 'NDCG*@10': 0.06907402724027634, 'MRR*@10': 0.04849266757567724, 'Recall*@5': 0.07790269205967586, 'NDCG*@5': 0.049768744657437004, 'MRR*@5': 0.04059866691629092}
INFO    [11-27 19:10:51] train in BasicTrainer:
duration: 5.02207612991333s
INFO    [11-27 19:10:51] train in BasicTrainer:
epoch: 29
INFO    [11-27 19:10:54] _train_one_epoch in BasicTrainer:
loss = 4.371562337875366
INFO    [11-27 19:10:56] validate in BasicTrainer:
{'Recall@10': 0.1293588032325109, 'NDCG@10': 0.06640622392296791, 'MRR@10': 0.04757716382543246, 'Recall@5': 0.07452839116255443, 'NDCG@5': 0.048593622942765556, 'MRR@5': 0.04017932899296284, 'Recall*@10': 0.1293588032325109, 'NDCG*@10': 0.06640622392296791, 'MRR*@10': 0.04757716382543246, 'Recall*@5': 0.07452839116255443, 'NDCG*@5': 0.048593622942765556, 'MRR*@5': 0.04017932899296284}
INFO    [11-27 19:10:56] train in BasicTrainer:
duration: 4.892633676528931s
INFO    [11-27 19:10:56] train in BasicTrainer:
epoch: 30
INFO    [11-27 19:10:59] _train_one_epoch in BasicTrainer:
loss = 4.348736724853516
INFO    [11-27 19:11:01] validate in BasicTrainer:
{'Recall@10': 0.13436070829629898, 'NDCG@10': 0.06788815557956696, 'MRR@10': 0.048035857578118644, 'Recall@5': 0.07660060872634251, 'NDCG@5': 0.04929529130458832, 'MRR@5': 0.04040851630270481, 'Recall*@10': 0.13436070829629898, 'NDCG*@10': 0.06788815557956696, 'MRR*@10': 0.048035857578118644, 'Recall*@5': 0.07660060872634251, 'NDCG*@5': 0.04929529130458832, 'MRR*@5': 0.04040851630270481}
INFO    [11-27 19:11:01] train in BasicTrainer:
duration: 4.938406944274902s
INFO    [11-27 19:11:01] train in BasicTrainer:
epoch: 31
INFO    [11-27 19:11:04] _train_one_epoch in BasicTrainer:
loss = 4.3344309425354
INFO    [11-27 19:11:06] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [11-27 19:11:06] validate in BasicTrainer:
{'Recall@10': 0.13667905082305273, 'NDCG@10': 0.07080357149243355, 'MRR@10': 0.051082863161961235, 'Recall@5': 0.08213446289300919, 'NDCG@5': 0.05334964022040367, 'MRR@5': 0.0439914936820666, 'Recall*@10': 0.13667905082305273, 'NDCG*@10': 0.07080357149243355, 'MRR*@10': 0.051082863161961235, 'Recall*@5': 0.08213446289300919, 'NDCG*@5': 0.05334964022040367, 'MRR*@5': 0.0439914936820666}
INFO    [11-27 19:11:06] train in BasicTrainer:
duration: 5.563421964645386s
INFO    [11-27 19:11:06] train in BasicTrainer:
epoch: 32
INFO    [11-27 19:11:10] _train_one_epoch in BasicTrainer:
loss = 4.317395229339599
INFO    [11-27 19:11:11] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [11-27 19:11:11] validate in BasicTrainer:
{'Recall@10': 0.14160156001647314, 'NDCG@10': 0.07218446334203084, 'MRR@10': 0.05141690125068029, 'Recall@5': 0.08079268286625545, 'NDCG@5': 0.05270964900652567, 'MRR@5': 0.043489584078391395, 'Recall*@10': 0.14160156001647314, 'NDCG*@10': 0.07218446334203084, 'MRR*@10': 0.05141690125068029, 'Recall*@5': 0.08079268286625545, 'NDCG*@5': 0.05270964900652567, 'MRR*@5': 0.043489584078391395}
INFO    [11-27 19:11:11] train in BasicTrainer:
duration: 4.9220967292785645s
INFO    [11-27 19:11:11] train in BasicTrainer:
epoch: 33
INFO    [11-27 19:11:15] _train_one_epoch in BasicTrainer:
loss = 4.298462009429931
INFO    [11-27 19:11:17] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [11-27 19:11:17] validate in BasicTrainer:
{'Recall@10': 0.1435943841934204, 'NDCG@10': 0.0728681484858195, 'MRR@10': 0.05177819232145945, 'Recall@5': 0.07912538076440494, 'NDCG@5': 0.052132200449705124, 'MRR@5': 0.043287125105659165, 'Recall*@10': 0.1435943841934204, 'NDCG*@10': 0.0728681484858195, 'MRR*@10': 0.05177819232145945, 'Recall*@5': 0.07912538076440494, 'NDCG*@5': 0.052132200449705124, 'MRR*@5': 0.043287125105659165}
INFO    [11-27 19:11:17] train in BasicTrainer:
duration: 5.614401578903198s
INFO    [11-27 19:11:17] train in BasicTrainer:
epoch: 34
INFO    [11-27 19:11:20] _train_one_epoch in BasicTrainer:
loss = 4.282749109268188
INFO    [11-27 19:11:21] validate in BasicTrainer:
{'Recall@10': 0.1422129049897194, 'NDCG@10': 0.07262847448388736, 'MRR@10': 0.05179873978098234, 'Recall@5': 0.08485772212346394, 'NDCG@5': 0.05420843760172526, 'MRR@5': 0.044273084650437035, 'Recall*@10': 0.1422129049897194, 'NDCG*@10': 0.07262847448388736, 'MRR*@10': 0.05179873978098234, 'Recall*@5': 0.08485772212346394, 'NDCG*@5': 0.05420843760172526, 'MRR*@5': 0.044273084650437035}
INFO    [11-27 19:11:21] train in BasicTrainer:
duration: 4.653838872909546s
INFO    [11-27 19:11:21] train in BasicTrainer:
epoch: 35
INFO    [11-27 19:11:25] _train_one_epoch in BasicTrainer:
loss = 4.267729425430298
INFO    [11-27 19:11:27] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [11-27 19:11:27] validate in BasicTrainer:
{'Recall@10': 0.14388020584980646, 'NDCG@10': 0.0731543352206548, 'MRR@10': 0.05185409511129061, 'Recall@5': 0.08746188879013062, 'NDCG@5': 0.05504994094371796, 'MRR@5': 0.04446257402499517, 'Recall*@10': 0.14388020584980646, 'NDCG*@10': 0.0731543352206548, 'MRR*@10': 0.05185409511129061, 'Recall*@5': 0.08746188879013062, 'NDCG*@5': 0.05504994094371796, 'MRR*@5': 0.04446257402499517}
INFO    [11-27 19:11:27] train in BasicTrainer:
duration: 5.173722982406616s
INFO    [11-27 19:11:27] train in BasicTrainer:
epoch: 36
INFO    [11-27 19:11:30] _train_one_epoch in BasicTrainer:
loss = 4.2508323192596436
INFO    [11-27 19:11:32] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [11-27 19:11:32] validate in BasicTrainer:
{'Recall@10': 0.14688928922017416, 'NDCG@10': 0.07387232780456543, 'MRR@10': 0.051987635592619576, 'Recall@5': 0.0844925045967102, 'NDCG@5': 0.05368133261799812, 'MRR@5': 0.043640567610661186, 'Recall*@10': 0.14688928922017416, 'NDCG*@10': 0.07387232780456543, 'MRR*@10': 0.051987635592619576, 'Recall*@5': 0.0844925045967102, 'NDCG*@5': 0.05368133261799812, 'MRR*@5': 0.043640567610661186}
INFO    [11-27 19:11:32] train in BasicTrainer:
duration: 5.309611558914185s
INFO    [11-27 19:11:32] train in BasicTrainer:
epoch: 37
INFO    [11-27 19:11:36] _train_one_epoch in BasicTrainer:
loss = 4.232915658950805
INFO    [11-27 19:11:37] log in loggers:
Update Best NDCG@10 Model at 37
INFO    [11-27 19:11:37] validate in BasicTrainer:
{'Recall@10': 0.15343940258026123, 'NDCG@10': 0.07853679607311885, 'MRR@10': 0.05607546617587408, 'Recall@5': 0.09278931468725204, 'NDCG@5': 0.0590813954671224, 'MRR@5': 0.04813645904262861, 'Recall*@10': 0.15343940258026123, 'NDCG*@10': 0.07853679607311885, 'MRR*@10': 0.05607546617587408, 'Recall*@5': 0.09278931468725204, 'NDCG*@5': 0.0590813954671224, 'MRR*@5': 0.04813645904262861}
INFO    [11-27 19:11:37] train in BasicTrainer:
duration: 5.319615840911865s
INFO    [11-27 19:11:37] train in BasicTrainer:
epoch: 38
INFO    [11-27 19:11:41] _train_one_epoch in BasicTrainer:
loss = 4.219403495788574
INFO    [11-27 19:11:42] validate in BasicTrainer:
{'Recall@10': 0.14815167586008707, 'NDCG@10': 0.07610624035199483, 'MRR@10': 0.05430499340097109, 'Recall@5': 0.09315453469753265, 'NDCG@5': 0.05835162475705147, 'MRR@5': 0.04699382930994034, 'Recall*@10': 0.14815167586008707, 'NDCG*@10': 0.07610624035199483, 'MRR*@10': 0.05430499340097109, 'Recall*@5': 0.09315453469753265, 'NDCG*@5': 0.05835162475705147, 'MRR*@5': 0.04699382930994034}
INFO    [11-27 19:11:42] train in BasicTrainer:
duration: 5.10234522819519s
INFO    [11-27 19:11:42] train in BasicTrainer:
epoch: 39
DEBUG   [11-27 19:11:46] calculate_loss in loss:
soft_target max: 0.5027085542678833, argmax 887447
DEBUG   [11-27 19:11:46] calculate_loss in loss:
pred max in softmax: 0.1045696809887886, argmax 1690774
INFO    [11-27 19:11:46] _train_one_epoch in BasicTrainer:
loss = 4.203584880828857
INFO    [11-27 19:11:47] validate in BasicTrainer:
{'Recall@10': 0.14782615502675375, 'NDCG@10': 0.0766600991288821, 'MRR@10': 0.055119012792905174, 'Recall@5': 0.09311483552058537, 'NDCG@5': 0.05909574901064237, 'MRR@5': 0.04794538393616676, 'Recall*@10': 0.14782615502675375, 'NDCG*@10': 0.0766600991288821, 'MRR*@10': 0.055119012792905174, 'Recall*@5': 0.09311483552058537, 'NDCG*@5': 0.05909574901064237, 'MRR*@5': 0.04794538393616676}
INFO    [11-27 19:11:47] train in BasicTrainer:
duration: 4.946825981140137s
INFO    [11-27 19:11:47] train in BasicTrainer:
epoch: 40
DEBUG   [11-27 19:11:48] calculate_loss in loss:
soft_target max: 0.5027085542678833, argmax 238281
DEBUG   [11-27 19:11:48] calculate_loss in loss:
pred max in softmax: 0.0997515544295311, argmax 601573
INFO    [11-27 19:11:51] _train_one_epoch in BasicTrainer:
loss = 4.185396137237549
INFO    [11-27 19:11:52] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [11-27 19:11:52] validate in BasicTrainer:
{'Recall@10': 0.15445566177368164, 'NDCG@10': 0.08127552767594655, 'MRR@10': 0.05911358570059141, 'Recall@5': 0.09771182636419933, 'NDCG@5': 0.0629020556807518, 'MRR@5': 0.05151023343205452, 'Recall*@10': 0.15445566177368164, 'NDCG*@10': 0.08127552767594655, 'MRR*@10': 0.05911358570059141, 'Recall*@5': 0.09771182636419933, 'NDCG*@5': 0.0629020556807518, 'MRR*@5': 0.05151023343205452}
INFO    [11-27 19:11:52] train in BasicTrainer:
duration: 5.143568515777588s
INFO    [11-27 19:11:52] train in BasicTrainer:
epoch: 41
INFO    [11-27 19:11:55] _train_one_epoch in BasicTrainer:
loss = 4.170918264389038
INFO    [11-27 19:11:57] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [11-27 19:11:57] validate in BasicTrainer:
{'Recall@10': 0.1567740092674891, 'NDCG@10': 0.08146602163712184, 'MRR@10': 0.058761650075515114, 'Recall@5': 0.09644943972428639, 'NDCG@5': 0.06200595200061798, 'MRR@5': 0.050751479963461556, 'Recall*@10': 0.1567740092674891, 'NDCG*@10': 0.08146602163712184, 'MRR*@10': 0.058761650075515114, 'Recall*@5': 0.09644943972428639, 'NDCG*@5': 0.06200595200061798, 'MRR*@5': 0.050751479963461556}
INFO    [11-27 19:11:57] train in BasicTrainer:
duration: 4.609091281890869s
INFO    [11-27 19:11:57] train in BasicTrainer:
epoch: 42
INFO    [11-27 19:12:00] _train_one_epoch in BasicTrainer:
loss = 4.156392650604248
INFO    [11-27 19:12:02] validate in BasicTrainer:
{'Recall@10': 0.1531138817469279, 'NDCG@10': 0.08102747301260631, 'MRR@10': 0.05925240864356359, 'Recall@5': 0.0953140879670779, 'NDCG@5': 0.062444974978764854, 'MRR@5': 0.051649571706851326, 'Recall*@10': 0.1531138817469279, 'NDCG*@10': 0.08102747301260631, 'MRR*@10': 0.05925240864356359, 'Recall*@5': 0.0953140879670779, 'NDCG*@5': 0.062444974978764854, 'MRR*@5': 0.051649571706851326}
INFO    [11-27 19:12:02] train in BasicTrainer:
duration: 4.875692129135132s
INFO    [11-27 19:12:02] train in BasicTrainer:
epoch: 43
INFO    [11-27 19:12:05] _train_one_epoch in BasicTrainer:
loss = 4.141496362686158
INFO    [11-27 19:12:07] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [11-27 19:12:07] validate in BasicTrainer:
{'Recall@10': 0.1521373192469279, 'NDCG@10': 0.08234856526056926, 'MRR@10': 0.06122796858350436, 'Recall@5': 0.09799764802058537, 'NDCG@5': 0.06498820583025615, 'MRR@5': 0.05414880191286405, 'Recall*@10': 0.1521373192469279, 'NDCG*@10': 0.08234856526056926, 'MRR*@10': 0.06122796858350436, 'Recall*@5': 0.09799764802058537, 'NDCG*@5': 0.06498820583025615, 'MRR*@5': 0.05414880191286405}
INFO    [11-27 19:12:07] train in BasicTrainer:
duration: 4.997859477996826s
INFO    [11-27 19:12:07] train in BasicTrainer:
epoch: 44
INFO    [11-27 19:12:10] _train_one_epoch in BasicTrainer:
loss = 4.1284694480896
INFO    [11-27 19:12:12] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [11-27 19:12:12] validate in BasicTrainer:
{'Recall@10': 0.15779026846090952, 'NDCG@10': 0.08472242454687755, 'MRR@10': 0.06267973904808362, 'Recall@5': 0.10035568972428639, 'NDCG@5': 0.06616821636756261, 'MRR@5': 0.05502691492438316, 'Recall*@10': 0.15779026846090952, 'NDCG*@10': 0.08472242454687755, 'MRR*@10': 0.06267973904808362, 'Recall*@5': 0.10035568972428639, 'NDCG*@5': 0.06616821636756261, 'MRR*@5': 0.05502691492438316}
INFO    [11-27 19:12:12] train in BasicTrainer:
duration: 4.873384714126587s
INFO    [11-27 19:12:12] train in BasicTrainer:
epoch: 45
INFO    [11-27 19:12:15] _train_one_epoch in BasicTrainer:
loss = 4.1117082118988035
INFO    [11-27 19:12:17] log in loggers:
Update Best NDCG@10 Model at 45
INFO    [11-27 19:12:17] validate in BasicTrainer:
{'Recall@10': 0.1621411293745041, 'NDCG@10': 0.08691398799419403, 'MRR@10': 0.0641613466044267, 'Recall@5': 0.1052781989177068, 'NDCG@5': 0.06874281913042068, 'MRR@5': 0.05678697923819224, 'Recall*@10': 0.1621411293745041, 'NDCG*@10': 0.08691398799419403, 'MRR*@10': 0.0641613466044267, 'Recall*@5': 0.1052781989177068, 'NDCG*@5': 0.06874281913042068, 'MRR*@5': 0.05678697923819224}
INFO    [11-27 19:12:17] train in BasicTrainer:
duration: 4.867671728134155s
INFO    [11-27 19:12:17] train in BasicTrainer:
epoch: 46
INFO    [11-27 19:12:20] _train_one_epoch in BasicTrainer:
loss = 4.093800959587097
INFO    [11-27 19:12:21] validate in BasicTrainer:
{'Recall@10': 0.15543222427368164, 'NDCG@10': 0.08365743855635326, 'MRR@10': 0.06181008989612261, 'Recall@5': 0.10397611558437347, 'NDCG@5': 0.06702221309145291, 'MRR@5': 0.0549492413798968, 'Recall*@10': 0.15543222427368164, 'NDCG*@10': 0.08365743855635326, 'MRR*@10': 0.06181008989612261, 'Recall*@5': 0.10397611558437347, 'NDCG*@5': 0.06702221309145291, 'MRR*@5': 0.0549492413798968}
INFO    [11-27 19:12:21] train in BasicTrainer:
duration: 4.709505558013916s
INFO    [11-27 19:12:21] train in BasicTrainer:
epoch: 47
INFO    [11-27 19:12:25] _train_one_epoch in BasicTrainer:
loss = 4.086801357269287
INFO    [11-27 19:12:26] validate in BasicTrainer:
{'Recall@10': 0.15815548598766327, 'NDCG@10': 0.08667247245709102, 'MRR@10': 0.06501117100318272, 'Recall@5': 0.10466685642798741, 'NDCG@5': 0.0695740779240926, 'MRR@5': 0.058065240581830345, 'Recall*@10': 0.15815548598766327, 'NDCG*@10': 0.08667247245709102, 'MRR*@10': 0.06501117100318272, 'Recall*@5': 0.10466685642798741, 'NDCG*@5': 0.0695740779240926, 'MRR*@5': 0.058065240581830345}
INFO    [11-27 19:12:26] train in BasicTrainer:
duration: 4.84122633934021s
INFO    [11-27 19:12:26] train in BasicTrainer:
epoch: 48
INFO    [11-27 19:12:30] _train_one_epoch in BasicTrainer:
loss = 4.073198962211609
INFO    [11-27 19:12:31] validate in BasicTrainer:
{'Recall@10': 0.15717892348766327, 'NDCG@10': 0.08552467823028564, 'MRR@10': 0.06368789821863174, 'Recall@5': 0.10905741651852925, 'NDCG@5': 0.07020283490419388, 'MRR@5': 0.05750603477160136, 'Recall*@10': 0.15717892348766327, 'NDCG*@10': 0.08552467823028564, 'MRR*@10': 0.06368789821863174, 'Recall*@5': 0.10905741651852925, 'NDCG*@5': 0.07020283490419388, 'MRR*@5': 0.05750603477160136}
INFO    [11-27 19:12:31] train in BasicTrainer:
duration: 4.969400644302368s
INFO    [11-27 19:12:31] train in BasicTrainer:
epoch: 49
INFO    [11-27 19:12:34] _train_one_epoch in BasicTrainer:
loss = 4.056496753692627
INFO    [11-27 19:12:36] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [11-27 19:12:36] validate in BasicTrainer:
{'Recall@10': 0.16438007851441702, 'NDCG@10': 0.08875805139541626, 'MRR@10': 0.06565187871456146, 'Recall@5': 0.11409902075926463, 'NDCG@5': 0.07280080765485764, 'MRR@5': 0.05924611538648605, 'Recall*@10': 0.16438007851441702, 'NDCG*@10': 0.08875805139541626, 'MRR*@10': 0.06565187871456146, 'Recall*@5': 0.11409902075926463, 'NDCG*@5': 0.07280080765485764, 'MRR*@5': 0.05924611538648605}
INFO    [11-27 19:12:36] train in BasicTrainer:
duration: 4.878332138061523s
INFO    [11-27 19:12:36] train in BasicTrainer:
epoch: 50
INFO    [11-27 19:12:39] _train_one_epoch in BasicTrainer:
loss = 4.043799600601196
INFO    [11-27 19:12:41] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [11-27 19:12:41] validate in BasicTrainer:
{'Recall@10': 0.16376873354117075, 'NDCG@10': 0.09089987973372142, 'MRR@10': 0.06879796087741852, 'Recall@5': 0.1096290647983551, 'NDCG@5': 0.07373615602652232, 'MRR@5': 0.061914059023062386, 'Recall*@10': 0.16376873354117075, 'NDCG*@10': 0.09089987973372142, 'MRR*@10': 0.06879796087741852, 'Recall*@5': 0.1096290647983551, 'NDCG*@5': 0.07373615602652232, 'MRR*@5': 0.061914059023062386}
INFO    [11-27 19:12:41] train in BasicTrainer:
duration: 4.865420818328857s
INFO    [11-27 19:12:41] train in BasicTrainer:
epoch: 51
INFO    [11-27 19:12:44] _train_one_epoch in BasicTrainer:
loss = 4.03104983329773
INFO    [11-27 19:12:46] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [11-27 19:12:46] validate in BasicTrainer:
{'Recall@10': 0.1647849977016449, 'NDCG@10': 0.09148418654998143, 'MRR@10': 0.06916593263546626, 'Recall@5': 0.1093829373518626, 'NDCG@5': 0.07356207569440205, 'MRR@5': 0.061767046650250755, 'Recall*@10': 0.1647849977016449, 'NDCG*@10': 0.09148418654998143, 'MRR*@10': 0.06916593263546626, 'Recall*@5': 0.1093829373518626, 'NDCG*@5': 0.07356207569440205, 'MRR*@5': 0.061767046650250755}
INFO    [11-27 19:12:46] train in BasicTrainer:
duration: 4.960614919662476s
INFO    [11-27 19:12:46] train in BasicTrainer:
epoch: 52
INFO    [11-27 19:12:49] _train_one_epoch in BasicTrainer:
loss = 4.017536988258362
INFO    [11-27 19:12:51] validate in BasicTrainer:
{'Recall@10': 0.1638084352016449, 'NDCG@10': 0.08979896952708562, 'MRR@10': 0.06741891553004582, 'Recall@5': 0.11137576152880986, 'NDCG@5': 0.07311686128377914, 'MRR@5': 0.06069600582122803, 'Recall*@10': 0.1638084352016449, 'NDCG*@10': 0.08979896952708562, 'MRR*@10': 0.06741891553004582, 'Recall*@5': 0.11137576152880986, 'NDCG*@5': 0.07311686128377914, 'MRR*@5': 0.06069600582122803}
INFO    [11-27 19:12:51] train in BasicTrainer:
duration: 4.7963457107543945s
INFO    [11-27 19:12:51] train in BasicTrainer:
epoch: 53
INFO    [11-27 19:12:54] _train_one_epoch in BasicTrainer:
loss = 4.003664541244507
INFO    [11-27 19:12:56] validate in BasicTrainer:
{'Recall@10': 0.1631176918745041, 'NDCG@10': 0.09146184474229813, 'MRR@10': 0.06951941053072612, 'Recall@5': 0.11601244906584422, 'NDCG@5': 0.07632754494746526, 'MRR@5': 0.06332981089750926, 'Recall*@10': 0.1631176918745041, 'NDCG*@10': 0.09146184474229813, 'MRR*@10': 0.06951941053072612, 'Recall*@5': 0.11601244906584422, 'NDCG*@5': 0.07632754494746526, 'MRR*@5': 0.06332981089750926}
INFO    [11-27 19:12:56] train in BasicTrainer:
duration: 4.875554323196411s
INFO    [11-27 19:12:56] train in BasicTrainer:
epoch: 54
INFO    [11-27 19:12:59] _train_one_epoch in BasicTrainer:
loss = 3.9927715063095093
INFO    [11-27 19:13:00] validate in BasicTrainer:
{'Recall@10': 0.16742886106173197, 'NDCG@10': 0.09035554776589076, 'MRR@10': 0.06706559658050537, 'Recall@5': 0.10999428232510884, 'NDCG@5': 0.07206516961256663, 'MRR@5': 0.05968014399210612, 'Recall*@10': 0.16742886106173197, 'NDCG*@10': 0.09035554776589076, 'MRR*@10': 0.06706559658050537, 'Recall*@5': 0.10999428232510884, 'NDCG*@5': 0.07206516961256663, 'MRR*@5': 0.05968014399210612}
INFO    [11-27 19:13:00] train in BasicTrainer:
duration: 4.8213605880737305s
INFO    [11-27 19:13:00] train in BasicTrainer:
epoch: 55
INFO    [11-27 19:13:04] _train_one_epoch in BasicTrainer:
loss = 3.9808175659179685
INFO    [11-27 19:13:05] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [11-27 19:13:05] validate in BasicTrainer:
{'Recall@10': 0.16637290020783743, 'NDCG@10': 0.09345449507236481, 'MRR@10': 0.07134438802798589, 'Recall@5': 0.11764005323251088, 'NDCG@5': 0.07820655405521393, 'MRR@5': 0.06534949814279874, 'Recall*@10': 0.16637290020783743, 'NDCG*@10': 0.09345449507236481, 'MRR*@10': 0.07134438802798589, 'Recall*@5': 0.11764005323251088, 'NDCG*@5': 0.07820655405521393, 'MRR*@5': 0.06534949814279874}
INFO    [11-27 19:13:05] train in BasicTrainer:
duration: 4.9110376834869385s
INFO    [11-27 19:13:05] train in BasicTrainer:
epoch: 56
INFO    [11-27 19:13:09] _train_one_epoch in BasicTrainer:
loss = 3.970606083869934
INFO    [11-27 19:13:10] validate in BasicTrainer:
{'Recall@10': 0.16848481694857279, 'NDCG@10': 0.09095916400353114, 'MRR@10': 0.06757952893773715, 'Recall@5': 0.11003397901852925, 'NDCG@5': 0.07235407084226608, 'MRR@5': 0.06007897108793259, 'Recall*@10': 0.16848481694857279, 'NDCG*@10': 0.09095916400353114, 'MRR*@10': 0.06757952893773715, 'Recall*@5': 0.11003397901852925, 'NDCG*@5': 0.07235407084226608, 'MRR*@5': 0.06007897108793259}
INFO    [11-27 19:13:10] train in BasicTrainer:
duration: 4.846181154251099s
INFO    [11-27 19:13:10] train in BasicTrainer:
epoch: 57
INFO    [11-27 19:13:13] _train_one_epoch in BasicTrainer:
loss = 3.9577756547927856
INFO    [11-27 19:13:15] validate in BasicTrainer:
{'Recall@10': 0.16848481694857279, 'NDCG@10': 0.09267303844292958, 'MRR@10': 0.06979412337144215, 'Recall@5': 0.10942263652880986, 'NDCG@5': 0.07365650683641434, 'MRR@5': 0.06199610730012258, 'Recall*@10': 0.16848481694857279, 'NDCG*@10': 0.09267303844292958, 'MRR*@10': 0.06979412337144215, 'Recall*@5': 0.10942263652880986, 'NDCG*@5': 0.07365650683641434, 'MRR*@5': 0.06199610730012258}
INFO    [11-27 19:13:15] train in BasicTrainer:
duration: 4.772191524505615s
INFO    [11-27 19:13:15] train in BasicTrainer:
epoch: 58
INFO    [11-27 19:13:18] _train_one_epoch in BasicTrainer:
loss = 3.9474800395965577
INFO    [11-27 19:13:20] validate in BasicTrainer:
{'Recall@10': 0.16470559934775034, 'NDCG@10': 0.09312071651220322, 'MRR@10': 0.07127960522969563, 'Recall@5': 0.11601244906584422, 'NDCG@5': 0.07753455142180125, 'MRR@5': 0.0649336005250613, 'Recall*@10': 0.16470559934775034, 'NDCG*@10': 0.09312071651220322, 'MRR*@10': 0.07127960522969563, 'Recall*@5': 0.11601244906584422, 'NDCG*@5': 0.07753455142180125, 'MRR*@5': 0.0649336005250613}
INFO    [11-27 19:13:20] train in BasicTrainer:
duration: 4.868387937545776s
INFO    [11-27 19:13:20] train in BasicTrainer:
epoch: 59
DEBUG   [11-27 19:13:23] calculate_loss in loss:
soft_target max: 0.5027085542678833, argmax 511806
DEBUG   [11-27 19:13:23] calculate_loss in loss:
pred max in softmax: 0.20399707555770874, argmax 1129136
INFO    [11-27 19:13:23] _train_one_epoch in BasicTrainer:
loss = 3.9363487100601198
INFO    [11-27 19:13:25] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [11-27 19:13:25] validate in BasicTrainer:
{'Recall@10': 0.17417746285597482, 'NDCG@10': 0.09459381053845088, 'MRR@10': 0.07065964490175247, 'Recall@5': 0.11247141659259796, 'NDCG@5': 0.07511886954307556, 'MRR@5': 0.06289710601170857, 'Recall*@10': 0.17417746285597482, 'NDCG*@10': 0.09459381053845088, 'MRR*@10': 0.07065964490175247, 'Recall*@5': 0.11247141659259796, 'NDCG*@5': 0.07511886954307556, 'MRR*@5': 0.06289710601170857}
INFO    [11-27 19:13:25] train in BasicTrainer:
duration: 4.845685005187988s
INFO    [11-27 19:13:25] train in BasicTrainer:
epoch: 60
DEBUG   [11-27 19:13:25] calculate_loss in loss:
soft_target max: 0.5027085542678833, argmax 785331
DEBUG   [11-27 19:13:25] calculate_loss in loss:
pred max in softmax: 0.24188660085201263, argmax 834869
INFO    [11-27 19:13:28] _train_one_epoch in BasicTrainer:
loss = 3.9239801168441772
INFO    [11-27 19:13:29] validate in BasicTrainer:
{'Recall@10': 0.16938198606173197, 'NDCG@10': 0.09421778966983159, 'MRR@10': 0.07130574683348338, 'Recall@5': 0.11971227079629898, 'NDCG@5': 0.07846299310525258, 'MRR@5': 0.06497925147414207, 'Recall*@10': 0.16938198606173197, 'NDCG*@10': 0.09421778966983159, 'MRR*@10': 0.07130574683348338, 'Recall*@5': 0.11971227079629898, 'NDCG*@5': 0.07846299310525258, 'MRR*@5': 0.06497925147414207}
INFO    [11-27 19:13:29] train in BasicTrainer:
duration: 4.610502243041992s
INFO    [11-27 19:13:29] train in BasicTrainer:
epoch: 61
INFO    [11-27 19:13:32] _train_one_epoch in BasicTrainer:
loss = 3.9168850660324095
INFO    [11-27 19:13:34] validate in BasicTrainer:
{'Recall@10': 0.1631176918745041, 'NDCG@10': 0.09053791562716167, 'MRR@10': 0.06833030531803767, 'Recall@5': 0.1097481573621432, 'NDCG@5': 0.07319800804058711, 'MRR@5': 0.06112328420082728, 'Recall*@10': 0.1631176918745041, 'NDCG*@10': 0.09053791562716167, 'MRR*@10': 0.06833030531803767, 'Recall*@5': 0.1097481573621432, 'NDCG*@5': 0.07319800804058711, 'MRR*@5': 0.06112328420082728}
INFO    [11-27 19:13:34] train in BasicTrainer:
duration: 4.683640003204346s
INFO    [11-27 19:13:34] train in BasicTrainer:
epoch: 62
INFO    [11-27 19:13:37] _train_one_epoch in BasicTrainer:
loss = 3.902808632850647
INFO    [11-27 19:13:39] validate in BasicTrainer:
{'Recall@10': 0.16742886106173197, 'NDCG@10': 0.09355191886425018, 'MRR@10': 0.07108474274476369, 'Recall@5': 0.11499618738889694, 'NDCG@5': 0.07668012877305348, 'MRR@5': 0.06416823094089825, 'Recall*@10': 0.16742886106173197, 'NDCG*@10': 0.09355191886425018, 'MRR*@10': 0.07108474274476369, 'Recall*@5': 0.11499618738889694, 'NDCG*@5': 0.07668012877305348, 'MRR*@5': 0.06416823094089825}
INFO    [11-27 19:13:39] train in BasicTrainer:
duration: 4.823558807373047s
INFO    [11-27 19:13:39] train in BasicTrainer:
epoch: 63
INFO    [11-27 19:13:42] _train_one_epoch in BasicTrainer:
loss = 3.8920829057693482
INFO    [11-27 19:13:43] validate in BasicTrainer:
{'Recall@10': 0.16804020603497824, 'NDCG@10': 0.09371431668599446, 'MRR@10': 0.07104568680127461, 'Recall@5': 0.11580602079629898, 'NDCG@5': 0.07695893198251724, 'MRR@5': 0.06420845786730449, 'Recall*@10': 0.16804020603497824, 'NDCG*@10': 0.09371431668599446, 'MRR*@10': 0.07104568680127461, 'Recall*@5': 0.11580602079629898, 'NDCG*@5': 0.07695893198251724, 'MRR*@5': 0.06420845786730449}
INFO    [11-27 19:13:43] train in BasicTrainer:
duration: 4.731027841567993s
INFO    [11-27 19:13:43] train in BasicTrainer:
epoch: 64
INFO    [11-27 19:13:47] _train_one_epoch in BasicTrainer:
loss = 3.883637099266052
INFO    [11-27 19:13:48] validate in BasicTrainer:
{'Recall@10': 0.16368934015432993, 'NDCG@10': 0.09208099295695622, 'MRR@10': 0.07008505860964458, 'Recall@5': 0.11743362496296565, 'NDCG@5': 0.07713460673888524, 'MRR@5': 0.06392607341210048, 'Recall*@10': 0.16368934015432993, 'NDCG*@10': 0.09208099295695622, 'MRR*@10': 0.07008505860964458, 'Recall*@5': 0.11743362496296565, 'NDCG*@5': 0.07713460673888524, 'MRR*@5': 0.06392607341210048}
INFO    [11-27 19:13:48] train in BasicTrainer:
duration: 4.902212858200073s
INFO    [11-27 19:13:48] train in BasicTrainer:
epoch: 65
INFO    [11-27 19:13:52] _train_one_epoch in BasicTrainer:
loss = 3.870769395828247
INFO    [11-27 19:13:53] validate in BasicTrainer:
{'Recall@10': 0.16441977520783743, 'NDCG@10': 0.09309835980335872, 'MRR@10': 0.07126484314600627, 'Recall@5': 0.11812436332305272, 'NDCG@5': 0.07819314549366634, 'MRR@5': 0.065154317766428, 'Recall*@10': 0.16441977520783743, 'NDCG*@10': 0.09309835980335872, 'MRR*@10': 0.07126484314600627, 'Recall*@5': 0.11812436332305272, 'NDCG*@5': 0.07819314549366634, 'MRR*@5': 0.065154317766428}
INFO    [11-27 19:13:53] train in BasicTrainer:
duration: 4.759300947189331s
INFO    [11-27 19:13:53] train in BasicTrainer:
epoch: 66
INFO    [11-27 19:13:56] _train_one_epoch in BasicTrainer:
loss = 3.8652106857299806
INFO    [11-27 19:13:58] validate in BasicTrainer:
{'Recall@10': 0.16698424518108368, 'NDCG@10': 0.09433934837579727, 'MRR@10': 0.072071373462677, 'Recall@5': 0.11710810412963231, 'NDCG@5': 0.07820381969213486, 'MRR@5': 0.06540719171365102, 'Recall*@10': 0.16698424518108368, 'NDCG*@10': 0.09433934837579727, 'MRR*@10': 0.072071373462677, 'Recall*@5': 0.11710810412963231, 'NDCG*@5': 0.07820381969213486, 'MRR*@5': 0.06540719171365102}
INFO    [11-27 19:13:58] train in BasicTrainer:
duration: 5.030331134796143s
INFO    [11-27 19:13:58] train in BasicTrainer:
epoch: 67
INFO    [11-27 19:14:01] _train_one_epoch in BasicTrainer:
loss = 3.856753416061401
INFO    [11-27 19:14:03] validate in BasicTrainer:
{'Recall@10': 0.1657615602016449, 'NDCG@10': 0.09405027329921722, 'MRR@10': 0.07214842736721039, 'Recall@5': 0.11475006242593129, 'NDCG@5': 0.0775278980533282, 'MRR@5': 0.06531258051594098, 'Recall*@10': 0.1657615602016449, 'NDCG*@10': 0.09405027329921722, 'MRR*@10': 0.07214842736721039, 'Recall*@5': 0.11475006242593129, 'NDCG*@5': 0.0775278980533282, 'MRR*@5': 0.06531258051594098}
INFO    [11-27 19:14:03] train in BasicTrainer:
duration: 4.460896730422974s
INFO    [11-27 19:14:03] train in BasicTrainer:
epoch: 68
INFO    [11-27 19:14:06] _train_one_epoch in BasicTrainer:
loss = 3.844658236503601
INFO    [11-27 19:14:07] log in loggers:
Update Best NDCG@10 Model at 68
INFO    [11-27 19:14:07] validate in BasicTrainer:
{'Recall@10': 0.1695010761419932, 'NDCG@10': 0.095619002978007, 'MRR@10': 0.07310123989979427, 'Recall@5': 0.11434514572223027, 'NDCG@5': 0.07789988567431767, 'MRR@5': 0.06585604200760524, 'Recall*@10': 0.1695010761419932, 'NDCG*@10': 0.095619002978007, 'MRR*@10': 0.07310123989979427, 'Recall*@5': 0.11434514572223027, 'NDCG*@5': 0.07789988567431767, 'MRR*@5': 0.06585604200760524}
INFO    [11-27 19:14:07] train in BasicTrainer:
duration: 4.482591152191162s
INFO    [11-27 19:14:07] train in BasicTrainer:
epoch: 69
INFO    [11-27 19:14:10] _train_one_epoch in BasicTrainer:
loss = 3.8364110136032106
INFO    [11-27 19:14:12] log in loggers:
Update Best NDCG@10 Model at 69
INFO    [11-27 19:14:12] validate in BasicTrainer:
{'Recall@10': 0.16909616192181906, 'NDCG@10': 0.09576410800218582, 'MRR@10': 0.07335752248764038, 'Recall@5': 0.11808466662963231, 'NDCG@5': 0.07932714621225993, 'MRR@5': 0.0666081781188647, 'Recall*@10': 0.16909616192181906, 'NDCG*@10': 0.09576410800218582, 'MRR*@10': 0.07335752248764038, 'Recall*@5': 0.11808466662963231, 'NDCG*@5': 0.07932714621225993, 'MRR*@5': 0.0666081781188647}
INFO    [11-27 19:14:12] train in BasicTrainer:
duration: 4.666098594665527s
INFO    [11-27 19:14:12] train in BasicTrainer:
epoch: 70
INFO    [11-27 19:14:15] _train_one_epoch in BasicTrainer:
loss = 3.8270494174957275
INFO    [11-27 19:14:16] log in loggers:
Update Best NDCG@10 Model at 70
INFO    [11-27 19:14:16] validate in BasicTrainer:
{'Recall@10': 0.16832602520783743, 'NDCG@10': 0.09767866631348927, 'MRR@10': 0.07611492276191711, 'Recall@5': 0.11747332165638606, 'NDCG@5': 0.08135531346003215, 'MRR@5': 0.06944682449102402, 'Recall*@10': 0.16832602520783743, 'NDCG*@10': 0.09767866631348927, 'MRR*@10': 0.07611492276191711, 'Recall*@5': 0.11747332165638606, 'NDCG*@5': 0.08135531346003215, 'MRR*@5': 0.06944682449102402}
INFO    [11-27 19:14:16] train in BasicTrainer:
duration: 4.509778022766113s
INFO    [11-27 19:14:16] train in BasicTrainer:
epoch: 71
INFO    [11-27 19:14:19] _train_one_epoch in BasicTrainer:
loss = 3.8167685365676878
INFO    [11-27 19:14:21] validate in BasicTrainer:
{'Recall@10': 0.1706840693950653, 'NDCG@10': 0.0971596563855807, 'MRR@10': 0.0746657798687617, 'Recall@5': 0.11779884248971939, 'NDCG@5': 0.08012042691310246, 'MRR@5': 0.06767167896032333, 'Recall*@10': 0.1706840693950653, 'NDCG*@10': 0.0971596563855807, 'MRR*@10': 0.0746657798687617, 'Recall*@5': 0.11779884248971939, 'NDCG*@5': 0.08012042691310246, 'MRR*@5': 0.06767167896032333}
INFO    [11-27 19:14:21] train in BasicTrainer:
duration: 4.597423791885376s
INFO    [11-27 19:14:21] train in BasicTrainer:
epoch: 72
INFO    [11-27 19:14:24] _train_one_epoch in BasicTrainer:
loss = 3.8081737422943114
INFO    [11-27 19:14:26] validate in BasicTrainer:
{'Recall@10': 0.17108898361523947, 'NDCG@10': 0.09679915010929108, 'MRR@10': 0.0740897407134374, 'Recall@5': 0.11580602079629898, 'NDCG@5': 0.07885317007700603, 'MRR@5': 0.06664178892970085, 'Recall*@10': 0.17108898361523947, 'NDCG*@10': 0.09679915010929108, 'MRR*@10': 0.0740897407134374, 'Recall*@5': 0.11580602079629898, 'NDCG*@5': 0.07885317007700603, 'MRR*@5': 0.06664178892970085}
INFO    [11-27 19:14:26] train in BasicTrainer:
duration: 4.6094043254852295s
INFO    [11-27 19:14:26] train in BasicTrainer:
epoch: 73
INFO    [11-27 19:14:29] _train_one_epoch in BasicTrainer:
loss = 3.8044429445266723
INFO    [11-27 19:14:30] validate in BasicTrainer:
{'Recall@10': 0.16942168275515238, 'NDCG@10': 0.09562298903862636, 'MRR@10': 0.07298991084098816, 'Recall@5': 0.1197916641831398, 'NDCG@5': 0.07958513249953587, 'MRR@5': 0.06637806942065556, 'Recall*@10': 0.16942168275515238, 'NDCG*@10': 0.09562298903862636, 'MRR*@10': 0.07298991084098816, 'Recall*@5': 0.1197916641831398, 'NDCG*@5': 0.07958513249953587, 'MRR*@5': 0.06637806942065556}
INFO    [11-27 19:14:30] train in BasicTrainer:
duration: 4.579415798187256s
INFO    [11-27 19:14:30] train in BasicTrainer:
epoch: 74
INFO    [11-27 19:14:33] _train_one_epoch in BasicTrainer:
loss = 3.7921194648742675
INFO    [11-27 19:14:35] validate in BasicTrainer:
{'Recall@10': 0.17235137025515238, 'NDCG@10': 0.09718276063601176, 'MRR@10': 0.07420395314693451, 'Recall@5': 0.11808466662963231, 'NDCG@5': 0.07963145027558009, 'MRR@5': 0.06695831194519997, 'Recall*@10': 0.17235137025515238, 'NDCG*@10': 0.09718276063601176, 'MRR*@10': 0.07420395314693451, 'Recall*@5': 0.11808466662963231, 'NDCG*@5': 0.07963145027558009, 'MRR*@5': 0.06695831194519997}
INFO    [11-27 19:14:35] train in BasicTrainer:
duration: 4.49847936630249s
INFO    [11-27 19:14:35] train in BasicTrainer:
epoch: 75
INFO    [11-27 19:14:38] _train_one_epoch in BasicTrainer:
loss = 3.784215474128723
INFO    [11-27 19:14:39] validate in BasicTrainer:
{'Recall@10': 0.16905646522839865, 'NDCG@10': 0.09592086325089137, 'MRR@10': 0.07351533323526382, 'Recall@5': 0.11873570829629898, 'NDCG@5': 0.07958136747280757, 'MRR@5': 0.06673282633225124, 'Recall*@10': 0.16905646522839865, 'NDCG*@10': 0.09592086325089137, 'MRR*@10': 0.07351533323526382, 'Recall*@5': 0.11873570829629898, 'NDCG*@5': 0.07958136747280757, 'MRR*@5': 0.06673282633225124}
INFO    [11-27 19:14:39] train in BasicTrainer:
duration: 4.770498514175415s
INFO    [11-27 19:14:39] train in BasicTrainer:
epoch: 76
INFO    [11-27 19:14:42] _train_one_epoch in BasicTrainer:
loss = 3.7746265506744385
INFO    [11-27 19:14:44] validate in BasicTrainer:
{'Recall@10': 0.17060467104117075, 'NDCG@10': 0.09671010325352351, 'MRR@10': 0.07419608285029729, 'Recall@5': 0.11775914579629898, 'NDCG@5': 0.07992984106143315, 'MRR@5': 0.06745043148597081, 'Recall*@10': 0.17060467104117075, 'NDCG*@10': 0.09671010325352351, 'MRR*@10': 0.07419608285029729, 'Recall*@5': 0.11775914579629898, 'NDCG*@5': 0.07992984106143315, 'MRR*@5': 0.06745043148597081}
INFO    [11-27 19:14:44] train in BasicTrainer:
duration: 4.547694444656372s
INFO    [11-27 19:14:44] train in BasicTrainer:
epoch: 77
INFO    [11-27 19:14:47] _train_one_epoch in BasicTrainer:
loss = 3.76837646484375
INFO    [11-27 19:14:49] log in loggers:
Update Best NDCG@10 Model at 77
INFO    [11-27 19:14:49] validate in BasicTrainer:
{'Recall@10': 0.1714938978354136, 'NDCG@10': 0.09825699279705684, 'MRR@10': 0.07595701764027278, 'Recall@5': 0.11710810412963231, 'NDCG@5': 0.08072311927874883, 'MRR@5': 0.06875184923410416, 'Recall*@10': 0.1714938978354136, 'NDCG*@10': 0.09825699279705684, 'MRR*@10': 0.07595701764027278, 'Recall*@5': 0.11710810412963231, 'NDCG*@5': 0.08072311927874883, 'MRR*@5': 0.06875184923410416}
INFO    [11-27 19:14:49] train in BasicTrainer:
duration: 4.747468709945679s
INFO    [11-27 19:14:49] train in BasicTrainer:
epoch: 78
INFO    [11-27 19:14:52] _train_one_epoch in BasicTrainer:
loss = 3.7612015628814697
INFO    [11-27 19:14:53] validate in BasicTrainer:
{'Recall@10': 0.1706443727016449, 'NDCG@10': 0.09693295260270436, 'MRR@10': 0.07449578990538915, 'Recall@5': 0.11767974992593129, 'NDCG@5': 0.08000509689251582, 'MRR@5': 0.06762602801124255, 'Recall*@10': 0.1706443727016449, 'NDCG*@10': 0.09693295260270436, 'MRR*@10': 0.07449578990538915, 'Recall*@5': 0.11767974992593129, 'NDCG*@5': 0.08000509689251582, 'MRR*@5': 0.06762602801124255}
INFO    [11-27 19:14:53] train in BasicTrainer:
duration: 4.541524410247803s
INFO    [11-27 19:14:53] train in BasicTrainer:
epoch: 79
DEBUG   [11-27 19:14:56] calculate_loss in loss:
soft_target max: 0.5027085542678833, argmax 307574
DEBUG   [11-27 19:14:56] calculate_loss in loss:
pred max in softmax: 0.32881027460098267, argmax 759909
INFO    [11-27 19:14:56] _train_one_epoch in BasicTrainer:
loss = 3.7539156913757323
INFO    [11-27 19:14:58] log in loggers:
Update Best NDCG@10 Model at 79
INFO    [11-27 19:14:58] validate in BasicTrainer:
{'Recall@10': 0.17698805530865988, 'NDCG@10': 0.09858952462673187, 'MRR@10': 0.07478809853394826, 'Recall@5': 0.11808466662963231, 'NDCG@5': 0.07954807082811992, 'MRR@5': 0.06693131849169731, 'Recall*@10': 0.17698805530865988, 'NDCG*@10': 0.09858952462673187, 'MRR*@10': 0.07478809853394826, 'Recall*@5': 0.11808466662963231, 'NDCG*@5': 0.07954807082811992, 'MRR*@5': 0.06693131849169731}
INFO    [11-27 19:14:58] train in BasicTrainer:
duration: 4.815405607223511s
INFO    [11-27 19:14:58] close_training in BasicTrainer:
finished training
DEBUG   [11-27 19:14:58] debug_summary in loss:
loss nan summary: nan 0 times, not nan 4001 times, ratio nan / (nan + not_nan) = 0.0
INFO    [11-27 19:14:58] run_routine in Routine:
Finished training, Start final validation
INFO    [11-27 19:14:58] final_validate in BasicTrainer:
validate model on val set!
INFO    [11-27 19:14:58] load_state_from_given_path in utils:
checkpoint epoch: 79
INFO    [11-27 19:14:58] load_state_from_given_path in utils:
Loading model's parameters
INFO    [11-27 19:15:00] validate in BasicTrainer:
{'Recall@10': 0.17698805530865988, 'NDCG@10': 0.09858952462673187, 'MRR@10': 0.07478809853394826, 'Recall@5': 0.11808466662963231, 'NDCG@5': 0.07954807082811992, 'MRR@5': 0.06693131849169731, 'Recall*@10': 0.17698805530865988, 'NDCG*@10': 0.09858952462673187, 'MRR*@10': 0.07478809853394826, 'Recall*@5': 0.11808466662963231, 'NDCG*@5': 0.07954807082811992, 'MRR*@5': 0.06693131849169731}
INFO    [11-27 19:15:00] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.17698805530865988, 'NDCG@10': 0.09858952462673187, 'MRR@10': 0.07478809853394826, 'Recall@5': 0.11808466662963231, 'NDCG@5': 0.07954807082811992, 'MRR@5': 0.06693131849169731, 'Recall*@10': 0.17698805530865988, 'NDCG*@10': 0.09858952462673187, 'MRR*@10': 0.07478809853394826, 'Recall*@5': 0.11808466662963231, 'NDCG*@5': 0.07954807082811992, 'MRR*@5': 0.06693131849169731}
INFO    [11-27 19:15:00] _evaluate in DistillSched:
Start testing student model on test set
INFO    [11-27 19:15:00] test in BasicTrainer:
Test model on test set!
INFO    [11-27 19:15:00] test_with_given_state_path in BasicTrainer:
Loading model params from _____lfms_soft_len_4/soft_gru4rec-len-30_11-27_19-08_t5/student_gru4rec_logs/checkpoint/best_acc_model.pth.
INFO    [11-27 19:15:00] load_state_from_given_path in utils:
checkpoint epoch: 79
INFO    [11-27 19:15:00] load_state_from_given_path in utils:
Loading model's parameters
INFO    [11-27 19:15:00] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [11-27 19:15:01] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.15526549518108368, 'NDCG@10': 0.089155246814092, 'MRR@10': 0.06904736161231995, 'Recall@5': 0.11039919902880986, 'NDCG@5': 0.07480476796627045, 'MRR@5': 0.06321694081028302, 'Recall*@10': 0.15526549518108368, 'NDCG*@10': 0.089155246814092, 'MRR*@10': 0.06904736161231995, 'Recall*@5': 0.11039919902880986, 'NDCG*@5': 0.07480476796627045, 'MRR*@5': 0.06321694081028302}
INFO    [11-27 19:15:01] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.15526549518108368, 'NDCG@10': 0.089155246814092, 'MRR@10': 0.06904736161231995, 'Recall@5': 0.11039919902880986, 'NDCG@5': 0.07480476796627045, 'MRR@5': 0.06321694081028302, 'Recall*@10': 0.15526549518108368, 'NDCG*@10': 0.089155246814092, 'MRR*@10': 0.06904736161231995, 'Recall*@5': 0.11039919902880986, 'NDCG*@5': 0.07480476796627045, 'MRR*@5': 0.06321694081028302}
