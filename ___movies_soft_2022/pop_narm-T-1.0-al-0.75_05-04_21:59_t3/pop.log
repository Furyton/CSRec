INFO    [05-04 21:59:16] setup_train in utils:
{
    "experiment_dir": "___movies_soft_2022",
    "experiment_description": "pop",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "movies.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "alpha": 0.75,
    "T": 1.0,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "do_remap": false,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.movies/narm/config_distill.json",
    "task_id": 3,
    "split": "leave_one_out",
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "dvae_alpha": 0.5,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-04 21:59:16] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-04 21:59:16] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/movies-5-5.pkl
INFO    [05-04 21:59:17] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-04 21:59:17] _check_dataset_cache in utils:
correct.
INFO    [05-04 21:59:17] __init__ in NextItemDataloader:
there are 21035 items in this dataset, 82156 users, padding_first? False
DEBUG   [05-04 21:59:28] generate_model in utils:
model_code_list=['pop']
INFO    [05-04 21:59:28] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-04 21:59:28] load_model_config in utils:
{}
WARNING [05-04 22:00:07] get_exist_path in utils:
dir ___movies_soft_2022/pop_narm-T-1.0-al-0.75_05-04_21:59_t3/teacher_pop_logs does not exist! Create one.
WARNING [05-04 22:00:07] get_exist_path in utils:
dir ___movies_soft_2022/pop_narm-T-1.0-al-0.75_05-04_21:59_t3/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-04 22:00:08] get_exist_path in utils:
dir ___movies_soft_2022/pop_narm-T-1.0-al-0.75_05-04_21:59_t3/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-04 22:00:08] get_path in utils:
Path is None
WARNING [05-04 22:00:08] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-04 22:00:08] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-04 22:00:08] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-04 22:00:08] __init__ in BasicTrainer:
450560 iter per epoch
DEBUG   [05-04 22:00:08] generate_model in utils:
model_code_list=['narm']
INFO    [05-04 22:00:08] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-04 22:00:08] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-04 22:00:26] get_exist_path in utils:
dir ___movies_soft_2022/pop_narm-T-1.0-al-0.75_05-04_21:59_t3/student_narm_logs does not exist! Create one.
WARNING [05-04 22:00:26] get_exist_path in utils:
dir ___movies_soft_2022/pop_narm-T-1.0-al-0.75_05-04_21:59_t3/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-04 22:00:26] get_exist_path in utils:
dir ___movies_soft_2022/pop_narm-T-1.0-al-0.75_05-04_21:59_t3/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-04 22:00:26] get_path in utils:
Path is None
WARNING [05-04 22:00:26] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-04 22:00:26] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(21036, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-04 22:00:26] assert_model_device in utils:
model student_narm has 5.60498046875 MB params.
INFO    [05-04 22:00:26] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-04 22:00:26] __init__ in DistillTrainer:
450560 iter per epoch
INFO    [05-04 22:00:26] _set_current_routine in Routine:
first routine: student
INFO    [05-04 22:00:26] run_routine in Routine:
Start routine student
INFO    [05-04 22:00:26] run_routine in Routine:
Start training
INFO    [05-04 22:00:26] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-04 22:00:52] test_mentor in DistillTrainer:
{'Recall@10': 0.01926957221613044, 'NDCG@10': 0.008763348351099662, 'MRR@10': 0.00570286333649641, 'Recall@5': 0.008940985337609337, 'NDCG@5': 0.00557392868878586, 'MRR@5': 0.004471914765114586, 'Recall*@10': 0.020209885645835174, 'NDCG*@10': 0.008964412269138154, 'MRR*@10': 0.0057113271738801685, 'Recall*@5': 0.008626139722764492, 'NDCG*@5': 0.005387002557870888, 'MRR*@5': 0.004329948863458066}
INFO    [05-04 22:00:52] train in DistillTrainer:
result:
{'Recall@10': 0.01926957221613044, 'NDCG@10': 0.008763348351099662, 'MRR@10': 0.00570286333649641, 'Recall@5': 0.008940985337609337, 'NDCG@5': 0.00557392868878586, 'MRR@5': 0.004471914765114586, 'Recall*@10': 0.020209885645835174, 'NDCG*@10': 0.008964412269138154, 'MRR*@10': 0.0057113271738801685, 'Recall*@5': 0.008626139722764492, 'NDCG*@5': 0.005387002557870888, 'MRR*@5': 0.004329948863458066}
INFO    [05-04 22:01:16] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-04 22:01:16] validate in BasicTrainer:
{'Recall@10': 0.0006510416666666666, 'NDCG@10': 0.00032070457624892396, 'MRR@10': 0.00022083378072628484, 'Recall@5': 0.0004069010416666667, 'NDCG@5': 0.00024287350935905816, 'MRR@5': 0.0001893058698832257, 'Recall*@10': 0.0006208952399902046, 'NDCG*@10': 0.00030577815396966236, 'MRR*@10': 0.00021059572169352102, 'Recall*@5': 0.0003880097009685068, 'NDCG*@5': 0.00023223877014104453, 'MRR*@5': 0.00018123157566324587}
INFO    [05-04 22:01:16] train in BasicTrainer:
epoch: 0
DEBUG   [05-04 22:01:18] calculate_loss in loss:
soft_target max: 0.646086573600769, argmax 2026253
DEBUG   [05-04 22:01:18] calculate_loss in loss:
pred max in softmax: 4.769504812429659e-05, argmax 4329422
INFO    [05-04 22:01:39] _train_one_epoch in BasicTrainer:
loss = 6.367627078836614
INFO    [05-04 22:02:05] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-04 22:02:05] validate in BasicTrainer:
{'Recall@10': 0.016890432685613632, 'NDCG@10': 0.008231723304128363, 'MRR@10': 0.005630552480440764, 'Recall@5': 0.010185728115694863, 'NDCG@5': 0.006105508322694472, 'MRR@5': 0.004777103684665192, 'Recall*@10': 0.01587756128893012, 'NDCG*@10': 0.007642103780415796, 'MRR*@10': 0.00518008677421936, 'Recall*@5': 0.009558129900445541, 'NDCG*@5': 0.005632624872738407, 'MRR*@5': 0.004370064208550113}
INFO    [05-04 22:02:05] train in BasicTrainer:
duration: 48.293217182159424s
INFO    [05-04 22:02:05] train in BasicTrainer:
epoch: 1
INFO    [05-04 22:02:26] _train_one_epoch in BasicTrainer:
loss = 5.547285218672319
INFO    [05-04 22:02:50] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-04 22:02:51] validate in BasicTrainer:
{'Recall@10': 0.016964325060447056, 'NDCG@10': 0.008263920389470599, 'MRR@10': 0.00564810030517124, 'Recall@5': 0.010185728115694863, 'NDCG@5': 0.006105508322694472, 'MRR@5': 0.004777103684665192, 'Recall*@10': 0.015983355630721365, 'NDCG*@10': 0.007680599422504504, 'MRR*@10': 0.005198085813650063, 'Recall*@5': 0.009558129900445541, 'NDCG*@5': 0.005632624872738407, 'MRR*@5': 0.004370064208550113}
INFO    [05-04 22:02:51] train in BasicTrainer:
duration: 45.75385117530823s
INFO    [05-04 22:02:51] train in BasicTrainer:
epoch: 2
INFO    [05-04 22:03:13] _train_one_epoch in BasicTrainer:
loss = 5.477430347962813
INFO    [05-04 22:03:37] log in loggers:
Update Best NDCG@10 Model at 2
INFO    [05-04 22:03:38] validate in BasicTrainer:
{'Recall@10': 0.017494971376089824, 'NDCG@10': 0.008449321568367026, 'MRR@10': 0.005735183932951519, 'Recall@5': 0.010301985556171053, 'NDCG@5': 0.006157617395122846, 'MRR@5': 0.004809461977510225, 'Recall*@10': 0.016448575870266983, 'NDCG*@10': 0.007851057308947756, 'MRR*@10': 0.005283152518261757, 'Recall*@5': 0.009682285665933574, 'NDCG*@5': 0.005690255534968206, 'MRR*@5': 0.004407158941917476}
INFO    [05-04 22:03:38] train in BasicTrainer:
duration: 47.22856950759888s
INFO    [05-04 22:03:38] train in BasicTrainer:
epoch: 3
INFO    [05-04 22:04:00] _train_one_epoch in BasicTrainer:
loss = 5.447128083489158
INFO    [05-04 22:04:26] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-04 22:04:26] validate in BasicTrainer:
{'Recall@10': 0.0175414743522803, 'NDCG@10': 0.008488252005051999, 'MRR@10': 0.005765048587428672, 'Recall@5': 0.01036011427640915, 'NDCG@5': 0.006181695831141302, 'MRR@5': 0.004822637885808945, 'Recall*@10': 0.01627965284777539, 'NDCG*@10': 0.007811220983664195, 'MRR*@10': 0.005274194237288265, 'Recall*@5': 0.009714381481032996, 'NDCG*@5': 0.0057002948597073555, 'MRR*@5': 0.0044101509265601635}
INFO    [05-04 22:04:26] train in BasicTrainer:
duration: 48.22084617614746s
INFO    [05-04 22:04:26] train in BasicTrainer:
epoch: 4
INFO    [05-04 22:04:48] _train_one_epoch in BasicTrainer:
loss = 5.424752959338101
INFO    [05-04 22:05:12] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-04 22:05:12] validate in BasicTrainer:
{'Recall@10': 0.018782079219818115, 'NDCG@10': 0.00890142313160357, 'MRR@10': 0.005943098282884984, 'Recall@5': 0.010771153317320915, 'NDCG@5': 0.006340369316084045, 'MRR@5': 0.004903489457709449, 'Recall*@10': 0.01691710106318905, 'NDCG*@10': 0.008021774125241098, 'MRR*@10': 0.005363210159841748, 'Recall*@5': 0.009808359734181846, 'NDCG*@5': 0.0057381028309464455, 'MRR*@5': 0.004429664119102415}
INFO    [05-04 22:05:12] train in BasicTrainer:
duration: 46.03855013847351s
INFO    [05-04 22:05:12] train in BasicTrainer:
epoch: 5
INFO    [05-04 22:05:34] _train_one_epoch in BasicTrainer:
loss = 5.4071223432367495
INFO    [05-04 22:06:00] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-04 22:06:00] validate in BasicTrainer:
{'Recall@10': 0.019979530856722875, 'NDCG@10': 0.009333984505030372, 'MRR@10': 0.0061596787224213285, 'Recall@5': 0.010685635109742483, 'NDCG@5': 0.006349999967607714, 'MRR@5': 0.004940639128021541, 'Recall*@10': 0.018761092087342626, 'NDCG*@10': 0.008698473329700175, 'MRR*@10': 0.00570637947835383, 'Recall*@5': 0.010101149546071178, 'NDCG*@5': 0.005908384342633542, 'MRR*@5': 0.004560667090117931}
INFO    [05-04 22:06:00] train in BasicTrainer:
duration: 47.984811544418335s
INFO    [05-04 22:06:00] train in BasicTrainer:
epoch: 6
INFO    [05-04 22:06:21] _train_one_epoch in BasicTrainer:
loss = 5.393230390548706
INFO    [05-04 22:06:45] validate in BasicTrainer:
{'Recall@10': 0.019634108280851728, 'NDCG@10': 0.009271148969197557, 'MRR@10': 0.006169853133282491, 'Recall@5': 0.010825144038313911, 'NDCG@5': 0.006433439152758746, 'MRR@5': 0.005005549572940383, 'Recall*@10': 0.01854532256367661, 'NDCG*@10': 0.008654009883425065, 'MRR*@10': 0.005708317516282911, 'Recall*@5': 0.010194409195156325, 'NDCG*@5': 0.0059670633192928065, 'MRR*@5': 0.004607597543370156}
INFO    [05-04 22:06:45] train in BasicTrainer:
duration: 45.468077182769775s
INFO    [05-04 22:06:45] train in BasicTrainer:
epoch: 7
INFO    [05-04 22:07:07] _train_one_epoch in BasicTrainer:
loss = 5.379025771401145
INFO    [05-04 22:07:32] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-04 22:07:32] validate in BasicTrainer:
{'Recall@10': 0.02175826969600859, 'NDCG@10': 0.010175870908867745, 'MRR@10': 0.0067205132162641915, 'Recall@5': 0.011545940169266291, 'NDCG@5': 0.006886576479744343, 'MRR@5': 0.005371179243194915, 'Recall*@10': 0.0204512629480589, 'NDCG*@10': 0.009536779374771175, 'MRR*@10': 0.006289616581939515, 'Recall*@5': 0.0110510281242785, 'NDCG*@5': 0.006511453783050889, 'MRR*@5': 0.005049793204913537}
INFO    [05-04 22:07:32] train in BasicTrainer:
duration: 46.50784659385681s
INFO    [05-04 22:07:32] train in BasicTrainer:
epoch: 8
INFO    [05-04 22:07:54] _train_one_epoch in BasicTrainer:
loss = 5.35609506260265
INFO    [05-04 22:08:20] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-04 22:08:20] validate in BasicTrainer:
{'Recall@10': 0.02352203286829449, 'NDCG@10': 0.010800923619951521, 'MRR@10': 0.007022342312016657, 'Recall@5': 0.011887224745892343, 'NDCG@5': 0.00706483969198806, 'MRR@5': 0.005495318588578985, 'Recall*@10': 0.021940193538154875, 'NDCG*@10': 0.009974001773766108, 'MRR*@10': 0.006439422523336751, 'Recall*@5': 0.011004989833704062, 'NDCG*@5': 0.006473308828260217, 'MRR*@5': 0.005014829126940597}
INFO    [05-04 22:08:20] train in BasicTrainer:
duration: 48.392651319503784s
INFO    [05-04 22:08:20] train in BasicTrainer:
epoch: 9
DEBUG   [05-04 22:08:23] calculate_loss in loss:
soft_target max: 0.646086573600769, argmax 59033813
DEBUG   [05-04 22:08:23] calculate_loss in loss:
pred max in softmax: 0.4626069962978363, argmax 42120869
DEBUG   [05-04 22:08:24] calculate_loss in loss:
soft_target max: 0.646086573600769, argmax 13301549
DEBUG   [05-04 22:08:24] calculate_loss in loss:
pred max in softmax: 0.37795934081077576, argmax 80217065
INFO    [05-04 22:08:42] _train_one_epoch in BasicTrainer:
loss = 5.318478367545388
INFO    [05-04 22:09:06] validate in BasicTrainer:
{'Recall@10': 0.023792774904341923, 'NDCG@10': 0.010599527707589524, 'MRR@10': 0.006707632559395972, 'Recall@5': 0.011104161895456769, 'NDCG@5': 0.006541313758740823, 'MRR@5': 0.005059028022168647, 'Recall*@10': 0.022257955833559946, 'NDCG*@10': 0.009849626659637406, 'MRR*@10': 0.0061984082816966945, 'Recall*@5': 0.010444256100094034, 'NDCG*@5': 0.006065730981173969, 'MRR*@5': 0.004657765473460867}
INFO    [05-04 22:09:06] train in BasicTrainer:
duration: 45.755303144454956s
INFO    [05-04 22:09:06] train in BasicTrainer:
epoch: 10
INFO    [05-04 22:09:29] _train_one_epoch in BasicTrainer:
loss = 5.284373994307084
INFO    [05-04 22:09:54] validate in BasicTrainer:
{'Recall@10': 0.024501945291246687, 'NDCG@10': 0.010767627995283831, 'MRR@10': 0.006729643148857923, 'Recall@5': 0.01084839552640915, 'NDCG@5': 0.006395663489543256, 'MRR@5': 0.004950714851951315, 'Recall*@10': 0.022653291445402873, 'NDCG*@10': 0.009913882573268243, 'MRR*@10': 0.006174383640644096, 'Recall*@5': 0.010167370040324471, 'NDCG*@5': 0.005908190694061064, 'MRR*@5': 0.004539808014496451}
INFO    [05-04 22:09:54] train in BasicTrainer:
duration: 47.71181035041809s
INFO    [05-04 22:09:54] train in BasicTrainer:
epoch: 11
INFO    [05-04 22:10:15] _train_one_epoch in BasicTrainer:
loss = 5.256882780248469
INFO    [05-04 22:10:40] validate in BasicTrainer:
{'Recall@10': 0.024234553178151447, 'NDCG@10': 0.010701121895440988, 'MRR@10': 0.006719175460083144, 'Recall@5': 0.010941401478790101, 'NDCG@5': 0.00645697263202497, 'MRR@5': 0.004999349248551187, 'Recall*@10': 0.022677747089238393, 'NDCG*@10': 0.009916734659955614, 'MRR*@10': 0.006175060978248006, 'Recall*@5': 0.010243443306535482, 'NDCG*@5': 0.005947201911892209, 'MRR*@5': 0.004566568216042859}
INFO    [05-04 22:10:40] train in BasicTrainer:
duration: 45.773167848587036s
INFO    [05-04 22:10:40] train in BasicTrainer:
epoch: 12
INFO    [05-04 22:11:02] _train_one_epoch in BasicTrainer:
loss = 5.233450222015381
INFO    [05-04 22:11:27] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-04 22:11:28] validate in BasicTrainer:
{'Recall@10': 0.02509485823767526, 'NDCG@10': 0.011042174439699877, 'MRR@10': 0.0068963961897506604, 'Recall@5': 0.011515200936368533, 'NDCG@5': 0.006671074999585038, 'MRR@5': 0.0051042272798007444, 'Recall*@10': 0.022789669178781054, 'NDCG*@10': 0.010001976530821551, 'MRR*@10': 0.006239983497098798, 'Recall*@5': 0.0105390334723606, 'NDCG*@5': 0.006062420351164681, 'MRR*@5': 0.004626577420692358}
INFO    [05-04 22:11:28] train in BasicTrainer:
duration: 47.88972020149231s
INFO    [05-04 22:11:28] train in BasicTrainer:
epoch: 13
INFO    [05-04 22:11:49] _train_one_epoch in BasicTrainer:
loss = 5.212962206927213
INFO    [05-04 22:12:13] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-04 22:12:13] validate in BasicTrainer:
{'Recall@10': 0.026633594362508683, 'NDCG@10': 0.011652749652663866, 'MRR@10': 0.007238390035040322, 'Recall@5': 0.012015107930416153, 'NDCG@5': 0.006955885505747227, 'MRR@5': 0.005317365783931953, 'Recall*@10': 0.024884028626339778, 'NDCG*@10': 0.010802876913831347, 'MRR*@10': 0.006664029721702848, 'Recall*@5': 0.011095670983195305, 'NDCG*@5': 0.00635522637250168, 'MRR*@5': 0.004834575955534265}
INFO    [05-04 22:12:13] train in BasicTrainer:
duration: 45.22905874252319s
INFO    [05-04 22:12:13] train in BasicTrainer:
epoch: 14
INFO    [05-04 22:12:35] _train_one_epoch in BasicTrainer:
loss = 5.190180388363925
INFO    [05-04 22:12:59] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-04 22:12:59] validate in BasicTrainer:
{'Recall@10': 0.027567003631875628, 'NDCG@10': 0.011972453356498764, 'MRR@10': 0.007389016471625794, 'Recall@5': 0.012189494091130439, 'NDCG@5': 0.007054078193115336, 'MRR@5': 0.005390220543458348, 'Recall*@10': 0.026081293555242673, 'NDCG*@10': 0.011210899267877852, 'MRR*@10': 0.006857570238588821, 'Recall*@5': 0.011299518092224995, 'NDCG*@5': 0.0064844888457584945, 'MRR*@5': 0.004937384643458894}
INFO    [05-04 22:12:59] train in BasicTrainer:
duration: 46.09021759033203s
INFO    [05-04 22:12:59] train in BasicTrainer:
epoch: 15
INFO    [05-04 22:13:22] _train_one_epoch in BasicTrainer:
loss = 5.164255653728138
INFO    [05-04 22:13:47] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-04 22:13:47] validate in BasicTrainer:
{'Recall@10': 0.030578071340208964, 'NDCG@10': 0.013146561260024706, 'MRR@10': 0.008020625760157904, 'Recall@5': 0.013073050638749487, 'NDCG@5': 0.0075242290095913975, 'MRR@5': 0.005722342358369913, 'Recall*@10': 0.028750684733192127, 'NDCG*@10': 0.012288481218829042, 'MRR*@10': 0.00745770696639305, 'Recall*@5': 0.01218730920837039, 'NDCG*@5': 0.006951622797974518, 'MRR*@5': 0.005266277474306878}
INFO    [05-04 22:13:47] train in BasicTrainer:
duration: 48.5696907043457s
INFO    [05-04 22:13:47] train in BasicTrainer:
epoch: 16
INFO    [05-04 22:14:09] _train_one_epoch in BasicTrainer:
loss = 5.1385532292452725
INFO    [05-04 22:14:33] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-04 22:14:33] validate in BasicTrainer:
{'Recall@10': 0.03175719774195126, 'NDCG@10': 0.013546158249179522, 'MRR@10': 0.008197622484571877, 'Recall@5': 0.01328980177640915, 'NDCG@5': 0.007611944584087247, 'MRR@5': 0.005770329785134111, 'Recall*@10': 0.02994080295874959, 'NDCG*@10': 0.012694536353505793, 'MRR*@10': 0.007641017414806854, 'Recall*@5': 0.012481982864084699, 'NDCG*@5': 0.007080953146907545, 'MRR*@5': 0.005342863455769562}
INFO    [05-04 22:14:33] train in BasicTrainer:
duration: 45.58451771736145s
INFO    [05-04 22:14:33] train in BasicTrainer:
epoch: 17
INFO    [05-04 22:14:55] _train_one_epoch in BasicTrainer:
loss = 5.115477783029729
INFO    [05-04 22:15:20] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-04 22:15:21] validate in BasicTrainer:
{'Recall@10': 0.033496921261151634, 'NDCG@10': 0.014185704556959016, 'MRR@10': 0.008526963425711506, 'Recall@5': 0.014007248161804108, 'NDCG@5': 0.007960476069932892, 'MRR@5': 0.006002368427635659, 'Recall*@10': 0.03201437954391752, 'NDCG*@10': 0.013518543426124822, 'MRR*@10': 0.008098981010594539, 'Recall*@5': 0.013742138321201006, 'NDCG*@5': 0.007666765556981166, 'MRR*@5': 0.005716565375526746}
INFO    [05-04 22:15:21] train in BasicTrainer:
duration: 47.547924280166626s
INFO    [05-04 22:15:21] train in BasicTrainer:
epoch: 18
DEBUG   [05-04 22:15:25] calculate_loss in loss:
soft_target max: 0.646086573600769, argmax 679949
DEBUG   [05-04 22:15:25] calculate_loss in loss:
pred max in softmax: 0.3596203029155731, argmax 13553981
DEBUG   [05-04 22:15:25] calculate_loss in loss:
soft_target max: 0.646086573600769, argmax 5181653
DEBUG   [05-04 22:15:25] calculate_loss in loss:
pred max in softmax: 0.4680244028568268, argmax 82404809
INFO    [05-04 22:15:42] _train_one_epoch in BasicTrainer:
loss = 5.093536996841431
INFO    [05-04 22:16:06] log in loggers:
Update Best NDCG@10 Model at 18
INFO    [05-04 22:16:06] validate in BasicTrainer:
{'Recall@10': 0.03442284287441345, 'NDCG@10': 0.01465332969313576, 'MRR@10': 0.008842377989952053, 'Recall@5': 0.014805286501844725, 'NDCG@5': 0.00835679458188159, 'MRR@5': 0.0062712581074308785, 'Recall*@10': 0.03250353091529438, 'NDCG*@10': 0.01378788435388179, 'MRR*@10': 0.00829809664615563, 'Recall*@5': 0.013816421097587971, 'NDCG*@5': 0.007783878084626936, 'MRR*@5': 0.005842731644709905}
INFO    [05-04 22:16:06] train in BasicTrainer:
duration: 45.47902989387512s
INFO    [05-04 22:16:06] train in BasicTrainer:
epoch: 19
INFO    [05-04 22:16:28] _train_one_epoch in BasicTrainer:
loss = 5.072992918708108
INFO    [05-04 22:16:53] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-04 22:16:53] validate in BasicTrainer:
{'Recall@10': 0.03491112412441345, 'NDCG@10': 0.014812224677630834, 'MRR@10': 0.008907973899372987, 'Recall@5': 0.014514642900654249, 'NDCG@5': 0.008257266289244095, 'MRR@5': 0.0062261903215022315, 'Recall*@10': 0.033965354607928364, 'NDCG*@10': 0.014245716189699513, 'MRR*@10': 0.008471710430014701, 'Recall*@5': 0.01374829870959123, 'NDCG*@5': 0.007749524455340136, 'MRR*@5': 0.005814557141136555}
INFO    [05-04 22:16:53] train in BasicTrainer:
duration: 47.04598331451416s
INFO    [05-04 22:16:53] train in BasicTrainer:
epoch: 20
INFO    [05-04 22:17:15] _train_one_epoch in BasicTrainer:
loss = 5.054822141473943
INFO    [05-04 22:17:39] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-04 22:17:39] validate in BasicTrainer:
{'Recall@10': 0.036698138962189354, 'NDCG@10': 0.015379030479206926, 'MRR@10': 0.009138036452765976, 'Recall@5': 0.015057703036637534, 'NDCG@5': 0.008475137098381916, 'MRR@5': 0.006343800818458909, 'Recall*@10': 0.035198157298422995, 'NDCG*@10': 0.014713948947333154, 'MRR*@10': 0.008729062774883849, 'Recall*@5': 0.014183023900148414, 'NDCG*@5': 0.007999742957985117, 'MRR*@5': 0.0060058545897759144}
INFO    [05-04 22:17:39] train in BasicTrainer:
duration: 45.932952880859375s
INFO    [05-04 22:17:39] train in BasicTrainer:
epoch: 21
INFO    [05-04 22:18:00] _train_one_epoch in BasicTrainer:
loss = 5.036880891973322
INFO    [05-04 22:18:24] validate in BasicTrainer:
{'Recall@10': 0.03668237513019925, 'NDCG@10': 0.015252614482527687, 'MRR@10': 0.008985893357367743, 'Recall@5': 0.014317005251844725, 'NDCG@5': 0.00807703984901309, 'MRR@5': 0.006057702437309282, 'Recall*@10': 0.035065959252062295, 'NDCG*@10': 0.014546050246627558, 'MRR*@10': 0.008544770135943378, 'Recall*@5': 0.01392113772176561, 'NDCG*@5': 0.007741615242723908, 'MRR*@5': 0.005755849692615725}
INFO    [05-04 22:18:24] train in BasicTrainer:
duration: 45.25459027290344s
INFO    [05-04 22:18:24] train in BasicTrainer:
epoch: 22
INFO    [05-04 22:18:47] _train_one_epoch in BasicTrainer:
loss = 5.01880746754733
INFO    [05-04 22:19:12] log in loggers:
Update Best NDCG@10 Model at 22
INFO    [05-04 22:19:13] validate in BasicTrainer:
{'Recall@10': 0.037995296042589916, 'NDCG@10': 0.015887181806777204, 'MRR@10': 0.009407672698476486, 'Recall@5': 0.01521218754351139, 'NDCG@5': 0.008571490179747343, 'MRR@5': 0.00641868185872833, 'Recall*@10': 0.03691069843868414, 'NDCG*@10': 0.01539791277831509, 'MRR*@10': 0.009098668006204423, 'Recall*@5': 0.014881599295352186, 'NDCG*@5': 0.008317563771491959, 'MRR*@5': 0.006201889454608872}
INFO    [05-04 22:19:13] train in BasicTrainer:
duration: 48.26625990867615s
INFO    [05-04 22:19:13] train in BasicTrainer:
epoch: 23
INFO    [05-04 22:19:34] _train_one_epoch in BasicTrainer:
loss = 5.001275313984264
INFO    [05-04 22:19:58] log in loggers:
Update Best NDCG@10 Model at 23
INFO    [05-04 22:19:58] validate in BasicTrainer:
{'Recall@10': 0.0407397598028183, 'NDCG@10': 0.016918427976114408, 'MRR@10': 0.009958303600017513, 'Recall@5': 0.01596786090660663, 'NDCG@5': 0.009007923127639861, 'MRR@5': 0.006751673961324351, 'Recall*@10': 0.03877756061653296, 'NDCG*@10': 0.016152684133322465, 'MRR*@10': 0.009536829267051957, 'Recall*@5': 0.015533714954342161, 'NDCG*@5': 0.00870216688850806, 'MRR*@5': 0.006499899041262411}
INFO    [05-04 22:19:58] train in BasicTrainer:
duration: 45.53599786758423s
INFO    [05-04 22:19:58] train in BasicTrainer:
epoch: 24
INFO    [05-04 22:20:20] _train_one_epoch in BasicTrainer:
loss = 4.984560051831332
INFO    [05-04 22:20:46] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-04 22:20:46] validate in BasicTrainer:
{'Recall@10': 0.041453068277665546, 'NDCG@10': 0.017351375937107064, 'MRR@10': 0.010288972451928117, 'Recall@5': 0.01633988471613044, 'NDCG@5': 0.009276967894818102, 'MRR@5': 0.0069832200894043555, 'Recall*@10': 0.04032750019714946, 'NDCG*@10': 0.01683342665256489, 'MRR*@10': 0.00995865065072264, 'Recall*@5': 0.01607894560410863, 'NDCG*@5': 0.009047144026096379, 'MRR*@5': 0.006776992741617418}
INFO    [05-04 22:20:46] train in BasicTrainer:
duration: 47.874820947647095s
INFO    [05-04 22:20:46] train in BasicTrainer:
epoch: 25
INFO    [05-04 22:21:07] _train_one_epoch in BasicTrainer:
loss = 4.968763108686967
INFO    [05-04 22:21:31] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-04 22:21:32] validate in BasicTrainer:
{'Recall@10': 0.04346511016289393, 'NDCG@10': 0.01805909505734841, 'MRR@10': 0.010613078828014079, 'Recall@5': 0.016630528317320915, 'NDCG@5': 0.009383368084118479, 'MRR@5': 0.007033404539383593, 'Recall*@10': 0.04208134061523846, 'NDCG*@10': 0.017450626318653423, 'MRR*@10': 0.010240740807993072, 'Recall*@5': 0.01617193834057876, 'NDCG*@5': 0.009070057355399643, 'MRR*@5': 0.00678010754996822}
INFO    [05-04 22:21:32] train in BasicTrainer:
duration: 45.68409013748169s
INFO    [05-04 22:21:32] train in BasicTrainer:
epoch: 26
INFO    [05-04 22:21:53] _train_one_epoch in BasicTrainer:
loss = 4.953935917941007
INFO    [05-04 22:22:17] validate in BasicTrainer:
{'Recall@10': 0.042824906075284594, 'NDCG@10': 0.017808469278471812, 'MRR@10': 0.010496176956664948, 'Recall@5': 0.01618875004351139, 'NDCG@5': 0.009247890008347375, 'MRR@5': 0.006994008374888273, 'Recall*@10': 0.04146736948972657, 'NDCG*@10': 0.017262369882138, 'MRR*@10': 0.010191056079098157, 'Recall*@5': 0.015797844023576806, 'NDCG*@5': 0.008997881563291663, 'MRR*@5': 0.006801585955101819}
INFO    [05-04 22:22:17] train in BasicTrainer:
duration: 45.16983246803284s
INFO    [05-04 22:22:17] train in BasicTrainer:
epoch: 27
DEBUG   [05-04 22:22:24] calculate_loss in loss:
soft_target max: 0.646086573600769, argmax 13932629
DEBUG   [05-04 22:22:24] calculate_loss in loss:
pred max in softmax: 0.4754479229450226, argmax 75568109
DEBUG   [05-04 22:22:24] calculate_loss in loss:
soft_target max: 0.646086573600769, argmax 24050945
DEBUG   [05-04 22:22:24] calculate_loss in loss:
pred max in softmax: 0.4805649518966675, argmax 74011445
INFO    [05-04 22:22:39] _train_one_epoch in BasicTrainer:
loss = 4.940851293910633
INFO    [05-04 22:23:05] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-04 22:23:05] validate in BasicTrainer:
{'Recall@10': 0.045476363883132025, 'NDCG@10': 0.018985105412346975, 'MRR@10': 0.011238744748490197, 'Recall@5': 0.01752984860823268, 'NDCG@5': 0.010016061542999177, 'MRR@5': 0.007577285636216402, 'Recall*@10': 0.044006528421526865, 'NDCG*@10': 0.01843995623113144, 'MRR*@10': 0.010962510392779396, 'Recall*@5': 0.01728040822559879, 'NDCG*@5': 0.009849414805926028, 'MRR*@5': 0.00744749213169728}
INFO    [05-04 22:23:05] train in BasicTrainer:
duration: 48.65893054008484s
INFO    [05-04 22:23:05] train in BasicTrainer:
epoch: 28
INFO    [05-04 22:23:27] _train_one_epoch in BasicTrainer:
loss = 4.928619280728427
INFO    [05-04 22:23:51] log in loggers:
Update Best NDCG@10 Model at 28
INFO    [05-04 22:23:51] validate in BasicTrainer:
{'Recall@10': 0.04590237850234622, 'NDCG@10': 0.019211251909534138, 'MRR@10': 0.011379805437865712, 'Recall@5': 0.018580303483066104, 'NDCG@5': 0.010421545266927708, 'MRR@5': 0.0077790155164187864, 'Recall*@10': 0.044424389267251604, 'NDCG*@10': 0.01861323673455488, 'MRR*@10': 0.01104572220217614, 'Recall*@5': 0.018155020617303393, 'NDCG*@5': 0.010159720999321767, 'MRR*@5': 0.00758095970377326}
INFO    [05-04 22:23:51] train in BasicTrainer:
duration: 45.57506322860718s
INFO    [05-04 22:23:51] train in BasicTrainer:
epoch: 29
INFO    [05-04 22:24:13] _train_one_epoch in BasicTrainer:
loss = 4.9174755529923875
INFO    [05-04 22:24:38] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-04 22:24:39] validate in BasicTrainer:
{'Recall@10': 0.04641056131748926, 'NDCG@10': 0.019332853456338246, 'MRR@10': 0.011392608018858092, 'Recall@5': 0.0182738962272803, 'NDCG@5': 0.010271623641962097, 'MRR@5': 0.007674629999590772, 'Recall*@10': 0.0450930797627994, 'NDCG*@10': 0.018712308701305164, 'MRR*@10': 0.010984083415851706, 'Recall*@5': 0.017752757473360924, 'NDCG*@5': 0.009896994413187107, 'MRR*@5': 0.007360602839894238}
INFO    [05-04 22:24:39] train in BasicTrainer:
duration: 47.569899797439575s
INFO    [05-04 22:24:39] train in BasicTrainer:
epoch: 30
INFO    [05-04 22:25:00] _train_one_epoch in BasicTrainer:
loss = 4.905656519803133
INFO    [05-04 22:25:24] log in loggers:
Update Best NDCG@10 Model at 30
INFO    [05-04 22:25:24] validate in BasicTrainer:
{'Recall@10': 0.047937671698275064, 'NDCG@10': 0.02010715211785975, 'MRR@10': 0.011936666266549201, 'Recall@5': 0.019739528142270587, 'NDCG@5': 0.01103788951323146, 'MRR@5': 0.008222343910130717, 'Recall*@10': 0.04688654165892374, 'NDCG*@10': 0.019628614453332766, 'MRR*@10': 0.0116350171821458, 'Recall*@5': 0.01913247856178454, 'NDCG*@5': 0.01068763401625412, 'MRR*@5': 0.007964817208370991}
INFO    [05-04 22:25:24] train in BasicTrainer:
duration: 45.690359354019165s
INFO    [05-04 22:25:24] train in BasicTrainer:
epoch: 31
INFO    [05-04 22:25:47] _train_one_epoch in BasicTrainer:
loss = 4.8949985244057395
INFO    [05-04 22:26:12] validate in BasicTrainer:
{'Recall@10': 0.046998548188379834, 'NDCG@10': 0.019553203047031446, 'MRR@10': 0.01151032435397307, 'Recall@5': 0.01840926715660663, 'NDCG@5': 0.01033570533174844, 'MRR@5': 0.007722036092586461, 'Recall*@10': 0.045700308467660634, 'NDCG*@10': 0.019032029435038567, 'MRR*@10': 0.01121747356262945, 'Recall*@5': 0.01792700189564909, 'NDCG*@5': 0.010050813689650525, 'MRR*@5': 0.00751089584082365}
INFO    [05-04 22:26:12] train in BasicTrainer:
duration: 48.034629583358765s
INFO    [05-04 22:26:12] train in BasicTrainer:
epoch: 32
INFO    [05-04 22:26:33] _train_one_epoch in BasicTrainer:
loss = 4.885256086696278
INFO    [05-04 22:26:57] validate in BasicTrainer:
{'Recall@10': 0.047863779323441644, 'NDCG@10': 0.019990559933441027, 'MRR@10': 0.011809669922859896, 'Recall@5': 0.019386617910294307, 'NDCG@5': 0.01083102733606384, 'MRR@5': 0.008057859260588884, 'Recall*@10': 0.04685270325058982, 'NDCG*@10': 0.019622889214328358, 'MRR*@10': 0.011632925786432765, 'Recall*@5': 0.019103810900733584, 'NDCG*@5': 0.01068816070134441, 'MRR*@5': 0.00796779484621116}
INFO    [05-04 22:26:57] train in BasicTrainer:
duration: 45.11863899230957s
INFO    [05-04 22:26:57] train in BasicTrainer:
epoch: 33
INFO    [05-04 22:27:19] _train_one_epoch in BasicTrainer:
loss = 4.875596596977927
INFO    [05-04 22:27:43] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-04 22:27:43] validate in BasicTrainer:
{'Recall@10': 0.049886658787727356, 'NDCG@10': 0.021067792106242406, 'MRR@10': 0.012609792873263359, 'Recall@5': 0.020328303178151447, 'NDCG@5': 0.011559796209136644, 'MRR@5': 0.008715354260944184, 'Recall*@10': 0.048843832775240854, 'NDCG*@10': 0.020630670179213797, 'MRR*@10': 0.012359072276878925, 'Recall*@5': 0.019738170273956798, 'NDCG*@5': 0.011248155230922359, 'MRR*@5': 0.008503392360927094}
INFO    [05-04 22:27:43] train in BasicTrainer:
duration: 45.51601028442383s
INFO    [05-04 22:27:43] train in BasicTrainer:
epoch: 34
INFO    [05-04 22:28:06] _train_one_epoch in BasicTrainer:
loss = 4.866075121272694
INFO    [05-04 22:28:31] validate in BasicTrainer:
{'Recall@10': 0.048789700936703456, 'NDCG@10': 0.020362273656896183, 'MRR@10': 0.012037854109491621, 'Recall@5': 0.019530264749413447, 'NDCG@5': 0.010991127673713933, 'MRR@5': 0.00822332896114815, 'Recall*@10': 0.04783787436428524, 'NDCG*@10': 0.019898698532155583, 'MRR*@10': 0.011722888176639875, 'Recall*@5': 0.018941697442815417, 'NDCG*@5': 0.010623113252222538, 'MRR*@5': 0.007935270733599151}
INFO    [05-04 22:28:31] train in BasicTrainer:
duration: 48.420148611068726s
INFO    [05-04 22:28:31] train in BasicTrainer:
epoch: 35
INFO    [05-04 22:28:53] _train_one_epoch in BasicTrainer:
loss = 4.857377810911699
INFO    [05-04 22:29:17] validate in BasicTrainer:
{'Recall@10': 0.04906536887089411, 'NDCG@10': 0.020439319489967255, 'MRR@10': 0.01204688980111054, 'Recall@5': 0.019424844887994584, 'NDCG@5': 0.01089459125484739, 'MRR@5': 0.00813094029823939, 'Recall*@10': 0.047578140383674986, 'NDCG*@10': 0.0199350623325223, 'MRR*@10': 0.011825321552654108, 'Recall*@5': 0.019215972473224003, 'NDCG*@5': 0.01077189278744516, 'MRR*@5': 0.008048438067947115}
INFO    [05-04 22:29:17] train in BasicTrainer:
duration: 45.45219039916992s
INFO    [05-04 22:29:17] train in BasicTrainer:
epoch: 36
DEBUG   [05-04 22:29:25] calculate_loss in loss:
soft_target max: 0.646086573600769, argmax 13112225
DEBUG   [05-04 22:29:25] calculate_loss in loss:
pred max in softmax: 0.5459217429161072, argmax 26617337
DEBUG   [05-04 22:29:26] calculate_loss in loss:
soft_target max: 0.646086573600769, argmax 15194789
DEBUG   [05-04 22:29:26] calculate_loss in loss:
pred max in softmax: 0.5488806962966919, argmax 23861621
INFO    [05-04 22:29:39] _train_one_epoch in BasicTrainer:
loss = 4.846785120530562
INFO    [05-04 22:30:04] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-04 22:30:04] validate in BasicTrainer:
{'Recall@10': 0.05024291894265583, 'NDCG@10': 0.021111998352266494, 'MRR@10': 0.012555652120638462, 'Recall@5': 0.02083648599329449, 'NDCG@5': 0.011676480284049398, 'MRR@5': 0.00870401742646382, 'Recall*@10': 0.048862263382900326, 'NDCG*@10': 0.020544287260799182, 'MRR*@10': 0.012228308334237053, 'Recall*@5': 0.020337696896777266, 'NDCG*@5': 0.011366388937901883, 'MRR*@5': 0.008467028871001233}
INFO    [05-04 22:30:04] train in BasicTrainer:
duration: 47.58659219741821s
INFO    [05-04 22:30:04] train in BasicTrainer:
epoch: 37
INFO    [05-04 22:30:26] _train_one_epoch in BasicTrainer:
loss = 4.836725980585272
INFO    [05-04 22:30:50] validate in BasicTrainer:
{'Recall@10': 0.05008764635948908, 'NDCG@10': 0.02108544661175637, 'MRR@10': 0.0125842010602355, 'Recall@5': 0.020491063594818115, 'NDCG@5': 0.011585215195303871, 'MRR@5': 0.008704388469812415, 'Recall*@10': 0.04936573814068522, 'NDCG*@10': 0.02075056971183845, 'MRR*@10': 0.012377394939817134, 'Recall*@5': 0.019772845852587904, 'NDCG*@5': 0.011236453517561867, 'MRR*@5': 0.008482838116054024}
INFO    [05-04 22:30:50] train in BasicTrainer:
duration: 45.8387610912323s
INFO    [05-04 22:30:50] train in BasicTrainer:
epoch: 38
INFO    [05-04 22:31:12] _train_one_epoch in BasicTrainer:
loss = 4.827621893449263
INFO    [05-04 22:31:37] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-04 22:31:37] validate in BasicTrainer:
{'Recall@10': 0.05142125700201307, 'NDCG@10': 0.021552071330093202, 'MRR@10': 0.01279033933367048, 'Recall@5': 0.020530078737508683, 'NDCG@5': 0.01159109374774354, 'MRR@5': 0.00869582345088323, 'Recall*@10': 0.05055745903934751, 'NDCG*@10': 0.02120988354796455, 'MRR*@10': 0.012607479246244543, 'Recall*@5': 0.02013704331503028, 'NDCG*@5': 0.011379546131051722, 'MRR*@5': 0.008553904436883471}
INFO    [05-04 22:31:37] train in BasicTrainer:
duration: 46.910035133361816s
INFO    [05-04 22:31:37] train in BasicTrainer:
epoch: 39
INFO    [05-04 22:31:58] _train_one_epoch in BasicTrainer:
loss = 4.817870096726851
INFO    [05-04 22:32:23] log in loggers:
Update Best NDCG@10 Model at 39
INFO    [05-04 22:32:23] validate in BasicTrainer:
{'Recall@10': 0.05273496607939402, 'NDCG@10': 0.022435191663957778, 'MRR@10': 0.013533235838015875, 'Recall@5': 0.022239063112508683, 'NDCG@5': 0.012633471040143854, 'MRR@5': 0.00952326792425343, 'Recall*@10': 0.0512866752133483, 'NDCG*@10': 0.021865593712954295, 'MRR*@10': 0.013226873995292755, 'Recall*@5': 0.021768107921594664, 'NDCG*@5': 0.01236228755719605, 'MRR*@5': 0.009329355343998898}
INFO    [05-04 22:32:23] train in BasicTrainer:
duration: 45.695353746414185s
INFO    [05-04 22:32:23] train in BasicTrainer:
epoch: 40
INFO    [05-04 22:32:44] _train_one_epoch in BasicTrainer:
loss = 4.808346171812578
INFO    [05-04 22:33:09] validate in BasicTrainer:
{'Recall@10': 0.053214971508298604, 'NDCG@10': 0.022056822798081806, 'MRR@10': 0.012946148447337606, 'Recall@5': 0.02053756657100859, 'NDCG@5': 0.011566019306580225, 'MRR@5': 0.008660388068251666, 'Recall*@10': 0.052633173763751984, 'NDCG*@10': 0.02176776049392564, 'MRR*@10': 0.012753884795875777, 'Recall*@5': 0.02020286786414328, 'NDCG*@5': 0.011345595919660159, 'MRR*@5': 0.008489503835638365}
INFO    [05-04 22:33:09] train in BasicTrainer:
duration: 46.4101824760437s
INFO    [05-04 22:33:09] train in BasicTrainer:
epoch: 41
INFO    [05-04 22:33:32] _train_one_epoch in BasicTrainer:
loss = 4.799346962842074
INFO    [05-04 22:33:57] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-04 22:33:57] validate in BasicTrainer:
{'Recall@10': 0.053959807114941735, 'NDCG@10': 0.02255448299859251, 'MRR@10': 0.013343707480955692, 'Recall@5': 0.021584671700284594, 'NDCG@5': 0.012112111030589966, 'MRR@5': 0.00905012647576985, 'Recall*@10': 0.05336945042723701, 'NDCG*@10': 0.022279916065079824, 'MRR*@10': 0.013174752882193951, 'Recall*@5': 0.02094093949667045, 'NDCG*@5': 0.011795314073207833, 'MRR*@5': 0.008849058987661487}
INFO    [05-04 22:33:57] train in BasicTrainer:
duration: 47.828904151916504s
INFO    [05-04 22:33:57] train in BasicTrainer:
epoch: 42
INFO    [05-04 22:34:18] _train_one_epoch in BasicTrainer:
loss = 4.789206899296154
INFO    [05-04 22:34:42] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-04 22:34:42] validate in BasicTrainer:
{'Recall@10': 0.055719432731469475, 'NDCG@10': 0.02350607452293237, 'MRR@10': 0.014053094910369032, 'Recall@5': 0.022568721856389726, 'NDCG@5': 0.01281603044342427, 'MRR@5': 0.009658500818269593, 'Recall*@10': 0.0548586371753897, 'NDCG*@10': 0.02315978581706683, 'MRR*@10': 0.013864879141606036, 'Recall*@5': 0.022216113018138067, 'NDCG*@5': 0.012611292435654573, 'MRR*@5': 0.009515251476495038}
INFO    [05-04 22:34:42] train in BasicTrainer:
duration: 45.41090512275696s
INFO    [05-04 22:34:42] train in BasicTrainer:
epoch: 43
INFO    [05-04 22:35:05] _train_one_epoch in BasicTrainer:
loss = 4.780958864905617
INFO    [05-04 22:35:30] validate in BasicTrainer:
{'Recall@10': 0.055013611912727356, 'NDCG@10': 0.023235916913974853, 'MRR@10': 0.01389587852394297, 'Recall@5': 0.0230412394517944, 'NDCG@5': 0.012939221890909331, 'MRR@5': 0.0096705043466673, 'Recall*@10': 0.05504217335865611, 'NDCG*@10': 0.02323053138596671, 'MRR*@10': 0.013892605900764465, 'Recall*@5': 0.02279383476291384, 'NDCG*@5': 0.012829187281784556, 'MRR*@5': 0.009614984926191113}
INFO    [05-04 22:35:30] train in BasicTrainer:
duration: 47.48599052429199s
INFO    [05-04 22:35:30] train in BasicTrainer:
epoch: 44
INFO    [05-04 22:35:51] _train_one_epoch in BasicTrainer:
loss = 4.771960167451338
INFO    [05-04 22:36:15] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-04 22:36:15] validate in BasicTrainer:
{'Recall@10': 0.05595943509113221, 'NDCG@10': 0.023794893618850482, 'MRR@10': 0.014354858015264784, 'Recall@5': 0.022781335172199067, 'NDCG@5': 0.013121649223778929, 'MRR@5': 0.009983194060623646, 'Recall*@10': 0.05540396450530915, 'NDCG*@10': 0.02359761723450252, 'MRR*@10': 0.0142660103294821, 'Recall*@5': 0.022657378709742, 'NDCG*@5': 0.013042056267814977, 'MRR*@5': 0.009929515687482697}
INFO    [05-04 22:36:15] train in BasicTrainer:
duration: 45.512993574142456s
INFO    [05-04 22:36:15] train in BasicTrainer:
epoch: 45
DEBUG   [05-04 22:36:26] calculate_loss in loss:
soft_target max: 0.646086573600769, argmax 2383865
DEBUG   [05-04 22:36:26] calculate_loss in loss:
pred max in softmax: 0.48892098665237427, argmax 36209753
DEBUG   [05-04 22:36:26] calculate_loss in loss:
soft_target max: 0.646086573600769, argmax 4929221
DEBUG   [05-04 22:36:26] calculate_loss in loss:
pred max in softmax: 0.5485637784004211, argmax 12281737
INFO    [05-04 22:36:37] _train_one_epoch in BasicTrainer:
loss = 4.763380722566084
INFO    [05-04 22:37:01] validate in BasicTrainer:
{'Recall@10': 0.05587056740408852, 'NDCG@10': 0.023499249879802977, 'MRR@10': 0.01399670931554976, 'Recall@5': 0.02238605987458002, 'NDCG@5': 0.012678453654405616, 'MRR@5': 0.009534956022564853, 'Recall*@10': 0.055416143721058256, 'NDCG*@10': 0.023263758403204736, 'MRR*@10': 0.013837469076471669, 'Recall*@5': 0.022049791046551297, 'NDCG*@5': 0.012470673281876813, 'MRR*@5': 0.00938074720934743}
INFO    [05-04 22:37:01] train in BasicTrainer:
duration: 45.20802044868469s
INFO    [05-04 22:37:01] train in BasicTrainer:
epoch: 46
INFO    [05-04 22:37:23] _train_one_epoch in BasicTrainer:
loss = 4.755670469457453
INFO    [05-04 22:37:48] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-04 22:37:49] validate in BasicTrainer:
{'Recall@10': 0.05838921559708459, 'NDCG@10': 0.024619697637501218, 'MRR@10': 0.01472866783539454, 'Recall@5': 0.023463115983066104, 'NDCG@5': 0.0134018739862811, 'MRR@5': 0.010142736092564605, 'Recall*@10': 0.05832030233882722, 'NDCG*@10': 0.02459481722187428, 'MRR*@10': 0.014723991886490867, 'Recall*@5': 0.02343561943797838, 'NDCG*@5': 0.013374413940168563, 'MRR*@5': 0.010127227465134291}
INFO    [05-04 22:37:49] train in BasicTrainer:
duration: 47.9711799621582s
INFO    [05-04 22:37:49] train in BasicTrainer:
epoch: 47
INFO    [05-04 22:38:10] _train_one_epoch in BasicTrainer:
loss = 4.74718072197654
INFO    [05-04 22:38:34] validate in BasicTrainer:
{'Recall@10': 0.0579980785648028, 'NDCG@10': 0.024475428231415294, 'MRR@10': 0.014645332293141456, 'Recall@5': 0.023160846637828008, 'NDCG@5': 0.013253099506809599, 'MRR@5': 0.010039073326403187, 'Recall*@10': 0.057779786842209954, 'NDCG*@10': 0.02438243203574703, 'MRR*@10': 0.014605147453645865, 'Recall*@5': 0.022964824878034137, 'NDCG*@5': 0.013174110491360937, 'MRR*@5': 0.010007779579609632}
INFO    [05-04 22:38:34] train in BasicTrainer:
duration: 45.59758186340332s
INFO    [05-04 22:38:34] train in BasicTrainer:
epoch: 48
INFO    [05-04 22:38:56] _train_one_epoch in BasicTrainer:
loss = 4.738620719042691
INFO    [05-04 22:39:22] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-04 22:39:22] validate in BasicTrainer:
{'Recall@10': 0.05885089579082671, 'NDCG@10': 0.024888757261491957, 'MRR@10': 0.014918604422183264, 'Recall@5': 0.023959673231556303, 'NDCG@5': 0.013646594692199003, 'MRR@5': 0.010302665465999217, 'Recall*@10': 0.05887825166185697, 'NDCG*@10': 0.02484851951400439, 'MRR*@10': 0.014866975091752551, 'Recall*@5': 0.023924279337128002, 'NDCG*@5': 0.013565902775597004, 'MRR*@5': 0.010222612658426874}
INFO    [05-04 22:39:22] train in BasicTrainer:
duration: 47.74681544303894s
INFO    [05-04 22:39:22] train in BasicTrainer:
epoch: 49
INFO    [05-04 22:39:43] _train_one_epoch in BasicTrainer:
loss = 4.731754519722679
INFO    [05-04 22:40:07] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-04 22:40:07] validate in BasicTrainer:
{'Recall@10': 0.05926942257654099, 'NDCG@10': 0.02515800731877486, 'MRR@10': 0.015133901100073541, 'Recall@5': 0.02495199938615163, 'NDCG@5': 0.014122052118182182, 'MRR@5': 0.010614685669896148, 'Recall*@10': 0.059561661311558316, 'NDCG*@10': 0.025187159045821146, 'MRR*@10': 0.015101316961504165, 'Recall*@5': 0.024884157503644627, 'NDCG*@5': 0.014029297135060742, 'MRR*@5': 0.0105283193378931}
INFO    [05-04 22:40:07] train in BasicTrainer:
duration: 45.33791542053223s
INFO    [05-04 22:40:07] train in BasicTrainer:
epoch: 50
INFO    [05-04 22:40:29] _train_one_epoch in BasicTrainer:
loss = 4.723443534157493
INFO    [05-04 22:40:55] log in loggers:
Update Best NDCG@10 Model at 50
INFO    [05-04 22:40:55] validate in BasicTrainer:
{'Recall@10': 0.059599081320422034, 'NDCG@10': 0.025287078161324774, 'MRR@10': 0.01521369047640335, 'Recall@5': 0.024393175506875628, 'NDCG@5': 0.01395317069476559, 'MRR@5': 0.010565312224484626, 'Recall*@10': 0.06020855406920115, 'NDCG*@10': 0.02546578042563938, 'MRR*@10': 0.015278882302698634, 'Recall*@5': 0.024459008482240495, 'NDCG*@5': 0.013944057570326896, 'MRR*@5': 0.01054565439976397}
INFO    [05-04 22:40:55] train in BasicTrainer:
duration: 47.457006216049194s
INFO    [05-04 22:40:55] train in BasicTrainer:
epoch: 51
INFO    [05-04 22:41:17] _train_one_epoch in BasicTrainer:
loss = 4.715012645721435
INFO    [05-04 22:41:42] validate in BasicTrainer:
{'Recall@10': 0.05941641933861233, 'NDCG@10': 0.025233950022430646, 'MRR@10': 0.015186645312323457, 'Recall@5': 0.025165400866951262, 'NDCG@5': 0.014228730418142817, 'MRR@5': 0.010685947324548448, 'Recall*@10': 0.059010877673115046, 'NDCG*@10': 0.025094393552059217, 'MRR*@10': 0.015132725992727847, 'Recall*@5': 0.02505660332029774, 'NDCG*@5': 0.014172163969349293, 'MRR*@5': 0.010658576508008298}
INFO    [05-04 22:41:42] train in BasicTrainer:
duration: 47.34513711929321s
INFO    [05-04 22:41:42] train in BasicTrainer:
epoch: 52
INFO    [05-04 22:42:04] _train_one_epoch in BasicTrainer:
loss = 4.707372179898349
INFO    [05-04 22:42:28] log in loggers:
Update Best NDCG@10 Model at 52
INFO    [05-04 22:42:28] validate in BasicTrainer:
{'Recall@10': 0.06023514732008889, 'NDCG@10': 0.025624580681324005, 'MRR@10': 0.015471920326706908, 'Recall@5': 0.02460657698767526, 'NDCG@5': 0.014155099035373755, 'MRR@5': 0.010768641096850237, 'Recall*@10': 0.05991057803233465, 'NDCG*@10': 0.025559591306816964, 'MRR*@10': 0.015480278015491507, 'Recall*@5': 0.02489258579555012, 'NDCG*@5': 0.014256345640335764, 'MRR*@5': 0.010827133387681983}
INFO    [05-04 22:42:28] train in BasicTrainer:
duration: 45.711278676986694s
INFO    [05-04 22:42:28] train in BasicTrainer:
epoch: 53
INFO    [05-04 22:42:51] _train_one_epoch in BasicTrainer:
loss = 4.699620931798761
INFO    [05-04 22:43:16] log in loggers:
Update Best NDCG@10 Model at 53
INFO    [05-04 22:43:16] validate in BasicTrainer:
{'Recall@10': 0.060311601630278995, 'NDCG@10': 0.025990210118747893, 'MRR@10': 0.015877964241164073, 'Recall@5': 0.02619595399924687, 'NDCG@5': 0.014987802354707605, 'MRR@5': 0.011354417495784305, 'Recall*@10': 0.06002981144757498, 'NDCG*@10': 0.02583294894014086, 'MRR*@10': 0.015766788894931476, 'Recall*@5': 0.026110918482854253, 'NDCG*@5': 0.014877078877318473, 'MRR*@5': 0.011252500205522492}
INFO    [05-04 22:43:16] train in BasicTrainer:
duration: 48.115124464035034s
INFO    [05-04 22:43:16] train in BasicTrainer:
epoch: 54
DEBUG   [05-04 22:43:28] calculate_loss in loss:
soft_target max: 0.646086573600769, argmax 1815893
DEBUG   [05-04 22:43:28] calculate_loss in loss:
pred max in softmax: 0.6166360378265381, argmax 42583661
DEBUG   [05-04 22:43:28] calculate_loss in loss:
soft_target max: 0.646086573600769, argmax 2446973
DEBUG   [05-04 22:43:28] calculate_loss in loss:
pred max in softmax: 0.5877843499183655, argmax 62441645
INFO    [05-04 22:43:37] _train_one_epoch in BasicTrainer:
loss = 4.693139479377053
INFO    [05-04 22:44:01] log in loggers:
Update Best NDCG@10 Model at 54
INFO    [05-04 22:44:02] validate in BasicTrainer:
{'Recall@10': 0.06163358652875537, 'NDCG@10': 0.026409635852490152, 'MRR@10': 0.01605628625977607, 'Recall@5': 0.025680283350603923, 'NDCG@5': 0.014810259365254924, 'MRR@5': 0.011285730815004735, 'Recall*@10': 0.06141927341620127, 'NDCG*@10': 0.026365744304798898, 'MRR*@10': 0.016065295519573346, 'Recall*@5': 0.025680670780794963, 'NDCG*@5': 0.01481075088183085, 'MRR*@5': 0.011298515567822116}
INFO    [05-04 22:44:02] train in BasicTrainer:
duration: 45.57092261314392s
INFO    [05-04 22:44:02] train in BasicTrainer:
epoch: 55
INFO    [05-04 22:44:24] _train_one_epoch in BasicTrainer:
loss = 4.68559720732949
INFO    [05-04 22:44:49] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [05-04 22:44:50] validate in BasicTrainer:
{'Recall@10': 0.06254867038556508, 'NDCG@10': 0.026832199788519313, 'MRR@10': 0.016345385417696975, 'Recall@5': 0.02617605243410383, 'NDCG@5': 0.015134375852843126, 'MRR@5': 0.011555188512873082, 'Recall*@10': 0.06289187801026162, 'NDCG*@10': 0.02694691682145709, 'MRR*@10': 0.016396593923370045, 'Recall*@5': 0.026405616441652888, 'NDCG*@5': 0.015189419411832378, 'MRR*@5': 0.011568337058027586}
INFO    [05-04 22:44:50] train in BasicTrainer:
duration: 47.97695803642273s
INFO    [05-04 22:44:50] train in BasicTrainer:
epoch: 56
INFO    [05-04 22:45:11] _train_one_epoch in BasicTrainer:
loss = 4.679177526994185
INFO    [05-04 22:45:35] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-04 22:45:35] validate in BasicTrainer:
{'Recall@10': 0.06260187320765995, 'NDCG@10': 0.026890864063586508, 'MRR@10': 0.016399380041375047, 'Recall@5': 0.02652896266608011, 'NDCG@5': 0.015276864658863772, 'MRR@5': 0.011636470178408282, 'Recall*@10': 0.06281275621482305, 'NDCG*@10': 0.02699455042325315, 'MRR*@10': 0.016472009454099906, 'Recall*@5': 0.026964748544352397, 'NDCG*@5': 0.01542721710921753, 'MRR*@5': 0.011713283180835702}
INFO    [05-04 22:45:35] train in BasicTrainer:
duration: 45.345893144607544s
INFO    [05-04 22:45:35] train in BasicTrainer:
epoch: 57
INFO    [05-04 22:45:56] _train_one_epoch in BasicTrainer:
loss = 4.671646668694236
INFO    [05-04 22:46:20] log in loggers:
Update Best NDCG@10 Model at 57
INFO    [05-04 22:46:21] validate in BasicTrainer:
{'Recall@10': 0.06411814583199364, 'NDCG@10': 0.027535748002784594, 'MRR@10': 0.01678309767019181, 'Recall@5': 0.02726138454108011, 'NDCG@5': 0.015669561079925017, 'MRR@5': 0.011916233537097773, 'Recall*@10': 0.06376725701349122, 'NDCG*@10': 0.02748169324227742, 'MRR*@10': 0.016817113251558373, 'Recall*@5': 0.02742044015654496, 'NDCG*@5': 0.015758758854298366, 'MRR*@5': 0.011997074731403873}
INFO    [05-04 22:46:21] train in BasicTrainer:
duration: 45.70495963096619s
INFO    [05-04 22:46:21] train in BasicTrainer:
epoch: 58
INFO    [05-04 22:46:43] _train_one_epoch in BasicTrainer:
loss = 4.665475567904386
INFO    [05-04 22:47:09] validate in BasicTrainer:
{'Recall@10': 0.06394375967127937, 'NDCG@10': 0.027492022851393336, 'MRR@10': 0.016788623340073087, 'Recall@5': 0.026959115195842015, 'NDCG@5': 0.015620896592736244, 'MRR@5': 0.011940496485857736, 'Recall*@10': 0.06376964031230836, 'NDCG*@10': 0.027484371548607237, 'MRR*@10': 0.01683000838827519, 'Recall*@5': 0.027412408962845802, 'NDCG*@5': 0.015804788275133996, 'MRR*@5': 0.012053990071373326}
INFO    [05-04 22:47:09] train in BasicTrainer:
duration: 48.10291337966919s
INFO    [05-04 22:47:09] train in BasicTrainer:
epoch: 59
INFO    [05-04 22:47:30] _train_one_epoch in BasicTrainer:
loss = 4.657411362908103
INFO    [05-04 22:47:54] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [05-04 22:47:54] validate in BasicTrainer:
{'Recall@10': 0.06505234326635088, 'NDCG@10': 0.028061769814008757, 'MRR@10': 0.0171882582030126, 'Recall@5': 0.027351040747903642, 'NDCG@5': 0.015909639320203235, 'MRR@5': 0.012195878839563756, 'Recall*@10': 0.0649723346744265, 'NDCG*@10': 0.02812982173193069, 'MRR*@10': 0.017300782592168877, 'Recall*@5': 0.02750269394545328, 'NDCG*@5': 0.016017100330264794, 'MRR*@5': 0.012303763512699377}
INFO    [05-04 22:47:54] train in BasicTrainer:
duration: 45.664990186691284s
INFO    [05-04 22:47:55] close_training in BasicTrainer:
finished training
DEBUG   [05-04 22:47:55] debug_summary in loss:
loss nan summary: nan 0 times, not nan 6601 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-04 22:47:55] run_routine in Routine:
Finished training, Start final validation
INFO    [05-04 22:47:55] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-04 22:47:55] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-04 22:47:55] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-04 22:48:20] validate in BasicTrainer:
{'Recall@10': 0.06505234326635088, 'NDCG@10': 0.028061769814008757, 'MRR@10': 0.0171882582030126, 'Recall@5': 0.027351040747903642, 'NDCG@5': 0.015909639320203235, 'MRR@5': 0.012195878839563756, 'Recall*@10': 0.0649723346744265, 'NDCG*@10': 0.02812982173193069, 'MRR*@10': 0.017300782592168877, 'Recall*@5': 0.02750269394545328, 'NDCG*@5': 0.016017100330264794, 'MRR*@5': 0.012303763512699377}
INFO    [05-04 22:48:20] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.06505234326635088, 'NDCG@10': 0.028061769814008757, 'MRR@10': 0.0171882582030126, 'Recall@5': 0.027351040747903642, 'NDCG@5': 0.015909639320203235, 'MRR@5': 0.012195878839563756, 'Recall*@10': 0.0649723346744265, 'NDCG*@10': 0.02812982173193069, 'MRR*@10': 0.017300782592168877, 'Recall*@5': 0.02750269394545328, 'NDCG*@5': 0.016017100330264794, 'MRR*@5': 0.012303763512699377}
INFO    [05-04 22:48:20] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-04 22:48:20] test in BasicTrainer:
Test model on test set!
INFO    [05-04 22:48:20] test_with_given_state_path in BasicTrainer:
Loading model params from ___movies_soft_2022/pop_narm-T-1.0-al-0.75_05-04_21:59_t3/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-04 22:48:20] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-04 22:48:20] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-04 22:48:20] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-04 22:48:44] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.05863335622208459, 'NDCG@10': 0.024720080551647004, 'MRR@10': 0.014801829787237304, 'Recall@5': 0.022385271620892343, 'NDCG@5': 0.01304366710107951, 'MRR@5': 0.01000928639301232, 'Recall*@10': 0.06014256214811688, 'NDCG*@10': 0.025469042094690458, 'MRR*@10': 0.01532999160034316, 'Recall*@5': 0.022824909538030624, 'NDCG*@5': 0.013429628995557627, 'MRR*@5': 0.010377669086058935}
INFO    [05-04 22:48:44] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.05863335622208459, 'NDCG@10': 0.024720080551647004, 'MRR@10': 0.014801829787237304, 'Recall@5': 0.022385271620892343, 'NDCG@5': 0.01304366710107951, 'MRR@5': 0.01000928639301232, 'Recall*@10': 0.06014256214811688, 'NDCG*@10': 0.025469042094690458, 'MRR*@10': 0.01532999160034316, 'Recall*@5': 0.022824909538030624, 'NDCG*@5': 0.013429628995557627, 'MRR*@5': 0.010377669086058935}
