INFO    [05-25 14:46:58] setup_train in utils:
{
    "experiment_dir": "___ablation_movies_ed_test_teacher",
    "experiment_description": "new_metrics_ed_teacher_T_1",
    "dataset_name": "movies.csv",
    "sched": "ensemble",
    "model_code": "narm",
    "mentor_code": "narm",
    "mentor2_code": "narm",
    "softmaxed_mentor": true,
    "T": 1,
    "weight_list": [
        1,
        1
    ],
    "training_routine": "finished",
    "enable_auto_path_finder": false,
    "num_epochs": 0,
    "mode": "test",
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": "___movies_base_2022/base_narm_05-04_21:23_0/narm_logs/checkpoint/best_acc_model.pth",
    "mentor2_state_path": "___movies_base_2020/base_narm_05-04_21:31_0/narm_logs/checkpoint/best_acc_model.pth",
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "do_remap": false,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.movies/narm/config_ensemble.json",
    "task_id": -1,
    "describe": null,
    "split": "leave_one_out",
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "alpha": 0.1,
    "dvae_alpha": 0.5,
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
INFO    [05-25 14:46:58] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/movies-5-5.pkl
INFO    [05-25 14:46:59] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-25 14:46:59] _check_dataset_cache in utils:
correct.
INFO    [05-25 14:46:59] __init__ in NextItemDataloader:
there are 21035 items in this dataset, 82156 users, padding_first? False
DEBUG   [05-25 14:47:14] generate_model in utils:
model_code_list=['narm']
INFO    [05-25 14:47:14] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-25 14:47:14] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-25 14:47:22] get_exist_path in utils:
dir ___ablation_movies_ed_test_teacher/new_metrics_ed_teacher_T_1_narm_05-25_14:46_0/teacher1_narm_logs does not exist! Create one.
WARNING [05-25 14:47:22] get_exist_path in utils:
dir ___ablation_movies_ed_test_teacher/new_metrics_ed_teacher_T_1_narm_05-25_14:46_0/teacher1_narm_logs/tb_vis does not exist! Create one.
WARNING [05-25 14:47:22] get_exist_path in utils:
dir ___ablation_movies_ed_test_teacher/new_metrics_ed_teacher_T_1_narm_05-25_14:46_0/teacher1_narm_logs/checkpoint does not exist! Create one.
INFO    [05-25 14:47:22] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-25 14:47:22] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-25 14:47:22] load_state_from_given_path in utils:
Loading optimizer's parameters
DEBUG   [05-25 14:47:22] _generate_teacher_trainer in EnsembleSched:
teacher1_narm: 
NARM(
  (item_embedding): Embedding(21036, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-25 14:47:22] assert_model_device in utils:
model teacher1_narm has 5.60498046875 MB params.
INFO    [05-25 14:47:22] __init__ in BasicTrainer:
450560 iter per epoch
DEBUG   [05-25 14:47:22] generate_model in utils:
model_code_list=['narm']
INFO    [05-25 14:47:22] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-25 14:47:22] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-25 14:47:27] get_exist_path in utils:
dir ___ablation_movies_ed_test_teacher/new_metrics_ed_teacher_T_1_narm_05-25_14:46_0/teacher2_narm_logs does not exist! Create one.
WARNING [05-25 14:47:27] get_exist_path in utils:
dir ___ablation_movies_ed_test_teacher/new_metrics_ed_teacher_T_1_narm_05-25_14:46_0/teacher2_narm_logs/tb_vis does not exist! Create one.
WARNING [05-25 14:47:27] get_exist_path in utils:
dir ___ablation_movies_ed_test_teacher/new_metrics_ed_teacher_T_1_narm_05-25_14:46_0/teacher2_narm_logs/checkpoint does not exist! Create one.
INFO    [05-25 14:47:27] load_state_from_given_path in utils:
checkpoint epoch: 57
INFO    [05-25 14:47:27] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-25 14:47:27] load_state_from_given_path in utils:
Loading optimizer's parameters
DEBUG   [05-25 14:47:27] _generate_teacher_trainer in EnsembleSched:
teacher2_narm: 
NARM(
  (item_embedding): Embedding(21036, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-25 14:47:27] assert_model_device in utils:
model teacher2_narm has 5.60498046875 MB params.
INFO    [05-25 14:47:27] __init__ in BasicTrainer:
450560 iter per epoch
INFO    [05-25 14:47:27] assert_model_device in utils:
model ensemble_model has 0.0 MB params.
INFO    [05-25 14:47:27] assert_model_device in utils:
model ensemble_model has no param
INFO    [05-25 14:47:27] _set_current_routine in Routine:
first routine: finished
INFO    [05-25 14:47:27] _evaluate in EnsembleSched:
Start testing ensemble model on test set
INFO    [05-25 14:47:27] test in tester:
Finished loading. Start testing.
DEBUG   [05-25 14:47:27] forward in Ensembler:
raw predict
DEBUG   [05-25 14:47:27] forward in Ensembler:
[tensor([[3.4247e-10, 1.2628e-05, 3.1513e-07,  ..., 1.6457e-07, 2.0129e-06,
         1.7333e-05],
        [6.0432e-10, 3.1460e-08, 8.7890e-08,  ..., 2.0053e-08, 1.3966e-07,
         5.6891e-06],
        [1.2471e-10, 5.6176e-07, 1.5155e-08,  ..., 6.3844e-10, 1.2054e-08,
         3.7833e-07],
        ...,
        [1.6886e-12, 2.3767e-12, 1.6632e-08,  ..., 3.5092e-11, 6.1488e-09,
         2.3575e-10],
        [2.0090e-10, 1.5301e-04, 6.0499e-09,  ..., 1.0599e-06, 1.0600e-07,
         1.8289e-08],
        [1.1473e-09, 3.0392e-09, 3.1199e-06,  ..., 4.1735e-09, 1.2547e-09,
         3.5751e-06]], device='cuda:0'), tensor([[3.3047e-09, 8.8514e-05, 2.7018e-06,  ..., 9.2151e-08, 2.3947e-06,
         1.5326e-05],
        [1.1676e-10, 1.7760e-08, 1.1190e-08,  ..., 1.0180e-08, 1.1739e-07,
         3.2293e-06],
        [5.4760e-10, 3.5851e-07, 7.8197e-08,  ..., 2.2399e-09, 7.6208e-08,
         6.0340e-08],
        ...,
        [9.7622e-17, 8.2031e-17, 4.7834e-14,  ..., 6.6091e-16, 3.5728e-09,
         9.2034e-15],
        [4.1202e-11, 1.2502e-04, 7.0958e-08,  ..., 4.6447e-07, 1.5629e-06,
         5.6823e-08],
        [8.5217e-09, 3.4895e-07, 1.9139e-06,  ..., 2.1440e-08, 1.3087e-09,
         4.6571e-06]], device='cuda:0')]
DEBUG   [05-25 14:47:27] forward in Ensembler:
raw confidence
DEBUG   [05-25 14:47:27] forward in Ensembler:
[tensor([0.0201, 0.0119, 0.0388,  ..., 0.2576, 0.0321, 0.2632], device='cuda:0'), tensor([0.0095, 0.0136, 0.0321,  ..., 0.2743, 0.0287, 0.0760], device='cuda:0')]
DEBUG   [05-25 14:47:27] forward in Ensembler:
weighted predict
DEBUG   [05-25 14:47:27] forward in Ensembler:
[tensor([[3.4247e-10, 1.2628e-05, 3.1513e-07,  ..., 1.6457e-07, 2.0129e-06,
         1.7333e-05],
        [6.0432e-10, 3.1460e-08, 8.7890e-08,  ..., 2.0053e-08, 1.3966e-07,
         5.6891e-06],
        [1.2471e-10, 5.6176e-07, 1.5155e-08,  ..., 6.3844e-10, 1.2054e-08,
         3.7833e-07],
        ...,
        [1.6886e-12, 2.3767e-12, 1.6632e-08,  ..., 3.5092e-11, 6.1488e-09,
         2.3575e-10],
        [2.0090e-10, 1.5301e-04, 6.0499e-09,  ..., 1.0599e-06, 1.0600e-07,
         1.8289e-08],
        [1.1473e-09, 3.0392e-09, 3.1199e-06,  ..., 4.1735e-09, 1.2547e-09,
         3.5751e-06]], device='cuda:0'), tensor([[3.3047e-09, 8.8514e-05, 2.7018e-06,  ..., 9.2151e-08, 2.3947e-06,
         1.5326e-05],
        [1.1676e-10, 1.7760e-08, 1.1190e-08,  ..., 1.0180e-08, 1.1739e-07,
         3.2293e-06],
        [5.4760e-10, 3.5851e-07, 7.8197e-08,  ..., 2.2399e-09, 7.6208e-08,
         6.0340e-08],
        ...,
        [9.7622e-17, 8.2031e-17, 4.7834e-14,  ..., 6.6091e-16, 3.5728e-09,
         9.2034e-15],
        [4.1202e-11, 1.2502e-04, 7.0958e-08,  ..., 4.6447e-07, 1.5629e-06,
         5.6823e-08],
        [8.5217e-09, 3.4895e-07, 1.9139e-06,  ..., 2.1440e-08, 1.3087e-09,
         4.6571e-06]], device='cuda:0')]
DEBUG   [05-25 14:47:27] forward in Ensembler:
final predict
DEBUG   [05-25 14:47:27] forward in Ensembler:
tensor([[1.8236e-09, 5.0571e-05, 1.5085e-06,  ..., 1.2836e-07, 2.2038e-06,
         1.6330e-05],
        [3.6054e-10, 2.4610e-08, 4.9540e-08,  ..., 1.5116e-08, 1.2852e-07,
         4.4592e-06],
        [3.3616e-10, 4.6013e-07, 4.6676e-08,  ..., 1.4392e-09, 4.4131e-08,
         2.1934e-07],
        ...,
        [8.4435e-13, 1.1884e-12, 8.3158e-09,  ..., 1.7546e-11, 4.8608e-09,
         1.1788e-10],
        [1.2105e-10, 1.3902e-04, 3.8504e-08,  ..., 7.6217e-07, 8.3446e-07,
         3.7556e-08],
        [4.8345e-09, 1.7599e-07, 2.5169e-06,  ..., 1.2807e-08, 1.2817e-09,
         4.1161e-06]], device='cuda:0')
DEBUG   [05-25 14:47:27] forward in Ensembler:
final confidence
DEBUG   [05-25 14:47:27] forward in Ensembler:
tensor([0.0123, 0.0128, 0.0355,  ..., 0.1663, 0.0250, 0.1321], device='cuda:0')
DEBUG   [05-25 14:47:29] forward in Ensembler:
raw predict
DEBUG   [05-25 14:47:29] forward in Ensembler:
[tensor([[7.2661e-10, 1.4145e-05, 1.3802e-04,  ..., 1.4039e-09, 9.3619e-07,
         2.6967e-05],
        [8.0987e-10, 2.4429e-05, 4.4612e-07,  ..., 2.1055e-06, 6.4477e-07,
         9.1939e-08],
        [2.7849e-09, 1.0469e-06, 1.1335e-05,  ..., 9.7008e-08, 4.0650e-07,
         5.2924e-06],
        ...,
        [1.5740e-08, 1.4436e-04, 4.9334e-06,  ..., 4.6575e-04, 4.4813e-06,
         6.0394e-07],
        [8.3333e-11, 2.7732e-08, 4.4505e-09,  ..., 7.6353e-10, 3.1617e-08,
         3.5244e-07],
        [2.4019e-08, 6.1213e-05, 5.0305e-05,  ..., 4.2810e-07, 2.8760e-07,
         6.4896e-06]], device='cuda:0'), tensor([[9.7513e-10, 4.2232e-06, 1.2979e-05,  ..., 4.4100e-08, 2.0367e-05,
         2.6182e-05],
        [8.4867e-10, 4.6102e-05, 4.3848e-07,  ..., 4.8362e-06, 8.0558e-07,
         7.2657e-07],
        [1.4958e-10, 2.2040e-07, 2.6960e-07,  ..., 3.2601e-09, 4.6927e-08,
         7.9910e-06],
        ...,
        [1.7678e-08, 1.3658e-04, 8.7798e-06,  ..., 4.5989e-05, 4.1941e-05,
         1.1352e-07],
        [9.1456e-12, 1.8952e-08, 2.3209e-09,  ..., 4.7511e-10, 9.1494e-08,
         5.4052e-07],
        [1.1707e-09, 1.0939e-04, 6.9346e-07,  ..., 1.9944e-08, 1.6084e-06,
         6.2210e-06]], device='cuda:0')]
DEBUG   [05-25 14:47:29] forward in Ensembler:
raw confidence
DEBUG   [05-25 14:47:29] forward in Ensembler:
[tensor([0.0318, 0.0756, 0.0160,  ..., 0.0163, 0.0385, 0.0073], device='cuda:0'), tensor([0.0027, 0.0938, 0.0172,  ..., 0.0215, 0.0190, 0.0091], device='cuda:0')]
DEBUG   [05-25 14:47:29] forward in Ensembler:
weighted predict
DEBUG   [05-25 14:47:29] forward in Ensembler:
[tensor([[7.2661e-10, 1.4145e-05, 1.3802e-04,  ..., 1.4039e-09, 9.3619e-07,
         2.6967e-05],
        [8.0987e-10, 2.4429e-05, 4.4612e-07,  ..., 2.1055e-06, 6.4477e-07,
         9.1939e-08],
        [2.7849e-09, 1.0469e-06, 1.1335e-05,  ..., 9.7008e-08, 4.0650e-07,
         5.2924e-06],
        ...,
        [1.5740e-08, 1.4436e-04, 4.9334e-06,  ..., 4.6575e-04, 4.4813e-06,
         6.0394e-07],
        [8.3333e-11, 2.7732e-08, 4.4505e-09,  ..., 7.6353e-10, 3.1617e-08,
         3.5244e-07],
        [2.4019e-08, 6.1213e-05, 5.0305e-05,  ..., 4.2810e-07, 2.8760e-07,
         6.4896e-06]], device='cuda:0'), tensor([[9.7513e-10, 4.2232e-06, 1.2979e-05,  ..., 4.4100e-08, 2.0367e-05,
         2.6182e-05],
        [8.4867e-10, 4.6102e-05, 4.3848e-07,  ..., 4.8362e-06, 8.0558e-07,
         7.2657e-07],
        [1.4958e-10, 2.2040e-07, 2.6960e-07,  ..., 3.2601e-09, 4.6927e-08,
         7.9910e-06],
        ...,
        [1.7678e-08, 1.3658e-04, 8.7798e-06,  ..., 4.5989e-05, 4.1941e-05,
         1.1352e-07],
        [9.1456e-12, 1.8952e-08, 2.3209e-09,  ..., 4.7511e-10, 9.1494e-08,
         5.4052e-07],
        [1.1707e-09, 1.0939e-04, 6.9346e-07,  ..., 1.9944e-08, 1.6084e-06,
         6.2210e-06]], device='cuda:0')]
DEBUG   [05-25 14:47:29] forward in Ensembler:
final predict
DEBUG   [05-25 14:47:29] forward in Ensembler:
tensor([[8.5087e-10, 9.1844e-06, 7.5497e-05,  ..., 2.2752e-08, 1.0652e-05,
         2.6574e-05],
        [8.2927e-10, 3.5266e-05, 4.4230e-07,  ..., 3.4709e-06, 7.2518e-07,
         4.0925e-07],
        [1.4672e-09, 6.3365e-07, 5.8023e-06,  ..., 5.0134e-08, 2.2671e-07,
         6.6417e-06],
        ...,
        [1.6709e-08, 1.4047e-04, 6.8566e-06,  ..., 2.5587e-04, 2.3211e-05,
         3.5873e-07],
        [4.6239e-11, 2.3342e-08, 3.3857e-09,  ..., 6.1932e-10, 6.1555e-08,
         4.4648e-07],
        [1.2595e-08, 8.5303e-05, 2.5499e-05,  ..., 2.2402e-07, 9.4798e-07,
         6.3553e-06]], device='cuda:0')
DEBUG   [05-25 14:47:29] forward in Ensembler:
final confidence
DEBUG   [05-25 14:47:29] forward in Ensembler:
tensor([0.0164, 0.0847, 0.0125,  ..., 0.0110, 0.0281, 0.0077], device='cuda:0')
DEBUG   [05-25 14:47:31] forward in Ensembler:
raw predict
DEBUG   [05-25 14:47:31] forward in Ensembler:
[tensor([[1.9780e-09, 3.0406e-07, 1.9745e-08,  ..., 1.8953e-08, 5.0350e-07,
         1.2746e-06],
        [1.1182e-10, 4.9519e-08, 6.8715e-10,  ..., 2.1571e-09, 4.3470e-09,
         1.7888e-08],
        [1.3860e-09, 1.2206e-05, 1.0478e-06,  ..., 1.1239e-08, 1.0421e-04,
         5.4126e-06],
        ...,
        [5.8668e-10, 2.0479e-06, 1.7722e-07,  ..., 6.7162e-06, 7.5236e-08,
         4.0568e-07],
        [4.9093e-09, 1.1266e-04, 2.2164e-06,  ..., 4.6320e-06, 3.2201e-06,
         1.7296e-06],
        [1.2094e-09, 4.2733e-07, 8.8149e-09,  ..., 1.0488e-08, 3.1974e-07,
         2.7300e-05]], device='cuda:0'), tensor([[5.1841e-10, 7.6982e-07, 5.0963e-10,  ..., 1.6743e-07, 2.8371e-06,
         4.6426e-08],
        [4.4464e-13, 7.4454e-08, 7.2802e-10,  ..., 1.3261e-12, 1.0628e-08,
         9.8887e-08],
        [6.8559e-10, 1.9988e-06, 1.7054e-07,  ..., 4.4922e-07, 3.2173e-04,
         1.9890e-06],
        ...,
        [3.0570e-10, 1.7583e-06, 6.7269e-08,  ..., 2.0994e-05, 6.2897e-08,
         2.1115e-07],
        [5.5942e-09, 3.8494e-05, 6.2563e-07,  ..., 4.6714e-06, 2.4609e-06,
         2.8933e-06],
        [1.0133e-09, 2.8421e-07, 3.1883e-09,  ..., 1.5597e-08, 9.1647e-07,
         4.1231e-05]], device='cuda:0')]
DEBUG   [05-25 14:47:31] forward in Ensembler:
raw confidence
DEBUG   [05-25 14:47:31] forward in Ensembler:
[tensor([0.0153, 0.0207, 0.0110,  ..., 0.0318, 0.0120, 0.0134], device='cuda:0'), tensor([0.0098, 0.0324, 0.0071,  ..., 0.0395, 0.0111, 0.0110], device='cuda:0')]
DEBUG   [05-25 14:47:31] forward in Ensembler:
weighted predict
DEBUG   [05-25 14:47:31] forward in Ensembler:
[tensor([[1.9780e-09, 3.0406e-07, 1.9745e-08,  ..., 1.8953e-08, 5.0350e-07,
         1.2746e-06],
        [1.1182e-10, 4.9519e-08, 6.8715e-10,  ..., 2.1571e-09, 4.3470e-09,
         1.7888e-08],
        [1.3860e-09, 1.2206e-05, 1.0478e-06,  ..., 1.1239e-08, 1.0421e-04,
         5.4126e-06],
        ...,
        [5.8668e-10, 2.0479e-06, 1.7722e-07,  ..., 6.7162e-06, 7.5236e-08,
         4.0568e-07],
        [4.9093e-09, 1.1266e-04, 2.2164e-06,  ..., 4.6320e-06, 3.2201e-06,
         1.7296e-06],
        [1.2094e-09, 4.2733e-07, 8.8149e-09,  ..., 1.0488e-08, 3.1974e-07,
         2.7300e-05]], device='cuda:0'), tensor([[5.1841e-10, 7.6982e-07, 5.0963e-10,  ..., 1.6743e-07, 2.8371e-06,
         4.6426e-08],
        [4.4464e-13, 7.4454e-08, 7.2802e-10,  ..., 1.3261e-12, 1.0628e-08,
         9.8887e-08],
        [6.8559e-10, 1.9988e-06, 1.7054e-07,  ..., 4.4922e-07, 3.2173e-04,
         1.9890e-06],
        ...,
        [3.0570e-10, 1.7583e-06, 6.7269e-08,  ..., 2.0994e-05, 6.2897e-08,
         2.1115e-07],
        [5.5942e-09, 3.8494e-05, 6.2563e-07,  ..., 4.6714e-06, 2.4609e-06,
         2.8933e-06],
        [1.0133e-09, 2.8421e-07, 3.1883e-09,  ..., 1.5597e-08, 9.1647e-07,
         4.1231e-05]], device='cuda:0')]
DEBUG   [05-25 14:47:31] forward in Ensembler:
final predict
DEBUG   [05-25 14:47:31] forward in Ensembler:
tensor([[1.2482e-09, 5.3694e-07, 1.0127e-08,  ..., 9.3193e-08, 1.6703e-06,
         6.6054e-07],
        [5.6134e-11, 6.1986e-08, 7.0758e-10,  ..., 1.0792e-09, 7.4874e-09,
         5.8388e-08],
        [1.0358e-09, 7.1022e-06, 6.0915e-07,  ..., 2.3023e-07, 2.1297e-04,
         3.7008e-06],
        ...,
        [4.4619e-10, 1.9031e-06, 1.2225e-07,  ..., 1.3855e-05, 6.9066e-08,
         3.0841e-07],
        [5.2518e-09, 7.5579e-05, 1.4210e-06,  ..., 4.6517e-06, 2.8405e-06,
         2.3114e-06],
        [1.1113e-09, 3.5577e-07, 6.0016e-09,  ..., 1.3043e-08, 6.1811e-07,
         3.4265e-05]], device='cuda:0')
DEBUG   [05-25 14:47:31] forward in Ensembler:
final confidence
DEBUG   [05-25 14:47:31] forward in Ensembler:
tensor([0.0126, 0.0185, 0.0065,  ..., 0.0357, 0.0115, 0.0122], device='cuda:0')
DEBUG   [05-25 14:47:33] forward in Ensembler:
raw predict
DEBUG   [05-25 14:47:33] forward in Ensembler:
[tensor([[2.0442e-09, 2.7833e-06, 2.9422e-08,  ..., 1.7551e-06, 5.9218e-09,
         1.7444e-08],
        [2.3796e-09, 1.8165e-05, 6.2075e-06,  ..., 2.4643e-07, 2.8760e-06,
         5.7776e-06],
        [2.3035e-11, 4.5031e-09, 1.8506e-09,  ..., 2.2782e-10, 8.5672e-09,
         9.6988e-07],
        ...,
        [1.9220e-09, 7.8234e-07, 1.2430e-09,  ..., 9.1419e-07, 1.8813e-08,
         7.9009e-07],
        [3.1144e-10, 1.6609e-09, 7.1173e-08,  ..., 5.3398e-08, 5.2650e-09,
         1.9509e-06],
        [2.1085e-09, 5.8981e-05, 4.3534e-07,  ..., 1.1787e-06, 3.5428e-09,
         2.5712e-08]], device='cuda:0'), tensor([[6.5239e-10, 1.3683e-05, 6.2365e-08,  ..., 1.3094e-06, 1.9631e-07,
         8.6368e-08],
        [2.1967e-08, 1.7760e-05, 2.9688e-06,  ..., 3.5649e-06, 7.4591e-06,
         1.6830e-06],
        [5.8208e-13, 1.0369e-10, 2.9616e-11,  ..., 3.1645e-13, 3.9294e-09,
         2.1394e-06],
        ...,
        [4.1590e-10, 4.6250e-07, 2.9794e-09,  ..., 1.2296e-07, 3.3745e-08,
         1.1762e-06],
        [6.6181e-11, 3.5760e-10, 3.9811e-09,  ..., 3.8098e-08, 6.0221e-09,
         4.8633e-06],
        [9.0023e-10, 2.8111e-05, 1.0590e-08,  ..., 1.6463e-06, 3.7596e-09,
         6.9895e-09]], device='cuda:0')]
DEBUG   [05-25 14:47:33] forward in Ensembler:
raw confidence
DEBUG   [05-25 14:47:33] forward in Ensembler:
[tensor([0.1410, 0.0128, 0.0776,  ..., 0.0144, 0.0183, 0.1054], device='cuda:0'), tensor([0.1215, 0.0225, 0.0764,  ..., 0.0131, 0.0148, 0.2735], device='cuda:0')]
DEBUG   [05-25 14:47:33] forward in Ensembler:
weighted predict
DEBUG   [05-25 14:47:33] forward in Ensembler:
[tensor([[2.0442e-09, 2.7833e-06, 2.9422e-08,  ..., 1.7551e-06, 5.9218e-09,
         1.7444e-08],
        [2.3796e-09, 1.8165e-05, 6.2075e-06,  ..., 2.4643e-07, 2.8760e-06,
         5.7776e-06],
        [2.3035e-11, 4.5031e-09, 1.8506e-09,  ..., 2.2782e-10, 8.5672e-09,
         9.6988e-07],
        ...,
        [1.9220e-09, 7.8234e-07, 1.2430e-09,  ..., 9.1419e-07, 1.8813e-08,
         7.9009e-07],
        [3.1144e-10, 1.6609e-09, 7.1173e-08,  ..., 5.3398e-08, 5.2650e-09,
         1.9509e-06],
        [2.1085e-09, 5.8981e-05, 4.3534e-07,  ..., 1.1787e-06, 3.5428e-09,
         2.5712e-08]], device='cuda:0'), tensor([[6.5239e-10, 1.3683e-05, 6.2365e-08,  ..., 1.3094e-06, 1.9631e-07,
         8.6368e-08],
        [2.1967e-08, 1.7760e-05, 2.9688e-06,  ..., 3.5649e-06, 7.4591e-06,
         1.6830e-06],
        [5.8208e-13, 1.0369e-10, 2.9616e-11,  ..., 3.1645e-13, 3.9294e-09,
         2.1394e-06],
        ...,
        [4.1590e-10, 4.6250e-07, 2.9794e-09,  ..., 1.2296e-07, 3.3745e-08,
         1.1762e-06],
        [6.6181e-11, 3.5760e-10, 3.9811e-09,  ..., 3.8098e-08, 6.0221e-09,
         4.8633e-06],
        [9.0023e-10, 2.8111e-05, 1.0590e-08,  ..., 1.6463e-06, 3.7596e-09,
         6.9895e-09]], device='cuda:0')]
DEBUG   [05-25 14:47:33] forward in Ensembler:
final predict
DEBUG   [05-25 14:47:33] forward in Ensembler:
tensor([[1.3483e-09, 8.2331e-06, 4.5893e-08,  ..., 1.5323e-06, 1.0112e-07,
         5.1906e-08],
        [1.2173e-08, 1.7962e-05, 4.5882e-06,  ..., 1.9056e-06, 5.1675e-06,
         3.7303e-06],
        [1.1809e-11, 2.3034e-09, 9.4012e-10,  ..., 1.1407e-10, 6.2483e-09,
         1.5546e-06],
        ...,
        [1.1690e-09, 6.2242e-07, 2.1112e-09,  ..., 5.1858e-07, 2.6279e-08,
         9.8313e-07],
        [1.8881e-10, 1.0093e-09, 3.7577e-08,  ..., 4.5748e-08, 5.6436e-09,
         3.4071e-06],
        [1.5044e-09, 4.3546e-05, 2.2296e-07,  ..., 1.4125e-06, 3.6512e-09,
         1.6351e-08]], device='cuda:0')
DEBUG   [05-25 14:47:33] forward in Ensembler:
final confidence
DEBUG   [05-25 14:47:33] forward in Ensembler:
tensor([0.1312, 0.0142, 0.0770,  ..., 0.0090, 0.0165, 0.1894], device='cuda:0')
DEBUG   [05-25 14:47:34] forward in Ensembler:
raw predict
DEBUG   [05-25 14:47:34] forward in Ensembler:
[tensor([[8.2699e-10, 4.6272e-08, 3.5408e-09,  ..., 1.1805e-09, 3.5553e-09,
         4.5573e-07],
        [1.9705e-09, 2.9825e-07, 2.0512e-08,  ..., 1.0577e-07, 5.8844e-06,
         8.6891e-05],
        [2.5780e-09, 2.8410e-07, 4.0578e-11,  ..., 7.0819e-09, 4.0624e-08,
         7.0007e-08],
        ...,
        [6.0819e-11, 1.0416e-05, 8.6798e-07,  ..., 5.0642e-06, 7.4876e-07,
         9.8745e-07],
        [2.0393e-10, 2.4926e-06, 2.2990e-06,  ..., 2.8989e-06, 1.0709e-07,
         2.2006e-07],
        [1.1910e-10, 1.9573e-09, 4.6355e-09,  ..., 1.0030e-08, 3.9698e-09,
         5.3650e-06]], device='cuda:0'), tensor([[6.2533e-10, 2.2283e-07, 3.8967e-09,  ..., 7.4619e-10, 1.3926e-08,
         2.2601e-06],
        [2.1097e-09, 8.7917e-08, 7.2840e-09,  ..., 6.5519e-07, 2.5992e-06,
         9.8869e-05],
        [1.1992e-09, 1.7692e-07, 3.9977e-08,  ..., 9.7175e-10, 1.1818e-06,
         4.9733e-07],
        ...,
        [9.4472e-12, 9.2658e-07, 1.9769e-07,  ..., 8.5275e-07, 8.5790e-07,
         3.5445e-07],
        [3.0947e-12, 1.6905e-07, 6.9206e-07,  ..., 1.2308e-07, 4.7404e-08,
         2.0269e-07],
        [5.0490e-11, 3.3956e-10, 7.7144e-10,  ..., 1.6800e-08, 2.0752e-08,
         2.9536e-06]], device='cuda:0')]
DEBUG   [05-25 14:47:34] forward in Ensembler:
raw confidence
DEBUG   [05-25 14:47:34] forward in Ensembler:
[tensor([0.0488, 0.0053, 0.2972,  ..., 0.0357, 0.0338, 0.0272], device='cuda:0'), tensor([0.0139, 0.0064, 0.0806,  ..., 0.0482, 0.0587, 0.0184], device='cuda:0')]
DEBUG   [05-25 14:47:34] forward in Ensembler:
weighted predict
DEBUG   [05-25 14:47:34] forward in Ensembler:
[tensor([[8.2699e-10, 4.6272e-08, 3.5408e-09,  ..., 1.1805e-09, 3.5553e-09,
         4.5573e-07],
        [1.9705e-09, 2.9825e-07, 2.0512e-08,  ..., 1.0577e-07, 5.8844e-06,
         8.6891e-05],
        [2.5780e-09, 2.8410e-07, 4.0578e-11,  ..., 7.0819e-09, 4.0624e-08,
         7.0007e-08],
        ...,
        [6.0819e-11, 1.0416e-05, 8.6798e-07,  ..., 5.0642e-06, 7.4876e-07,
         9.8745e-07],
        [2.0393e-10, 2.4926e-06, 2.2990e-06,  ..., 2.8989e-06, 1.0709e-07,
         2.2006e-07],
        [1.1910e-10, 1.9573e-09, 4.6355e-09,  ..., 1.0030e-08, 3.9698e-09,
         5.3650e-06]], device='cuda:0'), tensor([[6.2533e-10, 2.2283e-07, 3.8967e-09,  ..., 7.4619e-10, 1.3926e-08,
         2.2601e-06],
        [2.1097e-09, 8.7917e-08, 7.2840e-09,  ..., 6.5519e-07, 2.5992e-06,
         9.8869e-05],
        [1.1992e-09, 1.7692e-07, 3.9977e-08,  ..., 9.7175e-10, 1.1818e-06,
         4.9733e-07],
        ...,
        [9.4472e-12, 9.2658e-07, 1.9769e-07,  ..., 8.5275e-07, 8.5790e-07,
         3.5445e-07],
        [3.0947e-12, 1.6905e-07, 6.9206e-07,  ..., 1.2308e-07, 4.7404e-08,
         2.0269e-07],
        [5.0490e-11, 3.3956e-10, 7.7144e-10,  ..., 1.6800e-08, 2.0752e-08,
         2.9536e-06]], device='cuda:0')]
DEBUG   [05-25 14:47:34] forward in Ensembler:
final predict
DEBUG   [05-25 14:47:34] forward in Ensembler:
tensor([[7.2616e-10, 1.3455e-07, 3.7187e-09,  ..., 9.6337e-10, 8.7407e-09,
         1.3579e-06],
        [2.0401e-09, 1.9308e-07, 1.3898e-08,  ..., 3.8048e-07, 4.2418e-06,
         9.2880e-05],
        [1.8886e-09, 2.3051e-07, 2.0009e-08,  ..., 4.0268e-09, 6.1120e-07,
         2.8367e-07],
        ...,
        [3.5133e-11, 5.6715e-06, 5.3283e-07,  ..., 2.9585e-06, 8.0333e-07,
         6.7095e-07],
        [1.0351e-10, 1.3308e-06, 1.4955e-06,  ..., 1.5110e-06, 7.7247e-08,
         2.1137e-07],
        [8.4796e-11, 1.1484e-09, 2.7035e-09,  ..., 1.3415e-08, 1.2361e-08,
         4.1593e-06]], device='cuda:0')
DEBUG   [05-25 14:47:34] forward in Ensembler:
final confidence
DEBUG   [05-25 14:47:34] forward in Ensembler:
tensor([0.0278, 0.0046, 0.1889,  ..., 0.0419, 0.0449, 0.0228], device='cuda:0')
WARNING [05-25 14:48:03] get_exist_path in utils:
dir ___ablation_movies_ed_test_teacher/new_metrics_ed_teacher_T_1_narm_05-25_14:46_0/ensemble_model_logs does not exist! Create one.
INFO    [05-25 14:48:03] _evaluate in EnsembleSched:
!!Final Result!!: {'Recall@10': 0.10061135639746983, 'NDCG@10': 0.05971804970786685, 'MRR@10': 0.0473043890226455, 'Recall@5': 0.06969200056933221, 'NDCG@5': 0.04977358043903396, 'MRR@5': 0.04323244183546021, 'Recall*@10': 0.10420687780493781, 'NDCG*@10': 0.06298250971095902, 'MRR*@10': 0.05045397952198982, 'Recall*@5': 0.07357712870552427, 'NDCG*@5': 0.053125390162070595, 'MRR*@5': 0.04641387877719743, 'Recall**@10': 0.09001020448548454, 'NDCG**@10': 0.050059997698380834, 'MRR**@10': 0.03797296736212004, 'Recall**@5': 0.05821778625249863, 'NDCG**@5': 0.039851390002738865, 'MRR**@5': 0.03380424351919265}
