INFO    [05-25 14:44:02] setup_train in utils:
{
    "experiment_dir": "___ablation_movies_ed_test_teacher",
    "experiment_description": "new_metrics_ed_teacher_T_3",
    "dataset_name": "movies.csv",
    "sched": "ensemble",
    "model_code": "narm",
    "mentor_code": "narm",
    "mentor2_code": "narm",
    "softmaxed_mentor": true,
    "T": 3,
    "weight_list": [
        1,
        1
    ],
    "training_routine": "finished",
    "enable_auto_path_finder": false,
    "num_epochs": 0,
    "mode": "test",
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": "___movies_base_2022/base_narm_05-04_21:23_0/narm_logs/checkpoint/best_acc_model.pth",
    "mentor2_state_path": "___movies_base_2020/base_narm_05-04_21:31_0/narm_logs/checkpoint/best_acc_model.pth",
    "rand_seed": 2022,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "do_remap": false,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.movies/narm/config_ensemble.json",
    "task_id": -1,
    "describe": null,
    "split": "leave_one_out",
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "alpha": 0.1,
    "dvae_alpha": 0.5,
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
INFO    [05-25 14:44:02] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/movies-5-5.pkl
INFO    [05-25 14:44:04] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-25 14:44:04] _check_dataset_cache in utils:
correct.
INFO    [05-25 14:44:04] __init__ in NextItemDataloader:
there are 21035 items in this dataset, 82156 users, padding_first? False
DEBUG   [05-25 14:44:18] generate_model in utils:
model_code_list=['narm']
INFO    [05-25 14:44:18] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-25 14:44:18] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-25 14:44:26] get_exist_path in utils:
dir ___ablation_movies_ed_test_teacher/new_metrics_ed_teacher_T_3_narm_05-25_14:44_0/teacher1_narm_logs does not exist! Create one.
WARNING [05-25 14:44:26] get_exist_path in utils:
dir ___ablation_movies_ed_test_teacher/new_metrics_ed_teacher_T_3_narm_05-25_14:44_0/teacher1_narm_logs/tb_vis does not exist! Create one.
WARNING [05-25 14:44:26] get_exist_path in utils:
dir ___ablation_movies_ed_test_teacher/new_metrics_ed_teacher_T_3_narm_05-25_14:44_0/teacher1_narm_logs/checkpoint does not exist! Create one.
INFO    [05-25 14:44:26] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-25 14:44:26] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-25 14:44:26] load_state_from_given_path in utils:
Loading optimizer's parameters
DEBUG   [05-25 14:44:26] _generate_teacher_trainer in EnsembleSched:
teacher1_narm: 
NARM(
  (item_embedding): Embedding(21036, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-25 14:44:26] assert_model_device in utils:
model teacher1_narm has 5.60498046875 MB params.
INFO    [05-25 14:44:26] __init__ in BasicTrainer:
450560 iter per epoch
DEBUG   [05-25 14:44:26] generate_model in utils:
model_code_list=['narm']
INFO    [05-25 14:44:26] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-25 14:44:26] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-25 14:44:31] get_exist_path in utils:
dir ___ablation_movies_ed_test_teacher/new_metrics_ed_teacher_T_3_narm_05-25_14:44_0/teacher2_narm_logs does not exist! Create one.
WARNING [05-25 14:44:31] get_exist_path in utils:
dir ___ablation_movies_ed_test_teacher/new_metrics_ed_teacher_T_3_narm_05-25_14:44_0/teacher2_narm_logs/tb_vis does not exist! Create one.
WARNING [05-25 14:44:31] get_exist_path in utils:
dir ___ablation_movies_ed_test_teacher/new_metrics_ed_teacher_T_3_narm_05-25_14:44_0/teacher2_narm_logs/checkpoint does not exist! Create one.
INFO    [05-25 14:44:31] load_state_from_given_path in utils:
checkpoint epoch: 57
INFO    [05-25 14:44:31] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-25 14:44:31] load_state_from_given_path in utils:
Loading optimizer's parameters
DEBUG   [05-25 14:44:31] _generate_teacher_trainer in EnsembleSched:
teacher2_narm: 
NARM(
  (item_embedding): Embedding(21036, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-25 14:44:31] assert_model_device in utils:
model teacher2_narm has 5.60498046875 MB params.
INFO    [05-25 14:44:31] __init__ in BasicTrainer:
450560 iter per epoch
INFO    [05-25 14:44:31] assert_model_device in utils:
model ensemble_model has 0.0 MB params.
INFO    [05-25 14:44:31] assert_model_device in utils:
model ensemble_model has no param
INFO    [05-25 14:44:31] _set_current_routine in Routine:
first routine: finished
INFO    [05-25 14:44:31] _evaluate in EnsembleSched:
Start testing ensemble model on test set
INFO    [05-25 14:44:31] test in tester:
Finished loading. Start testing.
DEBUG   [05-25 14:44:32] forward in Ensembler:
raw predict
DEBUG   [05-25 14:44:32] forward in Ensembler:
[tensor([[1.9717e-06, 6.5627e-05, 1.9178e-05,  ..., 1.5444e-05, 3.5582e-05,
         7.2933e-05],
        [2.4762e-06, 9.2459e-06, 1.3022e-05,  ..., 7.9571e-06, 1.5196e-05,
         5.2285e-05],
        [1.6328e-06, 2.6965e-05, 8.0874e-06,  ..., 2.8140e-06, 7.4932e-06,
         2.3636e-05],
        ...,
        [1.3629e-06, 1.5274e-06, 2.9214e-05,  ..., 3.7470e-06, 2.0968e-05,
         7.0703e-06],
        [2.3228e-06, 2.1213e-04, 7.2267e-06,  ..., 4.0437e-05, 1.8770e-05,
         1.0449e-05],
        [5.6644e-06, 7.8376e-06, 7.9064e-05,  ..., 8.7116e-06, 5.8359e-06,
         8.2736e-05]], device='cuda:0'), tensor([[3.4602e-06, 1.0353e-04, 3.2355e-05,  ..., 1.0493e-05, 3.1080e-05,
         5.7703e-05],
        [1.4241e-06, 7.6021e-06, 6.5172e-06,  ..., 6.3149e-06, 1.4267e-05,
         4.3068e-05],
        [2.2690e-06, 1.9702e-05, 1.1860e-05,  ..., 3.6287e-06, 1.1758e-05,
         1.0878e-05],
        ...,
        [1.7536e-07, 1.6548e-07, 1.3825e-06,  ..., 3.3174e-07, 5.8222e-05,
         7.9811e-07],
        [1.2829e-06, 1.8573e-04, 1.5378e-05,  ..., 2.8766e-05, 4.3105e-05,
         1.4280e-05],
        [9.2797e-06, 3.1985e-05, 5.6406e-05,  ..., 1.2621e-05, 4.9694e-06,
         7.5869e-05]], device='cuda:0')]
DEBUG   [05-25 14:44:32] forward in Ensembler:
raw confidence
DEBUG   [05-25 14:44:32] forward in Ensembler:
[tensor([0.0008, 0.0007, 0.0011,  ..., 0.0073, 0.0013, 0.0035], device='cuda:0'), tensor([0.0005, 0.0007, 0.0009,  ..., 0.0247, 0.0011, 0.0019], device='cuda:0')]
DEBUG   [05-25 14:44:32] forward in Ensembler:
weighted predict
DEBUG   [05-25 14:44:32] forward in Ensembler:
[tensor([[1.9717e-06, 6.5627e-05, 1.9178e-05,  ..., 1.5444e-05, 3.5582e-05,
         7.2933e-05],
        [2.4762e-06, 9.2459e-06, 1.3022e-05,  ..., 7.9571e-06, 1.5196e-05,
         5.2285e-05],
        [1.6328e-06, 2.6965e-05, 8.0874e-06,  ..., 2.8140e-06, 7.4932e-06,
         2.3636e-05],
        ...,
        [1.3629e-06, 1.5274e-06, 2.9214e-05,  ..., 3.7470e-06, 2.0968e-05,
         7.0703e-06],
        [2.3228e-06, 2.1213e-04, 7.2267e-06,  ..., 4.0437e-05, 1.8770e-05,
         1.0449e-05],
        [5.6644e-06, 7.8376e-06, 7.9064e-05,  ..., 8.7116e-06, 5.8359e-06,
         8.2736e-05]], device='cuda:0'), tensor([[3.4602e-06, 1.0353e-04, 3.2355e-05,  ..., 1.0493e-05, 3.1080e-05,
         5.7703e-05],
        [1.4241e-06, 7.6021e-06, 6.5172e-06,  ..., 6.3149e-06, 1.4267e-05,
         4.3068e-05],
        [2.2690e-06, 1.9702e-05, 1.1860e-05,  ..., 3.6287e-06, 1.1758e-05,
         1.0878e-05],
        ...,
        [1.7536e-07, 1.6548e-07, 1.3825e-06,  ..., 3.3174e-07, 5.8222e-05,
         7.9811e-07],
        [1.2829e-06, 1.8573e-04, 1.5378e-05,  ..., 2.8766e-05, 4.3105e-05,
         1.4280e-05],
        [9.2797e-06, 3.1985e-05, 5.6406e-05,  ..., 1.2621e-05, 4.9694e-06,
         7.5869e-05]], device='cuda:0')]
DEBUG   [05-25 14:44:32] forward in Ensembler:
final predict
DEBUG   [05-25 14:44:32] forward in Ensembler:
tensor([[2.7159e-06, 8.4578e-05, 2.5766e-05,  ..., 1.2968e-05, 3.3331e-05,
         6.5318e-05],
        [1.9502e-06, 8.4240e-06, 9.7696e-06,  ..., 7.1360e-06, 1.4731e-05,
         4.7677e-05],
        [1.9509e-06, 2.3334e-05, 9.9735e-06,  ..., 3.2214e-06, 9.6257e-06,
         1.7257e-05],
        ...,
        [7.6912e-07, 8.4643e-07, 1.5298e-05,  ..., 2.0394e-06, 3.9595e-05,
         3.9342e-06],
        [1.8029e-06, 1.9893e-04, 1.1302e-05,  ..., 3.4601e-05, 3.0938e-05,
         1.2365e-05],
        [7.4720e-06, 1.9911e-05, 6.7735e-05,  ..., 1.0666e-05, 5.4027e-06,
         7.9302e-05]], device='cuda:0')
DEBUG   [05-25 14:44:32] forward in Ensembler:
final confidence
DEBUG   [05-25 14:44:32] forward in Ensembler:
tensor([0.0006, 0.0007, 0.0010,  ..., 0.0141, 0.0011, 0.0020], device='cuda:0')
DEBUG   [05-25 14:44:33] forward in Ensembler:
raw predict
DEBUG   [05-25 14:44:33] forward in Ensembler:
[tensor([[2.0052e-06, 5.3943e-05, 1.1527e-04,  ..., 2.4975e-06, 2.1820e-05,
         6.6886e-05],
        [2.4339e-06, 7.5765e-05, 1.9952e-05,  ..., 3.3467e-05, 2.2558e-05,
         1.1785e-05],
        [2.9841e-06, 2.1537e-05, 4.7646e-05,  ..., 9.7458e-06, 1.5712e-05,
         3.6963e-05],
        ...,
        [5.9917e-06, 1.2542e-04, 4.0700e-05,  ..., 1.8532e-04, 3.9417e-05,
         2.0209e-05],
        [1.4994e-06, 1.0390e-05, 5.6464e-06,  ..., 3.1375e-06, 1.0854e-05,
         2.4247e-05],
        [6.4611e-06, 8.8254e-05, 8.2665e-05,  ..., 1.6877e-05, 1.4781e-05,
         4.1769e-05]], device='cuda:0'), tensor([[1.8299e-06, 2.9827e-05, 4.3365e-05,  ..., 6.5194e-06, 5.0393e-05,
         5.4794e-05],
        [2.6589e-06, 1.0070e-04, 2.1336e-05,  ..., 4.7493e-05, 2.6131e-05,
         2.5247e-05],
        [1.6296e-06, 1.8544e-05, 1.9832e-05,  ..., 4.5520e-06, 1.1073e-05,
         6.1375e-05],
        ...,
        [5.9406e-06, 1.1744e-04, 4.7045e-05,  ..., 8.1703e-05, 7.9231e-05,
         1.1042e-05],
        [7.4236e-07, 9.4645e-06, 4.6999e-06,  ..., 2.7700e-06, 1.5996e-05,
         2.8916e-05],
        [2.5815e-06, 1.1714e-04, 2.1680e-05,  ..., 6.6424e-06, 2.8698e-05,
         4.5048e-05]], device='cuda:0')]
DEBUG   [05-25 14:44:33] forward in Ensembler:
raw confidence
DEBUG   [05-25 14:44:33] forward in Ensembler:
[tensor([0.0007, 0.0011, 0.0005,  ..., 0.0006, 0.0012, 0.0004], device='cuda:0'), tensor([0.0003, 0.0013, 0.0008,  ..., 0.0006, 0.0009, 0.0005], device='cuda:0')]
DEBUG   [05-25 14:44:33] forward in Ensembler:
weighted predict
DEBUG   [05-25 14:44:33] forward in Ensembler:
[tensor([[2.0052e-06, 5.3943e-05, 1.1527e-04,  ..., 2.4975e-06, 2.1820e-05,
         6.6886e-05],
        [2.4339e-06, 7.5765e-05, 1.9952e-05,  ..., 3.3467e-05, 2.2558e-05,
         1.1785e-05],
        [2.9841e-06, 2.1537e-05, 4.7646e-05,  ..., 9.7458e-06, 1.5712e-05,
         3.6963e-05],
        ...,
        [5.9917e-06, 1.2542e-04, 4.0700e-05,  ..., 1.8532e-04, 3.9417e-05,
         2.0209e-05],
        [1.4994e-06, 1.0390e-05, 5.6464e-06,  ..., 3.1375e-06, 1.0854e-05,
         2.4247e-05],
        [6.4611e-06, 8.8254e-05, 8.2665e-05,  ..., 1.6877e-05, 1.4781e-05,
         4.1769e-05]], device='cuda:0'), tensor([[1.8299e-06, 2.9827e-05, 4.3365e-05,  ..., 6.5194e-06, 5.0393e-05,
         5.4794e-05],
        [2.6589e-06, 1.0070e-04, 2.1336e-05,  ..., 4.7493e-05, 2.6131e-05,
         2.5247e-05],
        [1.6296e-06, 1.8544e-05, 1.9832e-05,  ..., 4.5520e-06, 1.1073e-05,
         6.1375e-05],
        ...,
        [5.9406e-06, 1.1744e-04, 4.7045e-05,  ..., 8.1703e-05, 7.9231e-05,
         1.1042e-05],
        [7.4236e-07, 9.4645e-06, 4.6999e-06,  ..., 2.7700e-06, 1.5996e-05,
         2.8916e-05],
        [2.5815e-06, 1.1714e-04, 2.1680e-05,  ..., 6.6424e-06, 2.8698e-05,
         4.5048e-05]], device='cuda:0')]
DEBUG   [05-25 14:44:33] forward in Ensembler:
final predict
DEBUG   [05-25 14:44:33] forward in Ensembler:
tensor([[1.9175e-06, 4.1885e-05, 7.9316e-05,  ..., 4.5085e-06, 3.6106e-05,
         6.0840e-05],
        [2.5464e-06, 8.8233e-05, 2.0644e-05,  ..., 4.0480e-05, 2.4345e-05,
         1.8516e-05],
        [2.3069e-06, 2.0040e-05, 3.3739e-05,  ..., 7.1489e-06, 1.3393e-05,
         4.9169e-05],
        ...,
        [5.9662e-06, 1.2143e-04, 4.3872e-05,  ..., 1.3351e-04, 5.9324e-05,
         1.5625e-05],
        [1.1209e-06, 9.9274e-06, 5.1732e-06,  ..., 2.9537e-06, 1.3425e-05,
         2.6582e-05],
        [4.5213e-06, 1.0270e-04, 5.2172e-05,  ..., 1.1760e-05, 2.1740e-05,
         4.3408e-05]], device='cuda:0')
DEBUG   [05-25 14:44:33] forward in Ensembler:
final confidence
DEBUG   [05-25 14:44:33] forward in Ensembler:
tensor([0.0004, 0.0012, 0.0006,  ..., 0.0005, 0.0010, 0.0005], device='cuda:0')
DEBUG   [05-25 14:44:35] forward in Ensembler:
raw predict
DEBUG   [05-25 14:44:35] forward in Ensembler:
[tensor([[3.2093e-06, 1.7192e-05, 6.9101e-06,  ..., 6.8164e-06, 2.0339e-05,
         2.7720e-05],
        [1.5674e-06, 1.1947e-05, 2.8710e-06,  ..., 4.2037e-06, 5.3098e-06,
         8.5089e-06],
        [2.6932e-06, 5.5617e-05, 2.4534e-05,  ..., 5.4107e-06, 1.1367e-04,
         4.2412e-05],
        ...,
        [2.7692e-06, 4.2008e-05, 1.8581e-05,  ..., 6.2412e-05, 1.3965e-05,
         2.4488e-05],
        [3.7436e-06, 1.0639e-04, 2.8719e-05,  ..., 3.6718e-05, 3.2527e-05,
         2.6440e-05],
        [2.7478e-06, 1.9426e-05, 5.3276e-06,  ..., 5.6454e-06, 1.7636e-05,
         7.7657e-05]], device='cuda:0'), tensor([[2.2491e-06, 2.5660e-05, 2.2363e-06,  ..., 1.5431e-05, 3.9635e-05,
         1.0063e-05],
        [3.0666e-07, 1.6902e-05, 3.6144e-06,  ..., 4.4141e-07, 8.8335e-06,
         1.8580e-05],
        [1.9884e-06, 2.8406e-05, 1.2505e-05,  ..., 1.7270e-05, 1.5452e-04,
         2.8359e-05],
        ...,
        [2.3474e-06, 4.2058e-05, 1.4172e-05,  ..., 9.6129e-05, 1.3858e-05,
         2.0750e-05],
        [3.9023e-06, 7.4223e-05, 1.8801e-05,  ..., 3.6747e-05, 2.9678e-05,
         3.1324e-05],
        [2.5001e-06, 1.6366e-05, 3.6636e-06,  ..., 6.2192e-06, 2.4178e-05,
         8.5992e-05]], device='cuda:0')]
DEBUG   [05-25 14:44:35] forward in Ensembler:
raw confidence
DEBUG   [05-25 14:44:35] forward in Ensembler:
[tensor([0.0006, 0.0009, 0.0005,  ..., 0.0010, 0.0005, 0.0006], device='cuda:0'), tensor([0.0006, 0.0013, 0.0004,  ..., 0.0012, 0.0005, 0.0006], device='cuda:0')]
DEBUG   [05-25 14:44:35] forward in Ensembler:
weighted predict
DEBUG   [05-25 14:44:35] forward in Ensembler:
[tensor([[3.2093e-06, 1.7192e-05, 6.9101e-06,  ..., 6.8164e-06, 2.0339e-05,
         2.7720e-05],
        [1.5674e-06, 1.1947e-05, 2.8710e-06,  ..., 4.2037e-06, 5.3098e-06,
         8.5089e-06],
        [2.6932e-06, 5.5617e-05, 2.4534e-05,  ..., 5.4107e-06, 1.1367e-04,
         4.2412e-05],
        ...,
        [2.7692e-06, 4.2008e-05, 1.8581e-05,  ..., 6.2412e-05, 1.3965e-05,
         2.4488e-05],
        [3.7436e-06, 1.0639e-04, 2.8719e-05,  ..., 3.6718e-05, 3.2527e-05,
         2.6440e-05],
        [2.7478e-06, 1.9426e-05, 5.3276e-06,  ..., 5.6454e-06, 1.7636e-05,
         7.7657e-05]], device='cuda:0'), tensor([[2.2491e-06, 2.5660e-05, 2.2363e-06,  ..., 1.5431e-05, 3.9635e-05,
         1.0063e-05],
        [3.0666e-07, 1.6902e-05, 3.6144e-06,  ..., 4.4141e-07, 8.8335e-06,
         1.8580e-05],
        [1.9884e-06, 2.8406e-05, 1.2505e-05,  ..., 1.7270e-05, 1.5452e-04,
         2.8359e-05],
        ...,
        [2.3474e-06, 4.2058e-05, 1.4172e-05,  ..., 9.6129e-05, 1.3858e-05,
         2.0750e-05],
        [3.9023e-06, 7.4223e-05, 1.8801e-05,  ..., 3.6747e-05, 2.9678e-05,
         3.1324e-05],
        [2.5001e-06, 1.6366e-05, 3.6636e-06,  ..., 6.2192e-06, 2.4178e-05,
         8.5992e-05]], device='cuda:0')]
DEBUG   [05-25 14:44:35] forward in Ensembler:
final predict
DEBUG   [05-25 14:44:35] forward in Ensembler:
tensor([[2.7292e-06, 2.1426e-05, 4.5732e-06,  ..., 1.1124e-05, 2.9987e-05,
         1.8891e-05],
        [9.3705e-07, 1.4425e-05, 3.2427e-06,  ..., 2.3226e-06, 7.0717e-06,
         1.3544e-05],
        [2.3408e-06, 4.2011e-05, 1.8520e-05,  ..., 1.1341e-05, 1.3410e-04,
         3.5386e-05],
        ...,
        [2.5583e-06, 4.2033e-05, 1.6376e-05,  ..., 7.9271e-05, 1.3911e-05,
         2.2619e-05],
        [3.8230e-06, 9.0304e-05, 2.3760e-05,  ..., 3.6732e-05, 3.1103e-05,
         2.8882e-05],
        [2.6240e-06, 1.7896e-05, 4.4956e-06,  ..., 5.9323e-06, 2.0907e-05,
         8.1824e-05]], device='cuda:0')
DEBUG   [05-25 14:44:35] forward in Ensembler:
final confidence
DEBUG   [05-25 14:44:35] forward in Ensembler:
tensor([0.0006, 0.0010, 0.0004,  ..., 0.0011, 0.0005, 0.0006], device='cuda:0')
DEBUG   [05-25 14:44:37] forward in Ensembler:
raw predict
DEBUG   [05-25 14:44:37] forward in Ensembler:
[tensor([[4.3064e-06, 4.7730e-05, 1.0475e-05,  ..., 4.0930e-05, 6.1389e-06,
         8.8001e-06],
        [3.5048e-06, 6.9010e-05, 4.8247e-05,  ..., 1.6459e-05, 3.7333e-05,
         4.7106e-05],
        [1.3417e-06, 7.7871e-06, 5.7896e-06,  ..., 2.8801e-06, 9.6491e-06,
         4.6678e-05],
        ...,
        [3.4473e-06, 2.5548e-05, 2.9811e-06,  ..., 2.6910e-05, 7.3742e-06,
         2.5632e-05],
        [2.2773e-06, 3.9787e-06, 1.3923e-05,  ..., 1.2651e-05, 5.8447e-06,
         4.1980e-05],
        [4.0164e-06, 1.2192e-04, 2.3738e-05,  ..., 3.3086e-05, 4.7748e-06,
         9.2446e-06]], device='cuda:0'), tensor([[2.6536e-06, 7.3180e-05, 1.2133e-05,  ..., 3.3473e-05, 1.7782e-05,
         1.3524e-05],
        [8.2847e-06, 7.7178e-05, 4.2515e-05,  ..., 4.5189e-05, 5.7798e-05,
         3.5187e-05],
        [4.4698e-07, 2.5150e-06, 1.6563e-06,  ..., 3.6481e-07, 8.4477e-06,
         6.8980e-05],
        ...,
        [1.9394e-06, 2.0093e-05, 3.7387e-06,  ..., 1.2920e-05, 8.3961e-06,
         2.7426e-05],
        [1.4727e-06, 2.5842e-06, 5.7703e-06,  ..., 1.2251e-05, 6.6239e-06,
         6.1684e-05],
        [6.1881e-06, 1.9486e-04, 1.4074e-05,  ..., 7.5673e-05, 9.9653e-06,
         1.2253e-05]], device='cuda:0')]
DEBUG   [05-25 14:44:37] forward in Ensembler:
raw confidence
DEBUG   [05-25 14:44:37] forward in Ensembler:
[tensor([0.0018, 0.0006, 0.0020,  ..., 0.0007, 0.0009, 0.0015], device='cuda:0'), tensor([0.0015, 0.0008, 0.0023,  ..., 0.0006, 0.0009, 0.0042], device='cuda:0')]
DEBUG   [05-25 14:44:37] forward in Ensembler:
weighted predict
DEBUG   [05-25 14:44:37] forward in Ensembler:
[tensor([[4.3064e-06, 4.7730e-05, 1.0475e-05,  ..., 4.0930e-05, 6.1389e-06,
         8.8001e-06],
        [3.5048e-06, 6.9010e-05, 4.8247e-05,  ..., 1.6459e-05, 3.7333e-05,
         4.7106e-05],
        [1.3417e-06, 7.7871e-06, 5.7896e-06,  ..., 2.8801e-06, 9.6491e-06,
         4.6678e-05],
        ...,
        [3.4473e-06, 2.5548e-05, 2.9811e-06,  ..., 2.6910e-05, 7.3742e-06,
         2.5632e-05],
        [2.2773e-06, 3.9787e-06, 1.3923e-05,  ..., 1.2651e-05, 5.8447e-06,
         4.1980e-05],
        [4.0164e-06, 1.2192e-04, 2.3738e-05,  ..., 3.3086e-05, 4.7748e-06,
         9.2446e-06]], device='cuda:0'), tensor([[2.6536e-06, 7.3180e-05, 1.2133e-05,  ..., 3.3473e-05, 1.7782e-05,
         1.3524e-05],
        [8.2847e-06, 7.7178e-05, 4.2515e-05,  ..., 4.5189e-05, 5.7798e-05,
         3.5187e-05],
        [4.4698e-07, 2.5150e-06, 1.6563e-06,  ..., 3.6481e-07, 8.4477e-06,
         6.8980e-05],
        ...,
        [1.9394e-06, 2.0093e-05, 3.7387e-06,  ..., 1.2920e-05, 8.3961e-06,
         2.7426e-05],
        [1.4727e-06, 2.5842e-06, 5.7703e-06,  ..., 1.2251e-05, 6.6239e-06,
         6.1684e-05],
        [6.1881e-06, 1.9486e-04, 1.4074e-05,  ..., 7.5673e-05, 9.9653e-06,
         1.2253e-05]], device='cuda:0')]
DEBUG   [05-25 14:44:37] forward in Ensembler:
final predict
DEBUG   [05-25 14:44:37] forward in Ensembler:
tensor([[3.4800e-06, 6.0455e-05, 1.1304e-05,  ..., 3.7201e-05, 1.1960e-05,
         1.1162e-05],
        [5.8948e-06, 7.3094e-05, 4.5381e-05,  ..., 3.0824e-05, 4.7565e-05,
         4.1147e-05],
        [8.9436e-07, 5.1511e-06, 3.7229e-06,  ..., 1.6224e-06, 9.0484e-06,
         5.7829e-05],
        ...,
        [2.6934e-06, 2.2821e-05, 3.3599e-06,  ..., 1.9915e-05, 7.8851e-06,
         2.6529e-05],
        [1.8750e-06, 3.2815e-06, 9.8466e-06,  ..., 1.2451e-05, 6.2343e-06,
         5.1832e-05],
        [5.1022e-06, 1.5839e-04, 1.8906e-05,  ..., 5.4379e-05, 7.3700e-06,
         1.0749e-05]], device='cuda:0')
DEBUG   [05-25 14:44:37] forward in Ensembler:
final confidence
DEBUG   [05-25 14:44:37] forward in Ensembler:
tensor([0.0016, 0.0007, 0.0021,  ..., 0.0006, 0.0009, 0.0028], device='cuda:0')
DEBUG   [05-25 14:44:38] forward in Ensembler:
raw predict
DEBUG   [05-25 14:44:38] forward in Ensembler:
[tensor([[3.4252e-06, 1.3101e-05, 5.5619e-06,  ..., 3.8567e-06, 5.5695e-06,
         2.8082e-05],
        [2.8148e-06, 1.5001e-05, 6.1460e-06,  ..., 1.0618e-05, 4.0534e-05,
         9.9445e-05],
        [5.8510e-06, 2.8052e-05, 1.4663e-06,  ..., 8.1945e-06, 1.4669e-05,
         1.7587e-05],
        ...,
        [1.1534e-06, 6.4053e-05, 2.7977e-05,  ..., 5.0366e-05, 2.6633e-05,
         2.9206e-05],
        [1.8897e-06, 4.3530e-05, 4.2373e-05,  ..., 4.5777e-05, 1.5246e-05,
         1.9383e-05],
        [1.8988e-06, 4.8275e-06, 6.4347e-06,  ..., 8.3226e-06, 6.1106e-06,
         6.7560e-05]], device='cuda:0'), tensor([[2.5170e-06, 1.7845e-05, 4.6318e-06,  ..., 2.6697e-06, 7.0815e-06,
         3.8627e-05],
        [2.7119e-06, 9.4019e-06, 4.0987e-06,  ..., 1.8365e-05, 2.9072e-05,
         9.7771e-05],
        [3.9596e-06, 2.0922e-05, 1.2743e-05,  ..., 3.6915e-06, 3.9403e-05,
         2.9528e-05],
        ...,
        [7.5983e-07, 3.5041e-05, 2.0938e-05,  ..., 3.4084e-05, 3.4153e-05,
         2.5437e-05],
        [6.6937e-07, 2.5398e-05, 4.0629e-05,  ..., 2.2848e-05, 1.6624e-05,
         2.6982e-05],
        [1.3965e-06, 2.6361e-06, 3.4654e-06,  ..., 9.6773e-06, 1.0383e-05,
         5.4213e-05]], device='cuda:0')]
DEBUG   [05-25 14:44:39] forward in Ensembler:
raw confidence
DEBUG   [05-25 14:44:39] forward in Ensembler:
[tensor([0.0013, 0.0004, 0.0028,  ..., 0.0010, 0.0010, 0.0012], device='cuda:0'), tensor([0.0007, 0.0004, 0.0016,  ..., 0.0013, 0.0018, 0.0010], device='cuda:0')]
DEBUG   [05-25 14:44:39] forward in Ensembler:
weighted predict
DEBUG   [05-25 14:44:39] forward in Ensembler:
[tensor([[3.4252e-06, 1.3101e-05, 5.5619e-06,  ..., 3.8567e-06, 5.5695e-06,
         2.8082e-05],
        [2.8148e-06, 1.5001e-05, 6.1460e-06,  ..., 1.0618e-05, 4.0534e-05,
         9.9445e-05],
        [5.8510e-06, 2.8052e-05, 1.4663e-06,  ..., 8.1945e-06, 1.4669e-05,
         1.7587e-05],
        ...,
        [1.1534e-06, 6.4053e-05, 2.7977e-05,  ..., 5.0366e-05, 2.6633e-05,
         2.9206e-05],
        [1.8897e-06, 4.3530e-05, 4.2373e-05,  ..., 4.5777e-05, 1.5246e-05,
         1.9383e-05],
        [1.8988e-06, 4.8275e-06, 6.4347e-06,  ..., 8.3226e-06, 6.1106e-06,
         6.7560e-05]], device='cuda:0'), tensor([[2.5170e-06, 1.7845e-05, 4.6318e-06,  ..., 2.6697e-06, 7.0815e-06,
         3.8627e-05],
        [2.7119e-06, 9.4019e-06, 4.0987e-06,  ..., 1.8365e-05, 2.9072e-05,
         9.7771e-05],
        [3.9596e-06, 2.0922e-05, 1.2743e-05,  ..., 3.6915e-06, 3.9403e-05,
         2.9528e-05],
        ...,
        [7.5983e-07, 3.5041e-05, 2.0938e-05,  ..., 3.4084e-05, 3.4153e-05,
         2.5437e-05],
        [6.6937e-07, 2.5398e-05, 4.0629e-05,  ..., 2.2848e-05, 1.6624e-05,
         2.6982e-05],
        [1.3965e-06, 2.6361e-06, 3.4654e-06,  ..., 9.6773e-06, 1.0383e-05,
         5.4213e-05]], device='cuda:0')]
DEBUG   [05-25 14:44:39] forward in Ensembler:
final predict
DEBUG   [05-25 14:44:39] forward in Ensembler:
tensor([[2.9711e-06, 1.5473e-05, 5.0968e-06,  ..., 3.2632e-06, 6.3255e-06,
         3.3354e-05],
        [2.7633e-06, 1.2201e-05, 5.1223e-06,  ..., 1.4491e-05, 3.4803e-05,
         9.8608e-05],
        [4.9053e-06, 2.4487e-05, 7.1049e-06,  ..., 5.9430e-06, 2.7036e-05,
         2.3557e-05],
        ...,
        [9.5662e-07, 4.9547e-05, 2.4458e-05,  ..., 4.2225e-05, 3.0393e-05,
         2.7322e-05],
        [1.2796e-06, 3.4464e-05, 4.1501e-05,  ..., 3.4313e-05, 1.5935e-05,
         2.3182e-05],
        [1.6477e-06, 3.7318e-06, 4.9500e-06,  ..., 9.0000e-06, 8.2470e-06,
         6.0886e-05]], device='cuda:0')
DEBUG   [05-25 14:44:39] forward in Ensembler:
final confidence
DEBUG   [05-25 14:44:39] forward in Ensembler:
tensor([0.0009, 0.0004, 0.0022,  ..., 0.0011, 0.0014, 0.0011], device='cuda:0')
WARNING [05-25 14:45:06] get_exist_path in utils:
dir ___ablation_movies_ed_test_teacher/new_metrics_ed_teacher_T_3_narm_05-25_14:44_0/ensemble_model_logs does not exist! Create one.
INFO    [05-25 14:45:06] _evaluate in EnsembleSched:
!!Final Result!!: {'Recall@10': 0.10135126610596974, 'NDCG@10': 0.06013928832752364, 'MRR@10': 0.04762212222530728, 'Recall@5': 0.07005988629091353, 'NDCG@5': 0.050060132784502845, 'MRR@5': 0.04348533440913473, 'Recall*@10': 0.10491730982349032, 'NDCG*@10': 0.06337816250466165, 'MRR*@10': 0.050750418610516046, 'Recall*@5': 0.07396462559700012, 'NDCG*@5': 0.05341841990039462, 'MRR*@5': 0.04666820097537268, 'Recall**@10': 0.09084457939579374, 'NDCG**@10': 0.050557807087898254, 'MRR**@10': 0.03835147468461877, 'Recall**@5': 0.058559177886872066, 'NDCG**@5': 0.040125505289151556, 'MRR**@5': 0.03405188919887656}
