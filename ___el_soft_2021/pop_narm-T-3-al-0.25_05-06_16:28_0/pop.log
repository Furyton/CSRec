INFO    [05-06 16:28:22] setup_train in utils:
{
    "experiment_dir": "___el_soft_2021",
    "experiment_description": "pop",
    "describe": "{config[model_code]}-T-{config[T]}-al-{config[alpha]}",
    "dataset_name": "electronics.csv",
    "sched": "distill",
    "model_code": "narm",
    "mentor_code": "pop",
    "training_routine": "student",
    "softmaxed_mentor": false,
    "alpha": 0.25,
    "T": 3,
    "num_epochs": 60,
    "mode": [
        "train",
        "test"
    ],
    "max_len": 10,
    "test_state_path": null,
    "model_state_path": null,
    "mentor_state_path": null,
    "rand_seed": 2021,
    "load_processed_dataset": true,
    "save_processed_dataset": false,
    "dataset_cache_filename": null,
    "do_remap": false,
    "weight_decay": 0,
    "decay_step": 15,
    "gamma": 0.99,
    "lr": 0.001,
    "min_length": 5,
    "min_item_inter": 5,
    "good_only": false,
    "use_rating": true,
    "test_negative_sampler_code": "random",
    "test_negative_sample_size": 0,
    "dataloader_type": "next",
    "train_batch_size": 4096,
    "val_batch_size": 4096,
    "test_batch_size": 4096,
    "prop_sliding_window": -1.0,
    "worker_number": 2,
    "metric_ks": [
        5,
        10
    ],
    "device": "cuda",
    "num_gpu": 1,
    "optimizer": "Adam",
    "best_metric": "NDCG@10",
    "show_process_bar": false,
    "enable_sample": false,
    "samples_ratio": 0.1,
    "config_file": "config2.electronics/narm/config_distill.json",
    "task_id": -1,
    "split": "leave_one_out",
    "do_sampling": false,
    "path_for_sample": null,
    "sample_rate": 0.5,
    "sample_seed": 0,
    "train_negative_sampler_code": "random",
    "train_negative_sample_size": 100,
    "device_idx": "0",
    "momentum": null,
    "log_period_as_iter": 12800,
    "dvae_alpha": 0.5,
    "weight_list": [
        0.5,
        0.5
    ],
    "validation_rate": 0.2,
    "num_items": null,
    "start_index": 1,
    "kwargs": null
}
DEBUG   [05-06 16:28:22] __init__ in DistillSched:
DistillScheduler attribs: teacher tag=teacher_pop, student tag=student_narm
INFO    [05-06 16:28:22] _load_full_dataset_from_path in utils:
loading cache from /data01/wushiguang-slurm/Codes/soft-rec/Data/Cache/electronics-5-5.pkl
INFO    [05-06 16:28:24] _check_dataset_cache in utils:
check if the cache is generated under this configuration
INFO    [05-06 16:28:24] _check_dataset_cache in utils:
correct.
INFO    [05-06 16:28:24] __init__ in NextItemDataloader:
there are 29351 items in this dataset, 102187 users, padding_first? False
DEBUG   [05-06 16:28:39] generate_model in utils:
model_code_list=['pop']
INFO    [05-06 16:28:39] load_model_config in utils:
loading model pop's config file at asset/config/model/pop.json
INFO    [05-06 16:28:39] load_model_config in utils:
{}
WARNING [05-06 16:28:48] get_exist_path in utils:
dir ___el_soft_2021/pop_narm-T-3-al-0.25_05-06_16:28_0/teacher_pop_logs does not exist! Create one.
WARNING [05-06 16:28:48] get_exist_path in utils:
dir ___el_soft_2021/pop_narm-T-3-al-0.25_05-06_16:28_0/teacher_pop_logs/tb_vis does not exist! Create one.
WARNING [05-06 16:28:48] get_exist_path in utils:
dir ___el_soft_2021/pop_narm-T-3-al-0.25_05-06_16:28_0/teacher_pop_logs/checkpoint does not exist! Create one.
WARNING [05-06 16:28:48] get_path in utils:
Path is None
WARNING [05-06 16:28:48] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-06 16:28:48] __init__ in DistillSched:
teacher model: 
POPModel(
  (fake_parameter): Linear(in_features=1, out_features=1, bias=False)
)
INFO    [05-06 16:28:48] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-06 16:28:48] __init__ in BasicTrainer:
454656 iter per epoch
DEBUG   [05-06 16:28:48] generate_model in utils:
model_code_list=['narm']
INFO    [05-06 16:28:48] load_model_config in utils:
loading model narm's config file at asset/config/model/narm.json
INFO    [05-06 16:28:48] load_model_config in utils:
{
    "embedding_size": 64,
    "hidden_size": 128,
    "n_layers": 1,
    "dropout_probs": [
        0.25,
        0.5
    ]
}
WARNING [05-06 16:28:54] get_exist_path in utils:
dir ___el_soft_2021/pop_narm-T-3-al-0.25_05-06_16:28_0/student_narm_logs does not exist! Create one.
WARNING [05-06 16:28:54] get_exist_path in utils:
dir ___el_soft_2021/pop_narm-T-3-al-0.25_05-06_16:28_0/student_narm_logs/tb_vis does not exist! Create one.
WARNING [05-06 16:28:54] get_exist_path in utils:
dir ___el_soft_2021/pop_narm-T-3-al-0.25_05-06_16:28_0/student_narm_logs/checkpoint does not exist! Create one.
WARNING [05-06 16:28:54] get_path in utils:
Path is None
WARNING [05-06 16:28:54] load_state_from_given_path in utils:
Not given any path.
DEBUG   [05-06 16:28:54] __init__ in DistillSched:
student model: 
NARM(
  (item_embedding): Embedding(29352, 64, padding_idx=0)
  (emb_dropout): Dropout(p=0.25, inplace=False)
  (gru): GRU(64, 128, bias=False, batch_first=True)
  (a_1): Linear(in_features=128, out_features=128, bias=False)
  (a_2): Linear(in_features=128, out_features=128, bias=False)
  (v_t): Linear(in_features=128, out_features=1, bias=False)
  (ct_dropout): Dropout(p=0.5, inplace=False)
  (b): Linear(in_features=256, out_features=64, bias=False)
  (loss_fct): CrossEntropyLoss()
)
INFO    [05-06 16:28:54] assert_model_device in utils:
model student_narm has 7.63525390625 MB params.
INFO    [05-06 16:28:54] assert_model_device in utils:
model teacher_pop has 3.814697265625e-06 MB params.
INFO    [05-06 16:28:54] __init__ in DistillTrainer:
454656 iter per epoch
INFO    [05-06 16:28:54] _set_current_routine in Routine:
first routine: student
INFO    [05-06 16:28:54] run_routine in Routine:
Start routine student
INFO    [05-06 16:28:54] run_routine in Routine:
Start training
INFO    [05-06 16:28:54] train in DistillTrainer:
Test mentor model: teacher_pop
INFO    [05-06 16:29:35] test_mentor in DistillTrainer:
{'Recall@10': 0.04048062071204186, 'NDCG@10': 0.02167647883296013, 'MRR@10': 0.015917981527745723, 'Recall@5': 0.028058579713106154, 'NDCG@5': 0.017639418356120585, 'MRR@5': 0.014240672662854195, 'Recall*@10': 0.043127909898757935, 'NDCG*@10': 0.023359048739075662, 'MRR*@10': 0.017322874814271926, 'Recall*@5': 0.029491848796606063, 'NDCG*@5': 0.018924577198922633, 'MRR*@5': 0.015478770807385444}
INFO    [05-06 16:29:35] train in DistillTrainer:
result:
{'Recall@10': 0.04048062071204186, 'NDCG@10': 0.02167647883296013, 'MRR@10': 0.015917981527745723, 'Recall@5': 0.028058579713106154, 'NDCG@5': 0.017639418356120585, 'MRR@5': 0.014240672662854195, 'Recall*@10': 0.043127909898757935, 'NDCG*@10': 0.023359048739075662, 'MRR*@10': 0.017322874814271926, 'Recall*@5': 0.029491848796606063, 'NDCG*@5': 0.018924577198922633, 'MRR*@5': 0.015478770807385444}
INFO    [05-06 16:30:15] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-06 16:30:15] validate in BasicTrainer:
{'Recall@10': 0.000361328125, 'NDCG@10': 0.00016127488604979589, 'MRR@10': 0.00010046193085145206, 'Recall@5': 0.000224609375, 'NDCG@5': 0.00011851197865325958, 'MRR@5': 8.365885558305309e-05, 'Recall*@10': 0.000348900236422196, 'NDCG*@10': 0.0001629461967968382, 'MRR*@10': 0.00010581305505183992, 'Recall*@5': 0.000229010273469612, 'NDCG*@5': 0.0001252872875193134, 'MRR*@5': 9.091376879950985e-05}
INFO    [05-06 16:30:15] train in BasicTrainer:
epoch: 0
DEBUG   [05-06 16:30:16] calculate_loss in loss:
soft_target max: 0.5004648566246033, argmax 2146629
DEBUG   [05-06 16:30:16] calculate_loss in loss:
pred max in softmax: 3.4157266782131046e-05, argmax 9625995
INFO    [05-06 16:30:33] _train_one_epoch in BasicTrainer:
loss = 8.541255968111056
INFO    [05-06 16:31:13] log in loggers:
Update Best NDCG@10 Model at 0
INFO    [05-06 16:31:13] validate in BasicTrainer:
{'Recall@10': 0.03443475067615509, 'NDCG@10': 0.016761698126792908, 'MRR@10': 0.011469560153782367, 'Recall@5': 0.020070957392454146, 'NDCG@5': 0.012234769575297833, 'MRR@5': 0.00966980841010809, 'Recall*@10': 0.03725755050778389, 'NDCG*@10': 0.01863255474716425, 'MRR*@10': 0.013022318184375763, 'Recall*@5': 0.022865040078759193, 'NDCG*@5': 0.014074866212904453, 'MRR*@5': 0.011197437457740307}
INFO    [05-06 16:31:13] train in BasicTrainer:
duration: 58.37407684326172s
INFO    [05-06 16:31:13] train in BasicTrainer:
epoch: 1
INFO    [05-06 16:31:31] _train_one_epoch in BasicTrainer:
loss = 8.175791946617332
INFO    [05-06 16:32:10] log in loggers:
Update Best NDCG@10 Model at 1
INFO    [05-06 16:32:10] validate in BasicTrainer:
{'Recall@10': 0.037361223995685575, 'NDCG@10': 0.019977950006723404, 'MRR@10': 0.014724091067910195, 'Recall@5': 0.023638088926672934, 'NDCG@5': 0.015574872456490994, 'MRR@5': 0.01292694766074419, 'Recall*@10': 0.040559442043304444, 'NDCG*@10': 0.021877832338213922, 'MRR*@10': 0.01623912062495947, 'Recall*@5': 0.025581457167863846, 'NDCG*@5': 0.017079594023525716, 'MRR*@5': 0.014285144507884978}
INFO    [05-06 16:32:10] train in BasicTrainer:
duration: 57.32295870780945s
INFO    [05-06 16:32:10] train in BasicTrainer:
epoch: 2
INFO    [05-06 16:32:28] _train_one_epoch in BasicTrainer:
loss = 8.07360568347278
INFO    [05-06 16:33:08] validate in BasicTrainer:
{'Recall@10': 0.037377417981624604, 'NDCG@10': 0.01994227722287178, 'MRR@10': 0.014653396084904671, 'Recall@5': 0.024633646979928016, 'NDCG@5': 0.0158464290574193, 'MRR@5': 0.012977797351777554, 'Recall*@10': 0.04068238943815231, 'NDCG*@10': 0.022101675122976304, 'MRR*@10': 0.016451262943446635, 'Recall*@5': 0.027384260818362236, 'NDCG*@5': 0.017824874669313432, 'MRR*@5': 0.014699984341859818}
INFO    [05-06 16:33:08] train in BasicTrainer:
duration: 57.3512065410614s
INFO    [05-06 16:33:08] train in BasicTrainer:
epoch: 3
INFO    [05-06 16:33:26] _train_one_epoch in BasicTrainer:
loss = 7.935576322916392
INFO    [05-06 16:34:06] log in loggers:
Update Best NDCG@10 Model at 3
INFO    [05-06 16:34:06] validate in BasicTrainer:
{'Recall@10': 0.040882205963134764, 'NDCG@10': 0.022330848053097724, 'MRR@10': 0.01669687408953905, 'Recall@5': 0.027048434838652612, 'NDCG@5': 0.017897780686616897, 'MRR@5': 0.01489096138626337, 'Recall*@10': 0.04450653150677681, 'NDCG*@10': 0.02437877096235752, 'MRR*@10': 0.01826432555913925, 'Recall*@5': 0.02952183090150356, 'NDCG*@5': 0.01957431569695473, 'MRR*@5': 0.01630554296076298}
INFO    [05-06 16:34:06] train in BasicTrainer:
duration: 58.344305992126465s
INFO    [05-06 16:34:06] train in BasicTrainer:
epoch: 4
INFO    [05-06 16:34:23] _train_one_epoch in BasicTrainer:
loss = 7.867892931173514
INFO    [05-06 16:35:04] log in loggers:
Update Best NDCG@10 Model at 4
INFO    [05-06 16:35:04] validate in BasicTrainer:
{'Recall@10': 0.04204097792506218, 'NDCG@10': 0.022695269808173178, 'MRR@10': 0.016821999214589597, 'Recall@5': 0.027541001588106157, 'NDCG@5': 0.018045103885233404, 'MRR@5': 0.01492531668394804, 'Recall*@10': 0.04568553149700165, 'NDCG*@10': 0.02484831549227238, 'MRR*@10': 0.01852189306169748, 'Recall*@5': 0.030122604817152024, 'NDCG*@5': 0.01985716722905636, 'MRR*@5': 0.016486183144152164}
INFO    [05-06 16:35:04] train in BasicTrainer:
duration: 57.79190731048584s
INFO    [05-06 16:35:04] train in BasicTrainer:
epoch: 5
INFO    [05-06 16:35:21] _train_one_epoch in BasicTrainer:
loss = 7.808211391036575
INFO    [05-06 16:36:00] log in loggers:
Update Best NDCG@10 Model at 5
INFO    [05-06 16:36:00] validate in BasicTrainer:
{'Recall@10': 0.044266881495714186, 'NDCG@10': 0.023709605783224105, 'MRR@10': 0.017463073767721653, 'Recall@5': 0.0290687245875597, 'NDCG@5': 0.018829976245760917, 'MRR@5': 0.015469389706850053, 'Recall*@10': 0.048219898343086244, 'NDCG*@10': 0.026063983365893363, 'MRR*@10': 0.019332286790013312, 'Recall*@5': 0.03183456659317017, 'NDCG*@5': 0.020804000794887544, 'MRR*@5': 0.017183668203651904}
INFO    [05-06 16:36:00] train in BasicTrainer:
duration: 56.31084752082825s
INFO    [05-06 16:36:00] train in BasicTrainer:
epoch: 6
INFO    [05-06 16:36:18] _train_one_epoch in BasicTrainer:
loss = 7.7282290286845985
INFO    [05-06 16:36:58] log in loggers:
Update Best NDCG@10 Model at 6
INFO    [05-06 16:36:58] validate in BasicTrainer:
{'Recall@10': 0.04807856619358063, 'NDCG@10': 0.025868951827287674, 'MRR@10': 0.019133490771055223, 'Recall@5': 0.03156044274568558, 'NDCG@5': 0.02057304047048092, 'MRR@5': 0.01697436150163412, 'Recall*@10': 0.05198438838124275, 'NDCG*@10': 0.027948421463370322, 'MRR*@10': 0.02065589316189289, 'Recall*@5': 0.03413061134517193, 'NDCG*@5': 0.02221806041896343, 'MRR*@5': 0.018315948359668256}
INFO    [05-06 16:36:58] train in BasicTrainer:
duration: 58.1748321056366s
INFO    [05-06 16:36:58] train in BasicTrainer:
epoch: 7
INFO    [05-06 16:37:16] _train_one_epoch in BasicTrainer:
loss = 7.654462621018693
INFO    [05-06 16:37:55] log in loggers:
Update Best NDCG@10 Model at 7
INFO    [05-06 16:37:55] validate in BasicTrainer:
{'Recall@10': 0.04882128939032555, 'NDCG@10': 0.026372142136096954, 'MRR@10': 0.019557723626494408, 'Recall@5': 0.03193314358592034, 'NDCG@5': 0.02094373308122158, 'MRR@5': 0.017336494661867617, 'Recall*@10': 0.052838350832462314, 'NDCG*@10': 0.028648924455046652, 'MRR*@10': 0.02131009191274643, 'Recall*@5': 0.03464852213859558, 'NDCG*@5': 0.02280483141541481, 'MRR*@5': 0.018920230939984323}
INFO    [05-06 16:37:55] train in BasicTrainer:
duration: 56.830520153045654s
INFO    [05-06 16:37:55] train in BasicTrainer:
epoch: 8
INFO    [05-06 16:38:13] _train_one_epoch in BasicTrainer:
loss = 7.601511113278501
INFO    [05-06 16:38:53] log in loggers:
Update Best NDCG@10 Model at 8
INFO    [05-06 16:38:53] validate in BasicTrainer:
{'Recall@10': 0.05018740549683571, 'NDCG@10': 0.027322019189596175, 'MRR@10': 0.020388633012771606, 'Recall@5': 0.03284188240766525, 'NDCG@5': 0.021745313704013825, 'MRR@5': 0.018106120526790618, 'Recall*@10': 0.054041004478931426, 'NDCG*@10': 0.02961056597530842, 'MRR*@10': 0.022200594320893288, 'Recall*@5': 0.03566909983754158, 'NDCG*@5': 0.023708314895629884, 'MRR*@5': 0.01978739269077778}
INFO    [05-06 16:38:53] train in BasicTrainer:
duration: 57.70141124725342s
INFO    [05-06 16:38:53] train in BasicTrainer:
epoch: 9
DEBUG   [05-06 16:38:54] calculate_loss in loss:
soft_target max: 0.5004648566246033, argmax 3203301
DEBUG   [05-06 16:38:54] calculate_loss in loss:
pred max in softmax: 0.16038808226585388, argmax 97682509
DEBUG   [05-06 16:38:54] calculate_loss in loss:
soft_target max: 0.5004648566246033, argmax 385509
DEBUG   [05-06 16:38:54] calculate_loss in loss:
pred max in softmax: 0.15458367764949799, argmax 38143419
INFO    [05-06 16:39:10] _train_one_epoch in BasicTrainer:
loss = 7.560625119252248
INFO    [05-06 16:39:49] log in loggers:
Update Best NDCG@10 Model at 9
INFO    [05-06 16:39:49] validate in BasicTrainer:
{'Recall@10': 0.05077441439032555, 'NDCG@10': 0.027636628523468973, 'MRR@10': 0.02062008559703827, 'Recall@5': 0.03318314358592033, 'NDCG@5': 0.021976000592112542, 'MRR@5': 0.01830007128417492, 'Recall*@10': 0.05479719132184982, 'NDCG*@10': 0.030032063722610473, 'MRR*@10': 0.022521131187677384, 'Recall*@5': 0.036056821346282956, 'NDCG*@5': 0.023999520018696784, 'MRR*@5': 0.02004744753241539}
INFO    [05-06 16:39:49] train in BasicTrainer:
duration: 56.56050634384155s
INFO    [05-06 16:39:49] train in BasicTrainer:
epoch: 10
INFO    [05-06 16:40:07] _train_one_epoch in BasicTrainer:
loss = 7.5245936668670925
INFO    [05-06 16:40:48] validate in BasicTrainer:
{'Recall@10': 0.05054926931858063, 'NDCG@10': 0.027601297572255136, 'MRR@10': 0.020631208568811416, 'Recall@5': 0.033590085655450824, 'NDCG@5': 0.022140970379114153, 'MRR@5': 0.018391357026994227, 'Recall*@10': 0.05446887820959091, 'NDCG*@10': 0.02966399908065796, 'MRR*@10': 0.022126316502690316, 'Recall*@5': 0.03615954220294952, 'NDCG*@5': 0.023769396394491195, 'MRR*@5': 0.01970857337117195}
INFO    [05-06 16:40:48] train in BasicTrainer:
duration: 58.056360721588135s
INFO    [05-06 16:40:48] train in BasicTrainer:
epoch: 11
INFO    [05-06 16:41:04] _train_one_epoch in BasicTrainer:
loss = 7.489815179292147
INFO    [05-06 16:41:44] log in loggers:
Update Best NDCG@10 Model at 11
INFO    [05-06 16:41:44] validate in BasicTrainer:
{'Recall@10': 0.051346177458763125, 'NDCG@10': 0.028074989020824434, 'MRR@10': 0.02102188766002655, 'Recall@5': 0.0338825187087059, 'NDCG@5': 0.022465229034423828, 'MRR@5': 0.01872842535376549, 'Recall*@10': 0.05560106530785561, 'NDCG*@10': 0.030437165647745134, 'MRR*@10': 0.022807709723711014, 'Recall*@5': 0.036901348680257795, 'NDCG*@5': 0.024432328417897223, 'MRR*@5': 0.02035382717847824}
INFO    [05-06 16:41:44] train in BasicTrainer:
duration: 56.42475748062134s
INFO    [05-06 16:41:44] train in BasicTrainer:
epoch: 12
INFO    [05-06 16:42:02] _train_one_epoch in BasicTrainer:
loss = 7.45322847795916
INFO    [05-06 16:42:42] log in loggers:
Update Best NDCG@10 Model at 12
INFO    [05-06 16:42:42] validate in BasicTrainer:
{'Recall@10': 0.052180005460977556, 'NDCG@10': 0.028521158024668692, 'MRR@10': 0.02135708004236221, 'Recall@5': 0.03398392483592033, 'NDCG@5': 0.022668614014983178, 'MRR@5': 0.018959739804267885, 'Recall*@10': 0.05644356369972229, 'NDCG*@10': 0.030922555923461915, 'MRR*@10': 0.023188607394695283, 'Recall*@5': 0.03704459771513939, 'NDCG*@5': 0.02468170113861561, 'MRR*@5': 0.020631206557154655}
INFO    [05-06 16:42:42] train in BasicTrainer:
duration: 57.980304479599s
INFO    [05-06 16:42:42] train in BasicTrainer:
epoch: 13
INFO    [05-06 16:42:59] _train_one_epoch in BasicTrainer:
loss = 7.416677943221083
INFO    [05-06 16:43:38] log in loggers:
Update Best NDCG@10 Model at 13
INFO    [05-06 16:43:38] validate in BasicTrainer:
{'Recall@10': 0.05191740497946739, 'NDCG@10': 0.028627779856324195, 'MRR@10': 0.021552775427699088, 'Recall@5': 0.03480852290987969, 'NDCG@5': 0.023129861280322076, 'MRR@5': 0.019303891211748123, 'Recall*@10': 0.05624857947230339, 'NDCG*@10': 0.031116140931844713, 'MRR*@10': 0.023477414473891258, 'Recall*@5': 0.03801814928650856, 'NDCG*@5': 0.02525990203022957, 'MRR*@5': 0.021083155125379564}
INFO    [05-06 16:43:38] train in BasicTrainer:
duration: 56.1740882396698s
INFO    [05-06 16:43:38] train in BasicTrainer:
epoch: 14
INFO    [05-06 16:43:56] _train_one_epoch in BasicTrainer:
loss = 7.380649802921055
INFO    [05-06 16:44:36] log in loggers:
Update Best NDCG@10 Model at 14
INFO    [05-06 16:44:36] validate in BasicTrainer:
{'Recall@10': 0.052192985117435454, 'NDCG@10': 0.02875819116830826, 'MRR@10': 0.02163871333003044, 'Recall@5': 0.03494083285331726, 'NDCG@5': 0.023222784101963042, 'MRR@5': 0.019379516541957856, 'Recall*@10': 0.05666265815496445, 'NDCG*@10': 0.031326516345143315, 'MRR*@10': 0.023626616671681405, 'Recall*@5': 0.03819386243820191, 'NDCG*@5': 0.02540362983942032, 'MRR*@5': 0.021210989356040953}
INFO    [05-06 16:44:36] train in BasicTrainer:
duration: 58.21041679382324s
INFO    [05-06 16:44:36] train in BasicTrainer:
epoch: 15
INFO    [05-06 16:44:54] _train_one_epoch in BasicTrainer:
loss = 7.341897779756838
INFO    [05-06 16:45:33] log in loggers:
Update Best NDCG@10 Model at 15
INFO    [05-06 16:45:33] validate in BasicTrainer:
{'Recall@10': 0.05257223755121231, 'NDCG@10': 0.028916416317224504, 'MRR@10': 0.02173466645181179, 'Recall@5': 0.035115542709827426, 'NDCG@5': 0.023306877836585044, 'MRR@5': 0.019440237656235693, 'Recall*@10': 0.057076587080955504, 'NDCG*@10': 0.031510277464985845, 'MRR*@10': 0.023752918243408205, 'Recall*@5': 0.038102912902832034, 'NDCG*@5': 0.0254177176207304, 'MRR*@5': 0.021263350248336792}
INFO    [05-06 16:45:33] train in BasicTrainer:
duration: 56.715107679367065s
INFO    [05-06 16:45:33] train in BasicTrainer:
epoch: 16
INFO    [05-06 16:45:50] _train_one_epoch in BasicTrainer:
loss = 7.307321922199146
INFO    [05-06 16:46:30] log in loggers:
Update Best NDCG@10 Model at 16
INFO    [05-06 16:46:30] validate in BasicTrainer:
{'Recall@10': 0.05350532874464989, 'NDCG@10': 0.029716516956686975, 'MRR@10': 0.022502281069755554, 'Recall@5': 0.03561466097831726, 'NDCG@5': 0.023979759439826012, 'MRR@5': 0.02016341917216778, 'Recall*@10': 0.05822408348321915, 'NDCG*@10': 0.03249673791229725, 'MRR*@10': 0.024693491831421853, 'Recall*@5': 0.038861899822950366, 'NDCG*@5': 0.026280052959918976, 'MRR*@5': 0.022154412493109704}
INFO    [05-06 16:46:30] train in BasicTrainer:
duration: 57.383023500442505s
INFO    [05-06 16:46:30] train in BasicTrainer:
epoch: 17
INFO    [05-06 16:46:48] _train_one_epoch in BasicTrainer:
loss = 7.270737308639664
INFO    [05-06 16:47:27] log in loggers:
Update Best NDCG@10 Model at 17
INFO    [05-06 16:47:27] validate in BasicTrainer:
{'Recall@10': 0.054092337638139726, 'NDCG@10': 0.03000521466135979, 'MRR@10': 0.02271230436861515, 'Recall@5': 0.03585558742284775, 'NDCG@5': 0.02417348191142082, 'MRR@5': 0.020343574434518813, 'Recall*@10': 0.05859004035592079, 'NDCG*@10': 0.032593757957220075, 'MRR*@10': 0.02471809245646, 'Recall*@5': 0.038896889090538025, 'NDCG*@5': 0.02628382235765457, 'MRR*@5': 0.022147924974560737}
INFO    [05-06 16:47:27] train in BasicTrainer:
duration: 56.67044115066528s
INFO    [05-06 16:47:27] train in BasicTrainer:
epoch: 18
DEBUG   [05-06 16:47:28] calculate_loss in loss:
soft_target max: 0.5004648566246033, argmax 444213
DEBUG   [05-06 16:47:28] calculate_loss in loss:
pred max in softmax: 0.9054341316223145, argmax 93759268
DEBUG   [05-06 16:47:28] calculate_loss in loss:
soft_target max: 0.5004648566246033, argmax 6960357
DEBUG   [05-06 16:47:28] calculate_loss in loss:
pred max in softmax: 0.332830011844635, argmax 6774824
INFO    [05-06 16:47:44] _train_one_epoch in BasicTrainer:
loss = 7.235597709277728
INFO    [05-06 16:48:24] validate in BasicTrainer:
{'Recall@10': 0.05367509424686432, 'NDCG@10': 0.029900368750095368, 'MRR@10': 0.022669916078448295, 'Recall@5': 0.036446881890296934, 'NDCG@5': 0.024361452460289, 'MRR@5': 0.020402959063649178, 'Recall*@10': 0.05796760216355324, 'NDCG*@10': 0.03245552740991116, 'MRR*@10': 0.02469037637114525, 'Recall*@5': 0.03964441254734993, 'NDCG*@5': 0.02656113289296627, 'MRR*@5': 0.02227583363652229}
INFO    [05-06 16:48:24] train in BasicTrainer:
duration: 57.28447699546814s
INFO    [05-06 16:48:24] train in BasicTrainer:
epoch: 19
INFO    [05-06 16:48:42] _train_one_epoch in BasicTrainer:
loss = 7.2008138519149645
INFO    [05-06 16:49:21] log in loggers:
Update Best NDCG@10 Model at 19
INFO    [05-06 16:49:22] validate in BasicTrainer:
{'Recall@10': 0.05445366576313972, 'NDCG@10': 0.030345039665699004, 'MRR@10': 0.02303060546517372, 'Recall@5': 0.036281401962041854, 'NDCG@5': 0.024508191719651223, 'MRR@5': 0.02064505696296692, 'Recall*@10': 0.0591270337998867, 'NDCG*@10': 0.032994616106152536, 'MRR*@10': 0.025063662752509118, 'Recall*@5': 0.03951732605695724, 'NDCG*@5': 0.026691757962107657, 'MRR*@5': 0.022485178783535956}
INFO    [05-06 16:49:22] train in BasicTrainer:
duration: 57.189587116241455s
INFO    [05-06 16:49:22] train in BasicTrainer:
epoch: 20
INFO    [05-06 16:49:39] _train_one_epoch in BasicTrainer:
loss = 7.165000262561145
INFO    [05-06 16:50:19] log in loggers:
Update Best NDCG@10 Model at 20
INFO    [05-06 16:50:19] validate in BasicTrainer:
{'Recall@10': 0.05476348727941513, 'NDCG@10': 0.03054622605443001, 'MRR@10': 0.02319023810327053, 'Recall@5': 0.037090877443552016, 'NDCG@5': 0.024865378215909003, 'MRR@5': 0.020865890830755233, 'Recall*@10': 0.059279565513134, 'NDCG*@10': 0.03309935674071312, 'MRR*@10': 0.02514469191431999, 'Recall*@5': 0.04030857115983963, 'NDCG*@5': 0.027006392255425452, 'MRR*@5': 0.022654858827590944}
INFO    [05-06 16:50:19] train in BasicTrainer:
duration: 57.76969790458679s
INFO    [05-06 16:50:19] train in BasicTrainer:
epoch: 21
INFO    [05-06 16:50:36] _train_one_epoch in BasicTrainer:
loss = 7.132000553715336
INFO    [05-06 16:51:16] log in loggers:
Update Best NDCG@10 Model at 21
INFO    [05-06 16:51:16] validate in BasicTrainer:
{'Recall@10': 0.05625321924686432, 'NDCG@10': 0.031383563056588175, 'MRR@10': 0.023839561343193053, 'Recall@5': 0.037678422033786775, 'NDCG@5': 0.02542430229485035, 'MRR@5': 0.02140778936445713, 'Recall*@10': 0.06082420915365219, 'NDCG*@10': 0.03394953466951847, 'MRR*@10': 0.025794503390789033, 'Recall*@5': 0.040752834230661394, 'NDCG*@5': 0.02750124529004097, 'MRR*@5': 0.023157852441072463}
INFO    [05-06 16:51:16] train in BasicTrainer:
duration: 56.729714155197144s
INFO    [05-06 16:51:16] train in BasicTrainer:
epoch: 22
INFO    [05-06 16:51:35] _train_one_epoch in BasicTrainer:
loss = 7.09825409640063
INFO    [05-06 16:52:15] validate in BasicTrainer:
{'Recall@10': 0.05520442426204682, 'NDCG@10': 0.031015992015600204, 'MRR@10': 0.02365726575255394, 'Recall@5': 0.0373051854968071, 'NDCG@5': 0.02525884084403515, 'MRR@5': 0.021299694627523423, 'Recall*@10': 0.05945850193500519, 'NDCG*@10': 0.033399921879172324, 'MRR*@10': 0.025468400716781615, 'Recall*@5': 0.04037684574723244, 'NDCG*@5': 0.02726367026567459, 'MRR*@5': 0.02295622244477272}
INFO    [05-06 16:52:15] train in BasicTrainer:
duration: 59.16690468788147s
INFO    [05-06 16:52:15] train in BasicTrainer:
epoch: 23
INFO    [05-06 16:52:33] _train_one_epoch in BasicTrainer:
loss = 7.065707335600981
INFO    [05-06 16:53:12] validate in BasicTrainer:
{'Recall@10': 0.05589510530233383, 'NDCG@10': 0.03133634269237518, 'MRR@10': 0.023883726596832276, 'Recall@5': 0.03760083273053169, 'NDCG@5': 0.02547052338719368, 'MRR@5': 0.02149179905653, 'Recall*@10': 0.060143934786319735, 'NDCG*@10': 0.03390973255038261, 'MRR*@10': 0.02594492256641388, 'Recall*@5': 0.04065845817327499, 'NDCG*@5': 0.027657169327139856, 'MRR*@5': 0.023392578959465025}
INFO    [05-06 16:53:12] train in BasicTrainer:
duration: 56.52663493156433s
INFO    [05-06 16:53:12] train in BasicTrainer:
epoch: 24
INFO    [05-06 16:53:29] _train_one_epoch in BasicTrainer:
loss = 7.033928394317627
INFO    [05-06 16:54:09] log in loggers:
Update Best NDCG@10 Model at 24
INFO    [05-06 16:54:09] validate in BasicTrainer:
{'Recall@10': 0.056375227868556976, 'NDCG@10': 0.03170728497207165, 'MRR@10': 0.024206753373146057, 'Recall@5': 0.03828656911849976, 'NDCG@5': 0.025897109359502794, 'MRR@5': 0.021831444352865218, 'Recall*@10': 0.060795897394418714, 'NDCG*@10': 0.03417639315128326, 'MRR*@10': 0.026087272316217422, 'Recall*@5': 0.04120073229074478, 'NDCG*@5': 0.02787994682788849, 'MRR*@5': 0.023511794432997703}
INFO    [05-06 16:54:09] train in BasicTrainer:
duration: 57.23424577713013s
INFO    [05-06 16:54:09] train in BasicTrainer:
epoch: 25
INFO    [05-06 16:54:26] _train_one_epoch in BasicTrainer:
loss = 7.002775110639967
INFO    [05-06 16:55:05] log in loggers:
Update Best NDCG@10 Model at 25
INFO    [05-06 16:55:06] validate in BasicTrainer:
{'Recall@10': 0.057555261552333835, 'NDCG@10': 0.03230584979057312, 'MRR@10': 0.024634821638464928, 'Recall@5': 0.03913671419024468, 'NDCG@5': 0.026401272043585777, 'MRR@5': 0.022227808088064193, 'Recall*@10': 0.06202635198831558, 'NDCG*@10': 0.03482016533613205, 'MRR*@10': 0.02655715458095074, 'Recall*@5': 0.042159132063388824, 'NDCG*@5': 0.028454701229929925, 'MRR*@5': 0.023964404314756393}
INFO    [05-06 16:55:06] train in BasicTrainer:
duration: 56.48749041557312s
INFO    [05-06 16:55:06] train in BasicTrainer:
epoch: 26
INFO    [05-06 16:55:23] _train_one_epoch in BasicTrainer:
loss = 6.972015690159154
INFO    [05-06 16:56:03] validate in BasicTrainer:
{'Recall@10': 0.057315406203269956, 'NDCG@10': 0.032123755812644955, 'MRR@10': 0.024468056187033654, 'Recall@5': 0.03838261842727661, 'NDCG@5': 0.02602348044514656, 'MRR@5': 0.021963671743869782, 'Recall*@10': 0.06167351961135864, 'NDCG*@10': 0.034598048478364944, 'MRR*@10': 0.02637390486896038, 'Recall*@5': 0.041314808279275896, 'NDCG*@5': 0.028041254654526712, 'MRR*@5': 0.023683795779943465}
INFO    [05-06 16:56:03] train in BasicTrainer:
duration: 57.15752100944519s
INFO    [05-06 16:56:03] train in BasicTrainer:
epoch: 27
DEBUG   [05-06 16:56:04] calculate_loss in loss:
soft_target max: 0.5004648566246033, argmax 5287293
DEBUG   [05-06 16:56:04] calculate_loss in loss:
pred max in softmax: 0.8636409640312195, argmax 50779492
DEBUG   [05-06 16:56:04] calculate_loss in loss:
soft_target max: 0.5004648566246033, argmax 2968485
DEBUG   [05-06 16:56:04] calculate_loss in loss:
pred max in softmax: 0.6623626947402954, argmax 24650812
INFO    [05-06 16:56:21] _train_one_epoch in BasicTrainer:
loss = 6.943157475273888
INFO    [05-06 16:57:00] log in loggers:
Update Best NDCG@10 Model at 27
INFO    [05-06 16:57:00] validate in BasicTrainer:
{'Recall@10': 0.05837009370326996, 'NDCG@10': 0.032867239490151405, 'MRR@10': 0.025112326964735986, 'Recall@5': 0.03988104447722435, 'NDCG@5': 0.026915857791900633, 'MRR@5': 0.022671917527914046, 'Recall*@10': 0.06265850260853767, 'NDCG*@10': 0.03534296728670597, 'MRR*@10': 0.027035426497459412, 'Recall*@5': 0.0430148945748806, 'NDCG*@5': 0.02902114138007164, 'MRR*@5': 0.024443884566426276}
INFO    [05-06 16:57:00] train in BasicTrainer:
duration: 57.322158336639404s
INFO    [05-06 16:57:00] train in BasicTrainer:
epoch: 28
INFO    [05-06 16:57:17] _train_one_epoch in BasicTrainer:
loss = 6.917600300934938
INFO    [05-06 16:57:57] validate in BasicTrainer:
{'Recall@10': 0.057472727596759796, 'NDCG@10': 0.03255480639636517, 'MRR@10': 0.02499279096722603, 'Recall@5': 0.03880682572722435, 'NDCG@5': 0.02655784033238888, 'MRR@5': 0.02254037782549858, 'Recall*@10': 0.06163735628128052, 'NDCG*@10': 0.034902990087866785, 'MRR*@10': 0.02678483575582504, 'Recall*@5': 0.04171744897961616, 'NDCG*@5': 0.028500745445489882, 'MRR*@5': 0.02416538380086422}
INFO    [05-06 16:57:57] train in BasicTrainer:
duration: 57.221646308898926s
INFO    [05-06 16:57:57] train in BasicTrainer:
epoch: 29
INFO    [05-06 16:58:15] _train_one_epoch in BasicTrainer:
loss = 6.888414498921987
INFO    [05-06 16:58:54] log in loggers:
Update Best NDCG@10 Model at 29
INFO    [05-06 16:58:54] validate in BasicTrainer:
{'Recall@10': 0.05866895526647568, 'NDCG@10': 0.03333071120083332, 'MRR@10': 0.025628670006990432, 'Recall@5': 0.03994017392396927, 'NDCG@5': 0.027307212352752686, 'MRR@5': 0.02316203735768795, 'Recall*@10': 0.06295728579163551, 'NDCG*@10': 0.03574062593281269, 'MRR*@10': 0.027461829110980034, 'Recall*@5': 0.042971026450395584, 'NDCG*@5': 0.02930831216275692, 'MRR*@5': 0.024825413823127748}
INFO    [05-06 16:58:54] train in BasicTrainer:
duration: 56.97094750404358s
INFO    [05-06 16:58:54] train in BasicTrainer:
epoch: 30
INFO    [05-06 16:59:13] _train_one_epoch in BasicTrainer:
loss = 6.862387919211173
INFO    [05-06 16:59:53] validate in BasicTrainer:
{'Recall@10': 0.058817046582698825, 'NDCG@10': 0.03332430370151997, 'MRR@10': 0.025585579797625543, 'Recall@5': 0.03999876767396927, 'NDCG@5': 0.027290497347712515, 'MRR@5': 0.023125245422124862, 'Recall*@10': 0.06299228399991989, 'NDCG*@10': 0.03572356559336185, 'MRR*@10': 0.02744265228509903, 'Recall*@5': 0.04308866083621979, 'NDCG*@5': 0.02934669964015484, 'MRR*@5': 0.02484521895647049}
INFO    [05-06 16:59:53] train in BasicTrainer:
duration: 58.74932241439819s
INFO    [05-06 16:59:53] train in BasicTrainer:
epoch: 31
INFO    [05-06 17:00:11] _train_one_epoch in BasicTrainer:
loss = 6.836868548178458
INFO    [05-06 17:00:50] log in loggers:
Update Best NDCG@10 Model at 31
INFO    [05-06 17:00:50] validate in BasicTrainer:
{'Recall@10': 0.05968136608600617, 'NDCG@10': 0.03411861039698124, 'MRR@10': 0.02636346936225891, 'Recall@5': 0.040166390389204026, 'NDCG@5': 0.027832739055156708, 'MRR@5': 0.023783647418022157, 'Recall*@10': 0.06363623008131981, 'NDCG*@10': 0.03648143082857132, 'MRR*@10': 0.028237440958619117, 'Recall*@5': 0.043110867142677305, 'NDCG*@5': 0.02986604370176792, 'MRR*@5': 0.025520097836852072}
INFO    [05-06 17:00:50] train in BasicTrainer:
duration: 56.891995429992676s
INFO    [05-06 17:00:50] train in BasicTrainer:
epoch: 32
INFO    [05-06 17:01:08] _train_one_epoch in BasicTrainer:
loss = 6.812838193532583
INFO    [05-06 17:01:48] log in loggers:
Update Best NDCG@10 Model at 32
INFO    [05-06 17:01:48] validate in BasicTrainer:
{'Recall@10': 0.0599910643696785, 'NDCG@10': 0.03431386306881905, 'MRR@10': 0.02650220975279808, 'Recall@5': 0.041153254210948946, 'NDCG@5': 0.028253332152962683, 'MRR@5': 0.024019299298524855, 'Recall*@10': 0.06401532486081124, 'NDCG*@10': 0.03663237243890762, 'MRR*@10': 0.028294389247894288, 'Recall*@5': 0.04412778466939926, 'NDCG*@5': 0.03022897310554981, 'MRR*@5': 0.02566801518201828}
INFO    [05-06 17:01:48] train in BasicTrainer:
duration: 58.58183765411377s
INFO    [05-06 17:01:48] train in BasicTrainer:
epoch: 33
INFO    [05-06 17:02:06] _train_one_epoch in BasicTrainer:
loss = 6.790949791401356
INFO    [05-06 17:02:45] log in loggers:
Update Best NDCG@10 Model at 33
INFO    [05-06 17:02:45] validate in BasicTrainer:
{'Recall@10': 0.06019399970769882, 'NDCG@10': 0.03457081168889999, 'MRR@10': 0.026768887117505073, 'Recall@5': 0.041573176085948946, 'NDCG@5': 0.028582087978720666, 'MRR@5': 0.02431645564734936, 'Recall*@10': 0.06420715123414994, 'NDCG*@10': 0.03683401241898537, 'MRR*@10': 0.02849431850016117, 'Recall*@5': 0.044382603764534, 'NDCG*@5': 0.030454204678535463, 'MRR*@5': 0.02587947905063629}
INFO    [05-06 17:02:45] train in BasicTrainer:
duration: 57.01774740219116s
INFO    [05-06 17:02:45] train in BasicTrainer:
epoch: 34
INFO    [05-06 17:03:04] _train_one_epoch in BasicTrainer:
loss = 6.768801250973263
INFO    [05-06 17:03:44] log in loggers:
Update Best NDCG@10 Model at 34
INFO    [05-06 17:03:44] validate in BasicTrainer:
{'Recall@10': 0.0600501936674118, 'NDCG@10': 0.03463233716785908, 'MRR@10': 0.026889416798949243, 'Recall@5': 0.0417017363011837, 'NDCG@5': 0.02872762717306614, 'MRR@5': 0.024469040408730505, 'Recall*@10': 0.06404410943388938, 'NDCG*@10': 0.037035515755414965, 'MRR*@10': 0.02880176529288292, 'Recall*@5': 0.044681372493505477, 'NDCG*@5': 0.030803335756063463, 'MRR*@5': 0.02624652363359928}
INFO    [05-06 17:03:44] train in BasicTrainer:
duration: 58.37625527381897s
INFO    [05-06 17:03:44] train in BasicTrainer:
epoch: 35
INFO    [05-06 17:04:02] _train_one_epoch in BasicTrainer:
loss = 6.7479968629441816
INFO    [05-06 17:04:41] log in loggers:
Update Best NDCG@10 Model at 35
INFO    [05-06 17:04:41] validate in BasicTrainer:
{'Recall@10': 0.0601387432217598, 'NDCG@10': 0.03488786913454533, 'MRR@10': 0.027198706343770026, 'Recall@5': 0.0419295597076416, 'NDCG@5': 0.029040270894765855, 'MRR@5': 0.024809097200632096, 'Recall*@10': 0.06412693902850151, 'NDCG*@10': 0.03721749596297741, 'MRR*@10': 0.029020945131778716, 'Recall*@5': 0.04497983396053314, 'NDCG*@5': 0.031078755855560303, 'MRR*@5': 0.02651833266019821}
INFO    [05-06 17:04:41] train in BasicTrainer:
duration: 57.51380753517151s
INFO    [05-06 17:04:41] train in BasicTrainer:
epoch: 36
DEBUG   [05-06 17:04:43] calculate_loss in loss:
soft_target max: 0.5004648566246033, argmax 12067605
DEBUG   [05-06 17:04:43] calculate_loss in loss:
pred max in softmax: 0.9247190356254578, argmax 40541
DEBUG   [05-06 17:04:44] calculate_loss in loss:
soft_target max: 0.5004648566246033, argmax 20843853
DEBUG   [05-06 17:04:44] calculate_loss in loss:
pred max in softmax: 0.9985144734382629, argmax 108113151
INFO    [05-06 17:05:00] _train_one_epoch in BasicTrainer:
loss = 6.72600338480494
INFO    [05-06 17:05:40] log in loggers:
Update Best NDCG@10 Model at 36
INFO    [05-06 17:05:41] validate in BasicTrainer:
{'Recall@10': 0.06046529442071915, 'NDCG@10': 0.035047658160328864, 'MRR@10': 0.02730461962521076, 'Recall@5': 0.042315363585948944, 'NDCG@5': 0.029224047362804415, 'MRR@5': 0.02492782786488533, 'Recall*@10': 0.06421742230653762, 'NDCG*@10': 0.03723311148583889, 'MRR*@10': 0.029000539779663086, 'Recall*@5': 0.04529579967260361, 'NDCG*@5': 0.031152699887752534, 'MRR*@5': 0.026513620093464852}
INFO    [05-06 17:05:41] train in BasicTrainer:
duration: 59.403401613235474s
INFO    [05-06 17:05:41] train in BasicTrainer:
epoch: 37
INFO    [05-06 17:05:59] _train_one_epoch in BasicTrainer:
loss = 6.705075599051811
INFO    [05-06 17:06:39] validate in BasicTrainer:
{'Recall@10': 0.06018971413373947, 'NDCG@10': 0.03496964029967785, 'MRR@10': 0.027284550368785857, 'Recall@5': 0.04216661319136619, 'NDCG@5': 0.029174536243081094, 'MRR@5': 0.024912232458591463, 'Recall*@10': 0.0640705682337284, 'NDCG*@10': 0.03720276370644569, 'MRR*@10': 0.02900978282094002, 'Recall*@5': 0.04503153324127197, 'NDCG*@5': 0.031078613996505737, 'MRR*@5': 0.026501227989792823}
INFO    [05-06 17:06:39] train in BasicTrainer:
duration: 57.77523684501648s
INFO    [05-06 17:06:39] train in BasicTrainer:
epoch: 38
INFO    [05-06 17:06:57] _train_one_epoch in BasicTrainer:
loss = 6.686557834212844
INFO    [05-06 17:07:38] log in loggers:
Update Best NDCG@10 Model at 38
INFO    [05-06 17:07:38] validate in BasicTrainer:
{'Recall@10': 0.061773888170719146, 'NDCG@10': 0.035957309007644656, 'MRR@10': 0.028093653470277785, 'Recall@5': 0.043042840957641604, 'NDCG@5': 0.029915558397769926, 'MRR@5': 0.025609303414821625, 'Recall*@10': 0.06558634296059608, 'NDCG*@10': 0.0382362499833107, 'MRR*@10': 0.029903925433754922, 'Recall*@5': 0.04579531371593475, 'NDCG*@5': 0.03185038194060326, 'MRR*@5': 0.02727685645222664}
INFO    [05-06 17:07:38] train in BasicTrainer:
duration: 59.94880127906799s
INFO    [05-06 17:07:38] train in BasicTrainer:
epoch: 39
INFO    [05-06 17:07:55] _train_one_epoch in BasicTrainer:
loss = 6.667436951989526
INFO    [05-06 17:08:35] validate in BasicTrainer:
{'Recall@10': 0.0609285643696785, 'NDCG@10': 0.035551888346672056, 'MRR@10': 0.02782803922891617, 'Recall@5': 0.04261476054787636, 'NDCG@5': 0.029671611040830614, 'MRR@5': 0.025425664335489272, 'Recall*@10': 0.0645834594964981, 'NDCG*@10': 0.03775232776999474, 'MRR*@10': 0.029580693170428277, 'Recall*@5': 0.04525828123092651, 'NDCG*@5': 0.03153182923793793, 'MRR*@5': 0.027030233666300772}
INFO    [05-06 17:08:35] train in BasicTrainer:
duration: 57.00524663925171s
INFO    [05-06 17:08:35] train in BasicTrainer:
epoch: 40
INFO    [05-06 17:08:54] _train_one_epoch in BasicTrainer:
loss = 6.650923127526635
INFO    [05-06 17:09:35] log in loggers:
Update Best NDCG@10 Model at 40
INFO    [05-06 17:09:35] validate in BasicTrainer:
{'Recall@10': 0.061713687479496, 'NDCG@10': 0.03618430435657501, 'MRR@10': 0.0284058003872633, 'Recall@5': 0.04341286346316338, 'NDCG@5': 0.03029852397739887, 'MRR@5': 0.025995537117123605, 'Recall*@10': 0.06555801212787628, 'NDCG*@10': 0.03845116913318634, 'MRR*@10': 0.030185583233833312, 'Recall*@5': 0.04632103487849235, 'NDCG*@5': 0.032257746905088425, 'MRR*@5': 0.02764543391764164}
INFO    [05-06 17:09:35] train in BasicTrainer:
duration: 59.447561502456665s
INFO    [05-06 17:09:35] train in BasicTrainer:
epoch: 41
INFO    [05-06 17:09:53] _train_one_epoch in BasicTrainer:
loss = 6.634981627936836
INFO    [05-06 17:10:32] log in loggers:
Update Best NDCG@10 Model at 41
INFO    [05-06 17:10:32] validate in BasicTrainer:
{'Recall@10': 0.06198819637298584, 'NDCG@10': 0.0364208996295929, 'MRR@10': 0.028628727421164513, 'Recall@5': 0.043611925691366196, 'NDCG@5': 0.03051216818392277, 'MRR@5': 0.02620984360575676, 'Recall*@10': 0.06581633016467095, 'NDCG*@10': 0.03868340745568275, 'MRR*@10': 0.0304138170927763, 'Recall*@5': 0.04643567472696304, 'NDCG*@5': 0.03245623268187046, 'MRR*@5': 0.027867195159196854}
INFO    [05-06 17:10:32] train in BasicTrainer:
duration: 57.41185808181763s
INFO    [05-06 17:10:32] train in BasicTrainer:
epoch: 42
INFO    [05-06 17:10:51] _train_one_epoch in BasicTrainer:
loss = 6.6160087542490915
INFO    [05-06 17:11:31] log in loggers:
Update Best NDCG@10 Model at 42
INFO    [05-06 17:11:31] validate in BasicTrainer:
{'Recall@10': 0.06261533915996552, 'NDCG@10': 0.036481566876173016, 'MRR@10': 0.028523710891604423, 'Recall@5': 0.04360764026641846, 'NDCG@5': 0.030359178707003595, 'MRR@5': 0.026010717898607254, 'Recall*@10': 0.06629883766174316, 'NDCG*@10': 0.03857354506850243, 'MRR*@10': 0.030129156783223154, 'Recall*@5': 0.046240404099226, 'NDCG*@5': 0.032109730690717694, 'MRR*@5': 0.02747422084212303}
INFO    [05-06 17:11:31] train in BasicTrainer:
duration: 58.650140047073364s
INFO    [05-06 17:11:31] train in BasicTrainer:
epoch: 43
INFO    [05-06 17:11:48] _train_one_epoch in BasicTrainer:
loss = 6.600925896618818
INFO    [05-06 17:12:29] log in loggers:
Update Best NDCG@10 Model at 43
INFO    [05-06 17:12:29] validate in BasicTrainer:
{'Recall@10': 0.06294790595769882, 'NDCG@10': 0.03693405278027058, 'MRR@10': 0.029017207100987433, 'Recall@5': 0.04433886751532554, 'NDCG@5': 0.030955453962087633, 'MRR@5': 0.026572811305522918, 'Recall*@10': 0.0665785726904869, 'NDCG*@10': 0.03921008363366127, 'MRR*@10': 0.030876934230327606, 'Recall*@5': 0.04711861461400986, 'NDCG*@5': 0.03295588992536068, 'MRR*@5': 0.028318498060107233}
INFO    [05-06 17:12:29] train in BasicTrainer:
duration: 58.40669822692871s
INFO    [05-06 17:12:29] train in BasicTrainer:
epoch: 44
INFO    [05-06 17:12:49] _train_one_epoch in BasicTrainer:
loss = 6.585304732795234
INFO    [05-06 17:13:31] log in loggers:
Update Best NDCG@10 Model at 44
INFO    [05-06 17:13:32] validate in BasicTrainer:
{'Recall@10': 0.06331846415996552, 'NDCG@10': 0.0372582682967186, 'MRR@10': 0.029335264414548874, 'Recall@5': 0.04412843242287636, 'NDCG@5': 0.03109271138906479, 'MRR@5': 0.026813917011022568, 'Recall*@10': 0.06704660654067993, 'NDCG*@10': 0.039444699883461, 'MRR*@10': 0.0310481346398592, 'Recall*@5': 0.046930548399686814, 'NDCG*@5': 0.032982512041926385, 'MRR*@5': 0.028405920416116715}
INFO    [05-06 17:13:32] train in BasicTrainer:
duration: 62.30257487297058s
INFO    [05-06 17:13:32] train in BasicTrainer:
epoch: 45
DEBUG   [05-06 17:13:33] calculate_loss in loss:
soft_target max: 0.5004648566246033, argmax 3408765
DEBUG   [05-06 17:13:33] calculate_loss in loss:
pred max in softmax: 0.9527615308761597, argmax 82165936
DEBUG   [05-06 17:13:33] calculate_loss in loss:
soft_target max: 0.5004648566246033, argmax 9367221
DEBUG   [05-06 17:13:33] calculate_loss in loss:
pred max in softmax: 0.8979853391647339, argmax 97391439
INFO    [05-06 17:13:50] _train_one_epoch in BasicTrainer:
loss = 6.570064325590391
INFO    [05-06 17:14:30] validate in BasicTrainer:
{'Recall@10': 0.06307432353496552, 'NDCG@10': 0.03696308121085167, 'MRR@10': 0.029007833823561667, 'Recall@5': 0.04414796367287636, 'NDCG@5': 0.030863738879561425, 'MRR@5': 0.026502760872244836, 'Recall*@10': 0.06671552270650864, 'NDCG*@10': 0.03918384402990341, 'MRR*@10': 0.03078712083399296, 'Recall*@5': 0.0469563664495945, 'NDCG*@5': 0.032811659276485446, 'MRR*@5': 0.02816737987101078}
INFO    [05-06 17:14:30] train in BasicTrainer:
duration: 58.68379330635071s
INFO    [05-06 17:14:30] train in BasicTrainer:
epoch: 46
INFO    [05-06 17:14:50] _train_one_epoch in BasicTrainer:
loss = 6.55412956615826
INFO    [05-06 17:15:29] log in loggers:
Update Best NDCG@10 Model at 46
INFO    [05-06 17:15:29] validate in BasicTrainer:
{'Recall@10': 0.063315249979496, 'NDCG@10': 0.037475723624229434, 'MRR@10': 0.029606929272413252, 'Recall@5': 0.04461564227938652, 'NDCG@5': 0.03146294467151165, 'MRR@5': 0.027145291939377786, 'Recall*@10': 0.06663419932126999, 'NDCG*@10': 0.039486106336116794, 'MRR*@10': 0.031214246675372124, 'Recall*@5': 0.04711970001459122, 'NDCG*@5': 0.03320767529308796, 'MRR*@5': 0.028641738891601563}
INFO    [05-06 17:15:29] train in BasicTrainer:
duration: 58.91024374961853s
INFO    [05-06 17:15:29] train in BasicTrainer:
epoch: 47
INFO    [05-06 17:15:47] _train_one_epoch in BasicTrainer:
loss = 6.542032048508927
INFO    [05-06 17:16:27] validate in BasicTrainer:
{'Recall@10': 0.06320622086524963, 'NDCG@10': 0.03736637219786644, 'MRR@10': 0.029499506428837776, 'Recall@5': 0.04452280730009079, 'NDCG@5': 0.03135633870959282, 'MRR@5': 0.027037530541419982, 'Recall*@10': 0.06664678946137428, 'NDCG*@10': 0.03935396194458008, 'MRR*@10': 0.03104306049644947, 'Recall*@5': 0.046948344111442566, 'NDCG*@5': 0.03301306590437889, 'MRR*@5': 0.028442848473787308}
INFO    [05-06 17:16:27] train in BasicTrainer:
duration: 57.60454988479614s
INFO    [05-06 17:16:27] train in BasicTrainer:
epoch: 48
INFO    [05-06 17:16:44] _train_one_epoch in BasicTrainer:
loss = 6.527429194063754
INFO    [05-06 17:17:23] log in loggers:
Update Best NDCG@10 Model at 48
INFO    [05-06 17:17:24] validate in BasicTrainer:
{'Recall@10': 0.06360273867845535, 'NDCG@10': 0.037683034241199495, 'MRR@10': 0.02978419706225395, 'Recall@5': 0.044953566193580624, 'NDCG@5': 0.03167856626212597, 'MRR@5': 0.027321747466921807, 'Recall*@10': 0.06725594654679298, 'NDCG*@10': 0.03983857095241547, 'MRR*@10': 0.03147878587245941, 'Recall*@5': 0.04774231716990471, 'NDCG*@5': 0.03355369709432125, 'MRR*@5': 0.02890013337135315}
INFO    [05-06 17:17:24] train in BasicTrainer:
duration: 56.79775142669678s
INFO    [05-06 17:17:24] train in BasicTrainer:
epoch: 49
INFO    [05-06 17:17:42] _train_one_epoch in BasicTrainer:
loss = 6.514824368932226
INFO    [05-06 17:18:22] log in loggers:
Update Best NDCG@10 Model at 49
INFO    [05-06 17:18:22] validate in BasicTrainer:
{'Recall@10': 0.064369937479496, 'NDCG@10': 0.03831589996814728, 'MRR@10': 0.030382981523871422, 'Recall@5': 0.04534258410334587, 'NDCG@5': 0.03218779340386391, 'MRR@5': 0.02786858431994915, 'Recall*@10': 0.0679833671450615, 'NDCG*@10': 0.04047357723116875, 'MRR*@10': 0.0320946703851223, 'Recall*@5': 0.04800394356250763, 'NDCG*@5': 0.03403748795390129, 'MRR*@5': 0.029453123286366463}
INFO    [05-06 17:18:22] train in BasicTrainer:
duration: 58.218013048172s
INFO    [05-06 17:18:22] train in BasicTrainer:
epoch: 50
INFO    [05-06 17:18:40] _train_one_epoch in BasicTrainer:
loss = 6.502656223537685
INFO    [05-06 17:19:19] validate in BasicTrainer:
{'Recall@10': 0.0642142230272293, 'NDCG@10': 0.03822734400629997, 'MRR@10': 0.030320726931095124, 'Recall@5': 0.045165731459856036, 'NDCG@5': 0.032101293727755546, 'MRR@5': 0.02781247951090336, 'Recall*@10': 0.06768457725644111, 'NDCG*@10': 0.04023418247699737, 'MRR*@10': 0.03188203170895577, 'Recall*@5': 0.0475900000333786, 'NDCG*@5': 0.033775118663907054, 'MRR*@5': 0.029239399135112764}
INFO    [05-06 17:19:19] train in BasicTrainer:
duration: 57.053619384765625s
INFO    [05-06 17:19:19] train in BasicTrainer:
epoch: 51
INFO    [05-06 17:19:38] _train_one_epoch in BasicTrainer:
loss = 6.49091538867435
INFO    [05-06 17:20:17] log in loggers:
Update Best NDCG@10 Model at 51
INFO    [05-06 17:20:18] validate in BasicTrainer:
{'Recall@10': 0.06498237013816834, 'NDCG@10': 0.03897546723484993, 'MRR@10': 0.031039355993270873, 'Recall@5': 0.046604492515325543, 'NDCG@5': 0.033055419102311134, 'MRR@5': 0.02860964074730873, 'Recall*@10': 0.06828087761998176, 'NDCG*@10': 0.04105354607105255, 'MRR*@10': 0.03273555345833302, 'Recall*@5': 0.049314911365509036, 'NDCG*@5': 0.03494040787220001, 'MRR*@5': 0.030224341601133346}
INFO    [05-06 17:20:18] train in BasicTrainer:
duration: 58.618534088134766s
INFO    [05-06 17:20:18] train in BasicTrainer:
epoch: 52
INFO    [05-06 17:20:35] _train_one_epoch in BasicTrainer:
loss = 6.479012669743718
INFO    [05-06 17:21:14] validate in BasicTrainer:
{'Recall@10': 0.06458692401647567, 'NDCG@10': 0.03850912019610405, 'MRR@10': 0.030570292174816133, 'Recall@5': 0.045383789390325543, 'NDCG@5': 0.032314803600311276, 'MRR@5': 0.028022602573037146, 'Recall*@10': 0.06808270409703254, 'NDCG*@10': 0.04052985310554504, 'MRR*@10': 0.032135383114218714, 'Recall*@5': 0.047932551205158234, 'NDCG*@5': 0.03402564272284508, 'MRR*@5': 0.02945754215121269}
INFO    [05-06 17:21:14] train in BasicTrainer:
duration: 56.77617573738098s
INFO    [05-06 17:21:14] train in BasicTrainer:
epoch: 53
INFO    [05-06 17:21:32] _train_one_epoch in BasicTrainer:
loss = 6.468873805827923
INFO    [05-06 17:22:12] validate in BasicTrainer:
{'Recall@10': 0.06483160018920898, 'NDCG@10': 0.038735732436180115, 'MRR@10': 0.030798051431775095, 'Recall@5': 0.04576357737183571, 'NDCG@5': 0.03260597623884678, 'MRR@5': 0.02828926183283329, 'Recall*@10': 0.06843166649341584, 'NDCG*@10': 0.0409476101398468, 'MRR*@10': 0.03258776038885117, 'Recall*@5': 0.04854380801320076, 'NDCG*@5': 0.03456094175577164, 'MRR*@5': 0.029977647960186003}
INFO    [05-06 17:22:12] train in BasicTrainer:
duration: 57.39885401725769s
INFO    [05-06 17:22:12] train in BasicTrainer:
epoch: 54
DEBUG   [05-06 17:22:13] calculate_loss in loss:
soft_target max: 0.5004648566246033, argmax 2674965
DEBUG   [05-06 17:22:13] calculate_loss in loss:
pred max in softmax: 0.96723872423172, argmax 22488884
DEBUG   [05-06 17:22:13] calculate_loss in loss:
soft_target max: 0.5004648566246033, argmax 150693
DEBUG   [05-06 17:22:13] calculate_loss in loss:
pred max in softmax: 0.9879025816917419, argmax 102012434
INFO    [05-06 17:22:30] _train_one_epoch in BasicTrainer:
loss = 6.457168209660161
INFO    [05-06 17:23:09] log in loggers:
Update Best NDCG@10 Model at 54
INFO    [05-06 17:23:09] validate in BasicTrainer:
{'Recall@10': 0.06523359805345536, 'NDCG@10': 0.03903345182538032, 'MRR@10': 0.0310411137342453, 'Recall@5': 0.04639887869358063, 'NDCG@5': 0.03296183668076992, 'MRR@5': 0.028546729013323783, 'Recall*@10': 0.06880534246563912, 'NDCG*@10': 0.04115393504500389, 'MRR*@10': 0.03271592736244202, 'Recall*@5': 0.04894592791795731, 'NDCG*@5': 0.034749068915843964, 'MRR*@5': 0.030082866176962854}
INFO    [05-06 17:23:09] train in BasicTrainer:
duration: 57.246071100234985s
INFO    [05-06 17:23:09] train in BasicTrainer:
epoch: 55
INFO    [05-06 17:23:27] _train_one_epoch in BasicTrainer:
loss = 6.446482615427928
INFO    [05-06 17:24:07] log in loggers:
Update Best NDCG@10 Model at 55
INFO    [05-06 17:24:07] validate in BasicTrainer:
{'Recall@10': 0.06551024943590164, 'NDCG@10': 0.039294921606779096, 'MRR@10': 0.03131301380693913, 'Recall@5': 0.046342427730560305, 'NDCG@5': 0.03312769919633865, 'MRR@5': 0.028786407709121706, 'Recall*@10': 0.06931574255228043, 'NDCG*@10': 0.04154754072427749, 'MRR*@10': 0.03309145122766495, 'Recall*@5': 0.04916623711585998, 'NDCG*@5': 0.03507203817367554, 'MRR*@5': 0.030442933961749078}
INFO    [05-06 17:24:07] train in BasicTrainer:
duration: 57.78251767158508s
INFO    [05-06 17:24:07] train in BasicTrainer:
epoch: 56
INFO    [05-06 17:24:24] _train_one_epoch in BasicTrainer:
loss = 6.434338101395616
INFO    [05-06 17:25:03] log in loggers:
Update Best NDCG@10 Model at 56
INFO    [05-06 17:25:03] validate in BasicTrainer:
{'Recall@10': 0.06537406653165817, 'NDCG@10': 0.039396948516368865, 'MRR@10': 0.03146558336913586, 'Recall@5': 0.04659365549683571, 'NDCG@5': 0.033328614830970764, 'MRR@5': 0.028963544964790346, 'Recall*@10': 0.06882232889533042, 'NDCG*@10': 0.0414652518928051, 'MRR*@10': 0.033103954195976254, 'Recall*@5': 0.049317859411239624, 'NDCG*@5': 0.03516355380415916, 'MRR*@5': 0.0305060663074255}
INFO    [05-06 17:25:03] train in BasicTrainer:
duration: 56.63869547843933s
INFO    [05-06 17:25:03] train in BasicTrainer:
epoch: 57
INFO    [05-06 17:25:22] _train_one_epoch in BasicTrainer:
loss = 6.426563516393438
INFO    [05-06 17:26:02] validate in BasicTrainer:
{'Recall@10': 0.06580536097288131, 'NDCG@10': 0.039213448911905285, 'MRR@10': 0.031123460456728935, 'Recall@5': 0.0463717246055603, 'NDCG@5': 0.03297000966966152, 'MRR@5': 0.02857018433511257, 'Recall*@10': 0.06946399971842766, 'NDCG*@10': 0.04133405148983002, 'MRR*@10': 0.03277025684714317, 'Recall*@5': 0.04900607869029045, 'NDCG*@5': 0.03476051524281502, 'MRR*@5': 0.03008143439888954}
INFO    [05-06 17:26:02] train in BasicTrainer:
duration: 58.11058783531189s
INFO    [05-06 17:26:02] train in BasicTrainer:
epoch: 58
INFO    [05-06 17:26:20] _train_one_epoch in BasicTrainer:
loss = 6.416193051381154
INFO    [05-06 17:26:59] log in loggers:
Update Best NDCG@10 Model at 58
INFO    [05-06 17:26:59] validate in BasicTrainer:
{'Recall@10': 0.06581780523061752, 'NDCG@10': 0.039501611441373825, 'MRR@10': 0.03147528469562531, 'Recall@5': 0.046785218119621275, 'NDCG@5': 0.03336367964744568, 'MRR@5': 0.028951779082417486, 'Recall*@10': 0.06941681057214737, 'NDCG*@10': 0.041623138338327405, 'MRR*@10': 0.03314098156988621, 'Recall*@5': 0.04947045221924782, 'NDCG*@5': 0.0351929285377264, 'MRR*@5': 0.030498605296015738}
INFO    [05-06 17:26:59] train in BasicTrainer:
duration: 57.84544134140015s
INFO    [05-06 17:26:59] train in BasicTrainer:
epoch: 59
INFO    [05-06 17:27:18] _train_one_epoch in BasicTrainer:
loss = 6.404166281760276
INFO    [05-06 17:28:00] log in loggers:
Update Best NDCG@10 Model at 59
INFO    [05-06 17:28:00] validate in BasicTrainer:
{'Recall@10': 0.06600817322731017, 'NDCG@10': 0.03976200371980667, 'MRR@10': 0.03175499498844147, 'Recall@5': 0.047371568083763124, 'NDCG@5': 0.03375979021191597, 'MRR@5': 0.02929190382361412, 'Recall*@10': 0.06967161998152732, 'NDCG*@10': 0.041858666241168976, 'MRR*@10': 0.033373493030667306, 'Recall*@5': 0.04988991156220436, 'NDCG*@5': 0.035490103140473364, 'MRR*@5': 0.03076139621436596}
INFO    [05-06 17:28:00] train in BasicTrainer:
duration: 60.736897230148315s
INFO    [05-06 17:28:00] close_training in BasicTrainer:
finished training
DEBUG   [05-06 17:28:00] debug_summary in loss:
loss nan summary: nan 0 times, not nan 6661 times, ratio nan / (nan + not_nan) = 0.0
INFO    [05-06 17:28:00] run_routine in Routine:
Finished training, Start final validation
INFO    [05-06 17:28:00] final_validate in BasicTrainer:
validate model on val set!
INFO    [05-06 17:28:00] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-06 17:28:00] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-06 17:28:40] validate in BasicTrainer:
{'Recall@10': 0.06600817322731017, 'NDCG@10': 0.03976200371980667, 'MRR@10': 0.03175499498844147, 'Recall@5': 0.047371568083763124, 'NDCG@5': 0.03375979021191597, 'MRR@5': 0.02929190382361412, 'Recall*@10': 0.06967161998152732, 'NDCG*@10': 0.041858666241168976, 'MRR*@10': 0.033373493030667306, 'Recall*@5': 0.04988991156220436, 'NDCG*@5': 0.035490103140473364, 'MRR*@5': 0.03076139621436596}
INFO    [05-06 17:28:40] run_routine in Routine:
Finished final validating. Result: {'Recall@10': 0.06600817322731017, 'NDCG@10': 0.03976200371980667, 'MRR@10': 0.03175499498844147, 'Recall@5': 0.047371568083763124, 'NDCG@5': 0.03375979021191597, 'MRR@5': 0.02929190382361412, 'Recall*@10': 0.06967161998152732, 'NDCG*@10': 0.041858666241168976, 'MRR*@10': 0.033373493030667306, 'Recall*@5': 0.04988991156220436, 'NDCG*@5': 0.035490103140473364, 'MRR*@5': 0.03076139621436596}
INFO    [05-06 17:28:40] _evaluate in DistillSched:
Start testing student model on test set
INFO    [05-06 17:28:40] test in BasicTrainer:
Test model on test set!
INFO    [05-06 17:28:40] test_with_given_state_path in BasicTrainer:
Loading model params from ___el_soft_2021/pop_narm-T-3-al-0.25_05-06_16:28_0/student_narm_logs/checkpoint/best_acc_model.pth.
INFO    [05-06 17:28:40] load_state_from_given_path in utils:
checkpoint epoch: 59
INFO    [05-06 17:28:40] load_state_from_given_path in utils:
Loading model's parameters
INFO    [05-06 17:28:40] test_with_given_state_path in BasicTrainer:
Finished loading. Start testing.
INFO    [05-06 17:29:20] test_with_given_state_path in BasicTrainer:
{'Recall@10': 0.05407531887292862, 'NDCG@10': 0.0314566445350647, 'MRR@10': 0.024577636420726776, 'Recall@5': 0.037473054677248, 'NDCG@5': 0.02610210359096527, 'MRR@5': 0.022376222908496855, 'Recall*@10': 0.05813209280371666, 'NDCG*@10': 0.03383961886167526, 'MRR*@10': 0.026447375789284706, 'Recall*@5': 0.04044598937034607, 'NDCG*@5': 0.0281356094032526, 'MRR*@5': 0.024102362468838692}
INFO    [05-06 17:29:20] _evaluate in DistillSched:
!!Final Result!!: {'Recall@10': 0.05407531887292862, 'NDCG@10': 0.0314566445350647, 'MRR@10': 0.024577636420726776, 'Recall@5': 0.037473054677248, 'NDCG@5': 0.02610210359096527, 'MRR@5': 0.022376222908496855, 'Recall*@10': 0.05813209280371666, 'NDCG*@10': 0.03383961886167526, 'MRR*@10': 0.026447375789284706, 'Recall*@5': 0.04044598937034607, 'NDCG*@5': 0.0281356094032526, 'MRR*@5': 0.024102362468838692}
